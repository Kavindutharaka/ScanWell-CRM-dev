/*! For license information please see main.d022c2fb.js.LICENSE.txt */
(()=>{"use strict";var e={579:(e,t,r)=>{e.exports=r(2799)},2284:(e,t,r)=>{function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}r.d(t,{A:()=>a})},2799:(e,t)=>{var r=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function n(e,t,a){var n=null;if(void 0!==a&&(n=""+a),void 0!==t.key&&(n=""+t.key),"key"in t)for(var s in a={},t)"key"!==s&&(a[s]=t[s]);else a=t;return t=a.ref,{$$typeof:r,type:e,key:n,ref:void 0!==t?t:null,props:a}}t.Fragment=a,t.jsx=n,t.jsxs=n},4288:(e,t)=>{var r=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,x={};function b(e,t,r){this.props=e,this.context=t,this.refs=x,this.updater=r||p}function v(){}function y(e,t,r){this.props=e,this.context=t,this.refs=x,this.updater=r||p}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=b.prototype;var w=y.prototype=new v;w.constructor=y,g(w,b.prototype),w.isPureReactComponent=!0;var N=Array.isArray;function j(){}var k={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function A(e,t,a){var n=a.ref;return{$$typeof:r,type:e,key:t,ref:void 0!==n?n:null,props:a}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var _=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function E(e,t,n,s,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var o,c,d=!1;if(null===e)d=!0;else switch(l){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case r:case a:d=!0;break;case h:return E((d=e._init)(e._payload),t,n,s,i)}}if(d)return i=i(e),d=""===s?"."+T(e,0):s,N(i)?(n="",null!=d&&(n=d.replace(_,"$&/")+"/"),E(i,t,n,"",function(e){return e})):null!=i&&(C(i)&&(o=i,c=n+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+d,i=A(o.type,c,o.props)),t.push(i)),1;d=0;var u,f=""===s?".":s+":";if(N(e))for(var p=0;p<e.length;p++)d+=E(s=e[p],t,n,l=f+T(s,p),i);else if("function"===typeof(p=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=m&&u[m]||u["@@iterator"])?u:null))for(e=p.call(e),p=0;!(s=e.next()).done;)d+=E(s=s.value,t,n,l=f+T(s,p++),i);else if("object"===l){if("function"===typeof e.then)return E(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(j,j):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,n,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function L(e,t,r){if(null==e)return e;var a=[],n=0;return E(e,a,"","",function(e){return t.call(r,e,n++)}),a}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},F={map:L,forEach:function(e,t,r){L(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return L(e,function(){t++}),t},toArray:function(e){return L(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=F,t.Component=b,t.Fragment=n,t.Profiler=i,t.PureComponent=y,t.StrictMode=s,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return k.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var a=g({},e.props),n=e.key;if(null!=t)for(s in void 0!==t.key&&(n=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(a[s]=t[s]);var s=arguments.length-2;if(1===s)a.children=r;else if(1<s){for(var i=Array(s),l=0;l<s;l++)i[l]=arguments[l+2];a.children=i}return A(e.type,n,a)},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:l,_context:e},e},t.createElement=function(e,t,r){var a,n={},s=null;if(null!=t)for(a in void 0!==t.key&&(s=""+t.key),t)S.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&(n[a]=t[a]);var i=arguments.length-2;if(1===i)n.children=r;else if(1<i){for(var l=Array(i),o=0;o<i;o++)l[o]=arguments[o+2];n.children=l}if(e&&e.defaultProps)for(a in i=e.defaultProps)void 0===n[a]&&(n[a]=i[a]);return A(e,s,n)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=k.T,r={};k.T=r;try{var a=e(),n=k.S;null!==n&&n(r,a),"object"===typeof a&&null!==a&&"function"===typeof a.then&&a.then(j,O)}catch(s){O(s)}finally{null!==t&&null!==r.types&&(t.types=r.types),k.T=t}},t.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},t.use=function(e){return k.H.use(e)},t.useActionState=function(e,t,r){return k.H.useActionState(e,t,r)},t.useCallback=function(e,t){return k.H.useCallback(e,t)},t.useContext=function(e){return k.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return k.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return k.H.useEffect(e,t)},t.useEffectEvent=function(e){return k.H.useEffectEvent(e)},t.useId=function(){return k.H.useId()},t.useImperativeHandle=function(e,t,r){return k.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return k.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return k.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return k.H.useMemo(e,t)},t.useOptimistic=function(e,t){return k.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return k.H.useReducer(e,t,r)},t.useRef=function(e){return k.H.useRef(e)},t.useState=function(e){return k.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return k.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return k.H.useTransition()},t.version="19.2.0"},4391:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(7004)},4980:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(2284);function n(e){var t=function(e,t){if("object"!=(0,a.A)(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=(0,a.A)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,a.A)(t)?t:t+""}function s(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},5043:(e,t,r)=>{e.exports=r(4288)},5896:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var a=r-1>>>1,n=e[a];if(!(0<s(n,t)))break e;e[a]=t,e[r]=n,r=a}}function a(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var a=0,n=e.length,i=n>>>1;a<i;){var l=2*(a+1)-1,o=e[l],c=l+1,d=e[c];if(0>s(o,r))c<n&&0>s(d,o)?(e[a]=d,e[c]=r,a=c):(e[a]=o,e[l]=r,a=l);else{if(!(c<n&&0>s(d,r)))break e;e[a]=d,e[c]=r,a=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,h=null,f=3,m=!1,p=!1,g=!1,x=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=a(d);null!==t;){if(null===t.callback)n(d);else{if(!(t.startTime<=e))break;n(d),t.sortIndex=t.expirationTime,r(c,t)}t=a(d)}}function N(e){if(g=!1,w(e),!p)if(null!==a(c))p=!0,k||(k=!0,j());else{var t=a(d);null!==t&&P(N,t.startTime-e)}}var j,k=!1,S=-1,A=5,C=-1;function _(){return!!x||!(t.unstable_now()-C<A)}function T(){if(x=!1,k){var e=t.unstable_now();C=e;var r=!0;try{e:{p=!1,g&&(g=!1,v(S),S=-1),m=!0;var s=f;try{t:{for(w(e),h=a(c);null!==h&&!(h.expirationTime>e&&_());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var l=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof l){h.callback=l,w(e),r=!0;break t}h===a(c)&&n(c),w(e)}else n(c);h=a(c)}if(null!==h)r=!0;else{var o=a(d);null!==o&&P(N,o.startTime-e),r=!1}}break e}finally{h=null,f=s,m=!1}r=void 0}}finally{r?j():k=!1}}}if("function"===typeof y)j=function(){y(T)};else if("undefined"!==typeof MessageChannel){var E=new MessageChannel,L=E.port2;E.port1.onmessage=T,j=function(){L.postMessage(null)}}else j=function(){b(T,0)};function P(e,r){S=b(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,n,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:u++,callback:n,priorityLevel:e,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>i?(e.sortIndex=s,r(d,e),null===a(c)&&e===a(d)&&(g?(v(S),S=-1):g=!0,P(N,s-i))):(e.sortIndex=l,r(c,e),p||m||(p=!0,k||(k=!0,j()))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},6672:(e,t,r)=>{var a=r(5043);function n(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(n(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");var o=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(n(299));return function(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:l,key:null==a?null:""+a,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=o.T,r=i.p;try{if(o.T=null,i.p=2,e)return e()}finally{o.T=t,i.p=r,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var r=t.as,a=c(r,t.crossOrigin),n="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:a,integrity:n,fetchPriority:s}):"script"===r&&i.d.X(e,{crossOrigin:a,integrity:n,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var r=t.as,a=c(r,t.crossOrigin);i.d.L(e,r,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var r=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return o.H.useFormState(e,t,r)},t.useFormStatus=function(){return o.H.useHostTransitionStatus()},t.version="19.2.0"},7004:(e,t,r)=>{var a=r(8853),n=r(5043),s=r(7950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function o(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(o(e)!==e)throw Error(i(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),w=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var T=Symbol.iterator;function E(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=T&&e[T]||e["@@iterator"])?e:null}var L=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===L?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case j:return"Suspense";case k:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case w:return e.displayName||"Context";case y:return(e._context.displayName||"Context")+".Consumer";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return P(e(t))}catch(yy){}}return null}var O=Array.isArray,F=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},R=[],M=-1;function B(e){return{current:e}}function U(e){0>M||(e.current=R[M],R[M]=null,M--)}function z(e,t){M++,R[M]=e.current,e.current=t}var q,H,W=B(null),V=B(null),G=B(null),K=B(null);function Y(e,t){switch(z(G,t),z(V,e),z(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?xu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=bu(t=xu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(W),z(W,e)}function X(){U(W),U(V),U(G)}function $(e){null!==e.memoizedState&&z(K,e);var t=W.current,r=bu(t,e.type);t!==r&&(z(V,e),z(W,r))}function J(e){V.current===e&&(U(W),U(V)),K.current===e&&(U(K),dh._currentValue=I)}function Q(e){if(void 0===q)try{throw Error()}catch(yy){var t=yy.stack.trim().match(/\n( *(at )?)/);q=t&&t[1]||"",H=-1<yy.stack.indexOf("\n    at")?" (<anonymous>)":-1<yy.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+q+e+H}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(yy){var a=yy}Reflect.construct(e,[],r)}else{try{r.call()}catch(n){a=n}e.call(r.prototype)}}else{try{throw Error()}catch(s){a=s}(r=e())&&"function"===typeof r.catch&&r.catch(function(){})}}catch(i){if(i&&a&&"string"===typeof i.stack)return[i.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=a.DetermineComponentFrameRoot(),i=s[0],l=s[1];if(i&&l){var o=i.split("\n"),c=l.split("\n");for(n=a=0;a<o.length&&!o[a].includes("DetermineComponentFrameRoot");)a++;for(;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;if(a===o.length||n===c.length)for(a=o.length-1,n=c.length-1;1<=a&&0<=n&&o[a]!==c[n];)n--;for(;1<=a&&0<=n;a--,n--)if(o[a]!==c[n]){if(1!==a||1!==n)do{if(a--,0>--n||o[a]!==c[n]){var d="\n"+o[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=a&&0<=n);break}}}finally{Z=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?Q(r):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return e.child!==t&&null!==t?Q("Suspense Fallback"):Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Q("Activity");default:return""}}function re(e){try{var t="",r=null;do{t+=te(e,r),r=e,e=e.return}while(e);return t}catch(yy){return"\nError generating stack: "+yy.message+"\n"+yy.stack}}var ae=Object.prototype.hasOwnProperty,ne=a.unstable_scheduleCallback,se=a.unstable_cancelCallback,ie=a.unstable_shouldYield,le=a.unstable_requestPaint,oe=a.unstable_now,ce=a.unstable_getCurrentPriorityLevel,de=a.unstable_ImmediatePriority,ue=a.unstable_UserBlockingPriority,he=a.unstable_NormalPriority,fe=a.unstable_LowPriority,me=a.unstable_IdlePriority,pe=a.log,ge=a.unstable_setDisableYieldValue,xe=null,be=null;function ve(e){if("function"===typeof pe&&ge(e),be&&"function"===typeof be.setStrictMode)try{be.setStrictMode(xe,e)}catch(t){}}var ye=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(we(e)/Ne|0)|0},we=Math.log,Ne=Math.LN2;var je=256,ke=262144,Se=4194304;function Ae(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t,r){var a=e.pendingLanes;if(0===a)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var l=134217727&a;return 0!==l?0!==(a=l&~s)?n=Ae(a):0!==(i&=l)?n=Ae(i):r||0!==(r=l&~e)&&(n=Ae(r)):0!==(l=a&~s)?n=Ae(l):0!==i?n=Ae(i):r||0!==(r=a&~e)&&(n=Ae(r)),0===n?0:0!==t&&t!==n&&0===(t&s)&&((s=n&-n)>=(r=t&-t)||32===s&&0!==(4194048&r))?t:n}function _e(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Te(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ee(){var e=Se;return 0===(62914560&(Se<<=1))&&(Se=4194304),e}function Le(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Pe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-ye(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|261930&r}function Fe(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-ye(r),n=1<<a;n&t|e[a]&t&&(e[a]|=t),r&=~n}}function De(e,t){var r=t&-t;return 0!==((r=0!==(42&r)?1:Ie(r))&(e.suspendedLanes|t))?0:r}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Re(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Me(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Ah(e.type)}function Be(e,t){var r=D.p;try{return D.p=e,t()}finally{D.p=r}}var Ue=Math.random().toString(36).slice(2),ze="__reactFiber$"+Ue,qe="__reactProps$"+Ue,He="__reactContainer$"+Ue,We="__reactEvents$"+Ue,Ve="__reactListeners$"+Ue,Ge="__reactHandles$"+Ue,Ke="__reactResources$"+Ue,Ye="__reactMarker$"+Ue;function Xe(e){delete e[ze],delete e[qe],delete e[We],delete e[Ve],delete e[Ge]}function $e(e){var t=e[ze];if(t)return t;for(var r=e.parentNode;r;){if(t=r[He]||r[ze]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Iu(e);null!==e;){if(r=e[ze])return r;e=Iu(e)}return t}r=(e=r).parentNode}return null}function Je(e){if(e=e[ze]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ze(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ye]=!0}var tt=new Set,rt={};function at(e,t){nt(e,t),nt(e+"Capture",t)}function nt(e,t){for(rt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},lt={};function ot(e,t,r){if(n=t,ae.call(lt,n)||!ae.call(it,n)&&(st.test(n)?lt[n]=!0:(it[n]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var n}function ct(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function dt(e,t,r,a){if(null===a)e.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+a)}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,r){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof a&&"function"===typeof a.get&&"function"===typeof a.set){var n=a.get,s=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=ht(e)?e.checked?"true":"false":e.value),(e=a)!==r&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function xt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function bt(e,t,r,a,n,s,i,l){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?yt(e,i,ut(t)):null!=r?yt(e,i,ut(r)):null!=a&&e.removeAttribute("value"),null==n&&null!=s&&(e.defaultChecked=!!s),null!=n&&(e.checked=n&&"function"!==typeof n&&"symbol"!==typeof n),null!=l&&"function"!==typeof l&&"symbol"!==typeof l&&"boolean"!==typeof l?e.name=""+ut(l):e.removeAttribute("name")}function vt(e,t,r,a,n,s,i,l){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=r){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void ft(e);r=null!=r?""+ut(r):"",t=null!=t?""+ut(t):r,l||t===e.value||(e.value=t),e.defaultValue=t}a="function"!==typeof(a=null!=a?a:n)&&"symbol"!==typeof a&&!!a,e.checked=l?e.checked:!!a,e.defaultChecked=!!a,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i),ft(e)}function yt(e,t,r){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function wt(e,t,r,a){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&a&&(e[r].defaultSelected=!0)}else{for(r=""+ut(r),t=null,n=0;n<e.length;n++){if(e[n].value===r)return e[n].selected=!0,void(a&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function Nt(e,t,r){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ut(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function jt(e,t,r,a){if(null==t){if(null!=a){if(null!=r)throw Error(i(92));if(O(a)){if(1<a.length)throw Error(i(93));a=a[0]}r=a}null==r&&(r=""),t=r}r=ut(t),e.defaultValue=r,(a=e.textContent)===r&&""!==a&&null!==a&&(e.value=a),ft(e)}function kt(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function At(e,t,r){var a=0===t.indexOf("--");null==r||"boolean"===typeof r||""===r?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,r):"number"!==typeof r||0===r||St.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Ct(e,t,r){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=r){for(var a in r)!r.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var n in t)a=t[n],t.hasOwnProperty(n)&&r[n]!==a&&At(e,n,a)}else for(var s in t)t.hasOwnProperty(s)&&At(e,s,t[s])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Et=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lt(e){return Et.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pt(){}var Ot=null;function Ft(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,It=null;function Rt(e){var t=Je(e);if(t&&(e=t.stateNode)){var r=e[qe]||null;e:switch(e=t.stateNode,t.type){case"input":if(bt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+xt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=a[qe]||null;if(!n)throw Error(i(90));bt(a,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<r.length;t++)(a=r[t]).form===e.form&&mt(a)}break e;case"textarea":Nt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&wt(e,!!r.multiple,t,!1)}}}var Mt=!1;function Bt(e,t,r){if(Mt)return e(t,r);Mt=!0;try{return e(t)}finally{if(Mt=!1,(null!==Dt||null!==It)&&(Zc(),Dt&&(t=Dt,e=It,It=Dt=null,Rt(t),e)))for(t=0;t<e.length;t++)Rt(e[t])}}function Ut(e,t){var r=e.stateNode;if(null===r)return null;var a=r[qe]||null;if(null===a)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),qt=!1;if(zt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){qt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Jh){qt=!1}var Wt=null,Vt=null,Gt=null;function Kt(){if(Gt)return Gt;var e,t,r=Vt,a=r.length,n="value"in Wt?Wt.value:Wt.textContent,s=n.length;for(e=0;e<a&&r[e]===n[e];e++);var i=a-e;for(t=1;t<=i&&r[a-t]===n[s-t];t++);return Gt=n.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Xt(){return!0}function $t(){return!1}function Jt(e){function t(t,r,a,n,s){for(var i in this._reactName=t,this._targetInst=a,this.type=r,this.nativeEvent=n,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(n):n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Xt:$t,this.isPropagationStopped=$t,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),t}var Qt,Zt,er,tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rr=Jt(tr),ar=f({},tr,{view:0,detail:0}),nr=Jt(ar),sr=f({},ar,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==er&&(er&&"mousemove"===e.type?(Qt=e.screenX-er.screenX,Zt=e.screenY-er.screenY):Zt=Qt=0,er=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),ir=Jt(sr),lr=Jt(f({},sr,{dataTransfer:0})),or=Jt(f({},ar,{relatedTarget:0})),cr=Jt(f({},tr,{animationName:0,elapsedTime:0,pseudoElement:0})),dr=Jt(f({},tr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ur=Jt(f({},tr,{data:0})),hr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mr[e])&&!!t[e]}function gr(){return pr}var xr=Jt(f({},ar,{key:function(e){if(e.key){var t=hr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gr,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),br=Jt(f({},sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vr=Jt(f({},ar,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gr})),yr=Jt(f({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0})),wr=Jt(f({},sr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Nr=Jt(f({},tr,{newState:0,oldState:0})),jr=[9,13,27,32],kr=zt&&"CompositionEvent"in window,Sr=null;zt&&"documentMode"in document&&(Sr=document.documentMode);var Ar=zt&&"TextEvent"in window&&!Sr,Cr=zt&&(!kr||Sr&&8<Sr&&11>=Sr),_r=String.fromCharCode(32),Tr=!1;function Er(e,t){switch(e){case"keyup":return-1!==jr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pr=!1;var Or={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Or[e.type]:"textarea"===t}function Dr(e,t,r,a){Dt?It?It.push(a):It=[a]:Dt=a,0<(t=au(t,"onChange")).length&&(r=new rr("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var Ir=null,Rr=null;function Mr(e){Xd(e,0)}function Br(e){if(mt(Qe(e)))return e}function Ur(e,t){if("change"===e)return t}var zr=!1;if(zt){var qr;if(zt){var Hr="oninput"in document;if(!Hr){var Wr=document.createElement("div");Wr.setAttribute("oninput","return;"),Hr="function"===typeof Wr.oninput}qr=Hr}else qr=!1;zr=qr&&(!document.documentMode||9<document.documentMode)}function Vr(){Ir&&(Ir.detachEvent("onpropertychange",Gr),Rr=Ir=null)}function Gr(e){if("value"===e.propertyName&&Br(Rr)){var t=[];Dr(t,Rr,e,Ft(e)),Bt(Mr,t)}}function Kr(e,t,r){"focusin"===e?(Vr(),Rr=r,(Ir=t).attachEvent("onpropertychange",Gr)):"focusout"===e&&Vr()}function Yr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Br(Rr)}function Xr(e,t){if("click"===e)return Br(t)}function $r(e,t){if("input"===e||"change"===e)return Br(t)}var Jr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qr(e,t){if(Jr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!ae.call(t,n)||!Jr(e[n],t[n]))return!1}return!0}function Zr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ea(e,t){var r,a=Zr(e);for(e=0;a;){if(3===a.nodeType){if(r=e+a.textContent.length,e<=t&&r>=t)return{node:a,offset:t-e};e=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Zr(a)}}function ta(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ta(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ra(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(a){r=!1}if(!r)break;t=pt((e=t.contentWindow).document)}return t}function aa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var na=zt&&"documentMode"in document&&11>=document.documentMode,sa=null,ia=null,la=null,oa=!1;function ca(e,t,r){var a=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;oa||null==sa||sa!==pt(a)||("selectionStart"in(a=sa)&&aa(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},la&&Qr(la,a)||(la=a,0<(a=au(ia,"onSelect")).length&&(t=new rr("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=sa)))}function da(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ua={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionrun:da("Transition","TransitionRun"),transitionstart:da("Transition","TransitionStart"),transitioncancel:da("Transition","TransitionCancel"),transitionend:da("Transition","TransitionEnd")},ha={},fa={};function ma(e){if(ha[e])return ha[e];if(!ua[e])return e;var t,r=ua[e];for(t in r)if(r.hasOwnProperty(t)&&t in fa)return ha[e]=r[t];return e}zt&&(fa=document.createElement("div").style,"AnimationEvent"in window||(delete ua.animationend.animation,delete ua.animationiteration.animation,delete ua.animationstart.animation),"TransitionEvent"in window||delete ua.transitionend.transition);var pa=ma("animationend"),ga=ma("animationiteration"),xa=ma("animationstart"),ba=ma("transitionrun"),va=ma("transitionstart"),ya=ma("transitioncancel"),wa=ma("transitionend"),Na=new Map,ja="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ka(e,t){Na.set(e,t),at(t,[e])}ja.push("scrollEnd");var Sa="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Aa=[],Ca=0,_a=0;function Ta(){for(var e=Ca,t=_a=Ca=0;t<e;){var r=Aa[t];Aa[t++]=null;var a=Aa[t];Aa[t++]=null;var n=Aa[t];Aa[t++]=null;var s=Aa[t];if(Aa[t++]=null,null!==a&&null!==n){var i=a.pending;null===i?n.next=n:(n.next=i.next,i.next=n),a.pending=n}0!==s&&Oa(r,n,s)}}function Ea(e,t,r,a){Aa[Ca++]=e,Aa[Ca++]=t,Aa[Ca++]=r,Aa[Ca++]=a,_a|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function La(e,t,r,a){return Ea(e,t,r,a),Fa(e)}function Pa(e,t){return Ea(e,null,null,t),Fa(e)}function Oa(e,t,r){e.lanes|=r;var a=e.alternate;null!==a&&(a.lanes|=r);for(var n=!1,s=e.return;null!==s;)s.childLanes|=r,null!==(a=s.alternate)&&(a.childLanes|=r),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(n=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,n&&null!==t&&(n=31-ye(r),null===(a=(e=s.hiddenUpdates)[n])?e[n]=[t]:a.push(t),t.lane=536870912|r),s):null}function Fa(e){if(50<Wc)throw Wc=0,Vc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Da={};function Ia(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(e,t,r,a){return new Ia(e,t,r,a)}function Ma(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ba(e,t){var r=e.alternate;return null===r?((r=Ra(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Ua(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function za(e,t,r,a,n,s){var l=0;if(a=e,"function"===typeof e)Ma(e)&&(l=1);else if("string"===typeof e)l=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,r,W.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Ra(31,r,t,n)).elementType=C,e.lanes=s,e;case x:return qa(r.children,n,s,t);case b:l=8,n|=24;break;case v:return(e=Ra(12,r,t,2|n)).elementType=v,e.lanes=s,e;case j:return(e=Ra(13,r,t,n)).elementType=j,e.lanes=s,e;case k:return(e=Ra(19,r,t,n)).elementType=k,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:l=10;break e;case y:l=9;break e;case N:l=11;break e;case S:l=14;break e;case A:l=16,a=null;break e}l=29,r=Error(i(130,null===e?"null":typeof e,"")),a=null}return(t=Ra(l,r,t,n)).elementType=e,t.type=a,t.lanes=s,t}function qa(e,t,r,a){return(e=Ra(7,e,a,t)).lanes=r,e}function Ha(e,t,r){return(e=Ra(6,e,null,t)).lanes=r,e}function Wa(e){var t=Ra(18,null,null,0);return t.stateNode=e,t}function Va(e,t,r){return(t=Ra(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ga=new WeakMap;function Ka(e,t){if("object"===typeof e&&null!==e){var r=Ga.get(e);return void 0!==r?r:(t={value:e,source:t,stack:re(t)},Ga.set(e,t),t)}return{value:e,source:t,stack:re(t)}}var Ya=[],Xa=0,$a=null,Ja=0,Qa=[],Za=0,en=null,tn=1,rn="";function an(e,t){Ya[Xa++]=Ja,Ya[Xa++]=$a,$a=e,Ja=t}function nn(e,t,r){Qa[Za++]=tn,Qa[Za++]=rn,Qa[Za++]=en,en=e;var a=tn;e=rn;var n=32-ye(a)-1;a&=~(1<<n),r+=1;var s=32-ye(t)+n;if(30<s){var i=n-n%5;s=(a&(1<<i)-1).toString(32),a>>=i,n-=i,tn=1<<32-ye(t)+n|r<<n|a,rn=s+e}else tn=1<<s|r<<n|a,rn=e}function sn(e){null!==e.return&&(an(e,1),nn(e,1,0))}function ln(e){for(;e===$a;)$a=Ya[--Xa],Ya[Xa]=null,Ja=Ya[--Xa],Ya[Xa]=null;for(;e===en;)en=Qa[--Za],Qa[Za]=null,rn=Qa[--Za],Qa[Za]=null,tn=Qa[--Za],Qa[Za]=null}function on(e,t){Qa[Za++]=tn,Qa[Za++]=rn,Qa[Za++]=en,tn=t.id,rn=t.overflow,en=e}var cn=null,dn=null,un=!1,hn=null,fn=!1,mn=Error(i(519));function pn(e){throw wn(Ka(Error(i(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),mn}function gn(e){var t=e.stateNode,r=e.type,a=e.memoizedProps;switch(t[ze]=e,t[qe]=a,r){case"dialog":$d("cancel",t),$d("close",t);break;case"iframe":case"object":case"embed":$d("load",t);break;case"video":case"audio":for(r=0;r<Kd.length;r++)$d(Kd[r],t);break;case"source":$d("error",t);break;case"img":case"image":case"link":$d("error",t),$d("load",t);break;case"details":$d("toggle",t);break;case"input":$d("invalid",t),vt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":$d("invalid",t);break;case"textarea":$d("invalid",t),jt(t,a.value,a.defaultValue,a.children)}"string"!==typeof(r=a.children)&&"number"!==typeof r&&"bigint"!==typeof r||t.textContent===""+r||!0===a.suppressHydrationWarning||cu(t.textContent,r)?(null!=a.popover&&($d("beforetoggle",t),$d("toggle",t)),null!=a.onScroll&&$d("scroll",t),null!=a.onScrollEnd&&$d("scrollend",t),null!=a.onClick&&(t.onclick=Pt),t=!0):t=!1,t||pn(e,!0)}function xn(e){for(cn=e.return;cn;)switch(cn.tag){case 5:case 31:case 13:return void(fn=!1);case 27:case 3:return void(fn=!0);default:cn=cn.return}}function bn(e){if(e!==cn)return!1;if(!un)return xn(e),un=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||vu(e.type,e.memoizedProps)),t=!t),t&&dn&&pn(e),xn(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));dn=Du(e)}else if(31===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));dn=Du(e)}else 27===r?(r=dn,Au(e.type)?(e=Fu,Fu=null,dn=e):dn=r):dn=cn?Ou(e.stateNode.nextSibling):null;return!0}function vn(){dn=cn=null,un=!1}function yn(){var e=hn;return null!==e&&(null===Ec?Ec=e:Ec.push.apply(Ec,e),hn=null),e}function wn(e){null===hn?hn=[e]:hn.push(e)}var Nn=B(null),jn=null,kn=null;function Sn(e,t,r){z(Nn,t._currentValue),t._currentValue=r}function An(e){e._currentValue=Nn.current,U(Nn)}function Cn(e,t,r){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function _n(e,t,r,a){var n=e.child;for(null!==n&&(n.return=e);null!==n;){var s=n.dependencies;if(null!==s){var l=n.child;s=s.firstContext;e:for(;null!==s;){var o=s;s=n;for(var c=0;c<t.length;c++)if(o.context===t[c]){s.lanes|=r,null!==(o=s.alternate)&&(o.lanes|=r),Cn(s.return,r,e),a||(l=null);break e}s=o.next}}else if(18===n.tag){if(null===(l=n.return))throw Error(i(341));l.lanes|=r,null!==(s=l.alternate)&&(s.lanes|=r),Cn(l,r,e),l=null}else l=n.child;if(null!==l)l.return=n;else for(l=n;null!==l;){if(l===e){l=null;break}if(null!==(n=l.sibling)){n.return=l.return,l=n;break}l=l.return}n=l}}function Tn(e,t,r,a){e=null;for(var n=t,s=!1;null!==n;){if(!s)if(0!==(524288&n.flags))s=!0;else if(0!==(262144&n.flags))break;if(10===n.tag){var l=n.alternate;if(null===l)throw Error(i(387));if(null!==(l=l.memoizedProps)){var o=n.type;Jr(n.pendingProps.value,l.value)||(null!==e?e.push(o):e=[o])}}else if(n===K.current){if(null===(l=n.alternate))throw Error(i(387));l.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(null!==e?e.push(dh):e=[dh])}n=n.return}null!==e&&_n(t,e,r,a),t.flags|=262144}function En(e){for(e=e.firstContext;null!==e;){if(!Jr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ln(e){jn=e,kn=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pn(e){return Fn(jn,e)}function On(e,t){return null===jn&&Ln(e),Fn(e,t)}function Fn(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===kn){if(null===e)throw Error(i(308));kn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else kn=kn.next=t;return r}var Dn="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},In=a.unstable_scheduleCallback,Rn=a.unstable_NormalPriority,Mn={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bn(){return{controller:new Dn,data:new Map,refCount:0}}function Un(e){e.refCount--,0===e.refCount&&In(Rn,function(){e.controller.abort()})}var zn=null,qn=0,Hn=0,Wn=null;function Vn(){if(0===--qn&&null!==zn){null!==Wn&&(Wn.status="fulfilled");var e=zn;zn=null,Hn=0,Wn=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Gn=F.S;F.S=function(e,t){Oc=oe(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===zn){var r=zn=[];qn=0,Hn=qd(),Wn={status:"pending",value:void 0,then:function(e){r.push(e)}}}qn++,t.then(Vn,Vn)}(0,t),null!==Gn&&Gn(e,t)};var Kn=B(null);function Yn(){var e=Kn.current;return null!==e?e:mc.pooledCache}function Xn(e,t){z(Kn,null===t?Kn.current:t.pool)}function $n(){var e=Yn();return null===e?null:{parent:Mn._currentValue,pool:e}}var Jn=Error(i(460)),Qn=Error(i(474)),Zn=Error(i(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function rs(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(Pt,Pt),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e;default:if("string"===typeof t.status)t.then(Pt,Pt);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e}throw ns=t,Jn}}function as(e){try{return(0,e._init)(e._payload)}catch(yy){if(null!==yy&&"object"===typeof yy&&"function"===typeof yy.then)throw ns=yy,Jn;throw yy}}var ns=null;function ss(){if(null===ns)throw Error(i(459));var e=ns;return ns=null,e}function is(e){if(e===Jn||e===Zn)throw Error(i(483))}var ls=null,os=0;function cs(e){var t=os;return os+=1,null===ls&&(ls=[]),rs(ls,e,t)}function ds(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function us(e,t){if(t.$$typeof===m)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hs(e){function t(t,r){if(e){var a=t.deletions;null===a?(t.deletions=[r],t.flags|=16):a.push(r)}}function r(r,a){if(!e)return null;for(;null!==a;)t(r,a),a=a.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function n(e,t){return(e=Ba(e,t)).index=0,e.sibling=null,e}function s(t,r,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<r?(t.flags|=67108866,r):a:(t.flags|=67108866,r):(t.flags|=1048576,r)}function l(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function o(e,t,r,a){return null===t||6!==t.tag?((t=Ha(r,e.mode,a)).return=e,t):((t=n(t,r)).return=e,t)}function c(e,t,r,a){var s=r.type;return s===x?u(e,t,r.props.children,a,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&as(s)===t.type)?(ds(t=n(t,r.props),r),t.return=e,t):(ds(t=za(r.type,r.key,r.props,null,e.mode,a),r),t.return=e,t)}function d(e,t,r,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Va(r,e.mode,a)).return=e,t):((t=n(t,r.children||[])).return=e,t)}function u(e,t,r,a,s){return null===t||7!==t.tag?((t=qa(r,e.mode,a,s)).return=e,t):((t=n(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ha(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return ds(r=za(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case g:return(t=Va(t,e.mode,r)).return=e,t;case A:return h(e,t=as(t),r)}if(O(t)||E(t))return(t=qa(t,e.mode,r,null)).return=e,t;if("function"===typeof t.then)return h(e,cs(t),r);if(t.$$typeof===w)return h(e,On(e,t),r);us(e,t)}return null}function f(e,t,r,a){var n=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return null!==n?null:o(e,t,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return r.key===n?c(e,t,r,a):null;case g:return r.key===n?d(e,t,r,a):null;case A:return f(e,t,r=as(r),a)}if(O(r)||E(r))return null!==n?null:u(e,t,r,a,null);if("function"===typeof r.then)return f(e,t,cs(r),a);if(r.$$typeof===w)return f(e,t,On(e,r),a);us(e,r)}return null}function m(e,t,r,a,n){if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return o(t,e=e.get(r)||null,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case p:return c(t,e=e.get(null===a.key?r:a.key)||null,a,n);case g:return d(t,e=e.get(null===a.key?r:a.key)||null,a,n);case A:return m(e,t,r,a=as(a),n)}if(O(a)||E(a))return u(t,e=e.get(r)||null,a,n,null);if("function"===typeof a.then)return m(e,t,r,cs(a),n);if(a.$$typeof===w)return m(e,t,r,On(t,a),n);us(t,a)}return null}function b(o,c,d,u){if("object"===typeof d&&null!==d&&d.type===x&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case p:e:{for(var v=d.key;null!==c;){if(c.key===v){if((v=d.type)===x){if(7===c.tag){r(o,c.sibling),(u=n(c,d.props.children)).return=o,o=u;break e}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===A&&as(v)===c.type){r(o,c.sibling),ds(u=n(c,d.props),d),u.return=o,o=u;break e}r(o,c);break}t(o,c),c=c.sibling}d.type===x?((u=qa(d.props.children,o.mode,u,d.key)).return=o,o=u):(ds(u=za(d.type,d.key,d.props,null,o.mode,u),d),u.return=o,o=u)}return l(o);case g:e:{for(v=d.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){r(o,c.sibling),(u=n(c,d.children||[])).return=o,o=u;break e}r(o,c);break}t(o,c),c=c.sibling}(u=Va(d,o.mode,u)).return=o,o=u}return l(o);case A:return b(o,c,d=as(d),u)}if(O(d))return function(n,i,l,o){for(var c=null,d=null,u=i,p=i=0,g=null;null!==u&&p<l.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var x=f(n,u,l[p],o);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(n,u),i=s(x,i,p),null===d?c=x:d.sibling=x,d=x,u=g}if(p===l.length)return r(n,u),un&&an(n,p),c;if(null===u){for(;p<l.length;p++)null!==(u=h(n,l[p],o))&&(i=s(u,i,p),null===d?c=u:d.sibling=u,d=u);return un&&an(n,p),c}for(u=a(u);p<l.length;p++)null!==(g=m(u,n,p,l[p],o))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),i=s(g,i,p),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(n,e)}),un&&an(n,p),c}(o,c,d,u);if(E(d)){if("function"!==typeof(v=E(d)))throw Error(i(150));return function(n,l,o,c){if(null==o)throw Error(i(151));for(var d=null,u=null,p=l,g=l=0,x=null,b=o.next();null!==p&&!b.done;g++,b=o.next()){p.index>g?(x=p,p=null):x=p.sibling;var v=f(n,p,b.value,c);if(null===v){null===p&&(p=x);break}e&&p&&null===v.alternate&&t(n,p),l=s(v,l,g),null===u?d=v:u.sibling=v,u=v,p=x}if(b.done)return r(n,p),un&&an(n,g),d;if(null===p){for(;!b.done;g++,b=o.next())null!==(b=h(n,b.value,c))&&(l=s(b,l,g),null===u?d=b:u.sibling=b,u=b);return un&&an(n,g),d}for(p=a(p);!b.done;g++,b=o.next())null!==(b=m(p,n,g,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?g:b.key),l=s(b,l,g),null===u?d=b:u.sibling=b,u=b);return e&&p.forEach(function(e){return t(n,e)}),un&&an(n,g),d}(o,c,d=v.call(d),u)}if("function"===typeof d.then)return b(o,c,cs(d),u);if(d.$$typeof===w)return b(o,c,On(o,d),u);us(o,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(r(o,c.sibling),(u=n(c,d)).return=o,o=u):(r(o,c),(u=Ha(d,o.mode,u)).return=o,o=u),l(o)):r(o,c)}return function(e,t,r,a){try{os=0;var n=b(e,t,r,a);return ls=null,n}catch(yy){if(yy===Jn||yy===Zn)throw yy;var s=Ra(29,yy,null,e.mode);return s.lanes=a,s.return=e,s}}}var fs=hs(!0),ms=hs(!1),ps=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function vs(e,t,r){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&fc)){var n=a.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),a.pending=t,t=Fa(e),Oa(e,null,r),t}return Ea(e,a,t,r),Fa(e)}function ys(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&r))){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,Fe(e,r)}}function ws(e,t){var r=e.updateQueue,a=e.alternate;if(null!==a&&r===(a=a.updateQueue)){var n=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===s?n=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?n=s=t:s=s.next=t}else n=s=t;return r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Ns=!1;function js(){if(Ns){if(null!==Wn)throw Wn}}function ks(e,t,r,a){Ns=!1;var n=e.updateQueue;ps=!1;var s=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(null!==l){n.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?s=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==s){var u=n.baseState;for(i=0,d=c=o=null,l=s;;){var h=-536870913&l.lane,m=h!==l.lane;if(m?(gc&h)===h:(a&h)===h){0!==h&&h===Hn&&(Ns=!0),null!==d&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var p=e,g=l;h=t;var x=r;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){u=p.call(x,u,h);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(x,u,h):p)||void 0===h)break e;u=f({},u,h);break e;case 2:ps=!0}}null!==(h=l.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=n.callbacks)?n.callbacks=[h]:m.push(h))}else m={lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=m,o=u):d=d.next=m,i|=h;if(null===(l=l.next)){if(null===(l=n.shared.pending))break;l=(m=l).next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}null===d&&(o=u),n.baseState=o,n.firstBaseUpdate=c,n.lastBaseUpdate=d,null===s&&(n.shared.lanes=0),kc|=i,e.lanes=i,e.memoizedState=u}}function Ss(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function As(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)Ss(r[e],t)}var Cs=B(null),_s=B(0);function Ts(e,t){z(_s,e=Nc),z(Cs,t),Nc=e|t.baseLanes}function Es(){z(_s,Nc),z(Cs,Cs.current)}function Ls(){Nc=_s.current,U(Cs),U(_s)}var Ps=B(null),Os=null;function Fs(e){var t=e.alternate;z(Bs,1&Bs.current),z(Ps,e),null===Os&&(null===t||null!==Cs.current||null!==t.memoizedState)&&(Os=e)}function Ds(e){z(Bs,Bs.current),z(Ps,e),null===Os&&(Os=e)}function Is(e){22===e.tag?(z(Bs,Bs.current),z(Ps,e),null===Os&&(Os=e)):Rs()}function Rs(){z(Bs,Bs.current),z(Ps,Ps.current)}function Ms(e){U(Ps),Os===e&&(Os=null),U(Bs)}var Bs=B(0);function Us(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||Lu(r)||Pu(r)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zs=0,qs=null,Hs=null,Ws=null,Vs=!1,Gs=!1,Ks=!1,Ys=0,Xs=0,$s=null,Js=0;function Qs(){throw Error(i(321))}function Zs(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Jr(e[r],t[r]))return!1;return!0}function ei(e,t,r,a,n,s){return zs=s,qs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,F.H=null===e||null===e.memoizedState?pl:gl,Ks=!1,s=r(a,n),Ks=!1,Gs&&(s=ri(t,r,a,n)),ti(e),s}function ti(e){F.H=ml;var t=null!==Hs&&null!==Hs.next;if(zs=0,Ws=Hs=qs=null,Vs=!1,Xs=0,$s=null,t)throw Error(i(300));null===e||Pl||null!==(e=e.dependencies)&&En(e)&&(Pl=!0)}function ri(e,t,r,a){qs=e;var n=0;do{if(Gs&&($s=null),Xs=0,Gs=!1,25<=n)throw Error(i(301));if(n+=1,Ws=Hs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}F.H=xl,s=t(r,a)}while(Gs);return s}function ai(){var e=F.H,t=e.useState()[0];return t="function"===typeof t.then?ci(t):t,e=e.useState()[0],(null!==Hs?Hs.memoizedState:null)!==e&&(qs.flags|=1024),t}function ni(){var e=0!==Ys;return Ys=0,e}function si(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function ii(e){if(Vs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Vs=!1}zs=0,Ws=Hs=qs=null,Gs=!1,Xs=Ys=0,$s=null}function li(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ws?qs.memoizedState=Ws=e:Ws=Ws.next=e,Ws}function oi(){if(null===Hs){var e=qs.alternate;e=null!==e?e.memoizedState:null}else e=Hs.next;var t=null===Ws?qs.memoizedState:Ws.next;if(null!==t)Ws=t,Hs=e;else{if(null===e){if(null===qs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Hs=e).memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},null===Ws?qs.memoizedState=Ws=e:Ws=Ws.next=e}return Ws}function ci(e){var t=Xs;return Xs+=1,null===$s&&($s=[]),e=rs($s,e,t),t=qs,null===(null===Ws?t.memoizedState:Ws.next)&&(t=t.alternate,F.H=null===t||null===t.memoizedState?pl:gl),e}function di(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ci(e);if(e.$$typeof===w)return Pn(e)}throw Error(i(438,String(e)))}function ui(e){var t=null,r=qs.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var a=qs.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),a=0;a<e;a++)r[a]=_;return t.index++,r}function hi(e,t){return"function"===typeof t?t(e):t}function fi(e){return mi(oi(),Hs,e)}function mi(e,t,r){var a=e.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=r;var n=e.baseQueue,s=a.pending;if(null!==s){if(null!==n){var l=n.next;n.next=s.next,s.next=l}t.baseQueue=n=s,a.pending=null}if(s=e.baseState,null===n)e.memoizedState=s;else{var o=l=null,c=null,d=t=n.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(gc&h)===h:(zs&h)===h){var f=d.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Hn&&(u=!0);else{if((zs&f)===f){d=d.next,f===Hn&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=h,l=s):c=c.next=h,qs.lanes|=f,kc|=f}h=d.action,Ks&&r(s,h),s=d.hasEagerState?d.eagerState:r(s,h)}else f={lane:h,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=f,l=s):c=c.next=f,qs.lanes|=h,kc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?l=s:c.next=o,!Jr(s,e.memoizedState)&&(Pl=!0,u&&null!==(r=Wn)))throw r;e.memoizedState=s,e.baseState=l,e.baseQueue=c,a.lastRenderedState=s}return null===n&&(a.lanes=0),[e.memoizedState,a.dispatch]}function pi(e){var t=oi(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var a=r.dispatch,n=r.pending,s=t.memoizedState;if(null!==n){r.pending=null;var l=n=n.next;do{s=e(s,l.action),l=l.next}while(l!==n);Jr(s,t.memoizedState)||(Pl=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,a]}function gi(e,t,r){var a=qs,n=oi(),s=un;if(s){if(void 0===r)throw Error(i(407));r=r()}else r=t();var l=!Jr((Hs||n).memoizedState,r);if(l&&(n.memoizedState=r,Pl=!0),n=n.queue,zi(vi.bind(null,a,n,e),[e]),n.getSnapshot!==t||l||null!==Ws&&1&Ws.memoizedState.tag){if(a.flags|=2048,Ii(9,{destroy:void 0},bi.bind(null,a,n,r,t),null),null===mc)throw Error(i(349));s||0!==(127&zs)||xi(a,t,r)}return r}function xi(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=qs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function bi(e,t,r,a){t.value=r,t.getSnapshot=a,yi(t)&&wi(e)}function vi(e,t,r){return r(function(){yi(t)&&wi(e)})}function yi(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Jr(e,r)}catch(a){return!0}}function wi(e){var t=Pa(e,2);null!==t&&Yc(t,e,2)}function Ni(e){var t=li();if("function"===typeof e){var r=e;if(e=r(),Ks){ve(!0);try{r()}finally{ve(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:e},t}function ji(e,t,r,a){return e.baseState=r,mi(e,Hs,"function"===typeof a?a:hi)}function ki(e,t,r,a,n){if(ul(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==F.T?r(!0):s.isTransition=!1,a(s),null===(r=t.pending)?(s.next=t.pending=s,Si(t,s)):(s.next=r.next,t.pending=r.next=s)}}function Si(e,t){var r=t.action,a=t.payload,n=e.state;if(t.isTransition){var s=F.T,i={};F.T=i;try{var l=r(n,a),o=F.S;null!==o&&o(i,l),Ai(e,t,l)}catch(c){_i(e,t,c)}finally{null!==s&&null!==i.types&&(s.types=i.types),F.T=s}}else try{Ai(e,t,s=r(n,a))}catch(d){_i(e,t,d)}}function Ai(e,t,r){null!==r&&"object"===typeof r&&"function"===typeof r.then?r.then(function(r){Ci(e,t,r)},function(r){return _i(e,t,r)}):Ci(e,t,r)}function Ci(e,t,r){t.status="fulfilled",t.value=r,Ti(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,Si(e,r)))}function _i(e,t,r){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=r,Ti(t),t=t.next}while(t!==a)}e.action=null}function Ti(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ei(e,t){return t}function Li(e,t){if(un){var r=mc.formState;if(null!==r){e:{var a=qs;if(un){if(dn){t:{for(var n=dn,s=fn;8!==n.nodeType;){if(!s){n=null;break t}if(null===(n=Ou(n.nextSibling))){n=null;break t}}n="F!"===(s=n.data)||"F"===s?n:null}if(n){dn=Ou(n.nextSibling),a="F!"===n.data;break e}}pn(a)}a=!1}a&&(t=r[0])}}return(r=li()).memoizedState=r.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:t},r.queue=a,r=ol.bind(null,qs,a),a.dispatch=r,a=Ni(!1),s=dl.bind(null,qs,!1,a.queue),n={state:t,dispatch:null,action:e,pending:null},(a=li()).queue=n,r=ki.bind(null,qs,n,s,r),n.dispatch=r,a.memoizedState=e,[t,r,!1]}function Pi(e){return Oi(oi(),Hs,e)}function Oi(e,t,r){if(t=mi(e,t,Ei)[0],e=fi(hi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var a=ci(t)}catch(yy){if(yy===Jn)throw Zn;throw yy}else a=t;var n=(t=oi()).queue,s=n.dispatch;return r!==t.memoizedState&&(qs.flags|=2048,Ii(9,{destroy:void 0},Fi.bind(null,n,r),null)),[a,s,e]}function Fi(e,t){e.action=t}function Di(e){var t=oi(),r=Hs;if(null!==r)return Oi(t,r,e);oi(),t=t.memoizedState;var a=(r=oi()).queue.dispatch;return r.memoizedState=e,[t,a,!1]}function Ii(e,t,r,a){return e={tag:e,create:r,deps:a,inst:t,next:null},null===(t=qs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function Ri(){return oi().memoizedState}function Mi(e,t,r,a){var n=li();qs.flags|=e,n.memoizedState=Ii(1|t,{destroy:void 0},r,void 0===a?null:a)}function Bi(e,t,r,a){var n=oi();a=void 0===a?null:a;var s=n.memoizedState.inst;null!==Hs&&null!==a&&Zs(a,Hs.memoizedState.deps)?n.memoizedState=Ii(t,s,r,a):(qs.flags|=e,n.memoizedState=Ii(1|t,s,r,a))}function Ui(e,t){Mi(8390656,8,e,t)}function zi(e,t){Bi(2048,8,e,t)}function qi(e){var t=oi().memoizedState;return function(e){qs.flags|=4;var t=qs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t,t.events=[e];else{var r=t.events;null===r?t.events=[e]:r.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fc))throw Error(i(440));return t.impl.apply(void 0,arguments)}}function Hi(e,t){return Bi(4,2,e,t)}function Wi(e,t){return Bi(4,4,e,t)}function Vi(e,t){if("function"===typeof t){e=e();var r=t(e);return function(){"function"===typeof r?r():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Gi(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Bi(4,4,Vi.bind(null,t,e),r)}function Ki(){}function Yi(e,t){var r=oi();t=void 0===t?null:t;var a=r.memoizedState;return null!==t&&Zs(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Xi(e,t){var r=oi();t=void 0===t?null:t;var a=r.memoizedState;if(null!==t&&Zs(t,a[1]))return a[0];if(a=e(),Ks){ve(!0);try{e()}finally{ve(!1)}}return r.memoizedState=[a,t],a}function $i(e,t,r){return void 0===r||0!==(1073741824&zs)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=r,e=Kc(),qs.lanes|=e,kc|=e,r)}function Ji(e,t,r,a){return Jr(r,t)?r:null!==Cs.current?(e=$i(e,r,a),Jr(e,t)||(Pl=!0),e):0===(42&zs)||0!==(1073741824&zs)&&0===(261930&gc)?(Pl=!0,e.memoizedState=r):(e=Kc(),qs.lanes|=e,kc|=e,t)}function Qi(e,t,r,a,n){var s=D.p;D.p=0!==s&&8>s?s:8;var i=F.T,l={};F.T=l,dl(e,!1,t,r);try{var o=n(),c=F.S;if(null!==c&&c(l,o),null!==o&&"object"===typeof o&&"function"===typeof o.then){var d=function(e,t){var r=[],a={status:"pending",value:null,reason:null,then:function(e){r.push(e)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var e=0;e<r.length;e++)(0,r[e])(t)},function(e){for(a.status="rejected",a.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)}),a}(o,a);cl(e,t,d,Gc())}else cl(e,t,a,Gc())}catch(u){cl(e,t,{then:function(){},status:"rejected",reason:u},Gc())}finally{D.p=s,null!==i&&null!==l.types&&(i.types=l.types),F.T=i}}function Zi(){}function el(e,t,r,a){if(5!==e.tag)throw Error(i(476));var n=tl(e).queue;Qi(e,n,t,I,null===r?Zi:function(){return rl(e),r(a)})}function tl(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:I},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function rl(e){var t=tl(e);null===t.next&&(t=e.alternate.memoizedState),cl(e,t.next.queue,{},Gc())}function al(){return Pn(dh)}function nl(){return oi().memoizedState}function sl(){return oi().memoizedState}function il(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=Gc(),a=vs(t,e=bs(r),r);return null!==a&&(Yc(a,t,r),ys(a,t,r)),t={cache:Bn()},void(e.payload=t)}t=t.return}}function ll(e,t,r){var a=Gc();r={lane:a,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ul(e)?hl(t,r):null!==(r=La(e,t,r,a))&&(Yc(r,e,a),fl(r,t,a))}function ol(e,t,r){cl(e,t,r,Gc())}function cl(e,t,r,a){var n={lane:a,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(ul(e))hl(t,n);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=s(i,r);if(n.hasEagerState=!0,n.eagerState=l,Jr(l,i))return Ea(e,t,n,0),null===mc&&Ta(),!1}catch(o){}if(null!==(r=La(e,t,n,a)))return Yc(r,e,a),fl(r,t,a),!0}return!1}function dl(e,t,r,a){if(a={lane:2,revertLane:qd(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},ul(e)){if(t)throw Error(i(479))}else null!==(t=La(e,r,a,2))&&Yc(t,e,2)}function ul(e){var t=e.alternate;return e===qs||null!==t&&t===qs}function hl(e,t){Gs=Vs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function fl(e,t,r){if(0!==(4194048&r)){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,Fe(e,r)}}var ml={readContext:Pn,use:di,useCallback:Qs,useContext:Qs,useEffect:Qs,useImperativeHandle:Qs,useLayoutEffect:Qs,useInsertionEffect:Qs,useMemo:Qs,useReducer:Qs,useRef:Qs,useState:Qs,useDebugValue:Qs,useDeferredValue:Qs,useTransition:Qs,useSyncExternalStore:Qs,useId:Qs,useHostTransitionStatus:Qs,useFormState:Qs,useActionState:Qs,useOptimistic:Qs,useMemoCache:Qs,useCacheRefresh:Qs};ml.useEffectEvent=Qs;var pl={readContext:Pn,use:di,useCallback:function(e,t){return li().memoizedState=[e,void 0===t?null:t],e},useContext:Pn,useEffect:Ui,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Mi(4194308,4,Vi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mi(4194308,4,e,t)},useInsertionEffect:function(e,t){Mi(4,2,e,t)},useMemo:function(e,t){var r=li();t=void 0===t?null:t;var a=e();if(Ks){ve(!0);try{e()}finally{ve(!1)}}return r.memoizedState=[a,t],a},useReducer:function(e,t,r){var a=li();if(void 0!==r){var n=r(t);if(Ks){ve(!0);try{r(t)}finally{ve(!1)}}}else n=t;return a.memoizedState=a.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},a.queue=e,e=e.dispatch=ll.bind(null,qs,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},li().memoizedState=e},useState:function(e){var t=(e=Ni(e)).queue,r=ol.bind(null,qs,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ki,useDeferredValue:function(e,t){return $i(li(),e,t)},useTransition:function(){var e=Ni(!1);return e=Qi.bind(null,qs,e.queue,!0,!1),li().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var a=qs,n=li();if(un){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===mc)throw Error(i(349));0!==(127&gc)||xi(a,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,Ui(vi.bind(null,a,s,e),[e]),a.flags|=2048,Ii(9,{destroy:void 0},bi.bind(null,a,s,r,t),null),r},useId:function(){var e=li(),t=mc.identifierPrefix;if(un){var r=rn;t="_"+t+"R_"+(r=(tn&~(1<<32-ye(tn)-1)).toString(32)+r),0<(r=Ys++)&&(t+="H"+r.toString(32)),t+="_"}else t="_"+t+"r_"+(r=Js++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:al,useFormState:Li,useActionState:Li,useOptimistic:function(e){var t=li();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=dl.bind(null,qs,!0,r),r.dispatch=t,[e,t]},useMemoCache:ui,useCacheRefresh:function(){return li().memoizedState=il.bind(null,qs)},useEffectEvent:function(e){var t=li(),r={impl:e};return t.memoizedState=r,function(){if(0!==(2&fc))throw Error(i(440));return r.impl.apply(void 0,arguments)}}},gl={readContext:Pn,use:di,useCallback:Yi,useContext:Pn,useEffect:zi,useImperativeHandle:Gi,useInsertionEffect:Hi,useLayoutEffect:Wi,useMemo:Xi,useReducer:fi,useRef:Ri,useState:function(){return fi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){return Ji(oi(),Hs.memoizedState,e,t)},useTransition:function(){var e=fi(hi)[0],t=oi().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:nl,useHostTransitionStatus:al,useFormState:Pi,useActionState:Pi,useOptimistic:function(e,t){return ji(oi(),0,e,t)},useMemoCache:ui,useCacheRefresh:sl};gl.useEffectEvent=qi;var xl={readContext:Pn,use:di,useCallback:Yi,useContext:Pn,useEffect:zi,useImperativeHandle:Gi,useInsertionEffect:Hi,useLayoutEffect:Wi,useMemo:Xi,useReducer:pi,useRef:Ri,useState:function(){return pi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){var r=oi();return null===Hs?$i(r,e,t):Ji(r,Hs.memoizedState,e,t)},useTransition:function(){var e=pi(hi)[0],t=oi().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:nl,useHostTransitionStatus:al,useFormState:Di,useActionState:Di,useOptimistic:function(e,t){var r=oi();return null!==Hs?ji(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:ui,useCacheRefresh:sl};function bl(e,t,r,a){r=null===(r=r(a,t=e.memoizedState))||void 0===r?t:f({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}xl.useEffectEvent=qi;var vl={enqueueSetState:function(e,t,r){e=e._reactInternals;var a=Gc(),n=bs(a);n.payload=t,void 0!==r&&null!==r&&(n.callback=r),null!==(t=vs(e,n,a))&&(Yc(t,e,a),ys(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=Gc(),n=bs(a);n.tag=1,n.payload=t,void 0!==r&&null!==r&&(n.callback=r),null!==(t=vs(e,n,a))&&(Yc(t,e,a),ys(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Gc(),a=bs(r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=vs(e,a,r))&&(Yc(t,e,r),ys(t,e,r))}};function yl(e,t,r,a,n,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Qr(r,a)||!Qr(n,s))}function wl(e,t,r,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&vl.enqueueReplaceState(t,t.state,null)}function Nl(e,t){var r=t;if("ref"in t)for(var a in r={},t)"ref"!==a&&(r[a]=t[a]);if(e=e.defaultProps)for(var n in r===t&&(r=f({},r)),e)void 0===r[n]&&(r[n]=e[n]);return r}function jl(e){Sa(e)}function kl(e){console.error(e)}function Sl(e){Sa(e)}function Al(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function Cl(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function _l(e,t,r){return(r=bs(r)).tag=3,r.payload={element:null},r.callback=function(){Al(e,t)},r}function Tl(e){return(e=bs(e)).tag=3,e}function El(e,t,r,a){var n=r.type.getDerivedStateFromError;if("function"===typeof n){var s=a.value;e.payload=function(){return n(s)},e.callback=function(){Cl(t,r,a)}}var i=r.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){Cl(t,r,a),"function"!==typeof n&&(null===Ic?Ic=new Set([this]):Ic.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var Ll=Error(i(461)),Pl=!1;function Ol(e,t,r,a){t.child=null===e?ms(t,null,r,a):fs(t,e.child,r,a)}function Fl(e,t,r,a,n){r=r.render;var s=t.ref;if("ref"in a){var i={};for(var l in a)"ref"!==l&&(i[l]=a[l])}else i=a;return Ln(t),a=ei(e,t,r,i,s,n),l=ni(),null===e||Pl?(un&&l&&sn(t),t.flags|=1,Ol(e,t,a,n),t.child):(si(e,t,n),ao(e,t,n))}function Dl(e,t,r,a,n){if(null===e){var s=r.type;return"function"!==typeof s||Ma(s)||void 0!==s.defaultProps||null!==r.compare?((e=za(r.type,null,a,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Il(e,t,s,a,n))}if(s=e.child,!no(e,n)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:Qr)(i,a)&&e.ref===t.ref)return ao(e,t,n)}return t.flags|=1,(e=Ba(s,a)).ref=t.ref,e.return=t,t.child=e}function Il(e,t,r,a,n){if(null!==e){var s=e.memoizedProps;if(Qr(s,a)&&e.ref===t.ref){if(Pl=!1,t.pendingProps=a=s,!no(e,n))return t.lanes=e.lanes,ao(e,t,n);0!==(131072&e.flags)&&(Pl=!0)}}return Hl(e,t,r,a,n)}function Rl(e,t,r,a){var n=a.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===a.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|r:r,null!==e){for(a=t.child=e.child,n=0;null!==a;)n=n|a.lanes|a.childLanes,a=a.sibling;a=n&~s}else a=0,t.child=null;return Bl(e,t,s,r,a)}if(0===(536870912&r))return a=t.lanes=536870912,Bl(e,t,null!==s?s.baseLanes|r:r,r,a);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Xn(0,null!==s?s.cachePool:null),null!==s?Ts(t,s):Es(),Is(t)}else null!==s?(Xn(0,s.cachePool),Ts(t,s),Rs(),t.memoizedState=null):(null!==e&&Xn(0,null),Es(),Rs());return Ol(e,t,n,r),t.child}function Ml(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bl(e,t,r,a,n){var s=Yn();return s=null===s?null:{parent:Mn._currentValue,pool:s},t.memoizedState={baseLanes:r,cachePool:s},null!==e&&Xn(0,null),Es(),Is(t),null!==e&&Tn(e,t,a,!0),t.childLanes=n,null}function Ul(e,t){return(t=Ql({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function zl(e,t,r){return fs(t,e.child,null,r),(e=Ul(t,t.pendingProps)).flags|=2,Ms(t),t.memoizedState=null,e}function ql(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof r&&"object"!==typeof r)throw Error(i(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function Hl(e,t,r,a,n){return Ln(t),r=ei(e,t,r,a,void 0,n),a=ni(),null===e||Pl?(un&&a&&sn(t),t.flags|=1,Ol(e,t,r,n),t.child):(si(e,t,n),ao(e,t,n))}function Wl(e,t,r,a,n,s){return Ln(t),t.updateQueue=null,r=ri(t,a,r,n),ti(e),a=ni(),null===e||Pl?(un&&a&&sn(t),t.flags|=1,Ol(e,t,r,s),t.child):(si(e,t,s),ao(e,t,s))}function Vl(e,t,r,a,n){if(Ln(t),null===t.stateNode){var s=Da,i=r.contextType;"object"===typeof i&&null!==i&&(s=Pn(i)),s=new r(a,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=vl,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=a,s.state=t.memoizedState,s.refs={},gs(t),i=r.contextType,s.context="object"===typeof i&&null!==i?Pn(i):Da,s.state=t.memoizedState,"function"===typeof(i=r.getDerivedStateFromProps)&&(bl(t,r,i,a),s.state=t.memoizedState),"function"===typeof r.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&vl.enqueueReplaceState(s,s.state,null),ks(t,a,s,n),js(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){s=t.stateNode;var l=t.memoizedProps,o=Nl(r,l);s.props=o;var c=s.context,d=r.contextType;i=Da,"object"===typeof d&&null!==d&&(i=Pn(d));var u=r.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(l||c!==i)&&wl(t,s,a,i),ps=!1;var h=t.memoizedState;s.state=h,ks(t,a,s,n),js(),c=t.memoizedState,l||h!==c||ps?("function"===typeof u&&(bl(t,r,u,a),c=t.memoizedState),(o=ps||yl(t,r,o,a,h,c,i))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),s.props=a,s.state=c,s.context=i,a=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),a=!1)}else{s=t.stateNode,xs(e,t),d=Nl(r,i=t.memoizedProps),s.props=d,u=t.pendingProps,h=s.context,c=r.contextType,o=Da,"object"===typeof c&&null!==c&&(o=Pn(c)),(c="function"===typeof(l=r.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==u||h!==o)&&wl(t,s,a,o),ps=!1,h=t.memoizedState,s.state=h,ks(t,a,s,n),js();var f=t.memoizedState;i!==u||h!==f||ps||null!==e&&null!==e.dependencies&&En(e.dependencies)?("function"===typeof l&&(bl(t,r,l,a),f=t.memoizedState),(d=ps||yl(t,r,d,a,h,f,o)||null!==e&&null!==e.dependencies&&En(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(a,f,o),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(a,f,o)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),s.props=a,s.state=f,s.context=o,a=d):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return s=a,ql(e,t),a=0!==(128&t.flags),s||a?(s=t.stateNode,r=a&&"function"!==typeof r.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&a?(t.child=fs(t,e.child,null,n),t.child=fs(t,null,r,n)):Ol(e,t,r,n),t.memoizedState=s.state,e=t.child):e=ao(e,t,n),e}function Gl(e,t,r,a){return vn(),t.flags|=256,Ol(e,t,r,a),t.child}var Kl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yl(e){return{baseLanes:e,cachePool:$n()}}function Xl(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=Cc),e}function $l(e,t,r){var a,n=t.pendingProps,s=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&Bs.current)),a&&(s=!0,t.flags&=-129),a=0!==(32&t.flags),t.flags&=-33,null===e){if(un){if(s?Fs(t):Rs(),(e=dn)?null!==(e=null!==(e=Eu(e,fn))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==en?{id:tn,overflow:rn}:null,retryLane:536870912,hydrationErrors:null},(r=Wa(e)).return=t,t.child=r,cn=t,dn=null):e=null,null===e)throw pn(t);return Pu(e)?t.lanes=32:t.lanes=536870912,null}var o=n.children;return n=n.fallback,s?(Rs(),o=Ql({mode:"hidden",children:o},s=t.mode),n=qa(n,s,r,null),o.return=t,n.return=t,o.sibling=n,t.child=o,(n=t.child).memoizedState=Yl(r),n.childLanes=Xl(e,a,r),t.memoizedState=Kl,Ml(null,n)):(Fs(t),Jl(t,o))}var c=e.memoizedState;if(null!==c&&null!==(o=c.dehydrated)){if(l)256&t.flags?(Fs(t),t.flags&=-257,t=Zl(e,t,r)):null!==t.memoizedState?(Rs(),t.child=e.child,t.flags|=128,t=null):(Rs(),o=n.fallback,s=t.mode,n=Ql({mode:"visible",children:n.children},s),(o=qa(o,s,r,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,fs(t,e.child,null,r),(n=t.child).memoizedState=Yl(r),n.childLanes=Xl(e,a,r),t.memoizedState=Kl,t=Ml(null,n));else if(Fs(t),Pu(o)){if(a=o.nextSibling&&o.nextSibling.dataset)var d=a.dgst;a=d,(n=Error(i(419))).stack="",n.digest=a,wn({value:n,source:null,stack:null}),t=Zl(e,t,r)}else if(Pl||Tn(e,t,r,!1),a=0!==(r&e.childLanes),Pl||a){if(null!==(a=mc)&&(0!==(n=De(a,r))&&n!==c.retryLane))throw c.retryLane=n,Pa(e,n),Yc(a,e,n),Ll;Lu(o)||id(),t=Zl(e,t,r)}else Lu(o)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,dn=Ou(o.nextSibling),cn=t,un=!0,hn=null,fn=!1,null!==e&&on(t,e),(t=Jl(t,n.children)).flags|=4096);return t}return s?(Rs(),o=n.fallback,s=t.mode,d=(c=e.child).sibling,(n=Ba(c,{mode:"hidden",children:n.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?o=Ba(d,o):(o=qa(o,s,r,null)).flags|=2,o.return=t,n.return=t,n.sibling=o,t.child=n,Ml(null,n),n=t.child,null===(o=e.child.memoizedState)?o=Yl(r):(null!==(s=o.cachePool)?(c=Mn._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=$n(),o={baseLanes:o.baseLanes|r,cachePool:s}),n.memoizedState=o,n.childLanes=Xl(e,a,r),t.memoizedState=Kl,Ml(e.child,n)):(Fs(t),e=(r=e.child).sibling,(r=Ba(r,{mode:"visible",children:n.children})).return=t,r.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=r,t.memoizedState=null,r)}function Jl(e,t){return(t=Ql({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ql(e,t){return(e=Ra(22,e,null,t)).lanes=0,e}function Zl(e,t,r){return fs(t,e.child,null,r),(e=Jl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function eo(e,t,r){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Cn(e.return,t,r)}function to(e,t,r,a,n,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n,treeForkCount:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=r,i.tailMode=n,i.treeForkCount=s)}function ro(e,t,r){var a=t.pendingProps,n=a.revealOrder,s=a.tail;a=a.children;var i=Bs.current,l=0!==(2&i);if(l?(i=1&i|2,t.flags|=128):i&=1,z(Bs,i),Ol(e,t,a,r),a=un?Ja:0,!l&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&eo(e,r,t);else if(19===e.tag)eo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(n){case"forwards":for(r=t.child,n=null;null!==r;)null!==(e=r.alternate)&&null===Us(e)&&(n=r),r=r.sibling;null===(r=n)?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),to(t,!1,n,r,s,a);break;case"backwards":case"unstable_legacy-backwards":for(r=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===Us(e)){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}to(t,!0,r,null,s,a);break;case"together":to(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function ao(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),kc|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(Tn(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Ba(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Ba(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function no(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!En(e))}function so(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)Pl=!0;else{if(!no(e,r)&&0===(128&t.flags))return Pl=!1,function(e,t,r){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),Sn(0,Mn,e.memoizedState.cache),vn();break;case 27:case 5:$(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:Sn(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Ds(t),null;break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(Fs(t),t.flags|=128,null):0!==(r&t.child.childLanes)?$l(e,t,r):(Fs(t),null!==(e=ao(e,t,r))?e.sibling:null);Fs(t);break;case 19:var n=0!==(128&e.flags);if((a=0!==(r&t.childLanes))||(Tn(e,t,r,!1),a=0!==(r&t.childLanes)),n){if(a)return ro(e,t,r);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),z(Bs,Bs.current),a)break;return null;case 22:return t.lanes=0,Rl(e,t,r,t.pendingProps);case 24:Sn(0,Mn,e.memoizedState.cache)}return ao(e,t,r)}(e,t,r);Pl=0!==(131072&e.flags)}else Pl=!1,un&&0!==(1048576&t.flags)&&nn(t,Ja,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=as(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var n=e.$$typeof;if(n===N){t.tag=11,t=Fl(null,t,e,a,r);break e}if(n===S){t.tag=14,t=Dl(null,t,e,a,r);break e}}throw t=P(e)||e,Error(i(306,t,""))}Ma(e)?(a=Nl(e,a),t.tag=1,t=Vl(null,t,e,a,r)):(t.tag=0,t=Hl(null,t,e,a,r))}return t;case 0:return Hl(e,t,t.type,t.pendingProps,r);case 1:return Vl(e,t,a=t.type,n=Nl(a,t.pendingProps),r);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(i(387));a=t.pendingProps;var s=t.memoizedState;n=s.element,xs(e,t),ks(t,a,null,r);var l=t.memoizedState;if(a=l.cache,Sn(0,Mn,a),a!==s.cache&&_n(t,[Mn],r,!0),js(),a=l.element,s.isDehydrated){if(s={element:a,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Gl(e,t,a,r);break e}if(a!==n){wn(n=Ka(Error(i(424)),t)),t=Gl(e,t,a,r);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(dn=Ou(e.firstChild),cn=t,un=!0,hn=null,fn=!0,r=ms(t,null,a,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(vn(),a===n){t=ao(e,t,r);break e}Ol(e,t,a,r)}t=t.child}return t;case 26:return ql(e,t),null===e?(r=Vu(t.type,null,t.pendingProps,null))?t.memoizedState=r:un||(r=t.type,e=t.pendingProps,(a=gu(G.current).createElement(r))[ze]=t,a[qe]=e,hu(a,r,e),et(a),t.stateNode=a):t.memoizedState=Vu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&un&&(a=t.stateNode=Ru(t.type,t.pendingProps,G.current),cn=t,fn=!0,n=dn,Au(t.type)?(Fu=n,dn=Ou(a.firstChild)):dn=n),Ol(e,t,t.pendingProps.children,r),ql(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&un&&((n=a=dn)&&(null!==(a=function(e,t,r,a){for(;1===e.nodeType;){var n=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==n.rel||e.getAttribute("href")!==(null==n.href||""===n.href?null:n.href)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin)||e.getAttribute("title")!==(null==n.title?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==n.src?null:n.src)||e.getAttribute("type")!==(null==n.type?null:n.type)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==n.name?null:""+n.name;if("hidden"===n.type&&e.getAttribute("name")===s)return e}if(null===(e=Ou(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,fn))?(t.stateNode=a,cn=t,dn=Ou(a.firstChild),fn=!1,n=!0):n=!1),n||pn(t)),$(t),n=t.type,s=t.pendingProps,l=null!==e?e.memoizedProps:null,a=s.children,vu(n,s)?a=null:null!==l&&vu(n,l)&&(t.flags|=32),null!==t.memoizedState&&(n=ei(e,t,ai,null,null,r),dh._currentValue=n),ql(e,t),Ol(e,t,a,r),t.child;case 6:return null===e&&un&&((e=r=dn)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=Ou(e.nextSibling)))return null}return e}(r,t.pendingProps,fn))?(t.stateNode=r,cn=t,dn=null,e=!0):e=!1),e||pn(t)),null;case 13:return $l(e,t,r);case 4:return Y(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=fs(t,null,a,r):Ol(e,t,a,r),t.child;case 11:return Fl(e,t,t.type,t.pendingProps,r);case 7:return Ol(e,t,t.pendingProps,r),t.child;case 8:case 12:return Ol(e,t,t.pendingProps.children,r),t.child;case 10:return a=t.pendingProps,Sn(0,t.type,a.value),Ol(e,t,a.children,r),t.child;case 9:return n=t.type._context,a=t.pendingProps.children,Ln(t),a=a(n=Pn(n)),t.flags|=1,Ol(e,t,a,r),t.child;case 14:return Dl(e,t,t.type,t.pendingProps,r);case 15:return Il(e,t,t.type,t.pendingProps,r);case 19:return ro(e,t,r);case 31:return function(e,t,r){var a=t.pendingProps,n=0!==(128&t.flags);if(t.flags&=-129,null===e){if(un){if("hidden"===a.mode)return e=Ul(t,a),t.lanes=536870912,Ml(null,e);if(Ds(t),(e=dn)?null!==(e=null!==(e=Eu(e,fn))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==en?{id:tn,overflow:rn}:null,retryLane:536870912,hydrationErrors:null},(r=Wa(e)).return=t,t.child=r,cn=t,dn=null):e=null,null===e)throw pn(t);return t.lanes=536870912,null}return Ul(t,a)}var s=e.memoizedState;if(null!==s){var l=s.dehydrated;if(Ds(t),n)if(256&t.flags)t.flags&=-257,t=zl(e,t,r);else{if(null===t.memoizedState)throw Error(i(558));t.child=e.child,t.flags|=128,t=null}else if(Pl||Tn(e,t,r,!1),n=0!==(r&e.childLanes),Pl||n){if(null!==(a=mc)&&0!==(l=De(a,r))&&l!==s.retryLane)throw s.retryLane=l,Pa(e,l),Yc(a,e,l),Ll;id(),t=zl(e,t,r)}else e=s.treeContext,dn=Ou(l.nextSibling),cn=t,un=!0,hn=null,fn=!1,null!==e&&on(t,e),(t=Ul(t,a)).flags|=4096;return t}return(e=Ba(e.child,{mode:a.mode,children:a.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,r);case 22:return Rl(e,t,r,t.pendingProps);case 24:return Ln(t),a=Pn(Mn),null===e?(null===(n=Yn())&&(n=mc,s=Bn(),n.pooledCache=s,s.refCount++,null!==s&&(n.pooledCacheLanes|=r),n=s),t.memoizedState={parent:a,cache:n},gs(t),Sn(0,Mn,n)):(0!==(e.lanes&r)&&(xs(e,t),ks(t,null,null,r),js()),n=e.memoizedState,s=t.memoizedState,n.parent!==a?(n={parent:a,cache:a},t.memoizedState=n,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=n),Sn(0,Mn,a)):(a=s.cache,Sn(0,Mn,a),a!==n.cache&&_n(t,[Mn],r,!0))),Ol(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function io(e){e.flags|=4}function lo(e,t,r,a,n){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&n)===n)if(e.stateNode.complete)e.flags|=8192;else{if(!ad())throw ns=es,Qn;e.flags|=8192}}else e.flags&=-16777217}function oo(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!nh(t)){if(!ad())throw ns=es,Qn;e.flags|=8192}}function co(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ee():536870912,e.lanes|=t,_c|=t)}function uo(e,t){if(!un)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;null!==r;)null!==r.alternate&&(a=r),r=r.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function ho(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,a=0;if(t)for(var n=e.child;null!==n;)r|=n.lanes|n.childLanes,a|=65011712&n.subtreeFlags,a|=65011712&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function fo(e,t,r){var a=t.pendingProps;switch(ln(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ho(t),null;case 3:return r=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),An(Mn),X(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(bn(t)?io(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,yn())),ho(t),null;case 26:var n=t.type,s=t.memoizedState;return null===e?(io(t),null!==s?(ho(t),oo(t,s)):(ho(t),lo(t,n,0,0,r))):s?s!==e.memoizedState?(io(t),ho(t),oo(t,s)):(ho(t),t.flags&=-16777217):((e=e.memoizedProps)!==a&&io(t),ho(t),lo(t,n,0,0,r)),null;case 27:if(J(t),r=G.current,n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&io(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return ho(t),null}e=W.current,bn(t)?gn(t):(e=Ru(n,a,r),t.stateNode=e,io(t))}return ho(t),null;case 5:if(J(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&io(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return ho(t),null}if(s=W.current,bn(t))gn(t);else{var l=gu(G.current);switch(s){case 1:s=l.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:s=l.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":s=l.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":s=l.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(s=l.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof a.is?l.createElement("select",{is:a.is}):l.createElement("select"),a.multiple?s.multiple=!0:a.size&&(s.size=a.size);break;default:s="string"===typeof a.is?l.createElement(n,{is:a.is}):l.createElement(n)}}s[ze]=t,s[qe]=a;e:for(l=t.child;null!==l;){if(5===l.tag||6===l.tag)s.appendChild(l.stateNode);else if(4!==l.tag&&27!==l.tag&&null!==l.child){l.child.return=l,l=l.child;continue}if(l===t)break e;for(;null===l.sibling;){if(null===l.return||l.return===t)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}t.stateNode=s;e:switch(hu(s,n,a),n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&io(t)}}return ho(t),lo(t,t.type,null===e||e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&io(t);else{if("string"!==typeof a&&null===t.stateNode)throw Error(i(166));if(e=G.current,bn(t)){if(e=t.stateNode,r=t.memoizedProps,a=null,null!==(n=cn))switch(n.tag){case 27:case 5:a=n.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===r||null!==a&&!0===a.suppressHydrationWarning||cu(e.nodeValue,r)))||pn(t,!0)}else(e=gu(e).createTextNode(a))[ze]=t,t.stateNode=e}return ho(t),null;case 31:if(r=t.memoizedState,null===e||null!==e.memoizedState){if(a=bn(t),null!==r){if(null===e){if(!a)throw Error(i(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(i(557));e[ze]=t}else vn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ho(t),e=!1}else r=yn(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return 256&t.flags?(Ms(t),t):(Ms(t),null);if(0!==(128&t.flags))throw Error(i(558))}return ho(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(n=bn(t),null!==a&&null!==a.dehydrated){if(null===e){if(!n)throw Error(i(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(i(317));n[ze]=t}else vn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ho(t),n=!1}else n=yn(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),n=!0;if(!n)return 256&t.flags?(Ms(t),t):(Ms(t),null)}return Ms(t),0!==(128&t.flags)?(t.lanes=r,t):(r=null!==a,e=null!==e&&null!==e.memoizedState,r&&(n=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(n=a.alternate.memoizedState.cachePool.pool),s=null,null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(s=a.memoizedState.cachePool.pool),s!==n&&(a.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),co(t,t.updateQueue),ho(t),null);case 4:return X(),null===e&&Zd(t.stateNode.containerInfo),ho(t),null;case 10:return An(t.type),ho(t),null;case 19:if(U(Bs),null===(a=t.memoizedState))return ho(t),null;if(n=0!==(128&t.flags),null===(s=a.rendering))if(n)uo(a,!1);else{if(0!==jc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Us(e))){for(t.flags|=128,uo(a,!1),e=s.updateQueue,t.updateQueue=e,co(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)Ua(r,e),r=r.sibling;return z(Bs,1&Bs.current|2),un&&an(t,a.treeForkCount),t.child}e=e.sibling}null!==a.tail&&oe()>Fc&&(t.flags|=128,n=!0,uo(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=Us(s))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,co(t,e),uo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!s.alternate&&!un)return ho(t),null}else 2*oe()-a.renderingStartTime>Fc&&536870912!==r&&(t.flags|=128,n=!0,uo(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=a.last)?e.sibling=s:t.child=s,a.last=s)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=oe(),e.sibling=null,r=Bs.current,z(Bs,n?1&r|2:1&r),un&&an(t,a.treeForkCount),e):(ho(t),null);case 22:case 23:return Ms(t),Ls(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?0!==(536870912&r)&&0===(128&t.flags)&&(ho(t),6&t.subtreeFlags&&(t.flags|=8192)):ho(t),null!==(r=t.updateQueue)&&co(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==r&&(t.flags|=2048),null!==e&&U(Kn),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),An(Mn),ho(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function mo(e,t){switch(ln(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return An(Mn),X(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(Ms(t),null===t.alternate)throw Error(i(340));vn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Ms(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));vn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(Bs),null;case 4:return X(),null;case 10:return An(t.type),null;case 22:case 23:return Ms(t),Ls(),null!==e&&U(Kn),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return An(Mn),null;default:return null}}function po(e,t){switch(ln(t),t.tag){case 3:An(Mn),X();break;case 26:case 27:case 5:J(t);break;case 4:X();break;case 31:null!==t.memoizedState&&Ms(t);break;case 13:Ms(t);break;case 19:U(Bs);break;case 10:An(t.type);break;case 22:case 23:Ms(t),Ls(),null!==e&&U(Kn);break;case 24:An(Mn)}}function go(e,t){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var n=a.next;r=n;do{if((r.tag&e)===e){a=void 0;var s=r.create,i=r.inst;a=s(),i.destroy=a}r=r.next}while(r!==n)}}catch(l){jd(t,t.return,l)}}function xo(e,t,r){try{var a=t.updateQueue,n=null!==a?a.lastEffect:null;if(null!==n){var s=n.next;a=s;do{if((a.tag&e)===e){var i=a.inst,l=i.destroy;if(void 0!==l){i.destroy=void 0,n=t;var o=r,c=l;try{c()}catch(d){jd(n,o,d)}}}a=a.next}while(a!==s)}}catch(d){jd(t,t.return,d)}}function bo(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{As(t,r)}catch(a){jd(e,e.return,a)}}}function vo(e,t,r){r.props=Nl(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(a){jd(e,t,a)}}function yo(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"===typeof r?e.refCleanup=r(a):r.current=a}}catch(n){jd(e,t,n)}}function wo(e,t){var r=e.ref,a=e.refCleanup;if(null!==r)if("function"===typeof a)try{a()}catch(n){jd(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof r)try{r(null)}catch(s){jd(e,t,s)}else r.current=null}function No(e){var t=e.type,r=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&a.focus();break e;case"img":r.src?a.src=r.src:r.srcSet&&(a.srcset=r.srcSet)}}catch(n){jd(e,e.return,n)}}function jo(e,t,r){try{var a=e.stateNode;!function(e,t,r,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,s=null,l=null,o=null,c=null,d=null,u=null;for(m in r){var h=r[m];if(r.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:a.hasOwnProperty(m)||du(e,t,m,null,a,h)}}for(var f in a){var m=a[f];if(h=r[f],a.hasOwnProperty(f)&&(null!=m||null!=h))switch(f){case"type":s=m;break;case"name":n=m;break;case"checked":d=m;break;case"defaultChecked":u=m;break;case"value":l=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:m!==h&&du(e,t,f,m,a,h)}}return void bt(e,l,o,c,d,u,s,n);case"select":for(s in m=l=o=f=null,r)if(c=r[s],r.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":m=c;default:a.hasOwnProperty(s)||du(e,t,s,null,a,c)}for(n in a)if(s=a[n],c=r[n],a.hasOwnProperty(n)&&(null!=s||null!=c))switch(n){case"value":f=s;break;case"defaultValue":o=s;break;case"multiple":l=s;default:s!==c&&du(e,t,n,s,a,c)}return t=o,r=l,a=m,void(null!=f?wt(e,!!r,f,!1):!!a!==!!r&&(null!=t?wt(e,!!r,t,!0):wt(e,!!r,r?[]:"",!1)));case"textarea":for(o in m=f=null,r)if(n=r[o],r.hasOwnProperty(o)&&null!=n&&!a.hasOwnProperty(o))switch(o){case"value":case"children":break;default:du(e,t,o,null,a,n)}for(l in a)if(n=a[l],s=r[l],a.hasOwnProperty(l)&&(null!=n||null!=s))switch(l){case"value":f=n;break;case"defaultValue":m=n;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=n)throw Error(i(91));break;default:n!==s&&du(e,t,l,n,a,s)}return void Nt(e,f,m);case"option":for(var p in r)if(f=r[p],r.hasOwnProperty(p)&&null!=f&&!a.hasOwnProperty(p))if("selected"===p)e.selected=!1;else du(e,t,p,null,a,f);for(c in a)if(f=a[c],m=r[c],a.hasOwnProperty(c)&&f!==m&&(null!=f||null!=m))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else du(e,t,c,f,a,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)f=r[g],r.hasOwnProperty(g)&&null!=f&&!a.hasOwnProperty(g)&&du(e,t,g,null,a,f);for(d in a)if(f=a[d],m=r[d],a.hasOwnProperty(d)&&f!==m&&(null!=f||null!=m))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(i(137,t));break;default:du(e,t,d,f,a,m)}return;default:if(_t(t)){for(var x in r)f=r[x],r.hasOwnProperty(x)&&void 0!==f&&!a.hasOwnProperty(x)&&uu(e,t,x,void 0,a,f);for(u in a)f=a[u],m=r[u],!a.hasOwnProperty(u)||f===m||void 0===f&&void 0===m||uu(e,t,u,f,a,m);return}}for(var b in r)f=r[b],r.hasOwnProperty(b)&&null!=f&&!a.hasOwnProperty(b)&&du(e,t,b,null,a,f);for(h in a)f=a[h],m=r[h],!a.hasOwnProperty(h)||f===m||null==f&&null==m||du(e,t,h,f,a,m)}(a,e.type,r,t),a[qe]=t}catch(n){jd(e,e.return,n)}}function ko(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Au(e.type)||4===e.tag}function So(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ko(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Au(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ao(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Pt));else if(4!==a&&(27===a&&Au(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(Ao(e,t,r),e=e.sibling;null!==e;)Ao(e,t,r),e=e.sibling}function Co(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==a&&(27===a&&Au(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(Co(e,t,r),e=e.sibling;null!==e;)Co(e,t,r),e=e.sibling}function _o(e){var t=e.stateNode,r=e.memoizedProps;try{for(var a=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);hu(t,a,r),t[ze]=e,t[qe]=r}catch(s){jd(e,e.return,s)}}var To=!1,Eo=!1,Lo=!1,Po="function"===typeof WeakSet?WeakSet:Set,Oo=null;function Fo(e,t,r){var a=r.flags;switch(r.tag){case 0:case 11:case 15:Yo(e,r),4&a&&go(5,r);break;case 1:if(Yo(e,r),4&a)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(i){jd(r,r.return,i)}else{var n=Nl(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){jd(r,r.return,l)}}64&a&&bo(r),512&a&&yo(r,r.return);break;case 3:if(Yo(e,r),64&a&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{As(e,t)}catch(i){jd(r,r.return,i)}}break;case 27:null===t&&4&a&&_o(r);case 26:case 5:Yo(e,r),null===t&&4&a&&No(r),512&a&&yo(r,r.return);break;case 12:Yo(e,r);break;case 31:Yo(e,r),4&a&&Uo(e,r);break;case 13:Yo(e,r),4&a&&zo(e,r),64&a&&(null!==(e=r.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==r.readyState)t();else{var a=function(){t(),r.removeEventListener("DOMContentLoaded",a)};r.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,r=Cd.bind(null,r))));break;case 22:if(!(a=null!==r.memoizedState||To)){t=null!==t&&null!==t.memoizedState||Eo,n=To;var s=Eo;To=a,(Eo=t)&&!s?$o(e,r,0!==(8772&r.subtreeFlags)):Yo(e,r),To=n,Eo=s}break;case 30:break;default:Yo(e,r)}}function Do(e){var t=e.alternate;null!==t&&(e.alternate=null,Do(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Io=null,Ro=!1;function Mo(e,t,r){for(r=r.child;null!==r;)Bo(e,t,r),r=r.sibling}function Bo(e,t,r){if(be&&"function"===typeof be.onCommitFiberUnmount)try{be.onCommitFiberUnmount(xe,r)}catch(s){}switch(r.tag){case 26:Eo||wo(r,t),Mo(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:Eo||wo(r,t);var a=Io,n=Ro;Au(r.type)&&(Io=r.stateNode,Ro=!1),Mo(e,t,r),Mu(r.stateNode),Io=a,Ro=n;break;case 5:Eo||wo(r,t);case 6:if(a=Io,n=Ro,Io=null,Mo(e,t,r),Ro=n,null!==(Io=a))if(Ro)try{(9===Io.nodeType?Io.body:"HTML"===Io.nodeName?Io.ownerDocument.body:Io).removeChild(r.stateNode)}catch(i){jd(r,t,i)}else try{Io.removeChild(r.stateNode)}catch(i){jd(r,t,i)}break;case 18:null!==Io&&(Ro?(Cu(9===(e=Io).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),Wh(e)):Cu(Io,r.stateNode));break;case 4:a=Io,n=Ro,Io=r.stateNode.containerInfo,Ro=!0,Mo(e,t,r),Io=a,Ro=n;break;case 0:case 11:case 14:case 15:xo(2,r,t),Eo||xo(4,r,t),Mo(e,t,r);break;case 1:Eo||(wo(r,t),"function"===typeof(a=r.stateNode).componentWillUnmount&&vo(r,t,a)),Mo(e,t,r);break;case 21:Mo(e,t,r);break;case 22:Eo=(a=Eo)||null!==r.memoizedState,Mo(e,t,r),Eo=a;break;default:Mo(e,t,r)}}function Uo(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wh(e)}catch(r){jd(t,t.return,r)}}}function zo(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wh(e)}catch(r){jd(t,t.return,r)}}function qo(e,t){var r=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Po),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Po),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){if(!r.has(t)){r.add(t);var a=_d.bind(null,e,t);t.then(a,a)}})}function Ho(e,t){var r=t.deletions;if(null!==r)for(var a=0;a<r.length;a++){var n=r[a],s=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 27:if(Au(o.type)){Io=o.stateNode,Ro=!1;break e}break;case 5:Io=o.stateNode,Ro=!1;break e;case 3:case 4:Io=o.stateNode.containerInfo,Ro=!0;break e}o=o.return}if(null===Io)throw Error(i(160));Bo(s,l,n),Io=null,Ro=!1,null!==(s=n.alternate)&&(s.return=null),n.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Vo(t,e),t=t.sibling}var Wo=null;function Vo(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ho(t,e),Go(e),4&a&&(xo(3,e,e.return),go(3,e),xo(5,e,e.return));break;case 1:Ho(t,e),Go(e),512&a&&(Eo||null===r||wo(r,r.return)),64&a&&To&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?a:r.concat(a))));break;case 26:var n=Wo;if(Ho(t,e),Go(e),512&a&&(Eo||null===r||wo(r,r.return)),4&a){var s=null!==r?r.memoizedState:null;if(a=e.memoizedState,null===r)if(null===a)if(null===e.stateNode){e:{a=e.type,r=e.memoizedProps,n=n.ownerDocument||n;t:switch(a){case"title":(!(s=n.getElementsByTagName("title")[0])||s[Ye]||s[ze]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=n.createElement(a),n.head.insertBefore(s,n.querySelector("head > title"))),hu(s,a,r),s[ze]=e,et(s),a=s;break e;case"link":var l=rh("link","href",n).get(a+(r.href||""));if(l)for(var o=0;o<l.length;o++)if((s=l[o]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&s.getAttribute("rel")===(null==r.rel?null:r.rel)&&s.getAttribute("title")===(null==r.title?null:r.title)&&s.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){l.splice(o,1);break t}hu(s=n.createElement(a),a,r),n.head.appendChild(s);break;case"meta":if(l=rh("meta","content",n).get(a+(r.content||"")))for(o=0;o<l.length;o++)if((s=l[o]).getAttribute("content")===(null==r.content?null:""+r.content)&&s.getAttribute("name")===(null==r.name?null:r.name)&&s.getAttribute("property")===(null==r.property?null:r.property)&&s.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&s.getAttribute("charset")===(null==r.charSet?null:r.charSet)){l.splice(o,1);break t}hu(s=n.createElement(a),a,r),n.head.appendChild(s);break;default:throw Error(i(468,a))}s[ze]=e,et(s),a=s}e.stateNode=a}else ah(n,e.type,e.stateNode);else e.stateNode=Ju(n,a,e.memoizedProps);else s!==a?(null===s?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):s.count--,null===a?ah(n,e.type,e.stateNode):Ju(n,a,e.memoizedProps)):null===a&&null!==e.stateNode&&jo(e,e.memoizedProps,r.memoizedProps)}break;case 27:Ho(t,e),Go(e),512&a&&(Eo||null===r||wo(r,r.return)),null!==r&&4&a&&jo(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Ho(t,e),Go(e),512&a&&(Eo||null===r||wo(r,r.return)),32&e.flags){n=e.stateNode;try{kt(n,"")}catch(p){jd(e,e.return,p)}}4&a&&null!=e.stateNode&&jo(e,n=e.memoizedProps,null!==r?r.memoizedProps:n),1024&a&&(Lo=!0);break;case 6:if(Ho(t,e),Go(e),4&a){if(null===e.stateNode)throw Error(i(162));a=e.memoizedProps,r=e.stateNode;try{r.nodeValue=a}catch(p){jd(e,e.return,p)}}break;case 3:if(th=null,n=Wo,Wo=zu(t.containerInfo),Ho(t,e),Wo=n,Go(e),4&a&&null!==r&&r.memoizedState.isDehydrated)try{Wh(t.containerInfo)}catch(p){jd(e,e.return,p)}Lo&&(Lo=!1,Ko(e));break;case 4:a=Wo,Wo=zu(e.stateNode.containerInfo),Ho(t,e),Go(e),Wo=a;break;case 12:default:Ho(t,e),Go(e);break;case 31:case 19:Ho(t,e),Go(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,qo(e,a)));break;case 13:Ho(t,e),Go(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==r&&null!==r.memoizedState)&&(Pc=oe()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,qo(e,a)));break;case 22:n=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,d=To,u=Eo;if(To=d||n,Eo=u||c,Ho(t,e),Eo=u,To=d,Go(e),8192&a)e:for(t=e.stateNode,t._visibility=n?-2&t._visibility:1|t._visibility,n&&(null===r||c||To||Eo||Xo(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(s=c.stateNode,n)"function"===typeof(l=s.style).setProperty?l.setProperty("display","none","important"):l.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;o.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){jd(c,c.return,p)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=n?"":c.memoizedProps}catch(p){jd(c,c.return,p)}}}else if(18===t.tag){if(null===r){c=t;try{var m=c.stateNode;n?_u(m,!0):_u(c.stateNode,!1)}catch(p){jd(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(r=a.retryQueue)&&(a.retryQueue=null,qo(e,r))));case 30:case 21:}}function Go(e){var t=e.flags;if(2&t){try{for(var r,a=e.return;null!==a;){if(ko(a)){r=a;break}a=a.return}if(null==r)throw Error(i(160));switch(r.tag){case 27:var n=r.stateNode;Co(e,So(e),n);break;case 5:var s=r.stateNode;32&r.flags&&(kt(s,""),r.flags&=-33),Co(e,So(e),s);break;case 3:case 4:var l=r.stateNode.containerInfo;Ao(e,So(e),l);break;default:throw Error(i(161))}}catch(o){jd(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ko(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ko(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yo(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Fo(e,t.alternate,t),t=t.sibling}function Xo(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:xo(4,t,t.return),Xo(t);break;case 1:wo(t,t.return);var r=t.stateNode;"function"===typeof r.componentWillUnmount&&vo(t,t.return,r),Xo(t);break;case 27:Mu(t.stateNode);case 26:case 5:wo(t,t.return),Xo(t);break;case 22:null===t.memoizedState&&Xo(t);break;default:Xo(t)}e=e.sibling}}function $o(e,t,r){for(r=r&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,n=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:$o(n,s,r),go(4,s);break;case 1:if($o(n,s,r),"function"===typeof(n=(a=s).stateNode).componentDidMount)try{n.componentDidMount()}catch(c){jd(a,a.return,c)}if(null!==(n=(a=s).updateQueue)){var l=a.stateNode;try{var o=n.shared.hiddenCallbacks;if(null!==o)for(n.shared.hiddenCallbacks=null,n=0;n<o.length;n++)Ss(o[n],l)}catch(c){jd(a,a.return,c)}}r&&64&i&&bo(s),yo(s,s.return);break;case 27:_o(s);case 26:case 5:$o(n,s,r),r&&null===a&&4&i&&No(s),yo(s,s.return);break;case 12:$o(n,s,r);break;case 31:$o(n,s,r),r&&4&i&&Uo(n,s);break;case 13:$o(n,s,r),r&&4&i&&zo(n,s);break;case 22:null===s.memoizedState&&$o(n,s,r),yo(s,s.return);break;case 30:break;default:$o(n,s,r)}t=t.sibling}}function Jo(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Un(r))}function Qo(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Un(e))}function Zo(e,t,r,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,r,a),t=t.sibling}function ec(e,t,r,a){var n=t.flags;switch(t.tag){case 0:case 11:case 15:Zo(e,t,r,a),2048&n&&go(9,t);break;case 1:case 31:case 13:default:Zo(e,t,r,a);break;case 3:Zo(e,t,r,a),2048&n&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Un(e)));break;case 12:if(2048&n){Zo(e,t,r,a),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,l=s.onPostCommit;"function"===typeof l&&l(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(o){jd(t,t.return,o)}}else Zo(e,t,r,a);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Zo(e,t,r,a):rc(e,t):2&s._visibility?Zo(e,t,r,a):(s._visibility|=2,tc(e,t,r,a,0!==(10256&t.subtreeFlags)||!1)),2048&n&&Jo(i,t);break;case 24:Zo(e,t,r,a),2048&n&&Qo(t.alternate,t)}}function tc(e,t,r,a,n){for(n=n&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,i=t,l=r,o=a,c=i.flags;switch(i.tag){case 0:case 11:case 15:tc(s,i,l,o,n),go(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?tc(s,i,l,o,n):rc(s,i):(d._visibility|=2,tc(s,i,l,o,n)),n&&2048&c&&Jo(i.alternate,i);break;case 24:tc(s,i,l,o,n),n&&2048&c&&Qo(i.alternate,i);break;default:tc(s,i,l,o,n)}t=t.sibling}}function rc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,a=t,n=a.flags;switch(a.tag){case 22:rc(r,a),2048&n&&Jo(a.alternate,a);break;case 24:rc(r,a),2048&n&&Qo(a.alternate,a);break;default:rc(r,a)}t=t.sibling}}var ac=8192;function nc(e,t,r){if(e.subtreeFlags&ac)for(e=e.child;null!==e;)sc(e,t,r),e=e.sibling}function sc(e,t,r){switch(e.tag){case 26:nc(e,t,r),e.flags&ac&&null!==e.memoizedState&&function(e,t,r,a){if("stylesheet"===r.type&&("string"!==typeof a.media||!1!==matchMedia(a.media).matches)&&0===(4&r.state.loading)){if(null===r.instance){var n=Gu(a.href),s=t.querySelector(Ku(n));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ih.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=s,void et(s);s=t.ownerDocument||t,a=Yu(a),(n=Bu.get(n))&&Zu(a,n),et(s=s.createElement("link"));var i=s;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),hu(s,"link",a),r.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&0===(3&r.state.loading)&&(e.count++,r=ih.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}(r,Wo,e.memoizedState,e.memoizedProps);break;case 5:default:nc(e,t,r);break;case 3:case 4:var a=Wo;Wo=zu(e.stateNode.containerInfo),nc(e,t,r),Wo=a;break;case 22:null===e.memoizedState&&(null!==(a=e.alternate)&&null!==a.memoizedState?(a=ac,ac=16777216,nc(e,t,r),ac=a):nc(e,t,r))}}function ic(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function lc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var a=t[r];Oo=a,dc(a,e)}ic(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)oc(e),e=e.sibling}function oc(e){switch(e.tag){case 0:case 11:case 15:lc(e),2048&e.flags&&xo(9,e,e.return);break;case 3:case 12:default:lc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):lc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var a=t[r];Oo=a,dc(a,e)}ic(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:xo(8,t,t.return),cc(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function dc(e,t){for(;null!==Oo;){var r=Oo;switch(r.tag){case 0:case 11:case 15:xo(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var a=r.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:Un(r.memoizedState.cache)}if(null!==(a=r.child))a.return=r,Oo=a;else e:for(r=e;null!==Oo;){var n=(a=Oo).sibling,s=a.return;if(Do(a),a===r){Oo=null;break e}if(null!==n){n.return=s,Oo=n;break e}Oo=s}}}var uc={getCacheForType:function(e){var t=Pn(Mn),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Pn(Mn).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,fc=0,mc=null,pc=null,gc=0,xc=0,bc=null,vc=!1,yc=!1,wc=!1,Nc=0,jc=0,kc=0,Sc=0,Ac=0,Cc=0,_c=0,Tc=null,Ec=null,Lc=!1,Pc=0,Oc=0,Fc=1/0,Dc=null,Ic=null,Rc=0,Mc=null,Bc=null,Uc=0,zc=0,qc=null,Hc=null,Wc=0,Vc=null;function Gc(){return 0!==(2&fc)&&0!==gc?gc&-gc:null!==F.T?qd():Me()}function Kc(){if(0===Cc)if(0===(536870912&gc)||un){var e=ke;0===(3932160&(ke<<=1))&&(ke=262144),Cc=e}else Cc=536870912;return null!==(e=Ps.current)&&(e.flags|=32),Cc}function Yc(e,t,r){(e!==mc||2!==xc&&9!==xc)&&null===e.cancelPendingCommit||(td(e,0),Qc(e,gc,Cc,!1)),Pe(e,r),0!==(2&fc)&&e===mc||(e===mc&&(0===(2&fc)&&(Sc|=r),4===jc&&Qc(e,gc,Cc,!1)),Dd(e))}function Xc(e,t,r){if(0!==(6&fc))throw Error(i(327));for(var a=!r&&0===(127&t)&&0===(t&e.expiredLanes)||_e(e,t),n=a?function(e,t){var r=fc;fc|=2;var a=nd(),n=sd();mc!==e||gc!==t?(Dc=null,Fc=oe()+500,td(e,t)):yc=_e(e,t);e:for(;;)try{if(0!==xc&&null!==pc){t=pc;var s=bc;t:switch(xc){case 1:xc=0,bc=null,hd(e,t,s,1);break;case 2:case 9:if(ts(s)){xc=0,bc=null,ud(t);break}t=function(){2!==xc&&9!==xc||mc!==e||(xc=7),Dd(e)},s.then(t,t);break e;case 3:xc=7;break e;case 4:xc=5;break e;case 7:ts(s)?(xc=0,bc=null,ud(t)):(xc=0,bc=null,hd(e,t,s,7));break;case 5:var l=null;switch(pc.tag){case 26:l=pc.memoizedState;case 5:case 27:var o=pc;if(l?nh(l):o.stateNode.complete){xc=0,bc=null;var c=o.sibling;if(null!==c)pc=c;else{var d=o.return;null!==d?(pc=d,fd(d)):pc=null}break t}}xc=0,bc=null,hd(e,t,s,5);break;case 6:xc=0,bc=null,hd(e,t,s,6);break;case 8:ed(),jc=6;break e;default:throw Error(i(462))}}cd();break}catch(u){rd(e,u)}return kn=jn=null,F.H=a,F.A=n,fc=r,null!==pc?0:(mc=null,gc=0,Ta(),jc)}(e,t):ld(e,t,!0),s=a;;){if(0===n){yc&&!a&&Qc(e,t,0,!1);break}if(r=e.current.alternate,!s||Jc(r)){if(2===n){if(s=t,e.errorRecoveryDisabledLanes&s)var l=0;else l=0!==(l=-536870913&e.pendingLanes)?l:536870912&l?536870912:0;if(0!==l){t=l;e:{var o=e;n=Tc;var c=o.current.memoizedState.isDehydrated;if(c&&(td(o,l).flags|=256),2!==(l=ld(o,l,!1))){if(wc&&!c){o.errorRecoveryDisabledLanes|=s,Sc|=s,n=4;break e}s=Ec,Ec=n,null!==s&&(null===Ec?Ec=s:Ec.push.apply(Ec,s))}n=l}if(s=!1,2!==n)continue}}if(1===n){td(e,0),Qc(e,t,0,!0);break}e:{switch(a=e,s=n){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Qc(a,t,Cc,!vc);break e;case 2:Ec=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(n=Pc+300-oe())){if(Qc(a,t,Cc,!vc),0!==Ce(a,0,!0))break e;Uc=t,a.timeoutHandle=wu($c.bind(null,a,r,Ec,Dc,Lc,t,Cc,Sc,_c,vc,s,"Throttled",-0,0),n)}else $c(a,r,Ec,Dc,Lc,t,Cc,Sc,_c,vc,s,null,-0,0)}break}n=ld(e,t,!1),s=!1}Dd(e)}function $c(e,t,r,a,n,s,i,l,o,c,d,u,h,f){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||16785408===(16785408&u)){sc(t,s,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pt});var m=(62914560&s)===s?Pc-oe():(4194048&s)===s?Oc-oe():0;if(m=function(e,t){return e.stylesheets&&0===e.count&&oh(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var a=setTimeout(function(){if(e.stylesheets&&oh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sh&&(sh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,r=performance.getEntriesByType("resource"),a=0;a<r.length;a++){var n=r[a],s=n.transferSize,i=n.initiatorType,l=n.duration;if(s&&l&&fu(i)){for(i=0,l=n.responseEnd,a+=1;a<r.length;a++){var o=r[a],c=o.startTime;if(c>l)break;var d=o.transferSize,u=o.initiatorType;d&&fu(u)&&(i+=d*((o=o.responseEnd)<l?1:(l-c)/(o-c)))}if(--a,t+=8*(s+i)/(n.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var n=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&oh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sh?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(n)}}:null}(u,m),null!==m)return Uc=s,e.cancelPendingCommit=m(pd.bind(null,e,t,s,r,a,n,i,l,o,d,u,null,h,f)),void Qc(e,s,i,!c)}pd(e,t,s,r,a,n,i,l,o)}function Jc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var a=0;a<r.length;a++){var n=r[a],s=n.getSnapshot;n=n.value;try{if(!Jr(s(),n))return!1}catch(i){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qc(e,t,r,a){t&=~Ac,t&=~Sc,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var n=t;0<n;){var s=31-ye(n),i=1<<s;a[s]=-1,n&=~i}0!==r&&Oe(e,r,t)}function Zc(){return 0!==(6&fc)||(Id(0,!1),!1)}function ed(){if(null!==pc){if(0===xc)var e=pc.return;else kn=jn=null,ii(e=pc),ls=null,os=0,e=pc;for(;null!==e;)po(e.alternate,e),e=e.return;pc=null}}function td(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,Nu(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Uc=0,ed(),mc=e,pc=r=Ba(e.current,null),gc=t,xc=0,bc=null,vc=!1,yc=_e(e,t),wc=!1,_c=Cc=Ac=Sc=kc=jc=0,Ec=Tc=null,Lc=!1,0!==(8&t)&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var n=31-ye(a),s=1<<n;t|=e[n],a&=~s}return Nc=t,Ta(),r}function rd(e,t){qs=null,F.H=ml,t===Jn||t===Zn?(t=ss(),xc=3):t===Qn?(t=ss(),xc=4):xc=t===Ll?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,bc=t,null===pc&&(jc=1,Al(e,Ka(t,e.current)))}function ad(){var e=Ps.current;return null===e||((4194048&gc)===gc?null===Os:((62914560&gc)===gc||0!==(536870912&gc))&&e===Os)}function nd(){var e=F.H;return F.H=ml,null===e?ml:e}function sd(){var e=F.A;return F.A=uc,e}function id(){jc=4,vc||(4194048&gc)!==gc&&null!==Ps.current||(yc=!0),0===(134217727&kc)&&0===(134217727&Sc)||null===mc||Qc(mc,gc,Cc,!1)}function ld(e,t,r){var a=fc;fc|=2;var n=nd(),s=sd();mc===e&&gc===t||(Dc=null,td(e,t)),t=!1;var i=jc;e:for(;;)try{if(0!==xc&&null!==pc){var l=pc,o=bc;switch(xc){case 8:ed(),i=6;break e;case 3:case 2:case 9:case 6:null===Ps.current&&(t=!0);var c=xc;if(xc=0,bc=null,hd(e,l,o,c),r&&yc){i=0;break e}break;default:c=xc,xc=0,bc=null,hd(e,l,o,c)}}od(),i=jc;break}catch(d){rd(e,d)}return t&&e.shellSuspendCounter++,kn=jn=null,fc=a,F.H=n,F.A=s,null===pc&&(mc=null,gc=0,Ta()),i}function od(){for(;null!==pc;)dd(pc)}function cd(){for(;null!==pc&&!ie();)dd(pc)}function dd(e){var t=so(e.alternate,e,Nc);e.memoizedProps=e.pendingProps,null===t?fd(e):pc=t}function ud(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Wl(r,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Wl(r,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:ii(t);default:po(r,t),t=so(r,t=pc=Ua(t,Nc),Nc)}e.memoizedProps=e.pendingProps,null===t?fd(e):pc=t}function hd(e,t,r,a){kn=jn=null,ii(t),ls=null,os=0;var n=t.return;try{if(function(e,t,r,a,n){if(r.flags|=32768,null!==a&&"object"===typeof a&&"function"===typeof a.then){if(null!==(t=r.alternate)&&Tn(t,r,n,!0),null!==(r=Ps.current)){switch(r.tag){case 31:case 13:return null===Os?id():null===r.alternate&&0===jc&&(jc=3),r.flags&=-257,r.flags|=65536,r.lanes=n,a===es?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([a]):t.add(a),kd(e,a,n)),!1;case 22:return r.flags|=65536,a===es?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([a]):r.add(a),kd(e,a,n)),!1}throw Error(i(435,r.tag))}return kd(e,a,n),id(),!1}if(un)return null!==(t=Ps.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=n,a!==mn&&wn(Ka(e=Error(i(422),{cause:a}),r))):(a!==mn&&wn(Ka(t=Error(i(423),{cause:a}),r)),(e=e.current.alternate).flags|=65536,n&=-n,e.lanes|=n,a=Ka(a,r),ws(e,n=_l(e.stateNode,a,n)),4!==jc&&(jc=2)),!1;var s=Error(i(520),{cause:a});if(s=Ka(s,r),null===Tc?Tc=[s]:Tc.push(s),4!==jc&&(jc=2),null===t)return!0;a=Ka(a,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=n&-n,r.lanes|=e,ws(r,e=_l(r.stateNode,a,e)),!1;case 1:if(t=r.type,s=r.stateNode,0===(128&r.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Ic||!Ic.has(s))))return r.flags|=65536,n&=-n,r.lanes|=n,El(n=Tl(n),e,r,a),ws(r,n),!1}r=r.return}while(null!==r);return!1}(e,n,t,r,gc))return jc=1,Al(e,Ka(r,e.current)),void(pc=null)}catch(s){if(null!==n)throw pc=n,s;return jc=1,Al(e,Ka(r,e.current)),void(pc=null)}32768&t.flags?(un||1===a?e=!0:yc||0!==(536870912&gc)?e=!1:(vc=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=Ps.current)&&13===a.tag&&(a.flags|=16384))),md(t,e)):fd(t)}function fd(e){var t=e;do{if(0!==(32768&t.flags))return void md(t,vc);e=t.return;var r=fo(t.alternate,t,Nc);if(null!==r)return void(pc=r);if(null!==(t=t.sibling))return void(pc=t);pc=t=e}while(null!==t);0===jc&&(jc=5)}function md(e,t){do{var r=mo(e.alternate,e);if(null!==r)return r.flags&=32767,void(pc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(pc=e);pc=e=r}while(null!==e);jc=6,pc=null}function pd(e,t,r,a,n,s,l,o,c){e.cancelPendingCommit=null;do{yd()}while(0!==Rc);if(0!==(6&fc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,r,a,n,s){var i=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var l=e.entanglements,o=e.expirationTimes,c=e.hiddenUpdates;for(r=i&~r;0<r;){var d=31-ye(r),u=1<<d;l[d]=0,o[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var f=h[d];null!==f&&(f.lane&=-536870913)}r&=~u}0!==a&&Oe(e,a,0),0!==s&&0===n&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,r,s|=_a,l,o,c),e===mc&&(pc=mc=null,gc=0),Bc=t,Mc=e,Uc=r,zc=s,qc=n,Hc=a,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ne(he,function(){return wd(),null})):(e.callbackNode=null,e.callbackPriority=0),a=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||a){a=F.T,F.T=null,n=D.p,D.p=2,l=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,mu=vh,aa(e=ra(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(a&&0!==a.rangeCount){r=a.anchorNode;var n=a.anchorOffset,s=a.focusNode;a=a.focusOffset;try{r.nodeType,s.nodeType}catch(g){r=null;break e}var l=0,o=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==r||0!==n&&3!==h.nodeType||(o=l+n),h!==s||0!==a&&3!==h.nodeType||(c=l+a),3===h.nodeType&&(l+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++d===n&&(o=l),f===s&&++u===a&&(c=l),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}r=-1===o||-1===c?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pu={focusedElem:e,selectionRange:r},vh=!1,Oo=t;null!==Oo;)if(e=(t=Oo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Oo=e;else for(;null!==Oo;){switch(s=(t=Oo).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(r=0;r<e.length;r++)(n=e[r]).ref.impl=n.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,r=t,n=s.memoizedProps,s=s.memoizedState,a=r.stateNode;try{var p=Nl(r.type,n);e=a.getSnapshotBeforeUpdate(p,s),a.__reactInternalSnapshotBeforeUpdate=e}catch(x){jd(r,r.return,x)}}break;case 3:if(0!==(1024&e))if(9===(r=(e=t.stateNode.containerInfo).nodeType))Tu(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Tu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Oo=e;break}Oo=t.return}}(e,t)}finally{fc=l,D.p=n,F.T=a}}Rc=1,gd(),xd(),bd()}}function gd(){if(1===Rc){Rc=0;var e=Mc,t=Bc,r=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||r){r=F.T,F.T=null;var a=D.p;D.p=2;var n=fc;fc|=4;try{Vo(t,e);var s=pu,i=ra(e.containerInfo),l=s.focusedElem,o=s.selectionRange;if(i!==l&&l&&l.ownerDocument&&ta(l.ownerDocument.documentElement,l)){if(null!==o&&aa(l)){var c=o.start,d=o.end;if(void 0===d&&(d=c),"selectionStart"in l)l.selectionStart=c,l.selectionEnd=Math.min(d,l.value.length);else{var u=l.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var f=h.getSelection(),m=l.textContent.length,p=Math.min(o.start,m),g=void 0===o.end?p:Math.min(o.end,m);!f.extend&&p>g&&(i=g,g=p,p=i);var x=ea(l,p),b=ea(l,g);if(x&&b&&(1!==f.rangeCount||f.anchorNode!==x.node||f.anchorOffset!==x.offset||f.focusNode!==b.node||f.focusOffset!==b.offset)){var v=u.createRange();v.setStart(x.node,x.offset),f.removeAllRanges(),p>g?(f.addRange(v),f.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),f.addRange(v))}}}}for(u=[],f=l;f=f.parentNode;)1===f.nodeType&&u.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof l.focus&&l.focus(),l=0;l<u.length;l++){var y=u[l];y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}vh=!!mu,pu=mu=null}finally{fc=n,D.p=a,F.T=r}}e.current=t,Rc=2}}function xd(){if(2===Rc){Rc=0;var e=Mc,t=Bc,r=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||r){r=F.T,F.T=null;var a=D.p;D.p=2;var n=fc;fc|=4;try{Fo(e,t.alternate,t)}finally{fc=n,D.p=a,F.T=r}}Rc=3}}function bd(){if(4===Rc||3===Rc){Rc=0,le();var e=Mc,t=Bc,r=Uc,a=Hc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Rc=5:(Rc=0,Bc=Mc=null,vd(e,e.pendingLanes));var n=e.pendingLanes;if(0===n&&(Ic=null),Re(r),t=t.stateNode,be&&"function"===typeof be.onCommitFiberRoot)try{be.onCommitFiberRoot(xe,t,void 0,128===(128&t.current.flags))}catch(o){}if(null!==a){t=F.T,n=D.p,D.p=2,F.T=null;try{for(var s=e.onRecoverableError,i=0;i<a.length;i++){var l=a[i];s(l.value,{componentStack:l.stack})}}finally{F.T=t,D.p=n}}0!==(3&Uc)&&yd(),Dd(e),n=e.pendingLanes,0!==(261930&r)&&0!==(42&n)?e===Vc?Wc++:(Wc=0,Vc=e):Wc=0,Id(0,!1)}}function vd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Un(t)))}function yd(){return gd(),xd(),bd(),wd()}function wd(){if(5!==Rc)return!1;var e=Mc,t=zc;zc=0;var r=Re(Uc),a=F.T,n=D.p;try{D.p=32>r?32:r,F.T=null,r=qc,qc=null;var s=Mc,l=Uc;if(Rc=0,Bc=Mc=null,Uc=0,0!==(6&fc))throw Error(i(331));var o=fc;if(fc|=4,oc(s.current),ec(s,s.current,l,r),fc=o,Id(0,!1),be&&"function"===typeof be.onPostCommitFiberRoot)try{be.onPostCommitFiberRoot(xe,s)}catch(c){}return!0}finally{D.p=n,F.T=a,vd(e,t)}}function Nd(e,t,r){t=Ka(r,t),null!==(e=vs(e,t=_l(e.stateNode,t,2),2))&&(Pe(e,2),Dd(e))}function jd(e,t,r){if(3===e.tag)Nd(e,e,r);else for(;null!==t;){if(3===t.tag){Nd(t,e,r);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Ic||!Ic.has(a))){e=Ka(r,e),null!==(a=vs(t,r=Tl(2),2))&&(El(r,a,t,e),Pe(a,2),Dd(a));break}}t=t.return}}function kd(e,t,r){var a=e.pingCache;if(null===a){a=e.pingCache=new hc;var n=new Set;a.set(t,n)}else void 0===(n=a.get(t))&&(n=new Set,a.set(t,n));n.has(r)||(wc=!0,n.add(r),e=Sd.bind(null,e,t,r),t.then(e,e))}function Sd(e,t,r){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,mc===e&&(gc&r)===r&&(4===jc||3===jc&&(62914560&gc)===gc&&300>oe()-Pc?0===(2&fc)&&td(e,0):Ac|=r,_c===gc&&(_c=0)),Dd(e)}function Ad(e,t){0===t&&(t=Ee()),null!==(e=Pa(e,t))&&(Pe(e,t),Dd(e))}function Cd(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ad(e,r)}function _d(e,t){var r=0;switch(e.tag){case 31:case 13:var a=e.stateNode,n=e.memoizedState;null!==n&&(r=n.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==a&&a.delete(t),Ad(e,r)}var Td=null,Ed=null,Ld=!1,Pd=!1,Od=!1,Fd=0;function Dd(e){e!==Ed&&null===e.next&&(null===Ed?Td=Ed=e:Ed=Ed.next=e),Pd=!0,Ld||(Ld=!0,ku(function(){0!==(6&fc)?ne(de,Rd):Md()}))}function Id(e,t){if(!Od&&Pd){Od=!0;do{for(var r=!1,a=Td;null!==a;){if(!t)if(0!==e){var n=a.pendingLanes;if(0===n)var s=0;else{var i=a.suspendedLanes,l=a.pingedLanes;s=(1<<31-ye(42|e)+1)-1,s=201326741&(s&=n&~(i&~l))?201326741&s|1:s?2|s:0}0!==s&&(r=!0,zd(a,s))}else s=gc,0===(3&(s=Ce(a,a===mc?s:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||_e(a,s)||(r=!0,zd(a,s));a=a.next}}while(r);Od=!1}}function Rd(){Md()}function Md(){Pd=Ld=!1;var e=0;0!==Fd&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==yu&&(yu=e,!0);return yu=null,!1}()&&(e=Fd);for(var t=oe(),r=null,a=Td;null!==a;){var n=a.next,s=Bd(a,t);0===s?(a.next=null,null===r?Td=n:r.next=n,null===n&&(Ed=r)):(r=a,(0!==e||0!==(3&s))&&(Pd=!0)),a=n}0!==Rc&&5!==Rc||Id(e,!1),0!==Fd&&(Fd=0)}function Bd(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-ye(s),l=1<<i,o=n[i];-1===o?0!==(l&r)&&0===(l&a)||(n[i]=Te(l,t)):o<=t&&(e.expiredLanes|=l),s&=~l}if(r=gc,r=Ce(e,e===(t=mc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===r||e===t&&(2===xc||9===xc)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&se(a),e.callbackNode=null,e.callbackPriority=0;if(0===(3&r)||_e(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==a&&se(a),Re(r)){case 2:case 8:r=ue;break;case 32:default:r=he;break;case 268435456:r=me}return a=Ud.bind(null,e),r=ne(r,a),e.callbackPriority=t,e.callbackNode=r,t}return null!==a&&null!==a&&se(a),e.callbackPriority=2,e.callbackNode=null,2}function Ud(e,t){if(0!==Rc&&5!==Rc)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(yd()&&e.callbackNode!==r)return null;var a=gc;return 0===(a=Ce(e,e===mc?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Xc(e,a,t),Bd(e,oe()),null!=e.callbackNode&&e.callbackNode===r?Ud.bind(null,e):null)}function zd(e,t){if(yd())return null;Xc(e,t,!0)}function qd(){if(0===Fd){var e=Hn;0===e&&(e=je,0===(261888&(je<<=1))&&(je=256)),Fd=e}return Fd}function Hd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Lt(""+e)}function Wd(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var Vd=0;Vd<ja.length;Vd++){var Gd=ja[Vd];ka(Gd.toLowerCase(),"on"+(Gd[0].toUpperCase()+Gd.slice(1)))}ka(pa,"onAnimationEnd"),ka(ga,"onAnimationIteration"),ka(xa,"onAnimationStart"),ka("dblclick","onDoubleClick"),ka("focusin","onFocus"),ka("focusout","onBlur"),ka(ba,"onTransitionRun"),ka(va,"onTransitionStart"),ka(ya,"onTransitionCancel"),ka(wa,"onTransitionEnd"),nt("onMouseEnter",["mouseout","mouseover"]),nt("onMouseLeave",["mouseout","mouseover"]),nt("onPointerEnter",["pointerout","pointerover"]),nt("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kd));function Xd(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var a=e[r],n=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var l=a[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==s&&n.isPropagationStopped())break e;s=l,n.currentTarget=c;try{s(n)}catch(d){Sa(d)}n.currentTarget=null,s=o}else for(i=0;i<a.length;i++){if(o=(l=a[i]).instance,c=l.currentTarget,l=l.listener,o!==s&&n.isPropagationStopped())break e;s=l,n.currentTarget=c;try{s(n)}catch(d){Sa(d)}n.currentTarget=null,s=o}}}}function $d(e,t){var r=t[We];void 0===r&&(r=t[We]=new Set);var a=e+"__bubble";r.has(a)||(eu(t,e,2,!1),r.add(a))}function Jd(e,t,r){var a=0;t&&(a|=4),eu(r,e,a,t)}var Qd="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[Qd]){e[Qd]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Yd.has(t)||Jd(t,!1,e),Jd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qd]||(t[Qd]=!0,Jd("selectionchange",!1,t))}}function eu(e,t,r,a){switch(Ah(t)){case 2:var n=yh;break;case 8:n=wh;break;default:n=Nh}r=n.bind(null,t,r,e),n=void 0,!qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),a?void 0!==n?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):void 0!==n?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function tu(e,t,r,a,n){var s=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var l=a.stateNode.containerInfo;if(l===n)break;if(4===i)for(i=a.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===n)return;i=i.return}for(;null!==l;){if(null===(i=$e(l)))return;if(5===(c=i.tag)||6===c||26===c||27===c){a=s=i;continue e}l=l.parentNode}}a=a.return}Bt(function(){var a=s,n=Ft(r),i=[];e:{var l=Na.get(e);if(void 0!==l){var c=rr,d=e;switch(e){case"keypress":if(0===Yt(r))break e;case"keydown":case"keyup":c=xr;break;case"focusin":d="focus",c=or;break;case"focusout":d="blur",c=or;break;case"beforeblur":case"afterblur":c=or;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=lr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vr;break;case pa:case ga:case xa:c=cr;break;case wa:c=yr;break;case"scroll":case"scrollend":c=nr;break;case"wheel":c=wr;break;case"copy":case"cut":case"paste":c=dr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=br;break;case"toggle":case"beforetoggle":c=Nr}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),f=u?null!==l?l+"Capture":null:l;u=[];for(var m,p=a;null!==p;){var g=p;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===f||null!=(g=Ut(p,f))&&u.push(ru(p,g,m)),h)break;p=p.return}0<u.length&&(l=new c(l,d,null,r,n),i.push({event:l,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||r===Ot||!(d=r.relatedTarget||r.fromElement)||!$e(d)&&!d[He])&&(c||l)&&(l=n.window===n?n:(l=n.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=a,null!==(d=(d=r.relatedTarget||r.toElement)?$e(d):null)&&(h=o(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=a),c!==d)){if(u=ir,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=br,g="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==c?l:Qe(c),m=null==d?l:Qe(d),(l=new u(g,p+"leave",c,r,n)).target=h,l.relatedTarget=m,g=null,$e(n)===a&&((u=new u(f,p+"enter",d,r,n)).target=m,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(u=nu,p=d,m=0,g=f=c;g;g=u(g))m++;g=0;for(var x=p;x;x=u(x))g++;for(;0<m-g;)f=u(f),m--;for(;0<g-m;)p=u(p),g--;for(;m--;){if(f===p||null!==p&&f===p.alternate){u=f;break e}f=u(f),p=u(p)}u=null}else u=null;null!==c&&su(i,l,c,u,!1),null!==d&&null!==h&&su(i,h,d,u,!0)}if("select"===(c=(l=a?Qe(a):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var b=Ur;else if(Fr(l))if(zr)b=$r;else{b=Yr;var v=Kr}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?a&&_t(a.elementType)&&(b=Ur):b=Xr;switch(b&&(b=b(e,a))?Dr(i,b,r,n):(v&&v(e,l,a),"focusout"===e&&a&&"number"===l.type&&null!=a.memoizedProps.value&&yt(l,"number",l.value)),v=a?Qe(a):window,e){case"focusin":(Fr(v)||"true"===v.contentEditable)&&(sa=v,ia=a,la=null);break;case"focusout":la=ia=sa=null;break;case"mousedown":oa=!0;break;case"contextmenu":case"mouseup":case"dragend":oa=!1,ca(i,r,n);break;case"selectionchange":if(na)break;case"keydown":case"keyup":ca(i,r,n)}var y;if(kr)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Pr?Er(e,r)&&(w="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(w="onCompositionStart");w&&(Cr&&"ko"!==r.locale&&(Pr||"onCompositionStart"!==w?"onCompositionEnd"===w&&Pr&&(y=Kt()):(Vt="value"in(Wt=n)?Wt.value:Wt.textContent,Pr=!0)),0<(v=au(a,w)).length&&(w=new ur(w,e,null,r,n),i.push({event:w,listeners:v}),y?w.data=y:null!==(y=Lr(r))&&(w.data=y))),(y=Ar?function(e,t){switch(e){case"compositionend":return Lr(t);case"keypress":return 32!==t.which?null:(Tr=!0,_r);case"textInput":return(e=t.data)===_r&&Tr?null:e;default:return null}}(e,r):function(e,t){if(Pr)return"compositionend"===e||!kr&&Er(e,t)?(e=Kt(),Gt=Vt=Wt=null,Pr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(w=au(a,"onBeforeInput")).length&&(v=new ur("onBeforeInput","beforeinput",null,r,n),i.push({event:v,listeners:w}),v.data=y)),function(e,t,r,a,n){if("submit"===t&&r&&r.stateNode===n){var s=Hd((n[qe]||null).action),i=a.submitter;i&&null!==(t=(t=i[qe]||null)?Hd(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var l=new rr("action","action",null,a,n);e.push({event:l,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==Fd){var e=i?Wd(n,i):new FormData(n);el(r,{pending:!0,data:e,method:n.method,action:s},null,e)}}else"function"===typeof s&&(l.preventDefault(),e=i?Wd(n,i):new FormData(n),el(r,{pending:!0,data:e,method:n.method,action:s},s,e))},currentTarget:n}]})}}(i,e,a,r,n)}Xd(i,t)})}function ru(e,t,r){return{instance:e,listener:t,currentTarget:r}}function au(e,t){for(var r=t+"Capture",a=[];null!==e;){var n=e,s=n.stateNode;if(5!==(n=n.tag)&&26!==n&&27!==n||null===s||(null!=(n=Ut(e,r))&&a.unshift(ru(e,n,s)),null!=(n=Ut(e,t))&&a.push(ru(e,n,s))),3===e.tag)return a;e=e.return}return[]}function nu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function su(e,t,r,a,n){for(var s=t._reactName,i=[];null!==r&&r!==a;){var l=r,o=l.alternate,c=l.stateNode;if(l=l.tag,null!==o&&o===a)break;5!==l&&26!==l&&27!==l||null===c||(o=c,n?null!=(c=Ut(r,s))&&i.unshift(ru(r,c,o)):n||null!=(c=Ut(r,s))&&i.push(ru(r,c,o))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var iu=/\r\n?/g,lu=/\u0000|\uFFFD/g;function ou(e){return("string"===typeof e?e:""+e).replace(iu,"\n").replace(lu,"")}function cu(e,t){return t=ou(t),ou(e)===t}function du(e,t,r,a,n,s){switch(r){case"children":"string"===typeof a?"body"===t||"textarea"===t&&""===a||kt(e,a):("number"===typeof a||"bigint"===typeof a)&&"body"!==t&&kt(e,""+a);break;case"className":ct(e,"class",a);break;case"tabIndex":ct(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,r,a);break;case"style":Ct(e,a,s);break;case"data":if("object"!==t){ct(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==a||"function"===typeof a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(r);break}a=Lt(""+a),e.setAttribute(r,a);break;case"action":case"formAction":if("function"===typeof a){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===r?("input"!==t&&du(e,t,"name",n.name,n,null),du(e,t,"formEncType",n.formEncType,n,null),du(e,t,"formMethod",n.formMethod,n,null),du(e,t,"formTarget",n.formTarget,n,null)):(du(e,t,"encType",n.encType,n,null),du(e,t,"method",n.method,n,null),du(e,t,"target",n.target,n,null))),null==a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(r);break}a=Lt(""+a),e.setAttribute(r,a);break;case"onClick":null!=a&&(e.onclick=Pt);break;case"onScroll":null!=a&&$d("scroll",e);break;case"onScrollEnd":null!=a&&$d("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(r=a.__html)){if(null!=n.children)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"muted":e.muted=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"===typeof a||"boolean"===typeof a||"symbol"===typeof a){e.removeAttribute("xlink:href");break}r=Lt(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(r,""+a):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===a?e.setAttribute(r,""):!1!==a&&null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(r,a):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&!isNaN(a)&&1<=a?e.setAttribute(r,a):e.removeAttribute(r);break;case"rowSpan":case"start":null==a||"function"===typeof a||"symbol"===typeof a||isNaN(a)?e.removeAttribute(r):e.setAttribute(r,a);break;case"popover":$d("beforetoggle",e),$d("toggle",e),ot(e,"popover",a);break;case"xlinkActuate":dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":dt(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":dt(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":dt(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":dt(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":ot(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&ot(e,r=Tt.get(r)||r,a)}}function uu(e,t,r,a,n,s){switch(r){case"style":Ct(e,a,s);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(r=a.__html)){if(null!=n.children)throw Error(i(60));e.innerHTML=r}}break;case"children":"string"===typeof a?kt(e,a):("number"===typeof a||"bigint"===typeof a)&&kt(e,""+a);break;case"onScroll":null!=a&&$d("scroll",e);break;case"onScrollEnd":null!=a&&$d("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Pt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:rt.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(n=r.endsWith("Capture"),t=r.slice(2,n?r.length-7:void 0),"function"===typeof(s=null!=(s=e[qe]||null)?s[r]:null)&&e.removeEventListener(t,s,n),"function"!==typeof a)?r in e?e[r]=a:!0===a?e.setAttribute(r,""):ot(e,r,a):("function"!==typeof s&&null!==s&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,a,n)))}}function hu(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$d("error",e),$d("load",e);var a,n=!1,s=!1;for(a in r)if(r.hasOwnProperty(a)){var l=r[a];if(null!=l)switch(a){case"src":n=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,a,l,r,null)}}return s&&du(e,t,"srcSet",r.srcSet,r,null),void(n&&du(e,t,"src",r.src,r,null));case"input":$d("invalid",e);var o=a=l=s=null,c=null,d=null;for(n in r)if(r.hasOwnProperty(n)){var u=r[n];if(null!=u)switch(n){case"name":s=u;break;case"type":l=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":a=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:du(e,t,n,u,r,null)}}return void vt(e,a,o,c,d,l,s,!1);case"select":for(s in $d("invalid",e),n=l=a=null,r)if(r.hasOwnProperty(s)&&null!=(o=r[s]))switch(s){case"value":a=o;break;case"defaultValue":l=o;break;case"multiple":n=o;default:du(e,t,s,o,r,null)}return t=a,r=l,e.multiple=!!n,void(null!=t?wt(e,!!n,t,!1):null!=r&&wt(e,!!n,r,!0));case"textarea":for(l in $d("invalid",e),a=s=n=null,r)if(r.hasOwnProperty(l)&&null!=(o=r[l]))switch(l){case"value":n=o;break;case"defaultValue":s=o;break;case"children":a=o;break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(i(91));break;default:du(e,t,l,o,r,null)}return void jt(e,n,s,a);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(n=r[c]))if("selected"===c)e.selected=n&&"function"!==typeof n&&"symbol"!==typeof n;else du(e,t,c,n,r,null);return;case"dialog":$d("beforetoggle",e),$d("toggle",e),$d("cancel",e),$d("close",e);break;case"iframe":case"object":$d("load",e);break;case"video":case"audio":for(n=0;n<Kd.length;n++)$d(Kd[n],e);break;case"image":$d("error",e),$d("load",e);break;case"details":$d("toggle",e);break;case"embed":case"source":case"link":$d("error",e),$d("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in r)if(r.hasOwnProperty(d)&&null!=(n=r[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,d,n,r,null)}return;default:if(_t(t)){for(u in r)r.hasOwnProperty(u)&&(void 0!==(n=r[u])&&uu(e,t,u,n,r,void 0));return}}for(o in r)r.hasOwnProperty(o)&&(null!=(n=r[o])&&du(e,t,o,n,r,null))}function fu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var mu=null,pu=null;function gu(e){return 9===e.nodeType?e:e.ownerDocument}function xu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function vu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var yu=null;var wu="function"===typeof setTimeout?setTimeout:void 0,Nu="function"===typeof clearTimeout?clearTimeout:void 0,ju="function"===typeof Promise?Promise:void 0,ku="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ju?function(e){return ju.resolve(null).then(e).catch(Su)}:wu;function Su(e){setTimeout(function(){throw e})}function Au(e){return"head"===e}function Cu(e,t){var r=t,a=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&8===n.nodeType)if("/$"===(r=n.data)||"/&"===r){if(0===a)return e.removeChild(n),void Wh(t);a--}else if("$"===r||"$?"===r||"$~"===r||"$!"===r||"&"===r)a++;else if("html"===r)Mu(e.ownerDocument.documentElement);else if("head"===r){Mu(r=e.ownerDocument.head);for(var s=r.firstChild;s;){var i=s.nextSibling,l=s.nodeName;s[Ye]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||r.removeChild(s),s=i}}else"body"===r&&Mu(e.ownerDocument.body);r=n}while(r);Wh(t)}function _u(e,t){var r=e;e=0;do{var a=r.nextSibling;if(1===r.nodeType?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",""===r.getAttribute("style")&&r.removeAttribute("style")):3===r.nodeType&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===e)break;e--}else"$"!==r&&"$?"!==r&&"$~"!==r&&"$!"!==r||e++;r=a}while(r)}function Tu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Tu(r),Xe(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function Eu(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Ou(e.nextSibling)))return null}return e}function Lu(e){return"$?"===e.data||"$~"===e.data}function Pu(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Ou(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Fu=null;function Du(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r||"/&"===r){if(0===t)return Ou(e.nextSibling);t--}else"$"!==r&&"$!"!==r&&"$?"!==r&&"$~"!==r&&"&"!==r||t++}e=e.nextSibling}return null}function Iu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r||"$~"===r||"&"===r){if(0===t)return e;t--}else"/$"!==r&&"/&"!==r||t++}e=e.previousSibling}return null}function Ru(e,t,r){switch(t=gu(r),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Mu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var Bu=new Map,Uu=new Set;function zu(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var qu=D.d;D.d={f:function(){var e=qu.f(),t=Zc();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?rl(t):qu.r(e)},D:function(e){qu.D(e),Wu("dns-prefetch",e,null)},C:function(e,t){qu.C(e,t),Wu("preconnect",e,t)},L:function(e,t,r){qu.L(e,t,r);var a=Hu;if(a&&e&&t){var n='link[rel="preload"][as="'+xt(t)+'"]';"image"===t&&r&&r.imageSrcSet?(n+='[imagesrcset="'+xt(r.imageSrcSet)+'"]',"string"===typeof r.imageSizes&&(n+='[imagesizes="'+xt(r.imageSizes)+'"]')):n+='[href="'+xt(e)+'"]';var s=n;switch(t){case"style":s=Gu(e);break;case"script":s=Xu(e)}Bu.has(s)||(e=f({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Bu.set(s,e),null!==a.querySelector(n)||"style"===t&&a.querySelector(Ku(s))||"script"===t&&a.querySelector($u(s))||(hu(t=a.createElement("link"),"link",e),et(t),a.head.appendChild(t)))}},m:function(e,t){qu.m(e,t);var r=Hu;if(r&&e){var a=t&&"string"===typeof t.as?t.as:"script",n='link[rel="modulepreload"][as="'+xt(a)+'"][href="'+xt(e)+'"]',s=n;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Xu(e)}if(!Bu.has(s)&&(e=f({rel:"modulepreload",href:e},t),Bu.set(s,e),null===r.querySelector(n))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector($u(s)))return}hu(a=r.createElement("link"),"link",e),et(a),r.head.appendChild(a)}}},X:function(e,t){qu.X(e,t);var r=Hu;if(r&&e){var a=Ze(r).hoistableScripts,n=Xu(e),s=a.get(n);s||((s=r.querySelector($u(n)))||(e=f({src:e,async:!0},t),(t=Bu.get(n))&&eh(e,t),et(s=r.createElement("script")),hu(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},a.set(n,s))}},S:function(e,t,r){qu.S(e,t,r);var a=Hu;if(a&&e){var n=Ze(a).hoistableStyles,s=Gu(e);t=t||"default";var i=n.get(s);if(!i){var l={loading:0,preload:null};if(i=a.querySelector(Ku(s)))l.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Bu.get(s))&&Zu(e,r);var o=i=a.createElement("link");et(o),hu(o,"link",e),o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),o.addEventListener("load",function(){l.loading|=1}),o.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Qu(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:l},n.set(s,i)}}},M:function(e,t){qu.M(e,t);var r=Hu;if(r&&e){var a=Ze(r).hoistableScripts,n=Xu(e),s=a.get(n);s||((s=r.querySelector($u(n)))||(e=f({src:e,async:!0,type:"module"},t),(t=Bu.get(n))&&eh(e,t),et(s=r.createElement("script")),hu(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},a.set(n,s))}}};var Hu="undefined"===typeof document?null:document;function Wu(e,t,r){var a=Hu;if(a&&"string"===typeof t&&t){var n=xt(t);n='link[rel="'+e+'"][href="'+n+'"]',"string"===typeof r&&(n+='[crossorigin="'+r+'"]'),Uu.has(n)||(Uu.add(n),e={rel:e,crossOrigin:r,href:t},null===a.querySelector(n)&&(hu(t=a.createElement("link"),"link",e),et(t),a.head.appendChild(t)))}}function Vu(e,t,r,a){var n,s,l,o,c=(c=G.current)?zu(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof r.precedence&&"string"===typeof r.href?(t=Gu(r.href),(a=(r=Ze(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"===typeof r.href&&"string"===typeof r.precedence){e=Gu(r.href);var d=Ze(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Ku(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Bu.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Bu.set(e,r),d||(n=c,s=e,l=r,o=u.state,n.querySelector('link[rel="preload"][as="style"]['+s+"]")?o.loading=1:(s=n.createElement("link"),o.preload=s,s.addEventListener("load",function(){return o.loading|=1}),s.addEventListener("error",function(){return o.loading|=2}),hu(s,"link",l),et(s),n.head.appendChild(s))))),t&&null===a)throw Error(i(528,""));return u}if(t&&null!==a)throw Error(i(529,""));return null;case"script":return t=r.async,"string"===typeof(r=r.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Xu(r),(a=(r=Ze(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Gu(e){return'href="'+xt(e)+'"'}function Ku(e){return'link[rel="stylesheet"]['+e+"]"}function Yu(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Xu(e){return'[src="'+xt(e)+'"]'}function $u(e){return"script[async]"+e}function Ju(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+xt(r.href)+'"]');if(a)return t.instance=a,et(a),a;var n=f({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return et(a=(e.ownerDocument||e).createElement("style")),hu(a,"style",n),Qu(a,r.precedence,e),t.instance=a;case"stylesheet":n=Gu(r.href);var s=e.querySelector(Ku(n));if(s)return t.state.loading|=4,t.instance=s,et(s),s;a=Yu(r),(n=Bu.get(n))&&Zu(a,n),et(s=(e.ownerDocument||e).createElement("link"));var l=s;return l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),hu(s,"link",a),t.state.loading|=4,Qu(s,r.precedence,e),t.instance=s;case"script":return s=Xu(r.src),(n=e.querySelector($u(s)))?(t.instance=n,et(n),n):(a=r,(n=Bu.get(s))&&eh(a=f({},r),n),et(n=(e=e.ownerDocument||e).createElement("script")),hu(n,"link",a),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,Qu(a,r.precedence,e));return t.instance}function Qu(e,t,r){for(var a=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=a.length?a[a.length-1]:null,s=n,i=0;i<a.length;i++){var l=a[i];if(l.dataset.precedence===t)s=l;else if(s!==n)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Zu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function rh(e,t,r){if(null===th){var a=new Map,n=th=new Map;n.set(r,a)}else(a=(n=th).get(r))||(a=new Map,n.set(r,a));if(a.has(e))return a;for(a.set(e,null),r=r.getElementsByTagName(e),n=0;n<r.length;n++){var s=r[n];if(!(s[Ye]||s[ze]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var l=a.get(i);l?l.push(s):a.set(i,[s])}}return a}function ah(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function nh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sh=0;function ih(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)oh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var lh=null;function oh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,lh=new Map,t.forEach(ch,e),lh=null,ih.call(e))}function ch(e,t){if(!(4&t.state.loading)){var r=lh.get(e);if(r)var a=r.get(null);else{r=new Map,lh.set(e,r);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<n.length;s++){var i=n[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(r.set(i.dataset.precedence,i),a=i)}a&&r.set(null,a)}i=(n=t.instance).getAttribute("data-precedence"),(s=r.get(i)||a)===a&&r.set(null,n),r.set(i,n),this.count++,a=ih.bind(this),n.addEventListener("load",a),n.addEventListener("error",a),s?s.parentNode.insertBefore(n,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(n,e.firstChild),t.state.loading|=4}}var dh={$$typeof:w,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function uh(e,t,r,a,n,s,i,l,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Le(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Le(0),this.hiddenUpdates=Le(null),this.identifierPrefix=a,this.onUncaughtError=n,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function hh(e,t,r,a,n,s,i,l,o,c,d,u){return e=new uh(e,t,r,i,o,c,d,u,l),t=1,!0===s&&(t|=24),s=Ra(3,null,null,t),e.current=s,s.stateNode=e,(t=Bn()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:a,isDehydrated:r,cache:t},gs(s),e}function fh(e){return e?e=Da:Da}function mh(e,t,r,a,n,s){n=fh(n),null===a.context?a.context=n:a.pendingContext=n,(a=bs(t)).payload={element:r},null!==(s=void 0===s?null:s)&&(a.callback=s),null!==(r=vs(e,a,t))&&(Yc(r,0,t),ys(r,e,t))}function ph(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function gh(e,t){ph(e,t),(e=e.alternate)&&ph(e,t)}function xh(e){if(13===e.tag||31===e.tag){var t=Pa(e,67108864);null!==t&&Yc(t,0,67108864),gh(e,67108864)}}function bh(e){if(13===e.tag||31===e.tag){var t=Gc(),r=Pa(e,t=Ie(t));null!==r&&Yc(r,0,t),gh(e,t)}}var vh=!0;function yh(e,t,r,a){var n=F.T;F.T=null;var s=D.p;try{D.p=2,Nh(e,t,r,a)}finally{D.p=s,F.T=n}}function wh(e,t,r,a){var n=F.T;F.T=null;var s=D.p;try{D.p=8,Nh(e,t,r,a)}finally{D.p=s,F.T=n}}function Nh(e,t,r,a){if(vh){var n=jh(a);if(null===n)tu(e,t,a,kh,r),Dh(e,a);else if(function(e,t,r,a,n){switch(t){case"focusin":return _h=Ih(_h,e,t,r,a,n),!0;case"dragenter":return Th=Ih(Th,e,t,r,a,n),!0;case"mouseover":return Eh=Ih(Eh,e,t,r,a,n),!0;case"pointerover":var s=n.pointerId;return Lh.set(s,Ih(Lh.get(s)||null,e,t,r,a,n)),!0;case"gotpointercapture":return s=n.pointerId,Ph.set(s,Ih(Ph.get(s)||null,e,t,r,a,n)),!0}return!1}(n,e,t,r,a))a.stopPropagation();else if(Dh(e,a),4&t&&-1<Fh.indexOf(e)){for(;null!==n;){var s=Je(n);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=Ae(s.pendingLanes);if(0!==i){var l=s;for(l.pendingLanes|=2,l.entangledLanes|=2;i;){var o=1<<31-ye(i);l.entanglements[1]|=o,i&=~o}Dd(s),0===(6&fc)&&(Fc=oe()+500,Id(0,!1))}}break;case 31:case 13:null!==(l=Pa(s,2))&&Yc(l,0,2),Zc(),gh(s,2)}if(null===(s=jh(a))&&tu(e,t,a,kh,r),s===n)break;n=s}null!==n&&a.stopPropagation()}else tu(e,t,a,null,r)}}function jh(e){return Sh(e=Ft(e))}var kh=null;function Sh(e){if(kh=null,null!==(e=$e(e))){var t=o(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=c(t)))return e;e=null}else if(31===r){if(null!==(e=d(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return kh=e,null}function Ah(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case de:return 2;case ue:return 8;case he:case fe:return 32;case me:return 268435456;default:return 32}default:return 32}}var Ch=!1,_h=null,Th=null,Eh=null,Lh=new Map,Ph=new Map,Oh=[],Fh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dh(e,t){switch(e){case"focusin":case"focusout":_h=null;break;case"dragenter":case"dragleave":Th=null;break;case"mouseover":case"mouseout":Eh=null;break;case"pointerover":case"pointerout":Lh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ph.delete(t.pointerId)}}function Ih(e,t,r,a,n,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:s,targetContainers:[n]},null!==t&&(null!==(t=Je(t))&&xh(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Rh(e){var t=$e(e.target);if(null!==t){var r=o(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=c(r)))return e.blockedOn=t,void Be(e.priority,function(){bh(r)})}else if(31===t){if(null!==(t=d(r)))return e.blockedOn=t,void Be(e.priority,function(){bh(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Mh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=jh(e.nativeEvent);if(null!==r)return null!==(t=Je(r))&&xh(t),e.blockedOn=r,!1;var a=new(r=e.nativeEvent).constructor(r.type,r);Ot=a,r.target.dispatchEvent(a),Ot=null,t.shift()}return!0}function Bh(e,t,r){Mh(e)&&r.delete(t)}function Uh(){Ch=!1,null!==_h&&Mh(_h)&&(_h=null),null!==Th&&Mh(Th)&&(Th=null),null!==Eh&&Mh(Eh)&&(Eh=null),Lh.forEach(Bh),Ph.forEach(Bh)}function zh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ch||(Ch=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Uh)))}var qh=null;function Hh(e){qh!==e&&(qh=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){qh===e&&(qh=null);for(var t=0;t<e.length;t+=3){var r=e[t],a=e[t+1],n=e[t+2];if("function"!==typeof a){if(null===Sh(a||r))continue;break}var s=Je(r);null!==s&&(e.splice(t,3),t-=3,el(s,{pending:!0,data:n,method:r.method,action:a},a,n))}}))}function Wh(e){function t(t){return zh(t,e)}null!==_h&&zh(_h,e),null!==Th&&zh(Th,e),null!==Eh&&zh(Eh,e),Lh.forEach(t),Ph.forEach(t);for(var r=0;r<Oh.length;r++){var a=Oh[r];a.blockedOn===e&&(a.blockedOn=null)}for(;0<Oh.length&&null===(r=Oh[0]).blockedOn;)Rh(r),null===r.blockedOn&&Oh.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<r.length;a+=3){var n=r[a],s=r[a+1],i=n[qe]||null;if("function"===typeof s)i||Hh(r);else if(i){var l=null;if(s&&s.hasAttribute("formAction")){if(n=s,i=s[qe]||null)l=i.formAction;else if(null!==Sh(n))continue}else l=i.action;"function"===typeof l?r[a+1]=l:(r.splice(a,3),a-=3),Hh(r)}}}function Vh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return n=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==n&&(n(),n=null),a||setTimeout(r,20)}function r(){if(!a&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var a=!1,n=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==n&&(n(),n=null)}}}function Gh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));mh(t.current,Gc(),e,t,null,null)},Kh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),Zc(),t[He]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Me();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Oh.length&&0!==t&&t<Oh[r].priority;r++);Oh.splice(r,0,e),0===r&&Rh(e)}};var Yh=n.version;if("19.2.0"!==Yh)throw Error(i(527,Yh,"19.2.0"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=o(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,a=t;;){var n=r.return;if(null===n)break;var s=n.alternate;if(null===s){if(null!==(a=n.return)){r=a;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return u(n),e;if(s===a)return u(n),t;s=s.sibling}throw Error(i(188))}if(r.return!==a.return)r=n,a=s;else{for(var l=!1,c=n.child;c;){if(c===r){l=!0,r=n,a=s;break}if(c===a){l=!0,a=n,r=s;break}c=c.sibling}if(!l){for(c=s.child;c;){if(c===r){l=!0,r=s,a=n;break}if(c===a){l=!0,a=s,r=n;break}c=c.sibling}if(!l)throw Error(i(189))}}if(r.alternate!==a)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Xh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{xe=$h.inject(Xh),be=$h}catch(Qh){}}t.createRoot=function(e,t){if(!l(e))throw Error(i(299));var r=!1,a="",n=jl,s=kl,o=Sl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onUncaughtError&&(n=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=hh(e,1,!1,null,0,r,a,null,n,s,o,Vh),e[He]=t.current,Zd(e),new Gh(t)},t.hydrateRoot=function(e,t,r){if(!l(e))throw Error(i(299));var a=!1,n="",s=jl,o=kl,c=Sl,d=null;return null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(n=r.identifierPrefix),void 0!==r.onUncaughtError&&(s=r.onUncaughtError),void 0!==r.onCaughtError&&(o=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.formState&&(d=r.formState)),(t=hh(e,1,!0,t,0,a,n,d,s,o,c,Vh)).context=fh(null),r=t.current,(n=bs(a=Ie(a=Gc()))).callback=null,vs(r,n,a),r=a,t.current.lanes=r,Pe(t,r),Dd(t),e[He]=t.current,Zd(e),new Kh(t)},t.version="19.2.0"},7950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(6672)},8853:(e,t,r)=>{e.exports=r(5896)}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,r),s.exports}r.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var s=Object.create(null);r.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&n&&a;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>a[e]);return i.default=()=>a,r.d(s,i),s}})(),r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,a)=>(r.f[a](e,t),t),[])),r.u=e=>"static/js/"+e+"."+{239:"759cdc61",453:"3fa3ea41",455:"8d2787b5",977:"294bee46"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="scanwell_crm:";r.l=(a,n,s,i)=>{if(e[a])e[a].push(n);else{var l,o;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+s){l=u;break}}l||(o=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.setAttribute("data-webpack",t+s),l.src=a),e[a]=[n];var h=(t,r)=>{l.onerror=l.onload=null,clearTimeout(f);var n=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),n&&n.forEach(e=>e(r)),t)return t(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=h.bind(null,l.onerror),l.onload=h.bind(null,l.onload),o&&document.head.appendChild(l)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/",(()=>{var e={792:0};r.f.j=(t,a)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else{var s=new Promise((r,a)=>n=e[t]=[r,a]);a.push(n[2]=s);var i=r.p+r.u(t),l=new Error;r.l(i,a=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var s=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",l.name="ChunkLoadError",l.type=s,l.request=i,n[1](l)}},"chunk-"+t,t)}};var t=(t,a)=>{var n,s,i=a[0],l=a[1],o=a[2],c=0;if(i.some(t=>0!==e[t])){for(n in l)r.o(l,n)&&(r.m[n]=l[n]);if(o)o(r)}for(t&&t(a);c<i.length;c++)s=i[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0},a=self.webpackChunkscanwell_crm=self.webpackChunkscanwell_crm||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a={};r.r(a),r.d(a,{hasBrowserEnv:()=>$t,hasStandardBrowserEnv:()=>Qt,hasStandardBrowserWebWorkerEnv:()=>Zt,navigator:()=>Jt,origin:()=>er});var n,s=r(5043),i=r.t(s,2),l=r(4391),o=r(7950),c=r.t(o,2);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function f(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,r,a){return void 0===r&&(r=null),d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?x(t):t,{state:r,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:r="",hash:a=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function x(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function b(e,t,r,a){void 0===a&&(a={});let{window:s=document.defaultView,v5Compat:i=!1}=a,l=s.history,o=n.Pop,c=null,f=x();function x(){return(l.state||{idx:null}).idx}function b(){o=n.Pop;let e=x(),t=null==e?null:e-f;f=e,c&&c({action:o,location:y.location,delta:t})}function v(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,r="string"===typeof e?e:g(e);return r=r.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==f&&(f=0,l.replaceState(d({},l.state,{idx:f}),""));let y={get action(){return o},get location(){return e(s,l)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(u,b),c=e,()=>{s.removeEventListener(u,b),c=null}},createHref:e=>t(s,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=n.Push;let a=p(y.location,e,t);r&&r(a,e),f=x()+1;let d=m(a,f),u=y.createHref(a);try{l.pushState(d,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;s.location.assign(u)}i&&c&&c({action:o,location:y.location,delta:1})},replace:function(e,t){o=n.Replace;let a=p(y.location,e,t);r&&r(a,e),f=x();let s=m(a,f),d=y.createHref(a);l.replaceState(s,"",d),i&&c&&c({action:o,location:y.location,delta:0})},go:e=>l.go(e)};return y}var v;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(v||(v={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,r){return void 0===r&&(r="/"),w(e,t,r,!1)}function w(e,t,r,a){let n=D(("string"===typeof t?x(t):t).pathname||"/",r);if(null==n)return null;let s=N(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let l=0;null==i&&l<s.length;++l){let e=F(n);i=P(s[l],e,a)}return i}function N(e,t,r,a){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===a&&(a="");let n=(e,n,s)=>{let i={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};i.relativePath.startsWith("/")&&(h(i.relativePath.startsWith(a),'Absolute route path "'+i.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(a.length));let l=U([a,i.relativePath]),o=r.concat(i);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),N(e.children,t,o,l)),(null!=e.path||e.index)&&t.push({path:l,score:L(l,e.index),routesMeta:o})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let a of j(e.path))n(e,t,a);else n(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[r,...a]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===a.length)return n?[s,""]:[s];let i=j(a.join("/")),l=[];return l.push(...i.map(e=>""===e?s:[s,e].join("/"))),n&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const k=/^:[\w-]+$/,S=3,A=2,C=1,_=10,T=-2,E=e=>"*"===e;function L(e,t){let r=e.split("/"),a=r.length;return r.some(E)&&(a+=T),t&&(a+=A),r.filter(e=>!E(e)).reduce((e,t)=>e+(k.test(t)?S:""===t?C:_),a)}function P(e,t,r){void 0===r&&(r=!1);let{routesMeta:a}=e,n={},s="/",i=[];for(let l=0;l<a.length;++l){let e=a[l],o=l===a.length-1,c="/"===s?t:t.slice(s.length)||"/",d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&r&&!a[a.length-1].route.index&&(d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(n,d.params),i.push({params:n,pathname:U([s,d.pathname]),pathnameBase:z(U([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=U([s,d.pathnameBase]))}return i}function O(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);f("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(a.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(a.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))");let s=new RegExp(n,t?void 0:"i");return[s,a]}(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],i=s.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:a.reduce((e,t,r)=>{let{paramName:a,isOptional:n}=t;if("*"===a){let e=l[r]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[r];return e[a]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:i,pattern:e}}function F(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return f(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function D(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&"/"!==a?null:e.slice(r)||"/"}function I(e,t,r,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function R(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function M(e,t){let r=R(e);return t?r.map((e,t)=>t===r.length-1?e.pathname:e.pathnameBase):r.map(e=>e.pathnameBase)}function B(e,t,r,a){let n;void 0===a&&(a=!1),"string"===typeof e?n=x(e):(n=d({},e),h(!n.pathname||!n.pathname.includes("?"),I("?","pathname","search",n)),h(!n.pathname||!n.pathname.includes("#"),I("#","pathname","hash",n)),h(!n.search||!n.search.includes("#"),I("#","search","hash",n)));let s,i=""===e||""===n.pathname,l=i?"/":n.pathname;if(null==l)s=r;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}s=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:r,search:a="",hash:n=""}="string"===typeof e?x(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:q(a),hash:H(n)}}(n,s),c=l&&"/"!==l&&l.endsWith("/"),u=(i||"."===l)&&r.endsWith("/");return o.pathname.endsWith("/")||!c&&!u||(o.pathname+="/"),o}const U=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",H=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],G=(new Set(V),["get",...V]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},K.apply(this,arguments)}const Y=s.createContext(null);const X=s.createContext(null);const J=s.createContext(null);const Q=s.createContext(null);const Z=s.createContext({outlet:null,matches:[],isDataRoute:!1});const ee=s.createContext(null);function te(){return null!=s.useContext(Q)}function re(){return te()||h(!1),s.useContext(Q).location}function ae(e){s.useContext(J).static||s.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=s.useContext(Z);return e?function(){let{router:e}=pe(fe.UseNavigateStable),t=xe(me.UseNavigateStable),r=s.useRef(!1);return ae(()=>{r.current=!0}),s.useCallback(function(a,n){void 0===n&&(n={}),r.current&&("number"===typeof a?e.navigate(a):e.navigate(a,K({fromRouteId:t},n)))},[e,t])}():function(){te()||h(!1);let e=s.useContext(Y),{basename:t,future:r,navigator:a}=s.useContext(J),{matches:n}=s.useContext(Z),{pathname:i}=re(),l=JSON.stringify(M(n,r.v7_relativeSplatPath)),o=s.useRef(!1);return ae(()=>{o.current=!0}),s.useCallback(function(r,n){if(void 0===n&&(n={}),!o.current)return;if("number"===typeof r)return void a.go(r);let s=B(r,JSON.parse(l),i,"path"===n.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:U([t,s.pathname])),(n.replace?a.replace:a.push)(s,n.state,n)},[t,a,l,i,e])}()}const se=s.createContext(null);function ie(e,t){let{relative:r}=void 0===t?{}:t,{future:a}=s.useContext(J),{matches:n}=s.useContext(Z),{pathname:i}=re(),l=JSON.stringify(M(n,a.v7_relativeSplatPath));return s.useMemo(()=>B(e,JSON.parse(l),i,"path"===r),[e,l,i,r])}function le(e,t,r,a){te()||h(!1);let{navigator:i}=s.useContext(J),{matches:l}=s.useContext(Z),o=l[l.length-1],c=o?o.params:{},d=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let u,f=re();if(t){var m;let e="string"===typeof t?x(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||h(!1),u=e}else u=f;let p=u.pathname||"/",g=p;if("/"!==d){let e=d.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=y(e,{pathname:g});let v=he(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:U([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,r,a);return t&&v?s.createElement(Q.Provider,{value:{location:K({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:n.Pop}},v):v}function oe(){let e=function(){var e;let t=s.useContext(ee),r=ge(me.UseRouteError),a=xe(me.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[a]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),r?s.createElement("pre",{style:n},r):null,null)}const ce=s.createElement(oe,null);class de extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(Z.Provider,{value:this.props.routeContext},s.createElement(ee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ue(e){let{routeContext:t,match:r,children:a}=e,n=s.useContext(Y);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),s.createElement(Z.Provider,{value:t},a)}function he(e,t,r,a){var n;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===a&&(a=null),null==e){var i;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(i=a)&&i.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let l=e,o=null==(n=r)?void 0:n.errors;if(null!=o){let e=l.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||h(!1),l=l.slice(0,Math.min(l.length,e+1))}let c=!1,d=-1;if(r&&a&&a.v7_partialHydration)for(let s=0;s<l.length;s++){let e=l[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=s),e.route.id){let{loaderData:t,errors:a}=r,n=e.route.loader&&void 0===t[e.route.id]&&(!a||void 0===a[e.route.id]);if(e.route.lazy||n){c=!0,l=d>=0?l.slice(0,d+1):[l[0]];break}}}return l.reduceRight((e,a,n)=>{let i,u=!1,h=null,f=null;var m;r&&(i=o&&a.route.id?o[a.route.id]:void 0,h=a.route.errorElement||ce,c&&(d<0&&0===n?(m="route-fallback",!1||be[m]||(be[m]=!0),u=!0,f=null):d===n&&(u=!0,f=a.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,n+1)),g=()=>{let t;return t=i?h:u?f:a.route.Component?s.createElement(a.route.Component,null):a.route.element?a.route.element:e,s.createElement(ue,{match:a,routeContext:{outlet:e,matches:p,isDataRoute:null!=r},children:t})};return r&&(a.route.ErrorBoundary||a.route.errorElement||0===n)?s.createElement(de,{location:r.location,revalidation:r.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var fe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(fe||{}),me=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(me||{});function pe(e){let t=s.useContext(Y);return t||h(!1),t}function ge(e){let t=s.useContext(X);return t||h(!1),t}function xe(e){let t=function(){let e=s.useContext(Z);return e||h(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||h(!1),r.route.id}const be={};function ve(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function ye(e){let{to:t,replace:r,state:a,relative:n}=e;te()||h(!1);let{future:i,static:l}=s.useContext(J),{matches:o}=s.useContext(Z),{pathname:c}=re(),d=ne(),u=B(t,M(o,i.v7_relativeSplatPath),c,"path"===n),f=JSON.stringify(u);return s.useEffect(()=>d(JSON.parse(f),{replace:r,state:a,relative:n}),[d,f,n,r,a]),null}function we(e){return function(e){let t=s.useContext(Z).outlet;return t?s.createElement(se.Provider,{value:e},t):t}(e.context)}function Ne(e){h(!1)}function je(e){let{basename:t="/",children:r=null,location:a,navigationType:i=n.Pop,navigator:l,static:o=!1,future:c}=e;te()&&h(!1);let d=t.replace(/^\/*/,"/"),u=s.useMemo(()=>({basename:d,navigator:l,static:o,future:K({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);"string"===typeof a&&(a=x(a));let{pathname:f="/",search:m="",hash:p="",state:g=null,key:b="default"}=a,v=s.useMemo(()=>{let e=D(f,d);return null==e?null:{location:{pathname:e,search:m,hash:p,state:g,key:b},navigationType:i}},[d,f,m,p,g,b,i]);return null==v?null:s.createElement(J.Provider,{value:u},s.createElement(Q.Provider,{children:r,value:v}))}function ke(e){let{children:t,location:r}=e;return le(Se(t),r)}new Promise(()=>{});s.Component;function Se(e,t){void 0===t&&(t=[]);let r=[];return s.Children.forEach(e,(e,a)=>{if(!s.isValidElement(e))return;let n=[...t,a];if(e.type===s.Fragment)return void r.push.apply(r,Se(e.props.children,n));e.type!==Ne&&h(!1),e.props.index&&e.props.children&&h(!1);let i={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Se(e.props.children,n)),r.push(i)}),r}function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ae.apply(this,arguments)}function Ce(e,t){if(null==e)return{};var r,a,n={},s=Object.keys(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}function _e(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(e=>[r,e]):[[r,a]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Te=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ee=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(mT){}const Le=s.createContext({isTransitioning:!1});new Map;const Pe=i.startTransition;c.flushSync,i.useId;function Oe(e){let{basename:t,children:r,future:a,window:n}=e,i=s.useRef();var l;null==i.current&&(i.current=(void 0===(l={window:n,v5Compat:!0})&&(l={}),b(function(e,t){let{pathname:r,search:a,hash:n}=e.location;return p("",{pathname:r,search:a,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:g(t)},null,l)));let o=i.current,[c,d]=s.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},h=s.useCallback(e=>{u&&Pe?Pe(()=>d(e)):d(e)},[d,u]);return s.useLayoutEffect(()=>o.listen(h),[o,h]),s.useEffect(()=>ve(a),[a]),s.createElement(je,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:o,future:a})}const Fe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,De=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ie=s.forwardRef(function(e,t){let r,{onClick:a,relative:n,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:u,viewTransition:f}=e,m=Ce(e,Te),{basename:p}=s.useContext(J),x=!1;if("string"===typeof d&&De.test(d)&&(r=d,Fe))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),r=D(t.pathname,p);t.origin===e.origin&&null!=r?d=r+t.search+t.hash:x=!0}catch(mT){}let b=function(e,t){let{relative:r}=void 0===t?{}:t;te()||h(!1);let{basename:a,navigator:n}=s.useContext(J),{hash:i,pathname:l,search:o}=ie(e,{relative:r}),c=l;return"/"!==a&&(c="/"===l?a:U([a,l])),n.createHref({pathname:c,search:o,hash:i})}(d,{relative:n}),v=function(e,t){let{target:r,replace:a,state:n,preventScrollReset:i,relative:l,viewTransition:o}=void 0===t?{}:t,c=ne(),d=re(),u=ie(e,{relative:l});return s.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();let r=void 0!==a?a:g(d)===g(u);c(e,{replace:r,state:n,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,u,a,n,r,e,i,l,o])}(d,{replace:l,state:o,target:c,preventScrollReset:u,relative:n,viewTransition:f});return s.createElement("a",Ae({},m,{href:r||b,onClick:x||i?a:function(e){a&&a(e),e.defaultPrevented||v(e)},ref:t,target:c}))});const Re=s.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:a=!1,className:n="",end:i=!1,style:l,to:o,viewTransition:c,children:d}=e,u=Ce(e,Ee),f=ie(o,{relative:u.relative}),m=re(),p=s.useContext(X),{navigator:g,basename:x}=s.useContext(J),b=null!=p&&function(e,t){void 0===t&&(t={});let r=s.useContext(Le);null==r&&h(!1);let{basename:a}=Ue(Me.useViewTransitionState),n=ie(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=D(r.currentLocation.pathname,a)||r.currentLocation.pathname,l=D(r.nextLocation.pathname,a)||r.nextLocation.pathname;return null!=O(n.pathname,l)||null!=O(n.pathname,i)}(f)&&!0===c,v=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,y=m.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;a||(y=y.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&x&&(w=D(w,x)||w);const N="/"!==v&&v.endsWith("/")?v.length-1:v.length;let j,k=y===v||!i&&y.startsWith(v)&&"/"===y.charAt(N),S=null!=w&&(w===v||!i&&w.startsWith(v)&&"/"===w.charAt(v.length)),A={isActive:k,isPending:S,isTransitioning:b},C=k?r:void 0;j="function"===typeof n?n(A):[n,k?"active":null,S?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let _="function"===typeof l?l(A):l;return s.createElement(Ie,Ae({},u,{"aria-current":C,className:j,ref:t,style:_,to:o,viewTransition:c}),"function"===typeof d?d(A):d)});var Me,Be;function Ue(e){let t=s.useContext(Y);return t||h(!1),t}function ze(e){let t=s.useRef(_e(e)),r=s.useRef(!1),a=re(),n=s.useMemo(()=>function(e,t){let r=_e(e);return t&&t.forEach((e,a)=>{r.has(a)||t.getAll(a).forEach(e=>{r.append(a,e)})}),r}(a.search,r.current?null:t.current),[a.search]),i=ne(),l=s.useCallback((e,t)=>{const a=_e("function"===typeof e?e(n):e);r.current=!0,i("?"+a,t)},[i,n]);return[n,l]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Me||(Me={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Be||(Be={}));var qe=r(4980);function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach(function(t){(0,qe.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ve(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ge}=Object.prototype,{getPrototypeOf:Ke}=Object,{iterator:Ye,toStringTag:Xe}=Symbol,$e=(Je=Object.create(null),e=>{const t=Ge.call(e);return Je[t]||(Je[t]=t.slice(8,-1).toLowerCase())});var Je;const Qe=e=>(e=e.toLowerCase(),t=>$e(t)===e),Ze=e=>t=>typeof t===e,{isArray:et}=Array,tt=Ze("undefined");function rt(e){return null!==e&&!tt(e)&&null!==e.constructor&&!tt(e.constructor)&&st(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const at=Qe("ArrayBuffer");const nt=Ze("string"),st=Ze("function"),it=Ze("number"),lt=e=>null!==e&&"object"===typeof e,ot=e=>{if("object"!==$e(e))return!1;const t=Ke(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Xe in e)&&!(Ye in e)},ct=Qe("Date"),dt=Qe("File"),ut=Qe("Blob"),ht=Qe("FileList"),ft=Qe("URLSearchParams"),[mt,pt,gt,xt]=["ReadableStream","Request","Response","Headers"].map(Qe);function bt(e,t){let r,a,{allOwnKeys:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),et(e))for(r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else{if(rt(e))return;const a=n?Object.getOwnPropertyNames(e):Object.keys(e),s=a.length;let i;for(r=0;r<s;r++)i=a[r],t.call(null,e[i],i,e)}}function vt(e,t){if(rt(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a,n=r.length;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const yt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,wt=e=>!tt(e)&&e!==yt;const Nt=(jt="undefined"!==typeof Uint8Array&&Ke(Uint8Array),e=>jt&&e instanceof jt);var jt;const kt=Qe("HTMLFormElement"),St=(e=>{let{hasOwnProperty:t}=e;return(e,r)=>t.call(e,r)})(Object.prototype),At=Qe("RegExp"),Ct=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};bt(r,(r,n)=>{let s;!1!==(s=t(r,n,e))&&(a[n]=s||r)}),Object.defineProperties(e,a)};const _t=Qe("AsyncFunction"),Tt=((e,t)=>{return e?setImmediate:t?(r="axios@".concat(Math.random()),a=[],yt.addEventListener("message",e=>{let{source:t,data:n}=e;t===yt&&n===r&&a.length&&a.shift()()},!1),e=>{a.push(e),yt.postMessage(r,"*")}):e=>setTimeout(e);var r,a})("function"===typeof setImmediate,st(yt.postMessage)),Et="undefined"!==typeof queueMicrotask?queueMicrotask.bind(yt):"undefined"!==typeof process&&process.nextTick||Tt,Lt={isArray:et,isArrayBuffer:at,isBuffer:rt,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||st(e.append)&&("formdata"===(t=$e(e))||"object"===t&&st(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&at(e.buffer),t},isString:nt,isNumber:it,isBoolean:e=>!0===e||!1===e,isObject:lt,isPlainObject:ot,isEmptyObject:e=>{if(!lt(e)||rt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(mT){return!1}},isReadableStream:mt,isRequest:pt,isResponse:gt,isHeaders:xt,isUndefined:tt,isDate:ct,isFile:dt,isBlob:ut,isRegExp:At,isFunction:st,isStream:e=>lt(e)&&st(e.pipe),isURLSearchParams:ft,isTypedArray:Nt,isFileList:ht,forEach:bt,merge:function e(){const{caseless:t,skipUndefined:r}=wt(this)&&this||{},a={},n=(n,s)=>{const i=t&&vt(a,s)||s;ot(a[i])&&ot(n)?a[i]=e(a[i],n):ot(n)?a[i]=e({},n):et(n)?a[i]=n.slice():r&&tt(n)||(a[i]=n)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&bt(arguments[s],n);return a},extend:function(e,t,r){let{allOwnKeys:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return bt(t,(t,a)=>{r&&st(t)?e[a]=Ve(t,r):e[a]=t},{allOwnKeys:a}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,a)=>{let n,s,i;const l={};if(t=t||{},null==e)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)i=n[s],a&&!a(i,e,t)||l[i]||(t[i]=e[i],l[i]=!0);e=!1!==r&&Ke(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:$e,kindOfTest:Qe,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return-1!==a&&a===r},toArray:e=>{if(!e)return null;if(et(e))return e;let t=e.length;if(!it(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Ye]).call(e);let a;for(;(a=r.next())&&!a.done;){const r=a.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const a=[];for(;null!==(r=e.exec(t));)a.push(r);return a},isHTMLForm:kt,hasOwnProperty:St,hasOwnProp:St,reduceDescriptors:Ct,freezeMethods:e=>{Ct(e,(t,r)=>{if(st(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const a=e[r];st(a)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},a=e=>{e.forEach(e=>{r[e]=!0})};return et(e)?a(e):a(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:vt,global:yt,isContextDefined:wt,isSpecCompliantForm:function(e){return!!(e&&st(e.append)&&"FormData"===e[Xe]&&e[Ye])},toJSONObject:e=>{const t=new Array(10),r=(e,a)=>{if(lt(e)){if(t.indexOf(e)>=0)return;if(rt(e))return e;if(!("toJSON"in e)){t[a]=e;const n=et(e)?[]:{};return bt(e,(e,t)=>{const s=r(e,a+1);!tt(s)&&(n[t]=s)}),t[a]=void 0,n}}return e};return r(e,0)},isAsyncFn:_t,isThenable:e=>e&&(lt(e)||st(e))&&st(e.then)&&st(e.catch),setImmediate:Tt,asap:Et,isIterable:e=>null!=e&&st(e[Ye])};function Pt(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Lt.inherits(Pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Lt.toJSONObject(this.config),code:this.code,status:this.status}}});const Ot=Pt.prototype,Ft={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ft[e]={value:e}}),Object.defineProperties(Pt,Ft),Object.defineProperty(Ot,"isAxiosError",{value:!0}),Pt.from=(e,t,r,a,n,s)=>{const i=Object.create(Ot);Lt.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const l=e&&e.message?e.message:"Error",o=null==t&&e?e.code:t;return Pt.call(i,l,o,r,a,n),e&&null==i.cause&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",s&&Object.assign(i,s),i};const Dt=Pt;function It(e){return Lt.isPlainObject(e)||Lt.isArray(e)}function Rt(e){return Lt.endsWith(e,"[]")?e.slice(0,-2):e}function Mt(e,t,r){return e?e.concat(t).map(function(e,t){return e=Rt(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}const Bt=Lt.toFlatObject(Lt,{},null,function(e){return/^is[A-Z]/.test(e)});const Ut=function(e,t,r){if(!Lt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const a=(r=Lt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Lt.isUndefined(t[e])})).metaTokens,n=r.visitor||c,s=r.dots,i=r.indexes,l=(r.Blob||"undefined"!==typeof Blob&&Blob)&&Lt.isSpecCompliantForm(t);if(!Lt.isFunction(n))throw new TypeError("visitor must be a function");function o(e){if(null===e)return"";if(Lt.isDate(e))return e.toISOString();if(Lt.isBoolean(e))return e.toString();if(!l&&Lt.isBlob(e))throw new Dt("Blob is not supported. Use a Buffer instead.");return Lt.isArrayBuffer(e)||Lt.isTypedArray(e)?l&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,r,n){let l=e;if(e&&!n&&"object"===typeof e)if(Lt.endsWith(r,"{}"))r=a?r:r.slice(0,-2),e=JSON.stringify(e);else if(Lt.isArray(e)&&function(e){return Lt.isArray(e)&&!e.some(It)}(e)||(Lt.isFileList(e)||Lt.endsWith(r,"[]"))&&(l=Lt.toArray(e)))return r=Rt(r),l.forEach(function(e,a){!Lt.isUndefined(e)&&null!==e&&t.append(!0===i?Mt([r],a,s):null===i?r:r+"[]",o(e))}),!1;return!!It(e)||(t.append(Mt(n,r,s),o(e)),!1)}const d=[],u=Object.assign(Bt,{defaultVisitor:c,convertValue:o,isVisitable:It});if(!Lt.isObject(e))throw new TypeError("data must be an object");return function e(r,a){if(!Lt.isUndefined(r)){if(-1!==d.indexOf(r))throw Error("Circular reference detected in "+a.join("."));d.push(r),Lt.forEach(r,function(r,s){!0===(!(Lt.isUndefined(r)||null===r)&&n.call(t,r,Lt.isString(s)?s.trim():s,a,u))&&e(r,a?a.concat(s):[s])}),d.pop()}}(e),t};function zt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function qt(e,t){this._pairs=[],e&&Ut(e,this,t)}const Ht=qt.prototype;Ht.append=function(e,t){this._pairs.push([e,t])},Ht.toString=function(e){const t=e?function(t){return e.call(this,t,zt)}:zt;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Wt=qt;function Vt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Gt(e,t,r){if(!t)return e;const a=r&&r.encode||Vt;Lt.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let s;if(s=n?n(t,r):Lt.isURLSearchParams(t)?t.toString():new Wt(t,r).toString(a),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const Kt=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Lt.forEach(this.handlers,function(t){null!==t&&e(t)})}},Yt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Xt={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Wt,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},$t="undefined"!==typeof window&&"undefined"!==typeof document,Jt="object"===typeof navigator&&navigator||void 0,Qt=$t&&(!Jt||["ReactNative","NativeScript","NS"].indexOf(Jt.product)<0),Zt="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,er=$t&&window.location.href||"http://localhost",tr=We(We({},a),Xt);const rr=function(e){function t(e,r,a,n){let s=e[n++];if("__proto__"===s)return!0;const i=Number.isFinite(+s),l=n>=e.length;if(s=!s&&Lt.isArray(a)?a.length:s,l)return Lt.hasOwnProp(a,s)?a[s]=[a[s],r]:a[s]=r,!i;a[s]&&Lt.isObject(a[s])||(a[s]=[]);return t(e,r,a[s],n)&&Lt.isArray(a[s])&&(a[s]=function(e){const t={},r=Object.keys(e);let a;const n=r.length;let s;for(a=0;a<n;a++)s=r[a],t[s]=e[s];return t}(a[s])),!i}if(Lt.isFormData(e)&&Lt.isFunction(e.entries)){const r={};return Lt.forEachEntry(e,(e,a)=>{t(function(e){return Lt.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),a,r,0)}),r}return null};const ar={transitional:Yt,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,n=Lt.isObject(e);n&&Lt.isHTMLForm(e)&&(e=new FormData(e));if(Lt.isFormData(e))return a?JSON.stringify(rr(e)):e;if(Lt.isArrayBuffer(e)||Lt.isBuffer(e)||Lt.isStream(e)||Lt.isFile(e)||Lt.isBlob(e)||Lt.isReadableStream(e))return e;if(Lt.isArrayBufferView(e))return e.buffer;if(Lt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ut(e,new tr.classes.URLSearchParams,We({visitor:function(e,t,r,a){return tr.isNode&&Lt.isBuffer(e)?(this.append(t,e.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=Lt.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ut(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return n||a?(t.setContentType("application/json",!1),function(e,t,r){if(Lt.isString(e))try{return(t||JSON.parse)(e),Lt.trim(e)}catch(mT){if("SyntaxError"!==mT.name)throw mT}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ar.transitional,r=t&&t.forcedJSONParsing,a="json"===this.responseType;if(Lt.isResponse(e)||Lt.isReadableStream(e))return e;if(e&&Lt.isString(e)&&(r&&!this.responseType||a)){const r=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(e,this.parseReviver)}catch(mT){if(r){if("SyntaxError"===mT.name)throw Dt.from(mT,Dt.ERR_BAD_RESPONSE,this,null,this.response);throw mT}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tr.classes.FormData,Blob:tr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Lt.forEach(["delete","get","head","post","put","patch"],e=>{ar.headers[e]={}});const nr=ar,sr=Lt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ir=Symbol("internals");function lr(e){return e&&String(e).trim().toLowerCase()}function or(e){return!1===e||null==e?e:Lt.isArray(e)?e.map(or):String(e)}function cr(e,t,r,a,n){return Lt.isFunction(a)?a.call(this,t,r):(n&&(t=r),Lt.isString(t)?Lt.isString(a)?-1!==t.indexOf(a):Lt.isRegExp(a)?a.test(t):void 0:void 0)}class dr{constructor(e){e&&this.set(e)}set(e,t,r){const a=this;function n(e,t,r){const n=lr(t);if(!n)throw new Error("header name must be a non-empty string");const s=Lt.findKey(a,n);(!s||void 0===a[s]||!0===r||void 0===r&&!1!==a[s])&&(a[s||t]=or(e))}const s=(e,t)=>Lt.forEach(e,(e,r)=>n(e,r,t));if(Lt.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Lt.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let r,a,n;return e&&e.split("\n").forEach(function(e){n=e.indexOf(":"),r=e.substring(0,n).trim().toLowerCase(),a=e.substring(n+1).trim(),!r||t[r]&&sr[r]||("set-cookie"===r?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t})(e),t);else if(Lt.isObject(e)&&Lt.isIterable(e)){let r,a,n={};for(const t of e){if(!Lt.isArray(t))throw TypeError("Object iterator must return a key-value pair");n[a=t[0]]=(r=n[a])?Lt.isArray(r)?[...r,t[1]]:[r,t[1]]:t[1]}s(n,t)}else null!=e&&n(t,e,r);return this}get(e,t){if(e=lr(e)){const r=Lt.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}(e);if(Lt.isFunction(t))return t.call(this,e,r);if(Lt.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=lr(e)){const r=Lt.findKey(this,e);return!(!r||void 0===this[r]||t&&!cr(0,this[r],r,t))}return!1}delete(e,t){const r=this;let a=!1;function n(e){if(e=lr(e)){const n=Lt.findKey(r,e);!n||t&&!cr(0,r[n],n,t)||(delete r[n],a=!0)}}return Lt.isArray(e)?e.forEach(n):n(e),a}clear(e){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const n=t[r];e&&!cr(0,this[n],n,e,!0)||(delete this[n],a=!0)}return a}normalize(e){const t=this,r={};return Lt.forEach(this,(a,n)=>{const s=Lt.findKey(r,n);if(s)return t[s]=or(a),void delete t[n];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}(n):String(n).trim();i!==n&&delete t[n],t[i]=or(a),r[i]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Lt.forEach(this,(r,a)=>{null!=r&&!1!==r&&(t[a]=e&&Lt.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,r]=e;return t+": "+r}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[ir]=this[ir]={accessors:{}}).accessors,r=this.prototype;function a(e){const a=lr(e);t[a]||(!function(e,t){const r=Lt.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(e,r,n){return this[a].call(this,t,e,r,n)},configurable:!0})})}(r,e),t[a]=!0)}return Lt.isArray(e)?e.forEach(a):a(e),this}}dr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Lt.reduceDescriptors(dr.prototype,(e,t)=>{let{value:r}=e,a=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(e){this[a]=e}}}),Lt.freezeMethods(dr);const ur=dr;function hr(e,t){const r=this||nr,a=t||r,n=ur.from(a.headers);let s=a.data;return Lt.forEach(e,function(e){s=e.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function fr(e){return!(!e||!e.__CANCEL__)}function mr(e,t,r){Dt.call(this,null==e?"canceled":e,Dt.ERR_CANCELED,t,r),this.name="CanceledError"}Lt.inherits(mr,Dt,{__CANCEL__:!0});const pr=mr;function gr(e,t,r){const a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(new Dt("Request failed with status code "+r.status,[Dt.ERR_BAD_REQUEST,Dt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}const xr=function(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n,s=0,i=0;return t=void 0!==t?t:1e3,function(l){const o=Date.now(),c=a[i];n||(n=o),r[s]=l,a[s]=o;let d=i,u=0;for(;d!==s;)u+=r[d++],d%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),o-n<t)return;const h=c&&o-c;return h?Math.round(1e3*u/h):void 0}};const br=function(e,t){let r,a,n=0,s=1e3/t;const i=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();n=s,r=null,a&&(clearTimeout(a),a=null),e(...t)};return[function(){const e=Date.now(),t=e-n;for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];t>=s?i(o,e):(r=o,a||(a=setTimeout(()=>{a=null,i(r)},s-t)))},()=>r&&i(r)]},vr=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=0;const n=xr(50,250);return br(r=>{const s=r.loaded,i=r.lengthComputable?r.total:void 0,l=s-a,o=n(l);a=s;e({loaded:s,total:i,progress:i?s/i:void 0,bytes:l,rate:o||void 0,estimated:o&&i&&s<=i?(i-s)/o:void 0,event:r,lengthComputable:null!=i,[t?"download":"upload"]:!0})},r)},yr=(e,t)=>{const r=null!=e;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},wr=e=>function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return Lt.asap(()=>e(...r))},Nr=tr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,tr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(tr.origin),tr.navigator&&/(msie|trident)/i.test(tr.navigator.userAgent)):()=>!0,jr=tr.hasStandardBrowserEnv?{write(e,t,r,a,n,s){const i=[e+"="+encodeURIComponent(t)];Lt.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),Lt.isString(a)&&i.push("path="+a),Lt.isString(n)&&i.push("domain="+n),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function kr(e,t,r){let a=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(a||0==r)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Sr=e=>e instanceof ur?We({},e):e;function Ar(e,t){t=t||{};const r={};function a(e,t,r,a){return Lt.isPlainObject(e)&&Lt.isPlainObject(t)?Lt.merge.call({caseless:a},e,t):Lt.isPlainObject(t)?Lt.merge({},t):Lt.isArray(t)?t.slice():t}function n(e,t,r,n){return Lt.isUndefined(t)?Lt.isUndefined(e)?void 0:a(void 0,e,0,n):a(e,t,0,n)}function s(e,t){if(!Lt.isUndefined(t))return a(void 0,t)}function i(e,t){return Lt.isUndefined(t)?Lt.isUndefined(e)?void 0:a(void 0,e):a(void 0,t)}function l(r,n,s){return s in t?a(r,n):s in e?a(void 0,r):void 0}const o={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(e,t,r)=>n(Sr(e),Sr(t),0,!0)};return Lt.forEach(Object.keys(We(We({},e),t)),function(a){const s=o[a]||n,i=s(e[a],t[a],a);Lt.isUndefined(i)&&s!==l||(r[a]=i)}),r}const Cr=e=>{const t=Ar({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:s,headers:i,auth:l}=t;if(t.headers=i=ur.from(i),t.url=Gt(kr(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Lt.isFormData(r))if(tr.hasStandardBrowserEnv||tr.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Lt.isFunction(r.getHeaders)){const e=r.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[r,a]=e;t.includes(r.toLowerCase())&&i.set(r,a)})}if(tr.hasStandardBrowserEnv&&(a&&Lt.isFunction(a)&&(a=a(t)),a||!1!==a&&Nr(t.url))){const e=n&&s&&jr.read(s);e&&i.set(n,e)}return t},_r="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,r){const a=Cr(e);let n=a.data;const s=ur.from(a.headers).normalize();let i,l,o,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:f}=a;function m(){c&&c(),d&&d(),a.cancelToken&&a.cancelToken.unsubscribe(i),a.signal&&a.signal.removeEventListener("abort",i)}let p=new XMLHttpRequest;function g(){if(!p)return;const a=ur.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());gr(function(e){t(e),m()},function(e){r(e),m()},{data:u&&"text"!==u&&"json"!==u?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:a,config:e,request:p}),p=null}p.open(a.method.toUpperCase(),a.url,!0),p.timeout=a.timeout,"onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(g)},p.onabort=function(){p&&(r(new Dt("Request aborted",Dt.ECONNABORTED,e,p)),p=null)},p.onerror=function(t){const a=t&&t.message?t.message:"Network Error",n=new Dt(a,Dt.ERR_NETWORK,e,p);n.event=t||null,r(n),p=null},p.ontimeout=function(){let t=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const n=a.transitional||Yt;a.timeoutErrorMessage&&(t=a.timeoutErrorMessage),r(new Dt(t,n.clarifyTimeoutError?Dt.ETIMEDOUT:Dt.ECONNABORTED,e,p)),p=null},void 0===n&&s.setContentType(null),"setRequestHeader"in p&&Lt.forEach(s.toJSON(),function(e,t){p.setRequestHeader(t,e)}),Lt.isUndefined(a.withCredentials)||(p.withCredentials=!!a.withCredentials),u&&"json"!==u&&(p.responseType=a.responseType),f&&([o,d]=vr(f,!0),p.addEventListener("progress",o)),h&&p.upload&&([l,c]=vr(h),p.upload.addEventListener("progress",l),p.upload.addEventListener("loadend",c)),(a.cancelToken||a.signal)&&(i=t=>{p&&(r(!t||t.type?new pr(null,e,p):t),p.abort(),p=null)},a.cancelToken&&a.cancelToken.subscribe(i),a.signal&&(a.signal.aborted?i():a.signal.addEventListener("abort",i)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(a.url);x&&-1===tr.protocols.indexOf(x)?r(new Dt("Unsupported protocol "+x+":",Dt.ERR_BAD_REQUEST,e)):p.send(n||null)})},Tr=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,a=new AbortController;const n=function(e){if(!r){r=!0,i();const t=e instanceof Error?e:this.reason;a.abort(t instanceof Dt?t:new pr(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,n(new Dt("timeout ".concat(t," of ms exceeded"),Dt.ETIMEDOUT))},t);const i=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(n):e.removeEventListener("abort",n)}),e=null)};e.forEach(e=>e.addEventListener("abort",n));const{signal:l}=a;return l.unsubscribe=()=>Lt.asap(i),l}};function Er(e,t){this.v=e,this.k=t}function Lr(e){return function(){return new Pr(e.apply(this,arguments))}}function Pr(e){var t,r;function a(t,r){try{var s=e[t](r),i=s.value,l=i instanceof Er;Promise.resolve(l?i.v:i).then(function(r){if(l){var o="return"===t?"return":"next";if(!i.k||r.done)return a(o,r);r=e[o](r).value}n(s.done?"return":"normal",r)},function(e){a("throw",e)})}catch(e){n("throw",e)}}function n(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?a(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(s,i){var l={key:e,arg:n,resolve:s,reject:i,next:null};r?r=r.next=l:(t=r=l,a(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function Or(e){return new Er(e,0)}function Fr(e){var t={},r=!1;function a(t,a){return r=!0,a=new Promise(function(r){r(e[t](a))}),{done:!1,value:new Er(a,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):a("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return a("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):a("return",e)}),t}function Dr(e){var t,r,a,n=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,a=Symbol.iterator);n--;){if(r&&null!=(t=e[r]))return t.call(e);if(a&&null!=(t=e[a]))return new Ir(t.call(e));r="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function Ir(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Ir=function(e){this.s=e,this.n=e.next},Ir.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new Ir(e)}Pr.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Pr.prototype.next=function(e){return this._invoke("next",e)},Pr.prototype.throw=function(e){return this._invoke("throw",e)},Pr.prototype.return=function(e){return this._invoke("return",e)};const Rr=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let a,n=0;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},Mr=function(){var e=Lr(function*(e,t){var r,a=!1,n=!1;try{for(var s,i=Dr(Br(e));a=!(s=yield Or(i.next())).done;a=!1){const e=s.value;yield*Fr(Dr(Rr(e,t)))}}catch(l){n=!0,r=l}finally{try{a&&null!=i.return&&(yield Or(i.return()))}finally{if(n)throw r}}});return function(t,r){return e.apply(this,arguments)}}(),Br=function(){var e=Lr(function*(e){if(e[Symbol.asyncIterator])return void(yield*Fr(Dr(e)));const t=e.getReader();try{for(;;){const{done:e,value:r}=yield Or(t.read());if(e)break;yield r}}finally{yield Or(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),Ur=(e,t,r,a)=>{const n=Mr(e,t);let s,i=0,l=e=>{s||(s=!0,a&&a(e))};return new ReadableStream({async pull(e){try{const{done:t,value:a}=await n.next();if(t)return l(),void e.close();let s=a.byteLength;if(r){let e=i+=s;r(e)}e.enqueue(new Uint8Array(a))}catch(t){throw l(t),t}},cancel:e=>(l(e),n.return())},{highWaterMark:2})},{isFunction:zr}=Lt,qr=(e=>{let{Request:t,Response:r}=e;return{Request:t,Response:r}})(Lt.global),{ReadableStream:Hr,TextEncoder:Wr}=Lt.global,Vr=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return!!e(...r)}catch(mT){return!1}},Gr=e=>{e=Lt.merge.call({skipUndefined:!0},qr,e);const{fetch:t,Request:r,Response:a}=e,n=t?zr(t):"function"===typeof fetch,s=zr(r),i=zr(a);if(!n)return!1;const l=n&&zr(Hr),o=n&&("function"===typeof Wr?(e=>t=>e.encode(t))(new Wr):async e=>new Uint8Array(await new r(e).arrayBuffer())),c=s&&l&&Vr(()=>{let e=!1;const t=new r(tr.origin,{body:new Hr,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),d=i&&l&&Vr(()=>Lt.isReadableStream(new a("").body)),u={stream:d&&(e=>e.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!u[e]&&(u[e]=(t,r)=>{let a=t&&t[e];if(a)return a.call(t);throw new Dt("Response type '".concat(e,"' is not supported"),Dt.ERR_NOT_SUPPORT,r)})});const h=async(e,t)=>{const a=Lt.toFiniteNumber(e.getContentLength());return null==a?(async e=>{if(null==e)return 0;if(Lt.isBlob(e))return e.size;if(Lt.isSpecCompliantForm(e)){const t=new r(tr.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Lt.isArrayBufferView(e)||Lt.isArrayBuffer(e)?e.byteLength:(Lt.isURLSearchParams(e)&&(e+=""),Lt.isString(e)?(await o(e)).byteLength:void 0)})(t):a};return async e=>{let{url:n,method:i,data:l,signal:o,cancelToken:f,timeout:m,onDownloadProgress:p,onUploadProgress:g,responseType:x,headers:b,withCredentials:v="same-origin",fetchOptions:y}=Cr(e),w=t||fetch;x=x?(x+"").toLowerCase():"text";let N=Tr([o,f&&f.toAbortSignal()],m),j=null;const k=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let S;try{if(g&&c&&"get"!==i&&"head"!==i&&0!==(S=await h(b,l))){let e,t=new r(n,{method:"POST",body:l,duplex:"half"});if(Lt.isFormData(l)&&(e=t.headers.get("content-type"))&&b.setContentType(e),t.body){const[e,r]=yr(S,vr(wr(g)));l=Ur(t.body,65536,e,r)}}Lt.isString(v)||(v=v?"include":"omit");const t=s&&"credentials"in r.prototype,o=We(We({},y),{},{signal:N,method:i.toUpperCase(),headers:b.normalize().toJSON(),body:l,duplex:"half",credentials:t?v:void 0});j=s&&new r(n,o);let f=await(s?w(j,y):w(n,o));const m=d&&("stream"===x||"response"===x);if(d&&(p||m&&k)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=f[t]});const t=Lt.toFiniteNumber(f.headers.get("content-length")),[r,n]=p&&yr(t,vr(wr(p),!0))||[];f=new a(Ur(f.body,65536,r,()=>{n&&n(),k&&k()}),e)}x=x||"text";let A=await u[Lt.findKey(u,x)||"text"](f,e);return!m&&k&&k(),await new Promise((t,r)=>{gr(t,r,{data:A,headers:ur.from(f.headers),status:f.status,statusText:f.statusText,config:e,request:j})})}catch(A){if(k&&k(),A&&"TypeError"===A.name&&/Load failed|fetch/i.test(A.message))throw Object.assign(new Dt("Network Error",Dt.ERR_NETWORK,e,j),{cause:A.cause||A});throw Dt.from(A,A&&A.code,e,j)}}},Kr=new Map,Yr=e=>{let t=e?e.env:{};const{fetch:r,Request:a,Response:n}=t,s=[a,n,r];let i,l,o=s.length,c=Kr;for(;o--;)i=s[o],l=c.get(i),void 0===l&&c.set(i,l=o?new Map:Gr(t)),c=l;return l},Xr=(Yr(),{http:null,xhr:_r,fetch:{get:Yr}});Lt.forEach(Xr,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(mT){}Object.defineProperty(e,"adapterName",{value:t})}});const $r=e=>"- ".concat(e),Jr=e=>Lt.isFunction(e)||null===e||!1===e,Qr=(e,t)=>{e=Lt.isArray(e)?e:[e];const{length:r}=e;let a,n;const s={};for(let i=0;i<r;i++){let r;if(a=e[i],n=a,!Jr(a)&&(n=Xr[(r=String(a)).toLowerCase()],void 0===n))throw new Dt("Unknown adapter '".concat(r,"'"));if(n&&(Lt.isFunction(n)||(n=n.get(t))))break;s[r||"#"+i]=n}if(!n){const e=Object.entries(s).map(e=>{let[t,r]=e;return"adapter ".concat(t," ")+(!1===r?"is not supported by the environment":"is not available in the build")});let t=r?e.length>1?"since :\n"+e.map($r).join("\n"):" "+$r(e[0]):"as no adapter specified";throw new Dt("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return n};function Zr(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new pr(null,e)}function ea(e){Zr(e),e.headers=ur.from(e.headers),e.data=hr.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Qr(e.adapter||nr.adapter,e)(e).then(function(t){return Zr(e),t.data=hr.call(e,e.transformResponse,t),t.headers=ur.from(t.headers),t},function(t){return fr(t)||(Zr(e),t&&t.response&&(t.response.data=hr.call(e,e.transformResponse,t.response),t.response.headers=ur.from(t.response.headers))),Promise.reject(t)})}const ta="1.12.2",ra={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ra[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const aa={};ra.transitional=function(e,t,r){function a(e,t){return"[Axios v"+ta+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,n,s)=>{if(!1===e)throw new Dt(a(n," has been removed"+(t?" in "+t:"")),Dt.ERR_DEPRECATED);return t&&!aa[n]&&(aa[n]=!0,console.warn(a(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,s)}},ra.spelling=function(e){return(t,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};const na={assertOptions:function(e,t,r){if("object"!==typeof e)throw new Dt("options must be an object",Dt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const s=a[n],i=t[s];if(i){const t=e[s],r=void 0===t||i(t,s,e);if(!0!==r)throw new Dt("option "+s+" must be "+r,Dt.ERR_BAD_OPTION_VALUE);continue}if(!0!==r)throw new Dt("Unknown option "+s,Dt.ERR_BAD_OPTION)}},validators:ra},sa=na.validators;class ia{constructor(e){this.defaults=e||{},this.interceptors={request:new Kt,response:new Kt}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{r.stack?t&&!String(r.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(r.stack+="\n"+t):r.stack=t}catch(mT){}}throw r}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Ar(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:n}=t;void 0!==r&&na.assertOptions(r,{silentJSONParsing:sa.transitional(sa.boolean),forcedJSONParsing:sa.transitional(sa.boolean),clarifyTimeoutError:sa.transitional(sa.boolean)},!1),null!=a&&(Lt.isFunction(a)?t.paramsSerializer={serialize:a}:na.assertOptions(a,{encode:sa.function,serialize:sa.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),na.assertOptions(t,{baseUrl:sa.spelling("baseURL"),withXsrfToken:sa.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=n&&Lt.merge(n.common,n[t.method]);n&&Lt.forEach(["delete","get","head","post","put","patch","common"],e=>{delete n[e]}),t.headers=ur.concat(s,n);const i=[];let l=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(l=l&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const o=[];let c;this.interceptors.response.forEach(function(e){o.push(e.fulfilled,e.rejected)});let d,u=0;if(!l){const e=[ea.bind(this),void 0];for(e.unshift(...i),e.push(...o),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=i.length;let h=t;for(;u<d;){const e=i[u++],t=i[u++];try{h=e(h)}catch(f){t.call(this,f);break}}try{c=ea.call(this,h)}catch(f){return Promise.reject(f)}for(u=0,d=o.length;u<d;)c=c.then(o[u++],o[u++]);return c}getUri(e){return Gt(kr((e=Ar(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Lt.forEach(["delete","get","head","options"],function(e){ia.prototype[e]=function(t,r){return this.request(Ar(r||{},{method:e,url:t,data:(r||{}).data}))}}),Lt.forEach(["post","put","patch"],function(e){function t(t){return function(r,a,n){return this.request(Ar(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:a}))}}ia.prototype[e]=t(),ia.prototype[e+"Form"]=t(!0)});const la=ia;class oa{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t;const a=new Promise(e=>{r.subscribe(e),t=e}).then(e);return a.cancel=function(){r.unsubscribe(t)},a},e(function(e,a,n){r.reason||(r.reason=new pr(e,a,n),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new oa(function(t){e=t});return{token:t,cancel:e}}}const ca=oa;const da={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(da).forEach(e=>{let[t,r]=e;da[r]=t});const ua=da;const ha=function e(t){const r=new la(t),a=Ve(la.prototype.request,r);return Lt.extend(a,la.prototype,r,{allOwnKeys:!0}),Lt.extend(a,r,null,{allOwnKeys:!0}),a.create=function(r){return e(Ar(t,r))},a}(nr);ha.Axios=la,ha.CanceledError=pr,ha.CancelToken=ca,ha.isCancel=fr,ha.VERSION=ta,ha.toFormData=Ut,ha.AxiosError=Dt,ha.Cancel=ha.CanceledError,ha.all=function(e){return Promise.all(e)},ha.spread=function(e){return function(t){return e.apply(null,t)}},ha.isAxiosError=function(e){return Lt.isObject(e)&&!0===e.isAxiosError},ha.mergeConfig=Ar,ha.AxiosHeaders=ur,ha.formToJSON=e=>rr(Lt.isHTMLForm(e)?new FormData(e):e),ha.getAdapter=Qr,ha.HttpStatusCode=ua,ha.default=ha;const fa=ha,ma="https://crm.scanwellapps.com/api",pa=fa.create({baseURL:ma,withCredentials:!0});var ga=r(579);const xa=(0,s.createContext)(),ba=e=>{let{children:t}=e;const[r,a]=(0,s.useState)(null),[n,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(!0),c=async e=>{try{const t=await pa.get("/auth/info/".concat(e));console.log("this is permission: ",t),i(t.data)}catch(t){i(null)}finally{o(!1)}};(0,s.useEffect)(()=>{(async()=>{try{const e=await pa.get("/auth/me");a({id:e.data.id,username:e.data.username,isAuthenticated:!0}),c(e.data.id)}catch(e){a(null)}finally{o(!1)}})()},[]);return(0,ga.jsx)(xa.Provider,{value:{user:r,login:e=>{a(We(We({},e),{},{isAuthenticated:!0}))},logout:()=>{a(null),window.location.href="/login"},loading:l,permission:n},children:t})},va=()=>{const{user:e,loading:t}=(0,s.useContext)(xa);return console.log("ProtectedRoute:",{user:e,loading:t}),t?(0,ga.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),(0,ga.jsx)("p",{className:"text-xl font-semibold text-blue-800",children:"Loading your dashboard..."})]})}):e?(0,ga.jsx)(we,{}):(0,ga.jsx)(ye,{to:"/login",replace:!0})},ya=r.p+"static/media/logo.2605e2b8067f593472b6.png",wa=r.p+"static/media/app_logo.47e8e89d0a34644ec486.png";function Na(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const ja=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},ka=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var Sa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Aa=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Ca=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:l="",children:o,iconNode:c}=e,d=Na(e,Aa);return(0,s.createElement)("svg",We(We(We({ref:t},Sa),{},{width:a,height:a,stroke:r,strokeWidth:i?24*Number(n)/Number(a):n,className:ka("lucide",l)},!o&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"}),d),[...c.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),_a=["className"],Ta=(e,t)=>{const r=(0,s.forwardRef)((r,a)=>{let{className:n}=r,i=Na(r,_a);return(0,s.createElement)(Ca,We({ref:a,iconNode:t,className:ka("lucide-".concat((l=ja(e),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),n)},i));var l});return r.displayName=ja(e),r},Ea=Ta("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),La=Ta("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),Pa=Ta("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),Oa=Ta("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Fa=Ta("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),Da=async e=>(await fa.get("".concat(ma,"/UserRole/employee-details/").concat(e))).data,Ia={fetchUserRoles:async()=>(await fa.get("".concat(ma,"/UserRole/user-roles"))).data,fetchUserRoleById:async e=>(await fa.get("".concat(ma,"/UserRole/user-roles/").concat(e))).data,createUserRole:async e=>(await fa.post("".concat(ma,"/UserRole/user-roles"),e)).data,updateUserRole:async(e,t)=>(await fa.put("".concat(ma,"/UserRole/user-roles/").concat(e),t)).data,deleteUserRole:async e=>(await fa.delete("".concat(ma,"/UserRole/user-roles/").concat(e))).data,fetchUserDetailsByRoleID:Da};const Ra=function(e){let{onMenuToggle:t,isMobileMenuOpen:r}=e;const[a,n]=(0,s.useState)(!1),[i,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),d=(0,s.useRef)(null),{user:u}=(0,s.useContext)(xa);(0,s.useEffect)(()=>{console.log("Current user in header:",u),h(u.id)},[u]);const h=async e=>{try{const t=await Da(e);console.log("Fetched user data:",t),t&&t.length>0&&c(t[0])}catch(t){console.error("Error fetching user details:",t)}},f=()=>{var e,t;if(!o)return"K";return((null===(e=o.firstName)||void 0===e?void 0:e.charAt(0).toUpperCase())||"")+((null===(t=o.lastName)||void 0===t?void 0:t.charAt(0).toUpperCase())||"")};return(0,s.useEffect)(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&l(!1)};return i&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[i]),(0,ga.jsxs)("header",{className:"fixed top-0 left-0 right-0 w-full h-14 bg-white/95 backdrop-blur-md border-b border-slate-200 flex items-center justify-between px-4 md:px-6 z-50 shadow-sm",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-slate-100 transition-all duration-200 active:scale-95","aria-label":r?"Close menu":"Open menu",children:r?(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-600"}):(0,ga.jsx)(La,{className:"w-5 h-5 text-slate-600"})}),(0,ga.jsx)("div",{className:"flex items-center",children:(0,ga.jsx)("img",{src:wa,alt:"Company Logo",className:"h-12 w-auto transition-transform hover:scale-105"})})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,ga.jsxs)("div",{className:"relative group",children:[(0,ga.jsx)("button",{onClick:()=>n(!a),className:"p-2 rounded-lg hover:bg-slate-100 transition-all duration-200 active:scale-95 relative","aria-label":"Notifications",children:(0,ga.jsx)(Pa,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,ga.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"Notifications"})]}),(0,ga.jsxs)("div",{className:"relative",ref:d,children:[(0,ga.jsx)("button",{onClick:()=>l(!i),className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 active:scale-95","aria-label":"User profile",children:(0,ga.jsx)("span",{className:"text-sm font-semibold",children:f()})}),i&&(0,ga.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-slate-200 py-2 z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,ga.jsx)("div",{className:"px-4 py-3 border-b border-slate-100",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center",children:(0,ga.jsx)("span",{className:"text-sm font-semibold",children:f()})}),(0,ga.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ga.jsx)("p",{className:"text-sm font-semibold text-slate-900 truncate",children:u.username}),(0,ga.jsx)("p",{className:"text-xs text-slate-500 truncate",children:(null===o||void 0===o?void 0:o.email)||"Loading..."})]})]})}),(0,ga.jsxs)("div",{className:"py-1",children:[(0,ga.jsxs)("button",{className:"w-full px-4 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 transition-colors flex items-center gap-3",onClick:()=>{l(!1),console.log("Navigate to profile")},children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-slate-500"}),(0,ga.jsx)("span",{children:"My Profile"})]}),(0,ga.jsxs)("button",{className:"w-full px-4 py-2.5 text-left text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center gap-3",onClick:()=>{l(!1),(async()=>{try{const e=await pa.post("".concat(ma,"/auth/logout"));console.log("Logging out...",e),window.location.href="/login"}catch(e){console.log("error when logout",e)}})()},children:[(0,ga.jsx)(Fa,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Logout"})]})]})]})]})]})]})},Ma=Ta("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),Ba=Ta("chart-line",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),Ua=Ta("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),za=Ta("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),qa=Ta("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),Ha=Ta("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Wa=Ta("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),Va=Ta("circle-dollar-sign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]),Ga=Ta("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ka=Ta("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Ya=Ta("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Xa=Ta("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);function $a(e){let{isOpen:t,onClose:r,scrollBottom:a=!1}=e;const n=(0,s.useRef)(null),{permission:i}=(0,s.useContext)(xa);(0,s.useEffect)(()=>{a&&n.current&&(n.current.scrollTop=n.current.scrollHeight)},[]);const l=[{path:"/dashboard",icon:Ma,label:"Dashboard"},{path:"/rates",icon:Ba,label:"Rates Manage",permissionKey:"RateManageView"},{path:"/usefull-link",icon:Ua,label:"Useful Links",permissionKey:"UsefulLinksView"},{path:"/leads",icon:za,label:"Social Leads"},{path:"/mail-tracking",icon:qa,label:"Email Leads"}],o=[{path:"/sales-plans",icon:Ha,label:"Sales Plans",permissionKey:"SalesPlanView"},{path:"/quotes-invoices",icon:Wa,label:"Quotes",permissionKey:"QuotesView"},{path:"/rfq",icon:Va,label:"RFQ",permissionKey:"RfqView"},{path:"/accounts",icon:Ga,label:"Accounts",permissionKey:"AccountView"}],c=[{path:"/hr/manage",icon:Ka,label:"Resources",permissionKey:"SystemManagementView"},{path:"/hr/manage-employee",icon:Ya,label:"Employee",permissionKey:"SystemManagementView"},{path:"/rolebase",icon:Xa,label:"Role Manage",permissionKey:"SystemManagementView"}],d=(e,t)=>t?e.filter(e=>!e.permissionKey||t[e.permissionKey]):[],u=e=>{let{path:t,icon:a,label:n}=e;return(0,ga.jsx)(Re,{to:t,onClick:()=>{window.innerWidth<1024&&(null===r||void 0===r||r())},className:e=>{let{isActive:t}=e;return"flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 group ".concat(t?"bg-blue-50 text-blue-700 border-l-4 border-blue-600 shadow-sm":"hover:bg-slate-50 text-slate-700 hover:text-slate-900")},children:e=>{let{isActive:t}=e;return(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(a,{className:"w-5 h-5 transition-colors ".concat(t?"text-blue-600":"text-slate-500 group-hover:text-slate-700")}),(0,ga.jsx)("span",{className:"font-medium truncate",children:n})]})}})};return(0,ga.jsxs)(ga.Fragment,{children:[t&&(0,ga.jsx)("div",{className:"fixed inset-0 top-14 bg-black/20 backdrop-blur-sm z-40 lg:hidden",onClick:r}),(0,ga.jsxs)("aside",{className:"\n        fixed lg:relative \n        top-14 lg:top-0 left-0 \n        z-50 lg:z-auto\n        w-72 lg:w-64 \n        h-[calc(100vh-3.5rem)] lg:min-h-full\n        bg-white \n        shadow-xl lg:shadow-md \n        border-r border-slate-200\n        transform transition-transform duration-300 ease-in-out lg:transform-none\n        ".concat(t?"translate-x-0":"-translate-x-full lg:translate-x-0","\n        flex flex-col\n        overflow-y-auto\n      "),children:[(0,ga.jsx)("div",{className:"lg:hidden px-4 py-4 border-b border-slate-200",children:(0,ga.jsx)("h2",{className:"text-lg font-semibold text-slate-800",children:"Navigation"})}),(0,ga.jsxs)("div",{ref:n,className:"flex-1 p-4 overflow-y-auto",children:[(0,ga.jsxs)("nav",{className:"space-y-1 mb-6",children:[(0,ga.jsx)("div",{className:"flex items-center justify-between",children:(0,ga.jsx)("h3",{className:"text-sm font-semibold text-slate-600 uppercase tracking-wider",children:"Info"})}),(0,ga.jsx)("div",{className:"h-px bg-slate-200"}),d(l,i).map(e=>(0,ga.jsx)(u,{path:e.path,icon:e.icon,label:e.label},e.path))]}),(0,ga.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,ga.jsx)("div",{className:"flex items-center justify-between",children:(0,ga.jsx)("h3",{className:"text-sm font-semibold text-slate-600 uppercase tracking-wider",children:"Workspaces"})}),(0,ga.jsx)("div",{className:"h-px bg-slate-200"}),(0,ga.jsx)("nav",{className:"space-y-1",children:d(o,i).map(e=>(0,ga.jsx)(u,{path:e.path,icon:e.icon,label:e.label},e.path))})]}),i&&(i.IsAdmin||i.SystemManagementView)&&(0,ga.jsxs)("div",{className:"space-y-3",children:[(0,ga.jsx)("div",{className:"flex items-center justify-between",children:(0,ga.jsx)("h3",{className:"text-sm font-semibold text-orange-600 uppercase tracking-wider",children:"System Management"})}),(0,ga.jsx)("div",{className:"h-px bg-orange-200"}),(0,ga.jsx)("nav",{className:"space-y-1",children:d(c,i).map(e=>(0,ga.jsx)(u,{path:e.path,icon:e.icon,label:e.label},e.path))})]})]})]})]})}const Ja=Ta("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),Qa=Ta("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),Za=Ta("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),en=Ta("newspaper",[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]]),tn=Ta("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);function rn(){const[e,t]=(0,s.useState)(""),[r,a]=(0,s.useState)(!0),[n,i]=(0,s.useState)("dashboard");(0,s.useEffect)(()=>{const e=setTimeout(()=>{a(!1)},1500);return()=>clearTimeout(e)},[]);const l=()=>(0,ga.jsxs)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm p-5 h-full flex flex-col justify-between animate-pulse",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/3"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded w-4"})]}),(0,ga.jsx)("div",{className:"flex-1 bg-slate-100 rounded"})]}),o=e=>{let{title:t,children:r,className:a="",loading:n=!1,hasFilter:s=!0}=e;return n?(0,ga.jsx)(l,{}):(0,ga.jsxs)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm hover:shadow-md transition-shadow flex flex-col ".concat(a),style:{animation:"fadeIn 0.5s ease-out"},children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 pb-2",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("h3",{className:"font-medium text-[#323338] text-lg truncate tracking-tight",children:t}),s&&(0,ga.jsx)(Ja,{className:"w-3 h-3 text-[#676879] cursor-pointer hover:text-[#323338]"})]}),(0,ga.jsx)("button",{className:"text-[#676879] hover:text-[#323338] transition-colors",children:(0,ga.jsx)(Qa,{className:"w-5 h-5"})})]}),(0,ga.jsx)("div",{className:"p-4 flex-1 flex flex-col",children:r})]})},c=[{id:"dashboard",label:"Dashboard",icon:Za},{id:"marketplace",label:"MarketPlace Info",icon:Ma},{id:"newsfeed",label:"News Feed",icon:en}];return(0,ga.jsxs)("main",{className:"w-full bg-[#f6f8fb] min-h-screen text-[#323338] font-sans selection:bg-[#0086C0] selection:text-white",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          from { opacity: 0; transform: translateY(10px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n        /* Custom scrollbar for light theme */\n        ::-webkit-scrollbar { width: 8px; }\n        ::-webkit-scrollbar-track { background: #f6f8fb; }\n        ::-webkit-scrollbar-thumb { background: #c3c6d4; border-radius: 4px; }\n        ::-webkit-scrollbar-thumb:hover { background: #a8abbd; }\n      "}),(0,ga.jsxs)("div",{className:"p-6 max-w-[1600px] mx-auto pb-12",children:[(0,ga.jsx)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-6 border-b border-[#d0d4e4] pb-6",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("h1",{className:"text-2xl font-semibold text-[#323338] tracking-wide",children:"Sales Dashboard"}),(0,ga.jsx)("button",{className:"text-[#676879] hover:text-yellow-400 transition-colors",children:(0,ga.jsx)(tn,{className:"w-5 h-5"})})]})}),(0,ga.jsx)("div",{className:"mb-6",children:(0,ga.jsx)("div",{className:"flex gap-2 border-b border-[#d0d4e4]",children:c.map(e=>{const t=e.icon,r=n===e.id;return(0,ga.jsxs)("button",{onClick:()=>i(e.id),className:"\n                    flex items-center gap-2 px-6 py-3 font-medium transition-all relative\n                    ".concat(r?"text-[#0086C0] border-b-2 border-[#0086C0]":"text-[#676879] hover:text-[#323338] hover:bg-white/50","\n                  "),children:[(0,ga.jsx)(t,{className:"w-4 h-4"}),e.label]},e.id)})})}),"dashboard"===n&&(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,ga.jsx)(o,{title:"Annual Target",className:"lg:col-span-1 h-64",loading:r,children:(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-end h-full relative pb-4",children:[(0,ga.jsxs)("div",{className:"relative w-48 h-24 overflow-hidden mb-2",children:[(0,ga.jsx)("div",{className:"absolute top-0 left-0 w-48 h-48 rounded-full border-[20px] border-[#e6e9ef]"}),(0,ga.jsx)("div",{className:"absolute top-0 left-0 w-48 h-48 rounded-full border-[20px] border-transparent border-t-[#00C875] border-l-[#0086C0]",style:{transform:"rotate(45deg)",opacity:1}}),(0,ga.jsx)("div",{className:"absolute bottom-0 left-1/2 w-1 h-24 bg-[#323338] origin-bottom transform -rotate-12 rounded-full z-10 shadow-sm"}),(0,ga.jsx)("div",{className:"absolute bottom-0 left-1/2 w-4 h-4 bg-[#323338] rounded-full transform -translate-x-1/2 translate-y-1/2 z-20 border-2 border-white"})]}),(0,ga.jsxs)("div",{className:"flex justify-between w-full mt-6 px-2",children:[(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"ACTUAL"}),(0,ga.jsx)("div",{className:"text-xl font-bold text-[#323338]",children:"85K"})]}),(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"TARGET"}),(0,ga.jsx)("div",{className:"text-xl font-bold text-[#323338]",children:"100K"})]})]})]})}),(0,ga.jsx)(o,{title:"Monthly Target",className:"lg:col-span-1 h-64",loading:r,children:(0,ga.jsxs)("div",{className:"flex flex-col justify-center h-full gap-8",children:[(0,ga.jsxs)("div",{className:"relative h-12 w-full bg-[#e6e9ef] rounded-md overflow-hidden flex",children:[(0,ga.jsx)("div",{className:"h-full bg-gradient-to-r from-[#0086C0] to-[#A25DDC]",style:{width:"100%"}}),(0,ga.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white font-bold text-lg drop-shadow-md",children:"300%"})]}),(0,ga.jsxs)("div",{className:"flex justify-between w-full px-2",children:[(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"MONTHLY ACTUAL"}),(0,ga.jsx)("div",{className:"text-xl font-bold text-[#00C875]",children:"55K"})]}),(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"THIS MONTH'S TARGET"}),(0,ga.jsx)("div",{className:"text-xl font-bold text-[#323338]",children:"10K"})]})]})]})}),(0,ga.jsx)(o,{title:"Average Sales Value",className:"lg:col-span-1 h-64",loading:r,children:(0,ga.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,ga.jsx)("div",{className:"text-5xl font-light text-[#323338] mb-2",children:"$42,500"})})}),(0,ga.jsx)(o,{title:"Active Sales - Forecasted Rev...",className:"lg:col-span-1 h-64",loading:r,children:(0,ga.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,ga.jsx)("div",{className:"text-5xl font-light text-[#323338] mb-2",children:"$133,000"})})}),(0,ga.jsx)(o,{title:"Sales status distribution",className:"lg:col-span-2 min-h-[300px]",loading:r,children:(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center h-full gap-8",children:[(0,ga.jsx)("div",{className:"relative w-48 h-48 flex-shrink-0",children:(0,ga.jsxs)("svg",{viewBox:"0 0 100 100",className:"transform -rotate-90 w-full h-full",children:[(0,ga.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#00C875",strokeWidth:"50",strokeDasharray:"78.5 78.5",strokeDashoffset:"0"}),(0,ga.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#0086C0",strokeWidth:"50",strokeDasharray:"39.25 117.75",strokeDashoffset:"-78.5"}),(0,ga.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#FDAB3D",strokeWidth:"50",strokeDasharray:"19.625 137.375",strokeDashoffset:"-117.75"}),(0,ga.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#A25DDC",strokeWidth:"50",strokeDasharray:"19.625 137.375",strokeDashoffset:"-137.375"})]})}),(0,ga.jsx)("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4",children:[{status:"Won",percentage:50,color:"bg-[#00C875]",count:8},{status:"Discovery",percentage:25,color:"bg-[#0086C0]",count:4},{status:"Working on it",percentage:12.5,color:"bg-[#FDAB3D]",count:2},{status:"Proposal",percentage:12.5,color:"bg-[#A25DDC]",count:2}].map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.color)}),(0,ga.jsx)("div",{className:"flex flex-col",children:(0,ga.jsxs)("span",{className:"text-sm text-[#323338]",children:[e.status,": ",(0,ga.jsxs)("span",{className:"text-[#676879]",children:[e.percentage,"%"]})]})})]},t))})]})}),(0,ga.jsx)(o,{title:"Actual Revenue by Month (Deals won)",className:"lg:col-span-2 min-h-[300px]",loading:r,children:(0,ga.jsxs)("div",{className:"h-full w-full flex flex-col justify-end pt-8 px-4 relative",children:[[0,10,20,30,40,50,60].map((e,t)=>(0,ga.jsx)("div",{className:"absolute w-full border-t border-slate-100",style:{bottom:"".concat(e/60*80+20,"%"),left:0},children:(0,ga.jsxs)("span",{className:"absolute -left-0 -top-2.5 text-[10px] text-[#676879]",children:["$",e,",000"]})},t)),(0,ga.jsxs)("div",{className:"flex justify-around items-end h-[80%] z-10 pl-8",children:[[{month:"Sep",value:3e4,trend:"up"},{month:"Oct",value:55e3,trend:"up"}].map((e,t)=>(0,ga.jsxs)("div",{className:"flex flex-col items-center gap-2 group w-24",children:[(0,ga.jsxs)("div",{className:"mb-1 text-xs text-[#323338] opacity-0 group-hover:opacity-100 transition-opacity font-medium",children:["$",e.value.toLocaleString()]}),(0,ga.jsx)("div",{className:"w-full bg-[#579BFC] hover:bg-[#4680d3] transition-all rounded-t-sm relative",style:{height:"".concat(e.value/6e4*100,"%")}}),(0,ga.jsx)("div",{className:"text-xs text-[#676879] mt-2",children:e.month})]},t)),(0,ga.jsxs)("div",{className:"flex flex-col items-center gap-2 w-24 opacity-50",children:[(0,ga.jsx)("div",{className:"w-full bg-[#e6e9ef] border border-dashed border-[#c3c6d4] rounded-t-sm",style:{height:"5px"}}),(0,ga.jsx)("div",{className:"text-xs text-[#676879] mt-2",children:"Nov"})]})]}),(0,ga.jsx)("div",{className:"absolute bottom-4 right-4 z-20",children:(0,ga.jsx)("button",{className:"bg-[#0086C0] hover:bg-[#0071a1] text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-1 shadow-md",children:"Help"})})]})})]}),"marketplace"===n&&(0,ga.jsx)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm p-8 min-h-[500px] flex items-center justify-center",children:(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)(Ma,{className:"w-16 h-16 text-[#676879] mx-auto mb-4"}),(0,ga.jsx)("h2",{className:"text-2xl font-semibold text-[#323338] mb-2",children:"MarketPlace Info"}),(0,ga.jsx)("p",{className:"text-[#676879]",children:"Content coming soon..."})]})}),"newsfeed"===n&&(0,ga.jsx)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm p-8 min-h-[500px] flex items-center justify-center",children:(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)(en,{className:"w-16 h-16 text-[#676879] mx-auto mb-4"}),(0,ga.jsx)("h2",{className:"text-2xl font-semibold text-[#323338] mb-2",children:"News Feed"}),(0,ga.jsx)("p",{className:"text-[#676879]",children:"Content coming soon..."})]})})]})]})}function an(){const[e,t]=(0,s.useState)(!1);return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{t(!e)},isMobileMenuOpen:e}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:e,onClose:()=>{t(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(rn,{})})]})]})}const nn=Ta("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),sn=Ta("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ln=Ta("message-square-share",[["path",{d:"M12 3H4a2 2 0 0 0-2 2v16.286a.71.71 0 0 0 1.212.502l2.202-2.202A2 2 0 0 1 6.828 19H20a2 2 0 0 0 2-2v-4",key:"11da1y"}],["path",{d:"M16 3h6v6",key:"1bx56c"}],["path",{d:"m16 9 6-6",key:"m4dnic"}]]),on=Ta("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),cn=Ta("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),dn=Ta("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),un=Ta("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),hn=Ta("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),fn=Ta("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),mn=Ta("mouse",[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]]);function pn(){const[e,t]=(0,s.useState)("sent"),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(""),l=e=>{t(e)},o=()=>{a(!0),setTimeout(()=>a(!1),1500)},c=[{id:1,launched:"2025-12-15",subject:"Winter Sale Announcement",sentBy:"Kavindu Tharaka",status:"Ongoing",recipients:1250,delivered:1248,opened:856,clicked:342},{id:2,launched:"2025-12-14",subject:"Product Update Newsletter",sentBy:"Kavindu Tharaka",status:"Completed",recipients:980,delivered:978,opened:654,clicked:198},{id:3,launched:"2025-12-13",subject:"Customer Feedback Survey",sentBy:"Kavindu Tharaka",status:"Completed",recipients:2100,delivered:2095,opened:1256,clicked:567}],d=[{id:1,sendTime:"2025-12-20 09:00",subject:"Holiday Special Offer",sentBy:"Kavindu Tharaka",status:"Scheduled",recipients:1500},{id:2,sendTime:"2025-12-22 14:00",subject:"Year-End Clearance",sentBy:"Kavindu Tharaka",status:"Scheduled",recipients:2200}],u=e=>{const t="px-3 py-1 rounded-full text-xs font-medium inline-flex items-center gap-1";switch(e){case"Ongoing":return(0,ga.jsxs)("span",{className:"".concat(t," bg-blue-100 text-blue-700"),children:[(0,ga.jsx)(nn,{className:"w-3 h-3"}),"Ongoing"]});case"Completed":return(0,ga.jsxs)("span",{className:"".concat(t," bg-green-100 text-green-700"),children:[(0,ga.jsx)(sn,{className:"w-3 h-3"}),"Completed"]});case"Scheduled":return(0,ga.jsxs)("span",{className:"".concat(t," bg-amber-100 text-amber-700"),children:[(0,ga.jsx)(nn,{className:"w-3 h-3"}),"Scheduled"]});default:return(0,ga.jsx)("span",{className:"".concat(t," bg-gray-100 text-gray-700"),children:e})}};return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            background-position: -1000px 0;\n          }\n          100% {\n            background-position: 1000px 0;\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .skeleton {\n          animation: shimmer 2s infinite;\n          background: linear-gradient(\n            90deg,\n            #f0f0f0 25%,\n            #e0e0e0 50%,\n            #f0f0f0 75%\n          );\n          background-size: 1000px 100%;\n        }\n\n        .table-row-hover:hover {\n          background-color: rgba(59, 130, 246, 0.02);\n        }\n      "}),(0,ga.jsxs)("main",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto",children:[(0,ga.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(qa,{className:"w-8 h-8 text-blue-600"}),(0,ga.jsx)("div",{children:(0,ga.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Email Leads"})})]})}),(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"More information",children:(0,ga.jsx)(Ua,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share campaigns",children:(0,ga.jsx)(ln,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,ga.jsxs)("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group active:scale-95",children:[(0,ga.jsx)(on,{className:"w-4 h-4 ".concat(r?"animate-spin":"group-hover:rotate-180 transition-transform")}),(0,ga.jsx)("span",{children:"Refresh"})]})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-8 mb-6 border-b border-slate-200 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"150ms",animationFillMode:"both"},children:[(0,ga.jsxs)("button",{className:"px-1 py-3 font-medium text-sm transition-all duration-200 relative ".concat("sent"===e?"text-blue-600":"text-slate-600 hover:text-slate-800"),onClick:()=>l("sent"),children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(cn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Sent"}),(0,ga.jsx)("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-semibold",children:c.length})]}),"sent"===e&&(0,ga.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full"})]}),(0,ga.jsxs)("button",{className:"px-1 py-3 font-medium text-sm transition-all duration-200 relative ".concat("scheduled"===e?"text-blue-600":"text-slate-600 hover:text-slate-800"),onClick:()=>l("scheduled"),children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(nn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Scheduled"}),(0,ga.jsx)("span",{className:"bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full text-xs font-semibold",children:d.length})]}),"scheduled"===e&&(0,ga.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full"})]})]}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),(0,ga.jsx)("span",{children:"New Campaign"})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",children:[(0,ga.jsx)(Ja,{className:"w-4 h-4 text-slate-600"}),(0,ga.jsx)("span",{children:"Filter"}),(0,ga.jsx)(un,{className:"w-4 h-4 text-slate-400"})]})]}),(0,ga.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search campaigns...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}),(0,ga.jsxs)("div",{className:"flex flex-col bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:["sent"===e?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Launched"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Subject"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Sent by"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Status"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Recipients"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Delivered"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Opened"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Clicked"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-200",children:r?Array(3).fill(0).map((e,t)=>(0,ga.jsxs)("tr",{className:"table-row-hover",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-20"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded-full skeleton w-24"})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-right",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-right",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-right",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-right",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded skeleton w-8"})})]},t)):c.map(e=>(0,ga.jsxs)("tr",{className:"table-row-hover hover:bg-slate-50 transition-colors duration-150",children:[(0,ga.jsx)("td",{className:"px-6 py-4 text-sm",children:e.launched}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm font-medium truncate max-w-xs hover:text-blue-600 cursor-pointer",children:e.subject}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.sentBy}),(0,ga.jsx)("td",{className:"px-6 py-4",children:u(e.status)}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-right font-medium",children:e.recipients}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-right text-green-600 font-medium",children:e.delivered}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-right",children:(0,ga.jsxs)("div",{className:"flex items-center justify-end gap-1 text-blue-600 font-medium",children:[(0,ga.jsx)(fn,{className:"w-4 h-4"}),e.opened," (",Math.round(e.opened/e.delivered*100),"%)"]})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-right",children:(0,ga.jsxs)("div",{className:"flex items-center justify-end gap-1 text-purple-600 font-medium",children:[(0,ga.jsx)(mn,{className:"w-4 h-4"}),e.clicked," (",Math.round(e.clicked/e.opened*100),"%)"]})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors duration-150 text-slate-500 hover:text-slate-700",children:(0,ga.jsx)(Qa,{className:"w-5 h-5"})})})]},e.id))})]})}),(0,ga.jsx)("div",{className:"md:hidden space-y-4 p-4",children:r?Array(3).fill(0).map((e,t)=>(0,ga.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:(0,ga.jsxs)("div",{className:"space-y-3",children:[(0,ga.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton"})]})]})},t)):c.map(e=>(0,ga.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,ga.jsxs)("div",{className:"p-4 border-b border-slate-100",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,ga.jsx)("h3",{className:"text-base font-semibold text-slate-900 flex-1 pr-2",children:e.subject}),(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors flex-shrink-0",children:(0,ga.jsx)(Qa,{className:"w-5 h-5 text-slate-500"})})]}),(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,ga.jsx)(nn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:e.launched})]}),u(e.status)]})]}),(0,ga.jsxs)("div",{className:"p-4 space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,ga.jsx)("span",{className:"text-slate-500",children:"Sent by"}),(0,ga.jsx)("span",{className:"font-medium text-slate-900",children:e.sentBy})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Recipients"}),(0,ga.jsx)("div",{className:"text-lg font-bold text-slate-900",children:e.recipients})]}),(0,ga.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-green-600 mb-1",children:"Delivered"}),(0,ga.jsx)("div",{className:"text-lg font-bold text-green-700",children:e.delivered})]}),(0,ga.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,ga.jsxs)("div",{className:"text-xs text-blue-600 mb-1 flex items-center gap-1",children:[(0,ga.jsx)(fn,{className:"w-3 h-3"}),"Opened"]}),(0,ga.jsxs)("div",{className:"text-lg font-bold text-blue-700",children:[e.opened,(0,ga.jsxs)("span",{className:"text-xs font-normal ml-1",children:["(",Math.round(e.opened/e.delivered*100),"%)"]})]})]}),(0,ga.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3",children:[(0,ga.jsxs)("div",{className:"text-xs text-purple-600 mb-1 flex items-center gap-1",children:[(0,ga.jsx)(mn,{className:"w-3 h-3"}),"Clicked"]}),(0,ga.jsxs)("div",{className:"text-lg font-bold text-purple-700",children:[e.clicked,(0,ga.jsxs)("span",{className:"text-xs font-normal ml-1",children:["(",Math.round(e.clicked/e.opened*100),"%)"]})]})]})]})]})]},e.id))})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Send Time"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Subject"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Sent by"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Status"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Recipients"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-200",children:r?Array(2).fill(0).map((e,t)=>(0,ga.jsxs)("tr",{className:"table-row-hover",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded-full skeleton w-24"})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-right",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded skeleton w-8"})})]},t)):d.map(e=>(0,ga.jsxs)("tr",{className:"table-row-hover hover:bg-slate-50 transition-colors duration-150",children:[(0,ga.jsx)("td",{className:"px-6 py-4 text-sm",children:e.sendTime}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm font-medium truncate max-w-xs hover:text-blue-600 cursor-pointer",children:e.subject}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.sentBy}),(0,ga.jsx)("td",{className:"px-6 py-4",children:u(e.status)}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-right font-medium",children:e.recipients}),(0,ga.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors duration-150 text-slate-500 hover:text-slate-700",children:(0,ga.jsx)(Qa,{className:"w-5 h-5"})})})]},e.id))})]})}),(0,ga.jsx)("div",{className:"md:hidden space-y-4 p-4",children:r?Array(2).fill(0).map((e,t)=>(0,ga.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:(0,ga.jsxs)("div",{className:"space-y-3",children:[(0,ga.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-full"})]})},t)):d.map(e=>(0,ga.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,ga.jsxs)("div",{className:"p-4 border-b border-slate-100",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,ga.jsx)("h3",{className:"text-base font-semibold text-slate-900 flex-1 pr-2",children:e.subject}),(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors flex-shrink-0",children:(0,ga.jsx)(Qa,{className:"w-5 h-5 text-slate-500"})})]}),(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,ga.jsx)(nn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:e.sendTime})]}),u(e.status)]})]}),(0,ga.jsxs)("div",{className:"p-4 space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,ga.jsx)("span",{className:"text-slate-500",children:"Sent by"}),(0,ga.jsx)("span",{className:"font-medium text-slate-900",children:e.sentBy})]}),(0,ga.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-blue-600 mb-1",children:"Recipients"}),(0,ga.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:e.recipients})]})]})]},e.id))})]}),!r&&"sent"===e&&0===c.length&&(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,ga.jsx)(qa,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 font-medium",children:"No sent campaigns yet"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm",children:"Start by creating a new campaign"})]})]}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:o,className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh",children:(0,ga.jsx)(on,{className:"w-5 h-5 ".concat(r?"animate-spin":"group-hover:rotate-180 transition-transform duration-300")})})}),(0,ga.jsx)("div",{className:"h-8"})]})]})}function gn(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),l=()=>{t(!1),i(null)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(pn,{modalOpen:()=>{i(null),t(!0)},onEdit:e=>{i(e),t(!0)}})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:l}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn"})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const xn=Ta("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),bn=Ta("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),vn=Ta("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),yn=Ta("warehouse",[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]]),wn=Ta("plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]),Nn=Ta("container",[["path",{d:"M22 7.7c0-.6-.4-1.2-.8-1.5l-6.3-3.9a1.72 1.72 0 0 0-1.7 0l-10.3 6c-.5.2-.9.8-.9 1.4v6.6c0 .5.4 1.2.8 1.5l6.3 3.9a1.72 1.72 0 0 0 1.7 0l10.3-6c.5-.3.9-1 .9-1.5Z",key:"1t2lqe"}],["path",{d:"M10 21.9V14L2.1 9.1",key:"o7czzq"}],["path",{d:"m10 14 11.9-6.9",key:"zm5e20"}],["path",{d:"M14 19.8v-8.1",key:"159ecu"}],["path",{d:"M18 17.5V9.4",key:"11uown"}]]),jn=Ta("ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]),kn=Ta("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),Sn=Ta("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),An=Ta("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),Cn=Ta("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),_n=Ta("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Tn=Ta("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),En=Ta("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Ln=Ta("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Pn=Ta("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),On=Ta("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Fn=async()=>(await fa.get("".concat(ma,"/quote/quote"))).data,Dn=async e=>(await fa.get("".concat(ma,"/quote/quote/").concat(e))).data,In=async e=>(await fa.post("".concat(ma,"/quote/quote"),e)).data,Rn=async e=>{try{console.log("Payload being sent:",JSON.stringify(e,null,2));return(await fa.put("".concat(ma,"/quote/quote"),e,{headers:{"Content-Type":"application/json"}})).data}catch(r){var t;throw console.error("Error updating quote:",r),console.error("Error response:",null===(t=r.response)||void 0===t?void 0:t.data),r}},Mn=async e=>(await fa.delete("".concat(ma,"/quote/quote/").concat(e))).data,Bn=async()=>(await fa.get("".concat(ma,"/WarehouseQuotes"))).data,Un=async e=>(await fa.get("".concat(ma,"/WarehouseQuotes/").concat(e))).data,zn=async e=>(await fa.post("".concat(ma,"/WarehouseQuotes"),e)).data,qn=async(e,t)=>(await fa.put("".concat(ma,"/WarehouseQuotes/").concat(e),t)).data,Hn=async(e,t)=>(await fa.put("".concat(ma,"/WarehouseQuotes/").concat(e,"/status"),{status:t})).data,Wn=async e=>{try{return(await fa.post("".concat(ma,"/QuoteOutcome"),e)).data}catch(t){throw new Error("Failed to save quote outcome")}};function Vn(e){let{modalOpen:t}=e;const r=ne(),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)([]),[o,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(""),[h,f]=(0,s.useState)("all"),[m,p]=(0,s.useState)("all"),[g,x]=(0,s.useState)({show:!1,quoteId:null,quoteNumber:""}),[b,v]=(0,s.useState)(!1),[y,w]=(0,s.useState)(!1),[N,j]=(0,s.useState)(null),[k,S]=(0,s.useState)({}),[A,C]=(0,s.useState)({wonAmount:""}),[_,T]=(0,s.useState)({lostReason:"",lostNote:""}),E=async e=>{try{const t=await(async e=>{try{return(await fa.get("".concat(ma,"/QuoteOutcome/").concat(e))).data}catch(r){var t;if(404===(null===(t=r.response)||void 0===t?void 0:t.status))return null;throw new Error("Failed to fetch outcome")}})(e);S(r=>We(We({},r),{},{[e]:t}))}catch(t){S(t=>We(We({},t),{},{[e]:null}))}},L=e=>{const t=k[e];return t?"won"===t.outcomeStatus?(0,ga.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,ga.jsx)(bn,{size:14}),"Won"]}),t.wonAmount>0&&(0,ga.jsxs)("span",{className:"text-xs text-gray-600 font-semibold",children:["LKR ",parseFloat(t.wonAmount).toLocaleString()]})]}):"lost"===t.outcomeStatus?(0,ga.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,ga.jsx)(vn,{size:14}),"Lost"]}),t.lostReason&&(0,ga.jsx)("span",{className:"text-xs text-gray-600",children:t.lostReason})]}):null:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsxs)("button",{onClick:()=>{const t=F.find(t=>t.quoteId===e);j(t),C({wonAmount:""}),v(!0)},className:"flex items-center gap-1 px-3 py-1 bg-green-50 text-green-700 rounded-lg text-xs font-medium hover:bg-green-100 transition-colors",children:[(0,ga.jsx)(sn,{size:14}),"Win"]}),(0,ga.jsxs)("button",{onClick:()=>{const t=F.find(t=>t.quoteId===e);j(t),T({lostReason:"",lostNote:""}),w(!0)},className:"flex items-center gap-1 px-3 py-1 bg-red-50 text-red-700 rounded-lg text-xs font-medium hover:bg-red-100 transition-colors",children:[(0,ga.jsx)(xn,{size:14}),"Lost"]})]})};(0,s.useEffect)(()=>{P(),O()},[]);const P=async()=>{try{c(!0);const e=await Fn();n(e),e.forEach(e=>{E(e.quoteId)})}catch(e){console.error("Error loading quotes:",e)}finally{c(!1)}},O=async()=>{try{const e=(await Bn()).map(e=>{var t;return{quoteId:"WH-".concat(e.sysId),quoteNumber:e.quoteNumber,customer:e.customerName,freightCategory:"warehouse",freightType:"warehouse",freightMode:"storage",portOfLoading:null,portOfDischarge:null,createdDate:e.createdAt,rateValidity:e.validityDate,status:(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())||"active",warehouseData:e,isWarehouse:!0}});l(e)}catch(e){console.error("Error loading warehouse quotes:",e)}},F=[...a,...i],D=e=>{if(e.isWarehouse)r("/warehouse-quotes/".concat(e.warehouseData.sysId,"?edit=true"));else if("multimodal"===e.freightType)r("/quotes?type=multimodal&id=".concat(e.quoteId,"&edit=true"));else{const t=new URLSearchParams({category:e.freightCategory,type:e.freightType,mode:e.freightMode,id:e.quoteId,edit:"true"});r("/quotes?".concat(t.toString()))}},I=e=>{x({show:!0,quoteId:e.quoteId,quoteNumber:e.quoteNumber,isWarehouse:e.isWarehouse||!1})},R=(e,t)=>"warehouse"===e?{icon:yn,color:"text-amber-600",bg:"bg-amber-50",badge:"bg-amber-100 text-amber-800"}:"air"===e&&"import"===t?{icon:wn,color:"text-sky-600",bg:"bg-sky-50",badge:"bg-sky-100 text-sky-800"}:"air"===e&&"export"===t?{icon:wn,color:"text-blue-600",bg:"bg-blue-50",badge:"bg-blue-100 text-blue-800"}:"sea"!==e||"import"!==t&&"fcl"!==t&&"lcl"!==t?"sea"===e&&"export"===t?{icon:jn,color:"text-indigo-600",bg:"bg-indigo-50",badge:"bg-indigo-100 text-indigo-800"}:"multimodal"===e?{icon:kn,color:"text-purple-600",bg:"bg-purple-50",badge:"bg-purple-100 text-purple-800"}:{icon:Sn,color:"text-gray-600",bg:"bg-gray-50",badge:"bg-gray-100 text-gray-800"}:{icon:Nn,color:"text-teal-600",bg:"bg-teal-50",badge:"bg-teal-100 text-teal-800"},M=e=>"warehouse"===e?{icon:yn,color:"text-amber-600",badge:"bg-amber-100 text-amber-800"}:"direct"===e?{icon:An,color:"text-green-600",badge:"bg-green-100 text-green-800"}:"transit"===e?{icon:Cn,color:"text-orange-600",badge:"bg-orange-100 text-orange-800"}:"multimodal"===e?{icon:kn,color:"text-purple-600",badge:"bg-purple-100 text-purple-800"}:{icon:An,color:"text-gray-600",badge:"bg-gray-100 text-gray-800"},B=e=>{const t={draft:{bg:"bg-gray-100",text:"text-gray-800",label:"Draft"},pending:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Pending"},approved:{bg:"bg-green-100",text:"text-green-800",label:"Approved"},rejected:{bg:"bg-red-100",text:"text-red-800",label:"Rejected"},active:{bg:"bg-green-100",text:"text-green-800",label:"Active"}},r=t[e]||t.draft;return(0,ga.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text),children:r.label})},U=e=>{try{var t;if("multimodal"!==e.freightType||!e.routes)return null;const r=JSON.parse(e.routes);if(!r||!r[0]||!r[0].routes)return null;const a=r[0].routes,n=e=>"air"===e?"\u2708\ufe0f":"sea"===e?"\ud83d\udea2":"trucking"===e?"\ud83d\ude9b":"\ud83d\udce6";return(0,ga.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[a.map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[t>0&&(0,ga.jsx)(_n,{size:12,className:"text-gray-400"}),(0,ga.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded flex items-center gap-1",children:[n(e.mode),(0,ga.jsx)("span",{className:"font-medium",children:e.origin||"N/A"})]})]},t)),(0,ga.jsx)(_n,{size:12,className:"text-gray-400"}),(0,ga.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded font-medium",children:(null===(t=a[a.length-1])||void 0===t?void 0:t.destination)||"N/A"})]})}catch(r){return console.error("Error parsing multimodal route:",r),(0,ga.jsx)("span",{className:"text-xs text-gray-500",children:"Multi-segment route"})}},z=e=>{try{let t=0;if(e.isWarehouse&&e.warehouseData){const r=e.warehouseData.lineItems||[];return t=r.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),t.toFixed(2)}if("multimodal"===e.freightType&&e.routes){return JSON.parse(e.routes).forEach(e=>{e.routes&&Array.isArray(e.routes)&&e.routes.forEach(e=>{e.freightChargesTables&&e.freightChargesTables.forEach(e=>{const r=parseFloat(e.chargeableWeight)||0,a=parseFloat(e.charge)||0;t+=r*a}),e.originHandling&&Array.isArray(e.originHandling)&&e.originHandling.forEach(e=>{t+=parseFloat(e.total)||0}),e.destinationHandling&&Array.isArray(e.destinationHandling)&&e.destinationHandling.forEach(e=>{t+=parseFloat(e.total)||0})})}),t.toFixed(2)}if(e.freightCharges){const r=JSON.parse(e.freightCharges);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}if(e.destinationCharges){const r=JSON.parse(e.destinationCharges);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}if(e.originHandling){const r=JSON.parse(e.originHandling);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}if(e.destinationHandling){const r=JSON.parse(e.destinationHandling);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}return t.toFixed(2)}catch(t){return console.error("Error calculating total:",t),"0.00"}},q=F.filter(e=>{var t,r;const a=(null===(t=e.quoteNumber)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))||(null===(r=e.customer)||void 0===r?void 0:r.toLowerCase().includes(d.toLowerCase())),n="all"===h||e.freightType===h,s="all"===m||e.freightCategory===m;return a&&n&&s});return(0,ga.jsxs)("div",{className:"p-6 space-y-6",children:[(0,ga.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Freight Quotes"}),(0,ga.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage and track all your freight quotations"})]}),(0,ga.jsxs)("button",{onClick:()=>t("quote"),className:"flex items-center gap-2 px-4 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 shadow-lg shadow-teal-200 transition-all",children:[(0,ga.jsx)(dn,{size:20}),"Create Quote"]})]}),(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ga.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,ga.jsxs)("div",{className:"flex-1 relative",children:[(0,ga.jsx)(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,ga.jsx)("input",{type:"text",placeholder:"Search by quote number or customer...",value:d,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Ja,{className:"text-gray-400",size:20}),(0,ga.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[(0,ga.jsx)("option",{value:"all",children:"All Categories"}),(0,ga.jsx)("option",{value:"air",children:"Air"}),(0,ga.jsx)("option",{value:"sea",children:"Sea"}),(0,ga.jsx)("option",{value:"multimodal",children:"MultiModal"}),(0,ga.jsx)("option",{value:"warehouse",children:"Warehouse"})]}),(0,ga.jsxs)("select",{value:h,onChange:e=>f(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[(0,ga.jsx)("option",{value:"all",children:"All Types"}),(0,ga.jsx)("option",{value:"direct",children:"Direct"}),(0,ga.jsx)("option",{value:"transit",children:"Transit"}),(0,ga.jsx)("option",{value:"multimodal",children:"MultiModal"}),(0,ga.jsx)("option",{value:"warehouse",children:"Warehouse"})]})]})]})}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"text-sm text-gray-600",children:"Total Quotes"}),(0,ga.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:F.length})]}),(0,ga.jsx)("div",{className:"w-12 h-12 bg-teal-50 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(Sn,{className:"text-teal-600",size:24})})]})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"text-sm text-gray-600",children:"Air Freight"}),(0,ga.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:F.filter(e=>"air"===e.freightCategory).length})]}),(0,ga.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(wn,{className:"text-blue-600",size:24})})]})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"text-sm text-gray-600",children:"Sea Freight"}),(0,ga.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:F.filter(e=>"sea"===e.freightCategory).length})]}),(0,ga.jsx)("div",{className:"w-12 h-12 bg-teal-50 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(jn,{className:"text-teal-600",size:24})})]})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"text-sm text-gray-600",children:"MultiModal"}),(0,ga.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:F.filter(e=>"multimodal"===e.freightCategory).length})]}),(0,ga.jsx)("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(kn,{className:"text-purple-600",size:24})})]})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"text-sm text-gray-600",children:"Warehouse"}),(0,ga.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:F.filter(e=>"warehouse"===e.freightCategory).length})]}),(0,ga.jsx)("div",{className:"w-12 h-12 bg-amber-50 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(yn,{className:"text-amber-600",size:24})})]})})]}),o?(0,ga.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,ga.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):0===q.length?(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,ga.jsx)(Sn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,ga.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No quotes found"}),(0,ga.jsx)("p",{className:"text-gray-500 mb-4",children:d||"all"!==h||"all"!==m?"Try adjusting your search or filters":"Create your first quote to get started"}),!d&&"all"===h&&"all"===m&&(0,ga.jsxs)("button",{onClick:()=>t("quote"),className:"inline-flex items-center gap-2 px-6 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700",children:[(0,ga.jsx)(dn,{size:20}),"Create Quote"]})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"hidden lg:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Quote Details"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Freight Info"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Customer"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Route"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Dates"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Amount"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Status"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Outcome"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-gray-200",children:q.map(e=>{const t=R(e.freightCategory,e.freightMode),a=M(e.freightType),n=t.icon,s=a.icon;return(0,ga.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 rounded-lg ".concat(t.bg," ").concat(t.color," flex items-center justify-center flex-shrink-0"),children:(0,ga.jsx)(n,{size:20})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"font-semibold text-gray-900",children:e.quoteNumber}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,ga.jsx)(s,{size:14,className:a.color}),(0,ga.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(a.badge," capitalize"),children:e.freightType})]})]})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{children:[(0,ga.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t.badge," capitalize"),children:e.freightCategory}),(0,ga.jsx)("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:e.freightMode})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Oa,{size:14,className:"text-gray-400"}),(0,ga.jsx)("span",{className:"text-sm text-gray-700",children:e.customer||"-"})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:e.isWarehouse?(0,ga.jsx)("span",{className:"text-xs text-gray-500 italic",children:"Warehouse Services"}):"multimodal"===e.freightType?(0,ga.jsx)("div",{className:"max-w-xs",children:U(e)}):(0,ga.jsxs)("div",{className:"space-y-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,ga.jsx)(Tn,{size:14,className:"text-green-500"}),(0,ga.jsx)("span",{className:"truncate max-w-[150px]",children:e.portOfLoading||"-"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,ga.jsx)(Tn,{size:14,className:"text-red-500"}),(0,ga.jsx)("span",{className:"truncate max-w-[150px]",children:e.portOfDischarge||"-"})]})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"space-y-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,ga.jsx)(En,{size:14,className:"text-gray-400"}),(0,ga.jsx)("span",{className:"text-gray-700",children:new Date(e.createdDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.rateValidity&&(0,ga.jsxs)("div",{className:"text-xs text-gray-500",children:["Valid till: ",new Date(e.rateValidity).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-1 font-semibold text-gray-900",children:[(0,ga.jsx)(Ln,{size:16,className:"text-green-600"}),z(e)]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:B(e.status)}),(0,ga.jsx)("td",{className:"px-6 py-4",children:!e.isWarehouse&&L(e.quoteId)}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,ga.jsx)("button",{onClick:()=>(e=>{if(e.isWarehouse)r("/warehouse-quotes/".concat(e.warehouseData.sysId));else if("multimodal"===e.freightType)r("/quotes?type=multimodal&id=".concat(e.quoteId));else{const t=new URLSearchParams({category:e.freightCategory,type:e.freightType,mode:e.freightMode,id:e.quoteId});r("/quotes?".concat(t.toString()))}})(e),className:"p-2 text-teal-600 hover:bg-teal-50 rounded-lg transition-colors",title:"View",children:(0,ga.jsx)(fn,{size:18})}),(0,ga.jsx)("button",{onClick:()=>D(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:(0,ga.jsx)(Pn,{size:18})}),(0,ga.jsx)("button",{onClick:()=>I(e),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:(0,ga.jsx)(On,{size:18})})]})})]},e.quoteId)})})]})})}),(0,ga.jsx)("div",{className:"lg:hidden grid grid-cols-1 md:grid-cols-2 gap-4",children:q.map(e=>{const t=R(e.freightCategory,e.freightMode),r=M(e.freightType),a=t.icon,n=r.icon;return(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-12 h-12 rounded-lg ".concat(t.bg," ").concat(t.color," flex items-center justify-center flex-shrink-0"),children:(0,ga.jsx)(a,{size:24})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"font-semibold text-gray-900",children:e.quoteNumber}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,ga.jsx)(n,{size:12,className:r.color}),(0,ga.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(r.badge," capitalize"),children:e.freightType})]})]})]}),B(e.status)]}),(0,ga.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,ga.jsx)(Oa,{size:14,className:"text-gray-400"}),(0,ga.jsx)("span",{className:"text-gray-700",children:e.customer||"-"})]}),(0,ga.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t.badge," capitalize"),children:[e.freightCategory," - ",e.freightMode]}),e.isWarehouse?(0,ga.jsx)("span",{className:"block text-xs text-gray-500 italic mt-2",children:"Warehouse Services"}):"multimodal"===e.freightType?(0,ga.jsx)("div",{className:"mt-2",children:U(e)}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,ga.jsx)(Tn,{size:14,className:"text-green-500"}),(0,ga.jsx)("span",{className:"truncate",children:e.portOfLoading||"-"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,ga.jsx)(Tn,{size:14,className:"text-red-500"}),(0,ga.jsx)("span",{className:"truncate",children:e.portOfDischarge||"-"})]})]}),(0,ga.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(En,{size:14,className:"text-gray-400"}),(0,ga.jsx)("span",{className:"text-gray-600",children:new Date(e.createdDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-1 font-semibold text-gray-900",children:[(0,ga.jsx)(Ln,{size:16,className:"text-green-600"}),z(e)]})]})]}),(0,ga.jsx)("div",{className:"border-t border-gray-200 pt-3",children:!e.isWarehouse&&L(e.quoteId)}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-100 mt-3",children:[(0,ga.jsxs)("button",{onClick:()=>D(e),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-green-600 bg-green-50 rounded-lg text-sm font-medium hover:bg-green-100",children:[(0,ga.jsx)(Pn,{size:16}),"Edit"]}),(0,ga.jsx)("button",{onClick:()=>I(e),className:"flex items-center justify-center gap-2 px-3 py-2 text-red-600 bg-red-50 rounded-lg text-sm font-medium hover:bg-red-100",children:(0,ga.jsx)(On,{size:16})})]})]},e.quoteId)})})]}),g.show&&(0,ga.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,ga.jsx)(On,{className:"text-red-600",size:24})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Quote"}),(0,ga.jsx)("p",{className:"text-sm text-gray-500",children:"This action cannot be undone"})]})]}),(0,ga.jsxs)("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete quote ",(0,ga.jsx)("span",{className:"font-semibold",children:g.quoteNumber}),"? All associated data will be permanently removed."]}),(0,ga.jsxs)("div",{className:"flex gap-3",children:[(0,ga.jsx)("button",{onClick:()=>x({show:!1,quoteId:null,quoteNumber:"",isWarehouse:!1}),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,ga.jsx)("button",{onClick:async()=>{try{if(g.isWarehouse){const e=g.quoteId.replace("WH-","");await fa.delete("/api/WarehouseQuotes/".concat(e)),O()}else await Mn(g.quoteId),P();x({show:!1,quoteId:null,quoteNumber:"",isWarehouse:!1}),alert("Quote deleted successfully!")}catch(e){console.error("Error deleting quote:",e),alert("Failed to delete quote")}},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete Quote"})]})]})}),b&&N&&(0,ga.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,ga.jsx)(bn,{className:"text-green-600",size:24})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Quote Won!"}),(0,ga.jsxs)("p",{className:"text-sm text-gray-500",children:["Quote: ",N.quoteNumber]})]})]}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Won Amount (LKR) ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"LKR"}),(0,ga.jsx)("input",{type:"number",value:A.wonAmount,onChange:e=>C(We(We({},A),{},{wonAmount:e.target.value})),placeholder:"0.00",className:"w-full pl-14 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),(0,ga.jsxs)("div",{className:"flex gap-3",children:[(0,ga.jsx)("button",{onClick:()=>{v(!1),j(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,ga.jsx)("button",{onClick:async()=>{if(!A.wonAmount||parseFloat(A.wonAmount)<=0)alert("Please enter a valid won amount");else try{const e={quoteId:N.quoteId,outcomeStatus:"won",wonAmount:parseFloat(A.wonAmount),lostReason:null,lostNote:null};await Wn(e),await E(N.quoteId),v(!1),j(null),alert("Quote marked as won successfully!")}catch(e){console.error("Error saving win outcome:",e),alert("Failed to save win outcome")}},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Save"})]})]})}),y&&N&&(0,ga.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,ga.jsx)(vn,{className:"text-red-600",size:24})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Quote Lost"}),(0,ga.jsxs)("p",{className:"text-sm text-gray-500",children:["Quote: ",N.quoteNumber]})]})]}),(0,ga.jsxs)("div",{className:"mb-4",children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsxs)("select",{value:_.lostReason,onChange:e=>T(We(We({},_),{},{lostReason:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[(0,ga.jsx)("option",{value:"",children:"Select reason..."}),["High Prices","Late Submissions","Poor Transit Times","Destination free time","Flight cancelation","Others"].map(e=>(0,ga.jsx)("option",{value:e,children:e},e))]})]}),"Others"===_.lostReason&&(0,ga.jsxs)("div",{className:"mb-4",children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Note ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("textarea",{value:_.lostNote,onChange:e=>T(We(We({},_),{},{lostNote:e.target.value})),placeholder:"Please provide details...",rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"})]}),(0,ga.jsxs)("div",{className:"flex gap-3",children:[(0,ga.jsx)("button",{onClick:()=>{w(!1),j(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,ga.jsx)("button",{onClick:async()=>{if(_.lostReason)if("Others"!==_.lostReason||_.lostNote)try{const e={quoteId:N.quoteId,outcomeStatus:"lost",wonAmount:0,lostReason:_.lostReason,lostNote:"Others"===_.lostReason?_.lostNote:null};await Wn(e),await E(N.quoteId),w(!1),j(null),alert("Quote marked as lost successfully!")}catch(e){console.error("Error saving lost outcome:",e),alert("Failed to save lost outcome")}else alert("Please provide a note");else alert("Please select a reason")},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Save"})]})]})})]})}function Gn(e){let{onClose:t,type:r="quote",editDocument:a=null,onSuccess:n}=e;const i=ne(),[l,o]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),f=[{id:"air-import",label:"Air Import",icon:wn,color:"text-sky-600",bg:"bg-sky-50",category:"air",mode:"import"},{id:"air-export",label:"Air Export",icon:wn,color:"text-blue-600",bg:"bg-blue-50",category:"air",mode:"export"},{id:"sea-import-fcl",label:"Sea Import FCL",icon:Nn,color:"text-teal-600",bg:"bg-teal-50",category:"sea",mode:"import"},{id:"sea-import-lcl",label:"Sea Import LCL",icon:Sn,color:"text-emerald-600",bg:"bg-emerald-50",category:"sea",mode:"import"},{id:"sea-export-fcl",label:"Sea Export FCL",icon:jn,color:"text-indigo-600",bg:"bg-indigo-50",category:"sea",mode:"export"},{id:"sea-export-lcl",label:"Sea Export LCL",icon:Cn,color:"text-purple-600",bg:"bg-purple-50",category:"sea",mode:"export"}],m=[{id:"direct",label:"Direct",icon:An,description:"Single route without stops"},{id:"transit",label:"Transshipment",icon:Cn,description:"Multiple transit points"},{id:"multimodal",label:"MultiModal",icon:kn,description:"Combined air and sea"}],p=e=>{h(e),o(""),d("")};return(0,ga.jsxs)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto backdrop-blur-sm",children:[(0,ga.jsxs)("div",{className:"w-full max-w-7xl bg-white rounded-2xl shadow-2xl max-h-[95vh] flex flex-col my-8",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-teal-50 to-emerald-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-12 h-12 rounded-lg bg-teal-600 flex items-center justify-center shadow-lg shadow-teal-200",children:(0,ga.jsx)(Ha,{className:"w-6 h-6 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h1",{className:"text-2xl font-bold text-slate-800",children:[a?"Edit":"Create New"," ","quote"===r?"Quote":"Invoice"]}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Select quote type and details"})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors",children:(0,ga.jsx)(Ea,{className:"w-6 h-6 text-slate-500"})})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6 scroll-smooth",children:(0,ga.jsxs)("div",{className:"space-y-8",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Select Quote Type"}),(0,ga.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Choose the type of quotation you want to create"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsx)("button",{onClick:()=>p("freight"),className:"p-6 rounded-xl border-2 text-left transition-all hover:shadow-md ".concat("freight"===u?"border-teal-500 ring-2 ring-teal-200 bg-teal-50":"border-slate-200 hover:border-teal-200"),children:(0,ga.jsxs)("div",{className:"flex items-start gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat("freight"===u?"bg-teal-100":"bg-slate-100"),children:(0,ga.jsx)(jn,{className:"w-7 h-7 ".concat("freight"===u?"text-teal-600":"text-slate-600")})}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("span",{className:"font-semibold text-slate-800 block text-lg",children:"Freight Forwarding"}),(0,ga.jsx)("span",{className:"text-sm text-slate-500 mt-1 block",children:"Air & sea import/export quotations with routing options"})]})]})}),(0,ga.jsx)("button",{onClick:()=>p("warehouse"),className:"p-6 rounded-xl border-2 text-left transition-all hover:shadow-md ".concat("warehouse"===u?"border-teal-500 ring-2 ring-teal-200 bg-teal-50":"border-slate-200 hover:border-teal-200"),children:(0,ga.jsxs)("div",{className:"flex items-start gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat("warehouse"===u?"bg-teal-100":"bg-slate-100"),children:(0,ga.jsx)(yn,{className:"w-7 h-7 ".concat("warehouse"===u?"text-teal-600":"text-slate-600")})}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("span",{className:"font-semibold text-slate-800 block text-lg",children:"Warehouse Services"}),(0,ga.jsx)("span",{className:"text-sm text-slate-500 mt-1 block",children:"Storage, handling, and distribution quotations"})]})]})})]})]}),"warehouse"===u&&(0,ga.jsx)("div",{className:"pt-6 border-t border-slate-100 animate-fadeIn",children:(0,ga.jsx)("div",{className:"bg-teal-50 rounded-xl p-6 border border-teal-100",children:(0,ga.jsxs)("div",{className:"flex items-start gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 rounded-lg bg-teal-100 flex items-center justify-center",children:(0,ga.jsx)(yn,{className:"w-7 h-7 text-teal-600"})}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800 text-lg mb-2",children:"Warehouse Quotation"}),(0,ga.jsx)("p",{className:"text-slate-600 text-sm mb-4",children:"Create quotations for warehouse services including storage, handling, overtime charges, transport, picking & packing, and insurance."}),(0,ga.jsx)("button",{onClick:()=>{i("/quotes?type=warehouse"),t()},className:"px-6 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-medium shadow-lg shadow-teal-200",children:"Continue to Warehouse Quote"})]})]})})}),"freight"===u&&(0,ga.jsxs)("div",{className:"pt-6 border-t border-slate-100 animate-fadeIn",children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Step 1: Select Freight Mode"}),(0,ga.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Choose your shipping method"}),(0,ga.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:f.map(e=>(0,ga.jsxs)("button",{onClick:()=>(e=>{o(e),d("")})(e.id),className:"p-4 rounded-xl border-2 text-left transition-all hover:shadow-md ".concat(l===e.id?"border-teal-500 ring-2 ring-teal-200 bg-teal-50":"border-slate-200 hover:border-teal-200"),children:[(0,ga.jsx)("div",{className:"w-10 h-10 rounded-lg ".concat(e.bg," ").concat(e.color," flex items-center justify-center mb-3"),children:(0,ga.jsx)(e.icon,{className:"w-6 h-6"})}),(0,ga.jsx)("span",{className:"font-semibold text-slate-700 block",children:e.label})]},e.id))})]}),"freight"===u&&l&&(0,ga.jsxs)("div",{className:"pt-6 border-t border-slate-100 animate-fadeIn",children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Step 2: Select Routing Type"}),(0,ga.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Choose how your cargo will be transported"}),(0,ga.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map(e=>(0,ga.jsxs)("button",{onClick:()=>{return t=e.id,void d(t);var t},className:"p-5 rounded-xl border-2 flex flex-col items-center gap-3 transition-all hover:shadow-md ".concat(c===e.id?"border-teal-500 bg-teal-50 text-teal-700 ring-2 ring-teal-200":"border-slate-200 hover:bg-slate-50"),children:[(0,ga.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(c===e.id?"bg-teal-100":"bg-slate-100"),children:(0,ga.jsx)(e.icon,{className:"w-7 h-7 ".concat(c===e.id?"text-teal-700":"text-slate-600")})}),(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("span",{className:"font-semibold block text-base",children:e.label}),(0,ga.jsx)("span",{className:"text-xs block mt-1 ".concat(c===e.id?"text-teal-600":"text-slate-500"),children:e.description})]})]},e.id))})]}),"freight"===u&&l&&(0,ga.jsxs)("div",{className:"flex justify-between items-center pt-6 border-t border-slate-100 animate-fadeIn",children:[(0,ga.jsx)("button",{onClick:t,className:"px-6 py-2.5 border-2 border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors font-medium",children:"Cancel"}),(0,ga.jsx)("button",{disabled:!c,onClick:()=>{if(!l||!c)return;const e=f.find(e=>e.id===l);i("multimodal"===c?"/quotes?type=multimodal":"/quotes?category=".concat(e.category,"&type=").concat(c,"&mode=").concat(e.mode)),t()},className:"px-8 py-2.5 rounded-lg font-medium transition-all ".concat(c?"bg-teal-600 text-white hover:bg-teal-700 shadow-lg shadow-teal-200":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:"Continue to Quote Form"})]}),!u&&(0,ga.jsx)("div",{className:"flex justify-end pt-6 border-t border-slate-100",children:(0,ga.jsx)("button",{onClick:t,className:"px-6 py-2.5 border-2 border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors font-medium",children:"Cancel"})})]})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.3s ease-out;\n        }\n      "})]})}const Kn=Ta("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Yn=Ta("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Xn=("".concat(ma,"/Quote"),async()=>{try{return(await fa.get("".concat(ma,"/rates/rates"))).data}catch(e){throw new Error("Failed to fetch rates")}}),$n=async e=>{try{return(await fa.post("".concat(ma,"/rates/rates"),e)).data}catch(t){throw new Error("Failed to create rate")}},Jn=async(e,t)=>{try{return(await fa.put("".concat(ma,"/rates/rates/").concat(e),t)).data}catch(r){throw new Error("Failed to update rate")}};function Qn(e){let{onClose:t}=e;const[r,a]=(0,s.useState)(1),[n,i]=(0,s.useState)(""),l="quote",[o,c]=(0,s.useState)({origin:"",destination:"",route:"",weight:"",containerType:"",volume:""}),[d,u]=(0,s.useState)([]),[h,f]=(0,s.useState)(null),[m,p]=(0,s.useState)(""),[g,x]=(0,s.useState)(0),[b,v]=(0,s.useState)({documentNumber:"",recipient:"",recipientEmail:"",recipientAddress:"",issueDate:"",dueDate:"",expiryDate:"",currency:"USD",notes:"",terms:"",templateName:"",validUntil:""}),[y,w]=(0,s.useState)({airline:"",liner:"",routing:"",surcharges:"",transitTime:"",frequency:"",routingType:"DIRECT",rate45Minus:"",rate45Plus:"",rateM:"",rate45KG:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:"",validateDate:""}),[N,j]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),[A,C]=(0,s.useState)({}),[_,T]=(0,s.useState)(!1),[E,L]=(0,s.useState)(!1),[P,O]=(0,s.useState)([]),[F,D]=(0,s.useState)(!1),[I,R]=(0,s.useState)(""),[M,B]=(0,s.useState)(null),[U,z]=(0,s.useState)(""),[q,H]=(0,s.useState)(!1);(0,s.useEffect)(()=>{n&&2===r&&W()},[n,r]);const W=async()=>{D(!0),R("");try{const e=(await Xn()).filter(e=>e.freightType===n).map(e=>{let t={};if(e.rateDataJson)try{t=JSON.parse(e.rateDataJson)}catch(mT){console.error("Error parsing rateDataJson:",mT)}return We(We({},e),t)});O(e||[])}catch(e){console.error("Error fetching rates:",e),R("Failed to load rates. Please try again.")}finally{D(!1)}},V=()=>{B(null),w({airline:"",liner:"",routing:"",surcharges:"",transitTime:"",frequency:"",routingType:"DIRECT",rate45Minus:"",rate45Plus:"",rateM:"",rate45KG:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:"",validateDate:""})},G=async e=>{if(window.confirm("Are you sure you want to delete this rate?"))try{await(async e=>{try{return(await fa.delete("".concat(ma,"/rates/rates/").concat(e))).data}catch(t){throw new Error("Failed to delete rate")}})(e),W(),p("Rate deleted successfully!"),setTimeout(()=>p(""),3e3)}catch(a){var t,r;console.error("Error deleting rate:",a),R((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message||"Failed to delete rate.")}},K=e=>{const{name:t,value:r}=e.target;w(e=>We(We({},e),{},{[t]:r}))},Y=e=>{const{name:t,value:r}=e.target;c(e=>We(We({},e),{},{[t]:r}))};return(0,ga.jsxs)("div",{className:"w-full max-w-6xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 rounded-t-2xl ".concat("bg-gradient-to-r from-amber-50 to-orange-50"),children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("bg-amber-500"),children:(0,ga.jsx)(Ha,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h1",{className:"text-xl font-bold text-slate-800",children:["Rate Management - ",q?"Edit":"Create"," ",l.charAt(0).toUpperCase()+l.slice(1)]}),(0,ga.jsxs)("p",{className:"text-sm text-slate-600",children:["Manage rates and generate ",l,"s"]})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500"})})]}),(0,ga.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(I||A.submit)&&(0,ga.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:(0,ga.jsxs)("div",{className:"flex items-center",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-red-500 mr-3"}),(0,ga.jsx)("p",{className:"text-sm text-red-700",children:I||A.submit}),(0,ga.jsx)("button",{onClick:()=>{R(""),C(e=>We(We({},e),{},{submit:""}))},className:"ml-auto text-red-500 hover:text-red-700",children:(0,ga.jsx)(Ea,{className:"w-4 h-4"})})]})}),m&&(0,ga.jsx)("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-6",children:(0,ga.jsxs)("div",{className:"flex items-center",children:[(0,ga.jsx)(sn,{className:"w-5 h-5 text-green-500 mr-3"}),(0,ga.jsx)("p",{className:"text-sm text-green-700",children:m}),(0,ga.jsx)("button",{onClick:()=>p(""),className:"ml-auto text-green-500 hover:text-green-700",children:(0,ga.jsx)(Ea,{className:"w-4 h-4"})})]})}),(0,ga.jsxs)("div",{className:"space-y-8",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,ga.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full ".concat(r>=1?"bg-teal-600 text-white":"bg-slate-200 text-slate-600"),children:"1"}),(0,ga.jsx)("div",{className:"h-1 flex-1 ".concat(r>=2?"bg-teal-600":"bg-slate-200")}),(0,ga.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full ".concat(r>=2?"bg-teal-600 text-white":"bg-slate-200 text-slate-600"),children:"2"}),(0,ga.jsx)("div",{className:"h-1 flex-1 ".concat(r>=3?"bg-teal-600":"bg-slate-200")}),(0,ga.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full ".concat(r>=3?"bg-teal-600 text-white":"bg-slate-200 text-slate-600"),children:"3"})]}),1===r&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Select Freight Type"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{className:"border-2 border-slate-200 rounded-lg p-4 hover:border-teal-500 transition-all",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,ga.jsx)(wn,{className:"w-6 h-6 text-blue-500"}),(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Air Freight"})]}),(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsx)("button",{onClick:()=>{i("air-import"),a(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-blue-50 rounded-lg transition-colors",children:"Air Import"}),(0,ga.jsx)("button",{onClick:()=>{i("air-export"),a(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-blue-50 rounded-lg transition-colors",children:"Air Export"})]})]}),(0,ga.jsxs)("div",{className:"border-2 border-slate-200 rounded-lg p-4 hover:border-teal-500 transition-all",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,ga.jsx)(jn,{className:"w-6 h-6 text-teal-500"}),(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Freight"})]}),(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsxs)("button",{onClick:()=>{i("sea-import-fcl"),a(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,ga.jsx)("span",{children:"Sea Import FCL"}),(0,ga.jsx)(Nn,{className:"w-4 h-4 text-slate-400"})]}),(0,ga.jsxs)("button",{onClick:()=>{i("sea-import-lcl"),a(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,ga.jsx)("span",{children:"Sea Import LCL"}),(0,ga.jsx)(Sn,{className:"w-4 h-4 text-slate-400"})]}),(0,ga.jsxs)("button",{onClick:()=>{i("sea-export-fcl"),a(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,ga.jsx)("span",{children:"Sea Export FCL"}),(0,ga.jsx)(Nn,{className:"w-4 h-4 text-slate-400"})]}),(0,ga.jsxs)("button",{onClick:()=>{i("sea-export-lcl"),a(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,ga.jsx)("span",{children:"Sea Export LCL"}),(0,ga.jsx)(Sn,{className:"w-4 h-4 text-slate-400"})]})]})]})]}),A.freightType&&(0,ga.jsxs)("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),A.freightType]})]}),2===r&&(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg p-6 border border-blue-200",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Tn,{className:"w-5 h-5 text-blue-600"}),"Route Information"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Origin"}),(0,ga.jsx)("input",{name:"origin",value:o.origin,onChange:Y,placeholder:"e.g., CMB",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Destination"}),(0,ga.jsx)("input",{name:"destination",value:o.destination,onChange:Y,placeholder:"e.g., IND",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Route"}),(0,ga.jsx)("input",{name:"route",value:o.route,onChange:Y,placeholder:"e.g., CMB/DXB/IND",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-lg border-2 border-slate-200 p-6",children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Available Rates"}),F?(0,ga.jsxs)("div",{className:"text-center py-8",children:[(0,ga.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-teal-600 border-t-transparent rounded-full animate-spin"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600 mt-3",children:"Loading rates..."})]}):0===P.length?(0,ga.jsxs)("div",{className:"text-center py-8 bg-slate-50 rounded-lg",children:[(0,ga.jsx)(vn,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"No rates found for this freight type."}),(0,ga.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Create a new rate below to get started."})]}):(0,ga.jsx)("div",{className:"space-y-3",children:P.map(e=>(0,ga.jsx)("div",{className:"p-4 border-2 rounded-lg transition-all ".concat((null===h||void 0===h?void 0:h.id)===e.id?"border-green-500 bg-green-50":"border-slate-200 hover:border-teal-300 bg-white"),children:(0,ga.jsxs)("div",{className:"flex justify-between items-start",children:[(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(null===h||void 0===h?void 0:h.id)===e.id&&(0,ga.jsx)(sn,{className:"w-5 h-5 text-green-600"}),(0,ga.jsxs)("p",{className:"font-semibold text-slate-800",children:[e.airline||e.liner||"Rate"," - ",e.route||"N/A"]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[(0,ga.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ga.jsx)(En,{className:"w-3 h-3"}),"Valid until: ",new Date(e.validateDate).toLocaleDateString()]}),(0,ga.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ga.jsx)(Tn,{className:"w-3 h-3"}),e.origin," \u2192 ",e.destination]})]})]}),(0,ga.jsxs)("div",{className:"flex gap-2",children:[(0,ga.jsx)("button",{onClick:()=>(e=>{B(e.id);let t=e;if(e.rateDataJson&&"string"===typeof e.rateDataJson)try{const r=JSON.parse(e.rateDataJson);t=We(We({},e),r)}catch(mT){console.error("Error parsing rate data:",mT)}w({airline:t.airline||"",liner:t.liner||"",routing:t.routing||t.route||"",surcharges:t.surcharges||"",transitTime:t.transitTime||"",frequency:t.frequency||"",routingType:t.routingType||"DIRECT",rate45Minus:t.rate45Minus||"",rate45Plus:t.rate45Plus||"",rateM:t.rateM||"",rate45KG:t.rate45KG||"",rate100:t.rate100||"",rate300:t.rate300||"",rate500:t.rate500||"",rate1000:t.rate1000||"",rate20GP:t.rate20GP||"",rate40GP:t.rate40GP||"",rate40HQ:t.rate40HQ||"",lclRate:t.lclRate||"",validateDate:e.validateDate||""}),c(t=>We(We({},t),{},{origin:e.origin||"",destination:e.destination||"",route:e.route||""}))})(e),className:"p-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-colors",title:"Edit Rate",children:(0,ga.jsx)(Kn,{className:"w-4 h-4"})}),(0,ga.jsx)("button",{onClick:()=>G(e.id),className:"p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",title:"Delete Rate",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]})]})},e.id))})]}),(0,ga.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),z(""),!y.validateDate)return void z("Validation date is required.");if(!o.origin||!o.destination)return void z("Origin and Destination are required.");const t={airline:y.airline||null,liner:y.liner||null,routing:y.routing||null,surcharges:y.surcharges||null,transitTime:0,frequency:y.frequency||null,routingType:y.routingType||"DIRECT",rate45Minus:y.rate45Minus?parseFloat(y.rate45Minus):null,rate45Plus:y.rate45Plus?parseFloat(y.rate45Plus):null,rateM:y.rateM?parseFloat(y.rateM):null,rate45KG:y.rate45KG?parseFloat(y.rate45KG):null,rate100:y.rate100?parseFloat(y.rate100):null,rate300:y.rate300?parseFloat(y.rate300):null,rate500:y.rate500?parseFloat(y.rate500):null,rate1000:y.rate1000?parseFloat(y.rate1000):null,rate20GP:y.rate20GP?parseFloat(y.rate20GP):null,rate40GP:y.rate40GP?parseFloat(y.rate40GP):null,rate40HQ:y.rate40HQ?parseFloat(y.rate40HQ):null,lclRate:y.lclRate?parseFloat(y.lclRate):null},r={freightType:n,origin:o.origin,destination:o.destination,route:o.route||"".concat(o.origin,"/").concat(o.destination),rateDataJson:JSON.stringify(t),validateDate:y.validateDate,owner:"System"};console.log("Sending to backend:",r),console.log("Rate Data:",t);try{if(M){H(!0);const e=We(We({},r),{},{id:M});await Jn(e)}else await $n(r);V(),c({origin:"",destination:"",route:"",weight:"",containerType:"",volume:""}),W(),p(M?"Rate updated successfully!":"Rate created successfully!"),setTimeout(()=>p(""),3e3)}catch(i){var a,s;console.error("Error saving rate:",i),z((null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||i.message||"Failed to save rate.")}},className:"bg-slate-50 rounded-lg p-6 border-2 border-slate-200",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[M?(0,ga.jsx)(Kn,{className:"w-5 h-5 text-amber-600"}):(0,ga.jsx)(dn,{className:"w-5 h-5 text-teal-600"}),M?"Update Rate":"Create New Rate"]}),U&&(0,ga.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(vn,{className:"w-4 h-4 text-red-600"}),(0,ga.jsx)("p",{className:"text-sm text-red-600",children:U})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[(0,ga.jsx)(En,{className:"w-4 h-4 inline mr-1"}),"Valid Until *"]}),(0,ga.jsx)("input",{name:"validateDate",type:"date",value:y.validateDate,onChange:K,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0})]}),n.startsWith("air")&&(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[(0,ga.jsx)(wn,{className:"w-4 h-4 inline mr-1"}),"Airline"]}),(0,ga.jsx)("input",{name:"airline",value:y.airline,onChange:K,placeholder:"e.g., EK, QR, UL",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),n.startsWith("sea")&&(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[(0,ga.jsx)(jn,{className:"w-4 h-4 inline mr-1"}),"Liner/Carrier"]}),(0,ga.jsx)("input",{name:"liner",value:y.liner,onChange:K,placeholder:"e.g., MSC, MAERSK",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]}),"air-import"===n&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h4",{className:"font-medium text-slate-700",children:"Air Import Rates"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"M (-45KG)"}),(0,ga.jsx)("input",{name:"rateM",type:"number",step:"0.01",value:y.rateM,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"+45KG"}),(0,ga.jsx)("input",{name:"rate45KG",type:"number",step:"0.01",value:y.rate45KG,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]})]}),"air-export"===n&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h4",{className:"font-medium text-slate-700",children:"Air Export Rates"}),(0,ga.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[{name:"rate45Minus",label:"-45KG"},{name:"rate45Plus",label:"+45KG"},{name:"rate100",label:"+100KG"},{name:"rate300",label:"+300KG"},{name:"rate500",label:"+500KG"},{name:"rate1000",label:"+1000KG"}].map(e=>(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:e.label}),(0,ga.jsx)("input",{name:e.name,type:"number",step:"0.01",value:y[e.name],onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]},e.name))})]}),n.includes("fcl")&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h4",{className:"font-medium text-slate-700",children:"FCL Container Rates"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"20' GP"}),(0,ga.jsx)("input",{name:"rate20GP",type:"number",step:"0.01",value:y.rate20GP,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' GP"}),(0,ga.jsx)("input",{name:"rate40GP",type:"number",step:"0.01",value:y.rate40GP,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' HQ"}),(0,ga.jsx)("input",{name:"rate40HQ",type:"number",step:"0.01",value:y.rate40HQ,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]})]}),n.includes("lcl")&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h4",{className:"font-medium text-slate-700",children:"LCL Rate"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"LCL Rate (USD/CBM or W/M)"}),(0,ga.jsx)("input",{name:"lclRate",type:"number",step:"0.01",value:y.lclRate,onChange:K,placeholder:"0.00",className:"w-full md:w-1/3 px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]}),(0,ga.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,ga.jsxs)("button",{type:"submit",className:"px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-all font-medium flex items-center gap-2",children:[(0,ga.jsx)(Yn,{className:"w-4 h-4"}),M?"Update Rate":"Create Rate"]}),M&&(0,ga.jsx)("button",{type:"button",onClick:V,className:"px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-all font-medium",children:"Cancel"})]})]}),h&&(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-6 border-2 border-green-200",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Ln,{className:"w-5 h-5 text-green-600"}),"Shipment Details & Cost Calculation"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(n.includes("air")||n.includes("lcl"))&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Weight (KG)"}),(0,ga.jsx)("input",{name:"weight",type:"number",value:o.weight,onChange:Y,placeholder:"Enter weight",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),n.includes("fcl")&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Container Type"}),(0,ga.jsxs)("select",{name:"containerType",value:o.containerType,onChange:Y,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,ga.jsx)("option",{value:"",children:"Select Container Type"}),(0,ga.jsx)("option",{value:"20GP",children:"20' GP"}),(0,ga.jsx)("option",{value:"40GP",children:"40' GP"}),(0,ga.jsx)("option",{value:"40HQ",children:"40' HQ"})]})]}),n.includes("lcl")&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Volume (CBM)"}),(0,ga.jsx)("input",{name:"volume",type:"number",value:o.volume,onChange:Y,placeholder:"Enter volume",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),g>0&&(0,ga.jsx)("div",{className:"bg-white rounded-lg p-6 border-2 border-green-300 shadow-sm",children:(0,ga.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"text-sm text-slate-600 mb-1",children:"Estimated Freight Cost"}),(0,ga.jsx)("p",{className:"text-3xl font-bold text-green-600",children:(X=g,new Intl.NumberFormat("en-US",{style:"currency",currency:b.currency,minimumFractionDigits:2}).format(X))})]}),(0,ga.jsx)(sn,{className:"w-12 h-12 text-green-500"})]})})]})]})]})]}),2===r&&(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all font-medium",disabled:_,children:"Cancel"}),(0,ga.jsx)("div",{className:"flex flex-col sm:flex-row gap-2",children:(0,ga.jsx)("button",{onClick:()=>(async()=>{})(),disabled:_,className:"px-6 py-3 text-white bg-slate-600 hover:bg-slate-700 disabled:bg-slate-400 rounded-lg transition-all font-medium flex items-center gap-2 justify-center",children:_?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Close..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Yn,{className:"w-4 h-4"}),"Close"]})})})]})]});var X}function Zn(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)("quote"),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(0),f=()=>{t(!1),d(null)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{i(!n)},isMobileMenuOpen:n}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:n,onClose:()=>{i(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(Vn,{modalOpen:function(){o(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"quote"),d(null),t(!0)},onEditDocument:e=>{var r;d(e),o((null===(r=e.type)||void 0===r?void 0:r.toLowerCase())||"quote"),t(!0)},refreshTrigger:u,openRateModal:()=>{a(!0)}})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:f}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Gn,{onClose:f,type:l,editDocument:c,onSuccess:()=>{h(e=>e+1)}})})})]}),r&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:f}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Qn,{onClose:()=>{a(!1)}})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const es=Ta("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),ts=Ta("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),rs=Ta("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),as=Ta("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function ns(e){let{rfqId:t,rfqNumber:r,onClose:a}=e;const[n,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(100);(0,s.useEffect)(()=>(f(),()=>{c&&URL.revokeObjectURL(c)}),[t]);const f=async()=>{i(!0),o(null);try{const e=await(async e=>{try{return(await fa.get("".concat(ma,"/rfq/").concat(e))).data}catch(l){throw new Error("Failed to get obj from rfq")}})(t);if(console.log("Raw response:",e),!e||""===e)return void o("No PDF data available for this RFQ");const r=atob(e),a=new Array(r.length);for(let t=0;t<r.length;t++)a[t]=r.charCodeAt(t);const n=new Uint8Array(a),s=new Blob([n],{type:"application/pdf"}),i=URL.createObjectURL(s);d(i)}catch(e){console.error("Error fetching RFQ PDF:",e),o("Failed to load PDF. Please try again.")}finally{i(!1)}};return(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2 md:p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-[95vw] h-[95vh] flex flex-col overflow-hidden animate-fadeIn",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n          @keyframes fadeIn {\n            from {\n              opacity: 0;\n              transform: scale(0.95);\n            }\n            to {\n              opacity: 1;\n              transform: scale(1);\n            }\n          }\n          \n          @keyframes shimmer {\n            0% {\n              background-position: -1000px 0;\n            }\n            100% {\n              background-position: 1000px 0;\n            }\n          }\n          \n          .animate-fadeIn {\n            animation: fadeIn 0.2s ease-out;\n          }\n          \n          .skeleton {\n            animation: shimmer 2s infinite;\n            background: linear-gradient(\n              90deg,\n              #f0f0f0 25%,\n              #e0e0e0 50%,\n              #f0f0f0 75%\n            );\n            background-size: 1000px 100%;\n          }\n        "}),(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-3 flex items-center justify-between flex-shrink-0",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"bg-white/20 p-1.5 rounded-lg",children:(0,ga.jsx)(Ha,{className:"w-4 h-4 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h2",{className:"text-lg font-bold text-white",children:"RFQ Document"}),(0,ga.jsx)("p",{className:"text-blue-100 text-xs",children:n?"Loading PDF...":"RFQ #".concat(r||t)})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[!n&&!l&&c&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"flex items-center gap-1 bg-white/20 rounded-lg p-1",children:[(0,ga.jsx)("button",{onClick:()=>{h(e=>Math.max(e-10,50))},className:"text-white hover:bg-white/20 rounded p-1.5 transition-colors duration-200",title:"Zoom Out",children:(0,ga.jsx)(ts,{className:"w-4 h-4"})}),(0,ga.jsxs)("span",{className:"text-white text-sm font-medium px-2 min-w-[3rem] text-center",children:[u,"%"]}),(0,ga.jsx)("button",{onClick:()=>{h(e=>Math.min(e+10,200))},className:"text-white hover:bg-white/20 rounded p-1.5 transition-colors duration-200",title:"Zoom In",children:(0,ga.jsx)(rs,{className:"w-4 h-4"})})]}),(0,ga.jsxs)("button",{onClick:()=>{if(!c)return;const e=document.createElement("a");e.href=c,e.download="RFQ_".concat(r||t,".pdf"),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors duration-200 text-sm font-medium",children:[(0,ga.jsx)(es,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Download"})]})]}),(0,ga.jsx)("button",{onClick:a,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors duration-200",children:(0,ga.jsx)(Ea,{className:"w-5 h-5"})})]})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-hidden bg-slate-100",children:n?(0,ga.jsxs)("div",{className:"h-full flex flex-col items-center justify-center space-y-4 p-8",children:[(0,ga.jsx)(as,{className:"w-12 h-12 text-blue-600 animate-spin"}),(0,ga.jsx)("p",{className:"text-slate-600 font-medium",children:"Loading PDF..."}),(0,ga.jsx)("div",{className:"w-full max-w-md space-y-3",children:Array(3).fill(0).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton"},t))})]}):l?(0,ga.jsxs)("div",{className:"h-full flex flex-col items-center justify-center py-12",children:[(0,ga.jsx)(vn,{className:"w-16 h-16 text-red-500 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-700 font-medium text-lg mb-2",children:"Error Loading PDF"}),(0,ga.jsx)("p",{className:"text-slate-500 text-sm mb-6",children:l}),(0,ga.jsx)("button",{onClick:f,className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium",children:"Try Again"})]}):c?(0,ga.jsx)("div",{className:"h-full w-full overflow-auto bg-slate-100 p-2",children:(0,ga.jsx)("div",{className:"transition-transform duration-200 origin-top-left",style:{transform:"scale(".concat(u/100,")"),width:"".concat(100/(u/100),"%"),height:"".concat(100/(u/100),"%")},children:(0,ga.jsx)("iframe",{src:c,className:"w-full h-full border-none bg-white",title:"RFQ PDF Document",style:{minHeight:"100vh"}})})}):(0,ga.jsxs)("div",{className:"h-full flex flex-col items-center justify-center py-12",children:[(0,ga.jsx)(Ha,{className:"w-16 h-16 text-slate-300 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 font-medium text-lg",children:"No PDF Available"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:"This RFQ has no associated PDF document"})]})}),!n&&!l&&c&&(0,ga.jsx)("div",{className:"px-4 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between text-sm text-slate-600",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsxs)("span",{className:"font-medium text-slate-800",children:["RFQ #",r||t]}),(0,ga.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,ga.jsx)("span",{children:"PDF Document"})]}),(0,ga.jsx)("button",{onClick:a,className:"px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors duration-200 font-medium",children:"Close"})]})})]})})}function ss(e){let{modalOpen:t,onEdit:r}=e;const[a,n]=(0,s.useState)(!1),[i,l]=(0,s.useState)(""),[o,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),[m,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{g()},[]);const g=async()=>{n(!0);try{const e=await(async()=>{try{return(await fa.get("".concat(ma,"/rfq"))).data}catch(e){throw new Error("Failed to fetch rfqs")}})();console.log("Fetched RFQ data:",e),c(e)}catch(e){console.error("Error fetching RFQ items:",e)}finally{n(!1)}},x=(e,t)=>{f(e),p(t),u(!0)},b=async e=>{console.log("Download RFQ:",e)},v=o.filter(e=>{var t,r;const a=i.toLowerCase(),n=(null===(t=e.rfq_number)||void 0===t?void 0:t.toLowerCase())||"",s=(null===(r=e.customer)||void 0===r?void 0:r.toLowerCase())||"";return n.includes(a)||s.includes(a)}),y=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},w=e=>{if(!e)return!1;const t=new Date(e),r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t<r};return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            background-position: -1000px 0;\n          }\n          100% {\n            background-position: 1000px 0;\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .skeleton {\n          animation: shimmer 2s infinite;\n          background: linear-gradient(\n            90deg,\n            #f0f0f0 25%,\n            #e0e0e0 50%,\n            #f0f0f0 75%\n          );\n          background-size: 1000px 100%;\n        }\n\n        .table-row-hover:hover {\n          background-color: rgba(59, 130, 246, 0.02);\n        }\n\n        .expired-row {\n          background-color: rgba(239, 68, 68, 0.05);\n        }\n\n        .expired-row:hover {\n          background-color: rgba(239, 68, 68, 0.08);\n        }\n\n        .expired-date {\n          color: #dc2626;\n          font-weight: 600;\n        }\n\n        .expired-badge {\n          display: inline-flex;\n          align-items: center;\n          gap: 4px;\n          padding: 2px 8px;\n          background-color: #fee2e2;\n          color: #991b1b;\n          border-radius: 6px;\n          font-size: 0.75rem;\n          font-weight: 500;\n        }\n      "}),(0,ga.jsxs)("main",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto",children:[(0,ga.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Va,{className:"w-8 h-8 text-blue-600"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"RFQ"}),(0,ga.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Request for Quotation Data"})]})]})}),(0,ga.jsx)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:(0,ga.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg font-medium text-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Add New RFQ"})]})})]}),(0,ga.jsx)("div",{className:"mb-6 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:(0,ga.jsxs)("div",{className:"relative max-w-md",children:[(0,ga.jsx)(hn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search by RFQ number or customer...",value:i,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200 bg-white shadow-sm"})]})}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"300ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{children:(0,ga.jsxs)("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200",children:[(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"RFQ Number"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Customer"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Valid Date"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-200",children:a?Array(5).fill(0).map((e,t)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-3/4"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-2/3"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"h-8 w-8 bg-slate-200 rounded-lg skeleton"}),(0,ga.jsx)("div",{className:"h-8 w-8 bg-slate-200 rounded-lg skeleton"})]})})]},t)):v.length>0?v.map((e,t)=>{const r=w(e.valid_date);return(0,ga.jsxs)("tr",{className:"table-row-hover transition-colors duration-150 ".concat(r?"expired-row":""),style:{animation:"fadeInUp 0.4s ease-out",animationDelay:"".concat(50*t,"ms"),animationFillMode:"both"},children:[(0,ga.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-slate-800",children:e.rfq_number||"N/A"}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.customer||"N/A"}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ga.jsx)("span",{className:"text-sm ".concat(r?"expired-date":"text-slate-600"),children:y(e.valid_date)}),r&&(0,ga.jsxs)("span",{className:"expired-badge",children:[(0,ga.jsx)(vn,{className:"w-3 h-3"}),"Expired"]})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("button",{onClick:()=>x(e.sysID,e.rfq_number),className:"p-1.5 hover:bg-blue-50 rounded-lg transition-colors duration-150 text-blue-600 hover:text-blue-700",title:"View PDF",children:(0,ga.jsx)(fn,{className:"w-4 h-4"})}),(0,ga.jsx)("button",{onClick:()=>b(e),className:"p-1.5 hover:bg-green-50 rounded-lg transition-colors duration-150 text-green-600 hover:text-green-700",title:"Download",children:(0,ga.jsx)(es,{className:"w-4 h-4"})})]})})]},e.sysID)}):(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"4",className:"px-6 py-12",children:(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,ga.jsx)(Va,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 font-medium",children:"No RFQ found"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new RFQ"})]})})})})]})}),(0,ga.jsx)("div",{className:"md:hidden space-y-4 p-4",children:a?Array(5).fill(0).map((e,t)=>(0,ga.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:(0,ga.jsxs)("div",{className:"space-y-3",children:[(0,ga.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-2/3"}),(0,ga.jsxs)("div",{className:"flex gap-2",children:[(0,ga.jsx)("div",{className:"h-9 bg-slate-200 rounded skeleton flex-1"}),(0,ga.jsx)("div",{className:"h-9 bg-slate-200 rounded skeleton flex-1"})]})]})},t)):v.length>0?v.map((e,t)=>{const r=w(e.valid_date);return(0,ga.jsxs)("div",{className:"border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 ".concat(r?"border-red-200 bg-red-50/50":"bg-white"),style:{animation:"fadeInUp 0.4s ease-out",animationDelay:"".concat(50*t,"ms"),animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"p-4 border-b ".concat(r?"border-red-100 bg-red-100/50":"border-slate-100 bg-blue-50"),children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,ga.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"RFQ Number"}),r&&(0,ga.jsxs)("span",{className:"expired-badge",children:[(0,ga.jsx)(vn,{className:"w-3 h-3"}),"Expired"]})]}),(0,ga.jsx)("h3",{className:"text-base font-bold text-slate-900",children:e.rfq_number||"N/A"})]}),(0,ga.jsxs)("div",{className:"p-4 space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsx)("span",{className:"text-xs text-slate-500",children:"Customer"}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.customer||"N/A"})]}),(0,ga.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100",children:[(0,ga.jsx)("span",{className:"text-xs text-slate-500",children:"Valid Date"}),(0,ga.jsx)("span",{className:"text-sm font-semibold ".concat(r?"expired-date":"text-slate-900"),children:y(e.valid_date)})]})]}),(0,ga.jsxs)("div",{className:"px-4 py-3 bg-slate-50 border-t border-slate-100 flex items-center gap-2",children:[(0,ga.jsxs)("button",{onClick:()=>x(e.sysID,e.rfq_number),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,ga.jsx)(fn,{className:"w-4 h-4"}),"View PDF"]}),(0,ga.jsxs)("button",{onClick:()=>b(e),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-sm font-medium text-green-600 hover:bg-green-50 rounded-lg transition-colors",children:[(0,ga.jsx)(es,{className:"w-4 h-4"}),"Download"]})]})]},e.sysID)}):(0,ga.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-12",children:(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,ga.jsx)(Va,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 font-medium",children:"No RFQ found"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new RFQ"})]})})})]}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:()=>{g()},disabled:a,className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh",children:(0,ga.jsx)(on,{className:"w-5 h-5 ".concat(a?"animate-spin":"group-hover:rotate-180 transition-transform duration-300")})})}),(0,ga.jsx)("div",{className:"h-8"})]}),d&&(0,ga.jsx)(ns,{rfqId:h,rfqNumber:m,onClose:()=>{u(!1),f(null),p(null)}})]})}function is(e){let{onClose:t,initialItem:r,isEditMode:a}=e;const[n,i]=(0,s.useState)({rfq_number:"",customer:"",valid_date:"",file:null}),[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)({}),[u,h]=(0,s.useState)("");(0,s.useEffect)(()=>{a&&r&&i({rfq_number:r.rfq_number||"",customer:r.customer||"",valid_date:r.valid_date||"",file:null})},[a,r]);const f=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),c[t]&&d(e=>We(We({},e),{},{[t]:""}))};return(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,ga.jsx)(Ln,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h2",{className:"text-xl font-bold text-white",children:a?"Edit RFQ":"Add New RFQ"}),(0,ga.jsx)("p",{className:"text-blue-100 text-sm",children:a?"Update RFQ information":"Add a new Request for Quotation"})]})]}),(0,ga.jsx)("button",{onClick:()=>t(),className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors duration-200",children:(0,ga.jsx)(Ea,{className:"w-5 h-5"})})]}),(0,ga.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return n.rfq_number.trim()||(e.rfq_number="RFQ Number is required"),n.customer.trim()||(e.customer="Customer is required"),n.valid_date.trim()||(e.valid_date="Valid Date is required"),a||n.file||(e.file="PDF file is required"),d(e),0===Object.keys(e).length})()){o(!0);try{const e=n.file,r=await(e=>new Promise((t,r)=>{const a=new FileReader;a.onload=()=>{const e=a.result.split(",")[1];t(e)},a.onerror=e=>r(e),a.readAsDataURL(e)}))(e),a={rfq_number:n.rfq_number,customer:n.customer,valid_date:n.valid_date,data_obj:r,file_name:e.name,added_by:"Kavindu Tharaka"};console.log("Saving RFQ with PDF...");const s=await(async e=>{try{return(await fa.post("".concat(ma,"/rfq"),e)).data}catch(t){throw new Error("Failed to create rfq")}})(a);console.log(s),s&&window.location.reload(),t(a)}catch(r){console.error("Error saving RFQ:",r),d({submit:"Failed to save. Please try again."})}finally{o(!1)}}},className:"p-6 space-y-5",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["RFQ Number ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"rfq_number",value:n.rfq_number,onChange:f,placeholder:"Enter RFQ Number...",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(c.rfq_number?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),c.rfq_number&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.rfq_number})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Customer ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"customer",value:n.customer,onChange:f,placeholder:"Enter customer",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(c.customer?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),c.customer&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.customer})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Valid Date ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"date",name:"valid_date",value:n.valid_date,onChange:f,className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(c.valid_date?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),c.valid_date&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.valid_date})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["PDF File ",!a&&(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsxs)("div",{className:"space-y-2",children:[!n.file&&(0,ga.jsx)("div",{children:(0,ga.jsxs)("label",{htmlFor:"file-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed rounded-lg cursor-pointer transition-all duration-200 ".concat(c.file?"border-red-300 bg-red-50 hover:bg-red-100":"border-slate-300 bg-slate-50 hover:bg-slate-100"),children:[(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center pt-2 pb-2",children:[(0,ga.jsx)(Ha,{className:"w-6 h-6 mb-1 ".concat(c.file?"text-red-400":"text-slate-400")}),(0,ga.jsxs)("p",{className:"text-xs ".concat(c.file?"text-red-600":"text-slate-500"),children:[(0,ga.jsx)("span",{className:"font-medium",children:"Click to upload"})," or drag and drop"]}),(0,ga.jsx)("p",{className:"text-xs text-slate-400 mt-0.5",children:"PDF files only (Max 20MB)"})]}),(0,ga.jsx)("input",{id:"file-upload",type:"file",accept:".pdf,application/pdf",onChange:e=>{const t=e.target.files[0];if(t){const r=["application/pdf"],a=[".pdf"],n=t.name.toLowerCase().substring(t.name.lastIndexOf("."));if(!r.includes(t.type)&&!a.includes(n))return d(e=>We(We({},e),{},{file:"Please select a valid PDF file (.pdf)"})),void(e.target.value=null);if(t.size>20971520)return d(e=>We(We({},e),{},{file:"File size must be less than 20MB"})),void(e.target.value=null);i(e=>We(We({},e),{},{file:t})),h(t.name),c.file&&d(e=>We(We({},e),{},{file:""}))}},className:"hidden"})]})}),u&&(0,ga.jsxs)("div",{className:"flex items-center justify-between gap-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-blue-600"}),(0,ga.jsx)("span",{className:"text-sm text-blue-700 font-medium truncate",children:u})]}),(0,ga.jsx)("button",{type:"button",onClick:()=>{i(e=>We(We({},e),{},{file:null})),h("")},className:"text-blue-600 hover:text-blue-800",children:(0,ga.jsx)(Ea,{className:"w-4 h-4"})})]})]}),c.file&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.file})]}),c.submit&&(0,ga.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:c.submit}),(0,ga.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[(0,ga.jsx)("button",{type:"button",onClick:()=>t(),disabled:l,className:"px-5 py-2.5 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",disabled:l,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:l?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(as,{className:"w-4 h-4 animate-spin"}),(0,ga.jsx)("span",{children:"Saving..."})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Yn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:a?"Update":"Save"})]})})]})]})]})}function ls(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),l=()=>{t(!1),i(null)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(ss,{modalOpen:()=>{i(null),t(!0)},onEdit:e=>{i(e),t(!0)}})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:l}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full max-w-2xl animate-fadeIn",children:(0,ga.jsx)(is,{onClose:e=>{l()},initialItem:n,isEditMode:!!n})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const os=Ta("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),cs=Ta("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),ds=Ta("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),us=Ta("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),hs=Ta("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),fs=async e=>{try{return(await fa.patch("".concat(ma,"/Lead/bulk/approve"),{leadIds:e})).data}catch(t){throw new Error("Failed to bulk approve leads")}},ms=async(e,t)=>{try{return(await fa.patch("".concat(ma,"/Lead/bulk/reject"),{leadIds:e,reason:t})).data}catch(r){throw new Error("Failed to bulk reject leads")}};function ps(e){let{onClose:t,createGLeadId:r}=e;const[a,n]=(0,s.useState)({leadName:"",status:"",company:"",title:"",email:"",phone:"",lastInteraction:"",activeSequences:"",notes:"",priority:"medium",score:50}),[i,l]=(0,s.useState)({}),[o,c]=(0,s.useState)(!1),d=e=>{const{name:t,value:r}=e.target;n(e=>We(We({},e),{},{[t]:r})),i[t]&&l(e=>We(We({},e),{},{[t]:""}))};return(0,ga.jsxs)("div",{className:"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-orange-50 to-amber-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(os,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:"Add New Lead"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Capture and track potential customers"})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,ga.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return a.leadName.trim()||(e.leadName="Lead name is required"),a.status||(e.status="Status is required"),a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)||(e.email="Please enter a valid email address"):e.email="Email is required",a.phone&&!/^[\+]?[1-9][\d]{0,15}$/.test(a.phone.replace(/[\s\-\(\)]/g,""))&&(e.phone="Please enter a valid phone number"),a.company.trim()||(e.company="Company name is required"),l(e),0===Object.keys(e).length})()){c(!0);try{const e={name:a.leadName,status:a.status,company:a.company,title:a.title,email:a.email,phone:a.phone,lastInteraction:a.lastInteraction,activeSequences:a.activeSequences,notes:a.notes,priority:a.priority,score:parseInt(a.score),approvalStatus:"pending",assignedTo:null};console.log("ll",e);const n=await(async e=>{try{return(await fa.post("".concat(ma,"/Lead"),e)).data}catch(t){throw new Error("Failed to create lead")}})(e);console.log("Created lead response",n),console.log("Going to lead save",n.id,r),alert("Lead created successfully!"),t(),window.location.reload()}catch(n){alert("Failed to create lead. Please try again.")}finally{c(!1)}}},className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(os,{className:"w-4 h-4 text-orange-600"}),"Lead Name *"]}),(0,ga.jsx)("input",{type:"text",name:"leadName",value:a.leadName,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.leadName?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter lead's full name"}),i.leadName&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.leadName]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(cs,{className:"w-4 h-4 text-orange-600"}),"Status *"]}),(0,ga.jsxs)("select",{name:"status",value:a.status,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.status?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,ga.jsx)("option",{value:"",children:"Select status"}),[{value:"new",label:"New Lead",color:"bg-orange-500"},{value:"contacted",label:"Contacted",color:"bg-blue-500"},{value:"qualified",label:"Qualified",color:"bg-green-500"},{value:"unqualified",label:"Unqualified",color:"bg-red-500"},{value:"nurturing",label:"Nurturing",color:"bg-purple-500"},{value:"converted",label:"Converted",color:"bg-emerald-500"},{value:"lost",label:"Lost",color:"bg-gray-500"}].map(e=>(0,ga.jsx)("option",{value:e.value,children:e.label},e.value))]}),i.status&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.status]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(ds,{className:"w-4 h-4 text-orange-600"}),"Company *"]}),(0,ga.jsx)("input",{type:"text",name:"company",value:a.company,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.company?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter company name"}),i.company&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.company]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-orange-600"}),"Title"]}),(0,ga.jsx)("input",{type:"text",name:"title",value:a.title,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",placeholder:"Enter lead's title"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(qa,{className:"w-4 h-4 text-orange-600"}),"Email *"]}),(0,ga.jsx)("input",{type:"email",name:"email",value:a.email,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.email?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter lead's email"}),i.email&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.email]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(us,{className:"w-4 h-4 text-orange-600"}),"Phone"]}),(0,ga.jsx)("input",{type:"text",name:"phone",value:a.phone,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.phone?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter lead's phone number"}),i.phone&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.phone]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-orange-600"}),"Last Interaction"]}),(0,ga.jsx)("input",{type:"date",name:"lastInteraction",value:a.lastInteraction,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(hs,{className:"w-4 h-4 text-orange-600"}),"Active Sequences"]}),(0,ga.jsxs)("select",{name:"activeSequences",value:a.activeSequences,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",children:[(0,ga.jsx)("option",{value:"",children:"Select sequence"}),[{value:"welcome",label:"Welcome Series"},{value:"demo",label:"Product Demo Flow"},{value:"nurture",label:"Lead Nurturing"},{value:"trial",label:"Free Trial Follow-up"},{value:"webinar",label:"Webinar Series"},{value:"consultation",label:"Consultation Booking"},{value:"custom",label:"Custom Sequence"}].map(e=>(0,ga.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(hs,{className:"w-4 h-4 text-orange-600"}),"Priority"]}),(0,ga.jsxs)("select",{name:"priority",value:a.priority,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",children:[(0,ga.jsx)("option",{value:"low",children:"Low"}),(0,ga.jsx)("option",{value:"medium",children:"Medium"}),(0,ga.jsx)("option",{value:"high",children:"High"})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-orange-600"}),"Notes"]}),(0,ga.jsx)("textarea",{name:"notes",value:a.notes,onChange:d,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",placeholder:"Add any additional notes about the lead"})]}),(0,ga.jsxs)("div",{className:"flex gap-4 pt-4 border-t border-slate-200",children:[(0,ga.jsxs)("button",{type:"submit",disabled:o,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ".concat(o?"bg-slate-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-700 text-white"),children:[(0,ga.jsx)(os,{className:"w-5 h-5"}),o?"Creating...":"Create Lead"]}),(0,ga.jsx)("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300 transition-all duration-200",children:"Cancel"})]})]})})]})}const gs=Ta("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),xs=Ta("message-circle-heart",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}],["path",{d:"M7.828 13.07A3 3 0 0 1 12 8.764a3 3 0 0 1 5.004 2.224 3 3 0 0 1-.832 2.083l-3.447 3.62a1 1 0 0 1-1.45-.001z",key:"hoo97p"}]]),bs=Ta("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),vs=Ta("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),ys=Ta("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),ws=Ta("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Ns=Ta("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),js=Ta("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ks=Ta("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),Ss=async()=>(await fa.get("".concat(ma,"/Employee/emp"))).data;function As(e){let{onOpen:t,loading:r=!1,delay:a=0,reviewMode:n=!1,selectedLeads:i=[],setSelectedLeads:l=()=>{},filterStatus:o=null,setFilterStatus:c=()=>{},setLeadCounts:d=()=>{}}=e;const[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),[x,b]=(0,s.useState)([]),[v,y]=(0,s.useState)(!1),[w,N]=(0,s.useState)(null),[j,k]=(0,s.useState)(!0),S=Array(15).fill().map((e,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t%7],status:"inactive"})),A=async()=>{try{y(!0),N(null);const e=await(async()=>{try{return await fa.get("".concat(ma,"/Lead/facebook-leads")),(await fa.get("".concat(ma,"/Lead"))).data}catch(e){return console.warn("Facebook import failed, falling back to existing leads:",e.message),(await fa.get("".concat(ma,"/Lead"))).data}})();if(console.log("Fetched leads:",e),!Array.isArray(e))return console.warn("fetchLeads returned non-array response:",e),void b([]);const t=e.map(e=>{const t={new:{label:"New Lead",color:"bg-orange-500"},contacted:{label:"Contacted",color:"bg-blue-500"},qualified:{label:"Qualified",color:"bg-green-500"},converted:{label:"Converted",color:"bg-purple-500"},lost:{label:"Lost",color:"bg-red-500"}}[(e.status||"new").toLowerCase()]||{label:"New Lead",color:"bg-orange-500"};const r=(a=e.assignedTo)&&u.find(e=>e.id===a)||null;var a;return{id:e.id||Date.now()+Math.random(),name:e.name||"Unknown Lead",status:(e.status||"new").toLowerCase(),statusLabel:t.label,statusColor:t.color,company:e.company||"Unknown Company",title:e.title||"Unknown Title",email:e.email||"",phone:e.phone||"",lastInteraction:e.lastInteraction||"",activeSequences:e.activeSequences||"",approvalStatus:e.approvalStatus||"pending",assignedTo:r,priority:e.priority||"medium",source:e.source||"Unknown",score:e.score||0,notes:e.notes||"",timeline:e.timeline||S,createdAt:e.createdAt,updatedAt:e.updatedAt}});b(t)}catch(e){console.error("Error fetching leads:",e),N("Failed to load leads. Please try again."),b([])}finally{y(!1)}};(0,s.useEffect)(()=>{(async()=>{try{m(!0),g(null);const e=await Ss();console.log("Fetched employees:",e);const t=e.map(e=>({id:e.sysID,name:"".concat(e.fname," ").concat(e.lname).trim(),email:e.email,role:e.position,avatar:"".concat(e.fname[0]).concat(e.lname[0]).toUpperCase(),department:e.department,status:e.status}));h(t)}catch(e){console.error("Error fetching employees:",e),g("Failed to load employees. Please try again.")}finally{m(!1)}})()},[]),(0,s.useEffect)(()=>{u.length>0&&A()},[u]),(0,s.useEffect)(()=>{const e=x.filter(e=>"pending"===e.approvalStatus).length,t=x.filter(e=>"pending"===e.approvalStatus&&!e.assignedTo).length;d({pending:e,quickReview:t})},[x,d]);const[C,_]=(0,s.useState)(null),[T,E]=(0,s.useState)(null),[L,P]=(0,s.useState)(null),[O,F]=(0,s.useState)(null),[D,I]=(0,s.useState)(""),R=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=e=>{R.current&&!R.current.contains(e.target)&&(P(null),F(null))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const M=x.filter(e=>"pending"===o?"pending"===e.approvalStatus:"quick-review"!==o||"pending"===e.approvalStatus&&!e.assignedTo),B=async e=>{try{var t;await(async e=>{try{return(await fa.patch("".concat(ma,"/Lead/").concat(e,"/approve"))).data}catch(t){throw new Error("Failed to approve lead with id ".concat(e))}})(e),b(t=>t.map(t=>t.id===e?We(We({},t),{},{approvalStatus:"approved"}):t));const r=(null===(t=x.find(t=>t.id===e))||void 0===t?void 0:t.name)||"Lead";alert("".concat(r," approved successfully!"))}catch(r){console.error("Error approving lead:",r),alert("Failed to approve lead. Please try again.")}},U=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{var r;await(async(e,t)=>{try{return(await fa.patch("".concat(ma,"/Lead/").concat(e,"/reject"),{reason:t})).data}catch(r){throw new Error("Failed to reject lead with id ".concat(e))}})(e,t),b(r=>r.map(r=>r.id===e?We(We({},r),{},{approvalStatus:"rejected",rejectionReason:t}):r));const a=(null===(r=x.find(t=>t.id===e))||void 0===r?void 0:r.name)||"Lead";alert("".concat(a," rejected successfully!"))}catch(a){console.error("Error rejecting lead:",a),alert("Failed to reject lead. Please try again.")}},z=async(e,t)=>{try{1===e.length?await(async(e,t)=>{try{return(await fa.patch("".concat(ma,"/Lead/").concat(e,"/assign"),{employeeId:t})).data}catch(r){throw new Error("Failed to assign lead with id ".concat(e))}})(e[0],t.id):await(async(e,t)=>{try{return(await fa.patch("".concat(ma,"/Lead/bulk/assign"),{leadIds:e,employeeId:t})).data}catch(r){throw new Error("Failed to bulk assign leads")}})(e,t.id),b(r=>r.map(r=>e.includes(r.id)?We(We({},r),{},{assignedTo:t}):r));const r=e.length,a=1===r?"lead":"leads";alert("".concat(r," ").concat(a," assigned to ").concat(t.name," successfully!")),P(null),F(null),l([])}catch(r){console.error("Error assigning leads:",r),alert("Failed to assign leads. Please try again.")}},q=async(e,t)=>{try{const r=We(We({},x.find(t=>t.id===e)),t);await(async(e,t)=>{try{return(await fa.put("".concat(ma,"/Lead/").concat(e),t)).data}catch(r){throw new Error("Failed to update lead with id ".concat(e))}})(e,r),b(r=>r.map(r=>r.id===e?We(We({},r),t):r)),_(null),alert("Lead updated successfully!")}catch(r){console.error("Error updating lead:",r),alert("Failed to update lead. Please try again.")}},H=async(e,t)=>{if(window.confirm("Convert ".concat(t," to a contact? This will move them to your contacts board.")))try{await(async e=>{try{return(await fa.post("".concat(ma,"/Lead/").concat(e,"/convert"))).data}catch(t){throw new Error("Failed to convert lead with id ".concat(e," to contact"))}})(e),b(t=>t.filter(t=>t.id!==e)),alert("".concat(t," has been successfully converted to a contact!"))}catch(r){console.error("Error converting lead:",r),alert("Failed to convert lead. Please try again.")}},W=u.filter(e=>e.name.toLowerCase().includes(D.toLowerCase())||e.email.toLowerCase().includes(D.toLowerCase())),V=(x.filter(e=>"pending"===e.approvalStatus).length,x.filter(e=>"pending"===e.approvalStatus&&!e.assignedTo).length,()=>(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded w-24"}),(0,ga.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("div",{className:"min-w-full",children:[(0,ga.jsx)("div",{className:"grid grid-cols-12 gap-4 p-4 bg-slate-50 border-b border-slate-200",children:Array.from({length:12}).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))}),Array.from({length:2}).map((e,t)=>(0,ga.jsx)("div",{className:"grid grid-cols-12 gap-4 p-4 border-b border-slate-100",children:Array.from({length:12}).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))},t))]})})]})),G=e=>{let{status:t}=e;const r={pending:{icon:nn,color:"bg-amber-100 text-amber-800",label:"Pending"},approved:{icon:sn,color:"bg-green-100 text-green-800",label:"Approved"},rejected:{icon:xn,color:"bg-red-100 text-red-800",label:"Rejected"}},a=r[t]||r.pending,n=a.icon;return(0,ga.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(a.color),children:[(0,ga.jsx)(n,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:a.label})]})},K=e=>{let{priority:t}=e;const r={high:"bg-red-100 text-red-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-green-100 text-green-800"};return(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(r[t]||r.medium),children:[(0,ga.jsx)(tn,{className:"w-3 h-3"}),(t||"medium").charAt(0).toUpperCase()+(t||"medium").slice(1)]})},Y=e=>{let{status:t,color:r,label:a}=e;return(0,ga.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(r||"bg-orange-500"),children:[(()=>{switch(t){case"qualified":return(0,ga.jsx)(ws,{className:"w-3 h-3"});case"contacted":return(0,ga.jsx)(qa,{className:"w-3 h-3"});case"new":return(0,ga.jsx)(os,{className:"w-3 h-3"});case"converted":return(0,ga.jsx)(sn,{className:"w-3 h-3"});case"lost":return(0,ga.jsx)(xn,{className:"w-3 h-3"});default:return(0,ga.jsx)(nn,{className:"w-3 h-3"})}})(),(0,ga.jsx)("span",{children:a||"New Lead"})]})},X=e=>{let{timeline:t}=e;return(0,ga.jsx)("div",{className:"flex gap-1 justify-center items-center",children:(t||S).map((e,t)=>{let r="bg-slate-200";return"qualified"===e.status?r="bg-green-500":"contacted"===e.status?r="bg-blue-500":"new"===e.status?r="bg-orange-500":"pending"===e.status?r="bg-amber-500":"inactive"===e.status&&(r="bg-slate-300"),(0,ga.jsx)("div",{className:"h-6 w-2 rounded-sm ".concat(r," transition-all duration-200 hover:scale-110"),title:"".concat(e.day,": ").concat(e.status)},t)})})},$=e=>{let{leadId:t,currentAssignee:r}=e;return(0,ga.jsx)("div",{className:"absolute z-20 mt-2 w-64 bg-white border border-slate-200 rounded-lg shadow-lg",children:(0,ga.jsxs)("div",{className:"p-2",children:[(0,ga.jsxs)("div",{className:"relative mb-2",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search employees...",value:D,onChange:e=>I(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),f?(0,ga.jsx)("div",{className:"text-center text-sm text-slate-500",children:"Loading employees..."}):p?(0,ga.jsx)("div",{className:"text-center text-sm text-red-500",children:p}):0===W.length?(0,ga.jsx)("div",{className:"text-center text-sm text-slate-500",children:"No employees found"}):(0,ga.jsx)("div",{className:"max-h-40 overflow-y-auto",children:W.map(e=>(0,ga.jsxs)("button",{onClick:()=>z([t],e),className:"w-full p-2 text-left flex items-center gap-2 hover:bg-slate-100 rounded transition-colors ".concat((null===r||void 0===r?void 0:r.id)===e.id?"bg-orange-50":""),children:[(0,ga.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:e.avatar}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-sm font-medium text-slate-900",children:e.name}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:e.email})]})]},e.id))})]})})},J=e=>{let{leadIds:t,onClose:r}=e;const[a,n]=(0,s.useState)(null),i=x.filter(e=>t.includes(e.id));return(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[(0,ga.jsxs)("h3",{className:"text-xl font-semibold text-slate-900",children:["Assign Leads (",t.length,")"]}),(0,ga.jsx)("button",{onClick:r,className:"p-1 hover:bg-slate-100 rounded",children:(0,ga.jsx)(xn,{className:"w-5 h-5 text-slate-400"})})]}),(0,ga.jsxs)("div",{className:"p-6",children:[(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-3",children:"Selected Leads:"}),(0,ga.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:i.map(e=>(0,ga.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,ga.jsx)(os,{className:"w-4 h-4 text-orange-600"}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,ga.jsxs)("div",{className:"text-sm text-slate-600",children:[e.company," \u2022 ",e.title]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(K,{priority:e.priority}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-700",children:e.score})]})]},e.id))})]}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-3",children:"Assign to Employee:"}),(0,ga.jsxs)("div",{className:"relative mb-3",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search employees...",value:D,onChange:e=>I(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),f?(0,ga.jsx)("div",{className:"text-center text-sm text-slate-500",children:"Loading employees..."}):p?(0,ga.jsx)("div",{className:"text-center text-sm text-red-500",children:p}):0===W.length?(0,ga.jsx)("div",{className:"text-center text-sm text-slate-500",children:"No employees found"}):(0,ga.jsx)("div",{className:"grid gap-2 max-h-64 overflow-y-auto",children:W.map(e=>(0,ga.jsx)("button",{onClick:()=>n(e),className:"w-full p-3 text-left rounded-lg border-2 transition-all ".concat((null===a||void 0===a?void 0:a.id)===e.id?"border-orange-500 bg-orange-50":"border-slate-200 hover:border-slate-300 bg-white"),children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-orange-600 text-white rounded-full flex items-center justify-center text-sm font-medium",children:e.avatar}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,ga.jsx)("div",{className:"text-sm text-slate-600",children:e.role}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:e.email})]}),(null===a||void 0===a?void 0:a.id)===e.id&&(0,ga.jsx)(Ns,{className:"w-5 h-5 text-orange-600"})]})},e.id))})]}),(0,ga.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[(0,ga.jsxs)("button",{onClick:()=>{a?z(t,a):alert("Please select an employee to assign.")},className:"flex-1 flex items-center justify-center gap-2 bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed",disabled:!a,children:[(0,ga.jsx)(vs,{className:"w-5 h-5"}),a?"Assign to ".concat(a.name):"Select an Employee"]}),(0,ga.jsx)("button",{onClick:r,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"Cancel"})]})]})]})})},Q=e=>{let{lead:t,onClose:r}=e;const[a,n]=(0,s.useState)({priority:t.priority||"medium",notes:t.notes||"",source:t.source||""});return x&&0!==x.length?(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-900",children:["Quick Edit: ",t.name]}),(0,ga.jsx)("button",{onClick:r,className:"p-1 hover:bg-slate-100 rounded",children:(0,ga.jsx)(xn,{className:"w-5 h-5 text-slate-400"})})]}),(0,ga.jsxs)("form",{onSubmit:e=>{e.preventDefault(),q(t.id,a)},className:"p-4 space-y-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Priority"}),(0,ga.jsxs)("select",{value:a.priority,onChange:e=>n(We(We({},a),{},{priority:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[(0,ga.jsx)("option",{value:"low",children:"Low"}),(0,ga.jsx)("option",{value:"medium",children:"Medium"}),(0,ga.jsx)("option",{value:"high",children:"High"})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source"}),(0,ga.jsx)("input",{type:"text",value:a.source,onChange:e=>n(We(We({},a),{},{source:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,ga.jsx)("textarea",{value:a.notes,onChange:e=>n(We(We({},a),{},{notes:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,ga.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,ga.jsx)("button",{type:"submit",className:"flex-1 bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700 transition-colors",children:"Save Changes"}),(0,ga.jsx)("button",{type:"button",onClick:r,className:"flex-1 bg-slate-200 text-slate-700 py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors",children:"Cancel"})]})]})]})}):null};if(r||f||v)return(0,ga.jsx)(V,{});if(p||w)return(0,ga.jsx)(ga.Fragment,{});const Z=M.length>0&&i.length===M.length&&M.every(e=>i.includes(e.id)),ee=i.length>0&&i.length<M.length;return(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300 animate-slideInLeft",style:{animationDelay:"".concat(a,"ms"),animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 gap-4",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,ga.jsx)("button",{onClick:()=>k(!j),className:"p-1 hover:bg-slate-100 rounded transition-colors group",children:j?(0,ga.jsx)(un,{className:"w-4 h-4 text-slate-400 group-hover:text-slate-600"}):(0,ga.jsx)(js,{className:"w-4 h-4 text-slate-400 group-hover:text-slate-600"})}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("h2",{className:"text-lg font-bold text-slate-800",children:["All Leads"," ",n&&(0,ga.jsx)("span",{className:"text-sm text-orange-600",children:"(Review Mode)"}),o&&(0,ga.jsxs)("span",{className:"text-sm text-blue-600",children:[" ","- ","pending"===o?"Pending":"Quick Review"]})]}),(0,ga.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:o?"Showing ".concat(M.length," filtered lead(s)"):"Manage all your leads in one place (".concat(x.length," total)")})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[i.length>0&&(0,ga.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-orange-50 rounded-lg border border-orange-200",children:[(0,ga.jsxs)("span",{className:"text-sm text-orange-800 font-medium",children:[i.length," selected"]}),(0,ga.jsx)("button",{onClick:async()=>{if(0!==i.length)try{await fs(i),b(e=>e.map(e=>i.includes(e.id)?We(We({},e),{},{approvalStatus:"approved"}):e)),alert("".concat(i.length," lead(s) approved successfully!")),l([])}catch(e){console.error("Error bulk approving leads:",e),alert("Failed to approve leads. Please try again.")}else alert("Please select leads to approve")},className:"p-1 hover:bg-green-100 rounded transition-colors",title:"Approve selected",children:(0,ga.jsx)(sn,{className:"w-4 h-4 text-green-600"})}),(0,ga.jsx)("button",{onClick:async()=>{if(0===i.length)return void alert("Please select leads to reject");const e=window.prompt("Enter rejection reason (optional):");if(null!==e)try{await ms(i,e),b(t=>t.map(t=>i.includes(t.id)?We(We({},t),{},{approvalStatus:"rejected",rejectionReason:e}):t)),alert("".concat(i.length," lead(s) rejected successfully!")),l([])}catch(t){console.error("Error bulk rejecting leads:",t),alert("Failed to reject leads. Please try again.")}},className:"p-1 hover:bg-red-100 rounded transition-colors",title:"Reject selected",children:(0,ga.jsx)(xn,{className:"w-4 h-4 text-red-600"})}),(0,ga.jsx)("button",{onClick:()=>{0!==i.length?P([...i]):alert("Please select leads to assign")},className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Assign selected leads",children:(0,ga.jsx)(vs,{className:"w-4 h-4 text-blue-600"})})]}),(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors",children:(0,ga.jsx)(Qa,{className:"w-4 h-4 text-slate-400"})})]})]}),0===M.length?(0,ga.jsxs)("div",{className:"text-center py-12 bg-white rounded-b-xl",children:[(0,ga.jsx)(os,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),(0,ga.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:o?"No Leads Match Filter":"No Leads Available"}),(0,ga.jsx)("p",{className:"text-slate-600 mb-6 text-lg",children:o?"Try adjusting your filter criteria.":"Start by adding leads to manage your prospects effectively."}),!o&&t&&(0,ga.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-orange-600 text-white rounded-lg font-medium hover:bg-orange-700 transition-colors shadow-md",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),"Add Your First Lead"]})]}):(0,ga.jsx)("div",{className:"overflow-x-auto",children:j&&(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-4 py-3 text-left bg-slate-50 sticky left-0 z-10 border-r border-slate-200",children:(0,ga.jsx)("input",{type:"checkbox",checked:Z,ref:e=>{e&&(e.indeterminate=ee)},onChange:e=>(e=>{const t=e?M.map(e=>e.id):[];l(t)})(e.target.checked),className:"w-4 h-4 text-orange-600 border-slate-300 rounded focus:ring-orange-500 focus:ring-2"})}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider bg-slate-50 sticky left-16 z-10 border-r border-slate-200 min-w-48",children:"Lead"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Status"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Approval"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Priority"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Score"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Assigned To"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Timeline"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Company"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Email"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Source"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-100",children:M.map(e=>(0,ga.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,ga.jsx)("td",{className:"px-4 py-4 bg-white sticky left-0 z-10 border-r border-slate-200 shadow-sm group-hover:bg-slate-50",children:(0,ga.jsx)("input",{type:"checkbox",checked:i.includes(e.id),onChange:t=>((e,t)=>{const r=t?[...i,e]:i.filter(t=>t!==e);l(r)})(e.id,t.target.checked),className:"w-4 h-4 text-orange-600 border-slate-300 rounded focus:ring-orange-500 focus:ring-2"})}),(0,ga.jsx)("td",{className:"px-4 py-4 bg-white sticky left-16 z-10 border-r border-slate-200 min-w-48 shadow-sm group-hover:bg-slate-50",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(os,{className:"w-4 h-4 text-orange-600"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:e.title})]})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(Y,{status:e.status,color:e.statusColor,label:e.statusLabel})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(G,{status:e.approvalStatus})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(K,{priority:e.priority})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.score>=80?"bg-green-500":e.score>=60?"bg-yellow-500":"bg-red-500")}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.score})]})}),(0,ga.jsx)("td",{className:"px-4 py-4 relative",children:e.assignedTo?(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:e.assignedTo.avatar}),(0,ga.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ga.jsx)("div",{className:"text-sm font-medium text-slate-900 truncate",children:e.assignedTo.name}),(0,ga.jsx)("div",{className:"text-xs text-slate-500 truncate",children:e.assignedTo.role})]}),(0,ga.jsx)("button",{onClick:()=>F(O===e.id?null:e.id),className:"p-1 hover:bg-slate-100 rounded transition-colors",children:(0,ga.jsx)(un,{className:"w-3 h-3 text-slate-400"})})]}):(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsxs)("button",{onClick:()=>F(O===e.id?null:e.id),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm text-slate-600 transition-colors",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Assign"}),(0,ga.jsx)(un,{className:"w-3 h-3"})]}),O===e.id&&(0,ga.jsx)($,{leadId:e.id,currentAssignee:e.assignedTo})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(X,{timeline:e.timeline})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("div",{className:"flex items-center gap-1",children:n?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("button",{onClick:()=>E(e),className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Review details",children:(0,ga.jsx)(fn,{className:"w-4 h-4 text-blue-600"})}),(0,ga.jsx)("button",{onClick:()=>B(e.id),className:"p-1 hover:bg-green-100 rounded transition-colors",title:"Approve",children:(0,ga.jsx)(sn,{className:"w-4 h-4 text-green-600"})}),(0,ga.jsx)("button",{onClick:()=>U(e.id),className:"p-1 hover:bg-red-100 rounded transition-colors",title:"Reject",children:(0,ga.jsx)(xn,{className:"w-4 h-4 text-red-600"})})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("button",{onClick:()=>_(e),className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Quick edit",children:(0,ga.jsx)(ks,{className:"w-4 h-4 text-blue-600"})}),(0,ga.jsx)("button",{onClick:()=>H(e.id,e.name),className:"p-1 hover:bg-green-100 rounded transition-colors",title:"Convert to contact",children:(0,ga.jsx)(_n,{className:"w-4 h-4 text-green-600"})}),(0,ga.jsx)("button",{className:"p-1 hover:bg-orange-100 rounded transition-colors",title:"Add note",children:(0,ga.jsx)(bs,{className:"w-4 h-4 text-orange-600"})})]})})}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(ds,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.company})]})}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(qa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate max-w-32",children:e.email})]})}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,ga.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-slate-100 text-slate-700",children:e.source})})]},e.id))})]})})]}),L&&(0,ga.jsx)(J,{leadIds:L,onClose:()=>{P(null),l([])}}),C&&(0,ga.jsx)(Q,{lead:C,onClose:()=>_(null)}),T&&(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[(0,ga.jsxs)("h3",{className:"text-xl font-semibold text-slate-900",children:["Review Lead: ",T.name]}),(0,ga.jsx)("button",{onClick:()=>E(null),className:"p-1 hover:bg-slate-100 rounded",children:(0,ga.jsx)(xn,{className:"w-5 h-5 text-slate-400"})})]}),(0,ga.jsxs)("div",{className:"p-6 space-y-6",children:[(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Company"}),(0,ga.jsx)("p",{className:"text-slate-900",children:T.company})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Title"}),(0,ga.jsx)("p",{className:"text-slate-900",children:T.title})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),(0,ga.jsx)("p",{className:"text-slate-900",children:T.email})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone"}),(0,ga.jsx)("p",{className:"text-slate-900",children:T.phone})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source"}),(0,ga.jsx)("p",{className:"text-slate-900",children:T.source})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Score"}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(T.score>=80?"bg-green-500":T.score>=60?"bg-yellow-500":"bg-red-500")}),(0,ga.jsxs)("span",{className:"font-medium",children:[T.score,"/100"]})]})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Priority:"}),(0,ga.jsx)(K,{priority:T.priority})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Status:"}),(0,ga.jsx)(Y,{status:T.status,color:T.statusColor,label:T.statusLabel})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Approval:"}),(0,ga.jsx)(G,{status:T.approvalStatus})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),(0,ga.jsx)("p",{className:"text-slate-900 bg-slate-50 p-3 rounded-lg",children:T.notes||"No notes available"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Recent Activity"}),(0,ga.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,ga.jsx)(X,{timeline:T.timeline}),(0,ga.jsx)("p",{className:"text-xs text-slate-600 mt-2 text-center",children:"Last 15 days of activity"})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Assignment"}),(0,ga.jsx)("div",{className:"flex items-center gap-2",children:T.assignedTo?(0,ga.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 rounded-lg",children:[(0,ga.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:T.assignedTo.avatar}),(0,ga.jsxs)("span",{className:"text-sm text-green-800",children:["Assigned to ",T.assignedTo.name]})]}):(0,ga.jsx)("span",{className:"text-sm text-slate-500 px-3 py-2 bg-slate-100 rounded-lg",children:"Not assigned"})})]}),(0,ga.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[(0,ga.jsxs)("button",{onClick:()=>{B(T.id),E(null)},className:"flex-1 flex items-center justify-center gap-2 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors",children:[(0,ga.jsx)(sn,{className:"w-5 h-5"}),"Approve Lead"]}),(0,ga.jsxs)("button",{onClick:()=>{U(T.id),E(null)},className:"flex-1 flex items-center justify-center gap-2 bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition-colors",children:[(0,ga.jsx)(xn,{className:"w-5 h-5"}),"Reject Lead"]})]})]})]})})]})}function Cs(e){let{modalOpen:t}=e;const[r,a]=(0,s.useState)(!0),[n,i]=(0,s.useState)(""),[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(null),[f,m]=(0,s.useState)({pending:0,quickReview:0});(0,s.useEffect)(()=>{const e=setTimeout(()=>{a(!1)},1500);return()=>clearTimeout(e)},[]);return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-orange-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% { opacity: 0; transform: translateX(-100px); }\n          100% { opacity: 1; transform: translateX(0); }\n        }\n        @keyframes fadeInUp {\n          0% { opacity: 0; transform: translateY(30px); }\n          100% { opacity: 1; transform: translateY(0); }\n        }\n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,ga.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,ga.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(os,{className:"w-6 h-6 text-orange-600"}),(0,ga.jsxs)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:["Social Leads ",l&&(0,ga.jsx)("span",{className:"text-lg text-orange-600",children:"(Review Mode)"})]})]})}),(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,ga.jsxs)("button",{onClick:()=>{o(!l),d([])},className:"flex items-center gap-2 px-3 py-2 border rounded-lg text-sm font-medium transition-all duration-200 shadow-sm group ".concat(l?"bg-orange-100 border-orange-300 text-orange-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"),title:"Toggle review mode",children:[(0,ga.jsx)(gs,{className:"w-4 h-4"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:l?"Exit Review":"Review Mode"})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Provide feedback",children:[(0,ga.jsx)(xs,{className:"w-4 h-4 text-pink-500 group-hover:text-pink-600"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Messages",children:(0,ga.jsx)(bs,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,ga.jsx)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm",children:(0,ga.jsx)("span",{className:"text-sm font-semibold",children:"K"})}),(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-l-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Invite team members",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-orange-500 group-hover:text-orange-600"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Invite"}),(0,ga.jsx)("span",{className:"bg-orange-100 text-orange-700 px-1.5 py-0.5 rounded text-xs font-medium",children:"1"})]}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 border-l-0 rounded-r-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share leads",children:(0,ga.jsx)(ys,{className:"w-4 h-4 text-slate-600 group-hover:text-slate-800"})})]})]})]}),(0,ga.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:l?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsxs)("button",{onClick:async()=>{if(0!==c.length){if(window.confirm("Approve ".concat(c.length," selected lead(s)?")))try{await fs(c),alert("".concat(c.length," lead(s) approved successfully!")),d([])}catch(e){alert("Failed to approve leads. Please try again.")}}else alert("Please select leads to approve")},disabled:0===c.length,className:"flex items-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Approve selected leads",children:[(0,ga.jsx)(sn,{className:"w-5 h-5"}),(0,ga.jsxs)("span",{children:["Approve (",c.length,")"]})]}),(0,ga.jsxs)("button",{onClick:async()=>{if(0!==c.length){if(window.confirm("Reject ".concat(c.length," selected lead(s)?")))try{await ms(c),alert("".concat(c.length," lead(s) rejected successfully!")),d([])}catch(e){alert("Failed to reject leads. Please try again.")}}else alert("Please select leads to reject")},disabled:0===c.length,className:"flex items-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Reject selected leads",children:[(0,ga.jsx)(xn,{className:"w-5 h-5"}),(0,ga.jsxs)("span",{children:["Reject (",c.length,")"]})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 bg-blue-50 px-3 py-2 rounded-lg",children:[(0,ga.jsx)(vn,{className:"w-4 h-4 text-blue-600"}),(0,ga.jsx)("span",{children:"Select leads to review and approve/reject"})]})]}),(0,ga.jsx)("div",{className:"flex-1 flex items-center justify-end",children:(0,ga.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search leads to review...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[t&&(0,ga.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-orange-600 text-white rounded-lg text-sm font-medium hover:bg-orange-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Add new lead",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Add Lead"})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 shadow-sm ".concat("quick-review"===u?"bg-blue-600 text-white":"bg-white border border-slate-300 text-slate-700 hover:bg-slate-50"),title:"Quick review pending leads",onClick:()=>h("quick-review"===u?null:"quick-review"),children:[(0,ga.jsx)(fn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Quick Review"}),f.quickReview>0&&(0,ga.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium ".concat("quick-review"===u?"bg-blue-500 text-white":"bg-blue-100 text-blue-800"),children:f.quickReview})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 ".concat("pending"===u?"bg-amber-600 text-white":"bg-amber-100 text-amber-800 border border-amber-300 hover:bg-amber-200"),title:"View pending approvals",onClick:()=>h("pending"===u?null:"pending"),children:[(0,ga.jsx)(nn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Pending"}),f.pending>0&&(0,ga.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium ".concat("pending"===u?"bg-amber-500 text-white":"bg-amber-200 text-amber-900"),children:f.pending})]}),u&&(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-red-100 text-red-800 border border-red-300 rounded-lg text-sm font-medium hover:bg-red-200 transition-all duration-200",title:"Clear filter",onClick:()=>h(null),children:[(0,ga.jsx)(Ea,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Clear Filter"})]})]}),(0,ga.jsx)("div",{className:"flex-1 flex items-center justify-end",children:(0,ga.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search leads...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]})}),l&&(0,ga.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:(0,ga.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-6",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Approved: 15"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-3 h-3 bg-amber-500 rounded-full"}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Pending: 7"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Rejected: 3"})]})]}),(0,ga.jsxs)("div",{className:"text-sm text-slate-600",children:["Total Selected: ",(0,ga.jsx)("span",{className:"font-medium text-orange-600",children:c.length})]})]})}),(0,ga.jsx)("div",{className:"space-y-6",children:(0,ga.jsx)(As,{onOpen:t,loading:r,delay:300,reviewMode:l,selectedLeads:c,setSelectedLeads:d,filterStatus:u,setFilterStatus:h,setLeadCounts:m})}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:()=>{a(!0),setTimeout(()=>a(!1),1500)},className:"bg-orange-600 hover:bg-orange-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Leads",children:(0,ga.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(r?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ga.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,ga.jsx)("div",{className:"h-8"})]})]})}function _s(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),n=()=>{t(!1)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(Cs,{modalOpen:()=>{t(!0)}})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:n}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(ps,{onClose:n})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Ts=Ta("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Es=Ta("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Ls=Ta("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Ps=Ta("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Os=async()=>(await fa.get("".concat(ma,"/Account/account"))).data,Fs=async e=>(await fa.post("".concat(ma,"/Account/account-address"),{accountName:e})).data,Ds=async e=>(await fa.post("".concat(ma,"/Account/account"),e)).data,Is=async e=>(await fa.put("".concat(ma,"/Account/account"),e)).data,Rs=async()=>(await fa.get("".concat(ma,"/Account/account-names"))).data,Ms=["sysID"];function Bs(e){let{onClose:t,account:r=null,onSuccess:a,loadAccounts:n,setOpenContactModal:i,contacts:l=[]}=e;const[o,c]=(0,s.useState)({sysID:"",accountName:"",accountType:"",domain:"",fmsCode:"",industry:"",tp:"",location:"",salesPerson:"",description:""}),[d,u]=(0,s.useState)({}),[h,f]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[b,v]=(0,s.useState)([]),[y,w]=(0,s.useState)(!1),[N,j]=(0,s.useState)([]),k=(0,s.useRef)(null),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{A()},[]);const A=async()=>{try{const e=(await Ss()).filter(e=>"Active"===e.status);v(e)}catch(e){console.error("Error fetching employees:",e)}};(0,s.useEffect)(()=>{const e=e=>{S.current&&!S.current.contains(e.target)&&k.current&&!k.current.contains(e.target)&&w(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{r&&r.sysID&&(c({sysID:r.sysID||"",accountName:r.accountName||"",accountType:r.accountType||"",domain:r.domain||"",fmsCode:r.fmsCode||"",industry:r.industry||"",tp:r.tp||"",location:r.location||"",salesPerson:r.salesPerson||"",description:r.description||""}),x(!0),console.log(r))},[r]);const C=e=>{const{name:t,value:r}=e.target;if(c(e=>We(We({},e),{},{[t]:r})),d[t]&&u(e=>We(We({},e),{},{[t]:""})),m&&p(null),"salesPerson"===t)if(r.trim()){const e=b.filter(e=>{const t="".concat(e.fname," ").concat(e.lname).toLowerCase(),a=r.toLowerCase();return t.includes(a)||e.email.toLowerCase().includes(a)||e.position.toLowerCase().includes(a)});j(e),w(!0)}else j([]),w(!1)},_=(()=>{try{if(r&&r.contactsJson){const e=JSON.parse(r.contactsJson);return Array.isArray(e)?e:[]}}catch(mT){console.error("Error parsing contactsJson:",mT)}return[]})(),T=l.length>0?l:_;return(0,ga.jsxs)("div",{className:"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(ds,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:g?"Edit Account":"Add New Account"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:g?"Update account information and business details":"Create a new account to manage business relationships"})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),m&&(0,ga.jsxs)("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,ga.jsx)("span",{className:"text-red-500 text-lg",children:"\u26a0\ufe0f"}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("h3",{className:"text-sm font-semibold text-red-800",children:"Submission Error"}),(0,ga.jsx)("p",{className:"text-sm text-red-700 mt-1",children:m})]})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"bg-blue-50 rounded-xl p-5 border border-blue-200",children:[(0,ga.jsxs)("h2",{className:"text-base font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(ds,{className:"w-4 h-4 text-blue-600"}),"Company Information"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{className:"lg:col-span-2",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(ds,{className:"w-4 h-4 text-blue-600"}),"Account Name ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"accountName",value:o.accountName,onChange:C,className:"w-full px-4 py-3 border ".concat(d.accountName?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all"),placeholder:"Enter company or account name"}),d.accountName&&(0,ga.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.accountName})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ts,{className:"w-4 h-4 text-purple-600"}),"Account Type"]}),(0,ga.jsxs)("select",{name:"accountType",value:o.accountType,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",children:[(0,ga.jsx)("option",{value:"",children:"Select account type"}),(0,ga.jsx)("option",{value:"import",children:"Import"}),(0,ga.jsx)("option",{value:"export",children:"Export"}),(0,ga.jsx)("option",{value:"both",children:"Both Import & Export"})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Es,{className:"w-4 h-4 text-green-600"}),"Domain / Website"]}),(0,ga.jsx)("input",{type:"url",name:"domain",value:o.domain,onChange:C,className:"w-full px-4 py-3 border ".concat(d.domain?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all"),placeholder:"https://www.example.com"}),d.domain&&(0,ga.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.domain})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ls,{className:"w-4 h-4 text-indigo-600"}),"FMS Code"]}),(0,ga.jsx)("input",{type:"text",name:"fmsCode",value:o.fmsCode,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"Enter FMS code"}),d.fmsCode&&(0,ga.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.fmsCode})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(cs,{className:"w-4 h-4 text-yellow-600"}),"Industry"]}),(0,ga.jsxs)("select",{name:"industry",value:o.industry,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",children:[(0,ga.jsx)("option",{value:"",children:"Select industry"}),[{value:"technology",label:"Technology"},{value:"software",label:"Software & SaaS"},{value:"data-analytics",label:"Data & Analytics"},{value:"healthcare",label:"Healthcare"},{value:"finance",label:"Finance & Banking"},{value:"manufacturing",label:"Manufacturing"},{value:"retail",label:"Retail & E-commerce"},{value:"education",label:"Education"},{value:"real-estate",label:"Real Estate"},{value:"consulting",label:"Consulting"},{value:"media",label:"Media & Entertainment"},{value:"automotive",label:"Automotive"},{value:"energy",label:"Energy & Utilities"},{value:"telecommunications",label:"Telecommunications"},{value:"agriculture",label:"Agriculture"},{value:"construction",label:"Construction"},{value:"logistics",label:"Logistics & Transportation"},{value:"government",label:"Government"},{value:"nonprofit",label:"Non-profit"},{value:"other",label:"Other"}].map(e=>(0,ga.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(us,{className:"w-4 h-4 text-teal-600"}),"Company Phone"]}),(0,ga.jsx)("input",{type:"tel",name:"tp",value:o.tp,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"+1 (555) 000-0000"})]}),(0,ga.jsxs)("div",{className:"lg:col-span-1",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-red-600"}),"Location"]}),(0,ga.jsx)("input",{type:"text",name:"location",value:o.location,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"City, State/Province, Country"})]}),(0,ga.jsxs)("div",{className:"lg:col-span-1 relative",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ps,{className:"w-4 h-4 text-orange-600"}),"Sales Person"]}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("input",{ref:k,type:"text",name:"salesPerson",value:o.salesPerson,onChange:C,onFocus:()=>{o.salesPerson.trim()&&N.length>0&&w(!0)},className:"w-full px-4 py-3 pr-10 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"Type to search employee...",autoComplete:"off"}),(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2"})]}),y&&N.length>0&&(0,ga.jsx)("div",{ref:S,className:"absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:N.map(e=>(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{const t="".concat(e.fname," ").concat(e.lname);c(e=>We(We({},e),{},{salesPerson:t})),w(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-purple-50 transition-colors border-b border-slate-100 last:border-b-0",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,ga.jsx)(Oa,{className:"w-4 h-4 text-purple-600"})}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("p",{className:"text-sm font-medium text-slate-900",children:[e.fname," ",e.lname]}),(0,ga.jsxs)("p",{className:"text-xs text-slate-500",children:[e.position," \u2022 ",e.department]})]})]})},e.sysID))})]})]})]}),(0,ga.jsxs)("div",{className:"bg-orange-50 rounded-xl p-5 border border-orange-200",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ga.jsxs)("h2",{className:"text-base font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-orange-600"}),"Contact Information"]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>{i&&i(!0)},className:"px-4 py-2 text-orange-700 bg-white border-2 border-orange-300 hover:bg-orange-50 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 text-sm",disabled:h,children:[(0,ga.jsx)(vs,{className:"w-4 h-4"}),T.length>0?"Edit Contacts":"Add Contacts"]})]}),T.length>0?(0,ga.jsx)("div",{className:"space-y-3",children:T.map((e,t)=>(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:(0,ga.jsx)("div",{className:"flex items-start justify-between",children:(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-orange-600"}),(0,ga.jsx)("span",{className:"font-semibold text-slate-800",children:e.contactName||"Unnamed Contact"}),0===t&&(0,ga.jsx)("span",{className:"text-xs px-2 py-1 bg-orange-100 text-orange-700 rounded-full",children:"Primary"})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-slate-600",children:[e.email&&(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(qa,{className:"w-3 h-3 text-orange-500"}),(0,ga.jsx)("span",{children:e.email})]}),e.position&&(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(cs,{className:"w-3 h-3 text-orange-500"}),(0,ga.jsx)("span",{children:e.position})]}),e.mobile&&(0,ga.jsxs)("div",{className:"flex items-center gap-2 md:col-span-2",children:[(0,ga.jsx)(us,{className:"w-3 h-3 text-orange-500"}),(0,ga.jsx)("span",{children:e.mobile})]})]})]})})},t))}):(0,ga.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,ga.jsx)(vs,{className:"w-12 h-12 mx-auto mb-3 text-slate-300"}),(0,ga.jsx)("p",{className:"text-sm",children:"No contacts added yet"}),(0,ga.jsx)("p",{className:"text-xs mt-1",children:'Click "Add Contacts" to add contact information'})]})]}),(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[(0,ga.jsxs)("h2",{className:"text-base font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-gray-600"}),"Additional Details"]}),(0,ga.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-gray-600"}),"Company Description"]}),(0,ga.jsx)("textarea",{name:"description",value:o.description,onChange:C,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all resize-none",placeholder:"Enter company description, business overview, services, or important notes about this account..."})]})})]})]})}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:h,children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),(()=>{const e={};return o.accountName.trim()||(e.accountName="Account name is required"),o.fmsCode.trim()||(e.fmsCode="FMS code is required"),o.domain&&!o.domain.match(/^https?:\/\/.+/)&&(e.domain="Please enter a valid URL (starting with http:// or https://)"),u(e),0===Object.keys(e).length})()){f(!0),p(null);try{const e=l.length>0?l[0]:{},r=We(We({},o),{},{primaryContact:e.contactName||"",primaryEmail:e.email||"",primaryPosition:e.position||"",primaryMobile:e.mobile||"",contactsJson:JSON.stringify(l)});let s;if(g)s=await Is(r);else{const{sysID:e}=r,t=Na(r,Ms);console.log("this is gonee ",t),s=await Ds(t)}n&&n(),console.log("Account saved successfully:",s),a&&a(s),t()}catch(i){var r,s;console.error("Error submitting form:",i);const e=(null===(r=i.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||i.message||"Failed to ".concat(g?"update":"create"," account. Please try again.");p(e)}finally{f(!1)}}},disabled:h,className:"px-6 py-3 text-white bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:h?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),g?"Updating...":"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(ds,{className:"w-4 h-4"}),g?"Update Account":"Save Account"]})})]})]})}const Us=Ta("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),zs=Ta("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),qs=Ta("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);function Hs(e){let{onOpen:t,onEdit:r,setSelectedAccount:a,accounts:n,error:i,loading:l,loadAccounts:o}=e;const[c,d]=(0,s.useState)(new Set),u=e=>{try{if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(mT){return console.error("Error parsing contacts:",mT),[]}},h=()=>(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded w-24"}),(0,ga.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("div",{className:"min-w-full",children:[(0,ga.jsx)("div",{className:"grid grid-cols-11 gap-4 p-4 bg-slate-50 border-b border-slate-200",children:Array.from({length:11}).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))}),Array.from({length:3}).map((e,t)=>(0,ga.jsx)("div",{className:"grid grid-cols-11 gap-4 p-4 border-b border-slate-100",children:Array.from({length:11}).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))},t))]})})]}),f=e=>{let{industry:t}=e;return t?(0,ga.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:[(0,ga.jsx)(Ya,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate max-w-32",children:t})]}):null},m=e=>{let{domain:t}=e;return t?(0,ga.jsxs)("a",{href:t.startsWith("http")?t:"https://".concat(t),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-purple-600 hover:text-purple-800 transition-colors group",children:[(0,ga.jsx)(Es,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"text-sm truncate max-w-32",children:t.replace(/^https?:\/\//,"")}),(0,ga.jsx)(Us,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]}):(0,ga.jsx)("span",{className:"text-sm text-slate-400",children:"-"})},p=e=>{let{contact:t,isPrimary:r=!1}=e;return(0,ga.jsxs)("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200",children:[(0,ga.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-orange-600"}),(0,ga.jsx)("span",{className:"font-medium text-slate-800",children:t.contactName||"Unnamed"}),r&&(0,ga.jsx)("span",{className:"text-xs px-2 py-0.5 bg-orange-600 text-white rounded-full",children:"Primary"})]})}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[t.email&&(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-slate-600",children:[(0,ga.jsx)(qa,{className:"w-3 h-3 text-orange-500"}),(0,ga.jsx)("span",{className:"truncate",children:t.email})]}),t.position&&(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-slate-600",children:[(0,ga.jsx)(cs,{className:"w-3 h-3 text-orange-500"}),(0,ga.jsx)("span",{className:"truncate",children:t.position})]}),t.mobile&&(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-slate-600 md:col-span-2",children:[(0,ga.jsx)(us,{className:"w-3 h-3 text-orange-500"}),(0,ga.jsx)("span",{children:t.mobile})]})]})]})},g=e=>{let{account:t}=e;const r=u(t.contactsJson);return(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"10",className:"px-4 py-4 bg-slate-50",children:(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-orange-600"}),"Contact Information (",r.length," ",1===r.length?"contact":"contacts",")"]}),r.length>0?(0,ga.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:r.map((e,t)=>(0,ga.jsx)(p,{contact:e,isPrimary:0===t},t))}):(0,ga.jsxs)("div",{className:"text-center py-6 text-slate-500",children:[(0,ga.jsx)(vs,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),(0,ga.jsx)("p",{className:"text-sm",children:"No contacts added"})]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-slate-200",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Account Type"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.accountType||"-"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"FMS Code"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.fmsCode||"-"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Company Phone"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.tp||"-"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Sales Person"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.salesPerson||"-"})]}),(0,ga.jsxs)("div",{className:"md:col-span-2",children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Description"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.description||"-"})]})]})]})})})},x=e=>{let{account:r}=e;const n=c.has(r.sysID);u(r.contactsJson);return(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("button",{onClick:()=>{return e=r.sysID,void d(t=>{const r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r});var e},className:"p-2 text-slate-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-all duration-200",title:n?"Collapse details":"Expand details",children:n?(0,ga.jsx)(un,{className:"w-4 h-4"}):(0,ga.jsx)(zs,{className:"w-4 h-4"})}),(0,ga.jsx)("button",{onClick:()=>(e=>{a(e),t()})(r),className:"p-2 text-slate-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-all duration-200",title:"Edit account",children:(0,ga.jsx)(Kn,{className:"w-4 h-4"})})]})};return l?(0,ga.jsx)(h,{}):i?(0,ga.jsx)("div",{className:"bg-white rounded-xl border border-red-200 shadow-sm p-8",children:(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,ga.jsx)(qs,{className:"w-6 h-6 text-red-600"})}),(0,ga.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Failed to load accounts"}),(0,ga.jsx)("p",{className:"text-slate-500 mb-4",children:i}),(0,ga.jsx)("button",{onClick:o,className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:"Try Again"})]})}):(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300",children:[(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("div",{className:"min-w-full",children:[(0,ga.jsx)("div",{className:"hidden xl:block",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-4 py-3 text-left",children:(0,ga.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600 border-slate-300 rounded focus:ring-purple-500 focus:ring-2"})}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Account"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Domain"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Industry"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Primary Contact"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Email"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Location"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Type"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Contacts"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-100",children:n.map(e=>{const t=c.has(e.sysID),r=u(e.contactsJson);return(0,ga.jsxs)(s.Fragment,{children:[(0,ga.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group ".concat(t?"bg-slate-50":""),children:[(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600 border-slate-300 rounded focus:ring-purple-500 focus:ring-2"})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(ds,{className:"w-4 h-4 text-purple-600"}),(0,ga.jsx)("span",{className:"font-medium text-slate-900",children:e.accountName||"-"})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(m,{domain:e.domain})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(f,{industry:e.industry})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(Oa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate max-w-32",children:e.primaryContact||"-"})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:e.primaryEmail?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(qa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate max-w-32",children:e.primaryEmail})]}):(0,ga.jsx)("span",{className:"text-sm text-slate-400",children:"-"})}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(Tn,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate max-w-32",children:e.location||"-"})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:e.accountType&&(0,ga.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700",children:e.accountType})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(vs,{className:"w-3 h-3 text-orange-600"}),(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-700",children:r.length})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(x,{account:e})})]}),t&&(0,ga.jsx)(g,{account:e})]},e.sysID)})})]})}),(0,ga.jsx)("div",{className:"xl:hidden p-4 space-y-4",children:n.map(e=>{const t=c.has(e.sysID),r=u(e.contactsJson);return(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 space-y-4",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,ga.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600 border-slate-300 rounded focus:ring-purple-500 focus:ring-2"}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ga.jsx)(ds,{className:"w-4 h-4 text-purple-600"}),(0,ga.jsx)("h3",{className:"font-medium text-slate-900",children:e.accountName})]}),(0,ga.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,ga.jsx)(m,{domain:e.domain})}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ga.jsx)(f,{industry:e.industry}),e.accountType&&(0,ga.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700",children:e.accountType})]})]})]}),(0,ga.jsx)(x,{account:e})]}),(0,ga.jsx)("div",{className:"space-y-2",children:(0,ga.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm text-slate-600",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4"}),(0,ga.jsxs)("span",{children:["Primary: ",e.primaryContact||"-"]})]}),e.primaryEmail&&(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(qa,{className:"w-4 h-4"}),(0,ga.jsx)("span",{className:"truncate",children:e.primaryEmail})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4"}),(0,ga.jsxs)("span",{children:["Location: ",e.location||"-"]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-orange-600"}),(0,ga.jsxs)("span",{children:["Contacts: ",r.length]})]})]})}),t&&(0,ga.jsxs)("div",{className:"pt-4 border-t border-slate-200 space-y-3",children:[(0,ga.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 flex items-center gap-2",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-orange-600"}),"All Contacts (",r.length,")"]}),r.length>0?(0,ga.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,ga.jsx)(p,{contact:e,isPrimary:0===t},t))}):(0,ga.jsxs)("div",{className:"text-center py-4 text-slate-500",children:[(0,ga.jsx)(vs,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),(0,ga.jsx)("p",{className:"text-sm",children:"No contacts added"})]}),(0,ga.jsxs)("div",{className:"pt-3 border-t border-slate-200 space-y-2",children:[e.fmsCode&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"FMS Code"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800",children:e.fmsCode})]}),e.tp&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"Company Phone"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800",children:e.tp})]}),e.salesPerson&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"Sales Person"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800",children:e.salesPerson})]}),e.description&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"Description"}),(0,ga.jsx)("p",{className:"text-sm text-slate-800",children:e.description})]})]})]})]},e.sysID)})})]})}),0===n.length&&!l&&(0,ga.jsxs)("div",{className:"text-center py-12",children:[(0,ga.jsx)(ds,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),(0,ga.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No accounts yet"}),(0,ga.jsx)("p",{className:"text-slate-500 mb-4",children:"Get started by adding your first account"}),t&&(0,ga.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Account"]})]})]})}function Ws(e){let{modalOpen:t,setSelectedAccount:r,error:a,accounts:n,loadAccounts:i}=e;const[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)("");(0,s.useEffect)(()=>{const e=setTimeout(()=>{o(!1)},1500);return()=>clearTimeout(e)},[]);const u=(0,s.useMemo)(()=>{if(!c.trim())return n;const e=c.toLowerCase();return n.filter(t=>{var r;return[t.accountName,t.domain,t.industry,t.description,t.headquartersLocation,null===(r=t.numberOfEmployees)||void 0===r?void 0:r.toString()].some(t=>null===t||void 0===t?void 0:t.toLowerCase().includes(e))})},[n,c]);return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-purple-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,ga.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,ga.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(l?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(ds,{className:"w-6 h-6 text-purple-600"}),(0,ga.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Accounts"}),c&&(0,ga.jsxs)("span",{className:"text-sm text-slate-500 font-normal",children:["(",u.length," of ",n.length,")"]})]})}),(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Provide feedback",children:[(0,ga.jsx)(xs,{className:"w-4 h-4 text-pink-500 group-hover:text-pink-600"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Messages",children:(0,ga.jsx)(bs,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,ga.jsx)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm",children:(0,ga.jsx)("span",{className:"text-sm font-semibold",children:"K"})}),(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-l-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Invite team members",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-purple-500 group-hover:text-purple-600"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Invite"}),(0,ga.jsx)("span",{className:"bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded text-xs font-medium",children:"1"})]}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 border-l-0 rounded-r-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share account",children:(0,ga.jsx)(ys,{className:"w-4 h-4 text-slate-600 group-hover:text-slate-800"})})]})]})]}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(l?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,ga.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Create a new account",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),(0,ga.jsx)("span",{children:"New Account"})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",title:"Filter accounts",children:[(0,ga.jsx)(Ja,{className:"w-4 h-4 text-slate-600"}),(0,ga.jsx)("span",{children:"Filter"}),(0,ga.jsx)(un,{className:"w-4 h-4 text-slate-400"})]})]}),(0,ga.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search accounts...",value:c,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 text-sm"}),c&&(0,ga.jsx)("button",{onClick:()=>d(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600",title:"Clear search",children:"\u2715"})]})})]}),(0,ga.jsx)("div",{className:"space-y-6",children:c&&0===u.length?(0,ga.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border border-slate-200",children:[(0,ga.jsx)(hn,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,ga.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No accounts found"}),(0,ga.jsx)("p",{className:"text-slate-500",children:"Try adjusting your search query"})]}):(0,ga.jsx)(Hs,{onOpen:t,loading:l,delay:300,setSelectedAccount:r,error:a,accounts:u,loadAccounts:i})}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:()=>{o(!0),i(),setTimeout(()=>o(!1),1500)},className:"bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Accounts",children:(0,ga.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(l?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ga.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,ga.jsx)("div",{className:"h-8"})]})]})}function Vs(e){let{onClose:t,account:r=null,setSecContacts:a,existingContacts:n=[]}=e;const[i,l]=(0,s.useState)([{id:Date.now(),contactName:"",email:"",position:"",mobile:""}]),[o,c]=(0,s.useState)({}),[d,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{n&&n.length>0&&l(n.map((e,t)=>({id:Date.now()+t,contactName:e.contactName||"",email:e.email||"",position:e.position||"",mobile:e.mobile||""})))},[n]);const m=(e,t,r)=>{l(a=>a.map(a=>a.id===e?We(We({},a),{},{[t]:r}):a));const a="".concat(e,"_").concat(t);o[a]&&c(e=>We(We({},e),{},{[a]:""})),h&&f(null)};return(0,ga.jsxs)("div",{className:"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-orange-50 to-amber-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(vs,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:n.length>0?"Edit Contacts":"Add New Contacts"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:n.length>0?"Update contact information details":"Add multiple contacts for this account"})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),h&&(0,ga.jsxs)("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,ga.jsx)("span",{className:"text-red-500 text-lg",children:"\u26a0\ufe0f"}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsx)("h3",{className:"text-sm font-semibold text-red-800",children:"Submission Error"}),(0,ga.jsx)("p",{className:"text-sm text-red-700 mt-1",children:h})]})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Add multiple contacts for this account. First contact is primary."}),(0,ga.jsxs)("button",{type:"button",onClick:()=>{const e={id:Date.now(),contactName:"",email:"",position:"",mobile:""};l([...i,e])},className:"px-4 py-2 text-orange-700 bg-white border-2 border-orange-300 hover:bg-orange-50 rounded-lg transition-all duration-200 font-medium flex items-center gap-2",disabled:d,children:[(0,ga.jsx)(vs,{className:"w-4 h-4"}),"Add Contact"]})]}),i.map((e,t)=>(0,ga.jsxs)("div",{className:"bg-orange-50 rounded-xl p-5 border-2 border-orange-200 relative",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ga.jsxs)("h3",{className:"text-base font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-orange-600"}),"Contact ",t+1," ",0===t&&(0,ga.jsx)("span",{className:"text-xs font-normal text-orange-600",children:"(Primary)"})]}),i.length>1&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{if(i.length>1){l(i.filter(t=>t.id!==e));const t=We({},o);Object.keys(t).forEach(r=>{r.startsWith("".concat(e,"_"))&&delete t[r]}),c(t)}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200",title:"Remove contact",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{className:"lg:col-span-2",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-orange-600"}),"Contact Name ",0===t&&(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",value:e.contactName,onChange:t=>m(e.id,"contactName",t.target.value),className:"w-full px-4 py-3 border ".concat(o["".concat(e.id,"_contactName")]?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white"),placeholder:"Enter contact person name"}),o["".concat(e.id,"_contactName")]&&(0,ga.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o["".concat(e.id,"_contactName")]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(qa,{className:"w-4 h-4 text-orange-600"}),"Email"]}),(0,ga.jsx)("input",{type:"email",value:e.email,onChange:t=>m(e.id,"email",t.target.value),className:"w-full px-4 py-3 border ".concat(o["".concat(e.id,"_email")]?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white"),placeholder:"contact@company.com"}),o["".concat(e.id,"_email")]&&(0,ga.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o["".concat(e.id,"_email")]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(cs,{className:"w-4 h-4 text-orange-600"}),"Position"]}),(0,ga.jsx)("input",{type:"text",value:e.position,onChange:t=>m(e.id,"position",t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",placeholder:"Job title or position"})]}),(0,ga.jsxs)("div",{className:"lg:col-span-2",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(us,{className:"w-4 h-4 text-orange-600"}),"Mobile Number"]}),(0,ga.jsx)("input",{type:"tel",value:e.mobile,onChange:t=>m(e.id,"mobile",t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",placeholder:"+1 (555) 000-0000"})]})]})]},e.id)),(0,ga.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[(0,ga.jsx)("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,ga.jsx)("span",{className:"text-white text-xs font-bold",children:"i"})}),(0,ga.jsx)("div",{className:"flex-1",children:(0,ga.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,ga.jsx)("strong",{children:"Tip:"}),' You can add multiple contacts for this account. The first contact will be set as the primary contact. Click "Add Contact" to add more contacts.']})})]})]})}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:d,children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),(()=>{const e={};return i.forEach((t,r)=>{0!==r||t.contactName.trim()||(e["".concat(t.id,"_contactName")]="At least one contact name is required"),t.email&&!t.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)&&(e["".concat(t.id,"_email")]="Please enter a valid email address"),!t.contactName.trim()&&(t.email||t.position||t.mobile)&&(e["".concat(t.id,"_contactName")]="Contact name is required when other fields are filled")}),c(e),0===Object.keys(e).length})()){u(!0),f(null);try{const e=i.filter(e=>e.contactName.trim()||e.email.trim()||e.position.trim()||e.mobile.trim()).map(e=>({contactName:e.contactName||"",email:e.email||"",position:e.position||"",mobile:e.mobile||""}));a(e),console.log("Contacts to save:",e),t()}catch(s){var r,n;console.error("Error submitting form:",s);const e=(null===(r=s.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||s.message||"Failed to save contacts. Please try again.";f(e)}finally{u(!1)}}},disabled:d,className:"px-6 py-3 text-white bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:d?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(vs,{className:"w-4 h-4"}),"Save Contacts"]})})]})]})}function Gs(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(!0),[f,m]=(0,s.useState)(null),[p,g]=(0,s.useState)([]),x=()=>{t(!1),g([])};(0,s.useEffect)(()=>{b()},[]);const b=async()=>{try{h(!0),m(null);const e=await Os();d(e)}catch(e){console.error("Error fetching accounts:",e),m(e.message||"Failed to load accounts")}finally{h(!1)}},v=()=>{a(!1)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{i(!n)},isMobileMenuOpen:n}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:n,onClose:()=>{i(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(Ws,{modalOpen:()=>{t(!0)},setSelectedAccount:o,loading:u,error:f,accounts:c,loadAccounts:b})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:x}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Bs,{onClose:x,account:l,loadAccounts:b,setOpenContactModal:a,contacts:p})})})]}),r&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:v}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Vs,{onClose:v,setSecContacts:g,existingContacts:(()=>{try{if(l&&l.contactsJson){const e=JSON.parse(l.contactsJson);return Array.isArray(e)?e:[]}}catch(mT){console.error("Error parsing contactsJson:",mT)}return[]})()})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Ks=Ta("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Ys=Ta("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Xs=Ta("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var $s={version:"0.18.5"},Js=1200,Qs=1252,Zs=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ei={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ti=function(e){-1!=Zs.indexOf(e)&&(Qs=ei[0]=e)};var ri=function(e){Js=e,ti(e)};function ai(){ri(1200),ti(1252)}function ni(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function si(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ii,li=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?si(e.slice(2)):65279==t?e.slice(1):e},oi=function(e){return String.fromCharCode(e)},ci=function(e){return String.fromCharCode(e)};var di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ui(e){for(var t="",r=0,a=0,n=0,s=0,i=0,l=0,o=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(a=e.charCodeAt(c++))>>4,l=(15&a)<<2|(n=e.charCodeAt(c++))>>6,o=63&n,isNaN(a)?l=o=64:isNaN(n)&&(o=64),t+=di.charAt(s)+di.charAt(i)+di.charAt(l)+di.charAt(o);return t}function hi(e){var t="",r=0,a=0,n=0,s=0,i=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<e.length;)r=di.indexOf(e.charAt(o++))<<2|(s=di.indexOf(e.charAt(o++)))>>4,t+=String.fromCharCode(r),a=(15&s)<<4|(i=di.indexOf(e.charAt(o++)))>>2,64!==i&&(t+=String.fromCharCode(a)),n=(3&i)<<6|(l=di.indexOf(e.charAt(o++))),64!==l&&(t+=String.fromCharCode(n));return t}var fi=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),mi=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(mT){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function pi(e){return fi?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function gi(e){return fi?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var xi=function(e){return fi?mi(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function bi(e){if("undefined"===typeof ArrayBuffer)return xi(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function vi(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function yi(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return yi(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var wi=fi?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:mi(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var Ni=/\u0000/g,ji=/[\u0001-\u0006]/g;function ki(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Si(e,t){var r=""+e;return r.length>=t?r:Bl("0",t-r.length)+r}function Ai(e,t){var r=""+e;return r.length>=t?r:Bl(" ",t-r.length)+r}function Ci(e,t){var r=""+e;return r.length>=t?r:r+Bl(" ",t-r.length)}var _i=Math.pow(2,32);function Ti(e,t){return e>_i||e<-_i?function(e,t){var r=""+Math.round(e);return r.length>=t?r:Bl("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:Bl("0",t-r.length)+r}(Math.round(e),t)}function Ei(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Li=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pi=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Oi={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Fi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Di={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ii(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,l=0,o=1,c=0,d=0,u=Math.floor(n);c<t&&(l=(u=Math.floor(n))*i+s,d=u*c+o,!(n-u<5e-8));)n=1/(n-u),s=i,i=l,o=c,c=d;if(d>t&&(c>t?(d=o,l=s):(d=c,l=i)),!r)return[0,a*l,d];var h=Math.floor(a*l/d);return[h,a*l-h*d,d]}function Ri(e,t,r){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),s=0,i=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,86400==++n&&(l.T=n=0,++a,++l.D)),60===a)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===a)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),a<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(o,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=s,l}var Mi=new Date(1899,11,31,0,0,0),Bi=Mi.getTime(),Ui=new Date(1900,2,1,0,0,0);function zi(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Ui&&(r+=864e5),(r-(Bi+6e4*(e.getTimezoneOffset()-Mi.getTimezoneOffset())))/864e5}function qi(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hi(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=qi(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=qi(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),qi(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Wi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Hi(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return ul(14,zi(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Vi(e,t,r,a){var n,s="",i=0,l=0,o=r.y,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:n=o%100,c=2;break;default:n=o%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:n=r.m,c=t.length;break;case 3:return Pi[r.m-1][1];case 5:return Pi[r.m-1][0];default:return Pi[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=r.d,c=t.length;break;case 3:return Li[r.q][0];default:return Li[r.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(l=a>=2?3===a?1e3:100:1===a?10:1,(i=Math.round(l*(r.S+r.u)))>=60*l&&(i=0),"s"===t?0===i?"0":""+i/l:(s=Si(i,2+a),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Si(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":n=24*r.D+r.H;break;case"[m]":case"[mm]":n=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":n=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:n=o,c=1}return c>0?Si(n,c):""}function Gi(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var Ki=/%/g;function Yi(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Yi(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),-1===(r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(n+s)%n)+"."+a.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Xi=/# (\?+)( ?)\/( ?)(\d+)/;var $i=/^#*0*\.([0#]+)/,Ji=/\).*[0#]/,Qi=/\(###\) ###\\?-####/;function Zi(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function el(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function tl(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function rl(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ji)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rl("n",a,r):"("+rl("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return sl(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var a=t.replace(Ki,""),n=t.length-a.length;return sl(e,a,r*Math.pow(10,2*n))+Bl("%",n)}(e,t,r);if(-1!==t.indexOf("E"))return Yi(t,r);if(36===t.charCodeAt(0))return"$"+rl(e,t.substr(" "==t.charAt(1)?2:1),r);var n,s,i,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ti(o,t.length);if(t.match(/^[#?]+$/))return"0"===(n=Ti(r,0))&&(n=""),n.length>t.length?n:Zi(t.substr(0,t.length-n.length))+n;if(s=t.match(Xi))return function(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),i=n-s*a,l=a;return r+(0===s?"":""+s)+" "+(0===i?Bl(" ",e[1].length+1+e[4].length):Ai(i,e[1].length)+e[2]+"/"+e[3]+Si(l,e[4].length))}(s,o,c);if(t.match(/^#+0+$/))return c+Ti(o,t.length-t.indexOf("0"));if(s=t.match($i))return n=el(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Zi(s[1])).replace(/\.$/,"."+Zi(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Bl("0",Zi(s[1]).length-t.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+el(o,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Gi(Ti(o,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rl(e,t,-r):Gi(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+Si(tl(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return rl(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ki(rl(e,t.replace(/[\\-]/g,""),r)),i=0,ki(ki(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<n.length?n.charAt(i++):"0"===e?"0":""}));if(t.match(Qi))return"("+(n=rl(e,"##########",r)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=Ii(o,Math.pow(10,i)-1,!1),n=""+c," "==(d=sl("n",s[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],(d=Ci(l[2],i)).length<s[4].length&&(d=Zi(s[4].substr(s[4].length-d.length))+d),n+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((l=Ii(o,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ai(l[1],i)+s[2]+"/"+s[3]+Ci(l[2],i):Bl(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=Ti(r,0),t.length<=n.length?n:Zi(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=t.indexOf(".")-i,h=t.length-n.length-u;return Zi(t.substr(0,u)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=tl(r,s[1].length),r<0?"-"+rl(e,t,-r):Gi(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Si(0,3-e.length):"")+e})+"."+Si(i,s[1].length);switch(t){case"###,##0.00":return rl(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=Gi(Ti(o,0));return"0"!==f?c+f:"";case"###,###.00":return rl(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return rl(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function al(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+al(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),!(r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(n+s)%n)+"."+a.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function nl(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ji)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nl("n",a,r):"("+nl("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return sl(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var a=t.replace(Ki,""),n=t.length-a.length;return sl(e,a,r*Math.pow(10,2*n))+Bl("%",n)}(e,t,r);if(-1!==t.indexOf("E"))return al(t,r);if(36===t.charCodeAt(0))return"$"+nl(e,t.substr(" "==t.charAt(1)?2:1),r);var n,s,i,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Si(o,t.length);if(t.match(/^[#?]+$/))return n=""+r,0===r&&(n=""),n.length>t.length?n:Zi(t.substr(0,t.length-n.length))+n;if(s=t.match(Xi))return function(e,t,r){return r+(0===t?"":""+t)+Bl(" ",e[1].length+2+e[4].length)}(s,o,c);if(t.match(/^#+0+$/))return c+Si(o,t.length-t.indexOf("0"));if(s=t.match($i))return n=(n=(""+r).replace(/^([^\.]+)$/,"$1."+Zi(s[1])).replace(/\.$/,"."+Zi(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Bl("0",Zi(s[1]).length-t.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Gi(""+o);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nl(e,t,-r):Gi(""+r)+"."+Bl("0",s[1].length);if(s=t.match(/^#,#*,#0/))return nl(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ki(nl(e,t.replace(/[\\-]/g,""),r)),i=0,ki(ki(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<n.length?n.charAt(i++):"0"===e?"0":""}));if(t.match(Qi))return"("+(n=nl(e,"##########",r)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=Ii(o,Math.pow(10,i)-1,!1),n=""+c," "==(d=sl("n",s[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],(d=Ci(l[2],i)).length<s[4].length&&(d=Zi(s[4].substr(s[4].length-d.length))+d),n+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((l=Ii(o,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ai(l[1],i)+s[2]+"/"+s[3]+Ci(l[2],i):Bl(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Zi(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=t.indexOf(".")-i,h=t.length-n.length-u;return Zi(t.substr(0,u)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+nl(e,t,-r):Gi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Si(0,3-e.length):"")+e})+"."+Si(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=Gi(""+o);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return nl(e,t.slice(0,t.lastIndexOf(".")),r)+Zi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function sl(e,t,r){return(0|r)===r?nl(e,t,r):rl(e,t,r)}var il=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ll(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Ei(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(il))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var ol=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function cl(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function dl(e,t){var r=function(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(ol),l=r[1].match(ol);return cl(t,i)?[a,r[0]]:cl(t,l)?[a,r[1]]:[a,r[null!=i&&null!=l?2:1]]}return[a,s]}function ul(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Oi)[e])&&(a=r.table&&r.table[Fi[e]]||Oi[Fi[e]]),null==a&&(a=Di[e]||"General")}if(Ei(a,0))return Wi(t,r);t instanceof Date&&(t=zi(t,r.date1904));var n=dl(a,t);if(Ei(n[1]))return Wi(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,a){for(var n,s,i,l=[],o="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Ei(e,c))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";34!==(i=e.charCodeAt(++c))&&c<e.length;)o+=String.fromCharCode(i);l[l.length]={t:"t",v:o},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";l[l.length]={t:m,v:f},++c;break;case"_":l[l.length]={t:"t",v:" "},c+=2;break;case"@":l[l.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==n&&null==(n=Ri(t,r,"2"===e.charAt(c+1))))return"";l[l.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=Ri(t,r)))return"";for(o=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)o+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),l[l.length]={t:d,v:o},u=d;break;case"A":case"a":case"\u4e0a":var p={t:d,v:d};if(null==n&&(n=Ri(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=n&&(p.v=n.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==n&&"T"===p.t)return"";l[l.length]=p,u=d;break;case"[":for(o=d;"]"!==e.charAt(c++)&&c<e.length;)o+=e.charAt(c);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(il)){if(null==n&&null==(n=Ri(t,r)))return"";l[l.length]={t:"Z",v:o.toLowerCase()},u=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",ll(e)||(l[l.length]={t:"t",v:o}));break;case".":if(null!=n){for(o=d;++c<e.length&&"0"===(d=e.charAt(c));)o+=d;l[l.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)o+=d;l[l.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++c)===d;)o+=d;l[l.length]={t:d,v:o},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":l[l.length]={t:1===a?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);l[l.length]={t:"D",v:o};break;case" ":l[l.length]={t:d,v:d},++c;break;case"$":l[l.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"t",v:d},++c}var g,x=0,b=0;for(c=l.length-1,u="t";c>=0;--c)switch(l[c].t){case"h":case"H":l[c].t=h,u="h",x<1&&(x=1);break;case"s":(g=l[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=l[c].t;break;case"m":"s"===u&&(l[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&l[c].v.match(/[Hh]/)&&(x=1),x<2&&l[c].v.match(/[Mm]/)&&(x=2),x<3&&l[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var v,y="";for(c=0;c<l.length;++c)switch(l[c].t){case"t":case"T":case" ":case"D":break;case"X":l[c].v="",l[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[c].v=Vi(l[c].t.charCodeAt(0),l[c].v,n,b),l[c].t="t";break;case"n":case"?":for(v=c+1;null!=l[v]&&("?"===(d=l[v].t)||"D"===d||(" "===d||"t"===d)&&null!=l[v+1]&&("?"===l[v+1].t||"t"===l[v+1].t&&"/"===l[v+1].v)||"("===l[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===l[v].v||" "===l[v].v&&null!=l[v+1]&&"?"==l[v+1].t));)l[c].v+=l[v].v,l[v]={v:"",t:";"},++v;y+=l[c].v,c=v-1;break;case"G":l[c].t="t",l[c].v=Wi(t,r)}var w,N,j="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,N=sl("n",y,w)):(N=sl("n",y,w=t<0&&a>1?-t:t),w<0&&l[0]&&"t"==l[0].t&&(N=N.substr(1),l[0].v="-"+l[0].v)),v=N.length-1;var k=l.length;for(c=0;c<l.length;++c)if(null!=l[c]&&"t"!=l[c].t&&l[c].v.indexOf(".")>-1){k=c;break}var S=l.length;if(k===l.length&&-1===N.indexOf("E")){for(c=l.length-1;c>=0;--c)null!=l[c]&&-1!=="n?".indexOf(l[c].t)&&(v>=l[c].v.length-1?(v-=l[c].v.length,l[c].v=N.substr(v+1,l[c].v.length)):v<0?l[c].v="":(l[c].v=N.substr(0,v+1),v=-1),l[c].t="t",S=c);v>=0&&S<l.length&&(l[S].v=N.substr(0,v+1)+l[S].v)}else if(k!==l.length&&-1===N.indexOf("E")){for(v=N.indexOf(".")-1,c=k;c>=0;--c)if(null!=l[c]&&-1!=="n?".indexOf(l[c].t)){for(s=l[c].v.indexOf(".")>-1&&c===k?l[c].v.indexOf(".")-1:l[c].v.length-1,j=l[c].v.substr(s+1);s>=0;--s)v>=0&&("0"===l[c].v.charAt(s)||"#"===l[c].v.charAt(s))&&(j=N.charAt(v--)+j);l[c].v=j,l[c].t="t",S=c}for(v>=0&&S<l.length&&(l[S].v=N.substr(0,v+1)+l[S].v),v=N.indexOf(".")+1,c=k;c<l.length;++c)if(null!=l[c]&&(-1!=="n?(".indexOf(l[c].t)||c===k)){for(s=l[c].v.indexOf(".")>-1&&c===k?l[c].v.indexOf(".")+1:0,j=l[c].v.substr(0,s);s<l[c].v.length;++s)v<N.length&&(j+=N.charAt(v++));l[c].v=j,l[c].t="t",S=c}}}for(c=0;c<l.length;++c)null!=l[c]&&"n?".indexOf(l[c].t)>-1&&(w=a>1&&t<0&&c>0&&"-"===l[c-1].v?-t:t,l[c].v=sl(l[c].t,l[c].v,w),l[c].t="t");var A="";for(c=0;c!==l.length;++c)null!=l[c]&&(A+=l[c].v);return A}(n[1],t,r,n[0])}function hl(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=Oi[r]){if(Oi[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Oi[t]=e,t}function fl(e){for(var t=0;392!=t;++t)void 0!==e[t]&&hl(e[t],t)}function ml(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Oi=e}var pl={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var xl=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,a=0,n="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(a=0;256!=a;++a)n[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=n[t]=r>>>8^e[255&r];var s=[];for(a=1;16!=a;++a)s[a-1]="undefined"!==typeof Int32Array?n.subarray(256*a,256*a+256):n.slice(256*a,256*a+256);return s}(t),a=r[0],n=r[1],s=r[2],i=r[3],l=r[4],o=r[5],c=r[6],d=r[7],u=r[8],h=r[9],f=r[10],m=r[11],p=r[12],g=r[13],x=r[14];return e.table=t,e.bstr=function(e,r){for(var a=-1^r,n=0,s=e.length;n<s;)a=a>>>8^t[255&(a^e.charCodeAt(n++))];return~a},e.buf=function(e,r){for(var b=-1^r,v=e.length-15,y=0;y<v;)b=x[e[y++]^255&b]^g[e[y++]^b>>8&255]^p[e[y++]^b>>16&255]^m[e[y++]^b>>>24]^f[e[y++]]^h[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^o[e[y++]]^l[e[y++]]^i[e[y++]]^s[e[y++]]^n[e[y++]]^a[e[y++]]^t[e[y++]];for(v+=15;y<v;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,r){for(var a=-1^r,n=0,s=e.length,i=0,l=0;n<s;)(i=e.charCodeAt(n++))<128?a=a>>>8^t[255&(a^i)]:i<2048?a=(a=a>>>8^t[255&(a^(192|i>>6&31))])>>>8^t[255&(a^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),l=1023&e.charCodeAt(n++),a=(a=(a=(a=a>>>8^t[255&(a^(240|i>>8&7))])>>>8^t[255&(a^(128|i>>2&63))])>>>8^t[255&(a^(128|l>>6&15|(3&i)<<4))])>>>8^t[255&(a^(128|63&l))]):a=(a=(a=a>>>8^t[255&(a^(224|i>>12&15))])>>>8^t[255&(a^(128|i>>6&63))])>>>8^t[255&(a^(128|63&i))];return~a},e}(),bl=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function a(e){if("/"==e.charAt(e.length-1))return a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function n(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var a=t.getFullYear()-1980;a=(a=a<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,a)}function s(e){qc(e,0);for(var t={},r=0;e.l<=e.length-4;){var a=e.read_shift(2),n=e.read_shift(2),s=e.l+n,i={};if(21589===a)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),n>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[a]=i}return t}function i(){return e||(e={})}function l(e,t){if(80==e[0]&&75==e[1])return ae(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=N(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",a=(fi&&Buffer.isBuffer(e)?e.toString("binary"):N(e)).split("\r\n"),n=0,s="";for(n=0;n<a.length;++n)if(s=a[n],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(a[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var l="--"+(i[1]||""),o=[],c=[],d={FileIndex:o,FullPaths:c};h(d);var u,f=0;for(n=0;n<a.length;++n){var m=a[n];m!==l&&m!==l+"--"||(f++&&ce(d,a.slice(u,n),r),u=n)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,a,n,s,i,l,f=512,m=[],p=e.slice(0,512);qc(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return ae(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&qc(p=e.slice(0,f),28);var v=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var y=p.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),a=p.read_shift(4,"i"),l=p.read_shift(4,"i"),n=p.read_shift(4,"i");for(var w=-1,j=0;j<109&&!((w=p.read_shift(4,"i"))<0);++j)m[j]=w;var k=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],n=1;n<r;++n)a[n-1]=e.slice(n*t,(n+1)*t);return a[r-1]=e.slice(r*t),a}(e,f);c(l,n,k,f,m);var S=function(e,t,r,a){var n=e.length,s=[],i=[],l=[],o=[],c=a-1,d=0,u=0,h=0,f=0;for(d=0;d<n;++d)if(l=[],(h=d+t)>=n&&(h-=n),!i[h]){o=[];var m=[];for(u=h;u>=0;){m[u]=!0,i[u]=!0,l[l.length]=u,o.push(e[u]);var p=r[Math.floor(4*u/a)];if(a<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+a);if(!e[p])break;if(m[u=Fc(e[p],f)])break}s[h]={nodes:l,data:cc([o])}}return s}(k,s,m,f);S[s].name="!Directory",a>0&&i!==x&&(S[i].name="!MiniFAT"),S[m[0]].name="!FAT",S.fat_addrs=m,S.ssz=f;var A=[],C=[],_=[];!function(e,t,r,a,n,s,i,l){for(var c,h=0,f=a.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var b=m.slice(p,p+128);qc(b,64),g=b.read_shift(2),c=uc(b,0,g-f),a.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=u(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=u(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=x,v.name=""),5===v.type?(h=v.start,n>0&&h!==x&&(t[h].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=d(r,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:h!==x&&v.start!==x&&t[h]&&(v.content=o(v,t[h].data,(t[l]||{}).data))),v.content&&qc(v.content,0),s[c]=v,i.push(v)}}(s,S,k,A,a,{},C,i),function(e,t,r){for(var a=0,n=0,s=0,i=0,l=0,o=r.length,c=[],d=[];a<o;++a)c[a]=d[a]=a,t[a]=r[a];for(;l<d.length;++l)n=e[a=d[l]].L,s=e[a].R,i=e[a].C,c[a]===a&&(-1!==n&&c[n]!==n&&(c[a]=c[n]),-1!==s&&c[s]!==s&&(c[a]=c[s])),-1!==i&&(c[i]=a),-1!==n&&a!=c[a]&&(c[n]=c[a],d.lastIndexOf(n)<l&&d.push(n)),-1!==s&&a!=c[a]&&(c[s]=c[a],d.lastIndexOf(s)<l&&d.push(s));for(a=1;a<o;++a)c[a]===a&&(-1!==s&&c[s]!==s?c[a]=c[s]:-1!==n&&c[n]!==n&&(c[a]=c[n]));for(a=1;a<o;++a)if(0!==e[a].type){if((l=a)!=c[l])do{l=c[l],t[a]=t[l]+"/"+t[a]}while(0!==l&&-1!==c[l]&&l!=c[l]);c[a]=-1}for(t[0]+="/",a=1;a<o;++a)2!==e[a].type&&(t[a]+="/")}(C,_,A),A.shift();var T={FileIndex:C,FullPaths:_};return t&&t.raw&&(T.raw={header:v,sectors:k}),T}function o(e,t,r){for(var a=e.start,n=e.size,s=[],i=a;r&&n>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),n-=g,i=Fc(r,4*i);return 0===s.length?Wc(0):wi(s).slice(0,e.size)}function c(e,t,r,a,n){var s=x;if(e===x){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],l=(a>>>2)-1;if(!i)return;for(var o=0;o<l&&(s=Fc(i,4*o))!==x;++o)n.push(s);c(Fc(i,a-4),t-1,r,a,n)}}function d(e,t,r,a,n){var s=[],i=[];n||(n=[]);var l=a-1,o=0,c=0;for(o=t;o>=0;){n[o]=!0,s[s.length]=o,i.push(e[o]);var d=r[Math.floor(4*o/a)];if(a<4+(c=4*o&l))throw new Error("FAT boundary crossed: "+o+" 4 "+a);if(!e[d])break;o=Fc(e[d],c)}return{nodes:s,data:cc([i])}}function u(e,t){return new Date(1e3*(Oc(e,t+4)/1e7*Math.pow(2,32)+Oc(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},a=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(bl.find(e,"/"+t))return;var r=Wc(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var n=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var l=e.FileIndex[i];switch(l.type){case 0:s?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(l.R*l.L*l.C)&&(n=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(n=!0);break;default:n=!0}}if(n||t){var o=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var f=r(u[i][0]);(s=d[f])||(u.push([f,{name:a(f).replace("/",""),type:1,clsid:y,ct:o,mt:o,content:null}]),d[f]=!0)}for(u.sort(function(e,t){return function(e,t){for(var r=e.split("/"),a=t.split("/"),n=0,s=0,i=Math.min(r.length,a.length);n<i;++n){if(s=r[n].length-a[n].length)return s;if(r[n]!=a[n])return r[n]<a[n]?-1:1}return r.length-a.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=a(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||y,0===i)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=i+1;c<u.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=u.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},a=r.boundary||"SheetJS",n=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(a="------="+a).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,l=e.FileIndex[0],o=1;o<e.FullPaths.length;++o)if(i=e.FullPaths[o].slice(s.length),(l=e.FileIndex[o]).size&&l.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=l.content,d=fi&&Buffer.isBuffer(c)?c.toString("binary"):N(c),u=0,h=Math.min(1024,d.length),f=0,m=0;m<=h;++m)(f=d.charCodeAt(m))>=32&&f<128&&++u;var p=u>=4*h/5;n.push(a),n.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),n.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),n.push("Content-Type: "+ie(l,i)),n.push(""),n.push(p?oe(d):le(d))}return n.push(a+"--\r\n"),n.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},a=[],s=[],i=Wc(1),l=r.compression?8:0,o=0;0;var c=0,d=0,u=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var b=u,v=Wc(m.length);for(d=0;d<m.length;++d)v.write_shift(1,127&m.charCodeAt(d));v=v.slice(0,v.l),g[h]=xl.buf(p.content,0);var y=p.content;8==l&&(y=j(y)),(i=Wc(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,o),i.write_shift(2,l),p.mt?n(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&o?0:g[h]),i.write_shift(4,8&o?0:y.length),i.write_shift(4,8&o?0:p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),u+=i.length,a.push(i),u+=v.length,a.push(v),u+=y.length,a.push(y),8&o&&((i=Wc(12)).write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),u+=i.l,a.push(i)),(i=Wc(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,o),i.write_shift(2,l),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),x+=i.l,s.push(i),x+=v.length,s.push(v),++h}return i=Wc(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,x),i.write_shift(4,u),i.write_shift(2,0),wi([wi(a),wi(s),i])}(e,r);var a=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];if(n.content){var s=n.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,l=t+127>>7,o=(t+7>>3)+r+i+l,c=o+127>>7,d=c<=109?0:Math.ceil((c-109)/127);o+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,l,i,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),s=Wc(a[7]<<9),i=0,l=0;for(i=0;i<8;++i)s.write_shift(1,v[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,a[2]),s.write_shift(4,a[0]+a[1]+a[2]+a[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,a[3]?a[0]+a[1]+a[2]-1:x),s.write_shift(4,a[3]),s.write_shift(-4,a[1]?a[0]-1:x),s.write_shift(4,a[1]),i=0;i<109;++i)s.write_shift(-4,i<a[2]?a[1]+i:-1);if(a[1])for(l=0;l<a[1];++l){for(;i<236+127*l;++i)s.write_shift(-4,i<a[2]?a[1]+i:-1);s.write_shift(-4,l===a[1]-1?x:l+1)}var o=function(e){for(l+=e;i<l-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,x))};for(l=i=0,l+=a[1];i<l;++i)s.write_shift(-4,w.DIFSECT);for(l+=a[2];i<l;++i)s.write_shift(-4,w.FATSECT);o(a[3]),o(a[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=l,o(d+511>>9)));for(o(a[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(l=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=l,o(d+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<a[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:x);var m=0===i&&r.root||u.name;if(d=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,d),s.write_shift(1,u.type),s.write_shift(1,u.color),s.write_shift(-4,u.L),s.write_shift(-4,u.R),s.write_shift(-4,u.C),u.clsid)s.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,u.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,u.start),s.write_shift(4,u.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(s.l=u.start+1<<9,fi&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(fi&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(fi)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var p,g=64,x=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function j(e){return p?p.deflateRawSync(e):Y(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var _="undefined"!==typeof Uint8Array,T=_?new Uint8Array(256):[],E=0;E<256;++E)T[E]=C(E);function L(e,t){var r=T[255&e];return t<=8?r>>>8-t:(r=r<<8|T[e>>8&255],t<=16?r>>>16-t:(r=r<<8|T[e>>16&255])>>>24-t)}function P(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=6?0:e[a+1]<<8))>>>r&3}function O(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=5?0:e[a+1]<<8))>>>r&7}function F(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=3?0:e[a+1]<<8))>>>r&31}function D(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=1?0:e[a+1]<<8))>>>r&127}function I(e,t,r){var a=7&t,n=t>>>3,s=(1<<r)-1,i=e[n]>>>a;return r<8-a?i&s:(i|=e[n+1]<<8-a,r<16-a?i&s:(i|=e[n+2]<<16-a,r<24-a?i&s:(i|=e[n+3]<<24-a)&s))}function R(e,t,r){var a=7&t,n=t>>>3;return a<=5?e[n]|=(7&r)<<a:(e[n]|=r<<a&255,e[n+1]=(7&r)>>8-a),t+3}function M(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function B(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=r,t+8}function U(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=255&r,e[a+2]=r>>>8,t+16}function z(e,t){var r=e.length,a=2*r>t?2*r:t+5,n=0;if(r>=t)return e;if(fi){var s=gi(a);if(e.copy)e.copy(s);else for(;n<e.length;++n)s[n]=e[n];return s}if(_){var i=new Uint8Array(a);if(i.set)i.set(e);else for(;n<r;++n)i[n]=e[n];return i}return e.length=a,e}function q(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var a=1,n=0,s=0,i=0,l=0,o=e.length,c=_?new Uint16Array(32):q(32);for(s=0;s<32;++s)c[s]=0;for(s=o;s<r;++s)e[s]=0;o=e.length;var d=_?new Uint16Array(o):q(o);for(s=0;s<o;++s)c[n=e[s]]++,a<n&&(a=n),d[s]=0;for(c[0]=0,s=1;s<=a;++s)c[s+16]=l=l+c[s-1]<<1;for(s=0;s<o;++s)0!=(l=e[s])&&(d[s]=c[l+16]++);var u=0;for(s=0;s<o;++s)if(0!=(u=e[s]))for(l=L(d[s],a)>>a-u,i=(1<<a+4-u)-1;i>=0;--i)t[l|i<<u]=15&u|s<<4;return a}var W=_?new Uint16Array(512):q(512),V=_?new Uint16Array(32):q(32);if(!_){for(var G=0;G<512;++G)W[G]=0;for(G=0;G<32;++G)V[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,V,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,W,288)}();var K=function(){for(var e=_?new Uint8Array(32768):[],t=0,r=0;t<A.length-1;++t)for(;r<A[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var a=_?new Uint8Array(259):[];for(t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)a[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var a=Math.min(65535,e.length-r),n=r+a==e.length;for(t.write_shift(1,+n),t.write_shift(2,a),t.write_shift(2,65535&~a);a-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var n=0,s=0,i=_?new Uint16Array(32768):[];s<t.length;){var l=Math.min(65535,t.length-s);if(l<10){for(7&(n=R(r,n,+!(s+l!=t.length)))&&(n+=8-(7&n)),r.l=n/8|0,r.write_shift(2,l),r.write_shift(2,65535&~l);l-- >0;)r[r.l++]=t[s++];n=8*r.l}else{n=R(r,n,+!(s+l!=t.length)+2);for(var o=0;l-- >0;){var c=t[s],d=-1,u=0;if((d=i[o=32767&(o<<5^c)])&&((d|=-32768&s)>s&&(d-=32768),d<s))for(;t[d+u]==t[s+u]&&u<250;)++u;if(u>2){(c=a[u])<=22?n=B(r,n,T[c+1]>>1)-1:(B(r,n,3),B(r,n+=5,T[c-23]>>5),n+=3);var h=c<8?0:c-4>>2;h>0&&(U(r,n,u-S[c]),n+=h),c=e[s-d],n=B(r,n,T[c]>>3),n-=3;var f=c<4?0:c-2>>1;f>0&&(U(r,n,s-d-A[c]),n+=f);for(var m=0;m<u;++m)i[o]=32767&s,o=32767&(o<<5^t[s]),++s;l-=u-1}else c<=143?c+=48:n=M(r,n,1),n=B(r,n,T[c]),i[o]=32767&s,++s}n=B(r,n,0)-1}}return r.l=(n+7)/8|0,r.l}(t,r)}}();function Y(e){var t=Wc(50+Math.floor(1.1*e.length)),r=K(e,t);return t.slice(0,r)}var X=_?new Uint16Array(32768):q(32768),$=_?new Uint16Array(32768):q(32768),J=_?new Uint16Array(128):q(128),Q=1,Z=1;function ee(e,t){var r=F(e,t)+257,a=F(e,t+=5)+1,n=function(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=4?0:e[a+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,i=_?new Uint8Array(19):q(19),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=1,c=_?new Uint8Array(8):q(8),d=_?new Uint8Array(8):q(8),u=i.length,h=0;h<n;++h)i[k[h]]=s=O(e,t),o<s&&(o=s),c[s]++,t+=3;var f=0;for(c[0]=0,h=1;h<=o;++h)d[h]=f=f+c[h-1]<<1;for(h=0;h<u;++h)0!=(f=i[h])&&(l[h]=d[f]++);var m=0;for(h=0;h<u;++h)if(0!=(m=i[h])){f=T[l[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)J[f|p<<m]=7&m|h<<3}var g=[];for(o=1;g.length<r+a;)switch(t+=7&(f=J[D(e,t)]),f>>>=3){case 16:for(s=3+P(e,t),t+=2,f=g[g.length-1];s-- >0;)g.push(f);break;case 17:for(s=3+O(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+D(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(f),o<f&&(o=f)}var x=g.slice(0,r),b=g.slice(r);for(h=r;h<286;++h)x[h]=0;for(h=a;h<30;++h)b[h]=0;return Q=H(x,X,286),Z=H(b,$,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[pi(t),2];for(var r=0,a=0,n=gi(t||1<<18),s=0,i=n.length>>>0,l=0,o=0;0==(1&a);)if(a=O(e,r),r+=3,a>>>1!=0)for(a>>1==1?(l=9,o=5):(r=ee(e,r),l=Q,o=Z);;){!t&&i<s+32767&&(i=(n=z(n,s+32767)).length);var c=I(e,r,l),d=a>>>1==1?W[c]:X[c];if(r+=15&d,0===((d>>>=4)>>>8&255))n[s++]=d;else{if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=s+S[d];u>0&&(h+=I(e,r,u),r+=u),c=I(e,r,o),r+=15&(d=a>>>1==1?V[c]:$[c]);var f=(d>>>=4)<4?0:d-2>>1,m=A[d];for(f>0&&(m+=I(e,r,f),r+=f),!t&&i<h&&(i=(n=z(n,h+100)).length);s<h;)n[s]=n[s-m],++s}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<s+p&&(i=(n=z(n,s+p)).length);p-- >0;)n[s++]=e[r>>>3],r+=8}return t?[n,r+7>>>3]:[n.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ae(e,t){var r=e;qc(r,0);var a={FileIndex:[],FullPaths:[]};h(a,{root:t.root});for(var n=r.length-4;(80!=r[n]||75!=r[n+1]||5!=r[n+2]||6!=r[n+3])&&n>=0;)--n;r.l=n+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var l=r.read_shift(4);for(r.l=l,n=0;n<i;++n){r.l+=20;var o=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),u=r.read_shift(2),f=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=s(r.slice(r.l+d,r.l+d+u));r.l+=d+u+f;var g=r.l;r.l=m+4,ne(r,o,c,a,p),r.l=g}return a}function ne(e,t,r,a,n){e.l+=2;var i=e.read_shift(2),l=e.read_shift(2),o=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),a=new Date,n=31&r,s=15&(r>>>=5);r>>>=4,a.setMilliseconds(0),a.setFullYear(r+1980),a.setMonth(s-1),a.setDate(n);var i=31&t,l=63&(t>>>=5);return t>>>=6,a.setHours(t),a.setMinutes(l),a.setSeconds(i<<1),a}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<u;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=s(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(o=g[21589].mt),((n||{})[21589]||{}).mt&&(o=n[21589].mt)}e.l+=h;var x=e.slice(e.l,e.l+c);switch(l){case 8:x=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),a=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,a}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+l)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&re(b,"Bad compressed size: "+t+" != "+c),d!=r&&re(b,"Bad uncompressed size: "+r+" != "+d),de(a,f,x,{unsafe:!0,mt:o})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",a=r.match(/\.([^\.]+)$/);return a&&se[a[1]]||t&&(a=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[a[1]]?se[a[1]]:"application/octet-stream"}function le(e){for(var t=ui(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"}function oe(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],a=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),n=0;n<a.length;++n){var s=a[n];if(0!=s.length)for(var i=0;i<s.length;){var l=76,o=s.slice(i,i+l);"="==o.charAt(l-1)?l--:"="==o.charAt(l-2)?l-=2:"="==o.charAt(l-3)&&(l-=3),o=s.slice(i,i+l),(i+=l)<s.length&&(o+="="),r.push(o)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var a,n="",s="",i="",l=0;l<10;++l){var o=t[l];if(!o||o.match(/^\s*$/))break;var c=o.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":n=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++l,s.toLowerCase()){case"base64":a=xi(hi(t.slice(l).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return xi(t.join("\r\n"))}(t.slice(l));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var d=de(e,n.slice(r.length),a,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,r,n){var s=n&&n.unsafe;s||h(e);var i=!s&&bl.find(e,t);if(!i){var l=e.FullPaths[0];t.slice(0,l.length)==l?l=t:("/"!=l.slice(-1)&&(l+="/"),l=(l+t).replace("//","/")),i={name:a(t),type:2},e.FileIndex.push(i),e.FullPaths.push(l),s||bl.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,n&&(n.CLSID&&(i.clsid=n.CLSID),n.mt&&(i.mt=n.mt),n.ct&&(i.ct=n.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),n=!1;47===t.charCodeAt(0)?(n=!0,t=r[0].slice(0,-1)+t):n=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===n?r.indexOf(s):a.indexOf(s);if(-1!==i)return e.FileIndex[i];var l=!s.match(ji);for(s=s.replace(Ni,""),l&&(s=s.replace(ji,"!")),i=0;i<r.length;++i){if((l?r[i].replace(ji,"!"):r[i]).replace(Ni,"")==s)return e.FileIndex[i];if((l?a[i].replace(ji,"!"):a[i]).replace(Ni,"")==s)return e.FileIndex[i]}return null},t.read=function(t,r){var a=r&&r.type;switch(a||fi&&Buffer.isBuffer(t)&&(a="buffer"),a||"base64"){case"file":return function(t,r){return i(),l(e.readFileSync(t),r)}(t,r);case"base64":return l(xi(hi(t)),r);case"binary":return l(xi(t),r)}return l(t,r)},t.parse=l,t.write=function(t,r){var a=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,a),a;case"binary":return"string"==typeof a?a:N(a);case"base64":return ui("string"==typeof a?a:N(a));case"buffer":if(fi)return Buffer.isBuffer(a)?a:mi(a);case"array":return"string"==typeof a?xi(a):a}return a},t.writeFile=function(t,r,a){i();var n=m(t,a);e.writeFileSync(r,n)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var r=bl.find(e,t);if(r)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var n=bl.find(e,t);if(n)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==n)return e.FileIndex[s].name=a(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ic,CheckField:zc,prep_blob:qc,bconcat:wi,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(mT){console.error("cannot use native zlib: "+(mT.message||mT))}},_deflateRaw:Y,_inflateRaw:te,consts:w},t}();let vl;function yl(e){return"string"===typeof e?bi(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function wl(e,t,r){if("undefined"!==typeof vl&&vl.writeFileSync)return r?vl.writeFileSync(e,t,r):vl.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=bi(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a="utf8"==r?Co(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(a,e);if("undefined"!==typeof Blob){var n=new Blob([yl(a)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!==typeof saveAs)return saveAs(n,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=vi(t)),l.write(t),l.close(),t}catch(mT){if(!mT.message||!mT.message.match(/onstruct/))throw mT}throw new Error("cannot save file "+e)}function Nl(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function jl(e,t){for(var r=[],a=Nl(e),n=0;n!==a.length;++n)null==r[e[a[n]][t]]&&(r[e[a[n]][t]]=a[n]);return r}function kl(e){for(var t=[],r=Nl(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Sl(e){for(var t=[],r=Nl(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}var Al=new Date(1899,11,30,0,0,0);function Cl(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Al.getTime()+6e4*(e.getTimezoneOffset()-Al.getTimezoneOffset())))/864e5}var _l=new Date,Tl=Al.getTime()+6e4*(_l.getTimezoneOffset()-Al.getTimezoneOffset()),El=_l.getTimezoneOffset();function Ll(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Tl),t.getTimezoneOffset()!==El&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-El)),t}function Pl(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(n[s],10)}return t}var Ol=new Date("2017-02-19T19:06:09.000Z"),Fl=isNaN(Ol.getFullYear())?new Date("2/19/17"):Ol,Dl=2017==Fl.getFullYear();function Il(e,t){var r=new Date(e);if(Dl)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Fl.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function Rl(e,t){if(fi&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Co(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Co(si(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Co(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Co(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(mT){}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Ml(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ml(e[r]));return t}function Bl(e,t){for(var r="";r.length<t;)r+=e;return r}function Ul(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))?(a=a.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(a))?t:t/r):t/r}var zl=["january","february","march","april","may","june","july","august","september","october","november","december"];function ql(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==zl.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&101!=a?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Hl=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,a){if(e||"string"==typeof r)return t.split(r);for(var n=t.split(r),s=[n[0]],i=1;i<n.length;++i)s.push(a),s.push(n[i]);return s}}();function Wl(e){return e?e.content&&e.type?Rl(e.content,!0):e.data?li(e.data):e.asNodeBuffer&&fi?li(e.asNodeBuffer().toString("binary")):e.asBinary?li(e.asBinary()):e._data&&e._data.getContent?li(Rl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Vl(e){if(!e)return null;if(e.data)return ni(e.data);if(e.asNodeBuffer&&fi)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?ni(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Gl(e,t){for(var r=e.FullPaths||Nl(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Kl(e,t){var r=Gl(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Yl(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?Vl(e):Wl(e)}(Kl(e,t));if(!t)return null;try{return Yl(e,t)}catch(mT){return null}}function Xl(e,t,r){if(!r)return Wl(Kl(e,t));if(!t)return null;try{return Xl(e,t)}catch(mT){return null}}function $l(e,t,r){if(!r)return Vl(Kl(e,t));if(!t)return null;try{return $l(e,t)}catch(mT){return null}}function Jl(e){for(var t=e.FullPaths||Nl(e.files),r=[],a=0;a<t.length;++a)"/"!=t[a].slice(-1)&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ql(e,t,r){if(e.FullPaths){var a;if("string"==typeof r)return a=fi?mi(r):function(e){for(var t=[],r=0,a=e.length+250,n=pi(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var l=1023&e.charCodeAt(++s);n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|l>>6&15|(3&i)<<4,n[r++]=128|63&l}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|63&i;r>a&&(t.push(n.slice(0,r)),r=0,n=pi(65535),a=65530)}return t.push(n.slice(0,r)),wi(t)}(r),bl.utils.cfb_add(e,t,a);bl.utils.cfb_add(e,t,r)}else e.file(t,r)}function Zl(){return bl.utils.cfb_new()}function eo(e,t){switch(t.type){case"base64":return bl.read(e,{type:"base64"});case"binary":return bl.read(e,{type:"binary"});case"buffer":case"array":return bl.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function to(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var a=e.split("/");0!==a.length;){var n=a.shift();".."===n?r.pop():"."!==n&&r.push(n)}return r.join("/")}var ro='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ao=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,no=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,so=ro.match(no)?no:/<[^>]*>/g,io=/<\w*:/,lo=/<(\/?)\w+:/;function oo(e,t,r){for(var a={},n=0,s=0;n!==e.length&&(32!==(s=e.charCodeAt(n))&&10!==s&&13!==s);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(ao),l=0,o="",c=0,d="",u="",h=1;if(i)for(c=0;c!=i.length;++c){for(u=i[c],s=0;s!=u.length&&61!==u.charCodeAt(s);++s);for(d=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(h=34==(n=u.charCodeAt(s+1))||39==n?1:0,o=u.slice(s+1+h,u.length-h),l=0;l!=d.length&&58!==d.charCodeAt(l);++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=o,r||(a[d.toLowerCase()]=o);else{var f=(5===l&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(l+1);if(a[f]&&"ext"==d.slice(l-3,l))continue;a[f]=o,r||(a[f.toLowerCase()]=o)}}return a}function co(e){return e.replace(lo,"<$1")}var uo={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ho=kl(uo),fo=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(-1==s)return n.replace(e,function(e,t){return uo[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,i)+r(n.slice(i+3))}}(),mo=/[&<>'"]/g,po=/[\u0000-\u0008\u000b-\u001f]/g;function go(e){return(e+"").replace(mo,function(e){return ho[e]}).replace(po,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xo(e){return go(e).replace(/ /g,"_x0020_")}var bo=/[\u0000-\u001f]/g;function vo(e){return(e+"").replace(mo,function(e){return ho[e]}).replace(/\n/g,"<br/>").replace(bo,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var yo=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function wo(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function No(e){for(var t="",r=0,a=0,n=0,s=0,i=0,l=0;r<e.length;)(a=e.charCodeAt(r++))<128?t+=String.fromCharCode(a):(n=e.charCodeAt(r++),a>191&&a<224?(i=(31&a)<<6,i|=63&n,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),a<240?t+=String.fromCharCode((15&a)<<12|(63&n)<<6|63&s):(l=((7&a)<<18|(63&n)<<12|(63&s)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(1023&l)))));return t}function jo(e){var t,r,a,n=pi(2*e.length),s=1,i=0,l=0;for(r=0;r<e.length;r+=s)s=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=64*(31&a)+(63&e.charCodeAt(r+1)),s=2):a<240?(t=4096*(15&a)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&a)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),l=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==l&&(n[i++]=255&l,n[i++]=l>>>8,l=0),n[i++]=t%256,n[i++]=t>>>8;return n.slice(0,i).toString("ucs2")}function ko(e){return mi(e,"binary").toString("utf8")}var So="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Ao=fi&&(ko(So)==No(So)&&ko||jo(So)==No(So)&&jo)||No,Co=fi?function(e){return mi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)))}return t.join("")},_o=function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),To=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}}(),Eo=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Lo=/<\/?(?:vt:)?variant>/g,Po=/<(?:vt:)([^>]*)>([\s\S]*)</;function Oo(e,t){var r=oo(e),a=e.match(Eo(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(e){var t=e.replace(Lo,"").match(Po);t&&n.push({v:Ao(t[2]),t:t[1]})}),n}var Fo=/(^\s|\s$|\n)/;function Do(e,t){return"<"+e+(t.match(Fo)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Io(e){return Nl(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ro(e,t,r){return"<"+e+(null!=r?Io(r):"")+(null!=t?(t.match(Fo)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Mo(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(mT){if(t)throw mT}return""}function Bo(e){if(fi&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Ao(vi(yi(e)));throw new Error("Bad input format: expected Buffer or string")}var Uo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,zo="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",qo="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Ho="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Wo="http://schemas.openxmlformats.org/package/2006/content-types",Vo="http://schemas.openxmlformats.org/package/2006/relationships",Go="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ko="http://purl.org/dc/elements/1.1/",Yo="http://purl.org/dc/terms/",Xo="http://purl.org/dc/dcmitype/",$o="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Jo="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Qo="http://www.w3.org/2001/XMLSchema-instance",Zo="http://www.w3.org/2001/XMLSchema",ec=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],tc="urn:schemas-microsoft-com:office:office",rc="urn:schemas-microsoft-com:office:excel",ac="urn:schemas-microsoft-com:office:spreadsheet",nc="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",sc="http://macVmlSchemaUri",ic="urn:schemas-microsoft-com:vml",lc="http://www.w3.org/TR/REC-html40";var oc=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,n=e[0][r].length;a<n;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t},cc=fi?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:mi(e)})):oc(e)}:oc,dc=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Lc(e,n)));return a.join("").replace(Ni,"")},uc=fi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ni,""):dc(e,t,r)}:dc,hc=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},fc=fi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):hc(e,t,r)}:hc,mc=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Ec(e,n)));return a.join("")},pc=fi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):mc(e,t,r)}:mc,gc=function(e,t){var r=Oc(e,t);return r>0?pc(e,t+4,t+4+r-1):""},xc=gc,bc=function(e,t){var r=Oc(e,t);return r>0?pc(e,t+4,t+4+r-1):""},vc=bc,yc=function(e,t){var r=2*Oc(e,t);return r>0?pc(e,t+4,t+4+r-1):""},wc=yc,Nc=function(e,t){var r=Oc(e,t);return r>0?uc(e,t+4,t+4+r):""},jc=Nc,kc=function(e,t){var r=Oc(e,t);return r>0?pc(e,t+4,t+4+r):""},Sc=kc,Ac=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),a=((127&e[t+7])<<4)+(e[t+6]>>>4&15),n=15&e[t+6],s=5;s>=0;--s)n=256*n+e[t+s];return 2047==a?0==n?r*(1/0):NaN:(0==a?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}(e,t)},Cc=Ac,_c=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Tc(){uc=function(e,t,r){return ii.utils.decode(1200,e.slice(t,r)).replace(Ni,"")},pc=function(e,t,r){return ii.utils.decode(65001,e.slice(t,r))},xc=function(e,t){var r=Oc(e,t);return r>0?ii.utils.decode(Qs,e.slice(t+4,t+4+r-1)):""},vc=function(e,t){var r=Oc(e,t);return r>0?ii.utils.decode(Js,e.slice(t+4,t+4+r-1)):""},wc=function(e,t){var r=2*Oc(e,t);return r>0?ii.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},jc=function(e,t){var r=Oc(e,t);return r>0?ii.utils.decode(1200,e.slice(t+4,t+4+r)):""},Sc=function(e,t){var r=Oc(e,t);return r>0?ii.utils.decode(65001,e.slice(t+4,t+4+r)):""}}fi&&(xc=function(e,t){if(!Buffer.isBuffer(e))return gc(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},vc=function(e,t){if(!Buffer.isBuffer(e))return bc(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},wc=function(e,t){if(!Buffer.isBuffer(e))return yc(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},jc=function(e,t){if(!Buffer.isBuffer(e))return Nc(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Sc=function(e,t){if(!Buffer.isBuffer(e))return kc(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Cc=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Ac(e,t)},_c=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ii&&Tc();var Ec=function(e,t){return e[t]},Lc=function(e,t){return 256*e[t+1]+e[t]},Pc=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Oc=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Dc=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ic(e,t){var r,a,n,s,i,l,o="",c=[];switch(t){case"dbcs":if(l=this.l,fi&&Buffer.isBuffer(this))o=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)o+=String.fromCharCode(Lc(this,l)),l+=2;e*=2;break;case"utf8":o=pc(this,this.l,this.l+e);break;case"utf16le":e*=2,o=uc(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ii)return Ic.call(this,e,"dbcs");o=ii.utils.decode(Js,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":o=xc(this,this.l),e=4+Oc(this,this.l);break;case"lpstr-cp":o=vc(this,this.l),e=4+Oc(this,this.l);break;case"lpwstr":o=wc(this,this.l),e=4+2*Oc(this,this.l);break;case"lpp4":e=4+Oc(this,this.l),o=jc(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Oc(this,this.l),o=Sc(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,o="";0!==(n=Ec(this,this.l+e++));)c.push(oi(n));o=c.join("");break;case"_wstr":for(e=0,o="";0!==(n=Lc(this,this.l+e));)c.push(oi(n)),e+=2;e+=2,o=c.join("");break;case"dbcs-cont":for(o="",l=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return n=Ec(this,l),this.l=l+1,s=Ic.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(oi(Lc(this,l))),l+=2}o=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ii){o=ii.utils.decode(Js,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(o="",l=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return n=Ec(this,l),this.l=l+1,s=Ic.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(oi(Ec(this,l))),l+=1}o=c.join("");break;default:switch(e){case 1:return r=Ec(this,this.l),this.l++,r;case 2:return r=("i"===t?Pc:Lc)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Fc:Dc)(this,this.l),this.l+=4,r):(a=Oc(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return a=8==e?Cc(this,this.l):Cc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:o=fc(this,this.l,e)}}return this.l+=e,o}var Rc=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Mc=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Bc=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Uc(e,t,r){var a=0,n=0;if("dbcs"===r){for(n=0;n!=t.length;++n)Bc(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if("sbcs"===r){if("undefined"!==typeof ii&&874==Qs)for(n=0;n!=t.length;++n){var s=ii.utils.encode(Qs,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);a=t.length}else{if("hex"===r){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:a=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:a=4,Rc(this,t,this.l);break;case 8:if(a=8,"f"===r){!function(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?0==i?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=255&s;e[r+6]=(15&n)<<4|15&s,e[r+7]=n>>4|a}(this,t,this.l);break}case 16:break;case-4:a=4,Mc(this,t,this.l)}}return this.l+=a,this}function zc(e,t){var r=fc(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qc(e,t){e.l=t,e.read_shift=Ic,e.chk=zc,e.write_shift=Uc}function Hc(e,t){e.l+=t}function Wc(e){var t=pi(e);return qc(t,0),t}function Vc(e,t,r){if(e){var a,n,s;qc(e,e.l||0);for(var i=e.length,l=0,o=0;e.l<i;){128&(l=e.read_shift(1))&&(l=(127&l)+((127&e.read_shift(1))<<7));var c=ex[l]||ex[65535];for(s=127&(a=e.read_shift(1)),n=1;n<4&&128&a;++n)s+=(127&(a=e.read_shift(1)))<<7*n;o=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=o,t(d,c,l))return}}}function Gc(){var e=[],t=fi?256:2048,r=function(e){var t=Wc(e);return qc(t,0),t},a=r(t),n=function(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},s=function(e){return a&&e<a.length-a.l?a:(n(),a=r(Math.max(e+1,t)))};return{next:s,push:function(e){n(),null==(a=e).l&&(a.l=a.length),s(t)},end:function(){return n(),wi(e)},_bufs:e}}function Kc(e,t,r,a){var n,s=+t;if(!isNaN(s)){a||(a=ex[s].p||(r||[]).length||0),n=1+(s>=128?1:0)+1,a>=128&&++n,a>=16384&&++n,a>=2097152&&++n;var i=e.next(n);s<=127?i.write_shift(1,s):(i.write_shift(1,128+(127&s)),i.write_shift(1,s>>7));for(var l=0;4!=l;++l){if(!(a>=128)){i.write_shift(1,a);break}i.write_shift(1,128+(127&a)),a>>=7}a>0&&_c(r)&&e.push(r)}}function Yc(e,t,r){var a=Ml(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Xc(e,t,r){var a=Ml(e);return a.s=Yc(a.s,t.s,r),a.e=Yc(a.e,t.s,r),a}function $c(e,t){if(e.cRel&&e.c<0)for(e=Ml(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ml(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ad(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Jc(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?$c(e.s,t.biff)+":"+$c(e.e,t.biff):(e.s.rRel?"":"$")+Zc(e.s.r)+":"+(e.e.rRel?"":"$")+Zc(e.e.r):(e.s.cRel?"":"$")+td(e.s.c)+":"+(e.e.cRel?"":"$")+td(e.e.c)}function Qc(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Zc(e){return""+(e+1)}function ed(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function td(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function rd(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function ad(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function nd(e){var t=e.indexOf(":");return-1==t?{s:rd(e),e:rd(e)}:{s:rd(e.slice(0,t)),e:rd(e.slice(t+1))}}function sd(e,t){return"undefined"===typeof t||"number"===typeof t?sd(e.s,e.e):("string"!==typeof e&&(e=ad(e)),"string"!==typeof t&&(t=ad(t)),e==t?e:e+":"+t)}function id(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||10!=n)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function ld(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=ul(e.z,r?Cl(t):t)}catch(mT){}try{return e.w=ul((e.XF||{}).numFmtId||(r?14:0),r?Cl(t):t)}catch(mT){return""+t}}function od(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Kd[e.v]||e.v:ld(e,void 0==t?e.v:t))}function cd(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function dd(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense;var s=e||(n?[]:{}),i=0,l=0;if(s&&null!=a.origin){if("number"==typeof a.origin)i=a.origin;else{var o="string"==typeof a.origin?rd(a.origin):a.origin;i=o.r,l=o.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=id(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if("undefined"!==typeof t[u][h]){var f={v:t[u][h]},m=i+u,p=l+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!==typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(a.nullError)f.t="e",f.v=0;else{if(!a.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=a.dateNF||Oi[14],a.cellDates?(f.t="d",f.w=ul(f.z,Cl(f.v))):(f.t="n",f.v=Cl(f.v),f.w=ul(f.z,f.v))):f.t="s";else f=t[u][h];if(n)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(f.z=s[m][p].z),s[m][p]=f;else{var g=ad({c:p,r:m});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=sd(c)),s}function ud(e,t){return dd(null,e,t)}function hd(e,t){return t||(t=Wc(4)),t.write_shift(4,e),t}function fd(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function md(e,t){var r=!1;return null==t&&(r=!0,t=Wc(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function pd(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function gd(e,t){var r=e.l,a=e.read_shift(1),n=fd(e),s=[],i={t:n,h:n};if(0!==(1&a)){for(var l=e.read_shift(4),o=0;o!=l;++o)s.push(pd(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var xd=gd;function bd(e,t){var r=!1;return null==t&&(r=!0,t=Wc(23+4*e.t.length)),t.write_shift(1,1),md(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Wc(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function vd(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function yd(e,t){return null==t&&(t=Wc(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function wd(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Nd(e,t){return null==t&&(t=Wc(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var jd=fd,kd=md;function Sd(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Ad(e,t){var r=!1;return null==t&&(r=!0,t=Wc(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Cd=fd,_d=Sd,Td=Ad;function Ed(e){var t=e.slice(e.l,e.l+4),r=1&t[0],a=2&t[0];e.l+=4;var n=0===a?Cc([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Fc(t,0)>>2;return r?n/100:n}function Ld(e,t){null==t&&(t=Wc(4));var r=0,a=0,n=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?a=1:n==(0|n)&&n>=-(1<<29)&&n<1<<29&&(a=1,r=1),!a)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?n:e)<<2)+(r+2))}function Pd(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Od=Pd,Fd=function(e,t){return t||(t=Wc(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Dd(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Id(e,t){return(t||Wc(8)).write_shift(8,e,"f")}function Rd(e,t){if(t||(t=Wc(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var a=e.rgb||"FFFFFF";"number"==typeof a&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function Md(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Bd=80,Ud=[Bd,81],zd={1:{n:"CodePage",t:2},2:{n:"Category",t:Bd},3:{n:"PresentationFormat",t:Bd},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Bd},15:{n:"Company",t:Bd},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Bd},27:{n:"ContentStatus",t:Bd},28:{n:"Language",t:Bd},29:{n:"Version",t:Bd},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},qd={1:{n:"CodePage",t:2},2:{n:"Title",t:Bd},3:{n:"Subject",t:Bd},4:{n:"Author",t:Bd},5:{n:"Keywords",t:Bd},6:{n:"Comments",t:Bd},7:{n:"Template",t:Bd},8:{n:"LastAuthor",t:Bd},9:{n:"RevNumber",t:Bd},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Bd},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Hd={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Wd=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Vd(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Gd=Ml(Vd([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Kd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Yd={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$d={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Jd(e,t){var r,a=function(e){for(var t=[],r=Nl(e),a=0;a!==r.length;++a)null==t[e[r[a]]]&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}(Xd),n=[];n[n.length]=ro,n[n.length]=Ro("Types",null,{xmlns:Wo,"xmlns:xsd":Zo,"xmlns:xsi":Qo}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Ro("Default",null,{Extension:e[0],ContentType:e[1]})}));var s=function(a){e[a]&&e[a].length>0&&(r=e[a][0],n[n.length]=Ro("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:$d[a][t.bookType]||$d[a].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){n[n.length]=Ro("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:$d[r][t.bookType]||$d[r].xlsx})})},l=function(t){(e[t]||[]).forEach(function(e){n[n.length]=Ro("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:a[t][0]})})};return s("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Qd={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Zd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function eu(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var a={};return(e.match(so)||[]).forEach(function(e){var n=oo(e);if("<Relationship"===n[0]){var s={};s.Type=n.Type,s.Target=n.Target,s.Id=n.Id,n.TargetMode&&(s.TargetMode=n.TargetMode);var i="External"===n.TargetMode?n.Target:to(n.Target,t);r[i]=s,a[n.Id]=s}}),r["!id"]=a,r}function tu(e){var t=[ro,Ro("Relationships",null,{xmlns:Vo})];return Nl(e["!id"]).forEach(function(r){t[t.length]=Ro("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ru(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,s?n.TargetMode=s:[Qd.HLINK,Qd.XPATH,Qd.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function au(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function nu(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function su(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+$s.version+"</meta:generator></office:meta></office:document-meta>"}var iu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lu=function(){for(var e=new Array(iu.length),t=0;t<iu.length;++t){var r=iu[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function ou(e){var t={};e=Ao(e);for(var r=0;r<iu.length;++r){var a=iu[r],n=e.match(lu[r]);null!=n&&n.length>0&&(t[a[1]]=fo(n[1])),"date"===a[2]&&t[a[1]]&&(t[a[1]]=Il(t[a[1]]))}return t}function cu(e,t,r,a,n){null==n[e]&&null!=t&&""!==t&&(n[e]=t,t=go(t),a[a.length]=r?Ro(e,t,r):Do(e,t))}function du(e,t){var r=t||{},a=[ro,Ro("cp:coreProperties",null,{"xmlns:cp":zo,"xmlns:dc":Ko,"xmlns:dcterms":Yo,"xmlns:dcmitype":Xo,"xmlns:xsi":Qo})],n={};if(!e&&!r.Props)return a.join("");e&&(null!=e.CreatedDate&&cu("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Mo(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),null!=e.ModifiedDate&&cu("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Mo(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=iu.length;++s){var i=iu[s],l=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===l?l="1":!1===l?l="0":"number"==typeof l&&(l=String(l)),null!=l&&cu(i[0],l,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var uu=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],hu=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function fu(e,t,r,a){var n=[];if("string"==typeof e)n=Oo(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?Oo(t,a).map(function(e){return e.v}):t,l=0,o=0;if(i.length>0)for(var c=0;c!==n.length;c+=2){switch(o=+n[c+1].v,n[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=i.slice(l,l+o);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=o,r.DefinedNames=i.slice(l,l+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=i.slice(l,l+o)}l+=o}}function mu(e){var t=[],r=Ro;return e||(e={}),e.Application="SheetJS",t[t.length]=ro,t[t.length]=Ro("Properties",null,{xmlns:Ho,"xmlns:vt":Jo}),uu.forEach(function(a){if(void 0!==e[a[1]]){var n;switch(a[2]){case"string":n=go(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false"}void 0!==n&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+go(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var pu=/<[^>]+>[^<]*/g;function gu(e){var t=[ro,Ro("Properties",null,{xmlns:qo,"xmlns:vt":Jo})];if(!e)return t.join("");var r=1;return Nl(e).forEach(function(a){++r,t[t.length]=Ro("property",function(e,t){switch(typeof e){case"string":var r=Ro("vt:lpwstr",go(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Ro((0|e)==e?"vt:i4":"vt:r8",go(String(e)));case"boolean":return Ro("vt:bool",e?"true":"false")}if(e instanceof Date)return Ro("vt:filetime",Mo(e));throw new Error("Unable to serialize "+e)}(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:go(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xu,bu={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function vu(e,t,r){xu||(xu=kl(bu)),e[t=xu[t]||t]=r}function yu(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function wu(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function Nu(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function ju(e,t,r){return 31===t?Nu(e):wu(e,0,r)}function ku(e,t,r){return ju(e,t,!1===r?0:4)}function Su(e){var t=e.l,r=_u(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,_u(e,3)]}function Au(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(Ni,"").replace(ji,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),a}function Cu(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function _u(e,t,r){var a,n=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&n!==t&&-1===Ud.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&n)))throw new Error("Expected type "+t+" saw "+n);switch(12===t?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return a=e.read_shift(4);case 30:return wu(e,0,4).replace(Ni,"");case 31:return Nu(e);case 64:return yu(e);case 65:return Cu(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return ku(e,n,!s.raw).replace(Ni,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ju(e,t,0)}(e,n).replace(Ni,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(Su(e));return r}(e);case 4126:case 4127:return 4127==n?function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ni,""),e.l-n&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ni,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Tu(e,t){var r=Wc(4),a=Wc(4);switch(r.write_shift(4,80==e?31:e),e){case 3:a.write_shift(-4,t);break;case 5:(a=Wc(8)).write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),a=(t-r)/Math.pow(2,32);a*=1e7;var n=(r*=1e7)/Math.pow(2,32)|0;n>0&&(r%=Math.pow(2,32),a+=n);var s=Wc(8);return s.write_shift(4,r),s.write_shift(4,a),s}(t);break;case 31:case 80:for((a=Wc(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return wi([r,a])}function Eu(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,l=0,o=-1,c={};for(i=0;i!=n;++i){var d=e.read_shift(4),u=e.read_shift(4);s[i]=[d,u+r]}s.sort(function(e,t){return e[1]-t[1]});var h={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var f=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],f=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(f=!1,e.l=s[i][1]),f)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(h[m.n]=_u(e,m.t,{raw:!0}),"version"===m.p&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(65535&h[m.n])).slice(-4)),"CodePage"==m.n)switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ri(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(1===s[i][0]){if(l=h.CodePage=_u(e,2),ri(l),-1!==o){var p=e.l;e.l=s[o][1],c=Au(e,l),e.l=p}}else if(0===s[i][0]){if(0===l){o=i,e.l=s[i+1][1];continue}c=Au(e,l)}else{var g,x=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=Cu(e);break;case 30:case 31:e.l+=4,g=ku(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Ru(e,4);break;case 64:e.l+=4,g=Il(yu(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=g}}return e.l=r+a,h}var Lu=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Pu(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Ou(e,t,r){var a=Wc(8),n=[],s=[],i=8,l=0,o=Wc(8),c=Wc(8);if(o.write_shift(4,2),o.write_shift(4,1200),c.write_shift(4,1),s.push(o),n.push(c),i+=8+o.length,!t){(c=Wc(8)).write_shift(4,0),n.unshift(c);var d=[Wc(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var u=e[l][0];for((o=Wc(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,l+2),o.write_shift(4,u.length+1),o.write_shift(0,u,"dbcs");o.l!=o.length;)o.write_shift(1,0);d.push(o)}o=wi(d),s.unshift(o),i+=8+o.length}for(l=0;l<e.length;++l)if((!t||t[e[l][0]])&&!(Lu.indexOf(e[l][0])>-1||hu.indexOf(e[l][0])>-1)&&null!=e[l][1]){var h=e[l][1],f=0;if(t){var m=r[f=+t[e[l][0]]];if("version"==m.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}o=Tu(m.t,h)}else{var g=Pu(h);-1==g&&(g=31,h=String(h)),o=Tu(g,h)}s.push(o),(c=Wc(8)).write_shift(4,t?f:2+l),n.push(c),i+=8+o.length}var x=8*(s.length+1);for(l=0;l<s.length;++l)n[l].write_shift(4,x),x+=s[l].length;return a.write_shift(4,i),a.write_shift(4,s.length),wi([a].concat(n).concat(s))}function Fu(e,t,r){var a=e.content;if(!a)return{};qc(a,0);var n,s,i,l,o=0;a.chk("feff","Byte Order: "),a.read_shift(2);var c=a.read_shift(4),d=a.read_shift(16);if(d!==bl.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(1!==(n=a.read_shift(4))&&2!==n)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),l=a.read_shift(4),1===n&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);2===n&&(i=a.read_shift(16),o=a.read_shift(4));var u,h=Eu(a,t),f={SystemIdentifier:c};for(var m in h)f[m]=h[m];if(f.FMTID=s,1===n)return f;if(o-a.l==2&&(a.l+=2),a.l!==o)throw new Error("Length mismatch 2: "+a.l+" !== "+o);try{u=Eu(a,null)}catch(mT){}for(m in u)f[m]=u[m];return f.FMTID=[s,i],f}function Du(e,t,r,a,n,s){var i=Wc(n?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,bl.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var o=Ou(e,r,a);if(l.push(o),n){var c=Ou(n,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+o.length),l.push(c)}return wi(l)}function Iu(e,t){return e.read_shift(t),null}function Ru(e,t){return 1===e.read_shift(t)}function Mu(e,t){return t||(t=Wc(2)),t.write_shift(2,+!!e),t}function Bu(e){return e.read_shift(2,"u")}function Uu(e,t){return t||(t=Wc(2)),t.write_shift(2,e),t}function zu(e,t){return function(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}(e,t,Bu)}function qu(e,t,r){return r||(r=Wc(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function Hu(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",s=Js;(r&&r.biff>=8&&(Js=1200),r&&8!=r.biff)?12==r.biff&&(n="wstr"):e.read_shift(1)&&(n="dbcs-cont");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return Js=s,i}function Wu(e){var t=Js;Js=1200;var r,a=e.read_shift(2),n=e.read_shift(1),s=4&n,i=8&n,l=1+(1&n),o=0,c={};i&&(o=e.read_shift(2)),s&&(r=e.read_shift(4));var d=2==l?"dbcs-cont":"sbcs-cont",u=0===a?"":e.read_shift(a,d);return i&&(e.l+=4*o),s&&(e.l+=r),c.t=u,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Js=t,c}function Vu(e){var t=e.t||"",r=Wc(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Wc(2*t.length);return a.write_shift(2*t.length,t,"utf16le"),wi([r,a])}function Gu(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Ku(e,t,r){var a=e.read_shift(r&&2==r.biff?1:2);return 0===a?(e.l++,""):Gu(e,a,r)}function Yu(e,t,r){if(r.biff>5)return Ku(e,0,r);var a=e.read_shift(1);return 0===a?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Xu(e,t,r){return r||(r=Wc(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function $u(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ni,"");return a&&(e.l+=24),n}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+a.replace(/\\/g,"/");var n=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(n>>1,"utf16le").replace(Ni,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function Ju(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Ni,""):""}function Qu(e,t){t||(t=Wc(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Zu(e){var t=Wc(512),r=0,a=e.Target;"file://"==a.slice(0,7)&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==s)Qu(a=a.slice(1),t);else if(2&s){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),8&s&&Qu(n>-1?a.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var o=0;"../"==a.slice(3*o,3*o+3)||"..\\"==a.slice(3*o,3*o+3);)++o;for(t.write_shift(2,o),t.write_shift(4,a.length-3*o+1),r=0;r<a.length-3*o;++r)t.write_shift(1,255&a.charCodeAt(r+3*o));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function eh(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function th(e,t){var r=eh(e);return r[3]=0,r}function rh(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function ah(e,t,r,a){return a||(a=Wc(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function nh(e,t,r){var a=r.biff>8?4:2;return[e.read_shift(a),e.read_shift(a,"i"),e.read_shift(a,"i")]}function sh(e){return[e.read_shift(2),Ed(e)]}function ih(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function lh(e,t){return t||(t=Wc(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function oh(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var ch=oh;function dh(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function uh(e){e.l+=2,e.l+=e.read_shift(2)}var hh={0:uh,4:uh,5:uh,6:uh,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:uh,9:uh,10:uh,11:uh,12:uh,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:uh,15:uh,16:uh,17:uh,18:uh,19:uh,20:uh,21:dh};function fh(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function mh(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;default:throw new Error("unsupported BIFF version")}var s=Wc(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function ph(e,t){var r=!t||t.biff>=8?2:1,a=Wc(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function gh(e,t,r){var a=0;r&&2==r.biff||(a=e.read_shift(2));var n=e.read_shift(2);return r&&2==r.biff&&(a=1-(n>>15),n&=32767),[{Unsynced:1&a,DyZero:(2&a)>>1,ExAsc:(4&a)>>2,ExDsc:(8&a)>>3},n]}function xh(e,t,r,a){var n=r&&5==r.biff;a||(a=Wc(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return null==s.l&&(s.l=s.length),s}var bh=Yu;function vh(e,t,r){var a=e.l+t,n=8!=r.biff&&r.biff?2:4,s=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(2),o=e.read_shift(2);return e.l=a,{s:{r:s,c:l},e:{r:i,c:o}}}function yh(e,t,r,a){var n=r&&5==r.biff;a||(a=Wc(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function wh(e,t,r){var a=rh(e);2!=r.biff&&9!=t||++e.l;var n=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return a.val=n,a.t=!0===n||!1===n?"b":"e",a}var Nh=function(e,t,r){return 0===t?"":Yu(e,0,r)};function jh(e,t,r){var a,n=e.read_shift(2),s={fBuiltIn:1&n,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return 14849===r.sbcch&&(a=function(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Hu(e,0,r),s=e.read_shift(2);if(s!==(a-=e.l))throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}(e,t-2,r)),s.body=a||e.read_shift(t-2),"string"===typeof a&&(s.Name=a),s}var kh=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Sh(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&2==r.biff?1:2),o=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),o=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=Gu(e,i,r);32&n&&(c=kh[c.charCodeAt(0)]);var d=a-e.l;r&&2==r.biff&&--d;var u=a!=e.l&&0!==l&&d>0?function(e,t,r,a){var n,s=e.l+t,i=zm(e,a,r);s!==e.l&&(n=Um(e,s-e.l,i,r));return[i,n]}(e,d,r,l):[];return{chKey:s,Name:c,itab:o,rgce:u}}function Ah(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var a=Hu(e,0,r);return 3==a.charCodeAt(0)?a.slice(1):a}(e,0,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)a.push(nh(e,r.biff,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function Ch(e,t,r){var a=ch(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Km(e,t,r)]}var _h={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function Th(e){var t=Wc(24),r=rd(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return wi([t,Zu(e[1])])}function Eh(e){var t=e[1].Tooltip,r=Wc(10+2*(t.length+1));r.write_shift(2,2048);var a=rd(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function Lh(e,t,r){if(!r.cellStyles)return Hc(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(2);2==a&&(e.l+=2);var c={s:n,e:s,w:i,ixfe:l,flags:o};return(r.biff>=5||!r.biff)&&(c.level=o>>8&7),c}var Ph=rh,Oh=zu,Fh=Ku;var Dh=[2,3,48,49,131,139,140,245],Ih=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=kl({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var a=r||{};a.dateNF||(a.dateNF="yyyymmdd");var n=ud(function(t,r){var a=[],n=pi(1);switch(r.type){case"base64":n=xi(hi(t));break;case"binary":n=xi(t);break;case"buffer":case"array":n=t}qc(n,0);var s=n.read_shift(1),i=!!(136&s),l=!1,o=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:l=!0,i=!0;break;case 140:o=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,d=521;2==s&&(c=n.read_shift(2)),n.l+=3,2!=s&&(c=n.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(d=n.read_shift(2));var u=n.read_shift(2),h=r.codepage||1252;2!=s&&(n.l+=16,n.read_shift(1),0!==n[n.l]&&(h=e[n[n.l]]),n.l+=1,n.l+=2),o&&(n.l+=36);for(var f=[],m={},p=Math.min(n.length,2==s?521:d-10-(l?264:0)),g=o?32:11;n.l<p&&13!=n[n.l];)switch((m={}).name=ii.utils.decode(h,n.slice(n.l,n.l+g)).replace(/[\u0000\r\n].*$/g,""),n.l+=g,m.type=String.fromCharCode(n.read_shift(1)),2==s||o||(m.offset=n.read_shift(4)),m.len=n.read_shift(1),2==s&&(m.offset=n.read_shift(2)),m.dec=n.read_shift(1),m.name.length&&f.push(m),2!=s&&(n.l+=o?13:14),m.type){case"B":l&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==n[n.l]&&(n.l=d-1),13!==n.read_shift(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=d;var x=0,b=0;for(a[0]=[],b=0;b!=f.length;++b)a[0][b]=f[b].name;for(;c-- >0;)if(42!==n[n.l])for(++n.l,a[++x]=[],b=0,b=0;b!=f.length;++b){var v=n.slice(n.l,n.l+f[b].len);n.l+=f[b].len,qc(v,0);var y=ii.utils.decode(h,v);switch(f[b].type){case"C":y.trim().length&&(a[x][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?a[x][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):a[x][b]=y;break;case"F":a[x][b]=parseFloat(y.trim());break;case"+":case"I":a[x][b]=o?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":a[x][b]=!0;break;case"N":case"F":a[x][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));a[x][b]="##MEMO##"+(o?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(a[x][b]=+y||0);break;case"@":a[x][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":a[x][b]=new Date(864e5*(v.read_shift(4)-2440588)+v.read_shift(4));break;case"Y":a[x][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":a[x][b]=-v.read_shift(-8,"f");break;case"B":if(l&&8==f[b].len){a[x][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else n.l+=u;if(2!=s&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return r&&r.sheetRows&&(a=a.slice(0,r.sheetRows)),r.DBF=f,a}(t,a),a);return n["!cols"]=a.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete a.DBF,n}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return cd(r(e,t),t)}catch(mT){if(t&&t.WTF)throw mT}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var n=r||{};if(+n.codepage>=0&&ri(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var s=Gc(),i=Nb(e,{header:1,raw:!0,cellDates:!0}),l=i[0],o=i.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<l.length;++d)if(((c[d]||{}).DBF||{}).name)l[d]=c[d].DBF.name,++h;else if(null!=l[d]){if(++h,"number"===typeof l[d]&&(l[d]=l[d].toString(10)),"string"!==typeof l[d])throw new Error("DBF Invalid column name "+l[d]+" |"+typeof l[d]+"|");if(l.indexOf(l[d])!==d)for(u=0;u<1024;++u)if(-1==l.indexOf(l[d]+"_"+u)){l[d]+="_"+u;break}}var m=id(e["!ref"]),p=[],g=[],x=[];for(d=0;d<=m.e.c-m.s.c;++d){var b="",v="",y=0,w=[];for(u=0;u<o.length;++u)null!=o[u][d]&&w.push(o[u][d]);if(0!=w.length&&null!=l[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":v="B";break;case"string":default:v="C";break;case"boolean":v="L";break;case"object":v=w[u]instanceof Date?"D":"C"}y=Math.max(y,String(w[u]).length),b=b&&b!=v?"C":v}y>250&&(y=250),"C"==(v=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==v&&(b="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),g[d]="C"==b||"N"==v?y:a[b]||0,f+=g[d],p[d]=b}else p[d]="?"}var N=s.next(32);for(N.write_shift(4,318902576),N.write_shift(4,o.length),N.write_shift(2,296+32*h),N.write_shift(2,f),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+t[Qs]||3)<<8),d=0,u=0;d<l.length;++d)if(null!=l[d]){var j=s.next(32),k=(l[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,k,"sbcs"),j.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),j.write_shift(4,u),j.write_shift(1,g[d]||a[p[d]]||0),j.write_shift(1,x[d]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),u+=g[d]||a[p[d]]||0}var S=s.next(264);for(S.write_shift(4,13),d=0;d<65;++d)S.write_shift(4,0);for(d=0;d<o.length;++d){var A=s.next(f);for(A.write_shift(1,0),u=0;u<l.length;++u)if(null!=l[u])switch(p[u]){case"L":A.write_shift(1,null==o[d][u]?63:o[d][u]?84:70);break;case"B":A.write_shift(8,o[d][u]||0,"f");break;case"N":var C="0";for("number"==typeof o[d][u]&&(C=o[d][u].toFixed(x[u]||0)),h=0;h<g[u]-C.length;++h)A.write_shift(1,32);A.write_shift(1,C,"sbcs");break;case"D":o[d][u]?(A.write_shift(4,("0000"+o[d][u].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(o[d][u].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+o[d][u].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var _=String(null!=o[d][u]?o[d][u]:"").slice(0,g[u]);for(A.write_shift(1,_,"sbcs"),h=0;h<g[u]-_.length;++h)A.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Rh=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Nl(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var a=e[r];return"number"==typeof a?ci(a):a},a=function(e,t,r){var a=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==a?e:ci(a)};function n(e,n){var s,i=e.split(/[\n\r]+/),l=-1,o=-1,c=0,d=0,u=[],h=[],f=null,m={},p=[],g=[],x=[],b=0;for(+n.codepage>=0&&ri(+n.codepage);c!==i.length;++c){b=0;var v,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),N=w[0];if(y.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,k=!1,S=!1,A=!1,C=-1,_=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":o=parseInt(w[d].slice(1))-1,k=!0;break;case"Y":for(l=parseInt(w[d].slice(1))-1,k||(o=0),s=u.length;s<=l;++s)u[s]=[];break;case"K":'"'===(v=w[d].slice(1)).charAt(0)?v=v.slice(1,v.length-1):"TRUE"===v?v=!0:"FALSE"===v?v=!1:isNaN(Ul(v))?isNaN(ql(v).getDate())||(v=Il(v)):(v=Ul(v),null!==f&&ll(f)&&(v=Ll(v))),"undefined"!==typeof ii&&"string"==typeof v&&"string"!=(n||{}).type&&(n||{}).codepage&&(v=ii.utils.decode(n.codepage,v)),j=!0;break;case"E":A=!0;var T=pm(w[d].slice(1),{r:l,c:o});u[l][o]=[u[l][o],T];break;case"S":S=!0,u[l][o]=[u[l][o],"S5S"];break;case"R":C=parseInt(w[d].slice(1))-1;break;case"C":_=parseInt(w[d].slice(1))-1;break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+y)}if(j&&(u[l][o]&&2==u[l][o].length?u[l][o][0]=v:u[l][o]=v,f=null),S){if(A)throw new Error("SYLK shared formula cannot have own formula");var E=C>-1&&u[C][_];if(!E||!E[1])throw new Error("SYLK shared formula cannot find base");u[l][o][1]=bm(E[1],{r:l-C,c:o-_})}break;case"F":var L=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":o=parseInt(w[d].slice(1))-1,++L;break;case"Y":for(l=parseInt(w[d].slice(1))-1,s=u.length;s<=l;++s)u[s]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[d].slice(1))];break;case"W":for(x=w[d].slice(1).split(" "),s=parseInt(x[0],10);s<=parseInt(x[1],10);++s)b=parseInt(x[2],10),g[s-1]=0===b?{hidden:!0}:{wch:b},kf(g[s-1]);break;case"C":g[o=parseInt(w[d].slice(1))-1]||(g[o]={});break;case"R":p[l=parseInt(w[d].slice(1))-1]||(p[l]={}),b>0?(p[l].hpt=b,p[l].hpx=Cf(b)):0===b&&(p[l].hidden=!0);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+y)}L<1&&(f=null);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),n&&n.sheetRows&&(u=u.slice(0,n.sheetRows)),[u,m]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return n(hi(e),t);case"binary":return n(e,t);case"buffer":return n(fi&&Buffer.isBuffer(e)?e.toString("binary"):vi(e),t);case"array":return n(Rl(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),a=r[0],s=r[1],i=ud(a,t);return Nl(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,r,a){var n="C;Y"+(r+1)+";X"+(a+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+xm(e.f,{r:r,c:a}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}return e["|"]=254,{to_workbook:function(e,t){return cd(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,a,n=["ID;PWXL;N;E"],s=[],l=id(e["!ref"]),o=Array.isArray(e),c="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&(a=n,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=vf(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=yf(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&a.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var a="F;";t.hidden?a+="M0;":t.hpt?a+="M"+20*t.hpt+";":t.hpx&&(a+="M"+20*Af(t.hpx)+";"),a.length>2&&e.push(a+"R"+(r+1))})}(n,e["!rows"]),n.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" "));for(var d=l.s.r;d<=l.e.r;++d)for(var u=l.s.c;u<=l.e.c;++u){var h=ad({r:d,c:u});(r=o?(e[d]||[])[u]:e[h])&&(null!=r.v||r.f&&!r.F)&&s.push(i(r,0,d,u))}return n.join(c)+c+s.join(c)+c+"E"+c}}}(),Mh=function(){function e(e,t){for(var r=e.split("\n"),a=-1,n=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(a<0)){for(var l=r[s].trim().split(","),o=l[0],c=l[1],d=r[++s]||"";1&(d.match(/["]/g)||[]).length&&s<r.length-1;)d+="\n"+r[++s];switch(d=d.trim(),+o){case-1:if("BOT"===d){i[++a]=[],n=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[a][n]=!0:"FALSE"===d?i[a][n]=!1:isNaN(Ul(c))?isNaN(ql(c).getDate())?i[a][n]=c:i[a][n]=Il(c):i[a][n]=Ul(c),++n;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[a][n++]=""!==d?d:null}if("EOD"===d)break}}else i[++a]=[],n=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return ud(function(t,r){switch(r.type){case"base64":return e(hi(t),r);case"binary":return e(t,r);case"buffer":return e(fi&&Buffer.isBuffer(t)?t.toString("binary"):vi(t),r);case"array":return e(Rl(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}var r=function(){var e=function(e,t,r,a,n){e.push(t),e.push(r+","+a),e.push('"'+n.replace(/"/g,'""')+'"')},t=function(e,t,r,a){e.push(t+","+r),e.push(1==t?'"'+a.replace(/"/g,'""')+'"':a)};return function(r){var a,n=[],s=id(r["!ref"]),i=Array.isArray(r);e(n,"TABLE",0,1,"sheetjs"),e(n,"VECTORS",0,s.e.r-s.s.r+1,""),e(n,"TUPLES",0,s.e.c-s.s.c+1,""),e(n,"DATA",0,0,"");for(var l=s.s.r;l<=s.e.r;++l){t(n,-1,0,"BOT");for(var o=s.s.c;o<=s.e.c;++o){var c=ad({r:l,c:o});if(a=i?(r[l]||[])[o]:r[c])switch(a.t){case"n":var d=a.w;d||null==a.v||(d=a.v),null==d?a.f&&!a.F?t(n,1,0,"="+a.f):t(n,1,0,""):t(n,0,d,"V");break;case"b":t(n,0,a.v?1:0,a.v?"TRUE":"FALSE");break;case"s":t(n,1,0,isNaN(a.v)?a.v:'="'+a.v+'"');break;case"d":a.w||(a.w=ul(a.z||Oi[14],Cl(Il(a.v)))),t(n,0,a.w,"V");break;default:t(n,1,0,"")}else t(n,1,0,"")}}t(n,-1,0,"EOD");return n.join("\r\n")}}();return{to_workbook:function(e,r){return cd(t(e,r),r)},to_sheet:t,from_sheet:r}}(),Bh=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return ud(function(t,r){for(var a=t.split("\n"),n=-1,s=-1,i=0,l=[];i!==a.length;++i){var o=a[i].trim().split(":");if("cell"===o[0]){var c=rd(o[1]);if(l.length<=c.r)for(n=l.length;n<=c.r;++n)l[n]||(l[n]=[]);switch(n=c.r,s=c.c,o[2]){case"t":l[n][s]=e(o[3]);break;case"v":l[n][s]=+o[3];break;case"vtf":var d=o[o.length-1];case"vtc":"nl"===o[3]?l[n][s]=!!+o[4]:l[n][s]=+o[4],"vtf"==o[2]&&(l[n][s]=[l[n][s],d])}}}return r&&r.sheetRows&&(l=l.slice(0,r.sheetRows)),l}(t,r),r)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function l(e){if(!e||!e["!ref"])return"";for(var r,a=[],n=[],s="",i=nd(e["!ref"]),l=Array.isArray(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c)if(s=ad({r:o,c:c}),(r=l?(e[o]||[])[c]:e[s])&&null!=r.v&&"z"!==r.t){switch(n=["cell",s,"t"],r.t){case"s":case"str":n.push(t(r.v));break;case"n":r.f?(n[2]="vtf",n[3]="n",n[4]=r.v,n[5]=t(r.f)):(n[2]="v",n[3]=r.v);break;case"b":n[2]="vt"+(r.f?"f":"c"),n[3]="nl",n[4]=r.v?"1":"0",n[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=Cl(Il(r.v));n[2]="vtc",n[3]="nd",n[4]=""+d,n[5]=r.w||ul(r.z||Oi[14],d);break;case"e":continue}a.push(n.join(":"))}return a.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}return{to_workbook:function(e,t){return cd(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[a,n,s,n,l(e),i].join("\n")}}}(),Uh=function(){function e(e,t,r,a,n){n.raw?t[r][a]=e:""===e||("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(Ul(e))?isNaN(ql(e).getDate())?t[r][a]=e:t[r][a]=Il(e):t[r][a]=Ul(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(e){for(var a={},n=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?n=!n:!n&&i in t&&(a[i]=(a[i]||0)+1);for(s in i=[],a)Object.prototype.hasOwnProperty.call(a,s)&&i.push([a[s],s]);if(!i.length)for(s in a=r)Object.prototype.hasOwnProperty.call(a,s)&&i.push([a[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function n(e,t){var r=t||{},n="";var s=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=a(e.slice(0,1024)):n=r&&r.FS?r.FS:a(e.slice(0,1024));var l=0,o=0,c=0,d=0,u=0,h=n.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=r.dateNF?function(e){var t="number"==typeof e?Oi[e]:e;return t=t.replace(gl,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function x(){var t=e.slice(d,u),a={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)a.t="z";else if(r.raw)a.t="s",a.v=t;else if(0===t.trim().length)a.t="s",a.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(a.t="s",a.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(a.t="s",a.v=t):(a.t="n",a.f=t.slice(1));else if("TRUE"==t)a.t="b",a.v=!0;else if("FALSE"==t)a.t="b",a.v=!1;else if(isNaN(c=Ul(t)))if(!isNaN(ql(t).getDate())||g&&t.match(g)){a.z=r.dateNF||Oi[14];var n=0;g&&t.match(g)&&(t=function(e,t,r){var a=-1,n=-1,s=-1,i=-1,l=-1,o=-1;(t.match(gl)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":a=c;break;case"d":s=c;break;case"h":i=c;break;case"s":o=c;break;case"m":i>=0?l=c:n=c}}),o>=0&&-1==l&&n>=0&&(l=n,n=-1);var c=(""+(a>=0?a:(new Date).getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return-1==i&&-1==l&&-1==o?c:-1==a&&-1==n&&-1==s?d:c+"T"+d}(0,r.dateNF,t.match(g)||[]),n=1),r.cellDates?(a.t="d",a.v=Il(t,n)):(a.t="n",a.v=Cl(Il(t,n))),!1!==r.cellText&&(a.w=ul(a.z,a.v instanceof Date?Cl(a.v):a.v)),r.cellNF||delete a.z}else a.t="s",a.v=t;else a.t="n",!1!==r.cellText&&(a.w=t),a.v=c;if("z"==a.t||(r.dense?(s[l]||(s[l]=[]),s[l][o]=a):s[ad({c:o,r:l})]=a),d=u+1,p=e.charCodeAt(d),i.e.c<o&&(i.e.c=o),i.e.r<l&&(i.e.r=l),m==h)++o;else if(o=0,++l,r.sheetRows&&r.sheetRows<=l)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&x())break e}return u-d>0&&x(),s["!ref"]=sd(i),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?n(t,r):ud(function(t,r){var a=r||{},n=[];if(!t||0===t.length)return n;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var l=10,o=0,c=0;c<=i;++c)-1==(o=s[c].indexOf(" "))?o=s[c].length:o++,l=Math.max(l,o);for(c=0;c<=i;++c){n[c]=[];var d=0;for(e(s[c].slice(0,l).trim(),n,c,d,a),d=1;d<=(s[c].length-l)/10+1;++d)e(s[c].slice(l+10*(d-1),l+10*d).trim(),n,c,d,a)}return a.sheetRows&&(n=n.slice(0,a.sheetRows)),n}(t,r),r):n(t,r)}function i(e,t){var r="",a="string"==t.type?[0,0,0,0]:ub(e,t);switch(t.type){case"base64":r=hi(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ii?ii.utils.decode(t.codepage,e):fi&&Buffer.isBuffer(e)?e.toString("binary"):vi(e);break;case"array":r=Rl(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]?r=Ao(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Ao(r):"binary"==t.type&&"undefined"!==typeof ii&&t.codepage&&(r=ii.utils.decode(t.codepage,ii.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Bh.to_sheet("string"==t.type?r:Ao(r),t):s(r,t)}return{to_workbook:function(e,t){return cd(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],a=id(e["!ref"]),n=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){for(var i=[],l=a.s.c;l<=a.e.c;++l){var o=ad({r:s,c:l});if((t=n?(e[s]||[])[l]:e[o])&&null!=t.v){for(var c=(t.w||(od(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===l?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var zh=function(){function e(e,t,r){if(e){qc(e,e.l||0);for(var a=r.Enum||x;e.l<e.length;){var n=e.read_shift(2),s=a[n]||a[65535],i=e.read_shift(2),l=e.l+i,o=s.f&&s.f(e,i,r);if(e.l=l,t(o,s,n))return}}}function t(t,r){if(!t)return t;var a=r||{};var n=a.dense?[]:{},s="Sheet1",i="",l=0,o={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=a.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])a.Enum=x,e(t,function(e,t,r){switch(r){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||Oi[14],a.cellDates&&(e[1].t="d",e[1].v=Ll(e[1].v))),a.qpro&&e[3]>l&&(n["!ref"]=sd(u),o[s]=n,c.push(s),n=a.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s=i||"Sheet"+(l+1),i="");var d=a.dense?(n[e[0].r]||[])[e[0].c]:n[ad(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[ad(e[0])]=e[1]}},a);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);a.Enum=b,14==t[2]&&(a.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(n["!ref"]=sd(u),o[s]=n,c.push(s),n=a.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s="Sheet"+(l+1)),h>0&&e[0].r>=h)break;a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[ad(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==l&&(s=e[1])}},a)}if(n["!ref"]=sd(u),o[i||s]=n,c.push(i||s),!d.length)return{SheetNames:c,Sheets:o};for(var f={},m=[],p=0;p<d.length;++p)o[c[p]]?(m.push(d[p]||c[p]),f[d[p]]=o[d[p]]||o[c[p]]):(m.push(d[p]),f[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function r(e,t,r){var a=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(a[0].c=e.read_shift(1),a[3]=e.read_shift(1),a[0].r=e.read_shift(2),e.l+=2):(a[2]=e.read_shift(1),a[0].c=e.read_shift(2),a[0].r=e.read_shift(2)),a}function a(e,t,a){var n=e.l+t,s=r(e,0,a);if(s[1].t="s",20768==a.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return a.qpro&&e.l++,s[1].v=e.read_shift(n-e.l,"cstr"),s}function n(e,t,r){var a=Wc(7+r.length);a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(1,39);for(var n=0;n<a.length;++n){var s=r.charCodeAt(n);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function s(e,t,r){var a=Wc(7);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r,"i"),a}function i(e,t,r){var a=Wc(13);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(8,r,"f"),a}function l(e,t,r){var a=32768&t;return t=(a?e:0)+((t&=-32769)>=8192?t-16384:t),(a?"":"$")+(r?td(t):Zc(t))}var o={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,r,a){var n=Wc(6+a.length);n.write_shift(2,e),n.write_shift(1,r),n.write_shift(1,t),n.write_shift(1,39);for(var s=0;s<a.length;++s){var i=a.charCodeAt(s);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function h(e,t){var r=d(e),a=e.read_shift(4),n=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===a&&3221225472===n?(r[1].t="e",r[1].v=15):0===a&&3489660928===n?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(n*Math.pow(2,s+32)+a*Math.pow(2,s)),r}function f(e,t,r,a){var n=Wc(14);if(n.write_shift(2,e),n.write_shift(1,r),n.write_shift(1,t),0==a)return n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,65535),n;var s,i=0,l=0,o=0;return a<0&&(i=1,a=-a),l=0|Math.log2(a),0==(2147483648&(o=(a/=Math.pow(2,l-31))>>>0))&&(++l,o=(a/=2)>>>0),a-=o,o|=2147483648,o>>>=0,s=(a*=Math.pow(2,32))>>>0,n.write_shift(4,s),n.write_shift(4,o),l+=16383+(i?32768:0),n.write_shift(2,l),n}function m(e,t){var r=d(e),a=e.read_shift(8,"f");return r[1].v=a,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=Wc(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var a=0;a<e.length;++a){var n=e.charCodeAt(a);r[r.l++]=n>127?95:n}return r[r.l++]=0,r}var x={0:{n:"BOF",f:Bu},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var a={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(a.s.c=e.read_shift(1),e.l++,a.s.r=e.read_shift(2),a.e.c=e.read_shift(1),e.l++,a.e.r=e.read_shift(2),a):(a.s.c=e.read_shift(2),a.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),a.e.c=e.read_shift(2),a.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==a.s.c&&(a.s.c=a.e.c=a.s.r=a.e.r=0),a)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,a){var n=r(e,0,a);return n[1].v=e.read_shift(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,a){var n=r(e,0,a);return n[1].v=e.read_shift(8,"f"),n}},15:{n:"LABEL",f:a},16:{n:"FORMULA",f:function(e,t,a){var n=e.l+t,s=r(e,0,a);if(s[1].v=e.read_shift(8,"f"),a.qpro)e.l=n;else{var i=e.read_shift(2);!function(e,t){qc(e,0);var r=[],a=0,n="",s="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=l(t[0].c,e.read_shift(2),!0),n=l(t[0].r,e.read_shift(2),!1),r.push(s+n);break;case 2:var h=l(t[0].c,e.read_shift(2),!0),f=l(t[0].r,e.read_shift(2),!1);s=l(t[0].c,e.read_shift(2),!0),n=l(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+s+n);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),i=r.pop(),r.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=r.pop(),i=r.pop(),r.push(i+c[u]+d);else{if(!o[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(a=o[u][1])&&(a=e[e.l++]),a>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-a);r.length-=a,r.push(o[u][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:a},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var a="";a.length<r;)a+=String.fromCharCode(e[e.l++]);return a}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var a=r[1].v>>1;if(1&r[1].v)switch(7&a){case 0:a=5e3*(a>>3);break;case 1:a=500*(a>>3);break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64}return r[1].v=a,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},a=e.l+t;e.l<a;){var n=e.read_shift(2);if(14e3==n){for(r[n]=[0,""],r[n][0]=e.read_shift(2);e[e.l];)r[n][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),a=e.read_shift(4);return r[1].v=a>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var a=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[a,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&ri(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var a=Gc(),l=id(e["!ref"]),o=Array.isArray(e),c=[];rx(a,0,function(e){var t=Wc(2);return t.write_shift(2,e),t}(1030)),rx(a,6,function(e){var t=Wc(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(l));for(var d=Math.min(l.e.r,8191),u=l.s.r;u<=d;++u)for(var h=Zc(u),f=l.s.c;f<=l.e.c;++f){u===l.s.r&&(c[f]=td(f));var m=c[f]+h,p=o?(e[u]||[])[f]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?rx(a,13,s(u,f,p.v)):rx(a,14,i(u,f,p.v));else rx(a,15,n(u,f,od(p).slice(0,239)))}return rx(a,1),a.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&ri(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var a=Gc();rx(a,0,function(e){var t=Wc(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,a=0,n=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],l=e.Sheets[i];if(l&&l["!ref"]){++n;var o=nd(l["!ref"]);r<o.e.r&&(r=o.e.r),a<o.e.c&&(a=o.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,n),t.write_shift(1,a),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var n=0,s=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&rx(a,27,g(e.SheetNames[n],s++));var i=0;for(n=0;n<e.SheetNames.length;++n){var l=e.Sheets[e.SheetNames[n]];if(l&&l["!ref"]){for(var o=id(l["!ref"]),c=Array.isArray(l),d=[],h=Math.min(o.e.r,8191),m=o.s.r;m<=h;++m)for(var p=Zc(m),x=o.s.c;x<=o.e.c;++x){m===o.s.r&&(d[x]=td(x));var b=d[x]+p,v=c?(l[m]||[])[x]:l[b];if(v&&"z"!=v.t)if("n"==v.t)rx(a,23,f(m,x,i,v.v));else rx(a,22,u(m,x,i,od(v).slice(0,239)))}++i}}return rx(a,1),a.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(xi(hi(e)),r);case"binary":return t(xi(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var qh=function(){var e=_o("t"),t=_o("rPr");function r(r){var a=r.match(e);if(!a)return{t:"s",v:""};var n={t:"s",v:fo(a[1])},s=r.match(t);return s&&(n.s=function(e){var t={},r=e.match(so),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=oo(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=ei[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==s[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),n}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(e){return e.replace(a,"").split(n).map(r).filter(function(e){return e.v})}}(),Hh=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var a=[];e.u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),t.push('<span style="'+a.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var n=e.valign||"";"superscript"==n||"super"==n?n="sup":"subscript"==n&&(n="sub"),""!=n&&(t.push("<"+n+">"),r.push("</"+n+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Wh=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Vh=/<(?:\w+:)?r>/,Gh=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kh(e,t){var r=!t||t.cellHTML,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=fo(Ao(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ao(e),r&&(a.h=vo(a.t))):e.match(Vh)&&(a.r=Ao(e),a.t=fo(Ao((e.replace(Gh,"").match(Wh)||[]).join("").replace(so,""))),r&&(a.h=Hh(qh(a.r)))),a):{t:""}}var Yh=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Xh=/<(?:\w+:)?(?:si|sstItem)>/g,$h=/<\/(?:\w+:)?(?:si|sstItem)>/;var Jh=/^\s|\s$|[\t\n\r]/;function Qh(e,t){if(!t.bookSST)return"";var r=[ro];r[r.length]=Ro("sst",null,{xmlns:ec[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(null!=e[a]){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(Jh)&&(s+=' xml:space="preserve"'),s+=">"+go(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var Zh=function(e,t){var r=!1;return null==t&&(r=!0,t=Wc(15+4*e.t.length)),t.write_shift(1,0),md(e.t,t),r?t.slice(0,t.l):t};function ef(e){var t=Gc();Kc(t,159,function(e,t){return t||(t=Wc(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Kc(t,19,Zh(e[r]));return Kc(t,160),t.end()}function tf(e){if("undefined"!==typeof ii)return ii.utils.encode(Qs,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function rf(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function af(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function nf(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=rf(e,4),t.U=rf(e,4),t.W=rf(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function sf(e,t){var r=e.l+t,a={};a.Flags=63&e.read_shift(4),e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=36==a.Flags;break;case 26625:n=4==a.Flags;break;case 0:n=16==a.Flags||4==a.Flags||36==a.Flags;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function lf(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function of(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:sf(e,t),v:lf(e,e.length-e.l)}}function cf(){throw new Error("File is password-protected: ECMA-376 Extensible")}function df(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(so,function(e){var r=oo(e);switch(co(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){a[e]=r[e]});break;case"<dataIntegrity":a.encryptedHmacKey=r.encryptedHmacKey,a.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"<keyEncryptor":a.uri=r.uri;break;case"<encryptedKey":a.encs.push(r);break;default:throw r[0]}}),a}function uf(e){var t,r,a=0,n=tf(e),s=n.length+1;for((t=pi(s))[0]=n.length,r=1;r!=s;++r)t[r]=n[r-1];for(r=s-1;r>=0;--r)a=((0===(16384&a)?0:1)|a<<1&32767)^t[r];return 52811^a}var hf=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(n){for(var s,i,l,o=tf(n),c=function(e){for(var a=t[e.length-1],n=104,s=e.length-1;s>=0;--s)for(var i=e[s],l=0;7!=l;++l)64&i&&(a^=r[n]),i*=2,--n;return a}(o),d=o.length,u=pi(16),h=0;16!=h;++h)u[h]=0;for(1===(1&d)&&(s=c>>8,u[d]=a(e[0],s),--d,s=255&c,i=o[o.length-1],u[d]=a(i,s));d>0;)s=c>>8,u[--d]=a(o[d],s),s=255&c,u[--d]=a(o[d],s);for(d=15,l=15-o.length;l>0;)s=c>>8,u[d]=a(e[l],s),--l,s=255&c,u[--d]=a(o[d],s),--d,--l;return u}}(),ff=function(e){var t=0,r=hf(e);return function(e){var a=function(e,t,r,a,n){var s,i;for(n||(n=t),a||(a=hf(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=a[r])>>5|i<<3),n[s]=i,++r;return[n,r,a]}("",e,t,r);return t=a[1],a[0]}};function mf(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,1===a.Info?a.Data=function(e){var t={},r=t.EncryptionVersionInfo=rf(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):a.Data=function(e,t){var r={},a=r.EncryptionVersionInfo=rf(e,4);if(t-=4,2!=a.Minor)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=sf(e,n),t-=n,r.EncryptionVerifier=lf(e,t),r}(e,t),a}var pf=function(){function e(e,r){switch(r.type){case"base64":return t(hi(e),r);case"binary":return t(e,r);case"buffer":return t(fi&&Buffer.isBuffer(e)?e.toString("binary"):vi(e),r);case"array":return t(Rl(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},a=e.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var a,s=/\\\w+\b/g,i=0,l=-1;a=s.exec(e);){if("\\cell"===a[0]){var o=e.slice(i,s.lastIndex-a[0].length);if(" "==o[0]&&(o=o.slice(1)),++l,o.length){var c={v:o,t:"s"};Array.isArray(r)?r[t][l]=c:r[ad({r:t,c:l})]=c}}i=s.lastIndex}l>n.e.c&&(n.e.c=l)}),r["!ref"]=sd(n),r}return{to_workbook:function(t,r){return cd(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],a=id(e["!ref"]),n=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){r.push("\\trowd\\trautofit1");for(var i=a.s.c;i<=a.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=a.s.c;i<=a.e.c;++i){var l=ad({r:s,c:i});(t=n?(e[s]||[])[i]:e[l])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(od(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function gf(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xf(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),i=n-s;if(0===i)return[0,0,t];var l,o=0,c=n+s;switch(l=i/(c>1?2-c:c),n){case t:o=((r-a)/i+6)%6;break;case r:o=(a-t)/i+2;break;case a:o=(t-r)/i+4}return[o/6,l,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),gf(function(e){var t,r=e[0],a=e[1],n=e[2],s=2*a*(n<.5?n:1-n),i=n-s/2,l=[i,i,i],o=6*r;if(0!==a)switch(0|o){case 0:case 6:t=s*o,l[0]+=s,l[1]+=t;break;case 1:t=s*(2-o),l[0]+=t,l[1]+=s;break;case 2:t=s*(o-2),l[1]+=s,l[2]+=t;break;case 3:t=s*(4-o),l[1]+=t,l[2]+=s;break;case 4:t=s*(o-4),l[2]+=s,l[0]+=t;break;case 5:t=s*(6-o),l[2]+=t,l[0]+=s}for(var c=0;3!=c;++c)l[c]=Math.round(255*l[c]);return l}(r))}var bf=6;function vf(e){return Math.floor((e+Math.round(128/bf)/256)*bf)}function yf(e){return Math.floor((e-5)/bf*100+.5)/100}function wf(e){return Math.round((e*bf+5)/bf*256)/256}function Nf(e){return wf(yf(vf(e)))}function jf(e){var t=Math.abs(e-Nf(e)),r=bf;if(t>.005)for(bf=1;bf<15;++bf)Math.abs(e-Nf(e))<=t&&(t=Math.abs(e-Nf(e)),r=bf);bf=r}function kf(e){e.width?(e.wpx=vf(e.width),e.wch=yf(e.wpx),e.MDW=bf):e.wpx?(e.wch=yf(e.wpx),e.width=wf(e.wch),e.MDW=bf):"number"==typeof e.wch&&(e.width=wf(e.wch),e.wpx=vf(e.width),e.MDW=bf),e.customWidth&&delete e.customWidth}var Sf=96;function Af(e){return 96*e/Sf}function Cf(e){return e*Sf/96}var _f={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Tf=["numFmtId","fillId","fontId","borderId","xfId"],Ef=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Lf=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,l){var o,c={};return s?((o=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var a=Nl(Oi),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Oi[a[n]];var s=e[0].match(so);if(s)for(n=0;n<s.length;++n){var i=oo(s[n]);switch(co(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=fo(Ao(i.formatCode)),o=parseInt(i.numFmtId,10);if(t.NumberFmt[o]=l,o>0){if(o>392){for(o=392;o>60&&null!=t.NumberFmt[o];--o);t.NumberFmt[o]=l}hl(l,o)}break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(o,c,l),(o=s.match(a))&&function(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(so)||[]).forEach(function(e){var i=oo(e);switch(co(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":i.val&&(n.name=Ao(i.val));break;case"<b":n.bold=i.val?wo(i.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=i.val?wo(i.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(i.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=i.val?wo(i.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=i.val?wo(i.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=i.val?wo(i.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=i.val?wo(i.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=i.val?wo(i.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":i.val&&(n.sz=+i.val);break;case"<vertAlign":i.val&&(n.vertAlign=i.val);break;case"<family":i.val&&(n.family=parseInt(i.val,10));break;case"<scheme":i.val&&(n.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=ei[parseInt(i.val,10)];break;case"<color":if(n.color||(n.color={}),i.auto&&(n.color.auto=wo(i.auto)),i.rgb)n.color.rgb=i.rgb.slice(-6);else if(i.indexed){n.color.index=parseInt(i.indexed,10);var l=Gd[n.color.index];81==n.color.index&&(l=Gd[1]),l||(l=Gd[1]),n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else i.theme&&(n.color.theme=parseInt(i.theme,10),i.tint&&(n.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=xf(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(o,c,i,l),(o=s.match(r))&&function(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(so)||[]).forEach(function(e){var r=oo(e);switch(co(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":r.patternType&&(n.patternType=r.patternType);break;case"<bgColor":n.bgColor||(n.bgColor={}),r.indexed&&(n.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(n.bgColor.theme=parseInt(r.theme,10)),r.tint&&(n.bgColor.tint=parseFloat(r.tint)),r.rgb&&(n.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":n.fgColor||(n.fgColor={}),r.theme&&(n.fgColor.theme=parseInt(r.theme,10)),r.tint&&(n.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(n.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}})}(o,c,0,l),(o=s.match(n))&&function(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(so)||[]).forEach(function(e){var r=oo(e);switch(co(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":n={},r.diagonalUp&&(n.diagonalUp=wo(r.diagonalUp)),r.diagonalDown&&(n.diagonalDown=wo(r.diagonalDown)),t.Borders.push(n);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}})}(o,c,0,l),(o=s.match(t))&&function(e,t,r){var a;t.CellXf=[];var n=!1;(e[0].match(so)||[]).forEach(function(e){var s=oo(e),i=0;switch(co(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(a=s)[0],i=0;i<Tf.length;++i)a[Tf[i]]&&(a[Tf[i]]=parseInt(a[Tf[i]],10));for(i=0;i<Ef.length;++i)a[Ef[i]]&&(a[Ef[i]]=wo(a[Ef[i]]));if(t.NumberFmt&&a.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[i]){a.numFmtId=i;break}t.CellXf.push(a);break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),null!=s.textRotation&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=wo(s.wrapText)),a.alignment=l;break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(o,c,l),c):c}}();function Pf(e,t){var r,a=[ro,Ro("styleSheet",null,{xmlns:ec[0],"xmlns:vt":Jo})];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=e[a]&&(t[t.length]=Ro("numFmt",null,{numFmtId:a,formatCode:go(e[a])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Ro("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(a[a.length]=r),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=Ro("cellXfs",null),e.forEach(function(e){t[t.length]=Ro("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Ro("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(a[a.length]=r),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Of(e,t,r){r||(r=Wc(6+4*t.length)),r.write_shift(2,e),md(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),a}function Ff(e,t){t||(t=Wc(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Wc(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Rd(e.color,t);var a=0;return"major"==e.scheme&&(a=1),"minor"==e.scheme&&(a=2),t.write_shift(1,a),md(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Df,If=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rf=Hc;function Mf(e,t){t||(t=Wc(84)),Df||(Df=kl(If));var r=Df[e.patternType];null==r&&(r=40),t.write_shift(4,r);var a=0;if(40!=r)for(Rd({auto:1},t),Rd({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Bf(e,t,r){r||(r=Wc(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Uf(e,t){return t||(t=Wc(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var zf=Hc;function qf(e){Kc(e,613,hd(1)),Kc(e,46,function(e,t){return t||(t=Wc(51)),t.write_shift(1,0),Uf(0,t),Uf(0,t),Uf(0,t),Uf(0,t),Uf(0,t),t.length>t.l?t.slice(0,t.l):t}()),Kc(e,614)}function Hf(e){Kc(e,619,hd(1)),Kc(e,48,function(e,t){return t||(t=Wc(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Ad(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),Kc(e,620)}function Wf(e){Kc(e,508,function(e,t,r){var a=Wc(2052);return a.write_shift(4,e),Ad(t,a),Ad(r,a),a.length>a.l?a.slice(0,a.l):a}(0,"TableStyleMedium9","PivotStyleMedium4")),Kc(e,509)}function Vf(e,t){var r=Gc();return Kc(r,278),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var a=e[0];a<=e[1];++a)null!=t[a]&&++r}),0!=r&&(Kc(e,615,hd(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&Kc(e,44,Of(a,t[a]))}),Kc(e,616))}}(r,e.SSF),function(e){Kc(e,611,hd(1)),Kc(e,43,Ff({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Kc(e,612)}(r),function(e){Kc(e,603,hd(2)),Kc(e,45,Mf({patternType:"none"})),Kc(e,45,Mf({patternType:"gray125"})),Kc(e,604)}(r),qf(r),function(e){Kc(e,626,hd(1)),Kc(e,47,Bf({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Kc(e,627)}(r),function(e,t){Kc(e,617,hd(t.length)),t.forEach(function(t){Kc(e,47,Bf(t,0))}),Kc(e,618)}(r,t.cellXfs),Hf(r),function(e){Kc(e,505,hd(0)),Kc(e,506)}(r),Wf(r),Kc(r,279),r.end()}var Gf=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Kf(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(so)||[]).forEach(function(e){var n=oo(e);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===n[0].charAt(1)?(t.themeElements.clrScheme[Gf.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function Yf(){}function Xf(){}var $f=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Jf=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Qf=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Zf=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function em(e,t){var r;e&&0!==e.length||(e=tm());var a={};if(!(r=e.match(Zf)))throw new Error("themeElements not found in theme");return function(e,t,r){var a;t.themeElements={},[["clrScheme",$f,Kf],["fontScheme",Jf,Yf],["fmtScheme",Qf,Xf]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}(r[0],a,t),a.raw=e,a}function tm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[ro];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rm(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Hc(e,t)}(e,4);break;case 2:t.xclrValue=eh(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function am(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=rm(e);break;case 6:a[1]=function(e,t){return Hc(e,t)}(e,r);break;case 14:case 15:a[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function nm(e,t){t.forEach(function(e){e[0]})}function sm(){var e=Gc();return Kc(e,332),Kc(e,334,hd(1)),Kc(e,335,function(e){var t=Wc(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),md(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Kc(e,336),Kc(e,339,function(e,t){var r=Wc(8+2*t.length);return r.write_shift(4,e),md(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Kc(e,52),Kc(e,35,hd(514)),Kc(e,4096,hd(0)),Kc(e,4097,Uu(1)),Kc(e,36),Kc(e,53),Kc(e,340),Kc(e,337,function(e,t){var r=Wc(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Kc(e,51,function(e){var t=Wc(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Kc(e,338),Kc(e,333),e.end()}function im(){var e=[ro];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var lm=1024;function om(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Ro("xml",null,{"xmlns:v":ic,"xmlns:o":tc,"xmlns:x":rc,"xmlns:mv":sc}).replace(/\/>/,">"),Ro("o:shapelayout",Ro("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ro("v:shapetype",[Ro("v:stroke",null,{joinstyle:"miter"}),Ro("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];lm<1e3*e;)lm+=1e3;return t.forEach(function(e){var t=rd(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var a="gradient"==r.type?Ro("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Ro("v:fill",a,r);++lm,n=n.concat(["<v:shape"+Io({id:"_x0000_s"+lm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Ro("v:shadow",null,{on:"t",obscured:"t"}),Ro("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Do("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Do("x:AutoFill","False"),Do("x:Row",String(t.r)),Do("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function cm(e,t,r,a){var n,s=Array.isArray(e);t.forEach(function(t){var i=rd(t.ref);if(s?(e[i.r]||(e[i.r]=[]),n=e[i.r][i.c]):n=e[t.ref],!n){n={t:"z"},s?e[i.r][i.c]=n:e[t.ref]=n;var l=id(e["!ref"]||"BDWGO1000001:A1");l.s.r>i.r&&(l.s.r=i.r),l.e.r<i.r&&(l.e.r=i.r),l.s.c>i.c&&(l.s.c=i.c),l.e.c<i.c&&(l.e.c=i.c);var o=sd(l);o!==e["!ref"]&&(e["!ref"]=o)}n.c||(n.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=n.c.length-1;d>=0;--d){if(!r&&n.c[d].T)return;r&&!n.c[d].T&&n.c.splice(d,1)}if(r&&a)for(d=0;d<a.length;++d)if(c.a==a[d].id){c.a=a[d].name||c.a;break}n.c.push(c)})}function dm(e){var t=[ro,Ro("comments",null,{xmlns:ec[0]})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var a=go(e.a);-1==r.indexOf(a)&&(r.push(a),t.push("<author>"+a+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var a=0,n=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?a=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(a=r.indexOf(go(e.a))),n.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+a+'"><text>'),n.length<=1)t.push(Do("t",go(n[0]||"")));else{for(var s="Comment:\n    "+n[0]+"\n",i=1;i<n.length;++i)s+="Reply:\n    "+n[i]+"\n";t.push(Do("t",go(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function um(e,t,r){var a=[ro,Ro("ThreadedComments",null,{xmlns:Go}).replace(/[\/]>/,">")];return e.forEach(function(e){var n="";(e[1]||[]).forEach(function(s,i){if(s.T){s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var l={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?n=l.id:l.parentId=n,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),a.push(Ro("threadedComment",Do("text",s.t||""),l))}else delete s.ID})}),a.push("</ThreadedComments>"),a.join("")}var hm=fd;function fm(e){var t=Gc(),r=[];return Kc(t,628),Kc(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Kc(t,632,function(e){return md(e.slice(0,54))}(e.a)))})}),Kc(t,631),Kc(t,633),e.forEach(function(e){e[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var n={s:rd(e[0]),e:rd(e[0])};Kc(t,635,function(e,t){return null==t&&(t=Wc(36)),t.write_shift(4,e[1].iauthor),Fd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([n,a])),a.t&&a.t.length>0&&Kc(t,637,bd(a)),Kc(t,636),delete a.iauthor})}),Kc(t,634),Kc(t,629),t.end()}var mm=["xlsb","xlsm","xlam","biff8","xla"];var pm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,a,n){var s=!1,i=!1;0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1)),0==n.length?s=!0:"["==n.charAt(0)&&(s=!0,n=n.slice(1,-1));var l=a.length>0?0|parseInt(a,10):0,o=n.length>0?0|parseInt(n,10):0;return s?o+=t.c:--o,i?l+=t.r:--l,r+(s?"":"$")+td(o)+(i?"":"$")+Zc(l)}return function(a,n){return t=n,a.replace(e,r)}}(),gm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xm=function(){return function(e,t){return e.replace(gm,function(e,r,a,n,s,i){var l=ed(n)-(a?0:t.c),o=Qc(i)-(s?0:t.r);return r+"R"+(0==o?"":s?o+1:"["+o+"]")+"C"+(0==l?"":a?l+1:"["+l+"]")})}}();function bm(e,t){return e.replace(gm,function(e,r,a,n,s,i){return r+("$"==a?a+n:td(ed(n)+t.c))+("$"==s?s+i:Zc(Qc(i)+t.r))})}function vm(e,t,r){var a=nd(t).s,n=rd(r);return bm(e,{r:n.r-a.r,c:n.c-a.c})}function ym(e){return e.replace(/_xlfn\./g,"")}function wm(e){e.l+=1}function Nm(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function jm(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return km(e);12==r.biff&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=Nm(e,2),l=Nm(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function km(e){var t=Nm(e,2),r=Nm(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Sm(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=Nm(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var a=e.read_shift(r&&12==r.biff?4:2),n=Nm(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Am(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function Cm(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function _m(e){return[e.read_shift(1),e.read_shift(1)]}function Tm(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Ru(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Kd[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dd(e);break;case 2:r[1]=Yu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Em(e,t,r){for(var a=e.read_shift(12==r.biff?4:2),n=[],s=0;s!=a;++s)n.push((12==r.biff?Od:ih)(e,8));return n}function Lm(e,t,r){var a=0,n=0;12==r.biff?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,0==--n&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var l=0;l!=n;++l)i[s][l]=Tm(e,r.biff);return i}function Pm(e,t,r){return e.l+=2,[Am(e)]}function Om(e){return e.l+=6,[]}function Fm(e){return e.l+=2,[Bu(e),1&e.read_shift(2)]}var Dm=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Im={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Hc},3:{n:"PtgAdd",f:wm},4:{n:"PtgSub",f:wm},5:{n:"PtgMul",f:wm},6:{n:"PtgDiv",f:wm},7:{n:"PtgPower",f:wm},8:{n:"PtgConcat",f:wm},9:{n:"PtgLt",f:wm},10:{n:"PtgLe",f:wm},11:{n:"PtgEq",f:wm},12:{n:"PtgGe",f:wm},13:{n:"PtgGt",f:wm},14:{n:"PtgNe",f:wm},15:{n:"PtgIsect",f:wm},16:{n:"PtgUnion",f:wm},17:{n:"PtgRange",f:wm},18:{n:"PtgUplus",f:wm},19:{n:"PtgUminus",f:wm},20:{n:"PtgPercent",f:wm},21:{n:"PtgParen",f:wm},22:{n:"PtgMissArg",f:wm},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Hu(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Kd[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Dd(e)}},32:{n:"PtgArray",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[a]}},33:{n:"PtgFunc",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[np[n],ap[n],a]}},34:{n:"PtgFuncVar",f:function(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[88==a?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[n,(0===s[0]?ap:rp)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,Sm(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,jm(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[a,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Hc},40:{n:"PtgMemNoMem",f:Hc},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[a]}},43:{n:"PtgAreaErr",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}},44:{n:"PtgRefN",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=function(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),a=(32768&t)>>15,n=(16384&t)>>14;return t&=16383,1==a&&t>=8192&&(t-=16384),1==n&&r>=128&&(r-=256),{r:t,c:r,cRel:n,rRel:a}}(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,l=(32768&s)>>15;if(s&=16383,1==l)for(;n>524287;)n-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:n,c:s,cRel:i,rRel:l}}(e,0,r);return[a,n]}},45:{n:"PtgAreaN",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=function(e,t,r){if(r.biff<8)return km(e);var a=e.read_shift(12==r.biff?4:2),n=e.read_shift(12==r.biff?4:2),s=Nm(e,2),i=Nm(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[a,n]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[a,n,Sm(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[a,n,jm(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[a,n]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[a,n]}},255:{}},Rm={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Mm={1:{n:"PtgElfLel",f:Fm},2:{n:"PtgElfRw",f:Pm},3:{n:"PtgElfCol",f:Pm},6:{n:"PtgElfRwV",f:Pm},7:{n:"PtgElfColV",f:Pm},10:{n:"PtgElfRadical",f:Pm},11:{n:"PtgElfRadicalS",f:Om},13:{n:"PtgElfColS",f:Om},15:{n:"PtgElfColSV",f:Om},16:{n:"PtgElfRadicalLel",f:Fm},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:Dm[r>>2&31],idx:a,c:n,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Bm={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[a]}},2:{n:"PtgAttrIf",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var a=e.read_shift(r&&2==r.biff?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&2==r.biff?1:2));return n}},8:{n:"PtgAttrGoto",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Cm},33:{n:"PtgAttrBaxcel",f:Cm},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),_m(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),_m(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Um(e,t,r,a){if(a.biff<8)return Hc(e,t);for(var n=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Lm(e,0,a),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Em(e,r[i][1],a),s.push(r[i][2]);break;case"PtgExp":a&&12==a.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=n-e.l)&&s.push(Hc(e,t)),s}function zm(e,t,r){for(var a,n,s=e.l+t,i=[];s!=e.l;)t=s-e.l,n=e[e.l],a=Im[n]||Im[Rm[n]],24!==n&&25!==n||(a=(24===n?Mm:Bm)[e[e.l+1]]),a&&a.f?i.push([a.n,a.f(e,t,r)]):Hc(e,t);return i}function qm(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];if(i)if(2===i[0])n.push('"'+i[1].replace(/"/g,'""')+'"');else n.push(i[1]);else n.push("")}t.push(n.join(","))}return t.join(";")}var Hm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Wm(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[a[0]][0][3]?(n=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Vm(e,t,r){var a=Wm(e,t,r);return"#REF"==a?a:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(a,r)}function Gm(e,t,r,a,n){var s,i,l,o,c=n&&n.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,b=e[0].length;x<b;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Bl(" ",e[0][p][1][1]);break;case 1:g=Bl("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}u.push(i+Hm[v[0]]+s);break;case"PtgIsect":s=u.pop(),i=u.pop(),u.push(i+" "+s);break;case"PtgUnion":s=u.pop(),i=u.pop(),u.push(i+","+s);break;case"PtgRange":s=u.pop(),i=u.pop(),u.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":l=Yc(v[1][1],d,n),u.push($c(l,c));break;case"PtgRefN":l=r?Yc(v[1][1],r,n):v[1][1],u.push($c(l,c));break;case"PtgRef3d":h=v[1][1],l=Yc(v[1][2],d,n);m=Vm(a,h,n);u.push(m+"!"+$c(l,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],w=v[1][1];y||(y=0);var N=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=N.shift()),u.push(w+"("+N.join(",")+")");break;case"PtgBool":u.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(v[1]);break;case"PtgNum":u.push(String(v[1]));break;case"PtgStr":u.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":o=Xc(v[1][1],r?{s:r}:d,n),u.push(Jc(o,n));break;case"PtgArea":o=Xc(v[1][1],d,n),u.push(Jc(o,n));break;case"PtgArea3d":h=v[1][1],o=v[1][2],m=Vm(a,h,n),u.push(m+"!"+Jc(o,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=v[1][2];var j=(a.names||[])[f-1]||(a[0]||[])[f],k=j?j.Name:"SH33TJSNAME"+String(f);k&&"_xlfn."==k.slice(0,6)&&!n.xlfn&&(k=k.slice(6)),u.push(k);break;case"PtgNameX":var S,A=v[1][1];if(f=v[1][2],!(n.biff<=5)){var C="";if(14849==((a[A]||[])[0]||[])[0]||(1025==((a[A]||[])[0]||[])[0]?a[A][f]&&a[A][f].itab>0&&(C=a.SheetNames[a[A][f].itab-1]+"!"):C=a.SheetNames[f-1]+"!"),a[A]&&a[A][f])C+=a[A][f].Name;else if(a[0]&&a[0][f])C+=a[0][f].Name;else{var _=(Wm(a,A,n)||"").split(";;");_[f-1]?C=_[f-1]:C+="SH33TJSERRX"}u.push(C);break}A<0&&(A=-A),a[A]&&(S=a[A][f]),S||(S={Name:"SH33TJSERRY"}),u.push(S.Name);break;case"PtgParen":var T="(",E=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:T=Bl(" ",e[0][p][1][1])+T;break;case 3:T=Bl("\r",e[0][p][1][1])+T;break;case 4:E=Bl(" ",e[0][p][1][1])+E;break;case 5:E=Bl("\r",e[0][p][1][1])+E;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(T+u.pop()+E);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":l={c:v[1][1],r:v[1][0]};var L={c:r.c,r:r.r};if(a.sharedf[ad(l)]){var P=a.sharedf[ad(l)];u.push(Gm(P,d,L,a,n))}else{var O=!1;for(s=0;s!=a.arrayf.length;++s)if(i=a.arrayf[s],!(l.c<i[0].s.c||l.c>i[0].e.c)&&!(l.r<i[0].s.r||l.r>i[0].e.r)){u.push(Gm(i[1],d,L,a,n)),O=!0;break}O||u.push(v[1])}break;case"PtgArray":u.push("{"+qm(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=n.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var F=!0;switch((v=e[0][p])[1][0]){case 4:F=!1;case 0:g=Bl(" ",v[1][1]);break;case 5:F=!1;case 1:g=Bl("\r",v[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}u.push((F?g:"")+u.pop()+(F?"":g)),p=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function Km(e,t,r){var a,n=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Hc(e,t-2)];var l=zm(e,i,r);return t!==i+s&&(a=Um(e,t-i-s,l,r)),e.l=n,[l,a]}function Ym(e,t,r){var a,n=e.l+t,s=e.read_shift(2),i=zm(e,s,r);return 65535==s?[[],Hc(e,t-2)]:(t!==s+2&&(a=Um(e,n-s-2,i,r)),[i,a])}function Xm(e,t,r){var a=e.l+t,n=rh(e);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==Lc(e,e.l+6))return[Dd(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=function(e,t,r){var a,n=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Hc(e,t-2)];var l=zm(e,i,r);return t!==i+s&&(a=Um(e,t-i-s,l,r)),e.l=n,[l,a]}(e,a-e.l,r);return{cell:n,val:s[0],formula:l,shared:i>>3&1,tt:s[1]}}function $m(e,t,r,a,n){var s=ah(t,r,n),i=function(e){if(null==e){var t=Wc(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Id("number"==typeof e?e:0)}(e.v),l=Wc(6);l.write_shift(2,33),l.write_shift(4,0);for(var o=Wc(e.bf.length),c=0;c<e.bf.length;++c)o[c]=e.bf[c];return wi([s,i,l,o])}function Jm(e,t,r){var a=e.read_shift(4),n=zm(e,a,r),s=e.read_shift(4);return[n,s>0?Um(e,s,n,r):null]}var Qm=Jm,Zm=Jm,ep=Jm,tp=Jm,rp={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ap={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},np={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sp(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ip(e){return("of:="+e.replace(gm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function lp(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function op(e){return e.replace(/\./,"!")}var cp={},dp={},up="undefined"!==typeof Map;function hp(e,t,r){var a=0,n=e.length;if(r){if(up?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var s=up?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t:t},e.Count++,e.Unique++,r&&(up?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function fp(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(bf=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?a=yf(t.wpx):null!=t.wch&&(a=t.wch),a>-1?(r.width=wf(a),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function mp(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function pp(e,t,r){var a=r.revssf[null!=t.z?t.z:"General"],n=60,s=e.length;if(null==a&&r.ssf)for(;n<392;++n)if(null==r.ssf[n]){hl(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function gp(e,t,r,a,n,s){try{a.cellNF&&(e.z=Oi[t])}catch(mT){if(a.WTF)throw mT}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Il(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==Oi[t]&&hl(pl[t]||"General",t),"e"===e.t)e.w=e.w||Kd[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Hi(e.v);else if("d"===e.t){var i=Cl(e.v);e.w=(0|i)===i?i.toString(10):Hi(i)}else{if(void 0===e.v)return"";e.w=Wi(e.v,dp)}else"d"===e.t?e.w=ul(t,Cl(e.v),dp):e.w=ul(t,e.v,dp)}catch(mT){if(a.WTF)throw mT}if(a.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=xf(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=xf(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(mT){if(a.WTF&&s.Fills)throw mT}}}function xp(e,t,r){if(e&&e["!ref"]){var a=id(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var bp=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,vp=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,yp=/<(?:\w:)?hyperlink [^>]*>/gm,wp=/"(\w*:\w*)"/,Np=/<(?:\w:)?col\b[^>]*[\/]?>/g,jp=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,kp=/<(?:\w:)?pageMargins[^>]*\/>/g,Sp=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ap=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Cp=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _p(e,t,r,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(vp);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var h=c.match(Sp);h?Tp(h[0],l,n,r):(h=c.match(Ap))&&function(e,t,r,a,n){Tp(e.slice(0,e.indexOf(">")),r,a,n)}(h[0],h[1],l,n,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(wp);m&&function(e,t){var r=id(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=sd(r))}(l,m[1])}var p=c.match(Cp);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Pp)||[]).forEach(function(e,r){var a=oo(e);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),wo(a.rightToLeft)&&(t.Views[r].RTL=!0)})}(p[1],n);var g=[];if(t.cellStyles){var x=c.match(Np);x&&function(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=oo(t[a],!0);n.hidden&&(n.hidden=wo(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,jf(n.width)),kf(n);s<=i;)e[s++]=Ml(n)}}(g,x)}u&&Fp(u[1],l,t,o,s,i);var b=d.match(jp);b&&(l["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(b[0]));var v=[],y=d.match(bp);if(y)for(f=0;f!=y.length;++f)v[f]=id(y[f].slice(y[f].indexOf('"')+1));var w=d.match(yp);w&&function(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=oo(Ao(t[n]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+fo(s.location))):(s.Target="#"+fo(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=id(s.ref),o=l.s.r;o<=l.e.r;++o)for(var c=l.s.c;c<=l.e.c;++c){var d=ad({c:c,r:o});a?(e[o]||(e[o]=[]),e[o][c]||(e[o][c]={t:"z",v:void 0}),e[o][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}(l,w,a);var N=d.match(kp);if(N&&(l["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}(oo(N[0]))),!l["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(l["!ref"]=sd(o)),t.sheetRows>0&&l["!ref"]){var j=id(l["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>o.e.r&&(j.e.r=o.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>o.e.c&&(j.e.c=o.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),l["!fullref"]=l["!ref"],l["!ref"]=sd(j))}return g.length>0&&(l["!cols"]=g),v.length>0&&(l["!merges"]=v),l}function Tp(e,t,r,a){var n=oo(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=fo(Ao(n.codeName)))}var Ep=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Lp=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Pp=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Op(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var n="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Kd[e.v];break;case"d":a&&a.cellDates?n=Il(e.v,-1).toISOString():((e=Ml(e)).t="n",n=""+(e.v=Cl(Il(e.v)))),"undefined"===typeof e.z&&(e.z=Oi[14]);break;default:n=e.v}var l=Do("v",go(n)),o={r:t},c=pp(a.cellXfs,e,a);switch(0!==c&&(o.s=c),e.t){case"n":case"z":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=Do("v",""+hp(a.Strings,e.v,a.revStrings)),o.t="s";break}o.t="str"}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ro("f",go(e.f),d)+(null!=e.v?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),Ro("c",l,o)}var Fp=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=_o("v"),i=_o("f");return function(l,o,c,d,u,h){for(var f,m,p,g,x,b=0,v="",y=[],w=[],N=0,j=0,k=0,S="",A=0,C=0,_=0,T=0,E=Array.isArray(h.CellXf),L=[],P=[],O=Array.isArray(o),F=[],D={},I=!1,R=!!c.sheetStubs,M=l.split(t),B=0,U=M.length;B!=U;++B){var z=(v=M[B].trim()).length;if(0!==z){var q=0;e:for(b=0;b<z;++b)switch(v[b]){case">":if("/"!=v[b-1]){++b;break e}if(c&&c.cellStyles){if(A=null!=(m=oo(v.slice(q,b),!0)).r?parseInt(m.r,10):A+1,C=-1,c.sheetRows&&c.sheetRows<A)continue;D={},I=!1,m.ht&&(I=!0,D.hpt=parseFloat(m.ht),D.hpx=Cf(D.hpt)),"1"==m.hidden&&(I=!0,D.hidden=!0),null!=m.outlineLevel&&(I=!0,D.level=+m.outlineLevel),I&&(F[A-1]=D)}break;case"<":q=b}if(q>=b)break;if(A=null!=(m=oo(v.slice(q,b),!0)).r?parseInt(m.r,10):A+1,C=-1,!(c.sheetRows&&c.sheetRows<A)){d.s.r>A-1&&(d.s.r=A-1),d.e.r<A-1&&(d.e.r=A-1),c&&c.cellStyles&&(D={},I=!1,m.ht&&(I=!0,D.hpt=parseFloat(m.ht),D.hpx=Cf(D.hpt)),"1"==m.hidden&&(I=!0,D.hidden=!0),null!=m.outlineLevel&&(I=!0,D.level=+m.outlineLevel),I&&(F[A-1]=D)),y=v.slice(b).split(e);for(var H=0;H!=y.length&&"<"==y[H].trim().charAt(0);++H);for(y=y.slice(H),b=0;b!=y.length;++b)if(0!==(v=y[b].trim()).length){if(w=v.match(r),N=b,j=0,k=0,v="<c "+("<"==v.slice(0,1)?">":"")+v,null!=w&&2===w.length){for(N=0,S=w[1],j=0;j!=S.length&&!((k=S.charCodeAt(j)-64)<1||k>26);++j)N=26*N+k;C=--N}else++C;for(j=0;j!=v.length&&62!==v.charCodeAt(j);++j);if(++j,(m=oo(v.slice(0,j),!0)).r||(m.r=ad({r:A-1,c:C})),f={t:""},null!=(w=(S=v.slice(j)).match(s))&&""!==w[1]&&(f.v=fo(w[1])),c.cellFormula){if(null!=(w=S.match(i))&&""!==w[1]){if(f.f=fo(Ao(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=ym(f.f)),w[0].indexOf('t="array"')>-1)f.F=(S.match(n)||[])[1],f.F.indexOf(":")>-1&&L.push([id(f.F),f.F]);else if(w[0].indexOf('t="shared"')>-1){g=oo(w[0]);var W=fo(Ao(w[1]));c.xlfn||(W=ym(W)),P[parseInt(g.si,10)]=[g,W,m.r]}}else(w=S.match(/<f[^>]*\/>/))&&P[(g=oo(w[0])).si]&&(f.f=vm(P[g.si][1],P[g.si][2],m.r));var V=rd(m.r);for(j=0;j<L.length;++j)V.r>=L[j][0].s.r&&V.r<=L[j][0].e.r&&V.c>=L[j][0].s.c&&V.c<=L[j][0].e.c&&(f.F=L[j][1])}if(null==m.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!R)continue;f.t="z"}else f.t=m.t||"n";switch(d.s.c>C&&(d.s.c=C),d.e.c<C&&(d.e.c=C),f.t){case"n":if(""==f.v||null==f.v){if(!R)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!R)continue;f.t="z"}else p=cp[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?Ao(f.v):"",c.cellHTML&&(f.h=vo(f.v));break;case"inlineStr":w=S.match(a),f.t="s",null!=w&&(p=Kh(w[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=wo(f.v);break;case"d":c.cellDates?f.v=Il(f.v,1):(f.v=Cl(Il(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=Yd[f.v]}if(_=T=0,x=null,E&&void 0!==m.s&&null!=(x=h.CellXf[m.s])&&(null!=x.numFmtId&&(_=x.numFmtId),c.cellStyles&&null!=x.fillId&&(T=x.fillId)),gp(f,_,T,c,u,h),c.cellDates&&E&&"n"==f.t&&ll(Oi[_])&&(f.t="d",f.v=Ll(f.v)),m.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+m.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(O){var K=rd(m.r);o[K.r]||(o[K.r]=[]),o[K.r][K.c]=f}else o[m.r]=f}}}}F.length>0&&(o["!rows"]=F)}}();function Dp(e,t,r,a){var n,s=[ro,Ro("worksheet",null,{xmlns:ec[0],"xmlns:r":$o})],i=r.SheetNames[e],l="",o=r.Sheets[i];null==o&&(o={});var c=o["!ref"]||"A1",d=id(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=sd(d)}a||(a={}),o["!comments"]=[];var u=[];!function(e,t,r,a,n){var s=!1,i={},l=null;if("xlsx"!==a.bookType&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch(mT){}s=!0,i.codeName=Co(go(o))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+Ro("outlinePr",null,c)}(s||l)&&(n[n.length]=Ro("sheetPr",l,i))}(o,r,e,t,s),s[s.length]=Ro("dimension",null,{ref:c}),s[s.length]=function(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ro("sheetViews",Ro("sheetView",null,n),{})}(0,0,0,r),t.sheetFormat&&(s[s.length]=Ro("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=o["!cols"]&&o["!cols"].length>0&&(s[s.length]=function(e,t){for(var r,a=["<cols>"],n=0;n!=t.length;++n)(r=t[n])&&(a[a.length]=Ro("col",null,fp(n,r)));return a[a.length]="</cols>",a.join("")}(0,o["!cols"])),s[n=s.length]="<sheetData/>",o["!links"]=[],null!=o["!ref"]&&(l=function(e,t){var r,a,n=[],s=[],i=id(e["!ref"]),l="",o="",c=[],d=0,u=0,h=e["!rows"],f=Array.isArray(e),m={r:o},p=-1;for(u=i.s.c;u<=i.e.c;++u)c[u]=td(u);for(d=i.s.r;d<=i.e.r;++d){for(s=[],o=Zc(d),u=i.s.c;u<=i.e.c;++u){r=c[u]+o;var g=f?(e[d]||[])[u]:e[r];void 0!==g&&null!=(l=Op(g,r,e,t))&&s.push(l)}(s.length>0||h&&h[d])&&(m={r:o},h&&h[d]&&((a=h[d]).hidden&&(m.hidden=1),p=-1,a.hpx?p=Af(a.hpx):a.hpt&&(p=a.hpt),p>-1&&(m.ht=p,m.customHeight=1),a.level&&(m.outlineLevel=a.level)),n[n.length]=Ro("row",s.join(""),m))}if(h)for(;d<h.length;++d)h&&h[d]&&(m={r:d+1},(a=h[d]).hidden&&(m.hidden=1),p=-1,a.hpx?p=Af(a.hpx):a.hpt&&(p=a.hpt),p>-1&&(m.ht=p,m.customHeight=1),a.level&&(m.outlineLevel=a.level),n[n.length]=Ro("row","",m));return n.join("")}(o,t,0,0),l.length>0&&(s[s.length]=l)),s.length>n+1&&(s[s.length]="</sheetData>",s[n]=s[n].replace("/>",">")),o["!protect"]&&(s[s.length]=function(e){var t={sheet:1};return Ep.forEach(function(r){null!=e[r]&&e[r]&&(t[r]="1")}),Lp.forEach(function(r){null==e[r]||e[r]||(t[r]="0")}),e.password&&(t.password=uf(e.password).toString(16).toUpperCase()),Ro("sheetProtection",null,t)}(o["!protect"])),null!=o["!autofilter"]&&(s[s.length]=function(e,t,r,a){var n="string"==typeof e.ref?e.ref:sd(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=nd(n);i.s.r==i.e.r&&(i.e.r=nd(t["!ref"]).e.r,n=sd(i));for(var l=0;l<s.length;++l){var o=s[l];if("_xlnm._FilterDatabase"==o.Name&&o.Sheet==a){o.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Ro("autoFilter",null,{ref:n})}(o["!autofilter"],o,r,e)),null!=o["!merges"]&&o["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+sd(e[r])+'"/>';return t+"</mergeCells>"}(o["!merges"]));var h,f,m=-1,p=-1;return o["!links"].length>0&&(s[s.length]="<hyperlinks>",o["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=ru(a,-1,go(e[1].Target).replace(/#.*$/,""),Qd.HLINK),h["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(h.location=go(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=go(e[1].Tooltip)),s[s.length]=Ro("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete o["!links"],null!=o["!margins"]&&(s[s.length]=(mp(f=o["!margins"]),Ro("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(s[s.length]=Do("ignoredErrors",Ro("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=ru(a,-1,"../drawings/drawing"+(e+1)+".xml",Qd.DRAW),s[s.length]=Ro("drawing",null,{"r:id":"rId"+p}),o["!drawing"]=u),o["!comments"].length>0&&(p=ru(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Qd.VML),s[s.length]=Ro("legacyDrawing",null,{"r:id":"rId"+p}),o["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Ip(e,t,r,a){var n=function(e,t,r){var a=Wc(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=20*Af(n.hpx):n.hpt&&(s=20*n.hpt),a.write_shift(2,s),a.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var l=0,o=a.l;a.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,f=d<<10;f<d+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[ad(c)])&&(u<0&&(u=f),h=f);u<0||(++l,a.write_shift(4,u),a.write_shift(4,h))}var m=a.l;return a.l=o,a.write_shift(4,l),a.l=m,a.length>a.l?a.slice(0,a.l):a}(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Kc(e,0,n)}var Rp=Od,Mp=Fd;function Bp(e){return[wd(e),Dd(e),"n"]}var Up=Od,zp=Fd;var qp=["left","right","top","bottom","header","footer"];function Hp(e,t,r,a,n,s,i){if(void 0===t.v)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":(t=Ml(t)).z=t.z||Oi[14],t.v=Cl(Il(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v}var o={r:r,c:a};switch(o.s=pp(n.cellXfs,t,n),t.l&&s["!links"].push([ad(o),t.l]),t.c&&s["!comments"].push([ad(o),t.c]),t.t){case"s":case"str":return n.bookSST?(l=hp(n.Strings,t.v,n.revStrings),o.t="s",o.v=l,i?Kc(e,18,function(e,t,r){return null==r&&(r=Wc(8)),Nd(t,r),r.write_shift(4,t.v),r}(0,o)):Kc(e,7,function(e,t,r){return null==r&&(r=Wc(12)),yd(t,r),r.write_shift(4,t.v),r}(0,o))):(o.t="str",i?Kc(e,17,function(e,t,r){return null==r&&(r=Wc(8+4*e.v.length)),Nd(t,r),md(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,o)):Kc(e,6,function(e,t,r){return null==r&&(r=Wc(12+4*e.v.length)),yd(t,r),md(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,o))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Kc(e,13,function(e,t,r){return null==r&&(r=Wc(8)),Nd(t,r),Ld(e.v,r),r}(t,o)):Kc(e,2,function(e,t,r){return null==r&&(r=Wc(12)),yd(t,r),Ld(e.v,r),r}(t,o)):i?Kc(e,16,function(e,t,r){return null==r&&(r=Wc(12)),Nd(t,r),Id(e.v,r),r}(t,o)):Kc(e,5,function(e,t,r){return null==r&&(r=Wc(16)),yd(t,r),Id(e.v,r),r}(t,o)),!0;case"b":return o.t="b",i?Kc(e,15,function(e,t,r){return null==r&&(r=Wc(5)),Nd(t,r),r.write_shift(1,e.v?1:0),r}(t,o)):Kc(e,4,function(e,t,r){return null==r&&(r=Wc(9)),yd(t,r),r.write_shift(1,e.v?1:0),r}(t,o)),!0;case"e":return o.t="e",i?Kc(e,14,function(e,t,r){return null==r&&(r=Wc(8)),Nd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,o)):Kc(e,3,function(e,t,r){return null==r&&(r=Wc(9)),yd(t,r),r.write_shift(1,e.v),r}(t,o)),!0}return i?Kc(e,12,function(e,t,r){return null==r&&(r=Wc(4)),Nd(t,r)}(0,o)):Kc(e,1,function(e,t,r){return null==r&&(r=Wc(8)),yd(t,r)}(0,o)),!0}function Wp(e,t){t&&t["!merges"]&&(Kc(e,177,function(e,t){return null==t&&(t=Wc(4)),t.write_shift(4,e),t}(t["!merges"].length)),t["!merges"].forEach(function(t){Kc(e,176,zp(t))}),Kc(e,178))}function Vp(e,t){t&&t["!cols"]&&(Kc(e,390),t["!cols"].forEach(function(t,r){t&&Kc(e,60,function(e,t,r){null==r&&(r=Wc(18));var a=fp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(a.width||10)),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),"number"==typeof a.width&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}(r,t))}),Kc(e,391))}function Gp(e,t){t&&t["!ref"]&&(Kc(e,648),Kc(e,649,function(e){var t=Wc(24);return t.write_shift(4,4),t.write_shift(4,1),Fd(e,t),t}(id(t["!ref"]))),Kc(e,650))}function Kp(e,t,r){t["!links"].forEach(function(t){if(t[1].Target){var a=ru(r,-1,t[1].Target.replace(/#.*$/,""),Qd.HLINK);Kc(e,494,function(e,t){var r=Wc(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Fd({s:rd(e[0]),e:rd(e[0])},r),Td("rId"+t,r);var a=e[1].Target.indexOf("#");return md((-1==a?"":e[1].Target.slice(a+1))||"",r),md(e[1].Tooltip||"",r),md("",r),r.slice(0,r.l)}(t,a))}}),delete t["!links"]}function Yp(e,t,r){Kc(e,133),Kc(e,137,function(e,t,r){null==r&&(r=Wc(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Kc(e,138),Kc(e,134)}function Xp(e,t){t["!protect"]&&Kc(e,535,function(e,t){return null==t&&(t=Wc(66)),t.write_shift(2,e.password?uf(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,null==e[r[0]]||e[r[0]]?0:1):t.write_shift(4,null!=e[r[0]]&&e[r[0]]?0:1)}),t}(t["!protect"]))}function $p(e,t,r,a){var n=Gc(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch(mT){}var o=id(i["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Kc(n,129),(r.vbaraw||i["!outline"])&&Kc(n,147,function(e,t,r){null==r&&(r=Wc(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Rd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kd(e,r),r.slice(0,r.l)}(l,i["!outline"])),Kc(n,148,Mp(o)),Yp(n,0,r.Workbook),Vp(n,i),function(e,t,r,a){var n,s=id(t["!ref"]||"A1"),i="",l=[];Kc(e,145);var o=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=c;++d){i=Zc(d),Ip(e,t,s,d);var u=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(l[h]=td(h)),n=l[h]+i;var f=o?(t[d]||[])[h]:t[n];u=!!f&&Hp(e,f,d,h,a,t,u)}}Kc(e,146)}(n,i,0,t),Xp(n,i),function(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s="string"===typeof n.ref?n.ref:sd(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=nd(s);l.s.r==l.e.r&&(l.e.r=nd(t["!ref"]).e.r,s=sd(l));for(var o=0;o<i.length;++o){var c=i[o];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Kc(e,161,Fd(id(s))),Kc(e,162)}}(n,i,r,e),Wp(n,i),Kp(n,i,a),i["!margins"]&&Kc(n,476,function(e,t){return null==t&&(t=Wc(48)),mp(e),qp.forEach(function(r){Id(e[r],t)}),t}(i["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||Gp(n,i),function(e,t,r,a){if(t["!comments"].length>0){var n=ru(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Qd.VML);Kc(e,551,Td("rId"+n)),t["!legacy"]=n}}(n,i,e,a),Kc(n,130),n.end()}function Jp(e,t,r,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var l=0,o=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,r=[],a=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=a?+t[2]:t[2])});var n=fo((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,n,t]}(e);d.s.r=d.s.c=0,d.e.c=l,c=td(l),t[0].forEach(function(e,r){i[c+Zc(r)]={t:"n",v:e,z:t[1]},o=r}),d.e.r<o&&(d.e.r=o),++l}),l>0&&(i["!ref"]=sd(d)),i}var Qp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Zp=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],eg=[],tg=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function rg(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(null==a[s[0]])a[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof a[s[0]]&&(a[s[0]]=wo(a[s[0]]));break;case"int":"string"==typeof a[s[0]]&&(a[s[0]]=parseInt(a[s[0]],10))}}}function ag(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=wo(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}function ng(e){ag(e.WBProps,Qp),ag(e.CalcPr,tg),rg(e.WBView,Zp),rg(e.Sheets,eg),dp.date1904=wo(e.WBProps.date1904)}var sg="][*?/\\".split("");function ig(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return sg.forEach(function(a){if(-1!=e.indexOf(a)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function lg(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,r){e.forEach(function(a,n){ig(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var i=t&&t[n]&&t[n].CodeName||a;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)xp(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var og=/<\w+:workbook/;function cg(e){var t=[ro];t[t.length]=Ro("workbook",null,{xmlns:ec[0],"xmlns:r":$o});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Qp.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(a[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ro("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&n[s]&&n[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:go(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Ro("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=Ro("definedName",go(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function dg(e,t){return t||(t=Wc(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Td(e.strRelID,t),md(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ug(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hg(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&-1==n?n=a:1==r[a].Hidden&&-1==s&&(s=a);s>n||(Kc(e,135),Kc(e,158,function(e,t){return t||(t=Wc(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}(n)),Kc(e,136))}}function fg(e,t){var r=Gc();return Kc(r,131),Kc(r,128,function(e,t){t||(t=Wc(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return md("SheetJS",t),md($s.version,t),md($s.version,t),md("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Kc(r,153,function(e,t){t||(t=Wc(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kd(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),hg(r,e),function(e,t){Kc(e,143);for(var r=0;r!=t.SheetNames.length;++r)Kc(e,156,dg({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Kc(e,144)}(r,e),Kc(r,132),r.end()}function mg(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ex[16]={n:"BrtFRTArchID$",f:ug},Vc(e,function(e,l,o){switch(o){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=Gm(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([o,e]):i[0]=[o,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:a.push(o),n=!0;break;case 36:case 38:a.pop(),n=!1;break;default:if(l.T);else if(!n||t.WTF&&37!=a[a.length-1]&&35!=a[a.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}},t),ng(r),r.Names=s,r.supbooks=i,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(so,function(l,o){var c=oo(l);switch(co(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":l.match(og)&&(n="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=c[n];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Qp.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=wo(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=Ao(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=fo(Ao(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":a=!1;break;case"<definedName":(s={}).Name=Ao(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),wo(c.hidden||"0")&&(s.Hidden=!0),i=o+l.length;break;case"</definedName>":s.Ref=fo(Ao(e.slice(i,o))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),-1===ec.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return ng(r),r}(e,r)}function pg(e,t,r,a,n,s,i,l){return".bin"===t.slice(-4)?function(e,t,r,a,n,s,i){if(!e)return e;var l=t||{};a||(a={"!id":{}});var o,c,d,u,h,f,m,p,g,x,b=l.dense?[]:{},v={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=[],w=!1,N=!1,j=[];l.biff=12,l["!row"]=0;var k=0,S=!1,A=[],C={},_=l.supbooks||n.supbooks||[[]];if(_.sharedf=C,_.arrayf=A,_.SheetNames=n.SheetNames||n.Sheets.map(function(e){return e.name}),!l.supbooks&&(l.supbooks=_,n.Names))for(var T=0;T<n.Names.length;++T)_[0][T+1]=n.Names[T];var E,L,P=[],O=[],F=!1;if(ex[16]={n:"BrtShortReal",f:Bp},Vc(e,function(e,t,T){if(!N)switch(T){case 148:o=e;break;case 0:c=e,l.sheetRows&&l.sheetRows<=c.r&&(N=!0),g=Zc(h=c.r),l["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Cf(e.hpt)),O[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=cp[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==l.cellText&&(d.w=Kd[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((u=i.CellXf[e[0].iStyleRef])&&gp(d,u.numFmtId,null,l,s,i),f=-1==e[0].c?f+1:e[0].c,l.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[td(f)+g]=d,l.cellFormula){for(S=!1,k=0;k<A.length;++k){var D=A[k];c.r>=D[0].s.r&&c.r<=D[0].e.r&&f>=D[0].s.c&&f<=D[0].e.c&&(d.F=sd(D[0]),S=!0)}!S&&e.length>3&&(d.f=e[3])}if(v.s.r>c.r&&(v.s.r=c.r),v.s.c>f&&(v.s.c=f),v.e.r<c.r&&(v.e.r=c.r),v.e.c<f&&(v.e.c=f),l.cellDates&&u&&"n"==d.t&&ll(Oi[u.numFmtId])){var I=Ri(d.v);I&&(d.t="d",d.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}E&&("XLDAPR"==E.type&&(d.D=!0),E=void 0),L&&(L=void 0);break;case 1:case 12:if(!l.sheetStubs||w)break;d={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,l.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[td(f)+g]=d,v.s.r>c.r&&(v.s.r=c.r),v.s.c>f&&(v.s.c=f),v.e.r<c.r&&(v.e.r=c.r),v.e.c<f&&(v.e.c=f),E&&("XLDAPR"==E.type&&(d.D=!0),E=void 0),L&&(L=void 0);break;case 176:j.push(e);break;case 49:E=((l.xlmeta||{}).Cell||[])[e-1];break;case 494:var R=a["!id"][e.relId];for(R?(e.Target=R.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=R):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)l.dense?(b[h]||(b[h]=[]),b[h][f]||(b[h][f]={t:"z",v:void 0}),b[h][f].l=e):(m=ad({c:f,r:h}),b[m]||(b[m]={t:"z",v:void 0}),b[m].l=e);break;case 426:if(!l.cellFormula)break;A.push(e),(x=l.dense?b[h][f]:b[td(f)+g]).f=Gm(e[1],0,{r:c.r,c:f},_,l),x.F=sd(e[0]);break;case 427:if(!l.cellFormula)break;C[ad(e[0].s)]=e[1],(x=l.dense?b[h][f]:b[td(f)+g]).f=Gm(e[1],0,{r:c.r,c:f},_,l);break;case 60:if(!l.cellStyles)break;for(;e.e>=e.s;)P[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},F||(F=!0,jf(e.w/256)),kf(P[e.e+1]);break;case 161:b["!autofilter"]={ref:sd(e)};break;case 476:b["!margins"]=e;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),e.name&&(n.Sheets[r].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),e.RTL&&(n.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:y.push(T),w=!0;break;case 38:y.pop(),w=!1;break;default:if(t.T);else if(!w||l.WTF)throw new Error("Unexpected record 0x"+T.toString(16))}},l),delete l.supbooks,delete l["!row"],!b["!ref"]&&(v.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(b["!ref"]=sd(o||v)),l.sheetRows&&b["!ref"]){var D=id(b["!ref"]);l.sheetRows<=+D.e.r&&(D.e.r=l.sheetRows-1,D.e.r>v.e.r&&(D.e.r=v.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>v.e.c&&(D.e.c=v.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),b["!fullref"]=b["!ref"],b["!ref"]=sd(D))}return j.length>0&&(b["!merges"]=j),P.length>0&&(b["!cols"]=P),O.length>0&&(b["!rows"]=O),b}(e,a,r,n,s,i,l):_p(e,a,r,n,s,i,l)}function gg(e,t,r,a,n,s,i,l){return".bin"===t.slice(-4)?function(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],l=!1;return Vc(e,function(e,a,o){switch(o){case 550:s["!rel"]=e;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),e.name&&(n.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(o);break;case 38:i.pop();break;default:if(a.T>0)i.push(o);else if(a.T<0)i.pop();else if(!l||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}(e,a,r,n,s):function(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},l=e.match(Sp);return l&&Tp(l[0],0,n,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}(e,0,r,n,s)}function xg(e,t,r,a){return".bin"===t.slice(-4)?function(e,t,r){var a={NumberFmt:[]};for(var n in Oi)a.NumberFmt[n]=Oi[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return Vc(e,function(e,n,l){switch(l){case 44:a.NumberFmt[e[0]]=e[1],hl(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=xf(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&a.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(l),i=!0;break;case 38:s.pop(),i=!1;break;default:if(n.T>0)s.push(l);else if(n.T<0)s.pop();else if(!i||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),a}(e,r,a):Lf(e,r,a)}function bg(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],a=!1;return Vc(e,function(e,n,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(n.T,!a||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}(e,r):function(e,t){var r=[],a="";if(!e)return r;var n=e.match(Yh);if(n){a=n[2].replace(Xh,"").split($h);for(var s=0;s!=a.length;++s){var i=Kh(a[s].trim(),t);null!=i&&(r[r.length]=i)}n=oo(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}(e,r)}function vg(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],a=[],n={},s=!1;return Vc(e,function(e,i,l){switch(l){case 632:a.push(e);break;case 635:n=e;break;case 637:n.t=e.t,n.h=e.h,n.r=e.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var n=e.match(/<(?:\w+:)?comment[^>]*>/);if(n){var s=oo(n[0]),i={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},l=rd(s.ref);if(!(t.sheetRows&&t.sheetRows<=l.r)){var o=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!o&&!!o[1]&&Kh(o[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),a.push(i)}}}}),a}(e,r)}function yg(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Vc(e,function(e,r,a){if(63===a)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+a.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(so)||[]).forEach(function(e){var a=oo(e);switch(a[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a)}}),t}(e)}function wg(e,t,r,a){if(".bin"===r.slice(-4))return function(e,t,r,a){if(!e)return e;var n=a||{},s=!1;Vc(e,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||n.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},n)}(e,0,0,a)}function Ng(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],i=!1,l=2;return Vc(e,function(e,t,r){switch(r){case 335:a.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==l?a.Cell.push({type:a.Types[e[0]-1].name,index:e[1]}):0==l&&a.Value.push({type:a.Types[e[0]-1].name,index:e[1]})});break;case 337:l=e?1:0;break;case 338:l=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||n.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),a}(e,0,r):function(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n,s=!1,i=2;return e.replace(so,function(e){var t=oo(e);switch(co(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":a.Types.push({name:t.name});break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==t.name&&(n=a.Types[l]);break;case"<rc":1==i?a.Cell.push({type:a.Types[t.t-1].name,index:+t.v}):0==i&&a.Value.push({type:a.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!n)break;n.offsets||(n.offsets=[]),n.offsets.push(+t.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),a}(e,0,r)}function jg(e,t,r,a,n){return(".bin"===t.slice(-4)?$p:Dp)(e,r,a,n)}function kg(e,t,r){return(".bin"===t.slice(-4)?fm:dm)(e,r)}var Sg,Ag=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Cg=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _g(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),1===r.length)return a;var n,s,i,l=e.match(Ag);if(l)for(i=0;i!=l.length;++i)-1===(s=(n=l[i].match(Cg))[1].indexOf(":"))?a[n[1]]=n[2].slice(1,n[2].length-1):a["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(s+1)]=n[2].slice(1,n[2].length-1);return a}function Tg(e){var t={};if(1===e.split(/\s+/).length)return t;var r,a,n,s=e.match(Ag);if(s)for(n=0;n!=s.length;++n)-1===(a=(r=s[n].match(Cg))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(a+1)]=r[2].slice(1,r[2].length-1);return t}function Eg(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=wo(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Il(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[fo(t)]=n}function Lg(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Kd[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Hi(e.v):e.w=Wi(e.v):e.w=function(e,t){var r=Sg[e]||fo(e);return"General"===r?Wi(t):ul(r,t)}(t||"General",e.v)}catch(mT){if(r.WTF)throw mT}try{var a=Sg[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&"n"==e.t&&ll(a)){var n=Ri(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(mT){if(r.WTF)throw mT}}}function Pg(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=_f[a.Pattern]||a.Pattern)}e[t.ID]=t}function Og(e,t,r,a,n,s,i,l,o,c){var d="General",u=a.StyleID,h={};c=c||{};var f=[],m=0;for(void 0===u&&l&&(u=l.StyleID),void 0===u&&i&&(u=i.StyleID);void 0!==s[u]&&(s[u].nf&&(d=s[u].nf),s[u].Interior&&f.push(s[u].Interior),s[u].Parent);)u=s[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=wo(e);break;case"String":a.t="s",a.r=yo(fo(e)),a.v=e.indexOf("<")>-1?fo(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),a.v=(Il(e)-new Date(Date.UTC(1899,11,30)))/864e5,a.v!==a.v?a.v=fo(e):a.v<60&&(a.v=a.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===a.v&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Yd[e],!1!==c.cellText&&(a.w=e);break;default:""==e&&""==t?a.t="z":(a.t="s",a.v=yo(t||e))}if(Lg(a,d,c),!1!==c.cellFormula)if(a.Formula){var p=fo(a.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),a.f=pm(p,n),delete a.Formula,"RC"==a.ArrayRange?a.F=pm("RC:RC",n):a.ArrayRange&&(a.F=pm(a.ArrayRange,n),o.push([id(a.F),a.F]))}else for(m=0;m<o.length;++m)n.r>=o[m][0].s.r&&n.r<=o[m][0].e.r&&n.c>=o[m][0].s.c&&n.c<=o[m][0].e.c&&(a.F=o[m][1]);c.cellStyles&&(f.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),a.s=h),void 0!==a.StyleID&&(a.ixfe=a.StyleID)}function Fg(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Dg(e,t){var r=t||{};ml();var a=li(Bo(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(a="undefined"!==typeof ii?ii.utils.decode(65001,ni(a)):Ao(a));var n,s=a.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var l=Ml(r);return l.type="string",Uh.to_workbook(a,l)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return cd(hx(r[0],t),t);var a={SheetNames:[],Sheets:{}};return r.forEach(function(e,r){Eb(a,hx(e,t),"Sheet"+(r+1))}),a}(a,r);Sg={"General Number":"General","General Date":Oi[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oi[15],"Short Date":Oi[14],"Long Time":Oi[19],"Medium Time":Oi[18],"Short Time":Oi[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oi[2],Standard:Oi[4],Percent:Oi[10],Scientific:Oi[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[];var d,u={},h=[],f=r.dense?[]:{},m="",p={},g={},x=_g('<Data ss:Type="String">'),b=0,v=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},j={},k="",S=0,A=[],C={},_={},T=0,E=[],L=[],P={},O=[],F=!1,D=[],I=[],R={},M=0,B=0,U={Sheets:[],WBProps:{date1904:!1}},z={};Uo.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"");for(var q="";n=Uo.exec(a);)switch(n[3]=(q=n[3]).toLowerCase()){case"data":if("data"==q){if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break}if(c[c.length-1][1])break;"/"===n[1]?Og(a.slice(b,n.index),k,x,"comment"==c[c.length-1][0]?P:p,{c:v,r:y},N,O[v],g,D,r):(k="",x=_g(n[0]),b=n.index+n[0].length);break;case"cell":if("/"===n[1])if(L.length>0&&(p.c=L),(!r.sheetRows||r.sheetRows>y)&&void 0!==p.v&&(r.dense?(f[y]||(f[y]=[]),f[y][v]=p):f[td(v)+Zc(y)]=p),p.HRef&&(p.l={Target:fo(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(M=v+(0|parseInt(p.MergeAcross,10)),B=y+(0|parseInt(p.MergeDown,10)),A.push({s:{c:v,r:y},e:{c:M,r:B}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=v;H<=M;++H)for(var W=y;W<=B;++W)(H>v||W>y)&&(r.dense?(f[W]||(f[W]=[]),f[W][H]={t:"z"}):f[td(H)+Zc(W)]={t:"z"});v=M+1}else++v;else p.MergeAcross?v=M+1:++v;else(p=Tg(n[0])).Index&&(v=+p.Index-1),v<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),"/>"===n[0].slice(-2)&&++v,L=[];break;case"row":"/"===n[1]||"/>"===n[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===n[0].slice(-2)&&(g=_g(n[0])).Index&&(y=+g.Index-1),v=0,++y):((g=_g(n[0])).Index&&(y=+g.Index-1),R={},("0"==g.AutoFitHeight||g.Height)&&(R.hpx=parseInt(g.Height,10),R.hpt=Af(R.hpx),I[y]=R),"1"==g.Hidden&&(R.hidden=!0,I[y]=R));break;case"worksheet":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"));h.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=sd(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=sd(w))),A.length&&(f["!merges"]=A),O.length>0&&(f["!cols"]=O),I.length>0&&(f["!rows"]=I),u[m]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,c.push([n[3],!1]),o=_g(n[0]),m=fo(o.Name),f=r.dense?[]:{},A=[],D=[],I=[],z={name:m,Hidden:0},U.Sheets.push(z);break;case"table":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else{if("/>"==n[0].slice(-2))break;c.push([n[3],!1]),O=[],F=!1}break;case"style":"/"===n[1]?Pg(N,j,r):j=_g(n[0]);break;case"numberformat":j.nf=fo(_g(n[0]).Format||"General"),Sg[j.nf]&&(j.nf=Sg[j.nf]);for(var V=0;392!=V&&Oi[V]!=j.nf;++V);if(392==V)for(V=57;392!=V;++V)if(null==Oi[V]){hl(j.nf,V);break}break;case"column":if("table"!==c[c.length-1][0])break;if((d=_g(n[0])).Hidden&&(d.hidden=!0,delete d.Hidden),d.Width&&(d.wpx=parseInt(d.Width,10)),!F&&d.wpx>10){F=!0,bf=6;for(var G=0;G<O.length;++G)O[G]&&kf(O[G])}F&&kf(d),O[d.Index-1||O.length]=d;for(var K=0;K<+d.Span;++K)O[O.length]=Ml(d);break;case"namedrange":if("/"===n[1])break;U.Names||(U.Names=[]);var Y=oo(n[0]),X={Name:Y.Name,Ref:pm(Y.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(X.Sheet=U.Sheets.length-1),U.Names.push(X);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===n[0].slice(-2))break;"/"===n[1]?k+=a.slice(S,n.index):S=n.index+n[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=_g(n[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===n[0].slice(-2))break;"/"===n[1]?vu(C,q,a.slice(T,n.index)):T=n.index+n[0].length;break;case"styles":case"workbook":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else c.push([n[3],!1]);break;case"comment":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"));Fg(P),L.push(P)}else c.push([n[3],!1]),P={a:(o=_g(n[0])).Author};break;case"autofilter":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else if("/"!==n[0].charAt(n[0].length-2)){var $=_g(n[0]);f["!autofilter"]={ref:pm($.Range).replace(/\$/g,"")},c.push([n[3],!0])}break;case"datavalidation":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break;default:if(0==c.length&&"document"==n[3])return Sx(a,r);if(0==c.length&&"uof"==n[3])return Sx(a,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(n[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(n[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(n[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(n[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(n[3]){case"visible":if("/>"===n[0].slice(-2));else if("/"===n[1])switch(a.slice(T,n.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else T=n.index+n[0].length;break;case"header":f["!margins"]||mp(f["!margins"]={},"xlml"),isNaN(+oo(n[0]).Margin)||(f["!margins"].header=+oo(n[0]).Margin);break;case"footer":f["!margins"]||mp(f["!margins"]={},"xlml"),isNaN(+oo(n[0]).Margin)||(f["!margins"].footer=+oo(n[0]).Margin);break;case"pagemargins":var Q=oo(n[0]);f["!margins"]||mp(f["!margins"]={},"xlml"),isNaN(+Q.Top)||(f["!margins"].top=+Q.Top),isNaN(+Q.Left)||(f["!margins"].left=+Q.Left),isNaN(+Q.Right)||(f["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(f["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(n[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(n[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(n[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(n[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(n[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(n[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+n[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===n[0].slice(-2))break;"/"===n[1]?Eg(_,q,E,a.slice(T,n.index)):(E=n,T=n.index+n[0].length);break}if(r.WTF)throw"Unrecognized tag: "+n[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=u),Z.SheetNames=h,Z.Workbook=U,Z.SSF=Ml(Oi),Z.Props=C,Z.Custprops=_,Z}function Ig(e,t){switch(ab(t=t||{}),t.type||"base64"){case"base64":return Dg(hi(e),t);case"binary":case"buffer":case"file":return Dg(e,t);case"array":return Dg(vi(e),t)}}function Rg(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return Nl(bu).map(function(e){for(var t=0;t<iu.length;++t)if(iu[t][1]==e)return iu[t];for(t=0;t<uu.length;++t)if(uu[t][1]==e)return uu[t];throw e}).forEach(function(a){if(null!=e[a[1]]){var n=t&&t.Props&&null!=t.Props[a[1]]?t.Props[a[1]]:e[a[1]];"date"===a[2]&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof n?n=String(n):!0===n||!1===n?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Do(bu[a[1]]||a[1],n))}}),Ro("DocumentProperties",r.join(""),{xmlns:tc})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Nl(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var a=0;a<iu.length;++a)if(t==iu[a][1])return;for(a=0;a<uu.length;++a)if(t==uu[a][1])return;for(a=0;a<r.length;++a)if(t==r[a])return;var s=e[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s=String(s),n.push(Ro(xo(t),s,{"dt:dt":i}))}}),t&&Nl(t).forEach(function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var a=t[r],s="string";"number"==typeof a?(s="float",a=String(a)):!0===a||!1===a?(s="boolean",a=a?"1":"0"):a instanceof Date?(s="dateTime.tz",a=a.toISOString()):a=String(a),n.push(Ro(xo(r),a,{"dt:dt":s}))}}),"<"+a+' xmlns="'+tc+'">'+n.join("")+"</"+a+">"}(e.Props,e.Custprops)),r.join("")}function Mg(e){return Ro("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+xm(e.Ref,{r:0,c:0})})}function Bg(e,t,r,a,n,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var l={};if(e.f&&(l["ss:Formula"]="="+go(xm(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var o=rd(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(o.r==i.r?"":"["+(o.r-i.r)+"]")+"C"+(o.c==i.c?"":"["+(o.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=go(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=go(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(l["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(l["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=Kd[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Oi[14]);break;case"s":u="String",h=((e.v||"")+"").replace(mo,function(e){return ho[e]}).replace(bo,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=pp(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+f),l["ss:Index"]=i.c+1;var m=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=Ro("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Ro("Comment",t,{"ss:Author":e.a})}).join("")),Ro("Cell",p,l)}function Ug(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Cf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zg(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],i=s?function(e,t,r,a){if(!e)return"";if(!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],i=0;i<n.length;++i){var l=n[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(Mg(l)))}return s.join("")}(s,0,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),i=s?function(e,t){if(!e["!ref"])return"";var r=id(e["!ref"]),a=e["!merges"]||[],n=0,s=[];e["!cols"]&&e["!cols"].forEach(function(e,t){kf(e);var r=!!e.width,a=fp(t,e),n={"ss:Index":t+1};r&&(n["ss:Width"]=vf(a.width)),e.hidden&&(n["ss:Hidden"]="1"),s.push(Ro("Column",null,n))});for(var i=Array.isArray(e),l=r.s.r;l<=r.e.r;++l){for(var o=[Ug(l,(e["!rows"]||[])[l])],c=r.s.c;c<=r.e.c;++c){var d=!1;for(n=0;n!=a.length;++n)if(!(a[n].s.c>c)&&!(a[n].s.r>l)&&!(a[n].e.c<c)&&!(a[n].e.r<l)){a[n].s.c==c&&a[n].s.r==l||(d=!0);break}if(!d){var u={r:l,c:c},h=ad(u),f=i?(e[l]||[])[c]:e[h];o.push(Bg(f,h,e,t,0,0,u))}}o.push("</Row>"),o.length>2&&s.push(o.join(""))}return s.join("")}(s,t):"",i.length>0&&a.push("<Table>"+i+"</Table>"),a.push(function(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ro("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ro("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ro("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Ro("Visible",1==a.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&(!a.Workbook.Sheets[s]||a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Do("ProtectContents","True")),e["!protect"].objects&&n.push(Do("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Do("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||n.push(Do("EnableSelection","UnlockedCells")):n.push(Do("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&n.push("<"+t[1]+"/>")})),0==n.length?"":Ro("WorksheetOptions",n.join(""),{xmlns:rc})}(s,0,e,r)),a.join("")}function qg(e,t){t||(t={}),e.SSF||(e.SSF=Ml(Oi)),e.SSF&&(ml(),fl(e.SSF),t.revssf=Sl(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],pp(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Rg(e,t)),r.push(""),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ro("Worksheet",zg(a,t,e),{"ss:Name":go(e.SheetNames[a])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var a=[];a.push(Ro("NumberFormat",null,{"ss:Format":go(Oi[e.numFmtId])}));var n={"ss:ID":"s"+(21+t)};r.push(Ro("Style",a.join(""),n))}),Ro("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];null==n.Sheet&&(n.Name.match(/^_xlfn\./)||r.push(Mg(n)))}return Ro("Names",r.join(""))}(e),ro+Ro("Workbook",r.join(""),{xmlns:ac,"xmlns:o":tc,"xmlns:x":rc,"xmlns:ss":ac,"xmlns:dt":nc,"xmlns:html":lc})}function Hg(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Md(e,1)}(r),r.length-r.l<=4)return t;var a=r.read_shift(4);return 0==a||a>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(a=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Md(e,2)}(r),0==(a=r.read_shift(4))||a>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Wg=[60,1084,2066,2165,2175];function Vg(e,t,r,a,n){var s=a,i=[],l=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:n.enc.insitu(l)}i.push(l),r.l+=s;for(var o=Lc(r,r.l),c=tx[o],d=0;null!=c&&Wg.indexOf(o)>-1;)s=Lc(r,r.l+2),d=r.l+4,2066==o?d+=4:2165!=o&&2175!=o||(d+=12),l=r.slice(d,r.l+4+s),i.push(l),r.l+=4+s,c=tx[o=Lc(r,r.l)];var u=wi(i);qc(u,0);var h=0;u.lens=[];for(var f=0;f<i.length;++f)u.lens.push(h),h+=i[f].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,n)}function Gg(e,t,r){if("z"!==e.t&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Oi[a])}catch(mT){if(t.WTF)throw mT}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Kd[e.v]:0===a||"General"==a?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Hi(e.v):e.w=Wi(e.v):e.w=ul(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(mT){if(t.WTF)throw mT}if(t.cellDates&&a&&"n"==e.t&&ll(Oi[a]||String(a))){var n=Ri(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Kg(e,t,r){return{v:e,ixfe:t,t:r}}function Yg(e,t){var r={opts:{}},a={};var n,s,i,l,o,c,d,u,h=t.dense?[]:{},f={},m={},p=null,g=[],x="",b={},v="",y={},w=[],N=[],j=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},A=function(e){return e<8?Gd[e]:e<64&&j[e-8]||Gd[e]},C=function(e,t,r){if(!(R>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var a,n=t.XF.data;n&&n.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=n.patternType,(a=gf(A(n.icvFore)))&&(t.s.fgColor={rgb:a}),(a=gf(A(n.icvBack)))&&(t.s.bgColor={rgb:a}))}(0,t,r),delete t.ixfe,delete t.XF,n=e,v=ad(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),r.cellFormula&&t.f)for(var a=0;a<w.length;++a)if(!(w[a][0].s.c>e.c||w[a][0].s.r>e.r)&&!(w[a][0].e.c<e.c||w[a][0].e.r<e.r)){t.F=sd(w[a][0]),w[a][0].s.c==e.c&&w[a][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Gm(w[a][1],0,e,F,_));break}r.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[v]=t}},_={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(_.password=t.password);var T=[],E=[],L=[],P=[],O=!1,F=[];F.SheetNames=_.snames,F.sharedf=_.sharedf,F.arrayf=_.arrayf,F.names=[],F.XTI=[];var D,I=0,R=0,M=0,B=[],U=[];_.codepage=1200,ri(1200);for(var z=!1;e.l<e.length-1;){var q=e.l,H=e.read_shift(2);if(0===H&&10===I)break;var W=e.l===e.length?0:e.read_shift(2),V=tx[H];if(V&&V.f){if(t.bookSheets&&133===I&&133!==H)break;if(I=H,2===V.r||12==V.r){var G=e.read_shift(2);if(W-=2,!_.enc&&G!==H&&((255&G)<<8|G>>8)!==H)throw new Error("rt mismatch: "+G+"!="+H);12==V.r&&(e.l+=10,W-=10)}var K={};if(K=10===H?V.f(e,W,_):Vg(H,V,e,W,_),0==R&&-1===[9,521,1033,2057].indexOf(I))continue;switch(H){case 34:r.opts.Date1904=k.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=K;break;case 66:var Y=Number(K);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}ri(_.codepage=Y),z=!0;break;case 317:_.rrtabid=K;break;case 25:_.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:_.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(h["!type"]="dialog"),K.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),K.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:N.push(K);break;case 430:F.push([K]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(K);break;case 24:case 536:D={Name:K.Name,Ref:Gm(K.rgce,0,null,F,_)},K.itab>0&&(D.Sheet=K.itab-1),F.names.push(D),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(U[K.itab-1]={ref:sd(K.rgce[0][0][1][2])});break;case 22:_.ExternCount=K;break;case 23:0==F.length&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(K),F.XTI=F.XTI.concat(K);break;case 2196:if(_.biff<8)break;null!=D&&(D.Comment=K[1]);break;case 18:h["!protect"]=K;break;case 19:0!==K&&_.WTF&&console.error("Password verifier: "+K);break;case 133:f[K.pos]=K,_.snames.push(K.name);break;case 10:if(--R)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,h["!ref"]=sd(m),t.sheetRows&&t.sheetRows<=m.e.r){var X=m.e.r;m.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=sd(m),m.e.r=X}m.e.r++,m.e.c++}T.length>0&&(h["!merges"]=T),E.length>0&&(h["!objects"]=E),L.length>0&&(h["!cols"]=L),P.length>0&&(h["!rows"]=P),k.Sheets.push(S)}""===x?b=h:a[x]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===_.biff&&(_.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),_.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(_.biff=5,z=!0,ri(_.codepage=28591)),8==_.biff&&0==K.BIFFVer&&16==K.dt&&(_.biff=2),R++)break;if(h=t.dense?[]:{},_.biff<8&&!z&&(z=!0,ri(_.codepage=t.codepage||1252)),_.biff<5||0==K.BIFFVer&&4096==K.dt){""===x&&(x="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var $={pos:e.l-W,name:x};f[$.pos]=$,_.snames.push(x)}else x=(f[q]||{name:""}).name;32==K.dt&&(h["!type"]="chart"),64==K.dt&&(h["!type"]="macro"),T=[],E=[],_.arrayf=w=[],L=[],P=[],O=!1,S={Hidden:(f[q]||{hs:0}).hs,name:x};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[K.r]||[])[K.c]:h[ad({c:K.c,r:K.r})])&&++K.c,c={ixfe:K.ixfe,XF:N[K.ixfe]||{},v:K.val,t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 5:case 517:c={ixfe:K.ixfe,XF:N[K.ixfe],v:K.val,t:K.t},M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 638:c={ixfe:K.ixfe,XF:N[K.ixfe],v:K.rknum,t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 189:for(var J=K.c;J<=K.C;++J){var Q=K.rkrec[J-K.c][0];c={ixfe:Q,XF:N[Q],v:K.rkrec[J-K.c][1],t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:J,r:K.r},c,t)}break;case 6:case 518:case 1030:if("String"==K.val){p=K;break}if((c=Kg(K.val,K.cell.ixfe,K.tt)).XF=N[c.ixfe],t.cellFormula){var Z=K.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=ad({r:ee,c:te});y[re]?c.f=""+Gm(K.formula,0,K.cell,F,_):c.F=((t.dense?(h[ee]||[])[te]:h[re])||{}).F}else c.f=""+Gm(K.formula,0,K.cell,F,_)}M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C(K.cell,c,t),p=K;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=K,(c=Kg(K,p.cell.ixfe,"s")).XF=N[c.ixfe],t.cellFormula&&(c.f=""+Gm(p.formula,0,p.cell,F,_)),M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C(p.cell,c,t),p=null;break;case 33:case 545:w.push(K);var ae=ad(K[0].s);if(s=t.dense?(h[K[0].s.r]||[])[K[0].s.c]:h[ae],t.cellFormula&&s){if(!p)break;if(!ae||!s)break;s.f=""+Gm(K[1],0,K[0],F,_),s.F=sd(K[0])}break;case 1212:if(!t.cellFormula)break;if(v){if(!p)break;y[ad(p.cell)]=K[0],((s=t.dense?(h[p.cell.r]||[])[p.cell.c]:h[ad(p.cell)])||{}).f=""+Gm(K[0],0,n,F,_)}break;case 253:c=Kg(g[K.isst].t,K.ixfe,"s"),g[K.isst].h&&(c.h=g[K.isst].h),c.XF=N[c.ixfe],M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:K.ixfe,XF:N[K.ixfe],t:"z"},M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t));break;case 190:if(t.sheetStubs)for(var ne=K.c;ne<=K.C;++ne){var se=K.ixfe[ne-K.c];c={ixfe:se,XF:N[se],t:"z"},M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:ne,r:K.r},c,t)}break;case 214:case 516:case 4:(c=Kg(K.val,K.ixfe,"s")).XF=N[c.ixfe],M>0&&(c.z=B[c.ixfe>>8&63]),Gg(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 0:case 512:1===R&&(m=K);break;case 252:g=K;break;case 1054:if(4==_.biff){B[M++]=K[1];for(var ie=0;ie<M+163&&Oi[ie]!=K[1];++ie);ie>=163&&hl(K[1],M+163)}else hl(K[1],K[0]);break;case 30:B[M++]=K;for(var le=0;le<M+163&&Oi[le]!=K;++le);le>=163&&hl(K,M+163);break;case 229:T=T.concat(K);break;case 93:E[K.cmo[0]]=_.lastobj=K;break;case 438:_.lastobj.TxO=K;break;case 127:_.lastobj.ImData=K;break;case 440:for(o=K[0].s.r;o<=K[0].e.r;++o)for(l=K[0].s.c;l<=K[0].e.c;++l)(s=t.dense?(h[o]||[])[l]:h[ad({c:l,r:o})])&&(s.l=K[1]);break;case 2048:for(o=K[0].s.r;o<=K[0].e.r;++o)for(l=K[0].s.c;l<=K[0].e.c;++l)(s=t.dense?(h[o]||[])[l]:h[ad({c:l,r:o})])&&s.l&&(s.l.Tooltip=K[1]);break;case 28:if(_.biff<=5&&_.biff>=2)break;s=t.dense?(h[K[0].r]||[])[K[0].c]:h[ad(K[0])];var oe=E[K[2]];s||(t.dense?(h[K[0].r]||(h[K[0].r]=[]),s=h[K[0].r][K[0].c]={t:"z"}):s=h[ad(K[0])]={t:"z"},m.e.r=Math.max(m.e.r,K[0].r),m.s.r=Math.min(m.s.r,K[0].r),m.e.c=Math.max(m.e.c,K[0].c),m.s.c=Math.min(m.s.c,K[0].c)),s.c||(s.c=[]),i={a:K[1],t:oe.TxO.t},s.c.push(i);break;case 2173:nm(N[K.ixfe],K.ext);break;case 125:if(!_.cellStyles)break;for(;K.e>=K.s;)L[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},O||(O=!0,jf(K.w/256)),kf(L[K.e+1]);break;case 520:var ce={};null!=K.level&&(P[K.r]=ce,ce.level=K.level),K.hidden&&(P[K.r]=ce,ce.hidden=!0),K.hpt&&(P[K.r]=ce,ce.hpt=K.hpt,ce.hpx=Cf(K.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||mp(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=K;break;case 161:h["!margins"]||mp(h["!margins"]={}),h["!margins"].header=K.header,h["!margins"].footer=K.footer;break;case 574:K.RTL&&(k.Views[0].RTL=!0);break;case 146:j=K;break;case 2198:u=K;break;case 140:d=K;break;case 442:x?S.CodeName=K||S.name:k.WBProps.CodeName=K||"ThisWorkbook"}}else V||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=W}return r.SheetNames=Nl(f).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return f[e].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&b["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=b)):r.Preamble=b,r.Sheets&&U.forEach(function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e}),r.Strings=g,r.SSF=Ml(Oi),_.enc&&(r.Encryption=_.enc),u&&(r.Themes=u),r.Metadata={},void 0!==d&&(r.Metadata.Country=d),F.names.length>0&&(k.Names=F.names),r.Workbook=k,r}var Xg="e0859ff2f94f6810ab9108002b27b3d9",$g="02d5cdd59c2e1b10939708002b2cf9ae",Jg="05d5cdd59c2e1b10939708002b2cf9ae";function Qg(e,t){var r,a,n,s;if(t||(t={}),ab(t),ai(),t.codepage&&ti(t.codepage),e.FullPaths){if(bl.find(e,"/encryption"))throw new Error("File is password-protected");r=bl.find(e,"!CompObj"),a=bl.find(e,"/Workbook")||bl.find(e,"/Book")}else{switch(t.type){case"base64":e=xi(hi(e));break;case"binary":e=xi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}qc(e,0),a={content:e}}if(r&&Hg(r),t.bookProps&&!t.bookSheets)n={};else{var i=fi?"buffer":"array";if(a&&a.content)n=Yg(a.content,t);else if((s=bl.find(e,"PerfectOffice_MAIN"))&&s.content)n=zh.to_workbook(s.content,(t.type=i,t));else{if(!(s=bl.find(e,"NativeContent_MAIN"))||!s.content)throw(s=bl.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n=zh.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&bl.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=function(e){var t=bl.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");bl.utils.cfb_add(t,n,e.FileIndex[a].content)}}),bl.write(t)}(e))}var l={};return e.FullPaths&&function(e,t,r){var a=bl.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Fu(a,zd,$g);for(var s in n)t[s]=n[s]}catch(mT){if(r.WTF)throw mT}var i=bl.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=Fu(i,qd,Xg);for(var o in l)null==t[o]&&(t[o]=l[o])}catch(mT){if(r.WTF)throw mT}t.HeadingPairs&&t.TitlesOfParts&&(fu(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function Zg(e,t){var r=t||{},a=bl.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return bl.utils.cfb_add(a,n,ux(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,a=[],n=[],s=[],i=0,l=jl(zd,"n"),o=jl(qd,"n");if(e.Props)for(r=Nl(e.Props),i=0;i<r.length;++i)(Object.prototype.hasOwnProperty.call(l,r[i])?a:Object.prototype.hasOwnProperty.call(o,r[i])?n:s).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(r=Nl(e.Custprops),i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(l,r[i])?a:Object.prototype.hasOwnProperty.call(o,r[i])?n:s).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<s.length;++i)Lu.indexOf(s[i][0])>-1||hu.indexOf(s[i][0])>-1||null!=s[i][1]&&c.push(s[i]);n.length&&bl.utils.cfb_add(t,"/\x05SummaryInformation",Du(n,Xg,o,qd)),(a.length||c.length)&&bl.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Du(a,$g,l,zd,c.length?c:null,Jg))}(e,a),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(r,a){if(0!=a){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==n.slice(-1)&&bl.utils.cfb_add(e,n,t.FileIndex[a].content)}})}(a,bl.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),a}var ex={0:{f:function(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=n/20),r}},1:{f:function(e){return[vd(e)]}},2:{f:function(e){return[vd(e),Ed(e),"n"]}},3:{f:function(e){return[vd(e),e.read_shift(1),"e"]}},4:{f:function(e){return[vd(e),e.read_shift(1),"b"]}},5:{f:function(e){return[vd(e),Dd(e),"n"]}},6:{f:function(e){return[vd(e),fd(e),"str"]}},7:{f:function(e){return[vd(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var a=e.l+t,n=vd(e);n.r=r["!row"];var s=[n,fd(e),"str"];if(r.cellFormula){e.l+=2;var i=Zm(e,a-e.l,r);s[3]=Gm(i,0,n,r.supbooks,r)}else e.l=a;return s}},9:{f:function(e,t,r){var a=e.l+t,n=vd(e);n.r=r["!row"];var s=[n,Dd(e),"n"];if(r.cellFormula){e.l+=2;var i=Zm(e,a-e.l,r);s[3]=Gm(i,0,n,r.supbooks,r)}else e.l=a;return s}},10:{f:function(e,t,r){var a=e.l+t,n=vd(e);n.r=r["!row"];var s=[n,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=Zm(e,a-e.l,r);s[3]=Gm(i,0,n,r.supbooks,r)}else e.l=a;return s}},11:{f:function(e,t,r){var a=e.l+t,n=vd(e);n.r=r["!row"];var s=[n,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=Zm(e,a-e.l,r);s[3]=Gm(i,0,n,r.supbooks,r)}else e.l=a;return s}},12:{f:function(e){return[wd(e)]}},13:{f:function(e){return[wd(e),Ed(e),"n"]}},14:{f:function(e){return[wd(e),e.read_shift(1),"e"]}},15:{f:function(e){return[wd(e),e.read_shift(1),"b"]}},16:{f:Bp},17:{f:function(e){return[wd(e),fd(e),"str"]}},18:{f:function(e){return[wd(e),e.read_shift(4),"s"]}},19:{f:gd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=Cd(e),i=ep(e,0,r),l=Sd(e);e.l=a;var o={Name:s,Ptg:i};return n<268435455&&(o.Sheet=n),l&&(o.Comment=l),o}},40:{},42:{},43:{f:function(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1),700===e.read_shift(2)&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(a.underline=s);var i=e.read_shift(1);i>0&&(a.family=i);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=function(e){var t={},r=e.read_shift(1)>>>1,a=e.read_shift(1),n=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var o=Gd[a];o&&(t.rgb=gf(o));break;case 2:t.rgb=gf([s,i,l]);break;case 3:t.theme=a}return 0!=n&&(t.tint=n>0?n/32767:n/32768),t}(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor"}return a.name=fd(e),a}},44:{f:function(e,t){return[e.read_shift(2),fd(e)]}},45:{f:Rf},46:{f:zf},47:{f:function(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Lh},62:{f:function(e){return[vd(e),gd(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ad(r);var a=e.read_shift(1);return 2&a&&(t.l="1"),8&a&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},a=e[e.l];return++e.l,r.above=!(64&a),r.left=!(128&a),e.l+=18,r.name=jd(e,t-19),r}},148:{f:Rp,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?fd(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(65536&a),r.backupFile=!!(64&a),r.checkCompatibility=!!(4096&a),r.date1904=!!(1&a),r.filterPrivacy=!!(8&a),r.hidePivotFieldList=!!(1024&a),r.promptedSolutions=!!(16&a),r.publishItems=!!(2048&a),r.refreshAllConnections=!!(262144&a),r.saveExternalLinkValues=!!(128&a),r.showBorderUnselectedTables=!!(4&a),r.showInkAnnotation=!!(32&a),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(32768&a),r.updateLinks=["userSet","never","always"][a>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=_d(e,t-8),r.name=fd(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Od},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Up},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fd(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_d},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ah},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var a=e.l+t,n=Pd(e),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var l=Qm(e,a-e.l,r);i[1]=l}else e.l=a;return i}},427:{f:function(e,t,r){var a=e.l+t,n=[Od(e,16)];if(r.cellFormula){var s=tp(e,a-e.l,r);n[1]=s,e.l=a}else e.l=a;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return qp.forEach(function(r){t[r]=Dd(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,a=Od(e,16),n=Sd(e),s=fd(e),i=fd(e),l=fd(e);e.l=r;var o={rfx:a,relId:n,loc:s,display:l};return i&&(o.Tooltip=i),o}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_d},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hm},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Od(e,16);return t.rfx=r.s,t.ref=ad(r.s),e.l+=16,t}},636:{T:-1},637:{f:xd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:fd(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tx={6:{f:Xm},10:{f:Iu},12:{f:Bu},13:{f:Bu},14:{f:Ru},15:{f:Ru},16:{f:Dd},17:{f:Ru},18:{f:Ru},19:{f:Bu},20:{f:Nh},21:{f:Nh},23:{f:Ah},24:{f:Sh},25:{f:Ru},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=Yu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},l,i,s]}}(e,0,r)}},29:{},34:{f:Ru},35:{f:jh},38:{f:Dd},39:{f:Dd},40:{f:Dd},41:{f:Dd},42:{f:Ru},43:{f:Ru},47:{f:function(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?mf(e,t-2,a):function(e,t,r,a){var n={key:Bu(e),verificationBytes:Bu(e)};r.password&&(n.verifier=uf(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=ff(r.password))}(e,r.biff,r,a),a}},49:{f:function(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return a.name=Hu(e,0,r),a}},51:{f:Bu},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Ru},65:{f:function(){}},66:{f:Bu},77:{},80:{},81:{},82:{},85:{f:Bu},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=Yu(e,0,r);return e.read_shift(t+a-e.l),n}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((_h[a]||Hc)(e,t,r)),{cmo:[n,a,s],ft:i}}(e,t,r);var a=dh(e),n=function(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(hh[n](e,r-e.l))}catch(mT){return e.l=r,a}}return e.l!=r&&(e.l=r),a}(e,t-22,a[1]);return{cmo:a,ft:n}}},94:{},95:{f:Ru},96:{},97:{},99:{f:Ru},125:{f:Lh},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var a=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&a,fBelow:64&a,fRight:128&a}}},130:{f:Bu},131:{f:Ru},132:{f:Ru},133:{f:function(e,t,r){var a=e.read_shift(4),n=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=Hu(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Hd[t]||t,t=e.read_shift(2),r[1]=Hd[t]||t,r}},141:{f:Bu},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(th(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Bu},157:{},158:{},160:{f:Oh},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Dd(e),r.footer=Dd(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(sh(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}},193:{f:Iu},197:{},198:{},199:{},200:{},201:{},202:{f:Ru},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Bu},220:{},221:{f:Ru},222:{},224:{f:function(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,a.data=function(e,t,r,a){var n={},s=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(2);return n.patternType=Wd[l>>26],a.cellStyles?(n.alc=7&s,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=15&i,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=127&l,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=127&o,n.icvBack=o>>7&127,n.fsxButton=o>>14&1,n):n}(e,0,a.fStyle,r),a}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Iu},227:{},229:{f:function(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(ih(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<r;++i)s.push(Wu(e));return s.Count=a,s.Unique=n,s}},253:{f:function(e){var t=rh(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zu},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ru},353:{f:Iu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Gu(e,s),l=[];a>e.l;)l.push(Ku(e));return[s,n,i,l]}},431:{f:Ru},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var i=e.read_shift(2);e.read_shift(2),Bu(e);var l=e.read_shift(2);e.l+=l;for(var o=1;o<e.lens.length-1;++o){if(e.l-a!=e.lens[o])throw new Error("TxO: bad continue record");var c=e[e.l];if((n+=Gu(e,e.lens[o+1]-e.lens[o]-1)).length>=(c?i:2*i))break}if(n.length!==i&&n.length!==2*i)throw new Error("cchText: "+i+" != "+n.length);return e.l=a+t,{t:n}}catch(mT){return e.l=a+t,{t:n}}}},439:{f:Ru},440:{f:function(e,t){var r=ih(e);e.l+=16;var a=function(e,t){var r=e.l+t,a=e.read_shift(4);if(2!==a)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,l,o,c,d,u="";16&n&&(s=Ju(e,e.l)),128&n&&(i=Ju(e,e.l)),257===(257&n)&&(l=Ju(e,e.l)),1===(257&n)&&(o=$u(e,e.l)),8&n&&(u=Ju(e,e.l)),32&n&&(c=e.read_shift(16)),64&n&&(d=yu(e)),e.l=r;var h=i||l||o||"";h&&u&&(h+="#"+u),h||(h="#"+u),2&n&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),d&&(f.time=d),s&&(f.Tooltip=s),f}(e,t-24);return[r,a]}},441:{},442:{f:Ku},443:{},444:{f:Bu},445:{},446:{},448:{f:Iu},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Iu},512:{f:vh},513:{f:Ph},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var a=rh(e),n=Dd(e);return a.val=n,a}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var a=rh(e);2==r.biff&&e.l++;var n=Ku(e,e.l,r);return a.val=n,a}},517:{f:wh},519:{f:Fh},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,7&a&&(t.level=7&a),32&a&&(t.hidden=!0),64&a&&(t.hpt=r/20),t}},523:{},545:{f:Ch},549:{f:gh},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=sh(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),Yu(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var a=oh(e);e.l++;var n=e.read_shift(1);return[Ym(e,t-=8,r),n,a]}},2048:{f:function(e,t){e.read_shift(2);var r=ih(e),a=e.read_shift((t-10)/2,"dbcs-cont");return[r,a=a.replace(Ni,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Iu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),n=[];a-- >0;)n.push(am(e,e.l));return{ixfe:r,ext:n}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ru,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2);return[Gu(e,a,r),Gu(e,n,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var a=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var n,s=e.slice(e.l);e.l=a;try{n=eo(s,{type:"array"})}catch(mT){return}var i=Xl(n,"theme/theme/theme1.xml",!0);if(i)return em(i,r)}else e.l=a},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Iu},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Bu},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var a={area:!1};if(5!=r.biff)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,16&n&&(a.area=!0),a}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(th(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vh},1:{},2:{f:function(e){var t=rh(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=rh(e);++e.l;var r=Dd(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var a=rh(e);++e.l;var n=Yu(e,0,r);return a.t="str",a.val=n,a}},5:{f:wh},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:fh},11:{},22:{f:Bu},30:{f:bh},31:{},32:{},33:{f:Ch},36:{},37:{f:gh},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Bu},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var a=e.l+t,n=rh(e),s=e.read_shift(2),i=Gu(e,s,r);return e.l=a,n.t="str",n.val=i,n}},223:{},234:{},354:{},421:{},518:{f:Xm},521:{f:fh},536:{f:Sh},547:{f:jh},561:{},579:{},1030:{f:Xm},1033:{f:fh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rx(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&_c(r)&&e.push(r)}}function ax(e,t,r){return e||(e=Wc(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function nx(e,t,r,a){if(null!=t.v)switch(t.t){case"d":case"n":var n="d"==t.t?Cl(Il(t.v)):t.v;return void(n==(0|n)&&n>=0&&n<65536?rx(e,2,function(e,t,r){var a=Wc(9);return ax(a,e,t),a.write_shift(2,r),a}(r,a,n)):rx(e,3,function(e,t,r){var a=Wc(15);return ax(a,e,t),a.write_shift(8,r,"f"),a}(r,a,n)));case"b":case"e":return void rx(e,5,function(e,t,r,a){var n=Wc(9);return ax(n,e,t),qu(r,a||"b",n),n}(r,a,t.v,t.t));case"s":case"str":return void rx(e,4,function(e,t,r){var a=Wc(8+2*r.length);return ax(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}(r,a,(t.v||"").slice(0,255)))}rx(e,1,ax(null,r,a))}function sx(e,t){var r=t||{};for(var a=Gc(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(0==n&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return rx(a,4==r.biff?1033:3==r.biff?521:9,mh(0,16,r)),function(e,t,r,a){var n,s=Array.isArray(t),i=id(t["!ref"]||"A1"),l="",o=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),n=sd(i)}for(var c=i.s.r;c<=i.e.r;++c){l=Zc(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(o[d]=td(d)),n=o[d]+l;var u=s?(t[c]||[])[d]:t[n];u&&nx(e,u,c,d)}}}(a,e.Sheets[e.SheetNames[n]],0,r),rx(a,10),a.end()}function ix(e,t,r){rx(e,49,function(e,t){var r=e.name||"Arial",a=t&&5==t.biff,n=Wc(a?15+r.length:16+2*r.length);return n.write_shift(2,20*(e.sz||12)),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),n}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function lx(e,t){if(t){var r=0;t.forEach(function(t,a){++r<=256&&t&&rx(e,125,function(e,t){var r=Wc(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}(fp(a,t),a))})}}function ox(e,t,r,a,n){var s=16+pp(n.cellXfs,t,n);if(null!=t.v||t.bf)if(t.bf)rx(e,6,$m(t,r,a,0,s));else switch(t.t){case"d":case"n":rx(e,515,function(e,t,r,a){var n=Wc(14);return ah(e,t,a,n),Id(r,n),n}(r,a,"d"==t.t?Cl(Il(t.v)):t.v,s));break;case"b":case"e":rx(e,517,function(e,t,r,a,n,s){var i=Wc(8);return ah(e,t,a,i),qu(r,s,i),i}(r,a,t.v,s,0,t.t));break;case"s":case"str":if(n.bookSST)rx(e,253,function(e,t,r,a){var n=Wc(10);return ah(e,t,a,n),n.write_shift(4,r),n}(r,a,hp(n.Strings,t.v,n.revStrings),s));else rx(e,516,function(e,t,r,a,n){var s=!n||8==n.biff,i=Wc(+s+8+(1+s)*r.length);return ah(e,t,a,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}(r,a,(t.v||"").slice(0,255),s,n));break;default:rx(e,513,ah(r,a,s))}else rx(e,513,ah(r,a,s))}function cx(e,t,r){var a,n=Gc(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),d=8==t.biff,u="",h=[],f=id(i["!ref"]||"A1"),m=d?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}rx(n,2057,mh(0,16,t)),rx(n,13,Uu(1)),rx(n,12,Uu(100)),rx(n,15,Mu(!0)),rx(n,17,Mu(!1)),rx(n,16,Id(.001)),rx(n,95,Mu(!0)),rx(n,42,Mu(!1)),rx(n,43,Mu(!1)),rx(n,130,Uu(1)),rx(n,128,function(e){var t=Wc(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),rx(n,131,Mu(!1)),rx(n,132,Mu(!1)),d&&lx(n,i["!cols"]),rx(n,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,a=Wc(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}(f,t)),d&&(i["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){u=Zc(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=td(g)),a=h[g]+u;var x=c?(i[p]||[])[g]:i[a];x&&(ox(n,x,p,g,t),d&&x.l&&i["!links"].push([a,x.l]))}}var b=o.CodeName||o.name||s;return d&&rx(n,574,function(e){var t=Wc(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&rx(n,229,function(e){var t=Wc(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)lh(e[r],t);return t}(i["!merges"])),d&&function(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];rx(e,440,Th(a)),a[1].Tooltip&&rx(e,2048,Eh(a))}delete t["!links"]}(n,i),rx(n,442,Xu(b)),d&&function(e,t){var r=Wc(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),rx(e,2151,r),(r=Wc(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),lh(id(t["!ref"]||"A1"),r),r.write_shift(4,4),rx(e,2152,r)}(n,i),rx(n,10),n.end()}function dx(e,t,r){var a=Gc(),n=(e||{}).Workbook||{},s=n.Sheets||[],i=n.WBProps||{},l=8==r.biff,o=5==r.biff;(rx(a,2057,mh(0,5,r)),"xla"==r.bookType&&rx(a,135),rx(a,225,l?Uu(1200):null),rx(a,193,function(e,t){t||(t=Wc(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),o&&rx(a,191),o&&rx(a,192),rx(a,226),rx(a,92,function(e,t){var r=!t||8==t.biff,a=Wc(r?112:54);for(a.write_shift(8==t.biff?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}(0,r)),rx(a,66,Uu(l?1200:1252)),l&&rx(a,353,Uu(0)),l&&rx(a,448),rx(a,317,function(e){for(var t=Wc(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),l&&e.vbaraw&&rx(a,211),l&&e.vbaraw)&&rx(a,442,Xu(i.CodeName||"ThisWorkbook"));rx(a,156,Uu(17)),rx(a,25,Mu(!1)),rx(a,18,Mu(!1)),rx(a,19,Uu(0)),l&&rx(a,431,Mu(!1)),l&&rx(a,444,Uu(0)),rx(a,61,function(){var e=Wc(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),rx(a,64,Mu(!1)),rx(a,141,Uu(0)),rx(a,34,Mu("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&wo(e.Workbook.WBProps.date1904)?"true":"false"}(e))),rx(a,14,Mu(!0)),l&&rx(a,439,Mu(!1)),rx(a,218,Uu(0)),ix(a,0,r),function(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)null!=t[n]&&rx(e,1054,xh(n,t[n],r))})}(a,e.SSF,r),function(e,t){for(var r=0;r<16;++r)rx(e,224,yh({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){rx(e,224,yh(r,0,t))})}(a,r),l&&rx(a,352,Mu(!1));var c=a.end(),d=Gc();l&&rx(d,140,function(e){return e||(e=Wc(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),l&&r.Strings&&function(e,t,r,a){var n=a||(r||[]).length||0;if(n<=8224)return rx(e,t,r,n);var s=t;if(!isNaN(s)){for(var i=r.parts||[],l=0,o=0,c=0;c+(i[l]||8224)<=8224;)c+=i[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,c),e.push(r.slice(o,o+c)),o+=c;o<n;){for((d=e.next(4)).write_shift(2,60),c=0;c+(i[l]||8224)<=8224;)c+=i[l]||8224,l++;d.write_shift(2,c),e.push(r.slice(o,o+c)),o+=c}}}(d,252,function(e){var t=Wc(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],a=0;a<e.length;++a)r[a]=Vu(e[a]);var n=wi([t].concat(r));return n.parts=[t.length].concat(r.map(function(e){return e.length})),n}(r.Strings)),rx(d,10);var u=d.end(),h=Gc(),f=0,m=0;for(m=0;m<e.SheetNames.length;++m)f+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var p=c.length+f+u.length;for(m=0;m<e.SheetNames.length;++m){rx(h,133,ph({pos:p,hs:(s[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},r)),p+=t[m].length}var g=h.end();if(f!=g.length)throw new Error("BS8 "+f+" != "+g.length);var x=[];return c.length&&x.push(c),g.length&&x.push(g),u.length&&x.push(u),wi(x)}function ux(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(a&&a["!ref"])nd(a["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var n=t||{};switch(n.biff||2){case 8:case 5:return function(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Ml(Oi)),e&&e.SSF&&(ml(),fl(e.SSF),r.revssf=Sl(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,nb(r),r.cellXfs=[],pp(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=cx(n,r,e);return a.unshift(dx(e,a,r)),wi(a)}(e,t);case 4:case 3:case 2:return sx(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function hx(e,t){var r=t||{};var a=r.dense?[]:{},n=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,l=s&&s.index||e.length,o=Hl(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<o.length;++i){var p=o[i].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var x=p.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var b=x[l].trim();if(b.match(/<t[dh]/i)){for(var v=b,y=0;"<"==v.charAt(0)&&(y=v.indexOf(">"))>-1;)v=v.slice(y+1);for(var w=0;w<m.length;++w){var N=m[w];N.s.c==d&&N.s.r<c&&c<=N.e.r&&(d=N.e.c+1,w=-1)}var j=oo(b.slice(0,b.indexOf(">")));h=j.colspan?+j.colspan:1,((u=+j.rowspan)>1||h>1)&&m.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+h-1}});var k=j.t||j["data-t"]||"";if(v.length)if(v=To(v),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>d&&(f.s.c=d),f.e.c<d&&(f.e.c=d),v.length){var S={t:"s",v:v};r.raw||!v.trim().length||"s"==k||("TRUE"===v?S={t:"b",v:!0}:"FALSE"===v?S={t:"b",v:!1}:isNaN(Ul(v))?isNaN(ql(v).getDate())||(S={t:"d",v:Il(v)},r.cellDates||(S={t:"n",v:Cl(S.v)}),S.z=r.dateNF||Oi[14]):S={t:"n",v:Ul(v)}),r.dense?(a[c]||(a[c]=[]),a[c][d]=S):a[ad({r:c,c:d})]=S,d+=h}else d+=h;else d+=h}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0}}return a["!ref"]=sd(f),m.length&&(a["!merges"]=m),a}function fx(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,o=0,c=0;c<n.length;++c)if(!(n[c].s.r>r||n[c].s.c>i)&&!(n[c].e.r<r||n[c].e.c<i)){if(n[c].s.r<r||n[c].s.c<i){l=-1;break}l=n[c].e.r-n[c].s.r+1,o=n[c].e.c-n[c].s.c+1;break}if(!(l<0)){var d=ad({r:r,c:i}),u=a.dense?(e[r]||[])[i]:e[d],h=u&&null!=u.v&&(u.h||vo(u.w||(od(u),u.w)||""))||"",f={};l>1&&(f.rowspan=l),o>1&&(f.colspan=o),a.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(a.id||"sjs")+"-"+d,s.push(Ro("td",h,f))}}return"<tr>"+s.join("")+"</tr>"}var mx='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',px="</body></html>";function gx(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xx(e,t){var r=t||{},a=null!=r.header?r.header:mx,n=null!=r.footer?r.footer:px,s=[a],i=nd(e["!ref"]);r.dense=Array.isArray(e),s.push(gx(0,0,r));for(var l=i.s.r;l<=i.e.r;++l)s.push(fx(e,i,l,r));return s.push("</table>"+n),s.join("")}function bx(e,t,r){var a=r||{};var n=0,s=0;if(null!=a.origin)if("number"==typeof a.origin)n=a.origin;else{var i="string"==typeof a.origin?rd(a.origin):a.origin;n=i.r,s=i.c}var l=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var d=nd(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==n&&(c.e.r=n=d.e.r+1)}var u=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&p<o;++m){var y=l[m];if(yx(y)){if(a.display)continue;f[p]={hidden:!0}}var w=y.children;for(g=x=0;g<w.length;++g){var N=w[g];if(!a.display||!yx(N)){var j=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):To(N.innerHTML),k=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<u.length;++h){var S=u[h];S.s.c==x+s&&S.s.r<p+n&&p+n<=S.e.r&&(x=S.e.c+1-s,h=-1)}v=+N.getAttribute("colspan")||1,((b=+N.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+n,c:x+s},e:{r:p+n+(b||1)-1,c:x+s+(v||1)-1}});var A={t:"s",v:j},C=N.getAttribute("data-t")||N.getAttribute("t")||"";null!=j&&(0==j.length?A.t=C||"z":a.raw||0==j.trim().length||"s"==C||("TRUE"===j?A={t:"b",v:!0}:"FALSE"===j?A={t:"b",v:!1}:isNaN(Ul(j))?isNaN(ql(j).getDate())||(A={t:"d",v:Il(j)},a.cellDates||(A={t:"n",v:Cl(A.v)}),A.z=a.dateNF||Oi[14]):A={t:"n",v:Ul(j)})),void 0===A.z&&null!=k&&(A.z=k);var _="",T=N.getElementsByTagName("A");if(T&&T.length)for(var E=0;E<T.length&&(!T[E].hasAttribute("href")||"#"==(_=T[E].getAttribute("href")).charAt(0));++E);_&&"#"!=_.charAt(0)&&(A.l={Target:_}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][x+s]=A):e[ad({c:x+s,r:p+n})]=A,c.e.c<x+s&&(c.e.c=x+s),x+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+n),e["!ref"]=sd(c),p>=o&&(e["!fullref"]=sd((c.e.r=l.length-m+p-1+n,c))),e}function vx(e,t){return bx((t||{}).dense?[]:{},e,t)}function yx(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function wx(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[fo(t.replace(/<[^>]*>/g,""))]}var Nx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function jx(e,t){var r=t||{};var a,n,s,i,l,o,c=Bo(e),d=[],u={name:""},h="",f=0,m={},p=[],g=r.dense?[]:{},x={value:""},b="",v=0,y=[],w=-1,N=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},A=[],C={},_=[],T=1,E=1,L=[],P={Names:[]},O={},F=["",""],D=[],I={},R="",M=0,B=!1,U=!1,z=0;for(Uo.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");l=Uo.exec(c);)switch(l[3]=l[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===l[1]?(j.e.c>=j.s.c&&j.e.r>=j.s.r?g["!ref"]=sd(j):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(g["!fullref"]=g["!ref"],j.e.r=r.sheetRows-1,g["!ref"]=sd(j)),A.length&&(g["!merges"]=A),_.length&&(g["!rows"]=_),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),p.push(s.name),m[s.name]=g,U=!1):"/"!==l[0].charAt(l[0].length-2)&&(s=oo(l[0],!1),w=N=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,g=r.dense?[]:{},A=[],_=[],U=!0);break;case"table-row-group":"/"===l[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===l[1]){w+=T,T=1;break}if((i=oo(l[0],!1))["\u884c\u53f7"]?w=i["\u884c\u53f7"]-1:-1==w&&(w=0),(T=+i["number-rows-repeated"]||1)<10)for(z=0;z<T;++z)k>0&&(_[w+z]={level:k});N=-1;break;case"covered-table-cell":"/"!==l[1]&&++N,r.sheetStubs&&(r.dense?(g[w]||(g[w]=[]),g[w][N]={t:"z"}):g[ad({r:w,c:N})]={t:"z"}),b="",y=[];break;case"table-cell":case"\u6570\u636e":if("/"===l[0].charAt(l[0].length-2))++N,x=oo(l[0],!1),E=parseInt(x["number-columns-repeated"]||"1",10),o={t:"z",v:null},x.formula&&0!=r.cellFormula&&(o.f=sp(fo(x.formula))),"string"==(x["\u6570\u636e\u7c7b\u578b"]||x["value-type"])&&(o.t="s",o.v=fo(x["string-value"]||""),r.dense?(g[w]||(g[w]=[]),g[w][N]=o):g[ad({r:w,c:N})]=o),N+=E-1;else if("/"!==l[1]){b="",v=0,y=[],E=1;var q=T?w+T-1:w;if(++N>j.e.c&&(j.e.c=N),N<j.s.c&&(j.s.c=N),w<j.s.r&&(j.s.r=w),q>j.e.r&&(j.e.r=q),D=[],I={},o={t:(x=oo(l[0],!1))["\u6570\u636e\u7c7b\u578b"]||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=fo(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(C={s:{r:w,c:N},e:{r:w+(parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},o.F=sd(C),L.push([C,o.F])),x.formula)o.f=sp(x.formula);else for(z=0;z<L.length;++z)w>=L[z][0].s.r&&w<=L[z][0].e.r&&N>=L[z][0].s.c&&N<=L[z][0].e.c&&(o.F=L[z][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(C={s:{r:w,c:N},e:{r:w+(parseInt(x["number-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-columns-spanned"],10)||0)-1}},A.push(C)),x["number-columns-repeated"]&&(E=parseInt(x["number-columns-repeated"],10)),o.t){case"boolean":o.t="b",o.v=wo(x["boolean-value"]);break;case"float":case"percentage":case"currency":o.t="n",o.v=parseFloat(x.value);break;case"date":o.t="d",o.v=Il(x["date-value"]),r.cellDates||(o.t="n",o.v=Cl(o.v)),o.z="m/d/yy";break;case"time":o.t="n",o.v=Pl(x["time-value"])/86400,r.cellDates&&(o.t="d",o.v=Ll(o.v)),o.z="HH:MM:SS";break;case"number":o.t="n",o.v=parseFloat(x["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==o.t&&"text"!==o.t&&o.t)throw new Error("Unsupported value type "+o.t);o.t="s",null!=x["string-value"]&&(b=fo(x["string-value"]),y=[])}}else{if(B=!1,"s"===o.t&&(o.v=b||"",y.length&&(o.R=y),B=0==v),O.Target&&(o.l=O),D.length>0&&(o.c=D,D=[]),b&&!1!==r.cellText&&(o.w=b),B&&(o.t="z",delete o.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var H=0;H<T;++H){if(E=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[w+H]||(g[w+H]=[]),g[w+H][N]=0==H?o:Ml(o);--E>0;)g[w+H][N+E]=Ml(o);else for(g[ad({r:w+H,c:N})]=o;--E>0;)g[ad({r:w+H,c:N+E})]=Ml(o);j.e.c<=N&&(j.e.c=N)}N+=(E=parseInt(x["number-columns-repeated"]||"1",10))-1,E=0,o={},b="",y=[]}O={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===l[1]){if((a=d.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!0]);break;case"annotation":if("/"===l[1]){if((a=d.pop())[0]!==l[3])throw"Bad state: "+a;I.t=b,y.length&&(I.R=y),I.a=R,D.push(I)}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!1]);R="",M=0,b="",v=0,y=[];break;case"creator":"/"===l[1]?R=c.slice(M,l.index):M=l.index+l[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===l[1]){if((a=d.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!1]);b="",v=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===l[1]){if(S[u.name]=h,(a=d.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&(h="",u=oo(l[0],!1),d.push([l[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":n=oo(l[0],!1),h+=Nx[l[3]]["long"===n.style?1:0]}break;case"text":if("/>"===l[0].slice(-2))break;if("/"===l[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(f,l.index)}else f=l.index+l[0].length;break;case"named-range":F=lp((n=oo(l[0],!1))["cell-range-address"]);var W={Name:n.name,Ref:F[0]+"!"+F[1]};U&&(W.Sheet=p.length),P.Names.push(W);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==l[1]||x&&x["string-value"])oo(l[0],!1),v=l.index+l[0].length;else{var V=wx(c.slice(v,l.index));b=(b.length>0?b+"\n":"")+V[0]}break;case"database-range":if("/"===l[1])break;try{m[(F=lp(oo(l[0])["target-range-address"]))[0]]["!autofilter"]={ref:F[1]}}catch(mT){}break;case"a":if("/"!==l[1]){if(!(O=oo(l[0],!1)).href)break;O.Target=fo(O.href),delete O.href,"#"==O.Target.charAt(0)&&O.Target.indexOf(".")>-1?(F=lp(O.Target.slice(1)),O.Target="#"+F[0]+"!"+F[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;default:switch(l[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(l)}}var G={Sheets:m,SheetNames:p,Workbook:P};return r.bookSheets&&delete G.Sheets,G}function kx(e,t){t=t||{},Gl(e,"META-INF/manifest.xml")&&function(e,t){for(var r,a,n=Bo(e);r=Uo.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(a=oo(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==a.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Yl(e,"META-INF/manifest.xml"),t);var r=Xl(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=jx(Ao(r),t);return Gl(e,"meta.xml")&&(a.Props=ou(Yl(e,"meta.xml"))),a}function Sx(e,t){return jx(e,t)}var Ax=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Io({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ro+t}}(),Cx=function(){var e=function(e){return go(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r=function(r,a,n){var s=[];s.push('      <table:table table:name="'+go(a.SheetNames[n])+'" table:style-name="ta1">\n');var i=0,l=0,o=nd(r["!ref"]||"A1"),c=r["!merges"]||[],d=0,u=Array.isArray(r);if(r["!cols"])for(l=0;l<=o.e.c;++l)s.push("        <table:table-column"+(r["!cols"][l]?' table:style-name="co'+r["!cols"][l].ods+'"':"")+"></table:table-column>\n");var h="",f=r["!rows"]||[];for(i=0;i<o.s.r;++i)h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",s.push("        <table:table-row"+h+"></table:table-row>\n");for(;i<=o.e.r;++i){for(h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",s.push("        <table:table-row"+h+">\n"),l=0;l<o.s.c;++l)s.push(t);for(;l<=o.e.c;++l){var m=!1,p={},g="";for(d=0;d!=c.length;++d)if(!(c[d].s.c>l)&&!(c[d].s.r>i)&&!(c[d].e.c<l)&&!(c[d].e.r<i)){c[d].s.c==l&&c[d].s.r==i||(m=!0),p["table:number-columns-spanned"]=c[d].e.c-c[d].s.c+1,p["table:number-rows-spanned"]=c[d].e.r-c[d].s.r+1;break}if(m)s.push("          <table:covered-table-cell/>\n");else{var x=ad({r:i,c:l}),b=u?(r[i]||[])[l]:r[x];if(b&&b.f&&(p["table:formula"]=go(ip(b.f)),b.F&&b.F.slice(0,x.length)==x)){var v=nd(b.F);p["table:number-matrix-columns-spanned"]=v.e.c-v.s.c+1,p["table:number-matrix-rows-spanned"]=v.e.r-v.s.r+1}if(b){switch(b.t){case"b":g=b.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=b.v?"true":"false";break;case"n":g=b.w||String(b.v||0),p["office:value-type"]="float",p["office:value"]=b.v||0;break;case"s":case"str":g=null==b.v?"":b.v,p["office:value-type"]="string";break;case"d":g=b.w||Il(b.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Il(b.v).toISOString(),p["table:style-name"]="ce1";break;default:s.push(t);continue}var y=e(g);if(b.l&&b.l.Target){var w=b.l.Target;"#"==(w="#"==w.charAt(0)?"#"+op(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),y=Ro("text:a",y,{"xlink:href":w.replace(/&/g,"&amp;")})}s.push("          "+Ro("table:table-cell",Ro("text:p",y,{}),p)+"\n")}else s.push(t)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")};return function(e,t){var a=[ro],n=Io({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=Io({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(a.push("<office:document"+n+s+">\n"),a.push(su().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+n+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var a=0;a<t["!cols"].length;++a)if(t["!cols"][a]){var n=t["!cols"][a];if(null==n.width&&null==n.wpx&&null==n.wch)continue;kf(n),n.ods=r;var s=t["!cols"][a].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++r}});var a=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=a;var n=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+a+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+n+'"/>\n'),e.push("  </style:style>\n"),++a}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(a,e),a.push("  <office:body>\n"),a.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)a.push(r(e.Sheets[e.SheetNames[i]],e,i));return a.push("    </office:spreadsheet>\n"),a.push("  </office:body>\n"),"fods"==t.bookType?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function _x(e,t){if("fods"==t.bookType)return Cx(e,t);var r=Zl(),a="",n=[],s=[];return Ql(r,a="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ql(r,a="content.xml",Cx(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),Ql(r,a="styles.xml",Ax(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),Ql(r,a="meta.xml",ro+su()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),Ql(r,a="manifest.rdf",function(e){var t=[ro];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(au(e[r][0],e[r][1])),t.push(nu("",e[r][0]));return t.push(au("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),n.push([a,"application/rdf+xml"]),Ql(r,a="META-INF/manifest.xml",function(e){var t=[ro];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(n)),r}function Tx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ex(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Ao(vi(e))}function Lx(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):xi(Co(e))}function Px(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(e){r.set(e,a),a+=e.length}),r}function Ox(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Fx(e,t){var r=t?t[0]:0,a=127&e[r];e:if(e[r++]>=128){if(a|=(127&e[r])<<7,e[r++]<128)break e;if(a|=(127&e[r])<<14,e[r++]<128)break e;if(a|=(127&e[r])<<21,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),a}function Dx(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ix(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Rx(e){for(var t=[],r=[0];r[0]<e.length;){var a,n=r[0],s=Fx(e,r),i=7&s,l=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var o=r[0];e[r[0]++]>=128;);a=e.slice(o,r[0]);break;case 5:l=4,a=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,a=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Fx(e,r),a=e.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:a,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function Mx(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(Dx(8*r+e.type)),2==e.type&&t.push(Dx(e.data.length)),t.push(e.data))})}),Px(t)}function Bx(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Ux(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Fx(e,a),s=Rx(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:Ix(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=Rx(t.data),n=Ix(r[3][0].data);i.messages.push({meta:r,data:e.slice(a[0],a[0]+n)}),a[0]+=n}),(null==(t=s[3])?void 0:t[0])&&(i.merge=Ix(s[3][0].data)>>>0>0),r.push(i)}return r}function zx(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:Dx(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:Dx(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(e){a.push(e.data),e.meta[3]=[{type:0,data:Dx(e.data.length)}],r[2].push({data:Mx(e.meta),type:2})});var n=Mx(r);t.push(Dx(n.length)),t.push(n),a.forEach(function(e){return t.push(e)})}),Px(t)}function qx(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Fx(t,r),n=[];r[0]<t.length;){var s=3&t[r[0]];if(0!=s){var i=0,l=0;if(1==s?(l=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(l=1+(t[r[0]++]>>2),2==s?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Px(n)],0==i)throw new Error("Invalid offset 0");if(i>n[0].length)throw new Error("Invalid offset beyond length");if(l>=i)for(n.push(n[0].slice(-i)),l-=i;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-i,-i+l))}else{var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}n.push(t.slice(r[0],r[0]+o)),r[0]+=o}}var d=Px(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function Hx(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(qx(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Px(t)}function Wx(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=Dx(a),i=s.length;t.push(s),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,n[0]=0,n[1]=255&i,n[2]=i>>8&255,n[3]=i>>16&255,r+=a}return Px(t)}function Vx(e,t,r){var a,n=Tx(e),s=n.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,a=1&e[t+14],n=t+13;n>=t;--n)a=256*a+e[n];return(128&e[t+15]?-a:a)*Math.pow(10,r-6176)}(e,i),i+=16),2&s&&(d=n.getFloat64(i,!0),i+=8),4&s&&(u.setTime(u.getTime()+1e3*n.getFloat64(i,!0)),i+=8),8&s&&(o=n.getUint32(i,!0),i+=4),16&s&&(l=n.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:a={t:"n",v:c};break;case 3:a={t:"s",v:t[o]};break;case 5:a={t:"d",v:u};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(!(l>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));a={t:"s",v:r[l]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return a}function Gx(e,t){var r=new Uint8Array(32),a=Tx(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var a=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(127&a)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=255&n;e[t+15]|=r>=0?0:128}(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function Kx(e,t){var r=new Uint8Array(32),a=Tx(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function Yx(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,a){var n,s=Tx(e),i=s.getUint32(4,!0),l=(a>1?12:8)+4*Ox(i&(a>1?3470:398)),o=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&i&&(o=s.getUint32(l,!0),l+=4),l+=4*Ox(i&(a>1?12288:4096)),16&i&&(c=s.getUint32(l,!0),l+=4),32&i&&(d=s.getFloat64(l,!0),l+=8),64&i&&(u.setTime(u.getTime()+1e3*s.getFloat64(l,!0)),l+=8),e[2]){case 0:break;case 2:n={t:"n",v:d};break;case 3:n={t:"s",v:t[c]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:d>0};break;case 7:n={t:"n",v:d/86400};break;case 8:n={t:"e",v:0};break;case 9:if(o>-1)n={t:"s",v:r[o]};else if(c>-1)n={t:"s",v:t[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));n={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return n}(e,t,r,e[0]);case 5:return Vx(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Xx(e){return Fx(Rx(e)[1][0].data)}function $x(e,t){var r=Rx(t.data),a=Ix(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(t){var r=Rx(t.data),n=Ix(r[1][0].data)>>>0;switch(a){case 1:s[n]=Ex(r[3][0].data);break;case 8:var i=Rx(e[Xx(r[9][0].data)][0].data),l=e[Xx(i[1][0].data)][0],o=Ix(l.meta[1][0].data);if(2001!=o)throw new Error("2000 unexpected reference to ".concat(o));var c=Rx(l.data);s[n]=c[3].map(function(e){return Ex(e.data)}).join("")}}),s}function Jx(e,t){var r,a=Rx(t.data),n=(null==(r=null==a?void 0:a[7])?void 0:r[0])?Ix(a[7][0].data)>>>0>0?1:0:-1,s=Bx(a[5],function(e){return function(e,t){var r,a,n,s,i,l,o,c,d,u,h,f,m,p,g,x,b=Rx(e),v=Ix(b[1][0].data)>>>0,y=Ix(b[2][0].data)>>>0,w=(null==(a=null==(r=b[8])?void 0:r[0])?void 0:a.data)&&Ix(b[8][0].data)>0||!1;if((null==(s=null==(n=b[7])?void 0:n[0])?void 0:s.data)&&0!=t)g=null==(l=null==(i=b[7])?void 0:i[0])?void 0:l.data,x=null==(c=null==(o=b[6])?void 0:o[0])?void 0:c.data;else{if(!(null==(u=null==(d=b[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=b[4])?void 0:h[0])?void 0:f.data,x=null==(p=null==(m=b[3])?void 0:m[0])?void 0:p.data}for(var N=w?4:1,j=Tx(g),k=[],S=0;S<g.length/2;++S){var A=j.getUint16(2*S,!0);A<65535&&k.push([S,A])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var C=[];for(S=0;S<k.length-1;++S)C[k[S][0]]=x.subarray(k[S][1]*N,k[S+1][1]*N);return k.length>=1&&(C[k[k.length-1][0]]=x.subarray(k[k.length-1][1]*N)),{R:v,cells:C}}(e,n)});return{nrows:Ix(a[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,a){if(e[t.R][a])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(a));e[t.R][a]=r}),e},[])}}function Qx(e,t){var r={"!ref":"A1"},a=e[Xx(Rx(t.data)[2][0].data)],n=Ix(a[0].meta[1][0].data);if(6001!=n)throw new Error("6000 unexpected reference to ".concat(n));return function(e,t,r){var a,n=Rx(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ix(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Ix(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=sd(s);var i=Rx(n[4][0].data),l=$x(e,e[Xx(i[4][0].data)][0]),o=(null==(a=i[17])?void 0:a[0])?$x(e,e[Xx(i[17][0].data)][0]):[],c=Rx(i[3][0].data),d=0;c[1].forEach(function(t){var a=Rx(t.data),n=e[Xx(a[2][0].data)][0],s=Ix(n.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=Jx(0,n);i.data.forEach(function(e,t){e.forEach(function(e,a){var n=ad({r:d+t,c:a}),s=Yx(e,l,o);s&&(r[n]=s)})}),d+=i.nrows})}(e,a[0],r),r}function Zx(e,t){var r={SheetNames:[],Sheets:{}};if(Bx(Rx(t.data)[1],Xx).forEach(function(t){e[t].forEach(function(t){if(2==Ix(t.meta[1][0].data)){var a=function(e,t){var r,a=Rx(t.data),n={name:(null==(r=a[1])?void 0:r[0])?Ex(a[1][0].data):"",sheets:[]};return Bx(a[2],Xx).forEach(function(t){e[t].forEach(function(t){6e3==Ix(t.meta[1][0].data)&&n.sheets.push(Qx(e,t))})}),n}(e,t);a.sheets.forEach(function(e,t){Eb(r,e,0==t?a.name:a.name+"_"+t,!0)})}})}),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function eb(e){var t,r,a,n,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=Hx(e.content)}catch(mT){return console.log("?? "+e.content.length+" "+(mT.message||mT))}try{r=Ux(t)}catch(mT){return console.log("## "+(mT.message||mT))}r.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var l=(null==(n=null==(a=null==(r=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:r.meta)?void 0:a[1])?void 0:n[0].data)&&1==Ix(s[1][0].meta[1][0].data)&&s[1][0];if(l||i.forEach(function(e){s[e].forEach(function(e){if(1==Ix(e.meta[1][0].data)>>>0){if(l)throw new Error("Document has multiple roots");l=e}})}),!l)throw new Error("Cannot find Document root");return Zx(s,l)}function tb(e,t,r){var a,n,s,i;if(!(null==(a=e[6])?void 0:a[0])||!(null==(n=e[7])?void 0:n[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(s=e[8])?void 0:s[0])?void 0:i.data)&&Ix(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var l=0,o=Tx(e[7][0].data),c=0,d=[],u=Tx(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(o.setUint16(2*m,c,!0),u.setUint16(2*m,h,!0),typeof t[m]){case"string":p=Gx({t:"s",v:t[m]},r),g=Kx({t:"s",v:t[m]},r);break;case"number":p=Gx({t:"n",v:t[m]},r),g=Kx({t:"n",v:t[m]},r);break;case"boolean":p=Gx({t:"b",v:t[m]},r),g=Kx({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(p),c+=p.length,f.push(g),h+=g.length,++l}else o.setUint16(2*m,65535,!0),u.setUint16(2*m,65535);for(e[2][0].data=Dx(l);m<e[7][0].data.length/2;++m)o.setUint16(2*m,65535,!0),u.setUint16(2*m,65535,!0);return e[6][0].data=Px(d),e[3][0].data=Px(f),l}function rb(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];void 0===t[a[0]]&&(t[a[0]]=a[1]),"n"===a[2]&&(t[a[0]]=Number(t[a[0]]))}}}function ab(e){rb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function nb(e){rb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function sb(e,t,r,a,n,s,i,l,o,c,d,u){try{s[a]=eu(Xl(e,r,!0),t);var h,f=Yl(e,t);switch(l){case"sheet":h=pg(f,t,n,o,s[a],c,d,u);break;case"chart":if(!(h=gg(f,t,n,o,s[a],c))||!h["!drawel"])break;var m=to(h["!drawel"].Target,t),p=Zd(m),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(Xl(e,m,!0),eu(Xl(e,p,!0),m)),x=to(g,m),b=Zd(x);h=Jp(Xl(e,x,!0),0,0,eu(Xl(e,b,!0),x),0,h);break;case"macro":y=t,s[a],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[a]);break;default:throw new Error("Unrecognized sheet type "+l)}i[a]=h;var v=[];s&&s[a]&&Nl(s[a]).forEach(function(r){var n="";if(s[a][r].Type==Qd.CMNT){n=to(s[a][r].Target,t);var i=vg(Yl(e,n,!0),n,o);if(!i||!i.length)return;cm(h,i,!1)}s[a][r].Type==Qd.TCMNT&&(n=to(s[a][r].Target,t),v=v.concat(function(e,t){var r=[],a=!1,n={},s=0;return e.replace(so,function(i,l){var o=oo(i);switch(co(o[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":n={author:o.personId,guid:o.id,ref:o.ref,T:1};break;case"</threadedComment>":null!=n.t&&r.push(n);break;case"<text>":case"<text":s=l+i.length;break;case"</text>":n.t=e.slice(s,l).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":a=!0;break;case"</mentions>":case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}(Yl(e,n,!0),o)))}),v&&v.length&&cm(h,v,!0,o.people||[])}catch(mT){if(o.WTF)throw mT}var y}function ib(e){return"/"==e.charAt(0)?e.slice(1):e}function lb(e,t){if(ml(),ab(t=t||{}),Gl(e,"META-INF/manifest.xml"))return kx(e,t);if(Gl(e,"objectdata.xml"))return kx(e,t);if(Gl(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return eb(e);var r=bl.utils.cfb_new();return Jl(e).forEach(function(t){Ql(r,t,$l(e,t))}),eb(r)}if(!Gl(e,"[Content_Types].xml")){if(Gl(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Gl(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var a,n,s=Jl(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(so)||[]).forEach(function(e){var a=oo(e);switch(a[0].replace(io,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":void 0!==t[Xd[a.ContentType]]&&t[Xd[a.ContentType]].push(a.PartName)}}),t.xmlns!==Wo)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(Xl(e,"[Content_Types].xml")),l=!1;if(0===i.workbooks.length&&Yl(e,n="xl/workbook.xml",!0)&&i.workbooks.push(n),0===i.workbooks.length){if(!Yl(e,n="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(n),l=!0}"bin"==i.workbooks[0].slice(-3)&&(l=!0);var o={},c={};if(!t.bookSheets&&!t.bookProps){if(cp=[],i.sst)try{cp=bg(Yl(e,ib(i.sst)),i.sst,t)}catch(mT){if(t.WTF)throw mT}t.cellStyles&&i.themes.length&&(o=function(e,t,r){return em(e,r)}(Xl(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=xg(Yl(e,ib(i.style)),i.style,o,t))}i.links.map(function(r){try{eu(Xl(e,Zd(ib(r))),r);return wg(Yl(e,ib(r)),0,r,t)}catch(mT){}});var d=mg(Yl(e,ib(i.workbooks[0])),i.workbooks[0],t),u={},h="";i.coreprops.length&&((h=Yl(e,ib(i.coreprops[0]),!0))&&(u=ou(h)),0!==i.extprops.length&&(h=Yl(e,ib(i.extprops[0]),!0))&&function(e,t,r){var a={};t||(t={}),e=Ao(e),uu.forEach(function(r){var n=(e.match(_o(r[0]))||[])[1];switch(r[2]){case"string":n&&(t[r[1]]=fo(n));break;case"bool":t[r[1]]="true"===n;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(a[r[1]]=s[1])}}),a.HeadingPairs&&a.TitlesOfParts&&fu(a.HeadingPairs,a.TitlesOfParts,t,r)}(h,u,t));var f={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(h=Xl(e,ib(i.custprops[0]),!0))&&(f=function(e,t){var r={},a="",n=e.match(pu);if(n)for(var s=0;s!=n.length;++s){var i=n[s],l=oo(i);switch(l[0]){case"<?xml":case"<Properties":break;case"<property":a=fo(l.name);break;case"</property>":a=null;break;default:if(0===i.indexOf("<vt:")){var o=i.split(">"),c=o[0].slice(4),d=o[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[a]=fo(d);break;case"bool":r[a]=wo(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=Il(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,o)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}(h,t));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?a=d.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(a=u.SheetNames),t.bookProps&&(m.Props=u,m.Custprops=f),t.bookSheets&&"undefined"!==typeof a&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var p={};t.bookDeps&&i.calcchain&&(p=yg(Yl(e,ib(i.calcchain)),i.calcchain));var g,x,b=0,v={},y=d.Sheets;u.Worksheets=y.length,u.SheetNames=[];for(var w=0;w!=y.length;++w)u.SheetNames[w]=y[w].name;var N=l?"bin":"xml",j=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,j+1)+"_rels/"+i.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Gl(e,k)||(k="xl/_rels/workbook."+N+".rels");var S=eu(Xl(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Ng(Yl(e,ib(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var r=[],a=!1;return e.replace(so,function(e){var n=oo(e);switch(co(n[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:n.displayname,id:n.id});break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+n[0]+" in threaded comments")}return e}),r}(Yl(e,ib(i.people[0])),t)),S&&(S=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,Qd.WS.indexOf(r)>-1?"sheet":Qd.CS&&r==Qd.CS?"chart":Qd.DS&&r==Qd.DS?"dialog":Qd.MS&&r==Qd.MS?"macro":r&&r.length?r:"sheet")];var r})}catch(mT){return null}return e&&0!==e.length?e:null}(S,d.Sheets));var A=Yl(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=u.Worksheets;++b){var C="sheet";if(S&&S[b]?(g="xl/"+S[b][1].replace(/[\/]?xl\//,""),Gl(e,g)||(g=S[b][1]),Gl(e,g)||(g=k.replace(/_rels\/.*$/,"")+S[b][1]),C=S[b][2]):g=(g="xl/worksheets/sheet"+(b+1-A)+"."+N).replace(/sheet0\./,"sheet."),x=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(u.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var _=!1,T=0;T!=t.sheets.length;++T)"number"==typeof t.sheets[T]&&t.sheets[T]==b&&(_=1),"string"==typeof t.sheets[T]&&t.sheets[T].toLowerCase()==u.SheetNames[b].toLowerCase()&&(_=1);if(!_)continue e}}sb(e,g,x,u.SheetNames[b],b,v,a,C,t,d,o,c)}return m={Directory:i,Workbook:d,Props:u,Custprops:f,Deps:p,Sheets:a,SheetNames:u.SheetNames,Strings:cp,Styles:c,Themes:o,SSF:Ml(Oi)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Yl(e,ib(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(m.vbaraw=Yl(e,"xl/vbaProject.bin",!0))),m}function ob(e,t){var r=t||{},a="Workbook",n=bl.find(e,a);try{if(a="/!DataSpaces/Version",!(n=bl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=rf(e,4),t.U=rf(e,4),t.W=rf(e,4)}(n.content),a="/!DataSpaces/DataSpaceMap",!(n=bl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(af(e));return t}(n.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=bl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(n.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=bl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);nf(n.content)}catch(mT){}if(a="/EncryptionInfo",!(n=bl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=function(e){var t=rf(e);switch(t.Minor){case 2:return[t.Minor,of(e)];case 3:return[t.Minor,cf()];case 4:return[t.Minor,df(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(n.content);if(a="/EncryptedPackage",!(n=bl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(4==l[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(l[1],n.content,r.password||"",r);if(2==l[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function cb(e,t){return"ods"==t.bookType?_x(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=nd(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(sd(a)));var s=Nb(r,{range:a,header:1}),i=["~Sh33tJ5~"];s.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var l={},o=[],c=bl.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&Ux(Hx(t.content)).forEach(function(e){o.push(e.id),l[e.id]={deps:[],location:r,type:Ix(e.messages[0].meta[1][0].data)}})}),o.sort(function(e,t){return e-t});var d=o.filter(function(e){return e>1}).map(function(e){return[e,Dx(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Ux(Hx(t.content)).forEach(function(e){e.messages.forEach(function(t){d.forEach(function(t){e.messages.some(function(e){return 11006!=Ix(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}(e.data,t[1])})&&l[t[0]].deps.push(e.id)})})})});for(var u,h=bl.find(c,l[1].location),f=Ux(Hx(h.content)),m=0;m<f.length;++m){var p=f[m];1==p.id&&(u=p)}var g=Xx(Rx(u.messages[0].data)[1][0].data);for(f=Ux(Hx((h=bl.find(c,l[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Xx(Rx(u.messages[0].data)[2][0].data),f=Ux(Hx((h=bl.find(c,l[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Xx(Rx(u.messages[0].data)[2][0].data),f=Ux(Hx((h=bl.find(c,l[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);var x=Rx(u.messages[0].data);x[6][0].data=Dx(a.e.r+1),x[7][0].data=Dx(a.e.c+1);for(var b=Xx(x[46][0].data),v=bl.find(c,l[b].location),y=Ux(Hx(v.content)),w=0;w<y.length&&y[w].id!=b;++w);if(y[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var N=Rx(y[w].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var j=0;j<=a.e.c;++j){var k=[];k[1]=k[2]=[{type:0,data:Dx(j+420690)}],N[1].push({type:2,data:Mx(k)}),N[2].push({type:0,data:Dx(j)}),N[3].push({type:0,data:Dx(j)})}N[4]=[],N[5]=[],N[6]=[];for(var S=0;S<=a.e.r;++S)(k=[])[1]=k[2]=[{type:0,data:Dx(S+726270)}],N[4].push({type:2,data:Mx(k)}),N[5].push({type:0,data:Dx(S)}),N[6].push({type:0,data:Dx(S)});y[w].messages[0].data=Mx(N),v.content=Wx(zx(y)),v.size=v.content.length,delete x[46];var A=Rx(x[4][0].data);A[7][0].data=Dx(a.e.r+1);var C=Xx(Rx(A[1][0].data)[2][0].data);if((y=Ux(Hx((v=bl.find(c,l[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var _=Rx(y[0].messages[0].data);for(S=0;S<s.length;++S){var T=Rx(_[2][0].data);T[1][0].data=Dx(S),T[4][0].data=Dx(s[S].length),_[2][S]={type:_[2][0].type,data:Mx(T)}}y[0].messages[0].data=Mx(_),v.content=Wx(zx(y)),v.size=v.content.length;var E=Xx(A[2][0].data);if((y=Ux(Hx((v=bl.find(c,l[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";for(_=Rx(y[0].messages[0].data),j=0;j<=a.e.c;++j)(T=Rx(_[2][0].data))[1][0].data=Dx(j),T[4][0].data=Dx(a.e.r+1),_[2][j]={type:_[2][0].type,data:Mx(T)};y[0].messages[0].data=Mx(_),v.content=Wx(zx(y)),v.size=v.content.length;var L=Xx(A[4][0].data);!function(){for(var e,t=bl.find(c,l[L].location),r=Ux(Hx(t.content)),a=0;a<r.length;++a){var n=r[a];n.id==L&&(e=n)}var s=Rx(e.messages[0].data);s[3]=[];var o=[];i.forEach(function(e,t){o[1]=[{type:0,data:Dx(t)}],o[2]=[{type:0,data:Dx(1)}],o[3]=[{type:2,data:Lx(e)}],s[3].push({type:2,data:Mx(o)})}),e.messages[0].data=Mx(s);var d=Wx(zx(r));t.content=d,t.size=t.content.length}();var P=Rx(A[3][0].data),O=P[1][0];delete P[2];var F=Rx(O.data),D=Xx(F[2][0].data);!function(){for(var e,t=bl.find(c,l[D].location),r=Ux(Hx(t.content)),n=0;n<r.length;++n){var o=r[n];o.id==D&&(e=o)}var d=Rx(e.messages[0].data);delete d[6],delete P[7];var u=new Uint8Array(d[5][0].data);d[5]=[];for(var h=0,f=0;f<=a.e.r;++f){var m=Rx(u);h+=tb(m,s[f],i),m[1][0].data=Dx(f),d[5].push({data:Mx(m),type:2})}d[1]=[{type:0,data:Dx(a.e.c+1)}],d[2]=[{type:0,data:Dx(a.e.r+1)}],d[3]=[{type:0,data:Dx(h)}],d[4]=[{type:0,data:Dx(a.e.r+1)}],e.messages[0].data=Mx(d);var p=Wx(zx(r));t.content=p,t.size=t.content.length}(),O.data=Mx(F),A[3][0].data=Mx(P),x[4][0].data=Mx(A),u.messages[0].data=Mx(x);var I=Wx(zx(f));return h.content=I,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){lm=1024,e&&!e.SSF&&(e.SSF=Ml(Oi));e&&e.SSF&&(ml(),fl(e.SSF),t.revssf=Sl(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,up?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",a=mm.indexOf(t.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};nb(t=t||{});var s=Zl(),i="",l=0;t.cellXfs=[],pp(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(i="docProps/core.xml",Ql(s,i,du(e.Props,t)),n.coreprops.push(i),ru(t.rels,2,i,Qd.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var o=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ql(s,i,mu(e.Props)),n.extprops.push(i),ru(t.rels,3,i,Qd.EXT_PROPS),e.Custprops!==e.Props&&Nl(e.Custprops||{}).length>0&&(Ql(s,i="docProps/custom.xml",gu(e.Custprops)),n.custprops.push(i),ru(t.rels,4,i,Qd.CUST_PROPS));for(l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},u=e.Sheets[e.SheetNames[l-1]];(u||{})["!type"];if(Ql(s,i="xl/worksheets/sheet"+l+"."+r,jg(l-1,i,t,e,d)),n.sheets.push(i),ru(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Qd.WS[0]),u){var h=u["!comments"],f=!1,m="";h&&h.length>0&&(Ql(s,m="xl/comments"+l+"."+r,kg(h,m,t)),n.comments.push(m),ru(d,-1,"../comments"+l+"."+r,Qd.CMNT),f=!0),u["!legacy"]&&f&&Ql(s,"xl/drawings/vmlDrawing"+l+".vml",om(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&Ql(s,Zd(i),tu(d))}null!=t.Strings&&t.Strings.length>0&&(Ql(s,i="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?ef:Qh)(e,r)}(t.Strings,i,t)),n.strs.push(i),ru(t.wbrels,-1,"sharedStrings."+r,Qd.SST));i="xl/workbook."+r,Ql(s,i,function(e,t,r){return(".bin"===t.slice(-4)?fg:cg)(e,r)}(e,i,t)),n.workbooks.push(i),ru(t.rels,1,i,Qd.WB),i="xl/theme/theme1.xml",Ql(s,i,tm(e.Themes,t)),n.themes.push(i),ru(t.wbrels,-1,"theme/theme1.xml",Qd.THEME),i="xl/styles."+r,Ql(s,i,function(e,t,r){return(".bin"===t.slice(-4)?Vf:Pf)(e,r)}(e,i,t)),n.styles.push(i),ru(t.wbrels,-1,"styles."+r,Qd.STY),e.vbaraw&&a&&(Ql(s,i="xl/vbaProject.bin",e.vbaraw),n.vba.push(i),ru(t.wbrels,-1,"vbaProject.bin",Qd.VBA));return i="xl/metadata."+r,Ql(s,i,function(e){return(".bin"===e.slice(-4)?sm:im)()}(i)),n.metadata.push(i),ru(t.wbrels,-1,"metadata."+r,Qd.XLMETA),Ql(s,"[Content_Types].xml",Jd(n,t)),Ql(s,"_rels/.rels",tu(t.rels)),Ql(s,"xl/_rels/workbook."+r+".rels",tu(t.wbrels)),delete t.revssf,delete t.ssf,s}(e,t):db(e,t)}function db(e,t){lm=1024,e&&!e.SSF&&(e.SSF=Ml(Oi)),e&&e.SSF&&(ml(),fl(e.SSF),t.revssf=Sl(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,up?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=mm.indexOf(t.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};nb(t=t||{});var s=Zl(),i="",l=0;if(t.cellXfs=[],pp(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Ql(s,i="docProps/core.xml",du(e.Props,t)),n.coreprops.push(i),ru(t.rels,2,i,Qd.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var o=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ql(s,i,mu(e.Props)),n.extprops.push(i),ru(t.rels,3,i,Qd.EXT_PROPS),e.Custprops!==e.Props&&Nl(e.Custprops||{}).length>0&&(Ql(s,i="docProps/custom.xml",gu(e.Custprops)),n.custprops.push(i),ru(t.rels,4,i,Qd.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},h=e.Sheets[e.SheetNames[l-1]];(h||{})["!type"];if(Ql(s,i="xl/worksheets/sheet"+l+"."+r,Dp(l-1,t,e,u)),n.sheets.push(i),ru(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Qd.WS[0]),h){var f=h["!comments"],m=!1,p="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(Ql(s,p="xl/threadedComments/threadedComment"+l+"."+r,um(f,d,t)),n.threadedcomments.push(p),ru(u,-1,"../threadedComments/threadedComment"+l+"."+r,Qd.TCMNT)),Ql(s,p="xl/comments"+l+"."+r,dm(f)),n.comments.push(p),ru(u,-1,"../comments"+l+"."+r,Qd.CMNT),m=!0}h["!legacy"]&&m&&Ql(s,"xl/drawings/vmlDrawing"+l+".vml",om(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Ql(s,Zd(i),tu(u))}return null!=t.Strings&&t.Strings.length>0&&(Ql(s,i="xl/sharedStrings."+r,Qh(t.Strings,t)),n.strs.push(i),ru(t.wbrels,-1,"sharedStrings."+r,Qd.SST)),Ql(s,i="xl/workbook."+r,cg(e)),n.workbooks.push(i),ru(t.rels,1,i,Qd.WB),Ql(s,i="xl/theme/theme1.xml",tm(e.Themes,t)),n.themes.push(i),ru(t.wbrels,-1,"theme/theme1.xml",Qd.THEME),Ql(s,i="xl/styles."+r,Pf(e,t)),n.styles.push(i),ru(t.wbrels,-1,"styles."+r,Qd.STY),e.vbaraw&&a&&(Ql(s,i="xl/vbaProject.bin",e.vbaraw),n.vba.push(i),ru(t.wbrels,-1,"vbaProject.bin",Qd.VBA)),Ql(s,i="xl/metadata."+r,im()),n.metadata.push(i),ru(t.wbrels,-1,"metadata."+r,Qd.XLMETA),d.length>1&&(Ql(s,i="xl/persons/person.xml",function(e){var t=[ro,Ro("personList",null,{xmlns:Go,"xmlns:x":ec[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,r){t.push(Ro("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),n.people.push(i),ru(t.wbrels,-1,"persons/person.xml",Qd.PEOPLE)),Ql(s,"[Content_Types].xml",Jd(n,t)),Ql(s,"_rels/.rels",tu(t.rels)),Ql(s,"xl/_rels/workbook.xml.rels",tu(t.wbrels)),delete t.revssf,delete t.ssf,s}function ub(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=hi(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function hb(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ig(e.slice(r),t);default:break e}return Uh.to_workbook(e,t)}function fb(e,t,r,a){return a?(r.type="string",Uh.to_workbook(e,r)):Uh.to_workbook(t,r)}function mb(e,t){ai();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return mb(new Uint8Array(e),((r=Ml(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var a,n=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),dp={},r.dateNF&&(dp.dateNF=r.dateNF),r.type||(r.type=fi&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=fi?"buffer":"binary",n=function(e){if("undefined"!==typeof vl)return vl.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(mT){if(!mT.message||!mT.message.match(/onstruct/))throw mT}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||fi||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,n=function(e){return e.match(/[^\x00-\x7F]/)?Co(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return(r=Ml(r)).type="array",mb(yi(n),r)}switch((a=ub(n,r))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return function(e,t){return bl.find(e,"EncryptedPackage")?ob(e,t):Qg(e,t)}(bl.read(n,r),r);break;case 9:if(a[1]<=8)return Qg(n,r);break;case 60:return Ig(n,r);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===a[1])return function(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=Rh.to_workbook(e,r);return r.WTF=a,n}catch(mT){if(r.WTF=a,!mT.message.match(/SYLK bad record ID/)&&a)throw mT;return Uh.to_workbook(e,t)}}(n,r);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return Mh.to_workbook(n,r);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?function(e,t){var r=e,a=t||{};return a.type||(a.type=fi&&Buffer.isBuffer(e)?"buffer":"base64"),lb(eo(r,a),a)}(n,r):fb(e,n,r,s);case 239:return 60===a[3]?Ig(n,r):fb(e,n,r,s);case 255:if(254===a[1])return function(e,t){var r=e;return"base64"==t.type&&(r=hi(r)),r=ii.utils.decode(1200,r.slice(2),"str"),t.type="binary",hb(r,t)}(n,r);if(0===a[1]&&2===a[2]&&0===a[3])return zh.to_workbook(n,r);break;case 0:if(0===a[1]){if(a[2]>=2&&0===a[3])return zh.to_workbook(n,r);if(0===a[2]&&(8===a[3]||9===a[3]))return zh.to_workbook(n,r)}break;case 3:case 131:case 139:case 140:return Ih.to_workbook(n,r);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return pf.to_workbook(n,r);break;case 10:case 13:case 32:return function(e,t){var r="",a=ub(e,t);switch(t.type){case"base64":r=hi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Rl(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]&&(r=Ao(r)),t.type="binary",hb(r,t)}(n,r);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet")}return Dh.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ih.to_workbook(n,r):fb(e,n,r,s)}function pb(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return wl(t.file,bl.write(e,{type:fi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return bl.write(e,t)}function gb(e,t){var r={},a=fi?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?bl.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof n){if("binary"==t.type||"base64"==t.type)return n;n=new Uint8Array(bi(n))}return t.password&&"undefined"!==typeof encrypt_agile?pb(encrypt_agile(n,t.password),t):"file"===t.type?wl(t.file,n):"string"==t.type?Ao(n):n}function xb(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return ui(Co(a));case"binary":return Co(a);case"string":return e;case"file":return wl(t.file,a,"utf8");case"buffer":return fi?mi(a,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(a):xb(a,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bb(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return"base64"==t.type?ui(r):"string"==t.type?Ao(r):r;case"file":return wl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function vb(e,t){ai(),lg(e);var r=Ml(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var a=vb(e,r);return r.type="array",bi(a)}var n=0;if(r.sheet&&(n="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return xb(qg(e,r),r);case"slk":case"sylk":return xb(Rh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return xb(xx(e.Sheets[e.SheetNames[n]],r),r);case"txt":return function(e,t){switch(t.type){case"base64":return ui(e);case"binary":case"string":return e;case"file":return wl(t.file,e,"binary");case"buffer":return fi?mi(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(Ab(e.Sheets[e.SheetNames[n]],r),r);case"csv":return xb(Sb(e.Sheets[e.SheetNames[n]],r),r,"\ufeff");case"dif":return xb(Mh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return bb(Ih.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return xb(Uh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return xb(pf.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return xb(Bh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return xb(_x(e,r),r);case"wk1":return bb(zh.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return bb(zh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),bb(ux(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return pb(Zg(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r=Ml(t||{});return gb(cb(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function yb(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function wb(e,t,r,a,n,s,i,l){var o=Zc(r),c=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,h=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(mT){h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var m=i?e[r][f]:e[a[f]+o];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[f]){if(null==p)if("e"==m.t&&null===p)h[s[f]]=null;else if(void 0!==c)h[s[f]]=c;else{if(!d||null!==p)continue;h[s[f]]=null}else h[s[f]]=d&&("n"!==m.t||"n"===m.t&&!1!==l.rawNumbers)?p:od(m,p,l);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=s[f]&&(h[s[f]]=c)}}return{row:h,isempty:u}}function Nb(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?a=1:"A"===c.header?a=2:Array.isArray(c.header)?a=3:null==c.header&&(a=0),typeof d){case"string":o=id(d);break;case"number":(o=id(e["!ref"])).s.r=d;break;default:o=d}a>0&&(n=0);var u=Zc(o.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),x=o.s.r,b=0,v={};g&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=o.s.c;b<=o.e.c;++b)if(!(y[b]||{}).hidden)switch(h[b]=td(b),r=g?e[x][b]:e[h[b]+u],a){case 1:s[b]=b-o.s.c;break;case 2:s[b]=h[b];break;case 3:s[b]=c.header[b-o.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),l=i=od(r,null,c),p=v[i]||0){do{l=i+"_"+p++}while(v[l]);v[i]=p,v[l]=1}else v[i]=1;s[b]=l}for(x=o.s.r+n;x<=o.e.r;++x)if(!(w[x]||{}).hidden){var N=wb(e,o,x,h,a,s,g,c);(!1===N.isempty||(1===a?!1!==c.blankrows:c.blankrows))&&(f[m++]=N.row)}return f.length=m,f}var jb=/"/g;function kb(e,t,r,a,n,s,i,l){for(var o=!0,c=[],d="",u=Zc(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var f=l.dense?(e[r]||[])[h]:e[a[h]+u];if(null==f)d="";else if(null!=f.v){o=!1,d=""+(l.rawNumbers&&"n"==f.t?f.v:od(f,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===n||p===s||34===p||l.forceQuotes){d='"'+d.replace(jb,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(o=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(jb,'""')+'"'));c.push(d)}return!1===l.blankrows&&o?null:c.join(i)}function Sb(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";var n=id(e["!ref"]),s=void 0!==a.FS?a.FS:",",i=s.charCodeAt(0),l=void 0!==a.RS?a.RS:"\n",o=l.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),d="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],f=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(h[m]||{}).hidden||(u[m]=td(m));for(var p=0,g=n.s.r;g<=n.e.r;++g)(f[g]||{}).hidden||null!=(d=kb(e,n,g,u,i,o,s,a))&&(a.strip&&(d=d.replace(c,"")),(d||!1!==a.blankrows)&&r.push((p++?l:"")+d));return delete a.dense,r.join("")}function Ab(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=Sb(e,t);if("undefined"==typeof ii||"string"==t.type)return r;var a=ii.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}function Cb(e,t,r){var a,n=r||{},s=+!n.skipHeader,i=e||{},l=0,o=0;if(i&&null!=n.origin)if("number"==typeof n.origin)l=n.origin;else{var c="string"==typeof n.origin?rd(n.origin):n.origin;l=c.r,o=c.c}var d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+s}};if(i["!ref"]){var u=id(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==l&&(l=u.e.r+1,d.e.r=l+t.length-1+s)}else-1==l&&(l=0,d.e.r=t.length-1+s);var h=n.header||[],f=0;t.forEach(function(e,t){Nl(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],d="z",u="",m=ad({c:o+f,r:l+t+s});a=_b(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",n.cellDates||(d="n",c=Cl(c)),u=n.dateNF||Oi[14]):null===c&&n.nullError&&(d="e",c=0),a?(a.t=d,a.v=c,delete a.w,delete a.R,u&&(a.z=u)):i[m]=a={t:d,v:c},u&&(a.z=u)):i[m]=c})}),d.e.c=Math.max(d.e.c,o+h.length-1);var m=Zc(l);if(s)for(f=0;f<h.length;++f)i[td(f+o)+m]={t:"s",v:h[f]};return i["!ref"]=sd(d),i}function _b(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var a=rd(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return _b(e,ad("number"!=typeof t?t:{r:t,c:r||0}))}function Tb(){return{SheetNames:[],Sheets:{}}}function Eb(e,t,r,a){var n=1;if(!r)for(;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(r=i+n);++n);}if(ig(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Lb(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Pb={encode_col:td,encode_row:Zc,encode_cell:ad,encode_range:sd,decode_col:ed,decode_row:Qc,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:rd,decode_range:nd,format_cell:od,sheet_add_aoa:dd,sheet_add_json:Cb,sheet_add_dom:bx,aoa_to_sheet:ud,json_to_sheet:function(e,t){return Cb(null,e,t)},table_to_sheet:vx,table_to_book:function(e,t){return cd(vx(e,t),t)},sheet_to_csv:Sb,sheet_to_txt:Ab,sheet_to_json:Nb,sheet_to_html:xx,sheet_to_formulae:function(e){var t,r="",a="";if(null==e||null==e["!ref"])return[];var n,s=id(e["!ref"]),i="",l=[],o=[],c=Array.isArray(e);for(n=s.s.c;n<=s.e.c;++n)l[n]=td(n);for(var d=s.s.r;d<=s.e.r;++d)for(i=Zc(d),n=s.s.c;n<=s.e.c;++n)if(r=l[n]+i,a="",void 0!==(t=c?(e[d]||[])[n]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;a=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)a=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)a=""+t.v;else if("b"==t.t)a=t.v?"TRUE":"FALSE";else if(void 0!==t.w)a="'"+t.w;else{if(void 0===t.v)continue;a="s"==t.t?"'"+t.v:""+t.v}}o[o.length]=r+"="+a}return o},sheet_to_row_object_array:Nb,sheet_get_cell:_b,book_new:Tb,book_append_sheet:Eb,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Lb,cell_set_internal_link:function(e,t,r){return Lb(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,a){for(var n="string"!=typeof t?t:id(t),s="string"==typeof t?t:sd(t),i=n.s.r;i<=n.e.r;++i)for(var l=n.s.c;l<=n.e.c;++l){var o=_b(e,i,l);o.t="n",o.F=s,delete o.v,i==n.s.r&&l==n.s.c&&(o.f=r,a&&(o.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};$s.version;function Ob(e){let{modalOpen:t,onEditRate:r,refreshTrigger:a}=e;const[n,i]=(0,s.useState)("all"),[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(new Set),[x,b]=(0,s.useState)(null),[v,y]=(0,s.useState)([]),[w,N]=(0,s.useState)(!1),[j,k]=(0,s.useState)(!1),[S,A]=(0,s.useState)(null),[C,_]=(0,s.useState)(!1),T=[{code:"MSC",name:"MSC",color:"bg-red-600"},{code:"ONE",name:"ONE",color:"bg-purple-600"},{code:"YML",name:"YML",color:"bg-orange-600"},{code:"UNIFEEDER",name:"UNIFEEDER",color:"bg-teal-600"},{code:"OOCL",name:"OOCL",color:"bg-cyan-600"},{code:"RCL",name:"RCL",color:"bg-pink-600"},{code:"CMA",name:"CMA",color:"bg-amber-600"}],E=async()=>{o(!0),m(null);try{const e=(await Xn()).map(e=>{let t={};if(e.rateDataJson)try{t=JSON.parse(e.rateDataJson)}catch(mT){console.error("Error parsing rateDataJson:",mT)}return We(We(We({},e),t),{},{id:e.Id||e.id||e.sysID||e.SysId})});h(e)}catch(e){console.error("Error fetching rates:",e),m("Failed to load rates. Please try again.")}finally{o(!1)}},L=async e=>{N(!0);try{const t=await fetch("".concat(ma,"/rates/linear?category=").concat(e)),r=(await t.json()).map(e=>({id:e.Id||e.id,pol:e.Pol||e.pol,pod:e.Pod||e.pod,gp20Usd:e.Gp20Usd||e.gp20Usd||e.gp20_usd,hq40Usd:e.Hq40Usd||e.hq40Usd||e.hq40_usd,ttRouting:e.TtRouting||e.ttRouting||e.tt_routing,valid:e.Valid||e.valid,category:e.Category||e.category,origin:e.Pol||e.pol,destination:e.Pod||e.pod,rate20GP:e.Gp20Usd||e.gp20Usd||e.gp20_usd,rate40HQ:e.Hq40Usd||e.hq40Usd||e.hq40_usd,transitTime:e.TtRouting||e.ttRouting||e.tt_routing,validateDate:e.Valid||e.valid,freightType:"SEA-EXPORT-FCL",liner:e.Category||e.category,route:"".concat(e.Pol||e.pol||"","-").concat(e.Pod||e.pod||""),currency:"USD"}));y(r)}catch(t){console.error("Error fetching liner rates:",t),y([])}finally{N(!1)}};(0,s.useEffect)(()=>{E()},[a]);const P=e=>{i(e),b(null)},O=e=>{const t=new Set(p);t.has(e)?t.delete(e):t.add(e),g(t)},F=()=>{x?L(x):E()},D=async e=>{if(window.window.confirm("Are you sure you want to delete this rate?"))try{const t=x?"".concat(ma,"/rates/linear/").concat(e):"".concat(ma,"/rates/").concat(e);if(!(await fetch(t,{method:"DELETE"})).ok)throw new Error("Delete failed");x?L(x):E()}catch(t){window.alert("Failed to delete rate.")}},I=e=>{const t=null===e||void 0===e?void 0:e.toUpperCase();return null!==t&&void 0!==t&&t.includes("AIR-IMPORT")?"bg-yellow-500":null!==t&&void 0!==t&&t.includes("AIR-EXPORT")?"bg-yellow-300":null!==t&&void 0!==t&&t.includes("SEA-IMPORT-FCL")?"bg-blue-600":null!==t&&void 0!==t&&t.includes("SEA-EXPORT-FCL")?"bg-indigo-600":null!==t&&void 0!==t&&t.includes("SEA-IMPORT-LCL")?"bg-teal-600":null!==t&&void 0!==t&&t.includes("SEA-EXPORT-LCL")?"bg-cyan-600":null!==t&&void 0!==t&&t.includes("AIR")?"bg-yellow-500":null!==t&&void 0!==t&&t.includes("SEA")?"bg-blue-500":"bg-slate-500"},R=e=>{let{type:t}=e;const r=null===t||void 0===t?void 0:t.toLowerCase();return null!==r&&void 0!==r&&r.includes("air")?(0,ga.jsx)(wn,{className:"w-4 h-4"}):null!==r&&void 0!==r&&r.includes("sea")?(0,ga.jsx)(jn,{className:"w-4 h-4"}):null},M=e=>null===e||void 0===e||""===e?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),B=e=>{if(!e)return"-";const t=new Date(e),r=new Date,a=Math.ceil((t-r)/864e5),n=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return a<0?(0,ga.jsxs)("span",{className:"text-red-600 font-medium",children:[n," (Expired)"]}):a<=7?(0,ga.jsxs)("span",{className:"text-orange-600 font-medium",children:[n," (",a,"d left)"]}):n},U=e=>{var t,r,a,n,s,i,l,o,c,d,u,h;return null!==(t=e.freightType)&&void 0!==t&&t.toLowerCase().includes("air")?null!==(n=null!==(s=null!==(i=null!==(l=null!==(o=e.rate45Plus)&&void 0!==o?o:e.rate45MinusM)&&void 0!==l?l:e.rate45Minus)&&void 0!==i?i:e.rate100)&&void 0!==s?s:e.rateM)&&void 0!==n?n:"-":null!==(r=e.freightType)&&void 0!==r&&r.toLowerCase().includes("fcl")?null!==(c=null!==(d=null!==(u=e.rate20GP)&&void 0!==u?u:e.rate40GP)&&void 0!==d?d:e.rate40HQ)&&void 0!==c?c:"-":null!==(a=e.freightType)&&void 0!==a&&a.toLowerCase().includes("lcl")&&null!==(h=e.lclRate)&&void 0!==h?h:"-"},z=e=>{if(!e)return null;const t="DIRECT"===(null===e||void 0===e?void 0:e.toUpperCase());return(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ".concat(t?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"),children:[(0,ga.jsx)(_n,{className:"w-3 h-3"}),t?"Direct":"Transshipment"]})},q=(()=>{let e=u;if("liner"!==n){switch(n){case"air":e=u.filter(e=>{var t;return null===(t=e.freightType)||void 0===t?void 0:t.toLowerCase().includes("air")});break;case"sea":e=u.filter(e=>{var t;return null===(t=e.freightType)||void 0===t?void 0:t.toLowerCase().includes("sea")});break;default:e=u}c.trim()&&(e=e.filter(e=>{var t,r,a,n,s;return(null===(t=e.origin)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||(null===(r=e.destination)||void 0===r?void 0:r.toLowerCase().includes(c.toLowerCase()))||(null===(a=e.airline)||void 0===a?void 0:a.toLowerCase().includes(c.toLowerCase()))||(null===(n=e.liner)||void 0===n?void 0:n.toLowerCase().includes(c.toLowerCase()))||(null===(s=e.route)||void 0===s?void 0:s.toLowerCase().includes(c.toLowerCase()))}))}return e})(),H=x?v:q,W=x?w:l,V=T.find(e=>e.code===x);return(0,ga.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 bg-slate-50 min-h-screen",children:[(0,ga.jsxs)("div",{className:"max-w-[1800px] mx-auto",children:[(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ln,{className:"w-8 h-8 text-indigo-600"}),"Rates Management"]}),(0,ga.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage and compare freight rates across routes"})]}),x?(0,ga.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-6 py-3 ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-lg font-medium hover:opacity-90 transition-all shadow-lg hover:shadow-xl"),children:[(0,ga.jsx)(Ks,{className:"w-5 h-5"}),"Create New Rate for ",x]}):(0,ga.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-lg hover:shadow-xl",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),"Create New Rate"]})]}),(0,ga.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,ga.jsxs)("button",{onClick:()=>P("all"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("all"===n?"bg-indigo-600 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:["All Rates (",u.length,")"]}),(0,ga.jsxs)("button",{onClick:()=>P("air"),className:"px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ".concat("air"===n?"bg-yellow-500 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:[(0,ga.jsx)(wn,{className:"w-4 h-4"})," Air Freight"]}),(0,ga.jsxs)("button",{onClick:()=>P("sea"),className:"px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ".concat("sea"===n?"bg-blue-500 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:[(0,ga.jsx)(jn,{className:"w-4 h-4"})," Sea Freight"]}),(0,ga.jsx)("div",{className:"w-px bg-slate-300 mx-2"}),T.map(e=>(0,ga.jsxs)("button",{onClick:()=>{return t=e.code,b(t),i("liner"),void L(t);var t},className:"px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ".concat(x===e.code?"".concat(e.color," text-white shadow-md"):"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:[(0,ga.jsx)(jn,{className:"w-4 h-4"})," ",e.name]},e.code))]}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search by origin, destination, carrier, or route...",value:c,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white"})]})]}),f&&(0,ga.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded",children:(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"font-medium text-red-800",children:"Error Loading Rates"}),(0,ga.jsx)("p",{className:"text-red-600 text-sm mt-1",children:f}),(0,ga.jsx)("button",{onClick:F,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Try Again"})]})]})}),W&&!f&&(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-8 text-center",children:[(0,ga.jsx)(Ys,{className:"w-8 h-8 text-indigo-600 animate-spin mx-auto mb-4"}),(0,ga.jsx)("p",{className:"text-slate-600",children:"Loading rates..."})]}),!W&&!f&&(0,ga.jsxs)("div",{className:"space-y-3",children:[x&&(0,ga.jsx)("div",{className:"".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-xl p-4 mb-4 shadow-md"),children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)(jn,{className:"w-6 h-6"}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h3",{className:"text-lg font-bold",children:[x," Rates"]}),(0,ga.jsxs)("p",{className:"text-sm opacity-90",children:["Showing ",v.length," rates for ",x]})]})]}),(0,ga.jsxs)("button",{onClick:()=>k(!0),className:"bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-all flex items-center gap-2",children:[(0,ga.jsx)(Ks,{className:"w-4 h-4"}),"Upload Excel"]})]})}),H.map(e=>{var t,a,n,s,i;const l=p.has(e.sysID||e.id),o=null===(t=e.freightType)||void 0===t?void 0:t.toLowerCase().includes("air"),c=null===(a=e.freightType)||void 0===a?void 0:a.toLowerCase().includes("fcl"),d=null===(n=e.freightType)||void 0===n?void 0:n.toLowerCase().includes("lcl"),u=x&&e.category;return(0,ga.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,ga.jsxs)("div",{className:"p-4",children:[u?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 items-center",children:[(0,ga.jsx)("div",{className:"col-span-2",children:(0,ga.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"),children:[(0,ga.jsx)(jn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{className:"uppercase",children:x})]})}),(0,ga.jsxs)("div",{className:"col-span-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-indigo-600"}),(0,ga.jsx)("span",{className:"font-bold",children:e.pol||e.origin||"-"})]}),(0,ga.jsx)("div",{className:"flex-1 h-px bg-slate-300 relative",children:(0,ga.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,ga.jsx)(_n,{className:"w-4 h-4 text-slate-400 bg-white"})})}),(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-emerald-600"}),(0,ga.jsx)("span",{className:"font-bold",children:e.pod||e.destination||"-"})]})]}),(e.ttRouting||e.transitTime)&&(0,ga.jsxs)("div",{className:"mt-1 text-xs text-slate-500 flex items-center gap-1",children:[(0,ga.jsx)(nn,{className:"w-3 h-3"}),e.ttRouting||e.transitTime]})]}),(0,ga.jsxs)("div",{className:"col-span-2",children:[(0,ga.jsx)("div",{className:"text-sm font-semibold text-slate-600",children:"20' GP"}),(0,ga.jsx)("div",{className:"text-lg font-bold text-indigo-600",children:e.gp20Usd||e.rate20GP?M(e.gp20Usd||e.rate20GP):"-"})]}),(0,ga.jsxs)("div",{className:"col-span-2",children:[(0,ga.jsx)("div",{className:"text-sm font-semibold text-slate-600",children:"40' HQ"}),(0,ga.jsx)("div",{className:"text-lg font-bold text-emerald-600",children:e.hq40Usd||e.rate40HQ?M(e.hq40Usd||e.rate40HQ):"-"})]}),(0,ga.jsxs)("div",{className:"col-span-1",children:[(0,ga.jsx)("div",{className:"text-sm font-semibold text-slate-700",children:"USD"}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Currency"})]}),(0,ga.jsx)("div",{className:"col-span-1",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-slate-400"}),B(e.valid||e.validateDate)]})}),(0,ga.jsx)("div",{className:"col-span-1 flex items-center justify-end gap-2",children:(0,ga.jsx)("button",{onClick:()=>D(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Rate",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})})]}),(0,ga.jsxs)("div",{className:"md:hidden space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"),children:[(0,ga.jsx)(jn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{className:"uppercase",children:x})]}),(0,ga.jsx)("button",{onClick:()=>D(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Rate",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]}),(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-indigo-600"}),(0,ga.jsx)("span",{className:"font-bold text-sm",children:e.pol||e.origin||"-"}),(0,ga.jsx)(_n,{className:"w-4 h-4 text-slate-400"}),(0,ga.jsx)(Tn,{className:"w-4 h-4 text-emerald-600"}),(0,ga.jsx)("span",{className:"font-bold text-sm",children:e.pod||e.destination||"-"})]}),(e.ttRouting||e.transitTime)&&(0,ga.jsxs)("div",{className:"mt-2 text-xs text-slate-500 flex items-center gap-1",children:[(0,ga.jsx)(nn,{className:"w-3 h-3"}),e.ttRouting||e.transitTime]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ga.jsxs)("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[(0,ga.jsx)("div",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"20' GP"}),(0,ga.jsx)("div",{className:"text-lg font-bold text-indigo-700",children:e.gp20Usd||e.rate20GP?M(e.gp20Usd||e.rate20GP):"-"})]}),(0,ga.jsxs)("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3",children:[(0,ga.jsx)("div",{className:"text-xs font-semibold text-emerald-600 mb-1",children:"40' HQ"}),(0,ga.jsx)("div",{className:"text-lg font-bold text-emerald-700",children:e.hq40Usd||e.rate40HQ?M(e.hq40Usd||e.rate40HQ):"-"})]})]}),(0,ga.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,ga.jsx)("span",{className:"text-slate-600 font-medium",children:"USD"}),(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-slate-500",children:[(0,ga.jsx)(En,{className:"w-3 h-3"}),B(e.valid||e.validateDate)]})]})]})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 items-center",children:[(0,ga.jsx)("div",{className:"col-span-2",children:(0,ga.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat(I(e.freightType)),children:[(0,ga.jsx)(R,{type:e.freightType}),(0,ga.jsx)("span",{className:"uppercase",children:null===(s=e.freightType)||void 0===s?void 0:s.replace(/-/g," ")})]})}),(0,ga.jsxs)("div",{className:"col-span-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-indigo-600"}),(0,ga.jsx)("span",{className:"font-bold",children:e.origin||e.Origin||"-"})]}),(0,ga.jsx)("div",{className:"flex-1 h-px bg-slate-300 relative",children:(0,ga.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,ga.jsx)(_n,{className:"w-4 h-4 text-slate-400 bg-white"})})}),(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-emerald-600"}),(0,ga.jsx)("span",{className:"font-bold",children:e.destination||e.Destination||"-"})]})]}),(0,ga.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[z(e.routingType||e.RoutingType),(e.transitTime||e.TransitTime)>0&&(0,ga.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,ga.jsx)(nn,{className:"w-3 h-3"}),e.transitTime||e.TransitTime," days"]})]})]}),(0,ga.jsxs)("div",{className:"col-span-2",children:[(0,ga.jsx)("div",{className:"text-sm font-semibold",children:e.airline||e.liner||e.Airline||e.Liner||"-"}),(e.frequency||e.Frequency)&&(0,ga.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:e.frequency||e.Frequency})]}),(0,ga.jsxs)("div",{className:"col-span-1",children:[(0,ga.jsx)("div",{className:"text-sm font-semibold text-slate-700",children:e.currency||e.Currency||"USD"}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Currency"})]}),(0,ga.jsxs)("div",{className:"col-span-2",children:[(0,ga.jsx)("div",{className:"text-lg font-bold text-indigo-600",children:M(U(e))}),(0,ga.jsxs)("div",{className:"text-xs text-slate-500",children:[o&&"per kg (+45)",c&&"per container",d&&"per CBM"]})]}),(0,ga.jsx)("div",{className:"col-span-1",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-slate-400"}),B(e.validateDate||e.ValidateDate)]})}),(0,ga.jsxs)("div",{className:"col-span-1 flex items-center justify-end gap-2",children:[(0,ga.jsx)("button",{onClick:()=>r(e),className:"p-2 hover:bg-indigo-50 rounded-lg",children:(0,ga.jsx)(Kn,{className:"w-4 h-4 text-slate-600 hover:text-indigo-600"})}),(0,ga.jsx)("button",{onClick:()=>D(e.sysID||e.id),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,ga.jsx)(On,{className:"w-4 h-4 text-slate-600 hover:text-red-600"})}),(0,ga.jsx)("button",{onClick:()=>O(e.sysID||e.id),className:"p-2 hover:bg-slate-100 rounded-lg",children:l?(0,ga.jsx)(js,{className:"w-5 h-5"}):(0,ga.jsx)(un,{className:"w-5 h-5"})})]})]}),(0,ga.jsxs)("div",{className:"md:hidden space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat(I(e.freightType)),children:[(0,ga.jsx)(R,{type:e.freightType}),(0,ga.jsx)("span",{className:"uppercase",children:null===(i=e.freightType)||void 0===i?void 0:i.replace(/-/g," ")})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)("button",{onClick:()=>r(e),className:"p-2 hover:bg-indigo-50 rounded-lg",children:(0,ga.jsx)(Kn,{className:"w-4 h-4 text-slate-600 hover:text-indigo-600"})}),(0,ga.jsx)("button",{onClick:()=>D(e.sysID||e.id),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,ga.jsx)(On,{className:"w-4 h-4 text-slate-600 hover:text-red-600"})}),(0,ga.jsx)("button",{onClick:()=>O(e.sysID||e.id),className:"p-2 hover:bg-slate-100 rounded-lg",children:l?(0,ga.jsx)(js,{className:"w-5 h-5"}):(0,ga.jsx)(un,{className:"w-5 h-5"})})]})]}),(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-indigo-600"}),(0,ga.jsx)("span",{className:"font-bold text-sm",children:e.origin||e.Origin||"-"}),(0,ga.jsx)(_n,{className:"w-4 h-4 text-slate-400"}),(0,ga.jsx)(Tn,{className:"w-4 h-4 text-emerald-600"}),(0,ga.jsx)("span",{className:"font-bold text-sm",children:e.destination||e.Destination||"-"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[z(e.routingType||e.RoutingType),(e.transitTime||e.TransitTime)>0&&(0,ga.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,ga.jsx)(nn,{className:"w-3 h-3"}),e.transitTime||e.TransitTime," days"]})]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Carrier"}),(0,ga.jsx)("div",{className:"text-sm font-semibold",children:e.airline||e.liner||e.Airline||e.Liner||"-"}),(e.frequency||e.Frequency)&&(0,ga.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:e.frequency||e.Frequency})]}),(0,ga.jsxs)("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[(0,ga.jsxs)("div",{className:"text-xs text-indigo-600 mb-1",children:[o&&"per kg (+45)",c&&"per container",d&&"per CBM"]}),(0,ga.jsx)("div",{className:"text-lg font-bold text-indigo-700",children:M(U(e))})]})]}),(0,ga.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,ga.jsx)("span",{className:"text-slate-600 font-medium",children:e.currency||e.Currency||"USD"}),(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-slate-500",children:[(0,ga.jsx)(En,{className:"w-3 h-3"}),B(e.validateDate||e.ValidateDate)]})]})]})]}),!u&&l&&(0,ga.jsx)("div",{className:"border-t border-slate-200 bg-slate-50 p-6",children:(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Sn,{className:"w-4 h-4"})," Rate Breakdown"]}),(0,ga.jsxs)("div",{className:"bg-white rounded-lg p-5",children:[o&&(0,ga.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:[null!=e.rate45MinusM&&""!==e.rate45MinusM&&(0,ga.jsxs)("div",{className:"bg-amber-50 border border-amber-300 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs font-semibold text-amber-700",children:"Minimum (M)"}),(0,ga.jsx)("div",{className:"text-xl font-bold text-amber-800 mt-1",children:M(e.rate45MinusM)})]}),null!=e.rate45Minus&&""!==e.rate45Minus&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-600",children:"-45 kg"}),(0,ga.jsx)("div",{className:"text-xl font-bold text-slate-900 mt-1",children:M(e.rate45Minus)})]}),null!=e.rate45Plus&&""!==e.rate45Plus&&(0,ga.jsxs)("div",{className:"bg-indigo-50 border-2 border-indigo-400 rounded-lg p-4 text-center shadow-sm",children:[(0,ga.jsx)("div",{className:"text-sm font-bold text-indigo-700",children:"+45 kg"}),(0,ga.jsx)("div",{className:"text-2xl font-bold text-indigo-600 mt-1",children:M(e.rate45Plus)})]}),e.rate100&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-600",children:"+100 kg"}),(0,ga.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate100)})]}),e.rate300&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-600",children:"+300 kg"}),(0,ga.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate300)})]}),e.rate500&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-600",children:"+500 kg"}),(0,ga.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate500)})]}),e.rate1000&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-600",children:"+1000 kg"}),(0,ga.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate1000)})]})]}),c&&(0,ga.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.rate20GP&&(0,ga.jsxs)("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs font-semibold text-blue-700",children:"20' GP"}),(0,ga.jsx)("div",{className:"text-2xl font-bold text-blue-800 mt-1",children:M(e.rate20GP)})]}),e.rate40GP&&(0,ga.jsxs)("div",{className:"bg-indigo-50 border-2 border-indigo-400 rounded-lg p-4 text-center shadow-sm",children:[(0,ga.jsx)("div",{className:"text-xs font-semibold text-indigo-700",children:"40' GP"}),(0,ga.jsx)("div",{className:"text-2xl font-bold text-indigo-600 mt-1",children:M(e.rate40GP)})]}),e.rate40HQ&&(0,ga.jsxs)("div",{className:"bg-purple-50 border border-purple-300 rounded-lg p-4 text-center",children:[(0,ga.jsx)("div",{className:"text-xs font-semibold text-purple-700",children:"40' HQ"}),(0,ga.jsx)("div",{className:"text-2xl font-bold text-purple-800 mt-1",children:M(e.rate40HQ)})]})]}),d&&e.lclRate&&(0,ga.jsxs)("div",{className:"bg-emerald-50 border-2 border-emerald-400 rounded-lg p-4 text-center max-w-xs",children:[(0,ga.jsx)("div",{className:"text-sm font-semibold text-emerald-700",children:"LCL Rate per CBM"}),(0,ga.jsx)("div",{className:"text-3xl font-bold text-emerald-600 mt-2",children:M(e.lclRate)})]}),x&&!o&&!c&&!d&&(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsx)("p",{className:"text-sm text-slate-600 mb-3",children:"All rate fields from Excel:"}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[e.rate45Minus&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"-45 kg"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate45Minus)})]}),e.rate45MinusM&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Min (M)"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate45MinusM)})]}),e.rate45Plus&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"+45 kg"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate45Plus)})]}),e.rate100&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"+100 kg"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate100)})]}),e.rate300&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"+300 kg"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate300)})]}),e.rate500&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"+500 kg"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate500)})]}),e.rate1000&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"+1000 kg"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate1000)})]}),e.rate20GP&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"20' GP"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate20GP)})]}),e.rate40GP&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"40' GP"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate40GP)})]}),e.rate40HQ&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"40' HQ"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.rate40HQ)})]}),e.lclRate&&(0,ga.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"LCL per CBM"}),(0,ga.jsx)("div",{className:"text-lg font-bold",children:M(e.lclRate)})]})]})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Ua,{className:"w-4 h-4"})," Additional Information"]}),(0,ga.jsxs)("div",{className:"bg-white rounded-lg p-5 space-y-4",children:[e.routing&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Routing"}),(0,ga.jsx)("div",{className:"text-sm font-medium",children:e.routing})]}),e.surcharges&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Surcharges"}),(0,ga.jsx)("div",{className:"text-sm font-medium",children:e.surcharges})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t border-slate-100",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Created"}),(0,ga.jsx)("div",{className:"text-sm font-medium",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:"Owner"}),(0,ga.jsx)("div",{className:"text-sm font-medium",children:e.owner||"\u2014"})]})]})]})]})]})})]})},e.sysID||e.id)})]}),!W&&!f&&0===H.length&&(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-12 text-center",children:[(0,ga.jsx)(Ln,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,ga.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No rates found"}),(0,ga.jsx)("p",{className:"text-slate-500 mb-6",children:x?"No rates available for ".concat(x,". Upload an Excel file to get started."):c?"Try adjusting your search":"Create your first rate"}),!c&&!x&&(0,ga.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),"Create New Rate"]}),x&&(0,ga.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-6 py-3 ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-lg hover:opacity-90"),children:[(0,ga.jsx)(Ks,{className:"w-5 h-5"}),"Upload Excel for ",x]})]}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:F,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg",children:(0,ga.jsx)(Ys,{className:"w-5 h-5 ".concat(W?"animate-spin":"")})})})]}),j&&(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,ga.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,ga.jsx)("div",{className:"".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," p-6 text-white"),children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)(Xs,{className:"w-8 h-8"}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h2",{className:"text-2xl font-bold",children:["Upload Rates for ",x]}),(0,ga.jsx)("p",{className:"text-sm opacity-90 mt-1",children:"Upload an Excel file with your rate data"})]})]}),(0,ga.jsx)("button",{onClick:()=>{k(!1),A(null)},className:"p-2 hover:bg-white/20 rounded-lg transition-all",children:(0,ga.jsx)(Ea,{className:"w-6 h-6"})})]})}),(0,ga.jsxs)("div",{className:"p-6 space-y-6",children:[(0,ga.jsxs)("div",{className:"border-2 border-dashed border-slate-300 rounded-xl p-8 text-center hover:border-indigo-400 transition-all",children:[(0,ga.jsx)("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls",onChange:e=>{const t=e.target.files[0];if(t){if(!t.name.match(/\.(xlsx|xls)$/))return void window.alert("Please upload a valid Excel file (.xlsx or .xls)");A(t)}},className:"hidden"}),(0,ga.jsxs)("label",{htmlFor:"excel-upload",className:"cursor-pointer",children:[(0,ga.jsx)(Ks,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),(0,ga.jsx)("p",{className:"text-lg font-semibold text-slate-700 mb-2",children:S?S.name:"Click to upload or drag and drop"}),(0,ga.jsx)("p",{className:"text-sm text-slate-500",children:"Excel files (.xlsx, .xls) only"})]})]}),(0,ga.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,ga.jsxs)("h4",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[(0,ga.jsx)(Ua,{className:"w-5 h-5"}),"Upload Instructions"]}),(0,ga.jsxs)("button",{onClick:()=>{const e=[{freightType:"SEA-EXPORT-FCL",origin:"COLOMBO",destination:"CHENNAI",airline:"",liner:x||"MSC",route:"CMB-MAA",surcharges:"FSC: $50, THC: $100",transitTime:5,transshipmentTime:"",frequency:"3x Weekly",routingType:"DIRECT",validateDate:"2025-12-31",note:"Sample note",remark:"",owner:"John Doe",currency:"USD",category:x||"MSC",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:850,rate40GP:1200,rate40HQ:1300,lclRate:""},{freightType:"AIR-IMPORT",origin:"DUBAI",destination:"COLOMBO",airline:"EMIRATES",liner:"",route:"DXB-CMB",surcharges:"",transitTime:1,transshipmentTime:"",frequency:"Daily",routingType:"DIRECT",validateDate:"2025-06-30",note:"",remark:"Contact sales for bulk",owner:"Jane Smith",currency:"USD",category:x||"MSC",rate45Minus:3.5,rate45MinusM:200,rate45Plus:3.2,rate100:2.8,rate300:2.5,rate500:2.2,rate1000:2,rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:""},{freightType:"SEA-EXPORT-LCL",origin:"COLOMBO",destination:"SINGAPORE",airline:"",liner:x||"MSC",route:"CMB-SIN",surcharges:"",transitTime:7,transshipmentTime:"2 days",frequency:"2x Weekly",routingType:"TRANSSHIPMENT",validateDate:"2025-09-30",note:"",remark:"",owner:"Admin",currency:"USD",category:x||"MSC",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:55}],t=Pb.json_to_sheet(e);t["!cols"]=[{wch:18},{wch:12},{wch:12},{wch:15},{wch:12},{wch:12},{wch:20},{wch:12},{wch:15},{wch:12},{wch:15},{wch:12},{wch:20},{wch:20},{wch:12},{wch:10},{wch:10},{wch:12},{wch:12},{wch:12},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10}];const r=Pb.book_new();Pb.book_append_sheet(r,t,"Rates Template"),function(e,t,r){var a=r||{};a.type="file",a.file=t,yb(a),vb(e,a)}(r,"".concat(x||"Liner","_Rates_Template.xlsx"))},className:"text-sm bg-blue-600 text-white px-3 py-1.5 rounded-lg hover:bg-blue-700 transition-all flex items-center gap-1.5",children:[(0,ga.jsx)(Xs,{className:"w-4 h-4"}),"Download Template"]})]}),(0,ga.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1 ml-6 list-disc",children:[(0,ga.jsx)("li",{children:"Download the Excel template to see the required format"}),(0,ga.jsx)("li",{children:"Ensure your Excel file has a header row with column names"}),(0,ga.jsx)("li",{children:"Include columns like: Origin, Destination, Rate fields, Currency, etc."}),(0,ga.jsxs)("li",{children:["All rows will be automatically tagged with category: ",x]}),(0,ga.jsx)("li",{children:"Rate fields (rate45Plus, rate20GP, etc.) will be stored in rateDataJson"})]})]}),(0,ga.jsxs)("div",{className:"flex gap-3",children:[(0,ga.jsx)("button",{onClick:()=>{k(!1),A(null)},className:"flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-all",children:"Cancel"}),(0,ga.jsx)("button",{onClick:async()=>{if(S&&x){_(!0);try{let t,r;console.log("Starting Excel upload for:",x);try{if(t=mb(await S.arrayBuffer(),{type:"array"}),!t.SheetNames||0===t.SheetNames.length)throw new Error("No sheets found in Excel file");const e=t.SheetNames[0],a=t.Sheets[e];if(!a)throw new Error("Cannot read Excel sheet");r=Pb.sheet_to_json(a)}catch(e){let t="\u274c Cannot read Excel file\n\n";return t+="\ud83d\udccb Possible reasons:\n",t+="\u2022 File is corrupted or damaged\n",t+="\u2022 File is not a valid Excel format (.xlsx, .xls)\n",t+="\u2022 File is password protected\n",t+="\u2022 File is open in another program\n\n",t+="Technical error: ".concat(e.message),window.alert(t),void _(!1)}if(console.log("Parsed ".concat(r.length," rows from Excel")),console.log("Sample row:",r[0]),console.log("Column headers detected:",Object.keys(r[0]||{})),!r||0===r.length)return window.alert("Excel file is empty or could not be read. Please check the file format."),void _(!1);const a=r[0],n=Object.keys(a||{}),s=n.some(e=>"POL"===e.toUpperCase()||"ORIGIN"===e.toUpperCase()),i=n.some(e=>"POD"===e.toUpperCase()||"DESTINATION"===e.toUpperCase()),l=n.some(e=>e.includes("20GP")||e.includes("20 GP")||e.includes("40HQ")||e.includes("40 HQ")||e.toUpperCase().includes("GP20")||e.toUpperCase().includes("HQ40"));if(!s||!i||!l){let e="\u274c Excel file format error!\n\n";return e+="Missing required columns:\n",s||(e+="\u2022 POL (Port of Loading) or Origin column\n"),i||(e+="\u2022 POD (Port of Discharge) or Destination column\n"),l||(e+="\u2022 Rate columns (20GP USD, 40HQ-USD, etc.)\n"),e+="\n\ud83d\udccb Your Excel file has these columns:\n",e+=n.join(", ")||"No columns detected",e+="\n\n\u2705 Required format:\n",e+="\u2022 POL (or Origin)\n",e+="\u2022 POD (or Destination)\n",e+="\u2022 20GP USD (or 20GP-USD, 20GP_USD)\n",e+="\u2022 40HQ-USD (or 40HQ USD, 40HQ_USD)\n",e+="\u2022 TT/Routing (optional)\n",e+="\u2022 VALID (optional)\n",e+="\n\ud83d\udca1 Tip: Download the template for the correct format.",window.alert(e),void _(!1)}const o=r.map((e,t)=>{const r=e.POL||e.pol||e.Origin||e.origin||null,a=e.POD||e.pod||e.Destination||e.destination||null,n=e["20GP USD"]||e["20GP-USD"]||e["20GP_USD"]||e["20GP"]||e.gp20_usd||e.Gp20Usd||null,s=e["40HQ-USD"]||e["40HQ USD"]||e["40HQ_USD"]||e["40HQ"]||e.hq40_usd||e.Hq40Usd||null,i=e["TT/Routing"]||e["TT-Routing"]||e["TT/ROUITNG"]||e.TTRouting||e.tt_routing||e.TtRouting||null;let l=e["VALID "]||e.Valid||e.valid||e.validateDate||e.ValidateDate||null;if("number"===typeof l){const e=new Date(1899,11,30);l=new Date(e.getTime()+864e5*l).toISOString().split("T")[0]}else if(l instanceof Date)l=l.toISOString().split("T")[0];else if("string"===typeof l&&l.includes("/")){const e=l.split("/");3===e.length&&(l="".concat(e[2],"-").concat(e[0].padStart(2,"0"),"-").concat(e[1].padStart(2,"0")))}return r&&a||console.warn("Row ".concat(t+1," missing required fields:"),{pol:r,pod:a,gp20Usd:n,hq40Usd:s}),{Pol:r,Pod:a,Gp20Usd:n?parseFloat(n):null,Hq40Usd:s?parseFloat(s):null,TtRouting:i?String(i):null,Valid:l,Category:x}}),c=o.filter(e=>e.Pol&&e.Pod&&(e.Gp20Usd||e.Hq40Usd));if(0===c.length){let e="\u274c No valid data found in Excel file!\n\n";return e+="\ud83d\udccb Common issues:\n",e+="\u2022 POL/POD columns are empty\n",e+="\u2022 Rate columns (20GP USD, 40HQ-USD) are empty\n",e+="\u2022 Data starts from wrong row (should have headers in row 1)\n",e+="\n\u2705 Each row must have:\n",e+="\u2022 POL (Port of Loading)\n",e+="\u2022 POD (Port of Discharge)\n",e+="\u2022 At least one rate value (20GP USD or 40HQ-USD)\n",e+="\n\ud83d\udca1 Tip: Download the template and check your data format.",window.alert(e),void _(!1)}if(c.length<o.length){const e=o.length-c.length,t=Math.round(e/o.length*100);console.warn("\u26a0\ufe0f Skipping ".concat(e," rows (").concat(t,"%) with missing POL, POD, or rate values"));const r=o.filter(e=>!e.Pol||!e.Pod||!e.Gp20Usd&&!e.Hq40Usd).slice(0,3);if(console.warn("Sample of skipped rows:",r),e>0){const t="\u26a0\ufe0f Warning: ".concat(e," out of ").concat(o.length," rows will be skipped because they are missing:\n\n");let r=[];const a=o.filter(e=>!e.Pol).length,n=o.filter(e=>!e.Pod).length,s=o.filter(e=>!e.Gp20Usd&&!e.Hq40Usd).length;if(a>0&&r.push("\u2022 ".concat(a," rows: Missing POL/Origin")),n>0&&r.push("\u2022 ".concat(n," rows: Missing POD/Destination")),s>0&&r.push("\u2022 ".concat(s," rows: Missing rate values")),!window.confirm(t+r.join("\n")+"\n\n\u2705 Continue uploading ".concat(c.length," valid rows?")))return void _(!1)}}console.log("Uploading ".concat(c.length," valid rates for ").concat(x)),console.log("Sample transformed data:",c[0]);const d=await fetch("".concat(ma,"/rates/linear/bulk"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Rates:c})}),u=await d.json();if(console.log("Backend response:",u),!d.ok){let e="\u274c Upload Failed\n\n";throw u.message&&(e+="Error: ".concat(u.message,"\n\n")),400===d.status?(e+="\ud83d\udccb This usually means:\n",e+="\u2022 Invalid data format\n",e+="\u2022 Database constraint violation\n",e+="\u2022 Missing required fields\n"):500===d.status&&(e+="\u26a0\ufe0f Server error occurred.\n",e+="Please contact your administrator.\n"),e+="\n\ud83d\udca1 Check browser console for more details.",new Error(e)}{let e="";u.failCount>0?(e="\u2705 Upload Complete\n\n",e+="\u2022 Successfully uploaded: ".concat(u.successCount," rates\n"),e+="\u2022 Failed: ".concat(u.failCount," rates\n\n"),e+="\u26a0\ufe0f Some rates failed to upload. Check console for details."):e="\u2705 Success!\n\nUploaded ".concat(u.successCount," rates for ").concat(x),window.alert(e),k(!1),A(null),L(x)}}catch(t){console.error("Error uploading Excel:",t);let e="";t.message.includes("Failed to fetch")||t.message.includes("NetworkError")?(e="\u274c Network Error\n\n",e+="Cannot connect to server.\n",e+="Please check your internet connection."):t.message.startsWith("\u274c")?e=t.message:(e="\u274c Upload Failed\n\n".concat(t.message,"\n\n"),e+="\ud83d\udca1 Tips:\n",e+="\u2022 Check that your Excel file has the correct format\n",e+="\u2022 Ensure all required columns are filled\n",e+="\u2022 Try downloading and using the template\n",e+="\u2022 Check browser console for technical details"),window.alert(e)}finally{_(!1)}}else window.alert("Please select an Excel file and ensure a shipping line is selected.")},disabled:!S||C,className:"flex-1 px-6 py-3 ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-lg font-medium hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"),children:C?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Ys,{className:"w-5 h-5 animate-spin"}),"Uploading..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Ks,{className:"w-5 h-5"}),"Upload & Save"]})})]})]})]})})]})}function Fb(e){let{onClose:t,editRate:r,onSuccess:a}=e;const[n,i]=(0,s.useState)(1),[l,o]=(0,s.useState)(""),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)({}),[f,m]=(0,s.useState)({origin:"",destination:""}),[p,g]=(0,s.useState)([{id:1,airline:"",liner:"",route:"",currency:"USD",surcharges:"",transitTime:"",transshipmentTime:"",frequency:"",routingType:"DIRECT",validateDate:"",note:"",remark:"",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:""}]);(0,s.useEffect)(()=>{r&&(o(r.freightType||""),i(2),m({origin:r.origin||"",destination:r.destination||""}),g([{id:1,airline:r.airline||"",liner:r.liner||"",route:r.route||"",currency:r.currency||"USD",surcharges:r.surcharges||"",transitTime:r.transitTime||"",transshipmentTime:r.transshipmentTime||"",frequency:r.frequency||"",routingType:r.routingType||"DIRECT",validateDate:r.validateDate||"",note:r.note||"",remark:r.remark||"",rate45Minus:r.rate45Minus||"",rate45MinusM:r.rate45MinusM||"",rate45Plus:r.rate45Plus||"",rate100:r.rate100||"",rate300:r.rate300||"",rate500:r.rate500||"",rate1000:r.rate1000||"",rate20GP:r.rate20GP||"",rate40GP:r.rate40GP||"",rate40HQ:r.rate40HQ||"",lclRate:r.lclRate||""}]))},[r]);const x=e=>{o(e),i(2),r||g([We({id:1},b()),We({id:2},b()),We({id:3},b())])},b=()=>({airline:"",liner:"",route:"",currency:"USD",surcharges:"",transitTime:"",transshipmentTime:"",frequency:"",routingType:"DIRECT",validateDate:"",note:"",remark:"",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:""}),v=()=>{const e=Math.max(...p.map(e=>e.id))+1;g([...p,We({id:e},b())])},y=e=>{const{name:t,value:r}=e.target;m(e=>We(We({},e),{},{[t]:r}))},w=(e,t,r)=>{g(p.map(a=>a.id===e?We(We({},a),{},{[t]:r}):a))},N=async e=>{if(e.preventDefault(),(()=>{const e={};return f.origin||(e.origin="Origin is required"),f.destination||(e.destination="Destination is required"),p.some(e=>e.route||e.airline||e.liner||l.includes("air")&&(e.rate45Plus||e.rate100)||l.includes("fcl")&&(e.rate20GP||e.rate40GP)||l.includes("lcl")&&e.lclRate)||(e.routes="At least one route must have data"),p.forEach((t,r)=>{(t.route||t.airline||t.liner||l.includes("air")&&(t.rate45Plus||t.rate100)||l.includes("fcl")&&(t.rate20GP||t.rate40GP)||l.includes("lcl")&&t.lclRate)&&(t.note&&""!==t.note.trim()||(e["route_".concat(t.id,"_note")]="Note is required"),!l.includes("air")||t.remark&&""!==t.remark.trim()||(e["route_".concat(t.id,"_remark")]="Remark is required for air freight"))}),h(e),0===Object.keys(e).length})()){d(!0);try{if(r){const e=p[0],t={freightType:l,origin:f.origin,destination:f.destination,currency:e.currency,airline:e.airline||null,liner:e.liner||null,route:e.route||null,surcharges:e.surcharges||null,transitTime:e.transitTime||null,transshipmentTime:e.transshipmentTime||null,frequency:e.frequency||null,routingType:e.routingType||"DIRECT",validateDate:e.validateDate||null,note:e.note||null,remark:e.remark||null,rateDataJson:JSON.stringify({rate45Minus:e.rate45Minus||null,rate45MinusM:e.rate45MinusM||null,rate45Plus:e.rate45Plus||null,rate100:e.rate100||null,rate300:e.rate300||null,rate500:e.rate500||null,rate1000:e.rate1000||null,rate20GP:e.rate20GP||null,rate40GP:e.rate40GP||null,rate40HQ:e.rate40HQ||null,lclRate:e.lclRate||null})};await Jn(r.id,t),a()}else{const e=p.filter(e=>e.route||e.airline||e.liner||l.includes("air")&&(e.rate45Plus||e.rate100)||l.includes("fcl")&&(e.rate20GP||e.rate40GP)||l.includes("lcl")&&e.lclRate).map(e=>{const t={freightType:l,origin:f.origin,destination:f.destination,currency:e.currency,airline:e.airline||null,liner:e.liner||null,route:e.route||null,surcharges:e.surcharges||null,transitTime:e.transitTime||null,transshipmentTime:e.transshipmentTime||null,frequency:e.frequency||null,routingType:e.routingType||"DIRECT",validateDate:e.validateDate||null,note:e.note||null,remark:e.remark||null,rateDataJson:JSON.stringify({rate45Minus:e.rate45Minus||null,rate45MinusM:e.rate45MinusM||null,rate45Plus:e.rate45Plus||null,rate100:e.rate100||null,rate300:e.rate300||null,rate500:e.rate500||null,rate1000:e.rate1000||null,rate20GP:e.rate20GP||null,rate40GP:e.rate40GP||null,rate40HQ:e.rate40HQ||null,lclRate:e.lclRate||null})};return console.log("Creating rate with payload:",t),$n(t)});await Promise.all(e),a()}}catch(t){console.error("Error saving rates:",t),h({submit:"Failed to save rates. Please try again."})}finally{d(!1)}}},j=(e,t)=>{const r=l.includes("air"),a=l.includes("fcl"),n=l.includes("lcl");return(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-xl p-6 border-2 border-slate-200",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ga.jsxs)("h4",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(_n,{className:"w-5 h-5 text-indigo-600"}),"Route ",t+1]}),p.length>1&&(0,ga.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void(p.length>1&&g(p.filter(e=>e.id!==t)));var t},className:"p-2 hover:bg-red-50 rounded-lg transition-colors group",title:"Remove route",children:(0,ga.jsx)(On,{className:"w-5 h-5 text-slate-600 group-hover:text-red-600"})})]}),(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Airline"}),(0,ga.jsx)("input",{type:"text",value:e.airline,onChange:t=>w(e.id,"airline",t.target.value),placeholder:"Enter airline",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),!r&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Liner"}),(0,ga.jsx)("input",{type:"text",value:e.liner,onChange:t=>w(e.id,"liner",t.target.value),placeholder:"Enter liner",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Route"}),(0,ga.jsx)("input",{type:"text",value:e.route,onChange:t=>w(e.id,"route",t.target.value),placeholder:"e.g., CMB-SIN-BKK",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Currency"}),(0,ga.jsxs)("select",{value:e.currency,onChange:t=>w(e.id,"currency",t.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,ga.jsx)("option",{value:"USD",children:"USD"}),(0,ga.jsx)("option",{value:"EUR",children:"EUR"}),(0,ga.jsx)("option",{value:"GBP",children:"GBP"}),(0,ga.jsx)("option",{value:"LKR",children:"LKR"}),(0,ga.jsx)("option",{value:"AED",children:"AED"}),(0,ga.jsx)("option",{value:"SGD",children:"SGD"}),(0,ga.jsx)("option",{value:"CNY",children:"CNY"}),(0,ga.jsx)("option",{value:"JPY",children:"JPY"}),(0,ga.jsx)("option",{value:"AUD",children:"AUD"}),(0,ga.jsx)("option",{value:"CAD",children:"CAD"})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Routing Type"}),(0,ga.jsxs)("select",{value:e.routingType,onChange:t=>w(e.id,"routingType",t.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,ga.jsx)("option",{value:"DIRECT",children:"Direct"}),(0,ga.jsx)("option",{value:"TRANSSHIP",children:"Transship"})]})]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transit Time"}),(0,ga.jsx)("input",{type:"text",value:e.transitTime,onChange:t=>w(e.id,"transitTime",t.target.value),placeholder:"e.g., 5-7 days",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),r&&(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transshipment Time"}),(0,ga.jsx)("input",{type:"text",value:e.transshipmentTime,onChange:t=>w(e.id,"transshipmentTime",t.target.value),placeholder:"e.g., 2-3 hours",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Frequency"}),(0,ga.jsx)("input",{type:"text",value:e.frequency,onChange:t=>w(e.id,"frequency",t.target.value),placeholder:"e.g., Daily, 3x weekly",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Surcharges"}),(0,ga.jsx)("input",{type:"text",value:e.surcharges,onChange:t=>w(e.id,"surcharges",t.target.value),placeholder:"Enter applicable surcharges",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-slate-500"}),"Valid Until"]}),(0,ga.jsx)("input",{type:"date",value:e.validateDate,onChange:t=>w(e.id,"validateDate",t.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),r&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h5",{className:"font-medium text-slate-700 text-sm uppercase tracking-wide",children:"Air Freight Rates (USD/KG)"}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"-45 KG"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate45Minus,onChange:t=>w(e.id,"rate45Minus",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"-45 KG (M)"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate45MinusM,onChange:t=>w(e.id,"rate45MinusM",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+45 KG"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate45Plus,onChange:t=>w(e.id,"rate45Plus",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+100 KG"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate100,onChange:t=>w(e.id,"rate100",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+300 KG"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate300,onChange:t=>w(e.id,"rate300",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+500 KG"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate500,onChange:t=>w(e.id,"rate500",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+1000 KG"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate1000,onChange:t=>w(e.id,"rate1000",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]})]})]}),r&&(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Remark ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",value:e.remark,onChange:t=>w(e.id,"remark",t.target.value),placeholder:"Additional remarks for this rate",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat(u["route_".concat(e.id,"_remark")]?"border-red-500":"border-slate-300")}),u["route_".concat(e.id,"_remark")]&&(0,ga.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u["route_".concat(e.id,"_remark")]})]}),a&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h5",{className:"font-medium text-slate-700 text-sm uppercase tracking-wide",children:"FCL Container Rates (USD)"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"20' GP"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate20GP,onChange:t=>w(e.id,"rate20GP",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' GP"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate40GP,onChange:t=>w(e.id,"rate40GP",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' HQ"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.rate40HQ,onChange:t=>w(e.id,"rate40HQ",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})]}),n&&(0,ga.jsxs)("div",{className:"space-y-4",children:[(0,ga.jsx)("h5",{className:"font-medium text-slate-700 text-sm uppercase tracking-wide",children:"LCL Rate"}),(0,ga.jsxs)("div",{className:"md:w-1/3",children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"LCL Rate (USD/CBM or W/M)"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.lclRate,onChange:t=>w(e.id,"lclRate",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Note ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("textarea",{value:e.note,onChange:t=>w(e.id,"note",t.target.value),placeholder:"Additional notes for this rate...",rows:3,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none ".concat(u["route_".concat(e.id,"_note")]?"border-red-500":"border-slate-300")}),u["route_".concat(e.id,"_note")]&&(0,ga.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u["route_".concat(e.id,"_note")]})]})]})]},e.id)};return(0,ga.jsxs)("div",{className:"w-full max-w-7xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-6 flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:l.includes("air")?(0,ga.jsx)(wn,{className:"w-6 h-6 text-white"}):(0,ga.jsx)(jn,{className:"w-6 h-6 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h2",{className:"text-2xl font-bold text-white",children:r?"Edit Rate":"Create New Rate"}),2===n&&(0,ga.jsx)("p",{className:"text-indigo-100 text-sm mt-1",children:l.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:(0,ga.jsx)(Ea,{className:"w-6 h-6 text-white"})})]}),(0,ga.jsxs)("div",{className:"p-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[1===n&&(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"text-center mb-8",children:[(0,ga.jsx)("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Select Freight Type"}),(0,ga.jsx)("p",{className:"text-slate-600",children:"Choose the type of freight service for this rate"})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsx)("button",{onClick:()=>x("air-import"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-sky-500 hover:bg-sky-50 transition-all group",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center group-hover:bg-sky-500 transition-colors",children:(0,ga.jsx)(wn,{className:"w-6 h-6 text-sky-600 group-hover:text-white"})}),(0,ga.jsxs)("div",{className:"text-left",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Air Import"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Inbound air freight rates"})]})]})}),(0,ga.jsx)("button",{onClick:()=>x("air-export"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-sky-500 hover:bg-sky-50 transition-all group",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center group-hover:bg-sky-500 transition-colors",children:(0,ga.jsx)(wn,{className:"w-6 h-6 text-sky-600 group-hover:text-white"})}),(0,ga.jsxs)("div",{className:"text-left",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Air Export"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Outbound air freight rates"})]})]})}),(0,ga.jsx)("button",{onClick:()=>x("sea-import-fcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,ga.jsx)(jn,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,ga.jsxs)("div",{className:"text-left",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Import FCL"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Full container load import"})]})]})}),(0,ga.jsx)("button",{onClick:()=>x("sea-import-lcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,ga.jsx)(Nn,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,ga.jsxs)("div",{className:"text-left",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Import LCL"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Less than container load import"})]})]})}),(0,ga.jsx)("button",{onClick:()=>x("sea-export-fcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,ga.jsx)(jn,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,ga.jsxs)("div",{className:"text-left",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Export FCL"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Full container load export"})]})]})}),(0,ga.jsx)("button",{onClick:()=>x("sea-export-lcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,ga.jsx)(Nn,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,ga.jsxs)("div",{className:"text-left",children:[(0,ga.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Export LCL"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:"Less than container load export"})]})]})})]})]}),2===n&&(0,ga.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 border-2 border-indigo-200",children:[(0,ga.jsxs)("h4",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Tn,{className:"w-5 h-5 text-indigo-600"}),"Route Information"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Origin ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"origin",value:f.origin,onChange:y,placeholder:"e.g., CMB, Colombo",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat(u.origin?"border-red-500":"border-slate-300")}),u.origin&&(0,ga.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u.origin})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Destination ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"destination",value:f.destination,onChange:y,placeholder:"e.g., SIN, Singapore",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat(u.destination?"border-red-500":"border-slate-300")}),u.destination&&(0,ga.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u.destination})]})]})]}),(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("h4",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:["Create New Rate",p.length>1?"s":"",(0,ga.jsxs)("span",{className:"text-sm font-normal text-slate-600",children:["(",p.length," route",p.length>1?"s":"",")"]})]}),(0,ga.jsxs)("button",{type:"button",onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors text-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Route"]})]}),u.routes&&(0,ga.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,ga.jsx)("p",{className:"text-red-700 text-sm",children:u.routes})]})}),p.map((e,t)=>j(e,t))]}),u.submit&&(0,ga.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,ga.jsx)("p",{className:"text-red-700 text-sm",children:u.submit})]})}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-3 pt-6 border-t border-slate-200",children:[(0,ga.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all font-medium",disabled:c,children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",disabled:c,className:"px-6 py-3 text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 rounded-lg transition-all font-medium flex items-center gap-2 justify-center",children:c?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r?"Updating...":"Saving Rates..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Yn,{className:"w-4 h-4"}),r?"Update Rate":"Save ".concat(p.length," Rate").concat(p.length>1?"s":"")]})})]})]})]})]})}function Db(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(0),c=()=>{t(!1),i(null)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(Ob,{modalOpen:()=>{i(null),t(!0)},onEditRate:e=>{i(e),t(!0)},refreshTrigger:l})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:c}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Fb,{onClose:c,editRate:n,onSuccess:()=>{o(e=>e+1),c()}})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Ib=Ta("calendar-1",[["path",{d:"M11 14h1v4",key:"fy54vd"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",key:"12vinp"}]]),Rb=Ta("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Mb=Ta("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Bb=async e=>(await fa.put("".concat(ma,"/Activity"),e)).data,Ub=async e=>(await fa.post("".concat(ma,"/Statuslog"),e)).data;function zb(e){let{onOpen:t,onEdit:r,loading:a=!1,delay:n=0,activities:i,loadActivities:l,setActivities:o}=e;const[c,d]=(0,s.useState)(a),[u,h]=(0,s.useState)(""),[f,m]=(0,s.useState)(new Set),[p,g]=(0,s.useState)(new Set),[x,b]=(0,s.useState)({}),[v,y]=(0,s.useState)({}),[w,N]=(0,s.useState)({key:null,direction:"asc"}),j=async e=>{if(!x[e]){y(t=>We(We({},t),{},{[e]:!0}));try{const t=await(async e=>(await fa.get("".concat(ma,"/Statuslog/").concat(e))).data)(e);b(r=>We(We({},r),{},{[e]:t}))}catch(t){console.error("Error fetching activity history:",t),h("Failed to load activity history. Please try again.")}finally{y(t=>We(We({},t),{},{[e]:!1}))}}},k=async e=>{const t=new Set(p);t.has(e)?t.delete(e):(t.add(e),await j(e)),g(t)},S=(0,s.useMemo)(()=>{if(!w.key)return i;const e=[...i].sort((e,t)=>{let r,a;switch(w.key){case"startTime":r=new Date(e.startTime).getTime(),a=new Date(t.startTime).getTime();break;case"endTime":r=new Date(e.endTime).getTime(),a=new Date(t.endTime).getTime();break;case"owner":return r=(e.owner||"").toLowerCase(),a=(t.owner||"").toLowerCase(),"asc"===w.direction?r.localeCompare(a):a.localeCompare(r);default:return 0}return"asc"===w.direction?r-a:a-r});return e},[i,w]),A=e=>{r&&r(e.rawData)},C=async e=>{if(window.confirm("Are you sure you want to delete this activity?"))try{await(async e=>(await fa.delete("".concat(ma,"/Activity/").concat(e))).data)(e),o(i.filter(t=>t.id!==e)),m(t=>{const r=new Set(t);return r.delete(e),r})}catch(t){console.error("Error deleting activity:",t),h("Failed to delete activity. Please try again.")}},_=e=>{if(!e)return"";const t=new Date(e),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),n=t.getFullYear();let s=t.getHours();const i=String(t.getMinutes()).padStart(2,"0"),l=s>=12?"PM":"AM";s=s%12||12;const o=String(s).padStart(2,"0");return"".concat(r,"/").concat(a,"/").concat(n," ").concat(o,":").concat(i," ").concat(l)},T=()=>(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded w-24"}),(0,ga.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("div",{className:"min-w-full",children:[(0,ga.jsx)("div",{className:"grid grid-cols-8 gap-4 p-4 bg-slate-50 border-b border-slate-200",children:Array.from({length:8}).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))}),Array.from({length:3}).map((e,t)=>(0,ga.jsx)("div",{className:"grid grid-cols-8 gap-4 p-4 border-b border-slate-100",children:Array.from({length:8}).map((e,t)=>(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))},t))]})})]}),E=e=>{let{status:t,color:r}=e;return(0,ga.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(r),children:["completed"===t?(0,ga.jsx)(Rb,{className:"w-3 h-3"}):"in-progress"===t?(0,ga.jsx)(nn,{className:"w-3 h-3"}):(0,ga.jsx)(Mb,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"capitalize",children:t})]})},L=e=>{let{priority:t}=e;const r="high"===t?"bg-red-400":"medium"===t?"bg-amber-400":"bg-green-400";return(0,ga.jsx)("div",{className:"w-2 h-8 rounded-full ".concat(r)})},P=e=>{let{initials:t,fullName:r}=e;const a=["bg-blue-500","bg-purple-500","bg-pink-500","bg-green-500","bg-indigo-500","bg-red-500"],n=r||"Unassigned",s=n.split("").reduce((e,t)=>e+t.charCodeAt(0),0),i=a[s%a.length];return(0,ga.jsxs)("div",{className:"relative group",children:[(0,ga.jsx)("div",{className:"".concat(i," text-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm text-xs font-semibold cursor-pointer transition-transform hover:scale-110"),children:t}),(0,ga.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-slate-900 text-white text-xs rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-10",children:[n,(0,ga.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-slate-900"})]})]})},O=e=>{let{label:t,sortKey:r,align:a="left"}=e;const n=w.key===r,s=w.direction;return(0,ga.jsx)("th",{className:"px-4 py-3 text-".concat(a," text-xs font-semibold text-slate-600 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors select-none"),onClick:()=>(e=>{let t="asc";w.key===e&&"asc"===w.direction&&(t="desc"),N({key:e,direction:t})})(r),children:(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsx)("span",{children:t}),(0,ga.jsxs)("div",{className:"flex flex-col",children:[(0,ga.jsx)(js,{className:"w-3 h-3 -mb-1 ".concat(n&&"asc"===s?"text-blue-600":"text-slate-400")}),(0,ga.jsx)(un,{className:"w-3 h-3 ".concat(n&&"desc"===s?"text-blue-600":"text-slate-400")})]})]})})},F=e=>{let{activityId:t}=e;const r=x[t]||[];return v[t]?(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"10",className:"px-4 py-3 bg-slate-50",children:(0,ga.jsxs)("div",{className:"flex items-center justify-center gap-2 text-slate-500",children:[(0,ga.jsx)(Ys,{className:"w-4 h-4 animate-spin"}),(0,ga.jsx)("span",{className:"text-sm",children:"Loading history..."})]})})}):r&&0!==r.length?(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"10",className:"px-4 py-3 bg-slate-50",children:(0,ga.jsxs)("div",{className:"space-y-3",children:[(0,ga.jsx)("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Activity History"}),(0,ga.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,ga.jsx)("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:(0,ga.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,ga.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)(E,{status:e.new_status,color:"completed"===e.new_status?"bg-green-500":"in-progress"===e.new_status?"bg-blue-500":"bg-slate-500"}),(0,ga.jsx)("span",{className:"text-xs text-slate-500",children:_(e.created_at)})]}),e.note&&(0,ga.jsx)("p",{className:"text-sm text-slate-600 pl-1",children:e.note})]})})},e.sysID))})]})})}):(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"10",className:"px-4 py-3 bg-slate-50",children:(0,ga.jsx)("div",{className:"text-center text-sm text-slate-500",children:"No history available"})})})};return c?(0,ga.jsx)(T,{}):(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300 animate-slideInLeft",style:{animationDelay:"".concat(n,"ms"),animationFillMode:"both"},children:[u&&(0,ga.jsxs)("div",{className:"p-4 bg-red-50 border-b border-red-200 flex items-start gap-3",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,ga.jsx)("div",{children:(0,ga.jsx)("p",{className:"text-sm text-red-800",children:u})})]}),(0,ga.jsx)("div",{className:"overflow-x-auto max-h-[630px] overflow-y-auto",children:(0,ga.jsxs)("div",{className:"min-w-full",children:[(0,ga.jsx)("div",{className:"hidden lg:block",children:(0,ga.jsxs)("table",{className:"w-full relative",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0 z-10",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-4 py-3 text-left w-12"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Activity"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Type"}),(0,ga.jsx)(O,{label:"Owner",sortKey:"owner"}),(0,ga.jsx)(O,{label:"Start Time",sortKey:"startTime"}),(0,ga.jsx)(O,{label:"End Time",sortKey:"endTime"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Status"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Related Account"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-100",children:S.map(e=>{const t=e.typeIcon,r=p.has(e.id);return(0,ga.jsxs)(s.Fragment,{children:[(0,ga.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("button",{onClick:()=>k(e.id),className:"p-1 hover:bg-slate-200 rounded transition-all",title:r?"Collapse history":"Expand history",children:(0,ga.jsx)(zs,{className:"w-4 h-4 text-slate-500 transition-transform duration-200 ".concat(r?"rotate-90":"")})})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("div",{className:"flex items-center gap-2",children:(0,ga.jsx)(L,{priority:e.priority})})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(t,{className:"w-4 h-4 text-slate-500"}),(0,ga.jsx)("span",{className:"font-medium text-slate-900",children:e.title})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(e.typeColor),children:[(0,ga.jsx)(t,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.type})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(P,{initials:e.ownerInitial,fullName:e.owner})}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600 whitespace-nowrap",children:_(e.startTime)}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600 whitespace-nowrap",children:_(e.endTime)}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(E,{status:e.status,color:e.statusColor})}),(0,ga.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:e.relatedAccount}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("div",{className:"flex items-center gap-2",children:(0,ga.jsx)("button",{onClick:()=>A(e),className:"p-1.5 hover:bg-blue-100 rounded transition-colors",title:"Edit activity",children:(0,ga.jsx)(Pn,{className:"w-4 h-4 text-blue-600"})})})})]}),r&&(0,ga.jsx)(F,{activityId:e.id})]},e.id)})})]})}),(0,ga.jsx)("div",{className:"lg:hidden p-4 space-y-4",children:S.map(e=>{const t=e.typeIcon,r=p.has(e.id),a=x[e.id]||[],n=v[e.id];return(0,ga.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,ga.jsx)("button",{onClick:()=>k(e.id),className:"p-1 hover:bg-slate-200 rounded transition-all",children:(0,ga.jsx)(zs,{className:"w-4 h-4 text-slate-500 transition-transform duration-200 ".concat(r?"rotate-90":"")})}),(0,ga.jsx)(L,{priority:e.priority}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(t,{className:"w-4 h-4 text-slate-500"}),(0,ga.jsx)("h3",{className:"font-medium text-slate-900",children:e.title})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[(0,ga.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(e.typeColor),children:[(0,ga.jsx)(t,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.type})]}),(0,ga.jsx)(E,{status:e.status,color:e.statusColor})]})]})]}),(0,ga.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,ga.jsx)(P,{initials:e.ownerInitial,fullName:e.owner}),(0,ga.jsx)("span",{className:"text-xs text-slate-600 font-medium",children:e.owner||"Unassigned"})]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm text-slate-600",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(nn,{className:"w-4 h-4"}),(0,ga.jsxs)("span",{children:[_(e.startTime)," - ",_(e.endTime)]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(vn,{className:"w-4 h-4"}),(0,ga.jsxs)("span",{children:["Related: ",e.relatedAccount]})]})]}),r&&(0,ga.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-300",children:n?(0,ga.jsxs)("div",{className:"flex items-center justify-center gap-2 text-slate-500 py-4",children:[(0,ga.jsx)(Ys,{className:"w-4 h-4 animate-spin"}),(0,ga.jsx)("span",{className:"text-sm",children:"Loading history..."})]}):0===a.length?(0,ga.jsx)("div",{className:"text-center text-sm text-slate-500 py-4",children:"No history available"}):(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsx)("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Activity History"}),a.map(e=>(0,ga.jsx)("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)(E,{status:e.new_status,color:"completed"===e.new_status?"bg-green-500":"in-progress"===e.new_status?"bg-blue-500":"bg-slate-500"}),(0,ga.jsx)("span",{className:"text-xs text-slate-500",children:_(e.created_at)})]}),e.note&&(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:e.note})]})},e.sysID))]})}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,ga.jsxs)("button",{onClick:()=>A(e),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-100 text-blue-600 rounded transition-colors hover:bg-blue-200",children:[(0,ga.jsx)(Pn,{className:"w-4 h-4"}),"Edit"]}),(0,ga.jsxs)("button",{onClick:()=>C(e.id),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-red-100 text-red-600 rounded transition-colors hover:bg-red-200",children:[(0,ga.jsx)(On,{className:"w-4 h-4"}),"Delete"]})]})]},e.id)})})]})}),0===S.length&&!u&&(0,ga.jsxs)("div",{className:"text-center py-12",children:[(0,ga.jsx)(En,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),(0,ga.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No activities yet"}),(0,ga.jsx)("p",{className:"text-slate-500 mb-4",children:"Get started by creating your first activity"}),t&&(0,ga.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Activity"]})]})]})}const qb=Ta("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function Hb(e){let{isAdmin:t=!1,data:r=[],onClose:a}=e;const[n,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(new Date);(0,s.useEffect)(()=>{const e=new Date,t=e=>String(e).padStart(2,"0"),r=[e.getFullYear(),t(e.getMonth()+1),t(e.getDate())].join("-");i(r)},[]),(0,s.useEffect)(()=>{const e=setInterval(()=>{o(new Date)},6e4);return()=>clearInterval(e)},[]);const c=e=>{if(!e)return!1;const t=new Date(e);return l>t},d=(0,s.useMemo)(()=>{if(console.log("todayDate: ",n),!n||!r||0===r.length)return[];console.log("data are: ",r);return r.filter(e=>{if(!e.endTime)return!1;const t=new Date(e.endTime);if(isNaN(t.getTime()))return!1;return t.toISOString().split("T")[0]===n}).sort((e,t)=>new Date(e.endTime).getTime()-new Date(t.endTime).getTime())},[r,n]),u=e=>({Call:"bg-blue-100 text-blue-800",Meeting:"bg-purple-100 text-purple-800",Email:"bg-green-100 text-green-800",Task:"bg-orange-100 text-orange-800",Demo:"bg-pink-100 text-pink-800","Follow-up":"bg-yellow-100 text-yellow-800"}[e]||"bg-slate-100 text-slate-800");return(0,ga.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(En,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:n||"Loading..."}),(0,ga.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:[d.length," ",1===d.length?"Task":"Tasks"," Today"]})]})]}),(0,ga.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group ml-8","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:0===d.length?(0,ga.jsxs)("div",{className:"text-center py-12",children:[(0,ga.jsx)(En,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 text-lg",children:"No activities scheduled for today"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:"Create a new activity to get started"})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"hidden lg:block overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0 z-10",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"#"}),t&&(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Owner"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"End Time"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Activity"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Type"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Related Account"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-100",children:d.map((e,r)=>{const a=c(e.endTime);return(0,ga.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group ".concat(a?"opacity-60 bg-slate-50/50":""),children:[(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("span",{className:"text-sm font-medium text-slate-700",children:r+1}),a&&(0,ga.jsx)(qb,{className:"w-3 h-3 text-slate-400"})]})}),t&&(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("span",{className:"text-sm text-slate-700",children:e.owner||"N/A"})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("span",{className:"text-sm ".concat(a?"text-slate-500 line-through":"text-slate-700"),children:e.endTime?new Date(e.endTime).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"N/A"}),a&&(0,ga.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Passed"})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"max-w-xs",children:[(0,ga.jsx)("p",{className:"text-sm font-medium ".concat(a?"text-slate-500 line-through":"text-slate-800"," truncate"),children:e.title||"Untitled Activity"}),e.description&&(0,ga.jsx)("p",{className:"text-xs text-slate-500 truncate mt-1",children:e.description})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ".concat(u(e.type)),children:e.type||"N/A"})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)("span",{className:"text-sm text-slate-700",children:e.relatedAccount||"N/A"})})]},e.activityId||r)})})]})}),(0,ga.jsx)("div",{className:"lg:hidden space-y-4",children:d.map((e,r)=>{const a=c(e.endTime);return(0,ga.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow ".concat(a?"opacity-60 bg-slate-50":""),children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsxs)("span",{className:"text-sm font-semibold text-slate-700",children:["#",r+1]}),a&&(0,ga.jsx)(qb,{className:"w-3 h-3 text-slate-400"}),(0,ga.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(u(e.type)),children:e.type||"N/A"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("span",{className:"text-xs ".concat(a?"text-slate-500 line-through":"text-slate-500"),children:e.endTime?new Date(e.endTime).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"N/A"}),a&&(0,ga.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Passed"})]})]}),(0,ga.jsx)("h3",{className:"text-sm font-semibold ".concat(a?"text-slate-500 line-through":"text-slate-800"," mb-2"),children:e.title||"Untitled Activity"}),e.description&&(0,ga.jsx)("p",{className:"text-xs text-slate-600 mb-2 line-clamp-2",children:e.description}),(0,ga.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-3 pt-3 border-t border-slate-100",children:[t&&e.owner&&(0,ga.jsxs)("span",{children:["Owner: ",e.owner]}),e.relatedAccount&&(0,ga.jsxs)("span",{children:["Account: ",e.relatedAccount]})]})]},e.activityId||r)})})]})})]})}function Wb(e){let{modalOpen:t,onEdit:r,activities:a,setActivities:n,loadActivities:i,isAdmin:l}=e;const[o,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(""),[h,f]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const e=setTimeout(()=>{c(!1)},1500);return()=>clearTimeout(e)},[]);return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,ga.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,ga.jsx)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(o?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(En,{className:"w-6 h-6 text-blue-600"}),(0,ga.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Sales Plans"})]})})}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(o?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,ga.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),(0,ga.jsx)("span",{children:"New Activity"})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",children:[(0,ga.jsx)(Ja,{className:"w-4 h-4 text-slate-600"}),(0,ga.jsx)("span",{children:"Filter"}),(0,ga.jsx)(un,{className:"w-4 h-4 text-slate-400"})]})]}),(0,ga.jsxs)("button",{onClick:()=>{f(!0)},className:"flex items-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",children:[(0,ga.jsx)(Ib,{className:"w-5 h-5"}),(0,ga.jsx)("span",{children:"View Activities"})]}),(0,ga.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search activities...",value:d,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}),(0,ga.jsx)("div",{className:"space-y-6",children:(0,ga.jsx)(zb,{onOpen:t,onEdit:r,loading:!1,delay:300,activities:a,setActivities:n,loadActivities:i})}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:()=>{c(!0),setTimeout(()=>c(!1),1500)},className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Activities",children:(0,ga.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(o?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ga.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,ga.jsx)("div",{className:"h-8"})]}),h&&(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,ga.jsx)(Hb,{data:a,onClose:()=>{f(!1)},isAdmin:l})})]})}function Vb(e){let{onClose:t,initialActivity:r=null,isEditMode:a=!1,noteModalOpen:n,isSuccesssNote:i,setCurrentStatus:l}=e;const{user:o}=(0,s.useContext)(xa),[c,d]=(0,s.useState)({id:(null===r||void 0===r?void 0:r.id)||null,activityName:(null===r||void 0===r?void 0:r.activity_name)||"",activityType:(null===r||void 0===r?void 0:r.activity_type)||"",owner:(null===r||void 0===r?void 0:r.owner)||"",startTime:(null===r||void 0===r?void 0:r.start_time)||"",endTime:(null===r||void 0===r?void 0:r.end_time)||"",status:(null===r||void 0===r?void 0:r.status)||"",relatedAccount:(null===r||void 0===r?void 0:r.related_account)||"",rescheduleDate:(null===r||void 0===r?void 0:r.reschedule_date)||""}),[u,h]=(0,s.useState)({}),[f,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(""),[x,b]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[j,k]=(0,s.useState)([]),[S,A]=(0,s.useState)([]),[C,_]=(0,s.useState)(!1),[T,E]=(0,s.useState)(""),L=(0,s.useRef)(null),P=(0,s.useRef)(null);(0,s.useEffect)(()=>{(async()=>{try{const e=await Os();k(e)}catch(e){console.error("Error loading accounts:",e)}})()},[]),(0,s.useEffect)(()=>{if(a)"completed"===(null===r||void 0===r?void 0:r.status)&&N(!0),null!==r&&void 0!==r&&r.related_account&&E(r.related_account);else{const e=new Date,t=e=>String(e).padStart(2,"0"),r=[e.getFullYear(),t(e.getMonth()+1),t(e.getDate())].join("-")+"T"+[t(e.getHours()),t(e.getMinutes())].join(":");d(e=>We(We({},e),{},{startTime:r,status:"planned"}))}},[a,r]),(0,s.useEffect)(()=>{i&&(console.log("dan trigger function!!"),R())},[i]),(0,s.useEffect)(()=>{b((null===r||void 0===r?void 0:r.status)||""),console.log(r)},[r]),(0,s.useEffect)(()=>{const e=e=>{P.current&&!P.current.contains(e.target)&&L.current&&!L.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const O=e=>{const{name:t,value:r}=e.target;d(e=>We(We({},e),{},{[t]:r})),u[t]&&h(e=>We(We({},e),{},{[t]:""})),p&&g("")},F=()=>{const e={};return c.activityName.trim()||(e.activityName="Activity name is required"),c.activityType||(e.activityType="Activity type is required"),c.startTime||(e.startTime="Start time is required"),c.status||(e.status="Status is required"),"reschedule"!==c.status||c.rescheduleDate||(e.rescheduleDate="Reschedule date is required when status is Reschedule"),c.startTime&&c.endTime&&c.endTime<=c.startTime&&(e.endTime="End time must be after start time"),h(e),0===Object.keys(e).length},D=e=>e?e.includes(":")&&2===e.split(":").length?"".concat(e,":00"):e:null,I=async e=>{const t=await Da(e);return console.log("this is user id: ",t[0].emp_id),t[0].emp_id},R=async()=>{if(F()){m(!0),g("");try{const e=We(We({},a&&{id:c.id}),{},{activityName:c.activityName.trim(),activityType:c.activityType,owner:await I(o.id)||null,startTime:D(c.startTime),endTime:c.endTime?D(c.endTime):null,status:c.status,relatedAccount:c.relatedAccount.trim()||null,rescheduleDate:c.rescheduleDate?D(c.rescheduleDate):null});console.log("yes it's bypass!");const r=await Bb(e);console.log("Activity updated successfully:",r),t(r),window.location.reload()}catch(n){var e,r;console.error("Error submitting form:",n),g((null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message||"An error occurred while saving the activity. Please try again.")}finally{m(!1)}}},M=async e=>{if(e.preventDefault(),w)g("Completed activities cannot be edited");else if(F()){if(a&&x!==c.status&&!v)return console.log("Status changed - opening notes modal"),l({status:c.status,activity_id:c.id,rescheduleDate:c.rescheduleDate}),void n();console.log("yes it's bypass!"),m(!0),g("");try{const e=We(We({},a&&{id:c.id}),{},{activityName:c.activityName.trim(),activityType:c.activityType,owner:await I(o.id)||null,startTime:D(c.startTime),endTime:c.endTime?D(c.endTime):null,status:c.status,relatedAccount:c.relatedAccount.trim()||null,rescheduleDate:c.rescheduleDate?D(c.rescheduleDate):null});let r;if(console.log("checking activities ",e),a)r=await Bb(e),console.log("Activity updated successfully:",r);else if(r=await(async e=>(await fa.post("".concat(ma,"/Activity"),e)).data)(e),console.log("Activity created successfully:",r),r.activityId){const e={new_status:"planned",note:"Activity created and planned",activity_id:r.activityId};console.log(e);const t=await Ub(e);console.log(t)}t(r)}catch(i){var r,s;console.error("Error submitting form:",i),g((null===(r=i.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||i.message||"An error occurred while saving the activity. Please try again.")}finally{m(!1)}}},B=(()=>{if(!a)return[];const e=[{value:"in_progress",label:"In Progress",color:"bg-blue-500",canRepeat:!0},{value:"completed",label:"Completed",color:"bg-green-500",canRepeat:!1},{value:"cancelled",label:"Cancelled",color:"bg-red-500",canRepeat:!1},{value:"reschedule",label:"Reschedule",color:"bg-amber-500",canRepeat:!0}];return"completed"===x?[{value:"completed",label:"Completed",color:"bg-green-500",canRepeat:!1}]:"cancelled"===x?e.filter(e=>["cancelled","reschedule"].includes(e.value)):e})();return(0,ga.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(En,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:a?"Edit Activity":"Create New Activity"}),w&&(0,ga.jsx)("p",{className:"text-sm text-green-600 font-medium mt-1",children:"\u2713 This activity is completed and cannot be edited"})]})]}),(0,ga.jsx)("button",{onClick:()=>t(),className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,ga.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[p&&(0,ga.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,ga.jsx)("span",{className:"text-xl",children:"\u26a0\ufe0f"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"font-semibold text-red-800",children:"Error"}),(0,ga.jsx)("p",{className:"text-red-700 text-sm",children:p})]})]}),w&&(0,ga.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-green-600 mt-0.5"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"font-semibold text-green-800",children:"Activity Completed"}),(0,ga.jsx)("p",{className:"text-green-700 text-sm",children:"This activity has been marked as completed. All fields are now read-only."})]})]}),(0,ga.jsx)("form",{onSubmit:M,className:"space-y-6",children:(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{className:"lg:col-span-2",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-blue-600"}),"Activity Name *"]}),(0,ga.jsx)("input",{type:"text",name:"activityName",value:c.activityName,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.activityName?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter a descriptive activity name"}),u.activityName&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.activityName]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(cs,{className:"w-4 h-4 text-purple-600"}),"Activity Type *"]}),(0,ga.jsxs)("select",{name:"activityType",value:c.activityType,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.activityType?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,ga.jsx)("option",{value:"",children:"Select activity type"}),[{value:"call",label:"Phone Call",color:"bg-blue-500"},{value:"email",label:"Email",color:"bg-purple-500"},{value:"meeting",label:"Meeting",color:"bg-green-500"},{value:"follow_up",label:"Follow Up",color:"bg-yellow-500"},{value:"presentation",label:"Presentation",color:"bg-pink-500"},{value:"site_visit",label:"Site Visit",color:"bg-indigo-500"},{value:"other",label:"Other",color:"bg-gray-500"}].map(e=>(0,ga.jsx)("option",{value:e.value,children:e.label},e.value))]}),u.activityType&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.activityType]})]}),a&&(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(nn,{className:"w-4 h-4 text-green-600"}),"Status *"]}),(0,ga.jsxs)("select",{name:"status",value:c.status,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.status?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,ga.jsx)("option",{value:"",children:"Select status"}),B.map(e=>(0,ga.jsx)("option",{value:e.value,children:e.label},e.value))]}),u.status&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.status]}),c.status&&(0,ga.jsxs)("div",{className:"mt-2 text-xs text-slate-600 bg-slate-50 p-2 rounded",children:["completed"===c.status&&"\u2713 Activity will be marked as completed and cannot be edited further","cancelled"===c.status&&"\u2717 Activity will be cancelled","in_progress"===c.status&&"\u25b6 Activity is currently in progress","reschedule"===c.status&&"\u23f0 Activity will be rescheduled to a new date"]})]}),a&&"reschedule"===c.status&&(0,ga.jsxs)("div",{className:"lg:col-span-2",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-amber-600"}),"Reschedule Date & Time *"]}),(0,ga.jsx)("input",{type:"datetime-local",name:"rescheduleDate",value:c.rescheduleDate,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.rescheduleDate?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400")}),u.rescheduleDate&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.rescheduleDate]})]}),!a&&(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ka,{className:"w-4 h-4 text-cyan-600"}),"Related Account"]}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("input",{ref:L,type:"text",name:"relatedAccount",value:T,onChange:e=>{const t=e.target.value;if(E(t),d(e=>We(We({},e),{},{relatedAccount:t})),""===t.trim())A([]),_(!1);else{const e=j.filter(e=>{var r,a,n;return(null===(r=e.accountName)||void 0===r?void 0:r.toLowerCase().includes(t.toLowerCase()))||(null===(a=e.companyName)||void 0===a?void 0:a.toLowerCase().includes(t.toLowerCase()))||(null===(n=e.accountNumber)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase()))});A(e),_(!0)}},onFocus:()=>{if(""!==T.trim()){const e=j.filter(e=>{var t,r,a;return(null===(t=e.accountName)||void 0===t?void 0:t.toLowerCase().includes(T.toLowerCase()))||(null===(r=e.companyName)||void 0===r?void 0:r.toLowerCase().includes(T.toLowerCase()))||(null===(a=e.accountNumber)||void 0===a?void 0:a.toLowerCase().includes(T.toLowerCase()))});A(e),_(!0)}},disabled:w,className:"w-full px-4 py-3 pr-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":"border-slate-300 hover:border-slate-400"),placeholder:"Search account by name, company, or number..."}),(0,ga.jsx)(hn,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none"})]}),C&&S.length>0&&(0,ga.jsx)("div",{ref:P,className:"absolute z-50 w-full mt-1 bg-white border border-slate-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:S.map((e,t)=>(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{const t=e.accountName||e.companyName||"Unknown Account";E(t),d(e=>We(We({},e),{},{relatedAccount:t})),_(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors border-b border-slate-100 last:border-b-0 focus:outline-none focus:bg-blue-50",children:(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)(Ka,{className:"w-5 h-5 text-cyan-600 mt-0.5 flex-shrink-0"}),(0,ga.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ga.jsx)("p",{className:"font-semibold text-slate-800 truncate",children:e.accountName||e.companyName||"Unknown Account"}),e.companyName&&e.accountName!==e.companyName&&(0,ga.jsx)("p",{className:"text-sm text-slate-600 truncate",children:e.companyName}),e.accountNumber&&(0,ga.jsxs)("p",{className:"text-xs text-slate-500",children:["Account #: ",e.accountNumber]}),e.industry&&(0,ga.jsx)("p",{className:"text-xs text-slate-500",children:e.industry})]})]})},e.id||t))}),C&&0===S.length&&""!==T.trim()&&(0,ga.jsxs)("div",{ref:P,className:"absolute z-50 w-full mt-1 bg-white border border-slate-300 rounded-lg shadow-lg p-4 text-center text-slate-600",children:[(0,ga.jsx)(hn,{className:"w-8 h-8 mx-auto mb-2 text-slate-400"}),(0,ga.jsxs)("p",{className:"text-sm",children:['No accounts found matching "',T,'"']})]})]}),!a&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-emerald-600"}),"Start Time *"]}),(0,ga.jsx)("input",{type:"datetime-local",name:"startTime",value:c.startTime,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(u.startTime?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),readOnly:!0}),u.startTime&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.startTime]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-red-600"}),"End Time"]}),(0,ga.jsx)("input",{type:"datetime-local",name:"endTime",value:c.endTime,onChange:O,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(u.endTime?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400")}),u.endTime&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.endTime]})]})]})]})})]}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{type:"button",onClick:()=>t(),className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:f,children:w?"Close":"Cancel"}),!w&&(0,ga.jsx)("button",{type:"submit",onClick:M,disabled:f,className:"px-6 py-3 text-white bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:f?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(En,{className:"w-4 h-4"}),a?"Update Activity":"Save Activity"]})})]})]})}function Gb(e){let{onClose:t,setIsSuccesssNote:r,currentStatus:a}=e;const[n,i]=(0,s.useState)({new_status:"",note:"",activity_id:0,reschedule_date:""}),[l,o]=(0,s.useState)({note:!1,rescheduleDate:!1}),[c,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i(e=>We(We({},e),{},{new_status:a.status,activity_id:a.activity_id,reschedule_date:a.rescheduleDate||""}))},[a]);const u=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),l[t]&&o(e=>We(We({},e),{},{[t]:!1}))},h=async e=>{if(e.preventDefault(),(()=>{const e={note:!1,rescheduleDate:!1};return n.note.length<5&&(e.note=!0),"reschedule"!==n.new_status||n.reschedule_date||(e.rescheduleDate=!0),o(e),!e.note&&!e.rescheduleDate})()&&a.activity_id){d(!0),console.log(n);try{const e=await Ub(n);console.log(e),r(!0),t()}catch(s){console.error("Error saving note:",s),d(!1)}}},f=(e=>{const t={planned:{color:"text-slate-600 bg-slate-100",icon:"\ud83d\udccb",label:"Planned",description:"Activity is planned and scheduled"},in_progress:{color:"text-blue-600 bg-blue-100",icon:"\u25b6\ufe0f",label:"In Progress",description:"Activity is currently being worked on"},completed:{color:"text-green-600 bg-green-100",icon:"\u2705",label:"Completed",description:"Activity has been completed successfully"},cancelled:{color:"text-red-600 bg-red-100",icon:"\u274c",label:"Cancelled",description:"Activity has been cancelled"},reschedule:{color:"text-amber-600 bg-amber-100",icon:"\u23f0",label:"Reschedule",description:"Activity is being rescheduled to a new date"}};return t[e]||t.planned})(n.new_status);return(0,ga.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(En,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:"Add Status Update Note"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Document the reason for this status change"})]})]}),(0,ga.jsx)("button",{onClick:()=>t(),className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,ga.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,ga.jsx)("div",{className:"mb-6 p-4 rounded-lg border ".concat(f.color," border-opacity-30"),children:(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)("span",{className:"text-2xl",children:f.icon}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("h3",{className:"font-semibold text-base mb-1",children:["Changing Status to: ",f.label]}),(0,ga.jsx)("p",{className:"text-sm opacity-90",children:f.description})]})]})}),(0,ga.jsx)("form",{onSubmit:h,className:"space-y-6",children:(0,ga.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(nn,{className:"w-4 h-4 text-blue-600"}),"New Status"]}),(0,ga.jsx)("input",{type:"text",name:"new_status",value:f.label,className:"w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-50 text-slate-700 font-medium cursor-not-allowed",readOnly:!0})]}),"reschedule"===n.new_status&&(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-amber-600"}),"Reschedule Date & Time *"]}),(0,ga.jsx)("input",{type:"datetime-local",name:"reschedule_date",value:n.reschedule_date,onChange:u,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(l.rescheduleDate?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),min:(new Date).toISOString().slice(0,16)}),l.rescheduleDate&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)(vn,{className:"w-4 h-4"}),"Reschedule date is required when changing status to Reschedule"]}),(0,ga.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:"Select the new date and time for this activity"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-indigo-600"}),"Status Change Note *"]}),(0,ga.jsx)("textarea",{name:"note",value:n.note,onChange:u,rows:8,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent hover:border-slate-400 transition-all resize-none ".concat(l.note?"border-red-500 bg-red-50":"border-slate-300"),placeholder:"Explain why the status is changing to ".concat(f.label.toLowerCase(),"...\n\nExamples:\n\u2022 Client requested to reschedule due to scheduling conflict\n\u2022 Completed all action items and received client confirmation\n\u2022 Unable to reach client after multiple attempts\n\u2022 Meeting was productive, moving forward with proposal")}),l.note&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)(vn,{className:"w-4 h-4"}),"Note must be at least 5 characters"]}),(0,ga.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:"Minimum 5 characters. Be specific about the reason for this status change."})]}),"completed"===n.new_status&&(0,ga.jsx)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:(0,ga.jsxs)("div",{className:"flex items-start gap-2",children:[(0,ga.jsx)(vn,{className:"w-5 h-5 text-amber-600 mt-0.5"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("p",{className:"font-semibold text-amber-800 text-sm",children:"Important Note"}),(0,ga.jsxs)("p",{className:"text-amber-700 text-sm mt-1",children:["Once an activity is marked as ",(0,ga.jsx)("strong",{children:"Completed"}),", it cannot be edited or changed to any other status. Make sure all information is accurate before proceeding."]})]})]})})]})})]}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{type:"button",onClick:()=>t(),className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:c,children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",onClick:h,disabled:c,className:"px-6 py-3 text-white rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center ".concat("completed"===n.new_status?"bg-green-600 hover:bg-green-700 disabled:bg-green-400":"cancelled"===n.new_status?"bg-red-600 hover:bg-red-700 disabled:bg-red-400":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400"),children:c?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(En,{className:"w-4 h-4"}),"Save Status Change"]})})]})]})}function Kb(){const{user:e,permission:t,loading:r}=(0,s.useContext)(xa),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(!0),[m,p]=(0,s.useState)(""),[g,x]=(0,s.useState)(!1),[b,v]=(0,s.useState)(!1),[y,w]=(0,s.useState)({status:"",activity_id:0}),[N,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&(console.log("Current user in header:",e),k(e.id))},[e]);const k=async e=>{try{const t=await Da(e);console.log("Fetched user data:",t),t&&t.length>0&&j(t[0])}catch(m){console.error("Error fetching user details:",m)}},S=()=>{l(!1),u(null)},A=e=>{if(!e||"null"===e||""===e.trim())return"U";const t=e.trim().split(" ");if(1===t.length)return t[0].charAt(0).toUpperCase();return t[0].charAt(0).toUpperCase()+t[t.length-1].charAt(0).toUpperCase()};(0,s.useEffect)(()=>{N&&C()},[t,N]);const C=async()=>{let e;f(!0),p(""),console.log("check admin **** : ",t);try{if(null!==t&&void 0!==t&&t.IsAdmin)e=await(async()=>(await fa.get("".concat(ma,"/Activity"))).data)();else{if(null===N||void 0===N||!N.emp_id)throw new Error("Employee ID not available");e=await(async e=>(await fa.get("".concat(ma,"/Activity/").concat(e))).data)(N.emp_id)}const r=e.map(e=>{const t=e.owner_name||"Unassigned";return{id:e.id,title:e.activity_name,type:_(e.activity_type),typeColor:T(e.activity_type),typeIcon:E(e.activity_type),owner:t,ownerInitial:A(t),startTime:O(e.start_time),endTime:O(e.end_time),status:e.status,statusColor:L(e.status),relatedAccount:e.related_account||"N/A",priority:P(e.status),rawData:e}});n(r)}catch(r){console.error("Error fetching activities:",r),p(r.message||"Failed to load activities. Please try again.")}finally{f(!1)}},_=e=>({call:"Phone Call",email:"Email",meeting:"Meeting",demo:"Demo","follow-up":"Follow-up",presentation:"Presentation",proposal:"Proposal",negotiation:"Negotiation","site-visit":"Site Visit",training:"Training",webinar:"Webinar",conference:"Conference",task:"Task",other:"Other"}[e]||e),T=e=>({call:"bg-blue-500",email:"bg-purple-500",meeting:"bg-indigo-500",demo:"bg-green-500","follow-up":"bg-amber-500",presentation:"bg-pink-500",proposal:"bg-cyan-500",negotiation:"bg-red-500","site-visit":"bg-orange-500",training:"bg-teal-500",webinar:"bg-violet-500",conference:"bg-lime-500",task:"bg-slate-500",other:"bg-gray-500"}[e]||"bg-slate-500"),E=e=>({call:us,email:qa,meeting:vs,demo:En,"follow-up":qa,presentation:vs,proposal:En,negotiation:vs,"site-visit":En,training:vs,webinar:En,conference:vs,task:nn,other:vn}[e]||vn),L=e=>({planned:"bg-blue-500","in-progress":"bg-amber-500",completed:"bg-emerald-500",cancelled:"bg-red-500",rescheduled:"bg-purple-500",overdue:"bg-orange-500"}[e]||"bg-slate-500"),P=e=>"overdue"===e?"high":"in-progress"===e||"planned"===e?"medium":"low",O=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return r?(0,ga.jsx)("div",{className:"flex h-screen items-center justify-center",children:"Loading..."}):e?(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{c(!o)},isMobileMenuOpen:o}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:o,onClose:()=>{c(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:m?(0,ga.jsx)("div",{className:"p-4 text-red-500",children:m}):(0,ga.jsx)(Wb,{modalOpen:()=>{u(null),l(!0)},onEdit:e=>{u(e),l(!0)},activities:a,setActivities:n,loadActivities:C})})]}),i&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:S}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Vb,{onClose:e=>{S()},initialActivity:d,isEditMode:!!d,noteModalOpen:()=>{console.log("not trigger this!"),x(!0)},isSuccesssNote:b,setCurrentStatus:w})})})]}),g&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:S}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(Gb,{onClose:()=>{x(!1)},initialActivity:d,setIsSuccesssNote:v,currentStatus:y})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]}):(0,ga.jsx)("div",{className:"flex h-screen items-center justify-center text-red-500",children:"Please log in to access activities."})}const Yb=Ta("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Xb=Ta("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);function $b(){ne();const[e,t]=(0,s.useState)({username:"",password:""}),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)({}),c=e=>{const{name:r,value:a}=e.target;t(e=>We(We({},e),{},{[r]:a})),l[r]&&o(e=>We(We({},e),{},{[r]:""}))};return(0,ga.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-slate-50 flex items-center justify-center p-4",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes slideIn {\n          0% {\n            opacity: 0;\n            transform: translateX(-20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n\n        .animate-fadeIn {\n          animation: fadeIn 0.6s ease-out;\n        }\n\n        .animate-slideIn {\n          animation: slideIn 0.6s ease-out;\n        }\n\n        .input-focus {\n          transition: all 0.2s ease;\n        }\n\n        .input-focus:focus {\n          transform: translateY(-1px);\n          box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);\n        }\n      "}),(0,ga.jsxs)("div",{className:"w-full max-w-md animate-fadeIn",children:[(0,ga.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-10 text-center",children:[(0,ga.jsx)("div",{className:"mb-6 flex justify-center",children:(0,ga.jsx)("div",{className:"bg-white rounded-xl p-4 shadow-lg",children:(0,ga.jsx)("img",{src:ya,alt:"Scanwell Logistics",className:"h-16 w-auto",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div class="text-blue-600 font-bold text-2xl">SCANWELL</div>'}})})}),(0,ga.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),(0,ga.jsx)("p",{className:"text-blue-100",children:"Sign in to your account"})]}),(0,ga.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),(()=>{const t={};return e.username.trim()||(t.username="Username is required"),e.password||(t.password="Password is required"),o(t),0===Object.keys(t).length})()){i(!0),o({});try{const t=await pa.post("".concat(ma,"/auth/login"),{username:e.username,password:e.password}),{id:r,username:a}=t.data;localStorage.setItem("userRoleId",r),localStorage.setItem("username",a),localStorage.setItem("user",JSON.stringify({id:r,username:a})),console.log("Login Success!",{userRoleId:r,username:a}),window.location.href="/dashboard"}catch(n){console.error("Login failed:",n);let e="Invalid username or password. Please try again.";var r,a;if(n.response)e=(null===(r=n.response.data)||void 0===r?void 0:r.message)||(null===(a=n.response.data)||void 0===a?void 0:a.title)||n.response.data||e;else e=n.request?"No response from server. Please check your connection.":"Something went wrong. Please try again.";o({submit:e})}finally{i(!1)}}},className:"px-8 py-8 space-y-6",children:[(0,ga.jsxs)("div",{className:"animate-slideIn",style:{animationDelay:"0.1s",animationFillMode:"both"},children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ga.jsx)(Oa,{className:"h-5 w-5 text-slate-400"})}),(0,ga.jsx)("input",{type:"text",name:"username",value:e.username,onChange:c,placeholder:"Enter your username",className:"input-focus w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(l.username?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-300 focus:ring-blue-500 focus:border-blue-500"),disabled:n})]}),l.username&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:l.username})]}),(0,ga.jsxs)("div",{className:"animate-slideIn",style:{animationDelay:"0.2s",animationFillMode:"both"},children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ga.jsx)(qb,{className:"h-5 w-5 text-slate-400"})}),(0,ga.jsx)("input",{type:r?"text":"password",name:"password",value:e.password,onChange:c,placeholder:"Enter your password",className:"input-focus w-full pl-10 pr-12 py-3 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(l.password?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-300 focus:ring-blue-500 focus:border-blue-500"),disabled:n}),(0,ga.jsx)("button",{type:"button",onClick:()=>a(!r),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors duration-200",tabIndex:"-1",children:r?(0,ga.jsx)(Yb,{className:"h-5 w-5"}):(0,ga.jsx)(fn,{className:"h-5 w-5"})})]}),l.password&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:l.password})]}),l.submit&&(0,ga.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2 animate-fadeIn",children:[(0,ga.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ga.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,ga.jsx)("span",{className:"text-sm",children:l.submit})]}),(0,ga.jsx)("div",{className:"animate-slideIn",style:{animationDelay:"0.3s",animationFillMode:"both"},children:(0,ga.jsx)("button",{type:"submit",disabled:n,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 font-medium shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600",children:n?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(as,{className:"w-5 h-5 animate-spin"}),(0,ga.jsx)("span",{children:"Signing In..."})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Xb,{className:"w-5 h-5"}),(0,ga.jsx)("span",{children:"Sign In"})]})})})]}),(0,ga.jsx)("div",{className:"px-8 py-6 bg-slate-50 border-t border-slate-200 text-center animate-fadeIn",style:{animationDelay:"0.4s",animationFillMode:"both"},children:(0,ga.jsxs)("p",{className:"text-sm text-slate-600",children:["\xa9 ",(new Date).getFullYear()," Scanwell Logistics. All rights reserved."]})})]}),(0,ga.jsx)("div",{className:"mt-6 text-center animate-fadeIn",style:{animationDelay:"0.5s",animationFillMode:"both"},children:(0,ga.jsxs)("p",{className:"text-sm text-slate-600",children:["Having trouble logging in?"," ",(0,ga.jsx)("a",{href:"mailto:support@scanwell.lk",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Contact Support"})]})})]})]})}const Jb=async()=>(await fa.get("".concat(ma,"/Department"))).data,Qb=async()=>(await fa.get("".concat(ma,"/Position"))).data,Zb=["sysID"];function ev(e){let{onClose:t,editEmployee:r=null,onSuccess:a}=e;const[n,i]=(0,s.useState)({sysID:"",fname:"",lname:"",email:"",tp:"",position:"",department:"",w_location:"",a_manager:"",status:"Active",note:""}),[l,o]=(0,s.useState)({}),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)([]);(0,s.useEffect)(()=>{console.log("this is employee",r),r&&i({sysID:r.sysID||"",fname:r.fname||"",lname:r.lname||"",email:r.email||"",tp:r.tp||"",position:r.position||"",department:r.department||"",w_location:r.w_location||"",a_manager:r.a_manager||"",status:r.status||"Active",note:r.note||""})},[r]),(0,s.useEffect)(()=>{(async()=>{try{const[e,t]=await Promise.all([Jb(),Qb()]);h(e||[]),m(t||[])}catch(e){console.error("Error fetching departments and positions:",e)}})()},[]);const p=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),l[t]&&o(e=>We(We({},e),{},{[t]:""}))},g=r&&r.sysID;return(0,ga.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-emerald-50 to-green-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center",children:(0,ga.jsx)(ws,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:g?"Edit Employee":"Add New Employee"}),(0,ga.jsx)("p",{className:"text-sm text-slate-600",children:g?"Update employee information":"Create a new employee profile"})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,ga.jsxs)("div",{className:"space-y-8",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Personal Information"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-blue-600"}),"First Name *"]}),(0,ga.jsx)("input",{type:"text",name:"fname",value:n.fname,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(l.fname?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter first name"}),l.fname&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),l.fname]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-purple-600"}),"Last Name *"]}),(0,ga.jsx)("input",{type:"text",name:"lname",value:n.lname,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(l.lname?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter last name"}),l.lname&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),l.lname]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(ws,{className:"w-4 h-4 text-emerald-600"}),"Employment Status"]}),(0,ga.jsx)("select",{name:"status",value:n.status,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all",children:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}].map(e=>(0,ga.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(qa,{className:"w-4 h-4 text-red-600"}),"Email Address *"]}),(0,ga.jsx)("input",{type:"email",name:"email",value:n.email,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(l.email?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter email address"}),l.email&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),l.email]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(us,{className:"w-4 h-4 text-green-600"}),"Phone Number"]}),(0,ga.jsx)("input",{type:"tel",name:"tp",value:n.tp,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(l.tp?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"0771234567"}),l.tp&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),l.tp]})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Employment Information"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ya,{className:"w-4 h-4 text-indigo-600"}),"Position/Title *"]}),(0,ga.jsxs)("select",{name:"position",value:n.position,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(l.position?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,ga.jsx)("option",{value:"",children:"Select position"}),f.map(e=>(0,ga.jsx)("option",{value:e.p_name,children:e.p_name},e.sysID))]}),l.position&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),l.position]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(ds,{className:"w-4 h-4 text-orange-600"}),"Department *"]}),(0,ga.jsxs)("select",{name:"department",value:n.department,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(l.department?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,ga.jsx)("option",{value:"",children:"Select department"}),u.map(e=>(0,ga.jsx)("option",{value:e.d_name,children:e.d_name},e.sysID))]}),l.department&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),l.department]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-teal-600"}),"Work Location"]}),(0,ga.jsx)("input",{type:"text",name:"w_location",value:n.w_location,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"e.g., Warehouse A, Distribution Center, Main Office"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-cyan-600"}),"Assigned Manager"]}),(0,ga.jsx)("input",{type:"text",name:"a_manager",value:n.a_manager,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"Enter assigned manager's name"})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Additional Information"}),(0,ga.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-gray-600"}),"Additional Notes"]}),(0,ga.jsx)("textarea",{name:"note",value:n.note,onChange:p,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all resize-none",placeholder:"Any additional notes about this employee, special skills, certifications, training requirements, etc..."})]})})]})]})}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:c,children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),(()=>{const e={};return n.fname.trim()||(e.fname="First name is required"),n.lname.trim()||(e.lname="Last name is required"),n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(e.email="Please enter a valid email address"):e.email="Email is required",n.position||(e.position="Position is required"),n.department||(e.department="Department is required"),n.tp&&!/^[\+]?[0-9\s\-\(\)]{10,15}$/.test(n.tp)&&(e.tp="Please enter a valid phone number"),o(e),0===Object.keys(e).length})()){d(!0),console.log("pppppppp",n);try{let e;if(r&&r.sysID)e=await(async e=>(console.log("oooo",e),(await fa.put("".concat(ma,"/Employee/emp"),e)).data))(n),console.log("Employee updated:",e);else{const{sysID:t}=n,r=Na(n,Zb);e=await(async e=>(await fa.post("".concat(ma,"/Employee/emp"),e)).data)(r),console.log("Employee created:",e)}a&&a(e),t()}catch(s){console.error("Error submitting form:",s),alert("Error saving employee. Please try again.")}finally{d(!1)}}},disabled:c,className:"px-6 py-3 text-white bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:c?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),g?"Updating...":"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(ws,{className:"w-4 h-4"}),g?"Update Employee":"Add Employee"]})})]})]})}const tv=Ta("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),rv=Ta("toggle-right",[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]),av=Ta("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]);function nv(e){let{onOpen:t,loading:r=!1,delay:a=0,employees:n=[],setSelectedEmployee:s}=e;const i=()=>(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded w-32"}),(0,ga.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,ga.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,ga.jsx)("div",{className:"p-4 space-y-4",children:Array.from({length:4}).map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-slate-200 rounded-full"}),(0,ga.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded w-48"}),(0,ga.jsx)("div",{className:"h-3 bg-slate-200 rounded w-32"})]}),(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded w-20"}),(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded w-16"})]},t))})]}),l=e=>{let{employee:t,onToggle:r}=e;const a="active"===(t.status||"").toLowerCase();return(0,ga.jsx)("button",{onClick:()=>r(t.sysID),className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 ".concat(a?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"),title:"Click to ".concat(a?"disable":"enable"," employee"),children:a?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(ws,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"Active"})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(tv,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"Disabled"})]})})},o=e=>{let{employee:t,onToggle:r}=e;const a="active"===(t.status||"").toLowerCase();return(0,ga.jsx)("button",{onClick:()=>r(t.sysID),className:"flex items-center gap-2 transition-all duration-200 ".concat(a?"text-emerald-600":"text-slate-400"),title:"Toggle availability for task assignment",disabled:"active"!==(t.status||"").toLowerCase(),children:a?(0,ga.jsx)(rv,{className:"w-6 h-6"}):(0,ga.jsx)(av,{className:"w-6 h-6"})})},c=e=>{let{current:t,capacity:r}=e;const a=t/r*100;return(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("div",{className:"w-16 bg-slate-200 rounded-full h-2",children:(0,ga.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(a>=100?"bg-red-500":a>=75?"bg-amber-500":"bg-green-500"),style:{width:"".concat(Math.min(a,100),"%")}})}),(0,ga.jsxs)("span",{className:"text-xs text-slate-600 font-medium",children:[t,"/",r]})]})},d=e=>{let{department:t}=e;if(!t)return(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[(0,ga.jsx)(ds,{className:"w-3 h-3"}),"N/A"]});return(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat((()=>{switch(t.toLowerCase()){case"logistics":case"ocean exports":case"ocean imports":return"bg-blue-100 text-blue-800";case"operations":case"sales":return"bg-purple-100 text-purple-800";case"transport":return"bg-green-100 text-green-800";case"warehouse":return"bg-amber-100 text-amber-800";case"customs":return"bg-red-100 text-red-800";case"hr":case"customer relations":return"bg-pink-100 text-pink-800";case"it":return"bg-indigo-100 text-indigo-800";case"dispatch":return"bg-teal-100 text-teal-800";case"fleet-management":return"bg-orange-100 text-orange-800";case"customer-service":case"air imports":return"bg-cyan-100 text-cyan-800";case"quality-control":return"bg-lime-100 text-lime-800";case"supply-chain":return"bg-violet-100 text-violet-800";case"inventory":return"bg-emerald-100 text-emerald-800";case"procurement":return"bg-rose-100 text-rose-800";case"safety":return"bg-yellow-100 text-yellow-800";case"air exports":return"bg-sky-100 text-sky-800";default:return"bg-slate-100 text-slate-800"}})()),children:[(0,ga.jsx)(ds,{className:"w-3 h-3"}),t]})},u=e=>{let{name:t,status:r,isAvailable:a}=e;const n=(()=>{if(!t||""===t.trim())return"?";const e=t.split(" ").filter(Boolean);return 0===e.length?"?":e.map(e=>e[0]).join("").toUpperCase().substring(0,2)})(),s="active"===(r||"").toLowerCase(),i=s?"bg-emerald-600":"bg-slate-400";return(0,ga.jsxs)("div",{className:"".concat(i," text-white rounded-full w-10 h-10 flex items-center justify-center shadow-sm relative"),children:[(0,ga.jsx)("span",{className:"text-sm font-semibold",children:n}),s&&(0,ga.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 border-2 border-white rounded-full ".concat(a?"bg-green-400":"bg-amber-400")})]})},h=(e,t)=>{const r=[e,t].filter(Boolean);return r.length>0?r.join(" "):"Unknown"},f=e=>{console.log("Toggling status for employee ".concat(e))},m=e=>{console.log("Toggling availability for employee ".concat(e))},p=e=>{s(e),t()};return r?(0,ga.jsx)(i,{}):(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300",style:{animationDelay:"".concat(a,"ms"),animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border-b border-slate-100 gap-4",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors group",children:(0,ga.jsx)(un,{className:"w-4 h-4 text-slate-400 group-hover:text-slate-600"})}),(0,ga.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Employee Management"}),(0,ga.jsxs)("div",{className:"text-sm text-slate-500 bg-slate-100 px-2 py-1 rounded",children:[n.filter(e=>"active"===(e.status||"").toLowerCase()).length," Active"]}),t&&(0,ga.jsxs)("button",{onClick:()=>t(),className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-all duration-200 active:scale-95 shadow-sm",title:"Add new employee",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Add Employee"})]})]}),(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors self-start sm:self-center",children:(0,ga.jsx)(Qa,{className:"w-4 h-4 text-slate-400"})})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("div",{className:"min-w-full",children:[(0,ga.jsx)("div",{className:"hidden lg:block",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-4 py-3 text-left bg-slate-50 sticky left-0 z-20 border-r border-slate-200 shadow-sm",children:(0,ga.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"})}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider bg-slate-50 sticky left-16 z-20 border-r border-slate-200 min-w-48 shadow-sm",children:"Employee"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-48",children:"Contact"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-36",children:"Position"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-32",children:"Department"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-24",children:"Status"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-24",children:"Available"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-32",children:"Task Load"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-24",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-100",children:n.map(e=>{const t=h(e.fname,e.lname),r="EMP".concat((e.sysID||0).toString().padStart(3,"0")),a="active"===(e.status||"").toLowerCase();return(0,ga.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,ga.jsx)("td",{className:"px-4 py-4 bg-white sticky left-0 z-10 border-r border-slate-200 shadow-sm group-hover:bg-slate-50",children:(0,ga.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"})}),(0,ga.jsx)("td",{className:"px-4 py-4 bg-white sticky left-16 z-10 border-r border-slate-200 min-w-48 shadow-sm group-hover:bg-slate-50",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)(u,{name:t,status:e.status||"",isAvailable:a}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"font-medium text-slate-900",children:t}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:r})]})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"space-y-1",children:[e.email?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(qa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate",children:e.email})]}):(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,ga.jsx)(qa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"N/A"})]}),e.tp?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(us,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.tp})]}):(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,ga.jsx)(us,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"N/A"})]})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:e.position?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(Ya,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.position})]}):(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,ga.jsx)(Ya,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"N/A"})]})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(d,{department:e.department})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(l,{employee:e,onToggle:f})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(o,{employee:e,onToggle:m})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsx)(c,{current:Math.floor(5*Math.random()),capacity:5})}),(0,ga.jsx)("td",{className:"px-4 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors",title:"View employee details",children:(0,ga.jsx)(fn,{className:"w-4 h-4 text-slate-600"})}),(0,ga.jsx)("button",{onClick:()=>p(e),className:"p-1 hover:bg-slate-100 rounded transition-colors",title:"Edit employee",children:(0,ga.jsx)(Kn,{className:"w-4 h-4 text-slate-600"})})]})})]},e.sysID)})})]})}),(0,ga.jsx)("div",{className:"lg:hidden divide-y divide-slate-200",children:n.map(e=>{const t=h(e.fname,e.lname),r="EMP".concat((e.sysID||0).toString().padStart(3,"0")),a="active"===(e.status||"").toLowerCase();return(0,ga.jsxs)("div",{className:"p-4 space-y-4",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"}),(0,ga.jsx)(u,{name:t,status:e.status||"",isAvailable:a}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"font-medium text-slate-900",children:t}),(0,ga.jsx)("div",{className:"text-xs text-slate-500",children:r})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("button",{className:"p-2 hover:bg-slate-100 rounded transition-colors",title:"View employee details",children:(0,ga.jsx)(fn,{className:"w-4 h-4 text-slate-600"})}),(0,ga.jsx)("button",{onClick:()=>p(e),className:"p-2 hover:bg-slate-100 rounded transition-colors",title:"Edit employee",children:(0,ga.jsx)(Kn,{className:"w-4 h-4 text-slate-600"})})]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Contact"}),(0,ga.jsxs)("div",{className:"space-y-1",children:[e.email?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(qa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{className:"truncate",children:e.email})]}):(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,ga.jsx)(qa,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"N/A"})]}),e.tp?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(us,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.tp})]}):(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,ga.jsx)(us,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"N/A"})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Position"}),e.position?(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,ga.jsx)(Ya,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:e.position})]}):(0,ga.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,ga.jsx)(Ya,{className:"w-3 h-3"}),(0,ga.jsx)("span",{children:"N/A"})]}),(0,ga.jsx)("div",{className:"mt-1",children:(0,ga.jsx)(d,{department:e.department})})]})]}),(0,ga.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Status"}),(0,ga.jsx)(l,{employee:e,onToggle:f})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Available"}),(0,ga.jsx)(o,{employee:e,onToggle:m})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Task Load"}),(0,ga.jsx)(c,{current:Math.floor(5*Math.random()),capacity:5})]})]})]},e.sysID)})})]})}),0===n.length&&(0,ga.jsxs)("div",{className:"text-center py-12",children:[(0,ga.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-full flex items-center justify-center",children:(0,ga.jsx)(Oa,{className:"w-8 h-8 text-slate-400"})}),(0,ga.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No employees found"}),(0,ga.jsx)("p",{className:"text-slate-500 mb-4",children:"Get started by adding your first employee to the system."}),t&&(0,ga.jsxs)("button",{onClick:()=>t(),className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Employee"]})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.5s ease-out;\n        }\n      "})]})}function sv(e){let{modalOpen:t,employees:r,setSelectedEmployee:a}=e;const[n,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)("");(0,s.useEffect)(()=>{const e=setTimeout(()=>{i(!1)},1500);return()=>clearTimeout(e)},[]);const c=r.filter(e=>{if(!l)return!0;const t=l.toLowerCase();return(e.fname||"").toLowerCase().includes(t)||(e.lname||"").toLowerCase().includes(t)||(e.email||"").toLowerCase().includes(t)||(e.tp||"").toLowerCase().includes(t)||(e.position||"").toLowerCase().includes(t)||(e.department||"").toLowerCase().includes(t)||(e.w_location||"").toLowerCase().includes(t)||(e.a_manager||"").toLowerCase().includes(t)||(e.status||"").toLowerCase().includes(t)});return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-emerald-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,ga.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,ga.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(ws,{className:"w-6 h-6 text-emerald-600"}),(0,ga.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Employee Directory"})]})}),(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Provide feedback",children:[(0,ga.jsx)(xs,{className:"w-4 h-4 text-pink-500 group-hover:text-pink-600"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Messages",children:(0,ga.jsx)(bs,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,ga.jsx)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm",children:(0,ga.jsx)("span",{className:"text-sm font-semibold",children:"K"})}),(0,ga.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-l-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Invite team members",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-emerald-500 group-hover:text-emerald-600"}),(0,ga.jsx)("span",{className:"hidden sm:inline",children:"Invite"}),(0,ga.jsx)("span",{className:"bg-emerald-100 text-emerald-700 px-1.5 py-0.5 rounded text-xs font-medium",children:"1"})]}),(0,ga.jsx)("button",{className:"p-2 bg-white border border-slate-300 border-l-0 rounded-r-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share employee data",children:(0,ga.jsx)(ys,{className:"w-4 h-4 text-slate-600 group-hover:text-slate-800"})})]})]})]}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,ga.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,ga.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Add new employee",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),(0,ga.jsx)("span",{children:"Add Employee"})]}),(0,ga.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",title:"Filter employees",children:[(0,ga.jsx)(Ja,{className:"w-4 h-4 text-slate-600"}),(0,ga.jsx)("span",{children:"Filter"}),(0,ga.jsx)(un,{className:"w-4 h-4 text-slate-400"})]})]}),(0,ga.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(hn,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search employees...",value:l,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}),(0,ga.jsx)("div",{className:"space-y-6",children:(0,ga.jsx)(nv,{onOpen:t,loading:n,employees:c,delay:300,setSelectedEmployee:a})}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:()=>{i(!0),setTimeout(()=>i(!1),1500)},className:"bg-emerald-600 hover:bg-emerald-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Employees",children:(0,ga.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(n?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ga.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,ga.jsx)("div",{className:"h-8"})]})]})}function iv(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),c=()=>{t(!1)};return(0,s.useEffect)(()=>{(async()=>{try{const e=await Ss();a(e)}catch(e){}})()},[]),(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{i(!n)},isMobileMenuOpen:n}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:n,onClose:()=>{i(!1)},scrollBottom:!0}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(sv,{modalOpen:()=>{t(!0)},employees:r,setSelectedEmployee:o})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:c}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(ev,{onClose:c,editEmployee:l})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}function lv(e){let{onClose:t,editItem:r=null,activeTab:a,onSuccess:n,loadDepartment:i,loadPosition:l}=e;const[o,c]=(0,s.useState)({name:""}),[d,u]=(0,s.useState)({}),[h,f]=(0,s.useState)(!1),m=async e=>{await(async e=>(await fa.post("".concat(ma,"/Department"),e)).data)({dName:e});i()},p=async(e,t)=>{const r={Id:e,dName:t};await(async e=>(await fa.put("".concat(ma,"/Department"),e)).data)(r);i()},g=async e=>{await(async e=>(await fa.post("".concat(ma,"/Position"),e)).data)({pName:e});l()},x=async(e,t)=>{const r={Id:e,pName:t};await(async e=>(await fa.put("".concat(ma,"/Position"),e)).data)(r);l()};(0,s.useEffect)(()=>{r&&c("departments"===a?{name:r.d_name||""}:{name:r.p_name||""})},[r]);const b=async e=>{if(e.preventDefault(),(()=>{const e={};return o.name.trim()||(e.name="Name is required"),u(e),0===Object.keys(e).length})()){f(!0);try{let e;r&&r.sysID?(e="departments"===a?await p(r.sysID,o.name):await x(r.sysID,o.name),console.log("".concat(a.slice(0,-1)," updated:"),e)):(e="departments"===a?await m(o.name):await g(o.name),console.log("".concat(a.slice(0,-1)," created:"),e)),n&&n(e),t()}catch(s){console.error("Error submitting form:",s),alert("Error saving ".concat(a.slice(0,-1),". Please try again."))}finally{f(!1)}}},v=r&&r.sysID;return(0,ga.jsxs)("div",{className:"w-full max-w-md mx-auto bg-white rounded-2xl shadow-xl",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-emerald-50 to-green-50 rounded-t-2xl",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center",children:"departments"===a?(0,ga.jsx)(Ka,{className:"w-5 h-5 text-white"}):(0,ga.jsx)(Ya,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h1",{className:"text-xl font-bold text-slate-800",children:[v?"Edit":"Add"," ",a.slice(0,-1)]}),(0,ga.jsxs)("p",{className:"text-sm text-slate-600",children:[v?"Update":"Create"," ",a.slice(0,-1)," information"]})]})]}),(0,ga.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,ga.jsx)(Ea,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,ga.jsx)("div",{className:"p-6",children:(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:["departments"===a?(0,ga.jsx)(Ka,{className:"w-4 h-4 text-emerald-600"}):(0,ga.jsx)(Ya,{className:"w-4 h-4 text-emerald-600"}),"departments"===a?"Department":"Position"," Name *"]}),(0,ga.jsx)("input",{type:"text",name:"name",value:o.name,onChange:e=>{const{name:t,value:r}=e.target;c(e=>We(We({},e),{},{[t]:r})),d[t]&&u(e=>We(We({},e),{},{[t]:""}))},className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(d.name?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter ".concat(a.slice(0,-1)," name"),onKeyPress:e=>"Enter"===e.key&&b(e)}),d.name&&(0,ga.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,ga.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),d.name]})]})}),(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,ga.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:h,children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",onClick:b,disabled:h||!o.name.trim(),className:"px-6 py-3 text-white bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[120px] justify-center",children:h?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),v?"Updating...":"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Yn,{className:"w-4 h-4"}),v?"Update":"Save"]})})]})]})}function ov(e){let{modalOpen:t,departments:r,positions:a,setSelectedItem:n,activeTab:i,setActiveTab:l,setDepartments:o,setPositions:c}=e;const[d,u]=(0,s.useState)(""),h=[{id:"departments",label:"Departments",icon:Ka},{id:"positions",label:"Positions",icon:Ya}],f=()=>{const e="departments"===i?r:a;return"departments"===i?e.filter(e=>e.d_name.toLowerCase().includes(d.toLowerCase())):"positions"===i?e.filter(e=>e.p_name.toLowerCase().includes(d.toLowerCase())):void 0};return(0,ga.jsxs)("div",{className:"p-6 max-w-6xl mx-auto",children:[(0,ga.jsxs)("div",{className:"mb-8",children:[(0,ga.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"HR System Management"}),(0,ga.jsx)("p",{className:"text-slate-600",children:"Manage departments and positions"})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsx)("div",{className:"border-b border-slate-200",children:(0,ga.jsx)("nav",{className:"flex",children:h.map(e=>(0,ga.jsxs)("button",{onClick:()=>l(e.id),className:"flex items-center gap-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(i===e.id?"border-emerald-500 text-emerald-600 bg-emerald-50":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"),children:[(0,ga.jsx)(e.icon,{className:"w-5 h-5"}),e.label]},e.id))})}),(0,ga.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,ga.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,ga.jsx)("div",{className:"flex-1",children:(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search ".concat(i,"..."),value:d,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),(0,ga.jsxs)("button",{onClick:()=>{n(null),t()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add ",i.slice(0,-1)]})]})}),(0,ga.jsx)("div",{className:"p-6",children:(0,ga.jsxs)("div",{className:"space-y-3",children:[f().map(e=>(0,ga.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:["departments"===i?(0,ga.jsx)(Ka,{className:"w-5 h-5 text-slate-400"}):(0,ga.jsx)(Ya,{className:"w-5 h-5 text-slate-400"}),(0,ga.jsx)("span",{className:"text-slate-900 font-medium",children:"departments"===i?e.d_name:e.p_name})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("button",{onClick:()=>(e=>{n(e),t()})(e),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:(0,ga.jsx)(Kn,{className:"w-4 h-4"})}),(0,ga.jsx)("button",{onClick:()=>{return t=e.sysID,void(window.confirm("Are you sure you want to delete this ".concat(i.slice(0,-1),"?"))&&("departments"===i?o(r.filter(e=>e.id!==t)):c(a.filter(e=>e.id!==t))));var t},className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]})]},e.id)),0===f().length&&(0,ga.jsxs)("div",{className:"text-center py-12",children:[(0,ga.jsx)("div",{className:"text-slate-400 mb-2",children:"departments"===i?(0,ga.jsx)(Ka,{className:"w-12 h-12 mx-auto"}):(0,ga.jsx)(Ya,{className:"w-12 h-12 mx-auto"})}),(0,ga.jsxs)("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:["No ",i," found"]}),(0,ga.jsx)("p",{className:"text-slate-500",children:d?"Try adjusting your search":"Add your first ".concat(i.slice(0,-1))})]})]})})]})]})}function cv(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)("departments"),f=()=>{d(null),t(!1)};(0,s.useEffect)(()=>{m(),p()},[]);const m=async()=>{const e=await Jb();a(e),console.log(e)},p=async()=>{const e=await Qb();i(e),console.log(e)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{o(!l)},isMobileMenuOpen:l}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:l,onClose:()=>{o(!1)},scrollBottom:!0}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(ov,{modalOpen:()=>{t(!0)},departments:r,positions:n,setSelectedItem:d,activeTab:u,setActiveTab:h,setDepartments:a,setPositions:i})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:f}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(lv,{onClose:f,editItem:c,activeTab:u,onSuccess:()=>{},loadDepartment:m,loadPosition:p})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const dv=Ta("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),uv=Ta("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),hv={createNewResource:async e=>(await fa.post("".concat(ma,"/Resource/resource"),e,{headers:{"Content-Type":"multipart/form-data"}})).data,deleteResource:async e=>(await fa.delete("".concat(ma,"/Resource/resource/").concat(e))).data,fetchResourceById:async e=>(await fa.get("".concat(ma,"/Resource/resource/").concat(e))).data,fetchResources:async()=>(await fa.get("".concat(ma,"/Resource/resource"))).data,updateResource:async e=>(await fa.put("".concat(ma,"/Resource/resource"),e,{headers:{"Content-Type":"multipart/form-data"}})).data};function fv(e){let{modalOpen:t,onEdit:r}=e;const[a,n]=(0,s.useState)(!1),[i,l]=(0,s.useState)(""),[o,c]=(0,s.useState)([]);(0,s.useEffect)(()=>{d()},[]);const d=async()=>{n(!0);try{const e=(await hv.fetchResources()).map(e=>({id:e.sysID,title:e.title,link:e.link,description:e.description,logoUrl:e.logoUrl,addedDate:e.addedDate,addedBy:e.addedBy}));c(e)}catch(e){console.error("Error fetching resources:",e)}finally{n(!1)}},u=async e=>{if(console.log("this is the id pass to the delete: ",e),window.confirm("Are you sure you want to delete this item?"))try{await hv.deleteResource(e),window.location.reload()}catch(t){console.error("Error deleting resource:",t)}},h=o.filter(e=>e.title.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase()));return(0,ga.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            background-position: -1000px 0;\n          }\n          100% {\n            background-position: 1000px 0;\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .skeleton {\n          animation: shimmer 2s infinite;\n          background: linear-gradient(\n            90deg,\n            #f0f0f0 25%,\n            #e0e0e0 50%,\n            #f0f0f0 75%\n          );\n          background-size: 1000px 100%;\n        }\n\n        .table-row-hover:hover {\n          background-color: rgba(59, 130, 246, 0.02);\n        }\n\n        .logo-img {\n          object-fit: contain;\n          max-height: 100%;\n          max-width: 100%;\n        }\n      "}),(0,ga.jsxs)("main",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto",children:[(0,ga.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,ga.jsx)("div",{className:"flex items-center gap-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(Ua,{className:"w-8 h-8 text-blue-600"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Useful Links"}),(0,ga.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Quick access to important logistics resources"})]})]})}),(0,ga.jsx)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:(0,ga.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg font-medium text-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:"Add New Link"})]})})]}),(0,ga.jsx)("div",{className:"mb-6 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:(0,ga.jsxs)("div",{className:"relative max-w-md",children:[(0,ga.jsx)(hn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search resources...",value:i,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})}),(0,ga.jsx)("div",{className:"hidden md:flex flex-col bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,ga.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Logo"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Title"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Description"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Link"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Added Date"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Added By"}),(0,ga.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-slate-200",children:a?Array(4).fill(0).map((e,t)=>(0,ga.jsxs)("tr",{className:"table-row-hover",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-12 w-12 bg-slate-200 rounded skeleton"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-64"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-24"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-6 bg-slate-200 rounded skeleton w-20"})})]},t)):h.length>0?h.map(e=>(0,ga.jsxs)("tr",{className:"table-row-hover hover:bg-slate-50 transition-colors duration-150",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("div",{className:"h-12 w-12 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border border-slate-200",children:e.logoUrl?(0,ga.jsx)("img",{src:e.logoUrl,alt:e.title,className:"logo-img",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div class="text-slate-400"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>'}}):(0,ga.jsx)(dv,{className:"w-6 h-6 text-slate-400"})})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-slate-800",children:e.title}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-md truncate",children:e.description}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 hover:underline",children:[(0,ga.jsx)(Us,{className:"w-4 h-4"}),"Visit"]})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.addedDate}),(0,ga.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.addedBy}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)("button",{onClick:()=>r(e),className:"p-1.5 hover:bg-blue-50 rounded-lg transition-colors duration-150 text-blue-600 hover:text-blue-700",title:"Edit",children:(0,ga.jsx)(Kn,{className:"w-4 h-4"})}),(0,ga.jsx)("button",{onClick:()=>u(e.id),className:"p-1.5 hover:bg-red-50 rounded-lg transition-colors duration-150 text-red-600 hover:text-red-700",title:"Delete",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]})})]},e.id)):(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"7",className:"px-6 py-12",children:(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,ga.jsx)(uv,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 font-medium",children:"No resources found"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new link"})]})})})})]})})}),(0,ga.jsx)("div",{className:"md:hidden space-y-4 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:a?Array(4).fill(0).map((e,t)=>(0,ga.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:[(0,ga.jsxs)("div",{className:"flex items-start gap-4 mb-3",children:[(0,ga.jsx)("div",{className:"h-16 w-16 bg-slate-200 rounded-lg skeleton flex-shrink-0"}),(0,ga.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,ga.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-full"})]})]}),(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,ga.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-2/3"})]})]},t)):h.length>0?h.map(e=>(0,ga.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,ga.jsx)("div",{className:"p-4 border-b border-slate-100",children:(0,ga.jsxs)("div",{className:"flex items-start gap-4",children:[(0,ga.jsx)("div",{className:"h-16 w-16 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border border-slate-200 flex-shrink-0",children:e.logoUrl?(0,ga.jsx)("img",{src:e.logoUrl,alt:e.title,className:"logo-img",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div class="text-slate-400"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>'}}):(0,ga.jsx)(dv,{className:"w-8 h-8 text-slate-400"})}),(0,ga.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ga.jsx)("h3",{className:"text-base font-semibold text-slate-800 mb-1",children:e.title}),(0,ga.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2",children:e.description})]})]})}),(0,ga.jsxs)("div",{className:"p-4 space-y-3",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsx)("span",{className:"text-xs text-slate-500 font-medium",children:"Link"}),(0,ga.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 hover:underline font-medium",children:[(0,ga.jsx)(Us,{className:"w-4 h-4"}),"Visit Website"]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t border-slate-100",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("span",{className:"text-xs text-slate-500 block mb-1",children:"Added Date"}),(0,ga.jsx)("span",{className:"text-sm text-slate-700 font-medium",children:e.addedDate})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("span",{className:"text-xs text-slate-500 block mb-1",children:"Added By"}),(0,ga.jsx)("span",{className:"text-sm text-slate-700 font-medium",children:e.addedBy})]})]})]}),(0,ga.jsxs)("div",{className:"px-4 py-3 bg-slate-50 border-t border-slate-100 flex items-center justify-end gap-2",children:[(0,ga.jsxs)("button",{onClick:()=>r(e),className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-150",children:[(0,ga.jsx)(Kn,{className:"w-4 h-4"}),"Edit"]}),(0,ga.jsxs)("button",{onClick:()=>u(e.id),className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-150",children:[(0,ga.jsx)(On,{className:"w-4 h-4"}),"Delete"]})]})]},e.id)):(0,ga.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-12",children:(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,ga.jsx)(uv,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,ga.jsx)("p",{className:"text-slate-500 font-medium",children:"No resources found"}),(0,ga.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new link"})]})})}),(0,ga.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,ga.jsx)("button",{onClick:()=>{d()},className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh",children:(0,ga.jsx)(on,{className:"w-5 h-5 ".concat(a?"animate-spin":"group-hover:rotate-180 transition-transform duration-300")})})}),(0,ga.jsx)("div",{className:"h-8"})]})]})}function mv(e){let{onClose:t,initialItem:r,isEditMode:a}=e;const[n,i]=(0,s.useState)({title:"",link:"",description:"",logoUrl:""}),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)({});(0,s.useEffect)(()=>{a&&r&&(i({title:r.title||"",link:r.link||"",description:r.description||"",logoUrl:r.logoUrl||""}),r.logoUrl&&d(r.logoUrl))},[a,r]);const p=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),f[t]&&m(e=>We(We({},e),{},{[t]:""}))};return(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,ga.jsx)(uv,{className:"w-5 h-5 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h2",{className:"text-xl font-bold text-white",children:a?"Edit Resource":"Add New Resource"}),(0,ga.jsx)("p",{className:"text-blue-100 text-sm",children:a?"Update resource information":"Add a new logistics resource link"})]})]}),(0,ga.jsx)("button",{onClick:()=>t(),className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors duration-200",children:(0,ga.jsx)(Ea,{className:"w-5 h-5"})})]}),(0,ga.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return n.title.trim()||(e.title="Title is required"),n.link.trim()||(e.link="Link is required"),n.description.trim()||(e.description="Description is required"),a||l||c||(e.logo="Logo is required"),m(e),0===Object.keys(e).length})()){h(!0),console.log("this ");try{const e=new FormData;e.append("title",n.title),e.append("link",n.link),e.append("description",n.description),l?e.append("logoFile",l):n.logoUrl&&e.append("logoUrl",n.logoUrl);const s=a?r.addedDate:(new Date).toISOString().split("T")[0];e.append("addedDate",s),e.append("addedBy","Kavindu Tharaka");for(let[t,r]of e.entries())console.log(t,r);let i;a?(e.append("sysID",r.id),await hv.updateResource(e),i=We(We(We({},r),n),{},{logoUrl:c||n.logoUrl})):(await hv.createNewResource(e),i=We(We({id:Date.now()},n),{},{logoUrl:c||n.logoUrl,addedDate:s,addedBy:"Kavindu Tharaka"})),t(i),window.location.reload()}catch(s){console.error("Error saving item:",s),m({submit:"Failed to save. Please try again."})}finally{h(!1)}}},className:"p-6 space-y-5",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Title ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"title",value:n.title,onChange:p,placeholder:"e.g., Sri Lanka Ports Authority",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(f.title?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),f.title&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.title})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Link URL ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)(uv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,ga.jsx)("input",{type:"url",name:"link",value:n.link,onChange:p,placeholder:"https://example.com",className:"w-full pl-10 pr-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(f.link?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")})]}),f.link&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.link})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Description ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("textarea",{name:"description",value:n.description,onChange:p,placeholder:"Brief description of this resource...",rows:"3",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 resize-none ".concat(f.description?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),f.description&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.description})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Logo ",!a&&(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsxs)("div",{className:"flex gap-4",children:[c&&(0,ga.jsx)("div",{className:"shrink-0",children:(0,ga.jsx)("div",{className:"h-24 w-24 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border-2 border-slate-200",children:(0,ga.jsx)("img",{src:c,alt:"Logo preview",className:"max-h-full max-w-full object-contain"})})}),(0,ga.jsx)("div",{className:"flex-1",children:(0,ga.jsxs)("label",{htmlFor:"logo-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed rounded-lg cursor-pointer transition-all duration-200 ".concat(f.logo?"border-red-300 bg-red-50 hover:bg-red-100":"border-slate-300 bg-slate-50 hover:bg-slate-100"),children:[(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center pt-2 pb-2",children:[(0,ga.jsx)(Ks,{className:"w-6 h-6 mb-1 ".concat(f.logo?"text-red-400":"text-slate-400")}),(0,ga.jsxs)("p",{className:"text-xs ".concat(f.logo?"text-red-600":"text-slate-500"),children:[(0,ga.jsx)("span",{className:"font-medium",children:"Click to upload"})," or drag and drop"]}),(0,ga.jsx)("p",{className:"text-xs text-slate-400 mt-0.5",children:"PNG, JPG, GIF up to 5MB"})]}),(0,ga.jsx)("input",{id:"logo-upload",type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return void m(e=>We(We({},e),{},{logo:"Please select a valid image file"}));if(t.size>5242880)return void m(e=>We(We({},e),{},{logo:"File size must be less than 5MB"}));o(t);const e=new FileReader;e.onloadend=()=>{d(e.result)},e.readAsDataURL(t),f.logo&&m(e=>We(We({},e),{},{logo:""}))}},className:"hidden"})]})})]}),f.logo&&(0,ga.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.logo})]}),f.submit&&(0,ga.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:f.submit}),(0,ga.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[(0,ga.jsx)("button",{type:"button",onClick:()=>t(),disabled:u,className:"px-5 py-2.5 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,ga.jsx)("button",{type:"submit",disabled:u,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(as,{className:"w-4 h-4 animate-spin"}),(0,ga.jsx)("span",{children:"Saving..."})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Yn,{className:"w-4 h-4"}),(0,ga.jsx)("span",{children:a?"Update":"Save"})]})})]})]})]})}function pv(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),l=()=>{t(!1),i(null)};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(fv,{modalOpen:()=>{i(null),t(!0)},onEdit:e=>{i(e),t(!0)}})})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:l}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full max-w-2xl animate-fadeIn",children:(0,ga.jsx)(mv,{onClose:e=>{l()},initialItem:n,isEditMode:!!n})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const gv=Ta("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),xv=Ta("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),bv=Ta("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),vv=Ta("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),yv=Ta("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),wv=Ta("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),Nv=e=>{let{employees:t,selectedRole:r,isEditMode:a,onClose:n,onSuccess:i}=e;const[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)({employeeId:"",username:"",password:"",isAdmin:!1,isActive:!0,rateManageView:!1,rateManageAdd:!1,rateManageEdit:!1,usefulLinksView:!1,usefulLinksAdd:!1,usefulLinksEdit:!1,salesPlanView:!1,salesPlanAdd:!1,salesPlanEdit:!1,quotesView:!1,quotesAdd:!1,quotesEdit:!1,rfqView:!1,rfqAdd:!1,rfqEdit:!1,contactView:!1,contactAdd:!1,contactEdit:!1,accountView:!1,accountAdd:!1,accountEdit:!1,systemManagementView:!1,systemManagementAdd:!1,systemManagementEdit:!1}),f=[{name:"Rate Manage",key:"rateManage",icon:xv,color:"text-blue-600",bgColor:"bg-blue-100"},{name:"Useful Links",key:"usefulLinks",icon:uv,color:"text-green-600",bgColor:"bg-green-100"},{name:"Sales Plan",key:"salesPlan",icon:Ma,color:"text-purple-600",bgColor:"bg-purple-100"},{name:"Quotes",key:"quotes",icon:Ha,color:"text-orange-600",bgColor:"bg-orange-100"},{name:"RFQ",key:"rfq",icon:bv,color:"text-pink-600",bgColor:"bg-pink-100"},{name:"Contact",key:"contact",icon:vs,color:"text-indigo-600",bgColor:"bg-indigo-100"},{name:"Account",key:"account",icon:Ya,color:"text-teal-600",bgColor:"bg-teal-100"},{name:"System Management",key:"systemManagement",icon:vv,color:"text-red-600",bgColor:"bg-red-100"}];(0,s.useEffect)(()=>{a&&r&&h({employeeId:r.employeeId||"",username:r.username||"",password:"",isAdmin:r.isAdmin||!1,isActive:void 0===r.isActive||r.isActive,rateManageView:r.rateManageView||!1,rateManageAdd:r.rateManageAdd||!1,rateManageEdit:r.rateManageEdit||!1,usefulLinksView:r.usefulLinksView||!1,usefulLinksAdd:r.usefulLinksAdd||!1,usefulLinksEdit:r.usefulLinksEdit||!1,salesPlanView:r.salesPlanView||!1,salesPlanAdd:r.salesPlanAdd||!1,salesPlanEdit:r.salesPlanEdit||!1,quotesView:r.quotesView||!1,quotesAdd:r.quotesAdd||!1,quotesEdit:r.quotesEdit||!1,rfqView:r.rfqView||!1,rfqAdd:r.rfqAdd||!1,rfqEdit:r.rfqEdit||!1,contactView:r.contactView||!1,contactAdd:r.contactAdd||!1,contactEdit:r.contactEdit||!1,accountView:r.accountView||!1,accountAdd:r.accountAdd||!1,accountEdit:r.accountEdit||!1,systemManagementView:r.systemManagementView||!1,systemManagementAdd:r.systemManagementAdd||!1,systemManagementEdit:r.systemManagementEdit||!1})},[r,a]);const m=e=>{const{name:t,value:r,type:a,checked:n}=e.target;h(e=>We(We({},e),{},{[t]:"checkbox"===a?n:r}))},p=(e,t)=>{const r="".concat(e).concat(t);h(e=>We(We({},e),{},{[r]:!e[r]}))},g=t.find(e=>e.id===u.employeeId);return(0,ga.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),u.employeeId?u.username.trim()?a||u.password.trim()?!(u.password&&u.password.length<6)||(alert("Password must be at least 6 characters long"),0):(alert("Please enter a password"),0):(alert("Please enter a username"),0):(alert("Please select an employee"),0))try{o(!0);const e=(e=>{const t={EmployeeId:e.employeeId,Username:e.username,IsAdmin:e.isAdmin,IsActive:e.isActive,RateManageView:e.rateManageView,RateManageAdd:e.rateManageAdd,RateManageEdit:e.rateManageEdit,UsefulLinksView:e.usefulLinksView,UsefulLinksAdd:e.usefulLinksAdd,UsefulLinksEdit:e.usefulLinksEdit,SalesPlanView:e.salesPlanView,SalesPlanAdd:e.salesPlanAdd,SalesPlanEdit:e.salesPlanEdit,QuotesView:e.quotesView,QuotesAdd:e.quotesAdd,QuotesEdit:e.quotesEdit,RfqView:e.rfqView,RfqAdd:e.rfqAdd,RfqEdit:e.rfqEdit,ContactView:e.contactView,ContactAdd:e.contactAdd,ContactEdit:e.contactEdit,AccountView:e.accountView,AccountAdd:e.accountAdd,AccountEdit:e.accountEdit,SystemManagementView:e.systemManagementView,SystemManagementAdd:e.systemManagementAdd,SystemManagementEdit:e.systemManagementEdit};return e.password&&e.password.trim()&&(t.Password=e.password),t})(u);console.log("this is y: ",e),a?(await Ia.updateUserRole(r.id,e),alert("User role updated successfully!")):(await Ia.createUserRole(e),alert("User role created successfully!")),i()}catch(c){var t,n,s,l;console.error("Error saving user role:",c);const e=(null===(t=c.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||(null===(s=c.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.Message)||"Failed to save user role. Please try again.";alert(e)}finally{o(!1)}},className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Oa,{className:"w-5 h-5 text-purple-600"}),"Employee Information"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Employee ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsxs)("select",{name:"employeeId",value:u.employeeId,onChange:m,disabled:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",required:!0,children:[(0,ga.jsx)("option",{value:"",children:"-- Select Employee --"}),t.map(e=>(0,ga.jsxs)("option",{value:e.id,children:[e.fullName," - ",e.sysID]},e.id))]})]}),g&&(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:(0,ga.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,ga.jsxs)("p",{children:[(0,ga.jsx)("span",{className:"font-medium",children:"Department:"})," ",g.department||"N/A"]}),(0,ga.jsxs)("p",{children:[(0,ga.jsx)("span",{className:"font-medium",children:"Position:"})," ",g.position||"N/A"]}),(0,ga.jsxs)("p",{children:[(0,ga.jsx)("span",{className:"font-medium",children:"Email:"})," ",g.email||"N/A"]}),(0,ga.jsxs)("p",{children:[(0,ga.jsx)("span",{className:"font-medium",children:"Location:"})," ",g.location||"N/A"]})]})})]})]}),(0,ga.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(gv,{className:"w-5 h-5 text-purple-600"}),"Login Credentials"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username ",(0,ga.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ga.jsx)("input",{type:"text",name:"username",value:u.username,onChange:m,placeholder:"Enter username",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",!a&&(0,ga.jsx)("span",{className:"text-red-500",children:"*"}),a&&(0,ga.jsx)("span",{className:"text-sm text-gray-500",children:"(Leave empty to keep current)"})]}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("input",{type:c?"text":"password",name:"password",value:u.password,onChange:m,placeholder:a?"Enter new password":"Enter password",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!a}),(0,ga.jsx)("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:c?(0,ga.jsx)(Yb,{className:"w-5 h-5"}):(0,ga.jsx)(fn,{className:"w-5 h-5"})})]})]})]})]}),(0,ga.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:(0,ga.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,ga.jsx)("input",{type:"checkbox",name:"isActive",checked:u.isActive,onChange:m,className:"w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Active Status"}),(0,ga.jsx)("p",{className:"text-sm text-gray-500",children:"User can log in and access assigned modules"})]})]})}),(0,ga.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,ga.jsxs)("div",{className:"bg-purple-50 px-6 py-4 border-b border-purple-100 flex items-center justify-between",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,ga.jsx)(Xa,{className:"w-5 h-5 text-purple-600"}),"Module Permissions"]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>{const e=f.every(e=>u["".concat(e.key,"View")]&&u["".concat(e.key,"Add")]&&u["".concat(e.key,"Edit")]),t={};f.forEach(r=>{t["".concat(r.key,"View")]=!e,t["".concat(r.key,"Add")]=!e,t["".concat(r.key,"Edit")]=!e}),h(e=>We(We({},e),t))},className:"text-sm text-purple-600 hover:text-purple-700 font-medium flex items-center gap-1",children:[(0,ga.jsx)(yv,{className:"w-4 h-4"}),"Select All"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/3",children:"Module"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-20",children:"View"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-20",children:"Add"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-20",children:"Edit"}),(0,ga.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-24",children:"All"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-gray-200",children:f.map(e=>{const t=e.icon,r=u["".concat(e.key,"View")]&&u["".concat(e.key,"Add")]&&u["".concat(e.key,"Edit")];return(0,ga.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"p-2 rounded-lg ".concat(e.bgColor),children:(0,ga.jsx)(t,{className:"w-5 h-5 ".concat(e.color)})}),(0,ga.jsx)("span",{className:"font-medium text-gray-900",children:e.name})]})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ga.jsx)("button",{type:"button",onClick:()=>p(e.key,"View"),className:"inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-100 transition-colors",children:u["".concat(e.key,"View")]?(0,ga.jsx)(yv,{className:"w-5 h-5 text-purple-600"}):(0,ga.jsx)(wv,{className:"w-5 h-5 text-gray-400"})})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ga.jsx)("button",{type:"button",onClick:()=>p(e.key,"Add"),className:"inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-100 transition-colors",children:u["".concat(e.key,"Add")]?(0,ga.jsx)(yv,{className:"w-5 h-5 text-green-600"}):(0,ga.jsx)(wv,{className:"w-5 h-5 text-gray-400"})})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ga.jsx)("button",{type:"button",onClick:()=>p(e.key,"Edit"),className:"inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-100 transition-colors",children:u["".concat(e.key,"Edit")]?(0,ga.jsx)(yv,{className:"w-5 h-5 text-blue-600"}):(0,ga.jsx)(wv,{className:"w-5 h-5 text-gray-400"})})}),(0,ga.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{const t=u["".concat(e,"View")]&&u["".concat(e,"Add")]&&u["".concat(e,"Edit")];h(r=>We(We({},r),{},{["".concat(e,"View")]:!t,["".concat(e,"Add")]:!t,["".concat(e,"Edit")]:!t}))})(e.key),className:"px-3 py-1 rounded-full text-sm font-medium transition-colors ".concat(r?"bg-purple-100 text-purple-700 hover:bg-purple-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:r?"All":"None"})})]},e.key)})})]})})]}),(0,ga.jsx)("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 rounded-lg p-6 border border-red-200",children:(0,ga.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,ga.jsx)("input",{type:"checkbox",name:"isAdmin",checked:u.isAdmin,onChange:m,className:"w-5 h-5 text-red-600 border-gray-300 rounded focus:ring-red-500 mt-0.5"}),(0,ga.jsxs)("div",{className:"flex-1",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,ga.jsx)(Xa,{className:"w-5 h-5 text-red-600"}),(0,ga.jsx)("span",{className:"text-sm font-bold text-red-900",children:"Administrator Access"})]}),(0,ga.jsx)("p",{className:"text-sm text-red-700",children:"Grant full system access with administrative privileges. Administrators can manage all modules, users, and system settings regardless of individual permissions."})]})]})}),(0,ga.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,ga.jsxs)("button",{type:"button",onClick:n,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",disabled:l,children:[(0,ga.jsx)(Ea,{className:"w-5 h-5"}),"Cancel"]}),(0,ga.jsx)("button",{type:"submit",className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)(Yn,{className:"w-5 h-5"}),a?"Update Role":"Create Role"]})})]})]})},jv=e=>{let{employees:t,selectedRole:r,isEditMode:a,onClose:n,onSuccess:i}=e;const l=(0,s.useRef)(null);return(0,s.useEffect)(()=>{const e=e=>{l.current&&!l.current.contains(e.target)&&n()},t=e=>{"Escape"===e.key&&n()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),document.body.style.overflow="hidden",()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[n]),(0,ga.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ga.jsxs)("div",{ref:l,className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,ga.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4 flex items-center justify-between",children:[(0,ga.jsx)("h2",{className:"text-xl font-bold text-white",children:a?"Edit User Role & Permissions":"Create New User Role"}),(0,ga.jsx)("button",{onClick:n,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1 transition-colors",children:(0,ga.jsx)(Ea,{className:"w-6 h-6"})})]}),(0,ga.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,ga.jsx)(Nv,{employees:t,selectedRole:r,isEditMode:a,onClose:n,onSuccess:i})})]})})};function kv(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(0),[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)([]),[p,g]=(0,s.useState)([]),[x,b]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N(),w()},[c]),(0,s.useEffect)(()=>{j()},[x,f]);const w=async()=>{try{const e=(await Ss()).map(e=>({id:e.sysID.toString(),sysID:e.sysID,firstName:e.fname,lastName:e.lname,fullName:"".concat(e.fname," ").concat(e.lname),email:e.email,phone:e.tp,position:e.position,department:e.department,location:e.w_location,manager:e.a_manager,status:e.status}));h(e)}catch(e){console.error("Error fetching employees:",e)}},N=async()=>{try{y(!0);const e=await Ia.fetchUserRoles();console.log("bbbb: ",e);const t=e.map(e=>({id:e.id,employeeId:e.employeeId,employeeName:e.employeeName||"Unknown Employee",username:e.username,isAdmin:e.isAdmin,isActive:e.isActive,rateManageView:e.rateManageView,rateManageAdd:e.rateManageAdd,rateManageEdit:e.rateManageEdit,usefulLinksView:e.usefulLinksView,usefulLinksAdd:e.usefulLinksAdd,usefulLinksEdit:e.usefulLinksEdit,salesPlanView:e.salesPlanView,salesPlanAdd:e.salesPlanAdd,salesPlanEdit:e.salesPlanEdit,quotesView:e.quotesView,quotesAdd:e.quotesAdd,quotesEdit:e.quotesEdit,rfqView:e.rfqView,rfqAdd:e.rfqAdd,rfqEdit:e.rfqEdit,contactView:e.contactView,contactAdd:e.contactAdd,contactEdit:e.contactEdit,accountView:e.accountView,accountAdd:e.accountAdd,accountEdit:e.accountEdit,systemManagementView:e.systemManagementView,systemManagementAdd:e.systemManagementAdd,systemManagementEdit:e.systemManagementEdit,createdAt:e.createdAt,updatedAt:e.updatedAt}));m(t),g(t)}catch(e){console.error("Error fetching user roles:",e),alert("Failed to load user roles. Please try again.")}finally{y(!1)}},j=()=>{if(!x.trim())return void g(f);const e=f.filter(e=>{var t,r,a;return(null===(t=e.employeeName)||void 0===t?void 0:t.toLowerCase().includes(x.toLowerCase()))||(null===(r=e.username)||void 0===r?void 0:r.toLowerCase().includes(x.toLowerCase()))||(null===(a=e.employeeId)||void 0===a?void 0:a.toLowerCase().includes(x.toLowerCase()))});g(e)},k=()=>{t(!1),i(null),o(!1)},S=e=>{i(e),o(!0),t(!0)},A=async e=>{if(window.confirm("Are you sure you want to delete this user role? This will revoke all access permissions."))try{await Ia.deleteUserRole(e),d(e=>e+1),alert("User role deleted successfully!")}catch(a){var t,r;console.error("Error deleting user role:",a),alert((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Failed to delete user role. Please try again.")}};return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsxs)("main",{className:"flex-1 overflow-y-auto p-6",children:[(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,ga.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,ga.jsx)(Xa,{className:"w-6 h-6 text-purple-600"})}),(0,ga.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Employee Role Management"})]}),(0,ga.jsx)("p",{className:"text-gray-600 ml-14",children:"Manage employee access permissions and system roles"})]}),(0,ga.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,ga.jsxs)("div",{className:"flex-1 relative",children:[(0,ga.jsx)(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,ga.jsx)("input",{type:"text",placeholder:"Search by employee name, username, or ID...",value:x,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,ga.jsxs)("button",{onClick:()=>{i(null),o(!1),t(!0)},className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:[(0,ga.jsx)(dn,{className:"w-5 h-5"}),"Add User Role"]})]})}),(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,ga.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-purple-50 border-b border-purple-100",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Employee"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Username"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Role Type"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Permissions"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Status"}),(0,ga.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Actions"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-gray-200",children:v?(0,ga.jsx)("tr",{children:(0,ga.jsx)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:(0,ga.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,ga.jsx)("div",{className:"w-5 h-5 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"}),"Loading user roles..."]})})}):0===p.length?(0,ga.jsx)("tr",{children:(0,ga.jsxs)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:[(0,ga.jsx)(vs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,ga.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-1",children:"No user roles found"}),(0,ga.jsx)("p",{className:"text-sm text-gray-500",children:x?"Try adjusting your search criteria":'Click "Add User Role" to create the first one'})]})}):p.map(e=>{const t=[e.rateManageView,e.rateManageAdd,e.rateManageEdit,e.usefulLinksView,e.usefulLinksAdd,e.usefulLinksEdit,e.salesPlanView,e.salesPlanAdd,e.salesPlanEdit,e.quotesView,e.quotesAdd,e.quotesEdit,e.rfqView,e.rfqAdd,e.rfqEdit,e.contactView,e.contactAdd,e.contactEdit,e.accountView,e.accountAdd,e.accountEdit,e.systemManagementView,e.systemManagementAdd,e.systemManagementEdit].filter(Boolean).length;return(0,ga.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:(0,ga.jsx)(vs,{className:"w-5 h-5 text-purple-600"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("div",{className:"font-medium text-gray-900",children:e.employeeName}),(0,ga.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.employeeId]})]})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(gv,{className:"w-4 h-4 text-gray-400"}),(0,ga.jsx)("span",{className:"text-gray-900 font-medium",children:e.username})]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:e.isAdmin?(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:[(0,ga.jsx)(Xa,{className:"w-4 h-4"}),"Administrator"]}):(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[(0,ga.jsx)(vs,{className:"w-4 h-4"}),"Standard User"]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("span",{className:"text-sm text-gray-600",children:[t," permissions assigned"]})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsx)("span",{className:"inline-flex px-3 py-1 rounded-full text-sm font-medium ".concat(e.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.isActive?"Active":"Inactive"})}),(0,ga.jsx)("td",{className:"px-6 py-4",children:(0,ga.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,ga.jsx)("button",{onClick:()=>S(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Role",children:(0,ga.jsx)(Pn,{className:"w-4 h-4"})}),(0,ga.jsx)("button",{onClick:()=>A(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Role",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]})})]},e.id)})})]})}),(0,ga.jsx)("div",{className:"md:hidden p-4 space-y-4",children:v?(0,ga.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-12",children:(0,ga.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,ga.jsx)("div",{className:"w-8 h-8 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"}),(0,ga.jsx)("p",{className:"text-gray-500",children:"Loading user roles..."})]})}):0===p.length?(0,ga.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-12",children:(0,ga.jsxs)("div",{className:"text-center",children:[(0,ga.jsx)(vs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,ga.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-1",children:"No user roles found"}),(0,ga.jsx)("p",{className:"text-sm text-gray-500",children:x?"Try adjusting your search criteria":'Click "Add User Role" to create the first one'})]})}):p.map(e=>{const t=[e.rateManageView,e.rateManageAdd,e.rateManageEdit,e.usefulLinksView,e.usefulLinksAdd,e.usefulLinksEdit,e.salesPlanView,e.salesPlanAdd,e.salesPlanEdit,e.quotesView,e.quotesAdd,e.quotesEdit,e.rfqView,e.rfqAdd,e.rfqEdit,e.contactView,e.contactAdd,e.contactEdit,e.accountView,e.accountAdd,e.accountEdit,e.systemManagementView,e.systemManagementAdd,e.systemManagementEdit].filter(Boolean).length;return(0,ga.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,ga.jsxs)("div",{className:"p-4 bg-purple-50 border-b border-purple-100",children:[(0,ga.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,ga.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,ga.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,ga.jsx)(vs,{className:"w-6 h-6 text-purple-600"})}),(0,ga.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ga.jsx)("h3",{className:"font-semibold text-gray-900 text-base mb-1",children:e.employeeName}),(0,ga.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:["ID: ",e.employeeId]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsx)(gv,{className:"w-3 h-3 text-gray-400"}),(0,ga.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:e.username})]})]})]})}),(0,ga.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[e.isAdmin?(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:[(0,ga.jsx)(Xa,{className:"w-3 h-3"}),"Administrator"]}):(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[(0,ga.jsx)(vs,{className:"w-3 h-3"}),"Standard User"]}),(0,ga.jsx)("span",{className:"inline-flex px-3 py-1 rounded-full text-xs font-medium ".concat(e.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.isActive?"Active":"Inactive"})]})]}),(0,ga.jsxs)("div",{className:"p-4",children:[(0,ga.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 mb-4",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,ga.jsx)(Xa,{className:"w-4 h-4 text-purple-600"}),(0,ga.jsx)("span",{className:"text-xs font-semibold text-purple-900",children:"Permissions"})]}),(0,ga.jsxs)("div",{className:"text-lg font-bold text-purple-700",children:[t," assigned"]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsxs)("button",{onClick:()=>S(e),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,ga.jsx)(Pn,{className:"w-4 h-4"}),"Edit Role"]}),(0,ga.jsxs)("button",{onClick:()=>A(e.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[(0,ga.jsx)(On,{className:"w-4 h-4"}),"Delete"]})]})]})]},e.id)})})]})]})]}),e&&(0,ga.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ga.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:k}),(0,ga.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,ga.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,ga.jsx)(jv,{employees:u,selectedRole:n,isEditMode:l,onClose:k,onSuccess:()=>{d(e=>e+1),k()}})})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Sv=function(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1),[c]=(0,s.useState)({sysID:9,fname:"Tharanga",lname:"Liyanage",email:"Tharanga@gmail.com",tp:"0781447845",position:"Forklift Operator",department:"Supply Chain",w_location:"Colombo",a_manager:"Jane Smith",note:"Demo",status:"Active",username:""}),[d,u]=(0,s.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),h=(e,t)=>{u(r=>We(We({},r),{},{[e]:t}))};return(0,ga.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 p-4 md:p-6 lg:p-8",children:(0,ga.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsx)("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"My Profile"}),(0,ga.jsx)("p",{className:"text-slate-600",children:"Manage your personal information and account settings"})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,ga.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 h-32 relative",children:(0,ga.jsx)("div",{className:"absolute -bottom-16 left-8",children:(0,ga.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full w-32 h-32 flex items-center justify-center text-3xl font-bold shadow-lg border-4 border-white",children:"".concat(c.fname.charAt(0)).concat(c.lname.charAt(0))})})}),(0,ga.jsxs)("div",{className:"pt-20 px-8 pb-8",children:[(0,ga.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h2",{className:"text-2xl font-bold text-slate-800",children:[c.fname," ",c.lname]}),(0,ga.jsx)("p",{className:"text-slate-600 mt-1",children:c.position})]}),(0,ga.jsxs)("span",{className:"px-4 py-1.5 rounded-full text-sm font-medium ".concat("Active"===c.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[(0,ga.jsx)(Ns,{className:"w-4 h-4 inline mr-1"}),c.status]})]}),(0,ga.jsxs)("div",{className:"mb-8",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Oa,{className:"w-5 h-5 text-blue-600"}),"Personal Information"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"First Name"}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.fname})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Last Name"}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.lname})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(qa,{className:"w-4 h-4 text-blue-600"}),"Email Address"]}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.email})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(us,{className:"w-4 h-4 text-blue-600"}),"Phone Number"]}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.tp})]})]})]}),(0,ga.jsxs)("div",{className:"mb-8",children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Ya,{className:"w-5 h-5 text-blue-600"}),"Work Information"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Position"}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.position})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(Ka,{className:"w-4 h-4 text-blue-600"}),"Department"]}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.department})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(Tn,{className:"w-4 h-4 text-blue-600"}),"Work Location"]}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.w_location})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(vs,{className:"w-4 h-4 text-blue-600"}),"Assigned Manager"]}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.a_manager})]}),(0,ga.jsxs)("div",{className:"md:col-span-2",children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-4 h-4 text-blue-600"}),"Notes"]}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.note||"No notes added"})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,ga.jsx)(Xa,{className:"w-5 h-5 text-blue-600"}),"Account Security"]}),(0,ga.jsxs)("div",{className:"mb-4",children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),(0,ga.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800 border border-slate-200",children:c.username})]}),n?(0,ga.jsx)("div",{className:"bg-slate-50 rounded-lg p-6 border border-slate-200",children:(0,ga.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Current Password"}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("input",{type:e?"text":"password",value:d.currentPassword,onChange:e=>h("currentPassword",e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all pr-10",placeholder:"Enter current password"}),(0,ga.jsx)("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:e?(0,ga.jsx)(Yb,{className:"w-5 h-5"}):(0,ga.jsx)(fn,{className:"w-5 h-5"})})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"New Password"}),(0,ga.jsx)("input",{type:"password",value:d.newPassword,onChange:e=>h("newPassword",e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter new password (min. 6 characters)"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Confirm New Password"}),(0,ga.jsxs)("div",{className:"relative",children:[(0,ga.jsx)("input",{type:r?"text":"password",value:d.confirmPassword,onChange:e=>h("confirmPassword",e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all pr-10",placeholder:"Confirm new password"}),(0,ga.jsx)("button",{type:"button",onClick:()=>a(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:r?(0,ga.jsx)(Yb,{className:"w-5 h-5"}):(0,ga.jsx)(fn,{className:"w-5 h-5"})})]})]}),d.newPassword&&(0,ga.jsxs)("div",{className:"text-xs text-slate-600",children:["Password strength:",(0,ga.jsx)("span",{className:"ml-2 font-medium ".concat(d.newPassword.length<6?"text-red-600":d.newPassword.length<10?"text-yellow-600":"text-green-600"),children:d.newPassword.length<6?"Weak":d.newPassword.length<10?"Medium":"Strong"})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,ga.jsx)("button",{onClick:async()=>{d.newPassword===d.confirmPassword?d.newPassword.length<6?alert("Password must be at least 6 characters!"):(o(!0),setTimeout(()=>{console.log("Password updated"),u({currentPassword:"",newPassword:"",confirmPassword:""}),i(!1),o(!1),alert("Password updated successfully!")},1e3)):alert("Passwords don't match!")},disabled:l||!d.currentPassword||!d.newPassword||!d.confirmPassword,className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Updating...":"Update Password"}),(0,ga.jsx)("button",{onClick:()=>{i(!1),u({currentPassword:"",newPassword:"",confirmPassword:""})},className:"px-4 py-2.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg transition-all duration-200 font-medium",children:"Cancel"})]})]})}):(0,ga.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 font-medium",children:"Change Password"})]})]})]})]})})};function Av(){const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null);return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{a(!r)},isMobileMenuOpen:r}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:r,onClose:()=>{a(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(Sv,{})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Cv=Ta("file-down",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),_v=Ta("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),Tv=Ta("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function Ev(e){let{label:t,value:r,onChange:a,suggestions:n=[],placeholder:i="",showLabel:l=!0,disabled:o=!1}=e;const[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)(0),[p,g]=(0,s.useState)({}),x=(0,s.useRef)(null),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&h(!1)},t=()=>{u&&h(!1)};return document.addEventListener("mousedown",e),window.addEventListener("scroll",t,!0),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t,!0)}},[u]),(0,s.useEffect)(()=>{if(u&&b.current){const e=b.current.getBoundingClientRect();g({position:"fixed",top:"".concat(e.bottom+2,"px"),left:"".concat(e.left,"px"),width:"".concat(e.width,"px"),zIndex:9999})}},[u,r]);const v=e=>{a(e),d([]),h(!1),m(0)};return(0,ga.jsxs)("div",{ref:x,className:"relative",children:[l&&t&&(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,ga.jsx)("input",{ref:b,type:"text",value:r,onChange:e=>{const t=e.target.value;a(t);const r=n.filter(e=>e.toLowerCase().includes(t.toLowerCase())).slice(0,5);d(r),h(!0),m(0)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),u&&c[f]&&v(c[f])):"ArrowUp"===e.key?(e.preventDefault(),f>0&&m(f-1)):"ArrowDown"===e.key?(e.preventDefault(),f<c.length-1&&m(f+1)):"Escape"===e.key&&h(!1)},onFocus:()=>{if(n.length>0&&!o){const e=n.slice(0,5);d(e),h(!0)}},placeholder:i||(t?"Enter ".concat(t.toLowerCase(),"..."):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",autoComplete:"off",disabled:o}),u&&c.length>0&&!o&&(0,ga.jsx)("ul",{style:p,className:"bg-white border border-gray-300 rounded-lg mt-1 shadow-lg overflow-hidden",children:c.map((e,t)=>(0,ga.jsx)("li",{onClick:()=>v(e),onMouseEnter:()=>m(t),className:"px-3 py-2 cursor-pointer text-sm transition-colors ".concat(t===f?"bg-blue-100 text-blue-900":"hover:bg-gray-100"),children:e},t))})]})}const Lv={pickup:["Colombo Port","BIA Cargo Terminal","Hambantota Port","Chennai Port","Mumbai Port","Singapore Port","Dubai Cargo Village","Warehouse - Katunayake","Warehouse - Colombo","Customer Premises"],delivery:["Colombo","Galle","Kandy","Jaffna","Trincomalee","Negombo","Kurunegala","Anuradhapura","Batticaloa","Matara"]},Pv=["Aarhus(AAR)","Abadan(ABD)","Abech\xe9(AEH)","Aberdeen(ABZ)","Aberdeen (SD)(ABR)","Abidjan(ABJ)","Abilene (TX)(ABI)","Abu Dhabi - Abu Dhabi International(AUH)","Abu Rudeis(AUE)","Abu Simbel(ABS)","Abuja - Nnamdi Azikiwe International Airport(ABV)","Acapulco(ACA)","Accra - Kotoka International Airport(ACC)","Adana(ADA)","Addis Ababa - Bole International Airport(ADD)","Adelaide(ADL)","Aden - Aden International Airport(ADE)","Adiyaman(ADF)","Adler/Sochi(AER)","Agades(AJY)","Agadir(AGA)","Agana (Hag\xe5t\xf1a)(SUM)","Aggeneys(AGZ)","Aguadilla(BQN)","Aguascaliente(AGU)","Ahmedabad(AMD)","Aiyura(AYU)","Ajaccio(AJA)","Akita(AXT)","Akron (OH)(CAK)","Akrotiri - RAF(AKT)","Al Ain(AAN)","Al Arish(AAC)","Al Hoceima(AHU)","Albany(ALH)","Albany (GA)(ABY)","Albany (NY) - Albany International Airport(ALB)","Albi(LBI)","Alborg(AAL)","Albuquerque (NM)(ABQ)","Albury(ABX)","Alderney(ACI)","Aleppo(ALP)","Alesund(AES)","Alexander Bay - Kortdoorn(ALJ)","Alexandria - Esler Field(ESF)","Alexandria - Borg el Arab Airport(HBH)","Alexandria - El Nhouza Airport(ALY)","Alghero Sassari(AHO)","Algiers, Houari Boumediene Airport(ALG)","Alicante(ALC)","Alice Springs(ASP)","Alldays(ADY)","Allentown (PA)(ABE)","Almaty (Alma Ata) - Almaty International Airport(ALA)","Almeria(LEI)","Alta(ALF)","Altay(AAT)","Altenrhein(ACH)","Altoona (PA)(AOO)","Altus(AXS)","Amami(ASJ)","Amarillo (TX)(AMA)","Amazon Bay(AZB)","Amman - Amman-Mark\xe1 International Airport(ADJ)","Amman - Queen Alia International Airport(AMM)","Amritsar(ATQ)","Amsterdam - Amsterdam Airport Schiphol(AMS)","Anand(QNB)","Anchorage (AK) - Ted Stevens Anchorage International(ANC)","Ancona - Ancona Falconara Airport(AOI)","Andorra La Vella - Heliport(ALV)","Anguilla(AXA)","Anjouan - Anjouan Airport(AJN)","Ankara(ANK)","Ankara - Esenbo\u011fa International Airport(ESB)","Ann Arbor (MI)(ARB)","Annaba(AAE)","Annecy(NCY)","Anniston (AL)(ANB)","Antalya(AYT)","Antananarivo (Tananarive) - Ivato International Airport(TNR)","Antigua, V.C. Bird International(ANU)","Antwerp(ANR)","Aomori(AOJ)","Apia - Faleolo International Airport(APW)","Appleton/Neenah/Menasha (WI)(ATW)","Aqaba(AQJ)","Aracaju(AJU)","Araxos(GPA)","Arkhangelsk(ARH)","Arlit(RLT)","Arrecife/Lanzarote(ACE)","Aruba - Reina Beatrix International, Oranjestad(AUA)","Arusha(ARK)","Asheville (NC)(AVL)","Ashgabat - Saparmurat Turkmenbashy Int. Airport(ASB)","Asmara - Asmara International(ASM)","Aspen (CO) - Aspen-Pitkin County Airport(ASE)","Assiut(ATZ)","Astana - Astana International Airport(TSE)","Asuncion - Asunci\xf3n International Airport(ASU)","Aswan - Daraw Airport(ASW)","Athens (GA)(AHN)","Athens (OH)(ATO)","Athens - Elefth\xe9rios Veniz\xe9los International Airport(ATH)","Athens, Hellinikon Airport(HEW)","Atlanta (GA) - Hartsfield Atlanta International Airport(ATL)","Atlantic City (NJ) - Atlantic City International(ACY)","Attawapiskat(YAT)","Auckland - Auckland International Airport(AKL)","Augsburg - Augsburg Airport(AGB)","Augusta (GA)(AGS)","Augusta (ME) - Augusta State Airport(AUG)","Aurillac(AUR)","Austin (TX) - Austin-Bergstrom Airport(AUS)","Ayawasi(AYW)","Ayers Rock - Connellan(AYQ)","Ayr(AYR)","Badajoz(BUZ)","Bagdad - Baghdad International Airport(BGW)","Bagdogra(IXB)","Bahamas - Lynden Pindling International Airport(NAS)","Bahawalpur(BHV)","Bahrain - Bahrain International Airport(BAH)","Bakersfield (CA)(BFL)","Baku - Heydar Aliyev International Airport(BAK)","Ballina(BNK)","Baltimore (MD) - Washington International Airport(BWI)","Bamaga(ABM)","Bamako - Bamako-S\xe9nou International Airport(BKO)","Bambari(BBY)","Bandar Seri Begawan - Brunei International Airport(BWN)","Bandung - Husein Sastranegara International Airport(BDO)","Bangalore(BLR)","Bangassou(BGU)","Bangkok, Don Muang(DMK)","Bangkok, Suvarnabhumi International(BKK)","Bangor (ME)(BGR)","Bangui - M'Poko International Airport(BGF)","Banjul - Banjul International Airport(BJL)","Bannu(BNP)","Barcelona(BCN)","Barcelona(BLA)","Bardufoss(BDU)","Bari(BRI)","Barisal(BZL)","Baroda(BDQ)","Barra (the famous tidal beach landing)(BRR)","Barranquilla(BAQ)","Basel(BSL)","Basel/Mulhouse(EAP)","Basra, Basrah(BSR)","Basse-Terre - Pointe-\xe0-Pitre International Airport(PTP)","Basseterre - Robert L. Bradshaw International Airport(SKB)","Bastia(BIA)","Baton Rouge (LA) - Baton Rouge Metropolitan Airport(BTR)","Bayreuth - Bindlacher-Berg(BYU)","Beaumont/Pt. Arthur (TX)(BPT)","Beckley (WV)(BKW)","Beef Island - Terrance B. Lettsome(EIS)","Beijing(PEK)","Beijing - Nanyuan Airport(NAY)","Beira(BEW)","Beirut - Beirut Rafic Hariri International Airport(BEY)","Belem - Val de Cans International Airport(BEL)","Belfast - Belfast International Airport(BFS)","Belfast - George Best Belfast City Airport(BHD)","Belgaum(IXG)","Belgrad (Beograd) - Belgrade Nikola Tesla International(BEG)","Belize City - Philip S.W.Goldson International(BZE)","Bellingham (WA)(BLI)","Belo Horizonte - Tancredo Neves International Airport(CNF)","Bemidji (MN)(BJI)","Benbecula(BEB)","Benghazi (Bengasi)(BEN)","Benguela(BUG)","Benton Harbour (MI)(BEH)","Berberati(BBT)","Bergamo/Milan - Orio Al Serio(BGY)","Bergen(BGO)","Bergerac - Roumanieres(EGC)","Berlin(BER)","Berlin, Schoenefeld(SXF)","Berlin, Tegel(TXL)","Berlin, Tempelhof(THF)","Bermuda - L.F. Wade International Airport(BDA)","Berne, Bern-Belp(BRN)","Berne, Railway Service(ZDJ)","Bethel (AK)(BET)","Bhopal(BHO)","Bhubaneswar(BBI)","Biarritz(BIQ)","Bilbao(BIO)","Billings (MT)(BIL)","Billund(BLL)","Bintulu(BTU)","Biraro(IRO)","Birmingham (AL)(BHM)","Birmingham - Birmingham International Airport(BHX)","Bishkek - Manas International Airport(FRU)","Bismarck (ND) - Bismarck Municipal Airport(BIS)","Bissau - Osvaldo Vieiro International Airport(BXO)","Blackpool(BLK)","Blackwater(BLT)","Blantyre (Mandala) - Chileka International Airport(BLZ)","Blenheim(BHE)","Bloemfontein - Bloemfontein Airport(BFN)","Bloomington (IL)(BMI)","Bloomington (IN)(BMG)","Bluefield (WV)(BLF)","Boa Vista(BVB)","Bobo/Dioulasso(BOY)","Bodo(BOO)","Bodrum - Milas Airport(BJV)","Bogota - El Nuevo Dorado International Airport(BOG)","Boise (ID) - Boise Air Terminal(BLI)","Bologna(BLQ)","Bombay (Mumbai) - Chhatrapati Shivaji International(BOM)","Bonaire(BON)","Bonaventure, PQ(YVB)","Bora Bora(BOB)","Bordeaux - Bordeaux Airport(BOD)","Borrego Springs (CA)(BXS)","Boston (MA) - General Edward Lawrence Logan(BOS)","Bouake(BYK)","Bourgas/Burgas(BOJ)","Bournemouth(BOH)","Bowen(ZBO)","Bozeman (MT)(BZN)","Bradford/Warren (PA) /Olean (NY)(BFD)","Brainerd (MN)(BRD)","Brampton Island(BMP)","Brasilia - President Juscelino Kubitschek International(BSB)","Bratislava - M. R. \u0160tef\xe1nik Airport(BTS)","Brazzaville - Maya-Maya Airport(BZV)","Bremen - Bremen Airport(BRE)","Brescia, Montichiari(VBS)","Brest(BES)","Bria(BIV)","Bridgeport (CT)(BDR)","Bridgetown - Grantley Adams International(BGI)","Brindisi(BDS)","Brisbane(BNE)","Bristol(BRS)","Broennoeysund(BNN)","Broken Hill(BHQ)","Brookings (SD)(BKX)","Broome(BME)","Brunswick (GA)(BQK)","Brussels - Brussels Airport(BRU)","Bucaramanga(BGA)","Bucharest(BUH)","Bucharest - Henri Coand\u0103 International Airport(OTP)","Budapest - Budapest Ferihegy International Airport(BUD)","Buenos Aires(BUE)","Buenos Aires, Ezeiza International Airport(EZE)","Buenos Aires, Jorge Newbery(AEP)","Buffalo Range(BFO)","Buffalo/Niagara Falls (NY)(BUF)","Bujumbura - Bujumbura International Airport(BJM)","Bulawayo(BUQ)","Bullhead City (NV)(BHC)","Bundaberg(BDB)","Burbank (CA)(BUR)","Burlington (VT)(BTV)","Burlington IA(BRL)","Burnie (Wynyard)(BWT)","Butte (MT)(BTM)","Cabinda(CAB)","Cagliari(CAG)","Cairns(CNS)","Cairo - Cairo International Airport(CAI)","Calama - El Loa(CJC)","Calcutta (Kolkata) - Netaji Subhas Chandra(CCU)","Calgary - Calgary International Airport(YYC)","Cali(CLO)","Calicut(CCJ)","Calvi(CLY)","Cambridge Bay(YCB)","Cambridge(CBG)","Campbeltown(CAL)","Campo Grande(CGR)","Canberra - Canberra Airport(CBR)","Cancun(CUN)","Cannes - Mandelieu Airport(CEQ)","Canouan (island) - Canouan Airport(CIW)","Cape Town - Cape Town International Airport(CPT)","Caracas - Sim\xf3n Bol\xedvar International Airport(CCS)","Cardiff - Cardiff Airport(CWL)","Carlsbad (CA)(CLD)","Carnarvon(CVQ)","Carnot(CRF)","Carson City (NV)(CSN)","Cartagena - Rafael N\xfa\xf1ez International Airport(CTG)","Casa de Campo - La Romana International Airport(LRM)","Casablanca(CMN)","Casino(CSI)","Casper (WY)(CPR)","Castaway(CST)","Castries - George F. L. Charles Airport(SLU)","Catania(CTA)","Cayenne - Cayenne-Rochambeau Airport(CAY)","Cebu City - Mactan-Cebu International(CEB)","Cedar City (UT)(CDC)","Cedar Rapids IA(CID)","Ceduna(CED)","Cessnock(CES)","Chabarovsk (Khabarovsk)(KHV)","Chambery(CMF)","Champaign (IL)(CMI)","Chandigarh - Chandigarh International Airport(IXC)","Changchun(CGQ)","Chania(CHQ)","Chaoyang, Beijing - Chaoyang Airport(CHG)","Charleston (SC)(CHS)","Charleston (WV) - Yeager Airport(CRW)","Charlotte (NC)(CLT)","Charlottesville (VA)(CHO)","Charters Towers(CXT)","Chattanooga (TN)(CHA)","Chengdu - Shuangliu(CTU)","Chennai (Madras)(MAA)","Cheyenne (WY) - Cheyenne Regional Airport(CYS)","Chiang Mai - Chiang Mai International Airport(CNX)","Chiba City(QCB)","Chicago (IL)(CHI)","Chicago (IL), Midway(MDW)","Chicago (IL), O'Hare International Airport(ORD)","Chichen Itza(CZA)","Chico (CA)(CIC)","Chihuahua - Gen Fierro Villalobos(CUU)","Chios(JKH)","Chipata(CIP)","Chisinau - Chi\u0219in\u0103u International Airport(KIV)","Chita (Tschita)(HTA)","Chitral(CJL)","Chittagong(CGP)","Chongqing - Jiangbei International Airport(CKG)","Christchurch(CHC)","Chub Cay(CCZ)","Churchill(YYQ)","Cienfuegos - Jaime Gonz\xe1lez Airport(CFG)","Cincinnati (OH) - Cincinnati/Northern Kentucky Int'l(CVG)","Ciudad Del Carmen(CME)","Ciudad Guayana(CGU)","Ciudad Juarez(CUS)","Ciudad Obregon(CEN)","Ciudad Victoria(CVM)","Clarksburg (WV)(CKB)","Clermont(CMQ)","Clermont Ferrand(CFE)","Cleveland (OH) - Cleveland Hopkins International(CLE)","Cleveland (OH), Burke Lakefront(BKL)","Cochabamba(CBB)","Cochin(COK)","Cody/Powell/Yellowstone (WY)(COD)","Coffmann Cove (AK)(KCC)","Coffs Harbour(CFS)","Coimbatore(CJB)","Colima(CLQ)","College Station/Bryan (TX)(CLL)","Collinsville(KCE)","Cologne - Cologne Airport (Flughafen K\xf6ln/Bonn)(CGN)","Colombo - Bandaranaike International Airport(CMB)","Colorado Springs (CO)(COS)","Columbia (SC) - Columbia Metropolitan Airport(CAE)","Columbus (GA)(CSG)","Columbus (OH) - Port Columbus International(CMH)","Conakry - Conakry International Airport(CKY)","Concord (CA) - Buchanan Field(CCR)","Concord (NH) - Concord Municipal Airport(CON)","Constan\u021ba (Constan\u021ba) - Constan\u021ba Int'l Airport(CND)","Constantine(CZL)","Coober Pedy(CPD)","Cooktown(CTN)","Cooma(OOM)","Copenhagen - Copenhagen Airport(CPH)","Cordoba(COR)","Cordova (AK)(CDV)","Corfu(CFU)","Cork(ORK)","Corpus Christi (TX)(CRP)","Cotonou - Cotonou Cadjehoun Airport(COO)","Cottbus - Cottbus-Drewitz Airport(CBU)","Coventry - Baginton(CVT)","Cozumel(CZM)","Craig (AK)(CGA)","Crescent City (CA)(CEC)","Cuiab\xe1 - Marechal Rondon International Airport(CGB)","Culiacan(CUL)","Curacao - Cura\xe7ao International Airport(CUR)","Curitiba - Afonso Pena International Airport(CWB)","Cuyo(CYU)","Dakar - L\xe9opold S\xe9dar Senghor International Airport(DKR)","Dalaman(DLM)","Dalby(DBY)","Dalian - Zhoushuizi International Airport(DLC)","Dallas (TX), Love Field(DAL)","Dallas/Ft. Worth (TX) - Dallas/Fort Worth International(DFW)","Daloa(DJO)"],Ov=["Shanghai Port","Singapore Port","Colombo Port","Chennai Port","Mumbai (JNPT) Port","Hambantota Port","Port Klang","Dubai (Jebel Ali)","Hong Kong Port","Chittagong Port","Karachi Port","Bangkok (Laem Chabang)","Jakarta (Tanjung Priok)","Ho Chi Minh (Cat Lai)"],Fv={sea:["Maersk Line","MSC (Mediterranean Shipping Company)","CMA CGM","COSCO Shipping","Hapag-Lloyd","ONE (Ocean Network Express)","Evergreen Line","Yang Ming Line","HMM (Hyundai Merchant Marine)","PIL (Pacific International Lines)","OOCL","ZIM","Wan Hai Lines"],air:["Emirates SkyCargo","Qatar Airways Cargo","Singapore Airlines Cargo","Cathay Pacific Cargo","Lufthansa Cargo","Korean Air Cargo","ANA Cargo","Turkish Cargo","Etihad Cargo","Air France-KLM Cargo","China Airlines Cargo","FedEx","DHL Aviation","UPS Airlines"],all:["Maersk Line","MSC","CMA CGM","Emirates SkyCargo","Qatar Airways Cargo","Singapore Airlines Cargo"]},Dv=["EXW (Ex Works)","FCA (Free Carrier)","CPT (Carriage Paid To)","CIP (Carriage and Insurance Paid To)","DAP (Delivered at Place)","DPU (Delivered at Place Unloaded)","DDP (Delivered Duty Paid)","FAS (Free Alongside Ship)","FOB (Free on Board)","CFR (Cost and Freight)","CIF (Cost, Insurance and Freight)"],Iv=["USD","EUR","LKR","GBP","AED","SGD","CNY","JPY","INR","AUD","CAD","HKD","MYR","THB"],Rv=["General Cargo","Dangerous Goods (DG)","Perishable Goods","Fragile Items","Hazardous Materials","Temperature Controlled","Live Animals","Oversized Cargo","Valuable Cargo","Pharmaceutical Products","Electronics","Garments & Textiles","Machinery & Equipment","Food & Beverages"],Mv={air:['Pallet (96" x 125")',"ULD Container - LD3","ULD Container - LD7","ULD Container - LD9","Wooden Crate","Cardboard Box","Skid","Bulk Cargo"],sea:["20 FT Standard Container","40 FT Standard Container","40 FT High Cube Container","45 FT High Cube Container","20 FT Refrigerated Container","40 FT Refrigerated Container","20 FT Open Top Container","40 FT Open Top Container","20 FT Flat Rack","40 FT Flat Rack","Bulk Cargo","Break Bulk"],trucking:["Dry Van","Flatbed","Refrigerated (Reefer)","Step Deck","Lowboy","Conestoga","Box Truck","Straight Truck","Dump Truck","Tanker","Container Chassis","Double Drop","Extendable Trailer"]},Bv=["WM","CBM","CONTAINER","KGS","SHIPMENT","TUE","PALLET","CASE","CTN","PKGS","SET","TON","ROLL","BL","DOC","TRUCK","20GP","40HC","20RF","40RF"],Uv=["-45 Kg","+45 Kg","+100 kg","+300 kg","+500 kg","+1000 kg","+1500 kg","+2000 kg","+3000 kg","+5000 kg"],zv=["20 GP","40 GP","40 HC","20 RF","40 RF","20 FR","40 FR","20 OT","40 OT","40OTHC","20 ISO","Per/CBM"],qv={air:["-45 Kg","+45 Kg","+100 Kg","+300 Kg","+500 Kg","+1000 Kg","+1500 Kg","+2000 Kg","+3000 Kg","+5000 Kg"],sea:["20 GP","40 GP","40 HC","20 RF","40 RF","20 FR","40 FR","20 OT","40 OT","40OTHC","20 ISO","Per/CBM"],trucking:["Per Truck","Per Kg","Per Ton","Per Mile","Per Km","Flat Rate","Per Pallet","Per CBM"]},Hv={freight:["Ocean Freight","Air Freight","Fuel Surcharge (BAF)","Currency Adjustment Factor (CAF)","Peak Season Surcharge","War Risk Surcharge","Emergency Surcharge"],destination:["Terminal Handling Charge (THC)","Documentation Fee","Customs Clearance","Port Charges","Delivery Order (DO) Fee","Container Detention","Demurrage","Inspection Fee","Fumigation","Storage Charges"],origin:["Warehouse Handling","Loading Charges","Stuffing Charges","VGM (Verified Gross Mass)","Seal Charges","Lashing & Securing","Export Customs","Bill of Lading Fee"],handling:["EXW Charges","BL Fee","CFS charges","Loading/ Unloading","Custom clearance charges","Handling Charges","PSS charges","ACI Fee","AMS Fee","ECI fee","Pickup Charges","CMB/KWI/CAI","NB FROM KWI/CAI","Local Forwarding charges","SLPA charges","Doc Fee","Export license fee","Trico Gatepass","VGM fee","Manifest amendment fee","EDI charges","Peek charges","Origin Charges","Others","Waiting Charges","Palletizing Charges","Labour Charges","Equipment charges"]},Wv=["Payment terms: 30 days from invoice date","Payment terms: 15 days from invoice date","Payment terms: Cash on delivery (COD)","Payment terms: 50% advance, 50% on delivery","Prices are subject to change without prior notice","All rates are valid for 30 days from quote date","All rates are valid for 15 days from quote date","All customs duties and taxes are excluded","All customs duties and taxes are included","Insurance is not included unless specified","Insurance coverage available at 0.5% of cargo value","Free storage for first 3 days, charges apply thereafter","Free demurrage for 5 days at destination","Cargo must be ready for pickup within 24 hours of booking","Subject to space and equipment availability","Rates based on commodity declaration provided","Additional charges may apply for oversized/overweight cargo","Customer responsible for proper packaging and marking","Delivery time estimates are approximate and not guaranteed","Claims must be reported within 24 hours of delivery","Force majeure clause applicable","Rates exclude weekend/holiday delivery charges"],Vv=["DHL Freight","DB Schenker","Kuehne + Nagel","XPO Logistics","FedEx Freight","UPS Freight","YRC Freight","Estes Express","Old Dominion","Saia Motor Freight","ABF Freight","TForce Freight","Ryder","J.B. Hunt","Schneider National"],Gv=e=>"air"===e?Fv.air||[]:"sea"===e?Fv.sea||[]:"trucking"===e?Vv||[]:[...Fv.sea||[],...Fv.air||[],...Fv.all||[],...Vv],Kv=e=>"air"===e?Mv.air:"sea"===e?Mv.sea:"trucking"===e?Mv.trucking:[...Mv.air,...Mv.sea,...Mv.trucking],Yv=e=>"air"===e?Uv:"sea"===e?zv:[...Uv,...zv];function Xv(e){let{formData:t,setFormData:r,disabled:a=!1}=e;const[n,i]=(0,s.useState)([]),l=(e,t)=>{r(r=>We(We({},r),{},{[e]:t}))};return(0,s.useEffect)(()=>{(async()=>{const e=await Rs();console.log("Fetched Account Names:",e),i(e)})()},[]),(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Basic Information"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quote Number"}),(0,ga.jsx)("input",{type:"text",value:t.quoteNumber||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",placeholder:"Auto-generated"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Created Date"}),(0,ga.jsx)("input",{type:"date",value:t.createdDate||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rate Validity"}),(0,ga.jsx)("input",{type:"date",value:t.rateValidity||"",onChange:e=>l("rateValidity",e.target.value),disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsx)(Ev,{label:"Customer",value:t.customer||"",onChange:e=>l("customer",e),suggestions:n,disabled:a}),(0,ga.jsx)(Ev,{label:"Pickup Location",value:t.pickupLocation||"",onChange:e=>l("pickupLocation",e),suggestions:Lv.pickup,disabled:a}),(0,ga.jsx)(Ev,{label:"Delivery Location",value:t.deliveryLocation||"",onChange:e=>l("deliveryLocation",e),suggestions:Lv.delivery,disabled:a})]})]})}function $v(e){let{formData:t,setFormData:r,disabled:a=!1}=e;return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Port of Loading (POL) and Port of Discharge (POD)"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsx)(Ev,{label:"Port of Loading (POL)",value:t.portOfLoading,onChange:e=>r(t=>We(We({},t),{},{portOfLoading:e})),suggestions:[],disabled:a}),(0,ga.jsx)(Ev,{label:"Port of Discharge (POD)",value:t.portOfDischarge,onChange:e=>r(t=>We(We({},t),{},{portOfDischarge:e})),suggestions:[],disabled:a})]})]})}function Jv(e){let{formData:t,setFormData:r,category:a,disabled:n=!1}=e;const s=(e,t)=>{n||r(r=>We(We({},r),{},{equipment:We(We({},r.equipment),{},{[e]:t})}))},i=Kv(a);return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Equipment Details"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsx)(Ev,{label:"Equipment",value:t.equipment.equipment,onChange:e=>s("equipment",e),suggestions:i,disabled:n}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Units"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.units,onChange:e=>s("units",e.target.value),disabled:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gross Weight"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.grossWeight,onChange:e=>s("grossWeight",e.target.value),disabled:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Volume (m\xb3)"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:t.equipment.volume,onChange:e=>s("volume",e.target.value),disabled:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chargeable Weight"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.chargeableWeight,onChange:e=>s("chargeableWeight",e.target.value),disabled:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]})]})]})}function Qv(e){let{formData:t,setFormData:r,disabled:a=!1,carrierName:n=null}=e;const i=["-45 Kg","+45 Kg","+100 kg","+300 kg","+500 kg","+1000 kg"],l=e=>{const t={};e.forEach(e=>{const r=e.carrier||"";t[r]||(t[r]={carrier:r,currency:e.currency||"",minimum:e.minimum||"",transitTime:e.transitTime||"",numberOfRouting:e.numberOfRouting||"",surcharge:e.surcharge||"",frequency:e.frequency||"",remarks:e.remarks||"",unitTypes:{}}),e.unitType&&(t[r].unitTypes[e.unitType]=e.amount||"")});const r=Object.values(t);return r.length>0?r:[{carrier:n||"",currency:"",minimum:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",remarks:"",unitTypes:{}}]},o=e=>{const t=[];return e.forEach(e=>{i.forEach(r=>{const a=e.unitTypes[r]||"";t.push({carrier:e.carrier,unitType:r,numberOfUnits:"",amount:a,currency:e.currency,minimum:e.minimum,transitTime:e.transitTime,numberOfRouting:e.numberOfRouting,surcharge:e.surcharge,frequency:e.frequency,total:0,remarks:e.remarks||""})})}),t},[c,d]=(0,s.useState)(()=>l(t.freightCharges));(0,s.useEffect)(()=>{const e=o(c);r(t=>We(We({},t),{},{freightCharges:e}))},[c]),(0,s.useEffect)(()=>{JSON.stringify(o(c))!==JSON.stringify(t.freightCharges)&&t.freightCharges.length>0&&d(l(t.freightCharges))},[t.freightCharges]);const u=(e,t,r)=>{a||d(a=>{const n=[...a];return n[e]=We(We({},n[e]),{},{[t]:r}),n})},h=Gv("air");return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Freight Charges"}),!a&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(a)return;const e={carrier:n||"",currency:"",minimum:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",remarks:"",unitTypes:{}};d(t=>[...t,e])},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Carrier"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"70px"},children:"AirLine"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"65px"},children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"60px"},children:"M"}),i.map(e=>(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"60px"},children:e},e)),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"90px"},children:"Surcharge"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"50px"},children:"T/T"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"85px"},children:"Frequency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"100px"},children:"Routing"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"90px"},children:"Remarks"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-center",style:{width:"60px"},children:"Action"})]})}),(0,ga.jsx)("tbody",{children:c.map((e,t)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)(Ev,{value:e.carrier,onChange:e=>u(t,"carrier",e),suggestions:h,showLabel:!1,disabled:a||null!==n})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>u(t,"currency",e),suggestions:Iv,showLabel:!1,disabled:a})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.minimum||"",onChange:e=>u(t,"minimum",e.target.value),disabled:a,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),i.map(r=>(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.unitTypes[r]||"",onChange:e=>((e,t,r)=>{a||d(a=>{const n=[...a];return n[e]=We(We({},n[e]),{},{unitTypes:We(We({},n[e].unitTypes),{},{[t]:r})}),n})})(t,r,e.target.value),disabled:a,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})},r)),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.surcharge||"",onChange:e=>u(t,"surcharge",e.target.value),disabled:a,placeholder:"e.g., ALL IN",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.transitTime||"",onChange:e=>u(t,"transitTime",e.target.value),disabled:a,placeholder:"e.g., 2",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.frequency||"",onChange:e=>u(t,"frequency",e.target.value),disabled:a,placeholder:"e.g., DAILY",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.numberOfRouting||"",onChange:e=>u(t,"numberOfRouting",e.target.value),disabled:a,placeholder:"e.g., CMB/KUL/KTI",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.remarks||"",onChange:e=>u(t,"remarks",e.target.value),disabled:a,placeholder:"Add remarks...",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1 text-center",children:c.length>1&&!a&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{a||d(t=>t.filter((t,r)=>r!==e))})(t),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},t))})]})})]})}function Zv(e){let{formData:t,setFormData:r,category:a,disabled:n=!1,carrierName:s=null}=e;if("air"===a)return(0,ga.jsx)(Qv,{formData:t,setFormData:r,disabled:n,carrierName:s});const i=(e,a,s)=>{if(n)return;const i=[...t.freightCharges];if(i[e][a]=s,"numberOfUnits"===a||"amount"===a){const t=parseFloat(i[e].numberOfUnits)||0,r=parseFloat(i[e].amount)||0;i[e].total=t*r}r(e=>We(We({},e),{},{freightCharges:i}))},l=Gv(a),o="air"===a,c=Yv(a);return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Freight Charges"}),!n&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(n)return;const e={carrier:s||"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",total:0,remarks:""};"air"===a&&(e.minimum="",e.surcharge="",e.frequency=""),r(t=>We(We({},t),{},{freightCharges:[...t.freightCharges,e]}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Charge"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"air"==a?"AirLine":"Carrier"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),o&&(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"M"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Transit Time"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Routing"}),o&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Surcharge"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Frequency"})]}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Remarks"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:t.freightCharges.map((e,a)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.carrier,onChange:e=>i(a,"carrier",e),suggestions:l,showLabel:!1,disabled:n||null!==s})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.unitType,onChange:e=>i(a,"unitType",e),suggestions:c,showLabel:!1,disabled:n})}),o&&(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.minimum||"",onChange:e=>i(a,"minimum",e.target.value),disabled:n,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>i(a,"numberOfUnits",e.target.value),disabled:n,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>i(a,"amount",e.target.value),disabled:n,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>i(a,"currency",e),suggestions:Iv,showLabel:!1,disabled:n})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.transitTime||"",onChange:e=>i(a,"transitTime",e.target.value),disabled:n,placeholder:"e.g., 7-10 days",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.numberOfRouting||"",onChange:e=>i(a,"numberOfRouting",e.target.value),disabled:n,placeholder:"e.g., Direct",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),o&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.surcharge||"",onChange:e=>i(a,"surcharge",e.target.value),disabled:n,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.frequency||"",onChange:e=>i(a,"frequency",e.target.value),disabled:n,placeholder:"e.g., Daily",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})})]}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.remarks||"",onChange:e=>i(a,"remarks",e.target.value),disabled:n,placeholder:"Add remarks...",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.freightCharges.length>1&&!n&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{n||r(t=>We(We({},t),{},{freightCharges:t.freightCharges.filter((t,r)=>r!==e)}))})(a),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},a))}),(0,ga.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:o?"11":"8",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:t.freightCharges.reduce((e,t)=>e+(parseFloat(t.total)||0),0).toFixed(2)}),(0,ga.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function ey(e){let{formData:t,setFormData:r,disabled:a=!1}=e;const n=(e,n,s)=>{if(a)return;const i=[...t.destinationCharges];if(i[e][n]=s,"numberOfUnits"===n||"amount"===n){const t=parseFloat(i[e].numberOfUnits)||0,r=parseFloat(i[e].amount)||0;i[e].total=t*r}r(e=>We(We({},e),{},{destinationCharges:i}))};return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Destination Charges (POD)"}),!a&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{a||r(e=>We(We({},e),{},{destinationCharges:[...e.destinationCharges,{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0,remark:""}]}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Charge"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Remark"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:t.destinationCharges.map((e,s)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.chargeName,onChange:e=>n(s,"chargeName",e),suggestions:Hv.destination,showLabel:!1,disabled:a})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.unitType,onChange:e=>n(s,"unitType",e),suggestions:Bv,showLabel:!1,disabled:a})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>n(s,"numberOfUnits",e.target.value),disabled:a,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>n(s,"amount",e.target.value),disabled:a,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>n(s,"currency",e),suggestions:Iv,showLabel:!1,disabled:a})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.remark||"",onChange:e=>n(s,"remark",e.target.value),disabled:a,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100",placeholder:"Add remark..."})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.destinationCharges.length>1&&!a&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{a||r(t=>We(We({},t),{},{destinationCharges:t.destinationCharges.filter((t,r)=>r!==e)}))})(s),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},s))}),(0,ga.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:"6",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:t.destinationCharges.reduce((e,t)=>e+(parseFloat(t.total)||0),0).toFixed(2)}),(0,ga.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function ty(e){let{formData:t,setFormData:r,type:a,title:n,disabled:s=!1}=e;const i="origin"===a?"originHandling":"destinationHandling",l=t[i]||[],o=(e,t,a)=>{if(s)return;const n=[...l];if(n[e][t]=a,"numberOfUnits"===t||"amount"===t){const t=parseFloat(n[e].numberOfUnits)||0,r=parseFloat(n[e].amount)||0;n[e].total=t*r}r(e=>We(We({},e),{},{[i]:n}))},c="origin"===a?Hv.origin:Hv.destination;return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:n}),!s&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{s||r(e=>We(We({},e),{},{[i]:[...e[i],{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0,remark:""}]}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Charge"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Remark"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:l.map((e,t)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.chargeName,onChange:e=>o(t,"chargeName",e),suggestions:c,showLabel:!1,disabled:s})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.unitType,onChange:e=>o(t,"unitType",e),suggestions:Bv,showLabel:!1,disabled:s})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>o(t,"numberOfUnits",e.target.value),disabled:s,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>o(t,"amount",e.target.value),disabled:s,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>o(t,"currency",e),suggestions:Iv,showLabel:!1,disabled:s})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.remark||"",onChange:e=>o(t,"remark",e.target.value),disabled:s,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100",placeholder:"Add remark..."})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:l.length>1&&!s&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{s||r(t=>We(We({},t),{},{[i]:t[i].filter((t,r)=>r!==e)}))})(t),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},t))}),(0,ga.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:"6",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:l.reduce((e,t)=>e+(parseFloat(t.total)||0),0).toFixed(2)}),(0,ga.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function ry(e){let{option:t,index:r,category:a,formData:n,setFormData:i,onRemove:l,disabled:o=!1,totalOptions:c}=e;const[d,u]=(0,s.useState)(!0),h=Gv(a),f="air"===a?"Airline Option":"Sea Option",m=(e,t)=>{if(o)return;const a=[...n.carrierOptions];a[r]=We(We({},a[r]),{},{[e]:t}),i(e=>We(We({},e),{},{carrierOptions:a}))},p=e=>({[e]:t[e]||[]}),g=e=>r=>{if("function"===typeof r){const a=r({[e]:t[e]||[]});m(e,a[e])}else m(e,r[e])};return(0,ga.jsxs)("div",{className:"border-2 border-blue-300 rounded-lg mb-6 overflow-hidden",children:[(0,ga.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 text-white p-4",children:(0,ga.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("button",{type:"button",onClick:()=>u(!d),className:"hover:bg-blue-700 p-1 rounded transition-colors",children:d?(0,ga.jsx)(js,{size:20}):(0,ga.jsx)(un,{size:20})}),(0,ga.jsxs)("h3",{className:"text-lg font-semibold",children:[f," [",r+1,"]"]})]}),c>1&&!o&&(0,ga.jsxs)("button",{type:"button",onClick:l,className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 hover:bg-red-700 rounded transition-colors",children:[(0,ga.jsx)(On,{size:16}),"Remove Option"]})]})}),d&&(0,ga.jsxs)("div",{className:"p-6 bg-blue-50/30",children:[(0,ga.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-6 shadow-sm",children:[(0,ga.jsxs)("h4",{className:"text-md font-semibold text-gray-700 mb-4",children:["air"===a?"Airline":"Carrier"," Details"]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ga.jsx)(Ev,{label:"air"===a?"Airline":"Carrier",value:t.carrier||"",onChange:e=>m("carrier",e),suggestions:h,disabled:o}),(0,ga.jsx)(Ev,{label:"Incoterm",value:t.incoterm||"",onChange:e=>m("incoterm",e),suggestions:Dv,disabled:o}),(0,ga.jsx)(Ev,{label:"Currency",value:t.currency||"",onChange:e=>m("currency",e),suggestions:Iv,disabled:o}),(0,ga.jsx)(Ev,{label:"Cargo Type",value:t.cargoType||"",onChange:e=>m("cargoType",e),suggestions:Rv,disabled:o})]})]}),(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 mb-4 shadow-sm",children:(0,ga.jsx)(Zv,{formData:p("freightCharges"),setFormData:g("freightCharges"),category:a,disabled:o,carrierName:t.carrier})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 mb-4 shadow-sm",children:(0,ga.jsx)(ey,{formData:p("destinationCharges"),setFormData:g("destinationCharges"),disabled:o})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 mb-4 shadow-sm",children:(0,ga.jsx)(ty,{formData:p("originHandling"),setFormData:g("originHandling"),type:"origin",title:"Origin Handling Charges",disabled:o})}),(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:(0,ga.jsx)(ty,{formData:p("destinationHandling"),setFormData:g("destinationHandling"),type:"destination",title:"Destination Handling Charges",disabled:o})})]})]})}function ay(e){let{formData:t,setFormData:r,disabled:a=!1}=e;const[n,i]=(0,s.useState)(""),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(""),u=e=>{!a&&e.trim()&&(r(t=>We(We({},t),{},{termsConditions:[...t.termsConditions,e.trim()]})),i(""))},h=()=>{if(c.trim()){const e=[...t.termsConditions];e[l]=c.trim(),r(t=>We(We({},t),{},{termsConditions:e}))}o(null),d("")},f=()=>{o(null),d("")};return(0,ga.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Terms & Conditions"}),!a&&(0,ga.jsxs)("div",{className:"space-y-2",children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Select from defaults or add custom:"}),(0,ga.jsx)("div",{className:"flex gap-2",children:(0,ga.jsxs)("select",{onChange:e=>{e.target.value&&(u(e.target.value),e.target.value="")},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg",children:[(0,ga.jsx)("option",{value:"",children:"-- Select a term --"}),Wv.map((e,t)=>(0,ga.jsx)("option",{value:e,children:e},t))]})}),(0,ga.jsxs)("div",{className:"flex gap-2",children:[(0,ga.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&u(n),placeholder:"Or type a custom term...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg"}),(0,ga.jsxs)("button",{type:"button",onClick:()=>u(n),className:"flex items-center gap-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,ga.jsx)(dn,{size:18}),"Add"]})]})]}),t.termsConditions.length>0&&(0,ga.jsx)("div",{className:"border border-gray-300 rounded-lg p-4 space-y-2",children:t.termsConditions.map((e,n)=>(0,ga.jsx)("div",{className:"flex items-start gap-2 p-2 bg-gray-50 rounded",children:l===n?(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded",autoFocus:!0}),(0,ga.jsx)("button",{type:"button",onClick:h,className:"text-green-600 hover:text-green-700",children:(0,ga.jsx)(Ns,{size:18})}),(0,ga.jsx)("button",{type:"button",onClick:f,className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(Ea,{size:18})})]}):(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("span",{className:"flex-1 text-sm text-gray-700",children:[n+1,". ",e]}),!a&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{a||(o(e),d(t.termsConditions[e]))})(n),className:"text-blue-600 hover:text-blue-700",children:(0,ga.jsx)(Pn,{size:16})}),(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{a||r(t=>We(We({},t),{},{termsConditions:t.termsConditions.filter((t,r)=>r!==e)}))})(n),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})]})]})},n))})]})}const ny=()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"Q-".concat(t,"-").concat(r,"-").concat(a,"-").concat(n).concat(s).concat(i)};var sy=r(2284),iy=Uint8Array,ly=Uint16Array,oy=Int32Array,cy=new iy([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dy=new iy([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uy=new iy([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hy=function(e,t){for(var r=new ly(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];var n=new oy(r[30]);for(a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},fy=hy(cy,2),my=fy.b,py=fy.r;my[28]=258,py[258]=28;for(var gy=hy(dy,0),xy=(gy.b,gy.r),by=new ly(32768),vy=0;vy<32768;++vy){var yy=(43690&vy)>>1|(21845&vy)<<1;yy=(61680&(yy=(52428&yy)>>2|(13107&yy)<<2))>>4|(3855&yy)<<4,by[vy]=((65280&yy)>>8|(255&yy)<<8)>>1}var wy=function(e,t,r){for(var a=e.length,n=0,s=new ly(t);n<a;++n)e[n]&&++s[e[n]-1];var i,l=new ly(t);for(n=1;n<t;++n)l[n]=l[n-1]+s[n-1]<<1;if(r){i=new ly(1<<t);var o=15-t;for(n=0;n<a;++n)if(e[n])for(var c=n<<4|e[n],d=t-e[n],u=l[e[n]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)i[by[u]>>o]=c}else for(i=new ly(a),n=0;n<a;++n)e[n]&&(i[n]=by[l[e[n]-1]++]>>15-e[n]);return i},Ny=new iy(288);for(vy=0;vy<144;++vy)Ny[vy]=8;for(vy=144;vy<256;++vy)Ny[vy]=9;for(vy=256;vy<280;++vy)Ny[vy]=7;for(vy=280;vy<288;++vy)Ny[vy]=8;var jy=new iy(32);for(vy=0;vy<32;++vy)jy[vy]=5;var ky=wy(Ny,9,0),Sy=wy(jy,5,0),Ay=function(e){return(e+7)/8|0},Cy=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new iy(e.subarray(t,r))},_y=function(e,t,r){r<<=7&t;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Ty=function(e,t,r){r<<=7&t;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Ey=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return{t:Ry,l:0};if(1==n){var i=new iy(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var l=r[0],o=r[1],c=0,d=1,u=2;for(r[0]={s:-1,f:l.f+o.f,l:l,r:o};d!=n-1;)l=r[r[c].f<r[u].f?c++:u++],o=r[c!=d&&r[c].f<r[u].f?c++:u++],r[d++]={s:-1,f:l.f+o.f,l:l,r:o};var h=s[0].s;for(a=1;a<n;++a)s[a].s>h&&(h=s[a].s);var f=new ly(h+1),m=Ly(r[d-1],f,0);if(m>t){a=0;var p=0,g=m-t,x=1<<g;for(s.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});a<n;++a){var b=s[a].s;if(!(f[b]>t))break;p+=x-(1<<m-f[b]),f[b]=t}for(p>>=g;p>0;){var v=s[a].s;f[v]<t?p-=1<<t-f[v]++-1:++a}for(;a>=0&&p;--a){var y=s[a].s;f[y]==t&&(--f[y],++p)}m=t}return{t:new iy(f),l:m}},Ly=function(e,t,r){return-1==e.s?Math.max(Ly(e.l,t,r+1),Ly(e.r,t,r+1)):t[e.s]=r},Py=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ly(++t),a=0,n=e[0],s=1,i=function(e){r[a++]=e},l=1;l<=t;++l)if(e[l]==n&&l!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(n),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(n);s=1,n=e[l]}return{c:r.subarray(0,a),n:t}},Oy=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},Fy=function(e,t,r){var a=r.length,n=Ay(t+2);e[n]=255&a,e[n+1]=a>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var s=0;s<a;++s)e[n+s+4]=r[s];return 8*(n+4+a)},Dy=function(e,t,r,a,n,s,i,l,o,c,d){_y(t,d++,r),++n[256];for(var u=Ey(n,15),h=u.t,f=u.l,m=Ey(s,15),p=m.t,g=m.l,x=Py(h),b=x.c,v=x.n,y=Py(p),w=y.c,N=y.n,j=new ly(19),k=0;k<b.length;++k)++j[31&b[k]];for(k=0;k<w.length;++k)++j[31&w[k]];for(var S=Ey(j,7),A=S.t,C=S.l,_=19;_>4&&!A[uy[_-1]];--_);var T,E,L,P,O=c+5<<3,F=Oy(n,Ny)+Oy(s,jy)+i,D=Oy(n,h)+Oy(s,p)+i+14+3*_+Oy(j,A)+2*j[16]+3*j[17]+7*j[18];if(o>=0&&O<=F&&O<=D)return Fy(t,d,e.subarray(o,o+c));if(_y(t,d,1+(D<F)),d+=2,D<F){T=wy(h,f,0),E=h,L=wy(p,g,0),P=p;var I=wy(A,C,0);_y(t,d,v-257),_y(t,d+5,N-1),_y(t,d+10,_-4),d+=14;for(k=0;k<_;++k)_y(t,d+3*k,A[uy[k]]);d+=3*_;for(var R=[b,w],M=0;M<2;++M){var B=R[M];for(k=0;k<B.length;++k){var U=31&B[k];_y(t,d,I[U]),d+=A[U],U>15&&(_y(t,d,B[k]>>5&127),d+=B[k]>>12)}}}else T=ky,E=Ny,L=Sy,P=jy;for(k=0;k<l;++k){var z=a[k];if(z>255){Ty(t,d,T[(U=z>>18&31)+257]),d+=E[U+257],U>7&&(_y(t,d,z>>23&31),d+=cy[U]);var q=31&z;Ty(t,d,L[q]),d+=P[q],q>3&&(Ty(t,d,z>>5&8191),d+=dy[q])}else Ty(t,d,T[z]),d+=E[z]}return Ty(t,d,T[256]),d+E[256]},Iy=new oy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ry=new iy(0),My=function(e,t,r,a,n,s){var i=s.z||e.length,l=new iy(a+i+5*(1+Math.ceil(i/7e3))+n),o=l.subarray(a,l.length-n),c=s.l,d=7&(s.r||0);if(t){d&&(o[0]=s.r>>3);for(var u=Iy[t-1],h=u>>13,f=8191&u,m=(1<<r)-1,p=s.p||new ly(32768),g=s.h||new ly(m+1),x=Math.ceil(r/3),b=2*x,v=function(t){return(e[t]^e[t+1]<<x^e[t+2]<<b)&m},y=new oy(25e3),w=new ly(288),N=new ly(32),j=0,k=0,S=s.i||0,A=0,C=s.w||0,_=0;S+2<i;++S){var T=v(S),E=32767&S,L=g[T];if(p[E]=L,g[T]=E,C<=S){var P=i-S;if((j>7e3||A>24576)&&(P>423||!c)){d=Dy(e,o,0,y,w,N,k,A,_,S-_,d),A=j=k=0,_=S;for(var O=0;O<286;++O)w[O]=0;for(O=0;O<30;++O)N[O]=0}var F=2,D=0,I=f,R=E-L&32767;if(P>2&&T==v(S-R))for(var M=Math.min(h,P)-1,B=Math.min(32767,S),U=Math.min(258,P);R<=B&&--I&&E!=L;){if(e[S+F]==e[S+F-R]){for(var z=0;z<U&&e[S+z]==e[S+z-R];++z);if(z>F){if(F=z,D=R,z>M)break;var q=Math.min(R,z-2),H=0;for(O=0;O<q;++O){var W=S-R+O&32767,V=W-p[W]&32767;V>H&&(H=V,L=W)}}}R+=(E=L)-(L=p[E])&32767}if(D){y[A++]=268435456|py[F]<<18|xy[D];var G=31&py[F],K=31&xy[D];k+=cy[G]+dy[K],++w[257+G],++N[K],C=S+F,++j}else y[A++]=e[S],++w[e[S]]}}for(S=Math.max(S,C);S<i;++S)y[A++]=e[S],++w[e[S]];d=Dy(e,o,c,y,w,N,k,A,_,S-_,d),c||(s.r=7&d|o[d/8|0]<<3,d-=7,s.h=g,s.p=p,s.i=S,s.w=C)}else{for(S=s.w||0;S<i+c;S+=65535){var Y=S+65535;Y>=i&&(o[d/8|0]=c,Y=i),d=Fy(o,d+1,e.subarray(S,Y))}s.i=i}return Cy(l,0,a+Ay(d)+n)},By=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=0|r.length,i=0;i!=s;){for(var l=Math.min(i+2655,s);i<l;++i)n+=a+=r[i];a=(65535&a)+15*(a>>16),n=(65535&n)+15*(n>>16)}e=a,t=n},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},Uy=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),i=new iy(s.length+e.length);i.set(s),i.set(e,s.length),e=i,n.w=s.length}return My(e,null==t.level?6:t.level,null==t.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,a,n)},zy=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},qy=function(e,t){var r=t.level,a=0==r?0:r<6?1:9==r?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=By();n.p(t.dictionary),zy(e,2,n.d())}};function Hy(e,t){t||(t={});var r=By();r.p(e);var a=Uy(e,t,t.dictionary?6:2,4);return qy(a,t),zy(a,a.length-4,r.d()),a}var Wy="undefined"!=typeof TextDecoder&&new TextDecoder;try{Wy.decode(Ry,{stream:!0})}catch(mT){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;function Vy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function Gy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,s,i,l=[],o=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;o=!1}else for(;!(o=(a=s.call(r)).done)&&(l.push(a.value),l.length!==t);o=!0);}catch(e){c=!0,n=e}finally{try{if(!o&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Vy(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vy(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ky(e){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(e)}const Yy=new TextEncoder;const Xy=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),$y={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Jy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,qe.A)(this,"buffer",void 0),(0,qe.A)(this,"byteLength",void 0),(0,qe.A)(this,"byteOffset",void 0),(0,qe.A)(this,"length",void 0),(0,qe.A)(this,"offset",void 0),(0,qe.A)(this,"lastWrittenByte",void 0),(0,qe.A)(this,"littleEndian",void 0),(0,qe.A)(this,"_data",void 0),(0,qe.A)(this,"_mark",void 0),(0,qe.A)(this,"_marks",void 0);let r=!1;"number"===typeof e?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const a=t.offset?t.offset>>>0:0,n=e.byteLength-a;let s=a;(ArrayBuffer.isView(e)||e instanceof Jy)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+a),e=e.buffer),this.lastWrittenByte=r?n:0,this.buffer=e,this.length=n,this.byteLength=n,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,n),this._mark=0,this._marks=[]}available(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=e,this}back(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(e)){const t=2*(this.offset+e),r=new Uint8Array(t);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(e,"uint8")}readArray(e,t){const r=$y[t].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,n=this.buffer.slice(a,a+r);if(this.littleEndian===Xy&&"uint8"!==t&&"int8"!==t){const e=new Uint8Array(this.buffer.slice(a,a+r));e.reverse();const n=new $y[t](e.buffer);return this.offset+=r,n.reverse(),n}const s=new $y[t](n);return this.offset+=r,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Ky(this.readBytes(e))}decodeText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return Ky(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(function(e){return Yy.encode(e)}(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Qy(e){let t=e.length;for(;--t>=0;)e[t]=0}const Zy=256,ew=286,tw=30,rw=15,aw=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),nw=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),sw=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),iw=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lw=new Array(576);Qy(lw);const ow=new Array(60);Qy(ow);const cw=new Array(512);Qy(cw);const dw=new Array(256);Qy(dw);const uw=new Array(29);Qy(uw);const hw=new Array(tw);function fw(e,t,r,a,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=a,this.max_length=n,this.has_stree=e&&e.length}let mw,pw,gw;function xw(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Qy(hw);const bw=e=>e<256?cw[e]:cw[256+(e>>>7)],vw=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},yw=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,vw(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},ww=(e,t,r)=>{yw(e,r[2*t],r[2*t+1])},Nw=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},jw=(e,t,r)=>{const a=new Array(16);let n,s,i=0;for(n=1;n<=rw;n++)i=i+r[n-1]<<1,a[n]=i;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=Nw(a[t]++,t))}},kw=e=>{let t;for(t=0;t<ew;t++)e.dyn_ltree[2*t]=0;for(t=0;t<tw;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Sw=e=>{e.bi_valid>8?vw(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Aw=(e,t,r,a)=>{const n=2*t,s=2*r;return e[n]<e[s]||e[n]===e[s]&&a[t]<=a[r]},Cw=(e,t,r)=>{const a=e.heap[r];let n=r<<1;for(;n<=e.heap_len&&(n<e.heap_len&&Aw(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!Aw(t,a,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=a},_w=(e,t,r)=>{let a,n,s,i,l=0;if(0!==e.sym_next)do{a=255&e.pending_buf[e.sym_buf+l++],a+=(255&e.pending_buf[e.sym_buf+l++])<<8,n=e.pending_buf[e.sym_buf+l++],0===a?ww(e,n,t):(s=dw[n],ww(e,s+Zy+1,t),i=aw[s],0!==i&&(n-=uw[s],yw(e,n,i)),a--,s=bw(a),ww(e,s,r),i=nw[s],0!==i&&(a-=hw[s],yw(e,a,i)))}while(l<e.sym_next);ww(e,256,t)},Tw=(e,t)=>{const r=t.dyn_tree,a=t.stat_desc.static_tree,n=t.stat_desc.has_stree,s=t.stat_desc.elems;let i,l,o,c=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<s;i++)0!==r[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)o=e.heap[++e.heap_len]=c<2?++c:0,r[2*o]=1,e.depth[o]=0,e.opt_len--,n&&(e.static_len-=a[2*o+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)Cw(e,r,i);o=s;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Cw(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=l,r[2*o]=r[2*i]+r[2*l],e.depth[o]=(e.depth[i]>=e.depth[l]?e.depth[i]:e.depth[l])+1,r[2*i+1]=r[2*l+1]=o,e.heap[1]=o++,Cw(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,a=t.max_code,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,o=t.stat_desc.max_length;let c,d,u,h,f,m,p=0;for(h=0;h<=rw;h++)e.bl_count[h]=0;for(r[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)d=e.heap[c],h=r[2*r[2*d+1]+1]+1,h>o&&(h=o,p++),r[2*d+1]=h,d>a||(e.bl_count[h]++,f=0,d>=l&&(f=i[d-l]),m=r[2*d],e.opt_len+=m*(h+f),s&&(e.static_len+=m*(n[2*d+1]+f)));if(0!==p){do{for(h=o-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[o]--,p-=2}while(p>0);for(h=o;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--c],u>a||(r[2*u+1]!==h&&(e.opt_len+=(h-r[2*u+1])*r[2*u],r[2*u+1]=h),d--)}})(e,t),jw(r,c,e.bl_count)},Ew=(e,t,r)=>{let a,n,s=-1,i=t[1],l=0,o=7,c=4;for(0===i&&(o=138,c=3),t[2*(r+1)+1]=65535,a=0;a<=r;a++)n=i,i=t[2*(a+1)+1],++l<o&&n===i||(l<c?e.bl_tree[2*n]+=l:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[32]++):l<=10?e.bl_tree[34]++:e.bl_tree[36]++,l=0,s=n,0===i?(o=138,c=3):n===i?(o=6,c=3):(o=7,c=4))},Lw=(e,t,r)=>{let a,n,s=-1,i=t[1],l=0,o=7,c=4;for(0===i&&(o=138,c=3),a=0;a<=r;a++)if(n=i,i=t[2*(a+1)+1],!(++l<o&&n===i)){if(l<c)do{ww(e,n,e.bl_tree)}while(0!==--l);else 0!==n?(n!==s&&(ww(e,n,e.bl_tree),l--),ww(e,16,e.bl_tree),yw(e,l-3,2)):l<=10?(ww(e,17,e.bl_tree),yw(e,l-3,3)):(ww(e,18,e.bl_tree),yw(e,l-11,7));l=0,s=n,0===i?(o=138,c=3):n===i?(o=6,c=3):(o=7,c=4)}};let Pw=!1;const Ow=(e,t,r,a)=>{yw(e,0+(a?1:0),3),Sw(e),vw(e,r),vw(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var Fw=e=>{Pw||((()=>{let e,t,r,a,n;const s=new Array(16);for(r=0,a=0;a<28;a++)for(uw[a]=r,e=0;e<1<<aw[a];e++)dw[r++]=a;for(dw[r-1]=a,n=0,a=0;a<16;a++)for(hw[a]=n,e=0;e<1<<nw[a];e++)cw[n++]=a;for(n>>=7;a<tw;a++)for(hw[a]=n<<7,e=0;e<1<<nw[a]-7;e++)cw[256+n++]=a;for(t=0;t<=rw;t++)s[t]=0;for(e=0;e<=143;)lw[2*e+1]=8,e++,s[8]++;for(;e<=255;)lw[2*e+1]=9,e++,s[9]++;for(;e<=279;)lw[2*e+1]=7,e++,s[7]++;for(;e<=287;)lw[2*e+1]=8,e++,s[8]++;for(jw(lw,287,s),e=0;e<tw;e++)ow[2*e+1]=5,ow[2*e]=Nw(e,5);mw=new fw(lw,aw,257,ew,rw),pw=new fw(ow,nw,0,tw,rw),gw=new fw(new Array(0),sw,0,19,7)})(),Pw=!0),e.l_desc=new xw(e.dyn_ltree,mw),e.d_desc=new xw(e.dyn_dtree,pw),e.bl_desc=new xw(e.bl_tree,gw),e.bi_buf=0,e.bi_valid=0,kw(e)},Dw=(e,t,r,a)=>{let n,s,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<Zy;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Tw(e,e.l_desc),Tw(e,e.d_desc),i=(e=>{let t;for(Ew(e,e.dyn_ltree,e.l_desc.max_code),Ew(e,e.dyn_dtree,e.d_desc.max_code),Tw(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*iw[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==t?Ow(e,t,r,a):4===e.strategy||s===n?(yw(e,2+(a?1:0),3),_w(e,lw,ow)):(yw(e,4+(a?1:0),3),((e,t,r,a)=>{let n;for(yw(e,t-257,5),yw(e,r-1,5),yw(e,a-4,4),n=0;n<a;n++)yw(e,e.bl_tree[2*iw[n]+1],3);Lw(e,e.dyn_ltree,t-1),Lw(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),_w(e,e.dyn_ltree,e.dyn_dtree)),kw(e),a&&Sw(e)},Iw=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(dw[r]+Zy+1)]++,e.dyn_dtree[2*bw(t)]++),e.sym_next===e.sym_end),Rw=e=>{yw(e,2,3),ww(e,256,lw),(e=>{16===e.bi_valid?(vw(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},Mw={_tr_init:Fw,_tr_stored_block:Ow,_tr_flush_block:Dw,_tr_tally:Iw,_tr_align:Rw};var Bw=(e,t,r,a)=>{let n=65535&e,s=e>>>16&65535,i=0;for(;0!==r;){i=r>2e3?2e3:r,r-=i;do{n=n+t[a++]|0,s=s+n|0}while(--i);n%=65521,s%=65521}return n|s<<16};const Uw=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var zw=(e,t,r,a)=>{const n=Uw,s=a+r;e^=-1;for(let i=a;i<s;i++)e=e>>>8^n[255&(e^t[i])];return-1^e},qw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Hw={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ww,_tr_stored_block:Vw,_tr_flush_block:Gw,_tr_tally:Kw,_tr_align:Yw}=Mw,{Z_NO_FLUSH:Xw,Z_PARTIAL_FLUSH:$w,Z_FULL_FLUSH:Jw,Z_FINISH:Qw,Z_BLOCK:Zw,Z_OK:eN,Z_STREAM_END:tN,Z_STREAM_ERROR:rN,Z_DATA_ERROR:aN,Z_BUF_ERROR:nN,Z_DEFAULT_COMPRESSION:sN,Z_FILTERED:iN,Z_HUFFMAN_ONLY:lN,Z_RLE:oN,Z_FIXED:cN,Z_DEFAULT_STRATEGY:dN,Z_UNKNOWN:uN,Z_DEFLATED:hN}=Hw,fN=258,mN=262,pN=42,gN=113,xN=666,bN=(e,t)=>(e.msg=qw[t],t),vN=e=>2*e-(e>4?9:0),yN=e=>{let t=e.length;for(;--t>=0;)e[t]=0},wN=e=>{let t,r,a,n=e.w_size;t=e.hash_size,a=t;do{r=e.head[--a],e.head[a]=r>=n?r-n:0}while(--t);t=n,a=t;do{r=e.prev[--a],e.prev[a]=r>=n?r-n:0}while(--t)};let NN=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const jN=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},kN=(e,t)=>{Gw(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,jN(e.strm)},SN=(e,t)=>{e.pending_buf[e.pending++]=t},AN=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},CN=(e,t,r,a)=>{let n=e.avail_in;return n>a&&(n=a),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),r),1===e.state.wrap?e.adler=Bw(e.adler,t,n,r):2===e.state.wrap&&(e.adler=zw(e.adler,t,n,r)),e.next_in+=n,e.total_in+=n,n)},_N=(e,t)=>{let r,a,n=e.max_chain_length,s=e.strstart,i=e.prev_length,l=e.nice_match;const o=e.strstart>e.w_size-mN?e.strstart-(e.w_size-mN):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+fN;let f=c[s+i-1],m=c[s+i];e.prev_length>=e.good_match&&(n>>=2),l>e.lookahead&&(l=e.lookahead);do{if(r=t,c[r+i]===m&&c[r+i-1]===f&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<h);if(a=fN-(h-s),s=h-fN,a>i){if(e.match_start=t,i=a,a>=l)break;f=c[s+i-1],m=c[s+i]}}}while((t=u[t&d])>o&&0!==--n);return i<=e.lookahead?i:e.lookahead},TN=e=>{const t=e.w_size;let r,a,n;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-mN)&&(e.window.set(e.window.subarray(t,t+t-a),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),wN(e),a+=t),0===e.strm.avail_in)break;if(r=CN(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=r,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=NN(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=NN(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<mN&&0!==e.strm.avail_in)},EN=(e,t)=>{let r,a,n,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,l=e.strm.avail_in;do{if(r=65535,n=e.bi_valid+42>>3,e.strm.avail_out<n)break;if(n=e.strm.avail_out-n,a=e.strstart-e.block_start,r>a+e.strm.avail_in&&(r=a+e.strm.avail_in),r>n&&(r=n),r<s&&(0===r&&t!==Qw||t===Xw||r!==a+e.strm.avail_in))break;i=t===Qw&&r===a+e.strm.avail_in?1:0,Vw(e,0,0,i),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,jN(e.strm),a&&(a>r&&(a=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,r-=a),r&&(CN(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===i);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==Xw&&t!==Qw&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(n=e.window_size-e.strstart,e.strm.avail_in>n&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,n+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),n>e.strm.avail_in&&(n=e.strm.avail_in),n&&(CN(e.strm,e.window,e.strstart,n),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.high_water<e.strstart&&(e.high_water=e.strstart),n=e.bi_valid+42>>3,n=e.pending_buf_size-n>65535?65535:e.pending_buf_size-n,s=n>e.w_size?e.w_size:n,a=e.strstart-e.block_start,(a>=s||(a||t===Qw)&&t!==Xw&&0===e.strm.avail_in&&a<=n)&&(r=a>n?n:a,i=t===Qw&&0===e.strm.avail_in&&r===a?1:0,Vw(e,e.block_start,r,i),e.block_start+=r,jN(e.strm)),i?3:1)},LN=(e,t)=>{let r,a;for(;;){if(e.lookahead<mN){if(TN(e),e.lookahead<mN&&t===Xw)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=NN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-mN&&(e.match_length=_N(e,r)),e.match_length>=3)if(a=Kw(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=NN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=NN(e,e.ins_h,e.window[e.strstart+1]);else a=Kw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(kN(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Qw?(kN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(kN(e,!1),0===e.strm.avail_out)?1:2},PN=(e,t)=>{let r,a,n;for(;;){if(e.lookahead<mN){if(TN(e),e.lookahead<mN&&t===Xw)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=NN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-mN&&(e.match_length=_N(e,r),e.match_length<=5&&(e.strategy===iN||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,a=Kw(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=NN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(kN(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(a=Kw(e,0,e.window[e.strstart-1]),a&&kN(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=Kw(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Qw?(kN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(kN(e,!1),0===e.strm.avail_out)?1:2};function ON(e,t,r,a,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=a,this.func=n}const FN=[new ON(0,0,0,0,EN),new ON(4,4,8,4,LN),new ON(4,5,16,8,LN),new ON(4,6,32,32,LN),new ON(4,4,16,16,PN),new ON(8,16,32,32,PN),new ON(8,16,128,128,PN),new ON(8,32,128,256,PN),new ON(32,128,258,1024,PN),new ON(32,258,258,4096,PN)];function DN(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=hN,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),yN(this.dyn_ltree),yN(this.dyn_dtree),yN(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),yN(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),yN(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const IN=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==pN&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==gN&&t.status!==xN?1:0},RN=e=>{if(IN(e))return bN(e,rN);e.total_in=e.total_out=0,e.data_type=uN;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?pN:gN,e.adler=2===t.wrap?0:1,t.last_flush=-2,Ww(t),eN},MN=e=>{const t=RN(e);return t===eN&&(e=>{e.window_size=2*e.w_size,yN(e.head),e.max_lazy_match=FN[e.level].max_lazy,e.good_match=FN[e.level].good_length,e.nice_match=FN[e.level].nice_length,e.max_chain_length=FN[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},BN=(e,t,r,a,n,s)=>{if(!e)return rN;let i=1;if(t===sN&&(t=6),a<0?(i=0,a=-a):a>15&&(i=2,a-=16),n<1||n>9||r!==hN||a<8||a>15||t<0||t>9||s<0||s>cN||8===a&&1!==i)return bN(e,rN);8===a&&(a=9);const l=new DN;return e.state=l,l.strm=e,l.status=pN,l.wrap=i,l.gzhead=null,l.w_bits=a,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=n+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new Uint8Array(2*l.w_size),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<n+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=3*(l.lit_bufsize-1),l.level=t,l.strategy=s,l.method=r,MN(e)};var UN=(e,t)=>{if(IN(e)||t>Zw||t<0)return e?bN(e,rN):rN;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===xN&&t!==Qw)return bN(e,0===e.avail_out?nN:rN);const a=r.last_flush;if(r.last_flush=t,0!==r.pending){if(jN(e),0===e.avail_out)return r.last_flush=-1,eN}else if(0===e.avail_in&&vN(t)<=vN(a)&&t!==Qw)return bN(e,nN);if(r.status===xN&&0!==e.avail_in)return bN(e,nN);if(r.status===pN&&0===r.wrap&&(r.status=gN),r.status===pN){let t=hN+(r.w_bits-8<<4)<<8,a=-1;if(a=r.strategy>=lN||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=a<<6,0!==r.strstart&&(t|=32),t+=31-t%31,AN(r,t),0!==r.strstart&&(AN(r,e.adler>>>16),AN(r,65535&e.adler)),e.adler=1,r.status=gN,jN(e),0!==r.pending)return r.last_flush=-1,eN}if(57===r.status)if(e.adler=0,SN(r,31),SN(r,139),SN(r,8),r.gzhead)SN(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),SN(r,255&r.gzhead.time),SN(r,r.gzhead.time>>8&255),SN(r,r.gzhead.time>>16&255),SN(r,r.gzhead.time>>24&255),SN(r,9===r.level?2:r.strategy>=lN||r.level<2?4:0),SN(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(SN(r,255&r.gzhead.extra.length),SN(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=zw(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(SN(r,0),SN(r,0),SN(r,0),SN(r,0),SN(r,0),SN(r,9===r.level?2:r.strategy>=lN||r.level<2?4:0),SN(r,3),r.status=gN,jN(e),0!==r.pending)return r.last_flush=-1,eN;if(69===r.status){if(r.gzhead.extra){let t=r.pending,a=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+a>r.pending_buf_size;){let n=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=zw(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=n,jN(e),0!==r.pending)return r.last_flush=-1,eN;t=0,a-=n}let n=new Uint8Array(r.gzhead.extra);r.pending_buf.set(n.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>t&&(e.adler=zw(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,a=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=zw(e.adler,r.pending_buf,r.pending-a,a)),jN(e),0!==r.pending)return r.last_flush=-1,eN;a=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,SN(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>a&&(e.adler=zw(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,a=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=zw(e.adler,r.pending_buf,r.pending-a,a)),jN(e),0!==r.pending)return r.last_flush=-1,eN;a=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,SN(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>a&&(e.adler=zw(e.adler,r.pending_buf,r.pending-a,a))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(jN(e),0!==r.pending))return r.last_flush=-1,eN;SN(r,255&e.adler),SN(r,e.adler>>8&255),e.adler=0}if(r.status=gN,jN(e),0!==r.pending)return r.last_flush=-1,eN}if(0!==e.avail_in||0!==r.lookahead||t!==Xw&&r.status!==xN){let a=0===r.level?EN(r,t):r.strategy===lN?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(TN(e),0===e.lookahead)){if(t===Xw)return 1;break}if(e.match_length=0,r=Kw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(kN(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Qw?(kN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(kN(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===oN?((e,t)=>{let r,a,n,s;const i=e.window;for(;;){if(e.lookahead<=fN){if(TN(e),e.lookahead<=fN&&t===Xw)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=e.strstart-1,a=i[n],a===i[++n]&&a===i[++n]&&a===i[++n])){s=e.strstart+fN;do{}while(a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&n<s);e.match_length=fN-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=Kw(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Kw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(kN(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Qw?(kN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(kN(e,!1),0===e.strm.avail_out)?1:2})(r,t):FN[r.level].func(r,t);if(3!==a&&4!==a||(r.status=xN),1===a||3===a)return 0===e.avail_out&&(r.last_flush=-1),eN;if(2===a&&(t===$w?Yw(r):t!==Zw&&(Vw(r,0,0,!1),t===Jw&&(yN(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),jN(e),0===e.avail_out))return r.last_flush=-1,eN}return t!==Qw?eN:r.wrap<=0?tN:(2===r.wrap?(SN(r,255&e.adler),SN(r,e.adler>>8&255),SN(r,e.adler>>16&255),SN(r,e.adler>>24&255),SN(r,255&e.total_in),SN(r,e.total_in>>8&255),SN(r,e.total_in>>16&255),SN(r,e.total_in>>24&255)):(AN(r,e.adler>>>16),AN(r,65535&e.adler)),jN(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?eN:tN)},zN=(e,t)=>{let r=t.length;if(IN(e))return rN;const a=e.state,n=a.wrap;if(2===n||1===n&&a.status!==pN||a.lookahead)return rN;if(1===n&&(e.adler=Bw(e.adler,t,r,0)),a.wrap=0,r>=a.w_size){0===n&&(yN(a.head),a.strstart=0,a.block_start=0,a.insert=0);let e=new Uint8Array(a.w_size);e.set(t.subarray(r-a.w_size,r),0),t=e,r=a.w_size}const s=e.avail_in,i=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,TN(a);a.lookahead>=3;){let e=a.strstart,t=a.lookahead-2;do{a.ins_h=NN(a,a.ins_h,a.window[e+3-1]),a.prev[e&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=e,e++}while(--t);a.strstart=e,a.lookahead=2,TN(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,e.next_in=i,e.input=l,e.avail_in=s,a.wrap=n,eN},qN={deflateInit:(e,t)=>BN(e,t,hN,15,8,dN),deflateInit2:BN,deflateReset:MN,deflateResetKeep:RN,deflateSetHeader:(e,t)=>IN(e)||2!==e.state.wrap?rN:(e.state.gzhead=t,eN),deflate:UN,deflateEnd:e=>{if(IN(e))return rN;const t=e.state.status;return e.state=null,t===gN?bN(e,aN):eN},deflateSetDictionary:zN,deflateInfo:"pako deflate (from Nodeca project)"};const HN=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var WN=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const t in r)HN(r,t)&&(e[t]=r[t])}}return e},VN=e=>{let t=0;for(let a=0,n=e.length;a<n;a++)t+=e[a].length;const r=new Uint8Array(t);for(let a=0,n=0,s=e.length;a<s;a++){let t=e[a];r.set(t,n),n+=t.length}return r};let GN=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(pT){GN=!1}const KN=new Uint8Array(256);for(let $=0;$<256;$++)KN[$]=$>=252?6:$>=248?5:$>=240?4:$>=224?3:$>=192?2:1;KN[254]=KN[254]=1;var YN=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,a,n,s,i=e.length,l=0;for(n=0;n<i;n++)r=e.charCodeAt(n),55296===(64512&r)&&n+1<i&&(a=e.charCodeAt(n+1),56320===(64512&a)&&(r=65536+(r-55296<<10)+(a-56320),n++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,n=0;s<l;n++)r=e.charCodeAt(n),55296===(64512&r)&&n+1<i&&(a=e.charCodeAt(n+1),56320===(64512&a)&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},XN=(e,t)=>{const r=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let a,n;const s=new Array(2*r);for(n=0,a=0;a<r;){let t=e[a++];if(t<128){s[n++]=t;continue}let i=KN[t];if(i>4)s[n++]=65533,a+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&a<r;)t=t<<6|63&e[a++],i--;i>1?s[n++]=65533:t<65536?s[n++]=t:(t-=65536,s[n++]=55296|t>>10&1023,s[n++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&GN)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r})(s,n)},$N=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128===(192&e[r]);)r--;return r<0||0===r?t:r+KN[e[r]]>t?r:t};var JN=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const QN=Object.prototype.toString,{Z_NO_FLUSH:ZN,Z_SYNC_FLUSH:ej,Z_FULL_FLUSH:tj,Z_FINISH:rj,Z_OK:aj,Z_STREAM_END:nj,Z_DEFAULT_COMPRESSION:sj,Z_DEFAULT_STRATEGY:ij,Z_DEFLATED:lj}=Hw;function oj(e){this.options=WN({level:sj,method:lj,chunkSize:16384,windowBits:15,memLevel:8,strategy:ij},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new JN,this.strm.avail_out=0;let r=qN.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==aj)throw new Error(qw[r]);if(t.header&&qN.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?YN(t.dictionary):"[object ArrayBuffer]"===QN.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=qN.deflateSetDictionary(this.strm,e),r!==aj)throw new Error(qw[r]);this._dict_set=!0}}function cj(e,t){const r=new oj(t);if(r.push(e,!0),r.err)throw r.msg||qw[r.err];return r.result}oj.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?rj:ZN,"string"===typeof e?r.input=YN(e):"[object ArrayBuffer]"===QN.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),(s===ej||s===tj)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(n=qN.deflate(r,s),n===nj)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=qN.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===aj;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},oj.prototype.onData=function(e){this.chunks.push(e)},oj.prototype.onEnd=function(e){e===aj&&(this.result=VN(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var dj={Deflate:oj,deflate:cj,deflateRaw:function(e,t){return(t=t||{}).raw=!0,cj(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,cj(e,t)},constants:Hw};const uj=16209;var hj=function(e,t){let r,a,n,s,i,l,o,c,d,u,h,f,m,p,g,x,b,v,y,w,N,j,k,S;const A=e.state;r=e.next_in,k=e.input,a=r+(e.avail_in-5),n=e.next_out,S=e.output,s=n-(t-e.avail_out),i=n+(e.avail_out-257),l=A.dmax,o=A.wsize,c=A.whave,d=A.wnext,u=A.window,h=A.hold,f=A.bits,m=A.lencode,p=A.distcode,g=(1<<A.lenbits)-1,x=(1<<A.distbits)-1;e:do{f<15&&(h+=k[r++]<<f,f+=8,h+=k[r++]<<f,f+=8),b=m[h&g];t:for(;;){if(v=b>>>24,h>>>=v,f-=v,v=b>>>16&255,0===v)S[n++]=65535&b;else{if(!(16&v)){if(0===(64&v)){b=m[(65535&b)+(h&(1<<v)-1)];continue t}if(32&v){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=uj;break e}y=65535&b,v&=15,v&&(f<v&&(h+=k[r++]<<f,f+=8),y+=h&(1<<v)-1,h>>>=v,f-=v),f<15&&(h+=k[r++]<<f,f+=8,h+=k[r++]<<f,f+=8),b=p[h&x];r:for(;;){if(v=b>>>24,h>>>=v,f-=v,v=b>>>16&255,!(16&v)){if(0===(64&v)){b=p[(65535&b)+(h&(1<<v)-1)];continue r}e.msg="invalid distance code",A.mode=uj;break e}if(w=65535&b,v&=15,f<v&&(h+=k[r++]<<f,f+=8,f<v&&(h+=k[r++]<<f,f+=8)),w+=h&(1<<v)-1,w>l){e.msg="invalid distance too far back",A.mode=uj;break e}if(h>>>=v,f-=v,v=n-s,w>v){if(v=w-v,v>c&&A.sane){e.msg="invalid distance too far back",A.mode=uj;break e}if(N=0,j=u,0===d){if(N+=o-v,v<y){y-=v;do{S[n++]=u[N++]}while(--v);N=n-w,j=S}}else if(d<v){if(N+=o+d-v,v-=d,v<y){y-=v;do{S[n++]=u[N++]}while(--v);if(N=0,d<y){v=d,y-=v;do{S[n++]=u[N++]}while(--v);N=n-w,j=S}}}else if(N+=d-v,v<y){y-=v;do{S[n++]=u[N++]}while(--v);N=n-w,j=S}for(;y>2;)S[n++]=j[N++],S[n++]=j[N++],S[n++]=j[N++],y-=3;y&&(S[n++]=j[N++],y>1&&(S[n++]=j[N++]))}else{N=n-w;do{S[n++]=S[N++],S[n++]=S[N++],S[n++]=S[N++],y-=3}while(y>2);y&&(S[n++]=S[N++],y>1&&(S[n++]=S[N++]))}break}}break}}while(r<a&&n<i);y=f>>3,r-=y,f-=y<<3,h&=(1<<f)-1,e.next_in=r,e.next_out=n,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=n<i?i-n+257:257-(n-i),A.hold=h,A.bits=f};const fj=15,mj=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),pj=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),gj=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xj=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var bj=(e,t,r,a,n,s,i,l)=>{const o=l.bits;let c,d,u,h,f,m,p=0,g=0,x=0,b=0,v=0,y=0,w=0,N=0,j=0,k=0,S=null;const A=new Uint16Array(16),C=new Uint16Array(16);let _,T,E,L=null;for(p=0;p<=fj;p++)A[p]=0;for(g=0;g<a;g++)A[t[r+g]]++;for(v=o,b=fj;b>=1&&0===A[b];b--);if(v>b&&(v=b),0===b)return n[s++]=20971520,n[s++]=20971520,l.bits=1,0;for(x=1;x<b&&0===A[x];x++);for(v<x&&(v=x),N=1,p=1;p<=fj;p++)if(N<<=1,N-=A[p],N<0)return-1;if(N>0&&(0===e||1!==b))return-1;for(C[1]=0,p=1;p<fj;p++)C[p+1]=C[p]+A[p];for(g=0;g<a;g++)0!==t[r+g]&&(i[C[t[r+g]]++]=g);if(0===e?(S=L=i,m=20):1===e?(S=mj,L=pj,m=257):(S=gj,L=xj,m=0),k=0,g=0,p=x,f=s,y=v,w=0,u=-1,j=1<<v,h=j-1,1===e&&j>852||2===e&&j>592)return 1;for(;;){_=p-w,i[g]+1<m?(T=0,E=i[g]):i[g]>=m?(T=L[i[g]-m],E=S[i[g]-m]):(T=96,E=0),c=1<<p-w,d=1<<y,x=d;do{d-=c,n[f+(k>>w)+d]=_<<24|T<<16|E}while(0!==d);for(c=1<<p-1;k&c;)c>>=1;if(0!==c?(k&=c-1,k+=c):k=0,g++,0===--A[p]){if(p===b)break;p=t[r+i[g]]}if(p>v&&(k&h)!==u){for(0===w&&(w=v),f+=x,y=p-w,N=1<<y;y+w<b&&(N-=A[y+w],!(N<=0));)y++,N<<=1;if(j+=1<<y,1===e&&j>852||2===e&&j>592)return 1;u=k&h,n[u]=v<<24|y<<16|f-s}}return 0!==k&&(n[f+k]=p-w<<24|64<<16),l.bits=v,0};const{Z_FINISH:vj,Z_BLOCK:yj,Z_TREES:wj,Z_OK:Nj,Z_STREAM_END:jj,Z_NEED_DICT:kj,Z_STREAM_ERROR:Sj,Z_DATA_ERROR:Aj,Z_MEM_ERROR:Cj,Z_BUF_ERROR:_j,Z_DEFLATED:Tj}=Hw,Ej=16180,Lj=16190,Pj=16191,Oj=16192,Fj=16194,Dj=16199,Ij=16200,Rj=16206,Mj=16209,Bj=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Uj(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const zj=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Ej||t.mode>16211?1:0},qj=e=>{if(zj(e))return Sj;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Ej,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Nj},Hj=e=>{if(zj(e))return Sj;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,qj(e)},Wj=(e,t)=>{let r;if(zj(e))return Sj;const a=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Sj:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,Hj(e))},Vj=(e,t)=>{if(!e)return Sj;const r=new Uj;e.state=r,r.strm=e,r.window=null,r.mode=Ej;const a=Wj(e,t);return a!==Nj&&(e.state=null),a};let Gj,Kj,Yj=!0;const Xj=e=>{if(Yj){Gj=new Int32Array(512),Kj=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(bj(1,e.lens,0,288,Gj,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;bj(2,e.lens,0,32,Kj,0,e.work,{bits:5}),Yj=!1}e.lencode=Gj,e.lenbits=9,e.distcode=Kj,e.distbits=5},$j=(e,t,r,a)=>{let n;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(t.subarray(r-a,r-a+n),s.wnext),(a-=n)?(s.window.set(t.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var Jj=(e,t)=>{let r,a,n,s,i,l,o,c,d,u,h,f,m,p,g,x,b,v,y,w,N,j,k=0;const S=new Uint8Array(4);let A,C;const _=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(zj(e)||!e.output||!e.input&&0!==e.avail_in)return Sj;r=e.state,r.mode===Pj&&(r.mode=Oj),i=e.next_out,n=e.output,o=e.avail_out,s=e.next_in,a=e.input,l=e.avail_in,c=r.hold,d=r.bits,u=l,h=o,j=Nj;e:for(;;)switch(r.mode){case Ej:if(0===r.wrap){r.mode=Oj;break}for(;d<16;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,S[0]=255&c,S[1]=c>>>8&255,r.check=zw(r.check,S,2,0),c=0,d=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Mj;break}if((15&c)!==Tj){e.msg="unknown compression method",r.mode=Mj;break}if(c>>>=4,d-=4,N=8+(15&c),0===r.wbits&&(r.wbits=N),N>15||N>r.wbits){e.msg="invalid window size",r.mode=Mj;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:Pj,c=0,d=0;break;case 16181:for(;d<16;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(r.flags=c,(255&r.flags)!==Tj){e.msg="unknown compression method",r.mode=Mj;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Mj;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=zw(r.check,S,2,0)),c=0,d=0,r.mode=16182;case 16182:for(;d<32;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,r.check=zw(r.check,S,4,0)),c=0,d=0,r.mode=16183;case 16183:for(;d<16;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=zw(r.check,S,2,0)),c=0,d=0,r.mode=16184;case 16184:if(1024&r.flags){for(;d<16;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=zw(r.check,S,2,0)),c=0,d=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>l&&(f=l),f&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+f),N)),512&r.flags&&4&r.wrap&&(r.check=zw(r.check,a,f,s)),l-=f,s+=f,r.length-=f),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===l)break e;f=0;do{N=a[s+f++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N))}while(N&&f<l);if(512&r.flags&&4&r.wrap&&(r.check=zw(r.check,a,f,s)),l-=f,s+=f,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===l)break e;f=0;do{N=a[s+f++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N))}while(N&&f<l);if(512&r.flags&&4&r.wrap&&(r.check=zw(r.check,a,f,s)),l-=f,s+=f,N)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;d<16;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Mj;break}c=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Pj;break;case 16189:for(;d<32;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}e.adler=r.check=Bj(c),c=0,d=0,r.mode=Lj;case Lj:if(0===r.havedict)return e.next_out=i,e.avail_out=o,e.next_in=s,e.avail_in=l,r.hold=c,r.bits=d,kj;e.adler=r.check=1,r.mode=Pj;case Pj:if(t===yj||t===wj)break e;case Oj:if(r.last){c>>>=7&d,d-=7&d,r.mode=Rj;break}for(;d<3;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}switch(r.last=1&c,c>>>=1,d-=1,3&c){case 0:r.mode=16193;break;case 1:if(Xj(r),r.mode=Dj,t===wj){c>>>=2,d-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Mj}c>>>=2,d-=2;break;case 16193:for(c>>>=7&d,d-=7&d;d<32;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if((65535&c)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Mj;break}if(r.length=65535&c,c=0,d=0,r.mode=Fj,t===wj)break e;case Fj:r.mode=16195;case 16195:if(f=r.length,f){if(f>l&&(f=l),f>o&&(f=o),0===f)break e;n.set(a.subarray(s,s+f),i),l-=f,s+=f,o-=f,i+=f,r.length-=f;break}r.mode=Pj;break;case 16196:for(;d<14;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(r.nlen=257+(31&c),c>>>=5,d-=5,r.ndist=1+(31&c),c>>>=5,d-=5,r.ncode=4+(15&c),c>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Mj;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;d<3;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}r.lens[_[r.have++]]=7&c,c>>>=3,d-=3}for(;r.have<19;)r.lens[_[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},j=bj(0,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,j){e.msg="invalid code lengths set",r.mode=Mj;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;k=r.lencode[c&(1<<r.lenbits)-1],g=k>>>24,x=k>>>16&255,b=65535&k,!(g<=d);){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(b<16)c>>>=g,d-=g,r.lens[r.have++]=b;else{if(16===b){for(C=g+2;d<C;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(c>>>=g,d-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=Mj;break}N=r.lens[r.have-1],f=3+(3&c),c>>>=2,d-=2}else if(17===b){for(C=g+3;d<C;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}c>>>=g,d-=g,N=0,f=3+(7&c),c>>>=3,d-=3}else{for(C=g+7;d<C;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}c>>>=g,d-=g,N=0,f=11+(127&c),c>>>=7,d-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Mj;break}for(;f--;)r.lens[r.have++]=N}}if(r.mode===Mj)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Mj;break}if(r.lenbits=9,A={bits:r.lenbits},j=bj(1,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,j){e.msg="invalid literal/lengths set",r.mode=Mj;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},j=bj(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,j){e.msg="invalid distances set",r.mode=Mj;break}if(r.mode=Dj,t===wj)break e;case Dj:r.mode=Ij;case Ij:if(l>=6&&o>=258){e.next_out=i,e.avail_out=o,e.next_in=s,e.avail_in=l,r.hold=c,r.bits=d,hj(e,h),i=e.next_out,n=e.output,o=e.avail_out,s=e.next_in,a=e.input,l=e.avail_in,c=r.hold,d=r.bits,r.mode===Pj&&(r.back=-1);break}for(r.back=0;k=r.lencode[c&(1<<r.lenbits)-1],g=k>>>24,x=k>>>16&255,b=65535&k,!(g<=d);){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(x&&0===(240&x)){for(v=g,y=x,w=b;k=r.lencode[w+((c&(1<<v+y)-1)>>v)],g=k>>>24,x=k>>>16&255,b=65535&k,!(v+g<=d);){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}c>>>=v,d-=v,r.back+=v}if(c>>>=g,d-=g,r.back+=g,r.length=b,0===x){r.mode=16205;break}if(32&x){r.back=-1,r.mode=Pj;break}if(64&x){e.msg="invalid literal/length code",r.mode=Mj;break}r.extra=15&x,r.mode=16201;case 16201:if(r.extra){for(C=r.extra;d<C;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;k=r.distcode[c&(1<<r.distbits)-1],g=k>>>24,x=k>>>16&255,b=65535&k,!(g<=d);){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(0===(240&x)){for(v=g,y=x,w=b;k=r.distcode[w+((c&(1<<v+y)-1)>>v)],g=k>>>24,x=k>>>16&255,b=65535&k,!(v+g<=d);){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}c>>>=v,d-=v,r.back+=v}if(c>>>=g,d-=g,r.back+=g,64&x){e.msg="invalid distance code",r.mode=Mj;break}r.offset=b,r.extra=15&x,r.mode=16203;case 16203:if(r.extra){for(C=r.extra;d<C;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Mj;break}r.mode=16204;case 16204:if(0===o)break e;if(f=h-o,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Mj;break}f>r.wnext?(f-=r.wnext,m=r.wsize-f):m=r.wnext-f,f>r.length&&(f=r.length),p=r.window}else p=n,m=i-r.offset,f=r.length;f>o&&(f=o),o-=f,r.length-=f;do{n[i++]=p[m++]}while(--f);0===r.length&&(r.mode=Ij);break;case 16205:if(0===o)break e;n[i++]=r.length,o--,r.mode=Ij;break;case Rj:if(r.wrap){for(;d<32;){if(0===l)break e;l--,c|=a[s++]<<d,d+=8}if(h-=o,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?zw(r.check,n,h,i-h):Bw(r.check,n,h,i-h)),h=o,4&r.wrap&&(r.flags?c:Bj(c))!==r.check){e.msg="incorrect data check",r.mode=Mj;break}c=0,d=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;d<32;){if(0===l)break e;l--,c+=a[s++]<<d,d+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Mj;break}c=0,d=0}r.mode=16208;case 16208:j=jj;break e;case Mj:j=Aj;break e;case 16210:return Cj;default:return Sj}return e.next_out=i,e.avail_out=o,e.next_in=s,e.avail_in=l,r.hold=c,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<Mj&&(r.mode<Rj||t!==vj))&&$j(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?zw(r.check,n,h,e.next_out-h):Bw(r.check,n,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Pj?128:0)+(r.mode===Dj||r.mode===Fj?256:0),(0===u&&0===h||t===vj)&&j===Nj&&(j=_j),j},Qj={inflateReset:Hj,inflateReset2:Wj,inflateResetKeep:qj,inflateInit:e=>Vj(e,15),inflateInit2:Vj,inflate:Jj,inflateEnd:e=>{if(zj(e))return Sj;let t=e.state;return t.window&&(t.window=null),e.state=null,Nj},inflateGetHeader:(e,t)=>{if(zj(e))return Sj;const r=e.state;return 0===(2&r.wrap)?Sj:(r.head=t,t.done=!1,Nj)},inflateSetDictionary:(e,t)=>{const r=t.length;let a,n,s;return zj(e)?Sj:(a=e.state,0!==a.wrap&&a.mode!==Lj?Sj:a.mode===Lj&&(n=1,n=Bw(n,t,r,0),n!==a.check)?Aj:(s=$j(e,t,r,r),s?(a.mode=16210,Cj):(a.havedict=1,Nj)))},inflateInfo:"pako inflate (from Nodeca project)"};var Zj=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ek=Object.prototype.toString,{Z_NO_FLUSH:tk,Z_FINISH:rk,Z_OK:ak,Z_STREAM_END:nk,Z_NEED_DICT:sk,Z_STREAM_ERROR:ik,Z_DATA_ERROR:lk,Z_MEM_ERROR:ok}=Hw;function ck(e){this.options=WN({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new JN,this.strm.avail_out=0;let r=Qj.inflateInit2(this.strm,t.windowBits);if(r!==ak)throw new Error(qw[r]);if(this.header=new Zj,Qj.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=YN(t.dictionary):"[object ArrayBuffer]"===ek.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Qj.inflateSetDictionary(this.strm,t.dictionary),r!==ak)))throw new Error(qw[r])}function dk(e,t){const r=new ck(t);if(r.push(e),r.err)throw r.msg||qw[r.err];return r.result}ck.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,i,l;if(this.ended)return!1;for(i=t===~~t?t:!0===t?rk:tk,"[object ArrayBuffer]"===ek.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=Qj.inflate(r,i),s===sk&&n&&(s=Qj.inflateSetDictionary(r,n),s===ak?s=Qj.inflate(r,i):s===lk&&(s=sk));r.avail_in>0&&s===nk&&r.state.wrap>0&&0!==e[r.next_in];)Qj.inflateReset(r),s=Qj.inflate(r,i);switch(s){case ik:case lk:case sk:case ok:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(0===r.avail_out||s===nk))if("string"===this.options.to){let e=$N(r.output,r.next_out),t=r.next_out-e,n=XN(r.output,e);r.next_out=t,r.avail_out=a-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==ak||0!==l){if(s===nk)return s=Qj.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},ck.prototype.onData=function(e){this.chunks.push(e)},ck.prototype.onEnd=function(e){e===ak&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=VN(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var uk={Inflate:ck,inflate:dk,inflateRaw:function(e,t){return(t=t||{}).raw=!0,dk(e,t)},ungzip:dk,constants:Hw};const{Deflate:hk,deflate:fk,deflateRaw:mk,gzip:pk}=dj,{Inflate:gk,inflate:xk,inflateRaw:bk,ungzip:vk}=uk;var yk=gk,wk=xk;const Nk=[];for(let $=0;$<256;$++){let e=$;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;Nk[$]=e}const jk=4294967295;function kk(e,t){return(function(e,t,r){let a=e;for(let n=0;n<r;n++)a=Nk[255&(a^t[n])]^a>>>8;return a}(jk,e,t)^jk)>>>0}function Sk(e,t,r){const a=e.readUint32(),n=kk(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(n!==a)throw new Error("CRC mismatch for chunk ".concat(r,". Expected ").concat(a,", found ").concat(n))}function Ak(e,t,r){for(let a=0;a<r;a++)t[a]=e[a]}function Ck(e,t,r,a){let n=0;for(;n<a;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+t[n-a]&255}function _k(e,t,r,a){let n=0;if(0===r.length)for(;n<a;n++)t[n]=e[n];else for(;n<a;n++)t[n]=e[n]+r[n]&255}function Tk(e,t,r,a,n){let s=0;if(0===r.length){for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+(t[s-n]>>1)&255}else{for(;s<n;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<a;s++)t[s]=e[s]+(t[s-n]+r[s]>>1)&255}}function Ek(e,t,r,a,n){let s=0;if(0===r.length){for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+t[s-n]&255}else{for(;s<n;s++)t[s]=e[s]+r[s]&255;for(;s<a;s++)t[s]=e[s]+Lk(t[s-n],r[s],r[s-n])&255}}function Lk(e,t,r){const a=e+t-r,n=Math.abs(a-e),s=Math.abs(a-t),i=Math.abs(a-r);return n<=s&&n<=i?e:s<=i?t:r}function Pk(e,t,r,a,n,s){switch(e){case 0:Ak(t,r,n);break;case 1:Ck(t,r,n,s);break;case 2:_k(t,r,a,n);break;case 3:Tk(t,r,a,n,s);break;case 4:Ek(t,r,a,n,s);break;default:throw new Error("Unsupported filter: ".concat(e))}}const Ok=new Uint16Array([255]),Fk=255===new Uint8Array(Ok.buffer)[0];function Dk(e){return(255&e)<<8|e>>8&255}const Ik=new Uint16Array([255]),Rk=255===new Uint8Array(Ik.buffer)[0],Mk=new Uint8Array(0);function Bk(e){const{data:t,width:r,height:a,channels:n,depth:s}=e,i=Math.ceil(s/8)*n,l=Math.ceil(s/8*n*r),o=new Uint8Array(a*l);let c,d,u=Mk,h=0;for(let f=0;f<a;f++){switch(c=t.subarray(h+1,h+1+l),d=o.subarray(f*l,(f+1)*l),t[h]){case 0:Ak(c,d,l);break;case 1:Ck(c,d,l,i);break;case 2:_k(c,d,u,l);break;case 3:Tk(c,d,u,l,i);break;case 4:Ek(c,d,u,l,i);break;default:throw new Error("Unsupported filter: ".concat(t[h]))}u=d,h+=l+1}if(16===s){const e=new Uint16Array(o.buffer);if(Rk)for(let t=0;t<e.length;t++)e[t]=Uk(e[t]);return e}return o}function Uk(e){return(255&e)<<8|e>>8&255}const zk=Uint8Array.of(137,80,78,71,13,10,26,10);function qk(e){if(!function(e){if(e.length<zk.length)return!1;for(let t=0;t<zk.length;t++)if(e[t]!==zk[t])return!1;return!0}(e.readBytes(zk.length)))throw new Error("wrong PNG signature")}const Hk="tEXt",Wk=new TextDecoder("latin1");function Vk(e){if(Kk(e),0===e.length||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Gk=/^[\u0000-\u00FF]*$/;function Kk(e){if(!Gk.test(e))throw new Error("invalid latin1 text")}function Yk(e,t,r){const a=Xk(t);e[a]=function(e,t){return Wk.decode(e.readBytes(t))}(t,r-a.length-1)}function Xk(e){for(e.mark();0!==e.readByte(););const t=e.offset;e.reset();const r=Wk.decode(e.readBytes(t-e.offset-1));return e.skip(1),Vk(r),r}const $k=-1,Jk=0,Qk=2,Zk=3,eS=4,tS=6,rS=-1,aS=0,nS=-1,sS=0,iS=-1,lS=0,oS=1,cS=0,dS=1,uS=2,hS=0,fS=1;class mS extends Jy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),(0,qe.A)(this,"_checkCrc",void 0),(0,qe.A)(this,"_inflator",void 0),(0,qe.A)(this,"_png",void 0),(0,qe.A)(this,"_apng",void 0),(0,qe.A)(this,"_end",void 0),(0,qe.A)(this,"_hasPalette",void 0),(0,qe.A)(this,"_palette",void 0),(0,qe.A)(this,"_hasTransparency",void 0),(0,qe.A)(this,"_transparency",void 0),(0,qe.A)(this,"_compressionMethod",void 0),(0,qe.A)(this,"_filterMethod",void 0),(0,qe.A)(this,"_interlaceMethod",void 0),(0,qe.A)(this,"_colorType",void 0),(0,qe.A)(this,"_isAnimated",void 0),(0,qe.A)(this,"_numberOfFrames",void 0),(0,qe.A)(this,"_numberOfPlays",void 0),(0,qe.A)(this,"_frames",void 0),(0,qe.A)(this,"_writingDataChunks",void 0);const{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new yk,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=rS,this._filterMethod=nS,this._interlaceMethod=iS,this._colorType=$k,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(qk(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(qk(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Hk:Yk(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-r!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?Sk(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const r=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=r+e}if(this.offset-r!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?Sk(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw new Error("invalid bit depth: ".concat(e));return e}(this.readUint8());const t=this.readUint8();let r;switch(this._colorType=t,t){case Jk:r=1;break;case Qk:r=3;break;case Zk:r=1;break;case eS:r=2;break;case tS:r=4;break;default:throw new Error("Unknown color type: ".concat(t))}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==aS)throw new Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError("PLTE field length must be a multiple of 3. Got ".concat(e));const t=e/3;this._hasPalette=!0;const r=[];this._palette=r;for(let a=0;a<t;a++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodetRNS(e){switch(this._colorType){case Jk:case Qk:if(e%2!==0)throw new RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(e));if(e/2>this._png.width*this._png.height)throw new Error("tRNS chunk contains more alpha values than there are pixels (".concat(e/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case Zk:{if(e>this._palette.length)throw new Error("tRNS chunk contains more alpha values than there are palette colors (".concat(e," vs ").concat(this._palette.length,")"));let t=0;for(;t<e;t++){const e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(e){const t=Xk(this),r=this.readUint8();if(r!==aS)throw new Error("Unsupported iCCP compression method: ".concat(r));const a=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:wk(a)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:e,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(e);if(r){if(r.data=Bk({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===r.xOffset&&0===r.yOffset&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{const a=this._apng.frames.at(e-1);this.disposeFrame(r,a,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,r){switch(e.disposeOp){case cS:break;case dS:for(let t=0;t<this._png.height;t++)for(let a=0;a<this._png.width;a++){const n=(t*e.width+a)*this._png.channels;for(let e=0;e<this._png.channels;e++)r.data[n+e]=0}break;case uS:r.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const r=1<<this._png.depth,a=(e,r)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+r)*this._png.channels,frameIndex:(e*t.width+r)*this._png.channels});switch(t.blendOp){case hS:for(let r=0;r<t.height;r++)for(let n=0;n<t.width;n++){const{index:s,frameIndex:i}=a(r,n);for(let r=0;r<this._png.channels;r++)e.data[s+r]=t.data[i+r]}break;case fS:for(let n=0;n<t.height;n++)for(let s=0;s<t.width;s++){const{index:i,frameIndex:l}=a(n,s);for(let a=0;a<this._png.channels;a++){const n=t.data[l+this._png.channels-1]/r,s=a%(this._png.channels-1)===0?1:t.data[l+a],o=Math.floor(n*s+(1-n)*e.data[i+a]);e.data[i+a]+=o}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var e;if(this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));const t=this._isAnimated?(null===(e=this._frames)||void 0===e?void 0:e.at(0)).data:this._inflator.result;if(this._filterMethod!==sS)throw new Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===lS)this._png.data=Bk({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==oS)throw new Error("Interlace method ".concat(this._interlaceMethod," not supported"));this._png.data=function(e){const{data:t,width:r,height:a,channels:n,depth:s}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*n,o=new Uint8Array(a*r*l);let c=0;for(let d=0;d<7;d++){const e=i[d],n=Math.ceil((r-e.x)/e.xStep),s=Math.ceil((a-e.y)/e.yStep);if(n<=0||s<=0)continue;const u=n*l,h=new Uint8Array(u);for(let i=0;i<s;i++){const s=t[c++],d=t.subarray(c,c+u);c+=u;const f=new Uint8Array(u);Pk(s,d,f,h,u,l),h.set(f);for(let t=0;t<n;t++){const n=e.x+t*e.xStep,s=e.y+i*e.yStep;if(!(n>=r||s>=a))for(let e=0;e<l;e++)o[(s*r+n)*l+e]=f[t*l+e]}}}if(16===s){const e=new Uint16Array(o.buffer);if(Fk)for(let t=0;t<e.length;t++)e[t]=Dk(e[t]);return e}return o}({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:cS,blendOp:hS,data:e}),this._inflator=new yk,this._writingDataChunks=!1}}var pS;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"}(pS||(pS={}));var gS=function(){return"undefined"!=typeof window?window:"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:this}();function xS(){gS.console&&"function"==typeof gS.console.log&&gS.console.log.apply(gS.console,arguments)}var bS={log:xS,warn:function(e){gS.console&&("function"==typeof gS.console.warn?gS.console.warn.apply(gS.console,arguments):xS.call(null,arguments))},error:function(e){gS.console&&("function"==typeof gS.console.error?gS.console.error.apply(gS.console,arguments):xS(e))}};function vS(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){NS(a.response,t,r)},a.onerror=function(){bS.error("could not download file")},a.send()}function yS(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return t.status>=200&&t.status<=299}function wS(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var NS=gS.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,sy.A)(window))||window!==gS?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=gS.URL||gS.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin!==location.origin?yS(n.href)?vS(e,t,r):wS(n,n.target="_blank"):wS(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){wS(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download","string"==typeof e)if(yS(e))vS(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){wS(a)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,sy.A)(t)&&(bS.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return vS(e,t,r);var n="application/octet-stream"===e.type,s=/constructor/i.test(gS.HTMLElement)||gS.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||n&&s)&&"object"===("undefined"==typeof FileReader?"undefined":(0,sy.A)(FileReader))){var l=new FileReader;l.onloadend=function(){var e=l.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},l.readAsDataURL(e)}else{var o=gS.URL||gS.webkitURL,c=o.createObjectURL(e);a?a.location=c:location.href=c,a=null,setTimeout(function(){o.revokeObjectURL(c)},4e4)}});function jS(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,i=n.exec(e);i&&(t=s(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==r.length&&(r="0"+r),"#"+e+t+r}}var kS=gS.atob.bind(gS),SS=gS.btoa.bind(gS);function AS(e,t){var r=e[0],a=e[1],n=e[2],s=e[3];r=_S(r,a,n,s,t[0],7,-680876936),s=_S(s,r,a,n,t[1],12,-389564586),n=_S(n,s,r,a,t[2],17,606105819),a=_S(a,n,s,r,t[3],22,-1044525330),r=_S(r,a,n,s,t[4],7,-176418897),s=_S(s,r,a,n,t[5],12,1200080426),n=_S(n,s,r,a,t[6],17,-1473231341),a=_S(a,n,s,r,t[7],22,-45705983),r=_S(r,a,n,s,t[8],7,1770035416),s=_S(s,r,a,n,t[9],12,-1958414417),n=_S(n,s,r,a,t[10],17,-42063),a=_S(a,n,s,r,t[11],22,-1990404162),r=_S(r,a,n,s,t[12],7,1804603682),s=_S(s,r,a,n,t[13],12,-40341101),n=_S(n,s,r,a,t[14],17,-1502002290),r=TS(r,a=_S(a,n,s,r,t[15],22,1236535329),n,s,t[1],5,-165796510),s=TS(s,r,a,n,t[6],9,-1069501632),n=TS(n,s,r,a,t[11],14,643717713),a=TS(a,n,s,r,t[0],20,-373897302),r=TS(r,a,n,s,t[5],5,-701558691),s=TS(s,r,a,n,t[10],9,38016083),n=TS(n,s,r,a,t[15],14,-660478335),a=TS(a,n,s,r,t[4],20,-405537848),r=TS(r,a,n,s,t[9],5,568446438),s=TS(s,r,a,n,t[14],9,-1019803690),n=TS(n,s,r,a,t[3],14,-187363961),a=TS(a,n,s,r,t[8],20,1163531501),r=TS(r,a,n,s,t[13],5,-1444681467),s=TS(s,r,a,n,t[2],9,-51403784),n=TS(n,s,r,a,t[7],14,1735328473),r=ES(r,a=TS(a,n,s,r,t[12],20,-1926607734),n,s,t[5],4,-378558),s=ES(s,r,a,n,t[8],11,-2022574463),n=ES(n,s,r,a,t[11],16,1839030562),a=ES(a,n,s,r,t[14],23,-35309556),r=ES(r,a,n,s,t[1],4,-1530992060),s=ES(s,r,a,n,t[4],11,1272893353),n=ES(n,s,r,a,t[7],16,-155497632),a=ES(a,n,s,r,t[10],23,-1094730640),r=ES(r,a,n,s,t[13],4,681279174),s=ES(s,r,a,n,t[0],11,-358537222),n=ES(n,s,r,a,t[3],16,-722521979),a=ES(a,n,s,r,t[6],23,76029189),r=ES(r,a,n,s,t[9],4,-640364487),s=ES(s,r,a,n,t[12],11,-421815835),n=ES(n,s,r,a,t[15],16,530742520),r=LS(r,a=ES(a,n,s,r,t[2],23,-995338651),n,s,t[0],6,-198630844),s=LS(s,r,a,n,t[7],10,1126891415),n=LS(n,s,r,a,t[14],15,-1416354905),a=LS(a,n,s,r,t[5],21,-57434055),r=LS(r,a,n,s,t[12],6,1700485571),s=LS(s,r,a,n,t[3],10,-1894986606),n=LS(n,s,r,a,t[10],15,-1051523),a=LS(a,n,s,r,t[1],21,-2054922799),r=LS(r,a,n,s,t[8],6,1873313359),s=LS(s,r,a,n,t[15],10,-30611744),n=LS(n,s,r,a,t[6],15,-1560198380),a=LS(a,n,s,r,t[13],21,1309151649),r=LS(r,a,n,s,t[4],6,-145523070),s=LS(s,r,a,n,t[11],10,-1120210379),n=LS(n,s,r,a,t[2],15,718787259),a=LS(a,n,s,r,t[9],21,-343485551),e[0]=BS(r,e[0]),e[1]=BS(a,e[1]),e[2]=BS(n,e[2]),e[3]=BS(s,e[3])}function CS(e,t,r,a,n,s){return t=BS(BS(t,e),BS(a,s)),BS(t<<n|t>>>32-n,r)}function _S(e,t,r,a,n,s,i){return CS(t&r|~t&a,e,t,n,s,i)}function TS(e,t,r,a,n,s,i){return CS(t&a|r&~a,e,t,n,s,i)}function ES(e,t,r,a,n,s,i){return CS(t^r^a,e,t,n,s,i)}function LS(e,t,r,a,n,s,i){return CS(r^(t|~a),e,t,n,s,i)}function PS(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)AS(a,OS(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(AS(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,AS(a,n),a}function OS(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var FS="0123456789abcdef".split("");function DS(e){for(var t="",r=0;r<4;r++)t+=FS[e>>8*r+4&15]+FS[e>>8*r&15];return t}function IS(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function RS(e){return PS(e).map(IS).join("")}var MS="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=DS(e[t]);return e.join("")}(PS("hello"));function BS(e,t){if(MS){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}function US(e,t){var r,a,n,s;if(e!==r){for(var i=(n=e,s=1+(256/e.length|0),new Array(s+1).join(n)),l=[],o=0;o<256;o++)l[o]=o;var c=0;for(o=0;o<256;o++){var d=l[o];c=(c+d+i.charCodeAt(o))%256,l[o]=l[c],l[c]=d}r=e,a=l}else l=a;var u=t.length,h=0,f=0,m="";for(o=0;o<u;o++)f=(f+(d=l[h=(h+1)%256]))%256,l[h]=l[f],l[f]=d,i=l[(l[h]+l[f])%256],m+=String.fromCharCode(t.charCodeAt(o)^i);return m}var zS={print:4,modify:8,copy:16,"annot-forms":32};function qS(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(e){if(void 0!==zS.perm)throw new Error("Invalid permission: "+e);n+=zS[e]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var s=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^n)),this.encryptionKey=RS(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=US(this.encryptionKey,this.padding)}function HS(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);t+=n<33||35===n||37===n||40===n||41===n||47===n||60===n||62===n||91===n||93===n||123===n||125===n||n>126?"#"+("0"+n.toString(16)).slice(-2):e[a]}return t}function WS(e){if("object"!==(0,sy.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,r,a){if(a=a||!1,"string"!=typeof e||"function"!=typeof r||"boolean"!=typeof a)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var n=Math.random().toString(35);return t[e][n]=[r,!!a],n},this.unsubscribe=function(e){for(var r in t)if(t[r][e])return delete t[r][e],0===Object.keys(t[r]).length&&delete t[r],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[r]){var i=t[r][s];try{i[0].apply(e,a)}catch(wS){gS.console&&bS.error("jsPDF PubSub Error",wS.message,wS)}i[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function VS(e){if(!(this instanceof VS))return new VS(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function GS(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function KS(e,t,r,a,n){if(!(this instanceof KS))return new KS(e,t,r,a,n);this.type="axial"===e?2:3,this.coords=t,this.colors=r,GS.call(this,a,n)}function YS(e,t,r,a,n){if(!(this instanceof YS))return new YS(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,GS.call(this,a,n)}function XS(e){var t,r="string"==typeof arguments[0]?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],i=[],l=1,o=16,c="S",d=null;"object"===(0,sy.A)(e=e||{})&&(r=e.orientation,a=e.unit||a,n=e.format||n,s=e.compress||e.compressPdf||s,null!==(d=e.encryption||null)&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(o=e.floatPrecision),c=e.defaultPathOperation||"S"),i=e.filters||(!0===s?["FlateEncode"]:i),a=a||"mm",r=(""+(r||"P")).toLowerCase();var u=e.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=WS;var m="1.3",p=f.__private__.getPdfVersion=function(){return m};f.__private__.setPdfVersion=function(e){m=e};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return g};var x=f.__private__.getPageFormat=function(e){return g[e]};n=n||"a4";var b="compat",v="advanced",y=b;function w(){this.saveGraphicsState(),J(new Le(he,0,0,-he,0,hr()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),c="n",y=v}function N(){this.restoreGraphicsState(),c="S",y=b}var j=f.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};f.advancedAPI=function(e){var t=y===b;return t&&w.call(this),"function"!=typeof e||(e(this),t&&N.call(this)),this},f.compatAPI=function(e){var t=y===v;return t&&N.call(this),"function"!=typeof e||(e(this),t&&w.call(this)),this},f.isAdvancedAPI=function(){return y===v};var k,S=function(e){if(y!==v)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},A=f.roundToPrecision=f.__private__.roundToPrecision=function(e,r){var a=t||r;if(isNaN(e)||isNaN(a))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(a).replace(/0+$/,"")};k=f.hpf=f.__private__.hpf="number"==typeof o?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,o)}:"smart"===o?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,16)};var C=f.f2=f.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return A(e,2)},_=f.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return A(e,3)},T=f.scale=f.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return y===b?e*he:y===v?e:void 0},E=function(e){return T(function(e){return y===b?hr()-e:y===v?e:void 0}(e))};f.__private__.setPrecision=f.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var L,P="00000000000000000000000000000000",O=f.__private__.getFileId=function(){return P},F=f.__private__.setFileId=function(e){return P=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():P.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==d&&(bt=new qS(d.userPermissions,d.userPassword,d.ownerPassword,P)),P};f.setFileId=function(e){return F(e),this},f.getFileId=function(){return O()};var D=f.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),r=t<0?"+":"-",a=Math.floor(Math.abs(t/60)),n=Math.abs(t%60),s=[r,U(a),"'",U(n),"'"].join("");return["D:",e.getFullYear(),U(e.getMonth()+1),U(e.getDate()),U(e.getHours()),U(e.getMinutes()),U(e.getSeconds()),s].join("")},I=f.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),r=parseInt(e.substr(6,2),10)-1,a=parseInt(e.substr(8,2),10),n=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),i=parseInt(e.substr(14,2),10);return new Date(t,r,a,n,s,i,0)},R=f.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=D(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return L=t},M=f.__private__.getCreationDate=function(e){var t=L;return"jsDate"===e&&(t=I(L)),t};f.setCreationDate=function(e){return R(e),this},f.getCreationDate=function(e){return M(e)};var B,U=f.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},z=f.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},q=0,H=[],W=[],V=0,G=[],K=[],Y=!1,X=W;f.__private__.setCustomOutputDestination=function(e){Y=!0,X=e};var $=function(e){Y||(X=e)};f.__private__.resetCustomOutputDestination=function(){Y=!1,X=W};var J=f.__private__.out=function(e){return e=e.toString(),V+=e.length+1,X.push(e),X},Q=f.__private__.write=function(e){return J(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},Z=f.__private__.getArrayBuffer=function(e){for(var t=e.length,r=new ArrayBuffer(t),a=new Uint8Array(r);t--;)a[t]=e.charCodeAt(t);return r},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(e){return te=y===v?e/he:e,this};var re,ae=f.__private__.getFontSize=f.getFontSize=function(){return y===b?te:te*he},ne=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(e){return ne=e,this},f.__private__.getR2L=f.getR2L=function(){return ne};var se,ie=f.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))re=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');re=e}else re=parseInt(e,10)};f.__private__.getZoomMode=function(){return re};var le,oe=f.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');se=e};f.__private__.getPageMode=function(){return se};var ce=f.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');le=e};f.__private__.getLayoutMode=function(){return le},f.__private__.setDisplayMode=f.setDisplayMode=function(e,t,r){return ie(e),ce(t),oe(r),this};var de={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(e){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return de[e]},f.__private__.getDocumentProperties=function(){return de},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(e){for(var t in de)de.hasOwnProperty(t)&&e[t]&&(de[t]=e[t]);return this},f.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return de[e]=t};var ue,he,fe,me,pe,ge={},xe={},be=[],ve={},ye={},we={},Ne={},je=null,ke=0,Se=[],Ae=new WS(f),Ce=e.hotfixes||[],_e={},Te={},Ee=[],Le=function e(t,r,a,n,s,i){if(!(this instanceof e))return new e(t,r,a,n,s,i);isNaN(t)&&(t=1),isNaN(r)&&(r=0),isNaN(a)&&(a=0),isNaN(n)&&(n=1),isNaN(s)&&(s=0),isNaN(i)&&(i=0),this._matrix=[t,r,a,n,s,i]};Object.defineProperty(Le.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Le.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Le.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Le.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Le.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Le.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Le.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Le.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Le.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Le.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Le.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Le.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Le.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Le.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Le.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Le.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Le.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(e)},Le.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,r=e.sx*this.shy+e.shy*this.sy,a=e.shx*this.sx+e.sy*this.shx,n=e.shx*this.shy+e.sy*this.sy,s=e.tx*this.sx+e.ty*this.shx+this.tx,i=e.tx*this.shy+e.ty*this.sy+this.ty;return new Le(t,r,a,n,s,i)},Le.prototype.decompose=function(){var e=this.sx,t=this.shy,r=this.shx,a=this.sy,n=this.tx,s=this.ty,i=Math.sqrt(e*e+t*t),l=(e/=i)*r+(t/=i)*a;r-=e*l,a-=t*l;var o=Math.sqrt(r*r+a*a);return l/=o,e*(a/=o)<t*(r/=o)&&(e=-e,t=-t,l=-l,i=-i),{scale:new Le(i,0,0,o,0,0),translate:new Le(1,0,0,1,n,s),rotate:new Le(e,t,-t,e,0,0),skew:new Le(1,0,l,1,0,0)}},Le.prototype.toString=function(e){return this.join(" ")},Le.prototype.inversed=function(){var e=this.sx,t=this.shy,r=this.shx,a=this.sy,n=this.tx,s=this.ty,i=1/(e*a-t*r),l=a*i,o=-t*i,c=-r*i,d=e*i;return new Le(l,o,c,d,-l*n-c*s,-o*n-d*s)},Le.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,r=e.x*this.shy+e.y*this.sy+this.ty;return new tr(t,r)},Le.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),r=this.applyToPoint(new tr(e.x+e.w,e.y+e.h));return new rr(t.x,t.y,r.x-t.x,r.y-t.y)},Le.prototype.clone=function(){var e=this.sx,t=this.shy,r=this.shx,a=this.sy,n=this.tx,s=this.ty;return new Le(e,t,r,a,n,s)},f.Matrix=Le;var Pe=f.matrixMult=function(e,t){return t.multiply(e)},Oe=new Le(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Oe;var Fe=function(e,t){if(!ye[e]){var r=(t instanceof KS?"Sh":"P")+(Object.keys(ve).length+1).toString(10);t.id=r,ye[e]=r,ve[r]=t,Ae.publish("addPattern",t)}};f.ShadingPattern=KS,f.TilingPattern=YS,f.addShadingPattern=function(e,t){return S("addShadingPattern()"),Fe(e,t),this},f.beginTilingPattern=function(e){S("beginTilingPattern()"),nr(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},f.endTilingPattern=function(e,t){S("endTilingPattern()"),t.stream=K[B].join("\n"),Fe(e,t),Ae.publish("endTilingPattern",t),Ee.pop().restore()};var De,Ie=f.__private__.newObject=function(){var e=Re();return Me(e,!0),e},Re=f.__private__.newObjectDeferred=function(){return q++,H[q]=function(){return V},q},Me=function(e,t){return t="boolean"==typeof t&&t,H[e]=V,t&&J(e+" 0 obj"),e},Be=f.__private__.newAdditionalObject=function(){var e={objId:Re(),content:""};return G.push(e),e},Ue=Re(),ze=Re(),qe=f.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var r=parseFloat(t[0]);t=[r,r,r,"r"]}for(var a="#",n=0;n<3;n++)a+=("0"+Math.floor(255*parseFloat(t[n])).toString(16)).slice(-2);return a},He=f.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var r=e.ch1,a=e.ch2,n=e.ch3,s=e.ch4,i="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof r&&"#"!==r.charAt(0)){var l=new jS(r);if(l.ok)r=l.toHex();else if(!/^\d*\.?\d*$/.test(r))throw new Error('Invalid color "'+r+'" passed to jsPDF.encodeColorString.')}if("string"==typeof r&&/^#[0-9A-Fa-f]{3}$/.test(r)&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),"string"==typeof r&&/^#[0-9A-Fa-f]{6}$/.test(r)){var o=parseInt(r.substr(1),16);r=o>>16&255,a=o>>8&255,n=255&o}if(void 0===a||void 0===s&&r===a&&a===n)t="string"==typeof r?r+" "+i[0]:2===e.precision?C(r/255)+" "+i[0]:_(r/255)+" "+i[0];else if(void 0===s||"object"===(0,sy.A)(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",i[1]].join(" ");t="string"==typeof r?[r,a,n,i[1]].join(" "):2===e.precision?[C(r/255),C(a/255),C(n/255),i[1]].join(" "):[_(r/255),_(a/255),_(n/255),i[1]].join(" ")}else t="string"==typeof r?[r,a,n,s,i[2]].join(" "):2===e.precision?[C(r),C(a),C(n),C(s),i[2]].join(" "):[_(r),_(a),_(n),_(s),i[2]].join(" ");return t},We=f.__private__.getFilters=function(){return i},Ve=f.__private__.putStream=function(e){var t=(e=e||{}).data||"",r=e.filters||We(),a=e.alreadyAppliedFilters||[],n=e.addLength1||!1,s=t.length,i=e.objectId,l=function(e){return e};if(null!==d&&void 0===i)throw new Error("ObjectId must be passed to putStream for file encryption");null!==d&&(l=bt.encryptor(i,0));var o={};!0===r&&(r=["FlateEncode"]);var c=e.additionalKeyValues||[],u=(o=void 0!==XS.API.processDataByFilters?XS.API.processDataByFilters(t,r):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(a)?a.join(" "):a.toString());if(0!==o.data.length&&(c.push({key:"Length",value:o.data.length}),!0===n&&c.push({key:"Length1",value:s})),0!=u.length)if(u.split("/").length-1==1)c.push({key:"Filter",value:u});else{c.push({key:"Filter",value:"["+u+"]"});for(var h=0;h<c.length;h+=1)if("DecodeParms"===c[h].key){for(var f=[],m=0;m<o.reverseChain.split("/").length-1;m+=1)f.push("null");f.push(c[h].value),c[h].value="["+f.join(" ")+"]"}}J("<<");for(var p=0;p<c.length;p++)J("/"+c[p].key+" "+c[p].value);J(">>"),0!==o.data.length&&(J("stream"),J(l(o.data)),J("endstream"))},Ge=f.__private__.putPage=function(e){var t=e.number,r=e.data,a=e.objId,n=e.contentsObjId;Me(a,!0),J("<</Type /Page"),J("/Parent "+e.rootDictionaryObjId+" 0 R"),J("/Resources "+e.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(k(e.mediaBox.bottomLeftX))+" "+parseFloat(k(e.mediaBox.bottomLeftY))+" "+k(e.mediaBox.topRightX)+" "+k(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&J("/CropBox ["+k(e.cropBox.bottomLeftX)+" "+k(e.cropBox.bottomLeftY)+" "+k(e.cropBox.topRightX)+" "+k(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&J("/BleedBox ["+k(e.bleedBox.bottomLeftX)+" "+k(e.bleedBox.bottomLeftY)+" "+k(e.bleedBox.topRightX)+" "+k(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&J("/TrimBox ["+k(e.trimBox.bottomLeftX)+" "+k(e.trimBox.bottomLeftY)+" "+k(e.trimBox.topRightX)+" "+k(e.trimBox.topRightY)+"]"),null!==e.artBox&&J("/ArtBox ["+k(e.artBox.bottomLeftX)+" "+k(e.artBox.bottomLeftY)+" "+k(e.artBox.topRightX)+" "+k(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&J("/UserUnit "+e.userUnit),Ae.publish("putPage",{objId:a,pageContext:Se[t],pageNumber:t,page:r}),J("/Contents "+n+" 0 R"),J(">>"),J("endobj");var s=r.join("\n");return y===v&&(s+="\nQ"),Me(n,!0),Ve({data:s,filters:We(),objectId:n}),J("endobj"),a},Ke=f.__private__.putPages=function(){var e,t,r=[];for(e=1;e<=ke;e++)Se[e].objId=Re(),Se[e].contentsObjId=Re();for(e=1;e<=ke;e++)r.push(Ge({number:e,data:K[e],objId:Se[e].objId,contentsObjId:Se[e].contentsObjId,mediaBox:Se[e].mediaBox,cropBox:Se[e].cropBox,bleedBox:Se[e].bleedBox,trimBox:Se[e].trimBox,artBox:Se[e].artBox,userUnit:Se[e].userUnit,rootDictionaryObjId:Ue,resourceDictionaryObjId:ze}));Me(Ue,!0),J("<</Type /Pages");var a="/Kids [";for(t=0;t<ke;t++)a+=r[t]+" 0 R ";J(a+"]"),J("/Count "+ke),J(">>"),J("endobj"),Ae.publish("postPutPages")},Ye=function(e){Ae.publish("putFont",{font:e,out:J,newObject:Ie,putStream:Ve}),!0!==e.isAlreadyPutted&&(e.objectNumber=Ie(),J("<<"),J("/Type /Font"),J("/BaseFont /"+HS(e.postScriptName)),J("/Subtype /Type1"),"string"==typeof e.encoding&&J("/Encoding /"+e.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},Xe=function(e){e.objectNumber=Ie();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[k(e.x),k(e.y),k(e.x+e.width),k(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var r=e.pages[1].join("\n");Ve({data:r,additionalKeyValues:t,objectId:e.objectNumber}),J("endobj")},$e=function(e,t){t||(t=21);var r=Ie(),a=function(e,t){var r,a=[],n=1/(t-1);for(r=0;r<1;r+=n)a.push(r);if(a.push(1),0!=e[0].offset){var s={offset:0,color:e[0].color};e.unshift(s)}if(1!=e[e.length-1].offset){var i={offset:1,color:e[e.length-1].color};e.push(i)}for(var l="",o=0,c=0;c<a.length;c++){for(r=a[c];r>e[o+1].offset;)o++;var d=e[o].offset,u=(r-d)/(e[o+1].offset-d),h=e[o].color,f=e[o+1].color;l+=z(Math.round((1-u)*h[0]+u*f[0]).toString(16))+z(Math.round((1-u)*h[1]+u*f[1]).toString(16))+z(Math.round((1-u)*h[2]+u*f[2]).toString(16))}return l.trim()}(e.colors,t),n=[];n.push({key:"FunctionType",value:"0"}),n.push({key:"Domain",value:"[0.0 1.0]"}),n.push({key:"Size",value:"["+t+"]"}),n.push({key:"BitsPerSample",value:"8"}),n.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),n.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve({data:a,additionalKeyValues:n,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:r}),J("endobj"),e.objectNumber=Ie(),J("<< /ShadingType "+e.type),J("/ColorSpace /DeviceRGB");var s="/Coords ["+k(parseFloat(e.coords[0]))+" "+k(parseFloat(e.coords[1]))+" ";2===e.type?s+=k(parseFloat(e.coords[2]))+" "+k(parseFloat(e.coords[3])):s+=k(parseFloat(e.coords[2]))+" "+k(parseFloat(e.coords[3]))+" "+k(parseFloat(e.coords[4]))+" "+k(parseFloat(e.coords[5])),J(s+="]"),e.matrix&&J("/Matrix ["+e.matrix.toString()+"]"),J("/Function "+r+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Je=function(e,t){var r=Re(),a=Ie();t.push({resourcesOid:r,objectOid:a}),e.objectNumber=a;var n=[];n.push({key:"Type",value:"/Pattern"}),n.push({key:"PatternType",value:"1"}),n.push({key:"PaintType",value:"1"}),n.push({key:"TilingType",value:"1"}),n.push({key:"BBox",value:"["+e.boundingBox.map(k).join(" ")+"]"}),n.push({key:"XStep",value:k(e.xStep)}),n.push({key:"YStep",value:k(e.yStep)}),n.push({key:"Resources",value:r+" 0 R"}),e.matrix&&n.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Ve({data:e.stream,additionalKeyValues:n,objectId:e.objectNumber}),J("endobj")},Qe=function(e){for(var t in e.objectNumber=Ie(),J("<<"),e)switch(t){case"opacity":J("/ca "+C(e[t]));break;case"stroke-opacity":J("/CA "+C(e[t]))}J(">>"),J("endobj")},Ze=function(e){Me(e.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in J("/Font <<"),ge)ge.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&J("/"+e+" "+ge[e].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(ve).length>0){for(var e in J("/Shading <<"),ve)ve.hasOwnProperty(e)&&ve[e]instanceof KS&&ve[e].objectNumber>=0&&J("/"+e+" "+ve[e].objectNumber+" 0 R");Ae.publish("putShadingPatternDict"),J(">>")}}(),function(e){if(Object.keys(ve).length>0){for(var t in J("/Pattern <<"),ve)ve.hasOwnProperty(t)&&ve[t]instanceof f.TilingPattern&&ve[t].objectNumber>=0&&ve[t].objectNumber<e&&J("/"+t+" "+ve[t].objectNumber+" 0 R");Ae.publish("putTilingPatternDict"),J(">>")}}(e.objectOid),function(){if(Object.keys(we).length>0){var e;for(e in J("/ExtGState <<"),we)we.hasOwnProperty(e)&&we[e].objectNumber>=0&&J("/"+e+" "+we[e].objectNumber+" 0 R");Ae.publish("putGStateDict"),J(">>")}}(),function(){for(var e in J("/XObject <<"),_e)_e.hasOwnProperty(e)&&_e[e].objectNumber>=0&&J("/"+e+" "+_e[e].objectNumber+" 0 R");Ae.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},et=function(e){xe[e.fontName]=xe[e.fontName]||{},xe[e.fontName][e.fontStyle]=e.id},tt=function(e,t,r,a,n){var s={id:"F"+(Object.keys(ge).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:r,encoding:a,isStandardFont:n||!1,metadata:{}};return Ae.publish("addFont",{font:s,instance:this}),ge[s.id]=s,et(s),s.id},rt=f.__private__.pdfEscape=f.pdfEscape=function(e,t){return function(e,t){var r,a,n,s,i,l,o,c,d;if(n=(t=t||{}).sourceEncoding||"Unicode",i=t.outputEncoding,(t.autoencode||i)&&ge[ue].metadata&&ge[ue].metadata[n]&&ge[ue].metadata[n].encoding&&(s=ge[ue].metadata[n].encoding,!i&&ge[ue].encoding&&(i=ge[ue].encoding),!i&&s.codePages&&(i=s.codePages[0]),"string"==typeof i&&(i=s[i]),i)){for(o=!1,l=[],r=0,a=e.length;r<a;r++)(c=i[e.charCodeAt(r)])?l.push(String.fromCharCode(c)):l.push(e[r]),l[r].charCodeAt(0)>>8&&(o=!0);e=l.join("")}for(r=e.length;void 0===o&&0!==r;)e.charCodeAt(r-1)>>8&&(o=!0),r--;if(!o)return e;for(l=t.noBOM?[]:[254,255],r=0,a=e.length;r<a;r++){if((d=(c=e.charCodeAt(r))>>8)>>8)throw new Error("Character at position "+r+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");l.push(d),l.push(c-(d<<8))}return String.fromCharCode.apply(void 0,l)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},at=f.__private__.beginPage=function(e){K[++ke]=[],Se[ke]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},it(ke),$(K[B])},nt=function(e,t){var a,s,i;switch(r=t||r,"string"==typeof e&&(a=x(e.toLowerCase()),Array.isArray(a)&&(s=a[0],i=a[1])),Array.isArray(e)&&(s=e[0]*he,i=e[1]*he),isNaN(s)&&(s=n[0],i=n[1]),(s>14400||i>14400)&&(bS.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),i=Math.min(14400,i)),n=[s,i],r.substr(0,1)){case"l":i>s&&(n=[i,s]);break;case"p":s>i&&(n=[i,s])}at(n),Mt(It),J(Gt),0!==Qt&&J(Qt+" J"),0!==Zt&&J(Zt+" j"),Ae.publish("addPage",{pageNumber:ke})},st=function(e){e>0&&e<=ke&&(K.splice(e,1),Se.splice(e,1),ke--,B>ke&&(B=ke),this.setPage(B))},it=function(e){e>0&&e<=ke&&(B=e)},lt=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return K.length-1},ot=function(e,t,r){var a,n=void 0;return r=r||{},e=void 0!==e?e:ge[ue].fontName,t=void 0!==t?t:ge[ue].fontStyle,a=e.toLowerCase(),void 0!==xe[a]&&void 0!==xe[a][t]?n=xe[a][t]:void 0!==xe[e]&&void 0!==xe[e][t]?n=xe[e][t]:!1===r.disableWarning&&bS.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),n||r.noFallback||null==(n=xe.times[t])&&(n=xe.times.normal),n},ct=f.__private__.putInfo=function(){var e=Ie(),t=function(e){return e};for(var r in null!==d&&(t=bt.encryptor(e,0)),J("<<"),J("/Producer ("+rt(t("jsPDF "+XS.version))+")"),de)de.hasOwnProperty(r)&&de[r]&&J("/"+r.substr(0,1).toUpperCase()+r.substr(1)+" ("+rt(t(de[r]))+")");J("/CreationDate ("+rt(t(L))+")"),J(">>"),J("endobj")},dt=f.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||Ue;switch(Ie(),J("<<"),J("/Type /Catalog"),J("/Pages "+t+" 0 R"),re||(re="fullwidth"),re){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+re;"%"===r.substr(r.length-1)&&(re=parseInt(re)/100),"number"==typeof re&&J("/OpenAction [3 0 R /XYZ null null "+C(re)+"]")}switch(le||(le="continuous"),le){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}se&&J("/PageMode /"+se),Ae.publish("putCatalog"),J(">>"),J("endobj")},ut=f.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(q+1)),J("/Root "+q+" 0 R"),J("/Info "+(q-1)+" 0 R"),null!==d&&J("/Encrypt "+bt.oid+" 0 R"),J("/ID [ <"+P+"> <"+P+"> ]"),J(">>")},ht=f.__private__.putHeader=function(){J("%PDF-"+m),J("%\xba\xdf\xac\xe0")},ft=f.__private__.putXRef=function(){var e="0000000000";J("xref"),J("0 "+(q+1)),J("0000000000 65535 f ");for(var t=1;t<=q;t++)"function"==typeof H[t]?J((e+H[t]()).slice(-10)+" 00000 n "):void 0!==H[t]?J((e+H[t]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},mt=f.__private__.buildDocument=function(){var e;q=0,V=0,W=[],H=[],G=[],Ue=Re(),ze=Re(),$(W),Ae.publish("buildDocument"),ht(),Ke(),function(){Ae.publish("putAdditionalObjects");for(var e=0;e<G.length;e++){var t=G[e];Me(t.objId,!0),J(t.content),J("endobj")}Ae.publish("postPutAdditionalObjects")}(),e=[],function(){for(var e in ge)ge.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&Ye(ge[e])}(),function(){var e;for(e in we)we.hasOwnProperty(e)&&Qe(we[e])}(),function(){for(var e in _e)_e.hasOwnProperty(e)&&Xe(_e[e])}(),function(e){var t;for(t in ve)ve.hasOwnProperty(t)&&(ve[t]instanceof KS?$e(ve[t]):ve[t]instanceof YS&&Je(ve[t],e))}(e),Ae.publish("putResources"),e.forEach(Ze),Ze({resourcesOid:ze,objectOid:Number.MAX_SAFE_INTEGER}),Ae.publish("postPutResources"),null!==d&&(bt.oid=Ie(),J("<<"),J("/Filter /Standard"),J("/V "+bt.v),J("/R "+bt.r),J("/U <"+bt.toHexString(bt.U)+">"),J("/O <"+bt.toHexString(bt.O)+">"),J("/P "+bt.P),J(">>"),J("endobj")),ct(),dt();var t=V;return ft(),ut(),J("startxref"),J(""+t),J("%%EOF"),$(K[B]),W.join("\n")},pt=f.__private__.getBlob=function(e){return new Blob([Z(e)],{type:"application/pdf"})},gt=f.output=f.__private__.output=(De=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return mt();case"save":f.save(t.filename);break;case"arraybuffer":return Z(mt());case"blob":return pt(mt());case"bloburi":case"bloburl":if(void 0!==gS.URL&&"function"==typeof gS.URL.createObjectURL)return gS.URL&&gS.URL.createObjectURL(pt(mt()))||void 0;bS.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var r="",a=mt();try{r=SS(a)}catch(d){r=SS(unescape(encodeURIComponent(a)))}return"data:application/pdf;filename="+t.filename+";base64,"+r;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(gS)){var n="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(n=t.pdfObjectUrl,s="");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+n+'"'+s+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",l=gS.open();return null!==l&&l.document.write(i),l}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(gS)){var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=gS.open();if(null!==c){c.document.write(o);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(gS))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',m=gS.open();if(null!==m&&(m.document.write(h),m.document.title=t.filename),m||"undefined"==typeof safari)return m;break;case"datauri":case"dataurl":return gS.document.location.href=this.output("datauristring",t);default:return null}},De.foo=function(){try{return De.apply(this,arguments)}catch(t){var e=t.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var r="Error in function "+e.split("\n")[0].split("<")[0]+": "+t.message;if(!gS.console)throw new Error(r);gS.console.error(r,t),gS.alert&&alert(r)}},De.foo.bar=De,De.foo),xt=function(e){return!0===Array.isArray(Ce)&&Ce.indexOf(e)>-1};switch(a){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=1==xt("px_scaling")?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if("number"!=typeof a)throw new Error("Invalid unit: "+a);he=a}var bt=null;R(),F();var vt=f.__private__.getPageInfo=f.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Se[e].objId,pageNumber:e,pageContext:Se[e]}},yt=f.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Se)if(Se[t].objId===e)break;return vt(t)},wt=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Se[B].objId,pageNumber:B,pageContext:Se[B]}};f.addPage=function(){return nt.apply(this,arguments),this},f.setPage=function(){return it.apply(this,arguments),$.call(this,K[B]),this},f.insertPage=function(e){return this.addPage(),this.movePage(B,e),this},f.movePage=function(e,t){var r,a;if(e>t){r=K[e],a=Se[e];for(var n=e;n>t;n--)K[n]=K[n-1],Se[n]=Se[n-1];K[t]=r,Se[t]=a,this.setPage(t)}else if(e<t){r=K[e],a=Se[e];for(var s=e;s<t;s++)K[s]=K[s+1],Se[s]=Se[s+1];K[t]=r,Se[t]=a,this.setPage(t)}return this},f.deletePage=function(){return st.apply(this,arguments),this},f.__private__.text=f.text=function(e,t,r,a,n){var s,i,l,o,c,d,u,f,m,p=(a=a||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof r||Array.isArray(r))){var g=r;r=t,t=e,e=g}if(arguments[3]instanceof Le==0?(l=arguments[4],o=arguments[5],"object"===(0,sy.A)(u=arguments[3])&&null!==u||("string"==typeof l&&(o=l,l=null),"string"==typeof u&&(o=u,u=null),"number"==typeof u&&(l=u,u=null),a={flags:u,angle:l,align:o})):(S("The transform parameter of text() with a Matrix value"),m=n),isNaN(t)||isNaN(r)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return p;var x,b="",w="number"==typeof a.lineHeightFactor?a.lineHeightFactor:Dt,N=p.internal.scaleFactor;function j(e){return e=e.split("\t").join(Array(a.TabLen||9).join(" ")),rt(e,u)}function A(e){for(var t,r=e.concat(),a=[],n=r.length;n--;)"string"==typeof(t=r.shift())?a.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?a.push(t[0]):a.push([t[0],t[1],t[2]]);return a}function C(e,t){var r;if("string"==typeof e)r=t(e)[0];else if(Array.isArray(e)){for(var a,n,s=e.concat(),i=[],l=s.length;l--;)"string"==typeof(a=s.shift())?i.push(t(a)[0]):Array.isArray(a)&&"string"==typeof a[0]&&(n=t(a[0],a[1],a[2]),i.push([n[0],n[1],n[2]]));r=i}return r}var _=!1,E=!0;if("string"==typeof e)_=!0;else if(Array.isArray(e)){var L=e.concat();i=[];for(var P,O=L.length;O--;)("string"!=typeof(P=L.shift())||Array.isArray(P)&&"string"!=typeof P[0])&&(E=!1);_=E}if(!1===_)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var F=te/p.internal.scaleFactor,D=F*(w-1);switch(a.baseline){case"bottom":r-=D;break;case"top":r+=F-D;break;case"hanging":r+=F-2*D;break;case"middle":r+=F/2-D}if((d=a.maxWidth||0)>0&&("string"==typeof e?e=p.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(p.splitTextToSize(t,d))},[]))),s={text:e,x:t,y:r,options:a,mutex:{pdfEscape:rt,activeFontKey:ue,fonts:ge,activeFontSize:te}},Ae.publish("preProcessText",s),e=s.text,l=(a=s.options).angle,m instanceof Le==0&&l&&"number"==typeof l){l*=Math.PI/180,0===a.rotationDirection&&(l=-l),y===v&&(l=-l);var I=Math.cos(l),R=Math.sin(l);m=new Le(I,R,-R,I,0,0)}else l&&l instanceof Le&&(m=l);y!==v||m||(m=Oe),void 0!==(c=a.charSpace||$t)&&(b+=k(T(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=a.horizontalScale)&&(b+=k(100*f)+" Tz\n"),a.lang;var M=-1,B=void 0!==a.renderingMode?a.renderingMode:a.stroke,U=p.internal.getCurrentPageInfo().pageContext;switch(B){case 0:case!1:case"fill":M=0;break;case 1:case!0:case"stroke":M=1;break;case 2:case"fillThenStroke":M=2;break;case 3:case"invisible":M=3;break;case 4:case"fillAndAddForClipping":M=4;break;case 5:case"strokeAndAddPathForClipping":M=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":M=6;break;case 7:case"addToPathForClipping":M=7}var z=void 0!==U.usedRenderingMode?U.usedRenderingMode:-1;-1!==M?b+=M+" Tr\n":-1!==z&&(b+="0 Tr\n"),-1!==M&&(U.usedRenderingMode=M),o=a.align||"left";var q,H=te*w,W=p.internal.pageSize.getWidth(),V=ge[ue];c=a.charSpace||$t,d=a.maxWidth||0,u=Object.assign({autoencode:!0,noBOM:!0},a.flags);var G=[],K=function(e){return p.getStringUnitWidth(e,{font:V,charSpace:c,fontSize:te,doKerning:!1})*te/N};if("[object Array]"===Object.prototype.toString.call(e)){var Y;i=A(e),"left"!==o&&(q=i.map(K));var X,$=0;if("right"===o){t-=q[0],e=[],O=i.length;for(var Q=0;Q<O;Q++)0===Q?(X=qt(t),Y=Ht(r)):(X=T($-q[Q]),Y=-H),e.push([i[Q],X,Y]),$=q[Q]}else if("center"===o){t-=q[0]/2,e=[],O=i.length;for(var Z=0;Z<O;Z++)0===Z?(X=qt(t),Y=Ht(r)):(X=T(($-q[Z])/2),Y=-H),e.push([i[Z],X,Y]),$=q[Z]}else if("left"===o){e=[],O=i.length;for(var ee=0;ee<O;ee++)e.push(i[ee])}else if("justify"===o&&"Identity-H"===V.encoding){e=[],O=i.length,d=0!==d?d:W;for(var re=0,ae=0;ae<O;ae++)if(Y=0===ae?Ht(r):-H,X=0===ae?qt(t):re,ae<O-1){var se=T((d-q[ae])/(i[ae].split(" ").length-1)),ie=i[ae].split(" ");e.push([ie[0]+" ",X,Y]),re=0;for(var le=1;le<ie.length;le++){var oe=(K(ie[le-1]+" "+ie[le])-K(ie[le]))*N+se;le==ie.length-1?e.push([ie[le],oe,0]):e.push([ie[le]+" ",oe,0]),re-=oe}}else e.push([i[ae],X,Y]);e.push(["",re,0])}else{if("justify"!==o)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],O=i.length,d=0!==d?d:W,ae=0;ae<O;ae++){Y=0===ae?Ht(r):-H,X=0===ae?qt(t):0;var ce=i[ae].split(" ").length-1,de=ce>0?(d-q[ae])/ce:0;ae<O-1?G.push(k(T(de))):G.push(0),e.push([i[ae],X,Y])}}}!0===("boolean"==typeof a.R2L?a.R2L:ne)&&(e=C(e,function(e,t,r){return[e.split("").reverse().join(""),t,r]})),s={text:e,x:t,y:r,options:a,mutex:{pdfEscape:rt,activeFontKey:ue,fonts:ge,activeFontSize:te}},Ae.publish("postProcessText",s),e=s.text,x=s.mutex.isHex||!1;var he=ge[ue].encoding;"WinAnsiEncoding"!==he&&"StandardEncoding"!==he||(e=C(e,function(e,t,r){return[j(e),t,r]})),i=A(e),e=[];for(var fe,me,pe,xe=Array.isArray(i[0])?1:0,be="",ve=function(e,t,r){var n="";return r instanceof Le?(r="number"==typeof a.angle?Pe(r,new Le(1,0,0,1,e,t)):Pe(new Le(1,0,0,1,e,t),r),y===v&&(r=Pe(new Le(1,0,0,-1,0,0),r)),n=r.join(" ")+" Tm\n"):n=k(e)+" "+k(t)+" Td\n",n},ye=0;ye<i.length;ye++){switch(be="",xe){case 1:pe=(x?"<":"(")+i[ye][0]+(x?">":")"),fe=parseFloat(i[ye][1]),me=parseFloat(i[ye][2]);break;case 0:pe=(x?"<":"(")+i[ye]+(x?">":")"),fe=qt(t),me=Ht(r)}void 0!==G&&void 0!==G[ye]&&(be=G[ye]+" Tw\n"),0===ye?e.push(be+ve(fe,me,m)+pe):0===xe?e.push(be+pe):1===xe&&e.push(be+ve(fe,me,m)+pe)}e=0===xe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var we="BT\n/";return we+=ue+" "+te+" Tf\n",we+=k(te*w)+" TL\n",we+=Yt+"\n",we+=b,we+=e,J(we+="ET"),h[ue]=!0,p};var Nt=f.__private__.clip=f.clip=function(e){return J("evenodd"===e?"W*":"W"),this};f.clipEvenOdd=function(){return Nt("evenodd")},f.__private__.discardPath=f.discardPath=function(){return J("n"),this};var jt=f.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(e){return jt(e)&&(c=e),this};var kt=f.__private__.getStyle=f.getStyle=function(e){var t=c;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},St=f.close=function(){return J("h"),this};f.stroke=function(){return J("S"),this},f.fill=function(e){return At("f",e),this},f.fillEvenOdd=function(e){return At("f*",e),this},f.fillStroke=function(e){return At("B",e),this},f.fillStrokeEvenOdd=function(e){return At("B*",e),this};var At=function(e,t){"object"===(0,sy.A)(t)?Tt(t,e):J(e)},Ct=function(e){null===e||y===v&&void 0===e||(e=kt(e),J(e))};function _t(e,t,r,a,n){var s=new YS(t||this.boundingBox,r||this.xStep,a||this.yStep,this.gState,n||this.matrix);s.stream=this.stream;var i=e+"$$"+this.cloneIndex+++"$$";return Fe(i,s),s}var Tt=function(e,t){var r=ye[e.key],a=ve[r];if(a instanceof KS)J("q"),J(Et(t)),a.gState&&f.setGState(a.gState),J(e.matrix.toString()+" cm"),J("/"+r+" sh"),J("Q");else if(a instanceof YS){var n=new Le(1,0,0,-1,0,hr());e.matrix&&(n=n.multiply(e.matrix||Oe),r=_t.call(a,e.key,e.boundingBox,e.xStep,e.yStep,n).id),J("q"),J("/Pattern cs"),J("/"+r+" scn"),a.gState&&f.setGState(a.gState),J(t),J("Q")}},Et=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Lt=f.moveTo=function(e,t){return J(k(T(e))+" "+k(E(t))+" m"),this},Pt=f.lineTo=function(e,t){return J(k(T(e))+" "+k(E(t))+" l"),this},Ot=f.curveTo=function(e,t,r,a,n,s){return J([k(T(e)),k(E(t)),k(T(r)),k(E(a)),k(T(n)),k(E(s)),"c"].join(" ")),this};f.__private__.line=f.line=function(e,t,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||!jt(n))throw new Error("Invalid arguments passed to jsPDF.line");return y===b?this.lines([[r-e,a-t]],e,t,[1,1],n||"S"):this.lines([[r-e,a-t]],e,t,[1,1]).stroke()},f.__private__.lines=f.lines=function(e,t,r,a,n,s){var i,l,o,c,d,u,h,f,m,p,g,x;if("number"==typeof e&&(x=r,r=t,t=e,e=x),a=a||[1,1],s=s||!1,isNaN(t)||isNaN(r)||!Array.isArray(e)||!Array.isArray(a)||!jt(n)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(Lt(t,r),i=a[0],l=a[1],c=e.length,p=t,g=r,o=0;o<c;o++)2===(d=e[o]).length?(p=d[0]*i+p,g=d[1]*l+g,Pt(p,g)):(u=d[0]*i+p,h=d[1]*l+g,f=d[2]*i+p,m=d[3]*l+g,p=d[4]*i+p,g=d[5]*l+g,Ot(u,h,f,m,p,g));return s&&St(),Ct(n),this},f.path=function(e){for(var t=0;t<e.length;t++){var r=e[t],a=r.c;switch(r.op){case"m":Lt(a[0],a[1]);break;case"l":Pt(a[0],a[1]);break;case"c":Ot.apply(this,a);break;case"h":St()}}return this},f.__private__.rect=f.rect=function(e,t,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||!jt(n))throw new Error("Invalid arguments passed to jsPDF.rect");return y===b&&(a=-a),J([k(T(e)),k(E(t)),k(T(r)),k(T(a)),"re"].join(" ")),Ct(n),this},f.__private__.triangle=f.triangle=function(e,t,r,a,n,s,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s)||!jt(i))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-e,a-t],[n-r,s-a],[e-n,t-s]],e,t,[1,1],i,!0),this},f.__private__.roundedRect=f.roundedRect=function(e,t,r,a,n,s,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s)||!jt(i))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var l=4/3*(Math.SQRT2-1);return n=Math.min(n,.5*r),s=Math.min(s,.5*a),this.lines([[r-2*n,0],[n*l,0,n,s-s*l,n,s],[0,a-2*s],[0,s*l,-n*l,s,-n,s],[2*n-r,0],[-n*l,0,-n,-s*l,-n,-s],[0,2*s-a],[0,-s*l,n*l,-s,n,-s]],e+n,t,[1,1],i,!0),this},f.__private__.ellipse=f.ellipse=function(e,t,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||!jt(n))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*r,i=4/3*(Math.SQRT2-1)*a;return Lt(e+r,t),Ot(e+r,t-i,e+s,t-a,e,t-a),Ot(e-s,t-a,e-r,t-i,e-r,t),Ot(e-r,t+i,e-s,t+a,e,t+a),Ot(e+s,t+a,e+r,t+i,e+r,t),Ct(n),this},f.__private__.circle=f.circle=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||!jt(a))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,r,r,a)},f.setFont=function(e,t,r){return r&&(t=j(t,r)),ue=ot(e,t,{disableWarning:!1}),this};var Ft=f.__private__.getFont=f.getFont=function(){return ge[ot.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var e,t,r={};for(e in xe)if(xe.hasOwnProperty(e))for(t in r[e]=[],xe[e])xe[e].hasOwnProperty(t)&&r[e].push(t);return r},f.addFont=function(e,t,r,a,n){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?n=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(r=j(r,a)),tt.call(this,e,t,r,n=n||"Identity-H")};var Dt,It=e.lineWidth||.200025,Rt=f.__private__.getLineWidth=f.getLineWidth=function(){return It},Mt=f.__private__.setLineWidth=f.setLineWidth=function(e){return It=e,J(k(T(e))+" w"),this};f.__private__.setLineDash=XS.API.setLineDash=XS.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return k(T(e))}).join(" "),t=k(T(t)),J("["+e+"] "+t+" d"),this};var Bt=f.__private__.getLineHeight=f.getLineHeight=function(){return te*Dt};f.__private__.getLineHeight=f.getLineHeight=function(){return te*Dt};var Ut=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Dt=e),this},zt=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Dt};Ut(e.lineHeight);var qt=f.__private__.getHorizontalCoordinate=function(e){return T(e)},Ht=f.__private__.getVerticalCoordinate=function(e){return y===v?e:Se[B].mediaBox.topRightY-Se[B].mediaBox.bottomLeftY-T(e)},Wt=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(e){return k(qt(e))},Vt=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(e){return k(Ht(e))},Gt=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return qe(Gt)},f.__private__.setStrokeColor=f.setDrawColor=function(e,t,r,a){return Gt=He({ch1:e,ch2:t,ch3:r,ch4:a,pdfColorType:"draw",precision:2}),J(Gt),this};var Kt=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return qe(Kt)},f.__private__.setFillColor=f.setFillColor=function(e,t,r,a){return Kt=He({ch1:e,ch2:t,ch3:r,ch4:a,pdfColorType:"fill",precision:2}),J(Kt),this};var Yt=e.textColor||"0 g",Xt=f.__private__.getTextColor=f.getTextColor=function(){return qe(Yt)};f.__private__.setTextColor=f.setTextColor=function(e,t,r,a){return Yt=He({ch1:e,ch2:t,ch3:r,ch4:a,pdfColorType:"text",precision:3}),this};var $t=e.charSpace,Jt=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat($t||0)};f.__private__.setCharSpace=f.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return $t=e,this};var Qt=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qt=t,J(t+" J"),this};var Zt=0;f.__private__.setLineJoin=f.setLineJoin=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zt=t,J(t+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(k(T(e))+" M"),this},f.GState=VS,f.setGState=function(e){(e="string"==typeof e?we[Ne[e]]:er(null,e)).equals(je)||(J("/"+e.id+" gs"),je=e)};var er=function(e,t){if(!e||!Ne[e]){var r=!1;for(var a in we)if(we.hasOwnProperty(a)&&we[a].equals(t)){r=!0;break}if(r)t=we[a];else{var n="GS"+(Object.keys(we).length+1).toString(10);we[n]=t,t.id=n}return e&&(Ne[e]=t.id),Ae.publish("addGState",t),t}};f.addGState=function(e,t){return er(e,t),this},f.saveGraphicsState=function(){return J("q"),be.push({key:ue,size:te,color:Yt}),this},f.restoreGraphicsState=function(){J("Q");var e=be.pop();return ue=e.key,te=e.size,Yt=e.color,je=null,this},f.setCurrentTransformationMatrix=function(e){return J(e.toString()+" cm"),this},f.comment=function(e){return J("#"+e),this};var tr=function(e,t){var r=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var a=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var n="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return n},set:function(e){n=e.toString()}}),this},rr=function(e,t,r,a){tr.call(this,e,t),this.type="rect";var n=r||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var s=a||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}}),this},ar=function(){this.page=ke,this.currentPage=B,this.pages=K.slice(0),this.pagesContext=Se.slice(0),this.x=fe,this.y=me,this.matrix=pe,this.width=ir(B),this.height=or(B),this.outputDestination=X,this.id="",this.objectNumber=-1};ar.prototype.restore=function(){ke=this.page,B=this.currentPage,Se=this.pagesContext,K=this.pages,fe=this.x,me=this.y,pe=this.matrix,lr(B,this.width),cr(B,this.height),X=this.outputDestination};var nr=function(e,t,r,a,n){Ee.push(new ar),ke=B=0,K=[],fe=e,me=t,pe=n,at([r,a])};for(var sr in f.beginFormObject=function(e,t,r,a,n){return nr(e,t,r,a,n),this},f.endFormObject=function(e){return function(e){if(Te[e])Ee.pop().restore();else{var t=new ar,r="Xo"+(Object.keys(_e).length+1).toString(10);t.id=r,Te[e]=r,_e[r]=t,Ae.publish("addFormObject",t),Ee.pop().restore()}}(e),this},f.doFormObject=function(e,t){var r=_e[Te[e]];return J("q"),J(t.toString()+" cm"),J("/"+r.id+" Do"),J("Q"),this},f.getFormObject=function(e){var t=_e[Te[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},f.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(NS(pt(mt()),e),"function"==typeof NS.unload&&gS.setTimeout&&setTimeout(NS.unload,911),this):new Promise(function(t,r){try{var n=NS(pt(mt()),e);"function"==typeof NS.unload&&gS.setTimeout&&setTimeout(NS.unload,911),t(n)}catch(a){r(a.message)}})},XS.API)XS.API.hasOwnProperty(sr)&&("events"===sr&&XS.API.events.length?function(e,t){var r,a,n;for(n=t.length-1;-1!==n;n--)r=t[n][0],a=t[n][1],e.subscribe.apply(e,[r].concat("function"==typeof a?[a]:a))}(Ae,XS.API.events):f[sr]=XS.API[sr]);function ir(e){return Se[e].mediaBox.topRightX-Se[e].mediaBox.bottomLeftX}function lr(e,t){Se[e].mediaBox.topRightX=t+Se[e].mediaBox.bottomLeftX}function or(e){return Se[e].mediaBox.topRightY-Se[e].mediaBox.bottomLeftY}function cr(e,t){Se[e].mediaBox.topRightY=t+Se[e].mediaBox.bottomLeftY}var dr=f.getPageWidth=function(e){return ir(e=e||B)/he},ur=f.setPageWidth=function(e,t){lr(e,t*he)},hr=f.getPageHeight=function(e){return or(e=e||B)/he},fr=f.setPageHeight=function(e,t){cr(e,t*he)};return f.internal={pdfEscape:rt,getStyle:kt,getFont:Ft,getFontSize:ae,getCharSpace:Jt,getTextColor:Xt,getLineHeight:Bt,getLineHeightFactor:zt,getLineWidth:Rt,write:Q,getHorizontalCoordinate:qt,getVerticalCoordinate:Ht,getCoordinateString:Wt,getVerticalCoordinateString:Vt,collections:{},newObject:Ie,newAdditionalObject:Be,newObjectDeferred:Re,newObjectDeferredBegin:Me,getFilters:We,putStream:Ve,events:Ae,scaleFactor:he,pageSize:{getWidth:function(){return dr(B)},setWidth:function(e){ur(B,e)},getHeight:function(){return hr(B)},setHeight:function(e){fr(B,e)}},encryptionOptions:d,encryption:bt,getEncryptor:function(e){return null!==d?bt.encryptor(e,0):function(e){return e}},output:gt,getNumberOfPages:lt,get pages(){return K},out:J,f2:C,f3:_,getPageInfo:vt,getPageInfoByObjId:yt,getCurrentPageInfo:wt,getPDFVersion:p,Point:tr,Rectangle:rr,Matrix:Le,hasHotfix:xt},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return dr(B)},set:function(e){ur(B,e)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return hr(B)},set:function(e){fr(B,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,r=ee.length;t<r;t++){var a=tt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===u&&(h[a]=!0);var n=e[t][0].split("-");et({id:a,fontName:n[0],fontStyle:n[1]||""})}Ae.publish("addFonts",{fonts:ge,dictionary:xe})}.call(f,ee),ue="F1",nt(n,r),Ae.publish("initialized"),f}qS.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},qS.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},qS.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},qS.prototype.processOwnerPassword=function(e,t){return US(RS(t).substr(0,5),e)},qS.prototype.encryptor=function(e,t){var r=RS(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return US(r,e)}},VS.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||(0,sy.A)(e)!==(0,sy.A)(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return 0===a},XS.API={events:[]},XS.version="3.0.4";var $S=XS.API,JS=1,QS=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ZS=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},eA=function(e){return e.toFixed(2)},tA=function(e){return e.toFixed(5)};$S.__acroform__={};var rA=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},aA=function(e){return e*JS},nA=function(e){var t=new yA,r=FA.internal.getHeight(e)||0,a=FA.internal.getWidth(e)||0;return t.BBox=[0,0,Number(eA(a)),Number(eA(r))],t},sA=$S.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},iA=$S.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},lA=$S.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},oA=$S.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return lA(e,t-1)},cA=$S.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return sA(e,t-1)},dA=$S.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return iA(e,t-1)},uA=$S.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],s=e[1],i=e[2],l=e[3],o={};return o.lowerLeft_X=r(n)||0,o.lowerLeft_Y=a(s+l)||0,o.upperRight_X=r(n+i)||0,o.upperRight_Y=a(s)||0,[Number(eA(o.lowerLeft_X)),Number(eA(o.lowerLeft_Y)),Number(eA(o.upperRight_X)),Number(eA(o.upperRight_Y))]},hA=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=fA(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+eA(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=nA(e);return s.scope=e.scope,s.stream=t.join("\n"),s}},fA=function(e,t){var r=0===e.fontSize?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(e){return e.split("\n")}):n.map(function(e){return[e]});var s=r,i=FA.internal.getHeight(e)||0;i=i<0?-i:i;var l=FA.internal.getWidth(e)||0;l=l<0?-l:l;var o=function(t,r,a){if(t+1<n.length){var s=r+" "+n[t+1][0];return mA(s,e,a).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var c,d,u=mA("3",e,s).height,h=e.multiline?i-s:(i-u)/2,f=h+=2,m=0,p=0,g=0;if(s<=0){t="(...) Tj\n",t+="% Width of Text: "+mA(t,e,s=12).width+", FieldWidth:"+l+"\n";break}for(var x="",b=0,v=0;v<n.length;v++)if(n.hasOwnProperty(v)){var y=!1;if(1!==n[v].length&&g!==n[v].length-1){if((u+2)*(b+2)+2>i)continue e;x+=n[v][g],y=!0,p=v,v--}else{x=" "==(x+=n[v][g]+" ").substr(x.length-1)?x.substr(0,x.length-1):x;var w=parseInt(v),N=o(w,x,s),j=v>=n.length-1;if(N&&!j){x+=" ",g=0;continue}if(N||j){if(j)p=w;else if(e.multiline&&(u+2)*(b+2)+2>i)continue e}else{if(!e.multiline)continue e;if((u+2)*(b+2)+2>i)continue e;p=w}}for(var k="",S=m;S<=p;S++){var A=n[S];if(e.multiline){if(S===p){k+=A[g]+" ",g=(g+1)%A.length;continue}if(S===m){k+=A[A.length-1]+" ";continue}}k+=A[0]+" "}switch(k=" "==k.substr(k.length-1)?k.substr(0,k.length-1):k,d=mA(k,e,s).width,e.textAlign){case"right":c=l-d-2;break;case"center":c=(l-d)/2;break;default:c=2}t+=eA(c)+" "+eA(f)+" Td\n",t+="("+QS(k)+") Tj\n",t+=-eA(c)+" 0 Td\n",f=-(s+2),d=0,m=y?p:p+1,b++,x=""}break}return a.text=t,a.fontSize=s,a},mA=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},pA={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gA=function(e,t){var r={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===r.type&&e.object===r.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},xA=$S.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(e){return e};if(Array.isArray(e)){for(var n="[",s=0;s<e.length;s++)switch(0!==s&&(n+=" "),(0,sy.A)(e[s])){case"boolean":case"number":case"object":n+=e[s].toString();break;case"string":"/"!==e[s].substr(0,1)?(void 0!==t&&r&&(a=r.internal.getEncryptor(t)),n+="("+QS(a(e[s].toString()))+")"):n+=e[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},bA=function(e,t,r){var a=function(e){return e};return void 0!==t&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+QS(a(e))+")"},vA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};vA.prototype.toString=function(){return this.objId+" 0 R"},vA.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},vA.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var r in t)if(!1===Object.getOwnPropertyDescriptor(this,t[r]).configurable){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:xA(n,this.objId,this.scope)}):n instanceof vA?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):"function"!=typeof n&&e.push({key:a,value:n}))}return e};var yA=function(){vA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};rA(yA,vA);var wA=function(){vA.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+QS(t(e))+")"}},set:function(t){e=t}})};rA(wA,vA);var NA=function e(){vA.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(t,3))},set:function(e){!0===Boolean(e)?this.F=cA(t,3):this.F=dA(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');r=e}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==a.length)return a},set:function(e){a=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(e){a[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(e){a[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(e){a[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(e){a[3]=e}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof EA)return;s="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+QS(t(s))+")"},set:function(e){s=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(e){s=e}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var o=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/JS:c},set:function(e){c=e}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){d=e}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof EA||this instanceof PA))return bA(u,this.objId,this.scope)},set:function(e){e=e.toString(),u=e}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof CA==0?bA(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof CA==0?"("===e.substr(0,1)?ZS(e.substr(1,e.length-2)):ZS(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof CA==1?ZS(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof CA==1?"/"+e:e}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof CA==0?bA(f,this.objId,this.scope):f},set:function(e){e=e.toString(),f=this instanceof CA==0?"("===e.substr(0,1)?ZS(e.substr(1,e.length-2)):ZS(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof CA==1?ZS(f.substr(1,f.length-1)):f},set:function(e){e=e.toString(),f=this instanceof CA==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(e){e=Boolean(e),p=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(e){m=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,1):this.Ff=dA(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,2):this.Ff=dA(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,3):this.Ff=dA(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');g=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(g){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};rA(NA,vA);var jA=function(){NA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return xA(t,this.objId,this.scope)},set:function(e){var r,a;a=[],"string"==typeof(r=e)&&(a=function(e,t,r){r||(r=1);for(var a,n=[];a=t.exec(e);)n.push(a[r]);return n}(r,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,r){for(r=r||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,18):this.Ff=dA(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=cA(this.Ff,19):this.Ff=dA(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=cA(this.Ff,20),t.sort()):this.Ff=dA(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,22):this.Ff=dA(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,23):this.Ff=dA(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,27):this.Ff=dA(this.Ff,27)}}),this.hasAppearanceStream=!1};rA(jA,NA);var kA=function(){jA.call(this),this.fontName="helvetica",this.combo=!1};rA(kA,jA);var SA=function(){kA.call(this),this.combo=!0};rA(SA,kA);var AA=function(){SA.call(this),this.edit=!0};rA(AA,SA);var CA=function(){NA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,15):this.Ff=dA(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,16):this.Ff=dA(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,17):this.Ff=dA(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,26):this.Ff=dA(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var r,a=[];for(r in a.push("<<"),t)a.push("/"+r+" ("+QS(e(t[r]))+")");return a.push(">>"),a.join("\n")}},set:function(e){"object"===(0,sy.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};rA(CA,NA);var _A=function(){CA.call(this),this.pushButton=!0};rA(_A,CA);var TA=function(){CA.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};rA(TA,CA);var EA=function(){var e,t;NA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,r=[];for(t in r.push("<<"),a)r.push("/"+t+" ("+QS(e(a[t]))+")");return r.push(">>"),r.join("\n")},set:function(e){"object"===(0,sy.A)(e)&&(a=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(e){"string"==typeof e&&(a.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=FA.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};rA(EA,NA),TA.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},TA.prototype.createOption=function(e){var t=new EA;return t.Parent=this,t.optionName=e,this.Kids.push(t),DA.call(this.scope,t),t};var LA=function(){CA.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=FA.CheckBox.createAppearanceStream()};rA(LA,CA);var PA=function(){NA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,13):this.Ff=dA(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,21):this.Ff=dA(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,23):this.Ff=dA(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,24):this.Ff=dA(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,25):this.Ff=dA(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,26):this.Ff=dA(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};rA(PA,NA);var OA=function(){PA.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(oA(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=cA(this.Ff,14):this.Ff=dA(this.Ff,14)}}),this.password=!0};rA(OA,PA);var FA={CheckBox:{createAppearanceStream:function(){return{N:{On:FA.CheckBox.YesNormal},D:{On:FA.CheckBox.YesPushDown,Off:FA.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=nA(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=fA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+eA(FA.internal.getWidth(e))+" "+eA(FA.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+eA(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join("\n"),t},YesNormal:function(e){var t=nA(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],s=FA.internal.getHeight(e),i=FA.internal.getWidth(e),l=fA(e,e.caption);return n.push("1 g"),n.push("0 0 "+eA(i)+" "+eA(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+eA(i-1)+" "+eA(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+eA(l.fontSize)+" Tf "+a),n.push(l.text),n.push("ET"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=nA(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+eA(FA.internal.getWidth(e))+" "+eA(FA.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:FA.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=FA.RadioButton.Circle.YesNormal,t.D[e]=FA.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=nA(e);t.scope=e.scope;var r=[],a=FA.internal.getWidth(e)<=FA.internal.getHeight(e)?FA.internal.getWidth(e)/4:FA.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=FA.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+tA(FA.internal.getWidth(e)/2)+" "+tA(FA.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=nA(e);t.scope=e.scope;var r=[],a=FA.internal.getWidth(e)<=FA.internal.getHeight(e)?FA.internal.getWidth(e)/4:FA.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*FA.internal.Bezier_C).toFixed(5)),i=Number((a*FA.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+tA(FA.internal.getWidth(e)/2)+" "+tA(FA.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+tA(FA.internal.getWidth(e)/2)+" "+tA(FA.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=nA(e);t.scope=e.scope;var r=[],a=FA.internal.getWidth(e)<=FA.internal.getHeight(e)?FA.internal.getWidth(e)/4:FA.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*FA.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+tA(FA.internal.getWidth(e)/2)+" "+tA(FA.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:FA.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=FA.RadioButton.Cross.YesNormal,t.D[e]=FA.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=nA(e);t.scope=e.scope;var r=[],a=FA.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+eA(FA.internal.getWidth(e)-2)+" "+eA(FA.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(eA(a.x1.x)+" "+eA(a.x1.y)+" m"),r.push(eA(a.x2.x)+" "+eA(a.x2.y)+" l"),r.push(eA(a.x4.x)+" "+eA(a.x4.y)+" m"),r.push(eA(a.x3.x)+" "+eA(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=nA(e);t.scope=e.scope;var r=FA.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+eA(FA.internal.getWidth(e))+" "+eA(FA.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+eA(FA.internal.getWidth(e)-2)+" "+eA(FA.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(eA(r.x1.x)+" "+eA(r.x1.y)+" m"),a.push(eA(r.x2.x)+" "+eA(r.x2.y)+" l"),a.push(eA(r.x4.x)+" "+eA(r.x4.y)+" m"),a.push(eA(r.x3.x)+" "+eA(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=nA(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+eA(FA.internal.getWidth(e))+" "+eA(FA.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};FA.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=FA.internal.getWidth(e),r=FA.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},FA.internal.getWidth=function(e){var t=0;return"object"===(0,sy.A)(e)&&(t=aA(e.Rect[2])),t},FA.internal.getHeight=function(e){var t=0;return"object"===(0,sy.A)(e)&&(t=aA(e.Rect[3])),t};var DA=$S.addField=function(e){if(function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(NA.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(pA)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");JS=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new wA,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];a.objId=void 0,a.hasAnnotation&&gA(a,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var r=!e;for(var a in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(a)){var n=e[a],s=[],i=n.Rect;if(n.Rect&&(n.Rect=uA(n.Rect,t)),t.internal.newObjectDeferredBegin(n.objId,!0),n.DA=FA.createDefaultAppearanceStream(n),"object"===(0,sy.A)(n)&&"function"==typeof n.getKeyValueListForStream&&(s=n.getKeyValueListForStream()),n.Rect=i,n.hasAppearanceStream&&!n.appearanceStreamContent){var l=hA(n);s.push({key:"AP",value:"<</N "+l+">>"}),t.internal.acroformPlugin.xForms.push(l)}if(n.appearanceStreamContent){var o="";for(var c in n.appearanceStreamContent)if(n.appearanceStreamContent.hasOwnProperty(c)){var d=n.appearanceStreamContent[c];if(o+="/"+c+" ",o+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var a in d)if(d.hasOwnProperty(a)){var u=d[a];"function"==typeof u&&(u=u.call(t,n)),o+="/"+a+" "+u+" ",t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u)}}else"function"==typeof(u=d)&&(u=u.call(t,n)),o+="/"+a+" "+u,t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u);o+=">>"}s.push({key:"AP",value:"<<\n"+o+">>"})}t.internal.putStream({additionalKeyValues:s,objectId:n.objId}),t.internal.out("endobj")}r&&function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,n=e[r];t.internal.newObjectDeferredBegin(n.objId,!0),"object"===(0,sy.A)(n)&&"function"==typeof n.putStream&&n.putStream(),delete e[a]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this,e),!(e instanceof NA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};$S.AcroFormChoiceField=jA,$S.AcroFormListBox=kA,$S.AcroFormComboBox=SA,$S.AcroFormEditBox=AA,$S.AcroFormButton=CA,$S.AcroFormPushButton=_A,$S.AcroFormRadioButton=TA,$S.AcroFormCheckBox=LA,$S.AcroFormTextField=PA,$S.AcroFormPasswordField=OA,$S.AcroFormAppearance=FA,$S.AcroForm={ChoiceField:jA,ListBox:kA,ComboBox:SA,EditBox:AA,Button:CA,PushButton:_A,RadioButton:TA,CheckBox:LA,TextField:PA,PasswordField:OA,Appearance:FA},XS.AcroForm={ChoiceField:jA,ListBox:kA,ComboBox:SA,EditBox:AA,Button:CA,PushButton:_A,RadioButton:TA,CheckBox:LA,TextField:PA,PasswordField:OA,Appearance:FA};XS.AcroForm;function IA(e){return e.reduce(function(e,t,r){return e[t]=r,e},{})}!function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(e,t){var n,s,i,l,o,c=r;if("RGBA"===(t=t||r)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(N(e))for(o in a)for(i=a[o],n=0;n<i.length;n+=1){for(l=!0,s=0;s<i[n].length;s+=1)if(void 0!==i[n][s]&&i[n][s]!==e[s]){l=!1;break}if(!0===l){c=o;break}}else for(o in a)for(i=a[o],n=0;n<i.length;n+=1){for(l=!0,s=0;s<i[n].length;s+=1)if(void 0!==i[n][s]&&i[n][s]!==e.charCodeAt(s)){l=!1;break}if(!0===l){c=o;break}}return c===r&&t!==r&&(c=t),c},s=function e(t){for(var r=this.internal.write,a=this.internal.putStream,n=(0,this.internal.getFilters)();-1!==n.indexOf("FlateEncode");)n.splice(n.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:t.width}),s.push({key:"Height",value:t.height}),t.colorSpace===x.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===x.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)&&t.transparency.length>0){for(var i="",l=0,o=t.transparency.length;l<o;l++)i+=t.transparency[l]+" "+t.transparency[l]+" ";s.push({key:"Mask",value:"["+i+"]"})}void 0!==t.sMask&&s.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(a({data:t.data,additionalKeyValues:s,alreadyAppliedFilters:c,objectId:t.objectId}),r("endobj"),"sMask"in t&&void 0!==t.sMask){var d,u=null!==(d=t.sMaskBitsPerComponent)&&void 0!==d?d:t.bitsPerComponent,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:u,data:t.sMask};"filter"in t&&(h.decodeParameters="/Predictor ".concat(t.predictor," /Colors 1 /BitsPerComponent ").concat(u," /Columns ").concat(t.width),h.filter=t.filter),e.call(this,h)}if(t.colorSpace===x.INDEXED){var f=this.internal.newObject();a({data:k(new Uint8Array(t.palette)),objectId:f}),r("endobj")}},i=function(){var e=this.internal.collections[t+"images"];for(var r in e)s.call(this,e[r])},l=function(){var e,r=this.internal.collections[t+"images"],a=this.internal.write;for(var n in r)a("/I"+(e=r[n]).index,e.objectId,"0","R")},o=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},c=function(){var e=this.internal.collections[t+"images"];return o.call(this),e},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},u=function(t){return"function"==typeof e["process"+t.toUpperCase()]},h=function(e){return"object"===(0,sy.A)(e)&&1===e.nodeType},f=function(t,r){if("IMG"===t.nodeName&&t.hasAttribute("src")){var a=""+t.getAttribute("src");if(0===a.indexOf("data:image/"))return kS(unescape(a).split("base64,").pop());var n=e.loadFile(a,!0);if(void 0!==n)return n}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var s;switch(r){case"PNG":s="image/png";break;case"WEBP":s="image/webp";break;default:s="image/jpeg"}return kS(t.toDataURL(s,1).split("base64,").pop())}},m=function(e){var r=this.internal.collections[t+"images"];if(r)for(var a in r)if(e===r[a].alias)return r[a]},p=function(e,t,r){return e||t||(e=-96,t=-96),e<0&&(e=-1*r.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*r.height*72/t/this.internal.scaleFactor),0===e&&(e=t*r.width/r.height),0===t&&(t=e*r.height/r.width),[e,t]},g=function(e,t,r,a,n,s){var i=p.call(this,r,a,n),l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,d=c.call(this);if(r=i[0],a=i[1],d[n.index]=n,s){s*=Math.PI/180;var u=Math.cos(s),h=Math.sin(s),f=function(e){return e.toFixed(4)},m=[f(u),f(h),f(-1*h),f(u),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,l(e),o(t+a),"cm"].join(" ")),this.internal.write(m.join(" ")),this.internal.write([l(r),"0","0",l(a),"0","0","cm"].join(" "))):this.internal.write([l(r),"0","0",l(a),l(e),o(t+a),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+n.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(e){var t,r,a=0;if("string"==typeof e)for(r=e.length,t=0;t<r;t++)a=(a<<5)-a+e.charCodeAt(t),a|=0;else if(N(e))for(r=e.byteLength/2,t=0;t<r;t++)a=(a<<5)-a+e[t],a|=0;return a},y=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},w=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null};e.__addimage__.isArrayBuffer=function(e){return e instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},j=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(t),a=0;a<t;a++)r[a]=e.charCodeAt(a);return r},k=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",r=N(e)?e:new Uint8Array(e),a=0;a<r.length;a+=8192)t+=String.fromCharCode.apply(null,r.subarray(a,a+8192));return t};e.addImage=function(){var e,t,a,n,s,i,l,c,d;if("number"==typeof arguments[1]?(t=r,a=arguments[1],n=arguments[2],s=arguments[3],i=arguments[4],l=arguments[5],c=arguments[6],d=arguments[7]):(t=arguments[1],a=arguments[2],n=arguments[3],s=arguments[4],i=arguments[5],l=arguments[6],c=arguments[7],d=arguments[8]),"object"===(0,sy.A)(e=arguments[0])&&!h(e)&&"imageData"in e){var u=e;e=u.imageData,t=u.format||t||r,a=u.x||a||0,n=u.y||n||0,s=u.w||u.width||s,i=u.h||u.height||i,l=u.alias||l,c=u.compression||c,d=u.rotation||u.angle||d}var f=this.internal.getFilters();if(void 0===c&&-1!==f.indexOf("FlateEncode")&&(c="SLOW"),isNaN(a)||isNaN(n))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var m=S.call(this,e,t,l,c);return g.call(this,a,n,s,i,m,d),this};var S=function(t,a,s,i){var l,o,c;if("string"==typeof t&&n(t)===r){t=unescape(t);var p=A(t,!1);(""!==p||void 0!==(p=e.loadFile(t,!0)))&&(t=p)}if(h(t)&&(t=f(t,a)),a=n(t,a),!u(a))throw new Error("addImage does not support files of type '"+a+"', please ensure that a plugin for '"+a+"' support is added.");if((null==(c=s)||0===c.length)&&(s=function(e){return"string"==typeof e||N(e)?v(e):N(e.data)?v(e.data):null}(t)),(l=m.call(this,s))||(t instanceof Uint8Array||"RGBA"===a||(o=t,t=j(t)),l=this["process"+a.toUpperCase()](t,d.call(this),s,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:b.NONE}(i),o)),!l)throw new Error("An unknown error occurred whilst processing the image.");return l},A=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var r,a="";if("string"==typeof e){var s;r=null!==(s=w(e))&&void 0!==s?s:e;try{a=kS(r)}catch(n){if(t)throw y(r)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+n.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return a};e.getImageProperties=function(t){var a,s,i="";if(h(t)&&(t=f(t)),"string"==typeof t&&n(t)===r&&(""===(i=A(t,!1))&&(i=e.loadFile(t)||""),t=i),s=n(t),!u(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(t instanceof Uint8Array||(t=j(t)),!(a=this["process"+s.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return a.fileType=s,a}}(XS.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};XS.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var r,a,n,s=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),o=e.pageContext.annotations,c=!1,d=0;d<o.length&&!c;d++)switch((r=o[d]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var u=0;u<o.length;u++){r=o[u];var h=this.internal.pdfEscape,f=this.internal.getEncryptor(e.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),p=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(m.objId),x=r.title||"Note";n="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(r.bounds.x)+" "+i(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y)+"] ")+"/Contents ("+h(g(r.contents))+")",n+=" /Popup "+p.objId+" 0 R",n+=" /P "+l.objId+" 0 R",n+=" /T ("+h(g(x))+") >>",m.content=n;var b=m.objId+" 0 R";n="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(r.bounds.x+30)+" "+i(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+i(r.bounds.y)+"] ")+" /Parent "+b,r.open&&(n+=" /Open true"),n+=" >>",p.content=n,this.internal.write(m.objId,"0 R",p.objId,"0 R");break;case"freetext":a="/Rect ["+s(r.bounds.x)+" "+i(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y+r.bounds.h)+"] ";var v=r.color||"#000000";n="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(f(r.contents))+")",n+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",n+=" /Border [0 0 0]",n+=" >>",this.internal.write(n);break;case"link":if(r.options.name){var y=this.annotations._nameMap[r.options.name];r.options.pageNumber=y.page,r.options.top=y.y}else r.options.top||(r.options.top=0);if(a="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",n="",r.options.url)n="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(f(r.options.url))+") >>";else if(r.options.pageNumber)switch(n="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":n+=" /Fit]";break;case"FitH":n+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,n+=" /FitV "+r.options.left+"]";break;default:var w=i(r.options.top);r.options.left=r.options.left||0,void 0===r.options.zoom&&(r.options.zoom=0),n+=" /XYZ "+r.options.left+" "+w+" "+r.options.zoom+"]"}""!=n&&(n+=" >>",this.internal.write(n))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,r,a,n){var s=this.internal.getCurrentPageInfo(),i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:i(e),y:l(t),w:i(e+r),h:l(t+a)},options:n,type:"link"})},e.textWithLink=function(e,t,r,a){var n,s,i=this.getTextWidth(e),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==a.maxWidth){s=a.maxWidth;var o=this.splitTextToSize(e,s).length;n=Math.ceil(l*o)}else s=i,n=l;return this.text(e,t,r,a),r+=.2*l,"center"===a.align&&(t-=i/2),"right"===a.align&&(t-=i),this.link(t,r-l,s,n,a),i},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(XS.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},i=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},l=e.__arabicParser__.isArabicEndLetter=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length<=2},o=e.__arabicParser__.isArabicAlfLetter=function(e){return i(e)&&n.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return i(e)&&s(e)&&4==t[e.charCodeAt(0)].length},u=e.__arabicParser__.resolveLigatures=function(e){var t=0,a=r,n="",s=0;for(t=0;t<e.length;t+=1)void 0!==a[e.charCodeAt(t)]?(s++,"number"==typeof(a=a[e.charCodeAt(t)])&&(n+=String.fromCharCode(a),a=r,s=0),t===e.length-1&&(a=r,n+=e.charAt(t-(s-1)),t-=s-1,s=0)):(a=r,n+=e.charAt(t-s),t-=s,s=0);return n};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==a[e.charCodeAt(0)]};var h=e.__arabicParser__.getCorrectForm=function(e,t,r){return i(e)?!1===s(e)?-1:!c(e)||!i(t)&&!i(r)||!i(r)&&l(t)||l(e)&&!i(t)||l(e)&&o(t)||l(e)&&l(t)?0:d(e)&&i(t)&&!l(t)&&i(r)&&c(r)?3:l(e)||!i(r)?1:2:-1},f=function(e){var r=0,a=0,n=0,s="",l="",o="",c=(e=e||"").split("\\s+"),d=[];for(r=0;r<c.length;r+=1){for(d.push(""),a=0;a<c[r].length;a+=1)s=c[r][a],l=c[r][a-1],o=c[r][a+1],i(s)?(n=h(s,l,o),d[r]+=-1!==n?String.fromCharCode(t[s.charCodeAt(0)][n]):s):d[r]+=s;d[r]=u(d[r])}return d.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,r=[];if(Array.isArray(t)){var a=0;for(r=[],a=0;a<t.length;a+=1)Array.isArray(t[a])?r.push([f(t[a][0]),t[a][1],t[a][2]]):r.push([f(t[a])]);e=r}else e=f(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",m])}(XS.API),XS.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(e){r=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(e){a=e}});var n={};Object.defineProperty(this,"style",{get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var r;if("2d"!==(e=e||"2d"))return null;for(r in t)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=t[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(XS.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var r=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var a=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var n=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var i=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return i},set:function(e){i=e}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return a.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){a.call(this);var r=(t=t||{}).fontSize||this.getFontSize(),n=t.font||this.getFont(),s=t.scaleFactor||this.internal.scaleFactor,i=0,l=0,o=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var d=t.maxWidth;d>0?"string"==typeof e?e=this.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(c.splitTextToSize(t,d))},[])):e=Array.isArray(e)?e:[e];for(var u=0;u<e.length;u++)i<(o=this.getStringUnitWidth(e[u],{font:n})*r)&&(i=o);return 0!==i&&(l=e.length),{w:i/=s,h:Math.max((l*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/s,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var e;e=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var n=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,l=this.internal.__cell__.margins||t,o=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==n.lineNumber&&(n.lineNumber===e.lineNumber?(e.x=(n.x||0)+(n.width||0),e.y=n.y||0):n.y+n.height+e.height+l.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=l.top,c&&o&&(this.printHeaderRow(e.lineNumber,!0),e.y+=o[0].height)):e.y=n.y+n.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===r?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-i,e.y+i,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+i,{align:"center",baseline:"top",maxWidth:e.width-i-i}):this.text(e.text,e.x+i,e.y+i,{align:"left",baseline:"top",maxWidth:e.width-i-i})),this.internal.__cell__.lastCell=e,this};e.table=function(e,r,o,c,d){if(a.call(this),!o)throw new Error("No data for PDF table.");var u,h,f,m,p=[],g=[],x=[],b={},v={},y=[],w=[],N=(d=d||{}).autoSize||!1,j=!1!==d.printHeaders,k=d.css&&void 0!==d.css["font-size"]?16*d.css["font-size"]:d.fontSize||12,S=d.margins||Object.assign({width:this.getPageWidth()},t),A="number"==typeof d.padding?d.padding:3,C=d.headerBackgroundColor||"#c8c8c8",_=d.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=k,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=C,this.internal.__cell__.headerTextColor=_,this.setFontSize(k),null==c)g=p=Object.keys(o[0]),x=p.map(function(){return"left"});else if(Array.isArray(c)&&"object"===(0,sy.A)(c[0]))for(p=c.map(function(e){return e.name}),g=c.map(function(e){return e.prompt||e.name||""}),x=c.map(function(e){return e.align||"left"}),u=0;u<c.length;u+=1)v[c[u].name]=.7499990551181103*c[u].width;else Array.isArray(c)&&"string"==typeof c[0]&&(g=p=c,x=p.map(function(){return"left"}));if(N||Array.isArray(c)&&"string"==typeof c[0])for(u=0;u<p.length;u+=1){for(b[m=p[u]]=o.map(function(e){return e[m]}),this.setFont(void 0,"bold"),y.push(this.getTextDimensions(g[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),h=b[m],this.setFont(void 0,"normal"),f=0;f<h.length;f+=1)y.push(this.getTextDimensions(h[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);v[m]=Math.max.apply(null,y)+A+A,y=[]}if(j){var T={};for(u=0;u<p.length;u+=1)T[p[u]]={},T[p[u]].text=g[u],T[p[u]].align=x[u];var E=l.call(this,T,v);w=p.map(function(t){return new s(e,r,v[t],E,T[t].text,void 0,T[t].align)}),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var L=c.reduce(function(e,t){return e[t.name]=t.align,e},{});for(u=0;u<o.length;u+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:u,data:o[u]},this);var P=l.call(this,o[u],v);for(f=0;f<p.length;f+=1){var O=o[u][p[f]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:u,col:f,data:O},this),i.call(this,new s(e,r,v[p[f]],P,O,u+2,L[p[f]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=r,this};var l=function(e,t){var r=this.internal.__cell__.padding,a=this.internal.__cell__.table_font_size,n=this.internal.scaleFactor;return Object.keys(e).map(function(a){var n=e[a];return this.splitTextToSize(n.hasOwnProperty("text")?n.text:n,t[a]-r-r)},this).map(function(e){return this.getLineHeightFactor()*e.length*a/n+r+r},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){a.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var n;if(r=!0,"function"==typeof this.internal.__cell__.headerFunction){var l=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(l[0],l[1],l[2],l[3],void 0,-1)}this.setFont(void 0,"bold");for(var o=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){n=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(n.y=this.internal.__cell__.margins.top||0,o.push(n)),n.lineNumber=e;var d=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,n),this.setTextColor(d)}o.length>0&&this.setTableHeaderRow(o),this.setFont(void 0,"normal"),r=!1}}(XS.API);var RA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},MA=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],BA=IA(MA),UA=[100,200,300,400,500,600,700,800,900],zA=IA(UA);function qA(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(e){return RA[e=e||"normal"]?e:"normal"}(e.style),a=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),n=function(e){return"number"==typeof BA[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function HA(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var WA={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},VA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function GA(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function KA(e){return e.trimLeft()}function YA(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function XA(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var $A,JA,QA,ZA,eC,tC,rC,aC,nC,sC=["times"];function iC(e,t,r,a,n){var s=4,i=cC;switch(n){case XS.API.image_compression.FAST:s=1,i=oC;break;case XS.API.image_compression.MEDIUM:s=6,i=dC;break;case XS.API.image_compression.SLOW:s=9,i=uC}e=function(e,t,r,a){for(var n,s=e.length/t,i=new Uint8Array(e.length+s),l=[lC,oC,cC,dC,uC],o=0;o<s;o+=1){var c=o*t,d=e.subarray(c,c+t);if(a)i.set(a(d,r,n),c+o);else{for(var u=l.length,h=[],f=0;f<u;f+=1)h[f]=l[f](d,r,n);var m=fC(h.concat());i.set(h[m],c+o)}n=d}return i}(e,t,Math.ceil(r*a/8),i);var l=Hy(e,{level:s});return XS.API.__addimage__.arrayBufferToBinaryString(l)}function lC(e){var t=Array.apply([],e);return t.unshift(0),t}function oC(e,t){var r=e.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=e[n-t]||0;a[n+1]=e[n]-s+256&255}return a}function cC(e,t,r){var a=e.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var i=r&&r[s]||0;n[s+1]=e[s]-i+256&255}return n}function dC(e,t,r){var a=e.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var i=e[s-t]||0,l=r&&r[s]||0;n[s+1]=e[s]+256-(i+l>>>1)&255}return n}function uC(e,t,r){var a=e.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var i=hC(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);n[s+1]=e[s]-i+256&255}return n}function hC(e,t,r){if(e===t&&t===r)return e;var a=Math.abs(t-r),n=Math.abs(e-r),s=Math.abs(e+t-r-r);return a<=n&&a<=s?e:n<=s?t:r}function fC(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))}function mC(e,t,r){var a=t*r,n=Math.floor(a/8),s=16-(a-8*n+r),i=(1<<r)-1;return gC(e,n)>>s&i}function pC(e,t,r,a){var n=r*a,s=Math.floor(n/8),i=16-(n-8*s+a),l=(1<<a)-1,o=(t&l)<<i;!function(e,t,r){if(t+1<e.byteLength)e.setUint16(t,r,!1);else{var a=r>>8&255;e.setUint8(t,a)}}(e,s,gC(e,s)&~(l<<i)&65535|o)}function gC(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function xC(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],s=n>>7,i=1<<1+(7&n);e[t++],e[t++];var l=null,o=null;s&&(l=t,o=i,t+=3*i);var c=!0,d=[],u=0,h=null,f=0,m=null;for(this.width=r,this.height=a;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var p=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],1&p||(h=null),f=p>>2&7,t++;break;case 254:for(;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,y=e[t++],w=y>>6&1,N=1<<1+(7&y),j=l,k=o,S=!1;y>>7&&(S=!0,j=t,k=N,t+=3*N);var A=t;for(t++;;){var C;if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}d.push({x:g,y:x,width:b,height:v,has_local_palette:S,palette_offset:j,palette_size:k,data_offset:A,data_length:t-A,transparent_index:h,interlaced:!!w,delay:u,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(e){if(e<0||e>=d.length)throw new Error("Frame index out of range.");return d[e]},this.decodeAndBlitFrameBGRA=function(t,a){var n=this.frameInfo(t),s=n.width*n.height,i=new Uint8Array(s);bC(e,n.data_offset,i,s);var l=n.palette_offset,o=n.transparent_index;null===o&&(o=256);var c=n.width,d=r-c,u=c,h=4*(n.y*r+n.x),f=4*((n.y+n.height)*r+n.x),m=h,p=4*d;!0===n.interlaced&&(p+=4*r*7);for(var g=8,x=0,b=i.length;x<b;++x){var v=i[x];if(0===u&&(u=c,(m+=p)>=f&&(p=4*d+4*r*(g-1),m=h+(c+d)*(g<<1),g>>=1)),v===o)m+=4;else{var y=e[l+3*v],w=e[l+3*v+1],N=e[l+3*v+2];a[m++]=N,a[m++]=w,a[m++]=y,a[m++]=255}--u}},this.decodeAndBlitFrameRGBA=function(t,a){var n=this.frameInfo(t),s=n.width*n.height,i=new Uint8Array(s);bC(e,n.data_offset,i,s);var l=n.palette_offset,o=n.transparent_index;null===o&&(o=256);var c=n.width,d=r-c,u=c,h=4*(n.y*r+n.x),f=4*((n.y+n.height)*r+n.x),m=h,p=4*d;!0===n.interlaced&&(p+=4*r*7);for(var g=8,x=0,b=i.length;x<b;++x){var v=i[x];if(0===u&&(u=c,(m+=p)>=f&&(p=4*d+4*r*(g-1),m=h+(c+d)*(g<<1),g>>=1)),v===o)m+=4;else{var y=e[l+3*v],w=e[l+3*v+1],N=e[l+3*v+2];a[m++]=y,a[m++]=w,a[m++]=N,a[m++]=255}--u}}}function bC(e,t,r,a){for(var n=e[t++],s=1<<n,i=s+1,l=i+1,o=n+1,c=(1<<o)-1,d=0,u=0,h=0,f=e[t++],m=new Int32Array(4096),p=null;;){for(;d<16&&0!==f;)u|=e[t++]<<d,d+=8,1===f?f=e[t++]:--f;if(d<o)break;var g=u&c;if(u>>=o,d-=o,g!==s){if(g===i)break;for(var x=g<l?g:p,b=0,v=x;v>s;)v=m[v]>>8,++b;var y=v;if(h+b+(x!==g?1:0)>a)return void bS.log("Warning, gif stream longer than expected.");r[h++]=y;var w=h+=b;for(x!==g&&(r[h++]=y),v=x;b--;)v=m[v],r[--w]=255&v,v>>=8;null!==p&&l<4096&&(m[l++]=p<<8|y,l>=c+1&&o<12&&(++o,c=c<<1|1)),p=g}else l=i+1,c=(1<<(o=n+1))-1,p=null}return h!==a&&bS.log("Warning, gif stream shorter than expected."),r}function vC(e){var t,r,a,n,s,i=Math.floor,l=new Array(64),o=new Array(64),c=new Array(64),d=new Array(64),u=new Array(65535),h=new Array(65535),f=new Array(64),m=new Array(64),p=[],g=0,x=7,b=new Array(64),v=new Array(64),y=new Array(64),w=new Array(256),N=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],L=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function P(e,t){for(var r=0,a=0,n=new Array,s=1;s<=16;s++){for(var i=1;i<=e[s];i++)n[t[a]]=[],n[t[a]][0]=r,n[t[a]][1]=s,a++,r++;r*=2}return n}function O(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(g|=1<<x),r--,--x<0&&(255==g?(F(255),F(0)):F(g),x=7,g=0)}function F(e){p.push(e)}function D(e){F(e>>8&255),F(255&e)}function I(e,t,r,a,n){for(var s,i=n[0],l=n[240],o=function(e,t){var r,a,n,s,i,l,o,c,d,u,h=0;for(d=0;d<8;++d){r=e[h],a=e[h+1],n=e[h+2],s=e[h+3],i=e[h+4],l=e[h+5],o=e[h+6];var m=r+(c=e[h+7]),p=r-c,g=a+o,x=a-o,b=n+l,v=n-l,y=s+i,w=s-i,N=m+y,j=m-y,k=g+b,S=g-b;e[h]=N+k,e[h+4]=N-k;var A=.707106781*(S+j);e[h+2]=j+A,e[h+6]=j-A;var C=.382683433*((N=w+v)-(S=x+p)),_=.5411961*N+C,T=1.306562965*S+C,E=.707106781*(k=v+x),L=p+E,P=p-E;e[h+5]=P+_,e[h+3]=P-_,e[h+1]=L+T,e[h+7]=L-T,h+=8}for(h=0,d=0;d<8;++d){r=e[h],a=e[h+8],n=e[h+16],s=e[h+24],i=e[h+32],l=e[h+40],o=e[h+48];var O=r+(c=e[h+56]),F=r-c,D=a+o,I=a-o,R=n+l,M=n-l,B=s+i,U=s-i,z=O+B,q=O-B,H=D+R,W=D-R;e[h]=z+H,e[h+32]=z-H;var V=.707106781*(W+q);e[h+16]=q+V,e[h+48]=q-V;var G=.382683433*((z=U+M)-(W=I+F)),K=.5411961*z+G,Y=1.306562965*W+G,X=.707106781*(H=M+I),$=F+X,J=F-X;e[h+40]=J+K,e[h+24]=J-K,e[h+8]=$+Y,e[h+56]=$-Y,h++}for(d=0;d<64;++d)u=e[d]*t[d],f[d]=u>0?u+.5|0:u-.5|0;return f}(e,t),c=0;c<64;++c)m[j[c]]=o[c];var d=m[0]-r;r=m[0],0==d?O(a[0]):(O(a[h[s=32767+d]]),O(u[s]));for(var p=63;p>0&&0==m[p];)p--;if(0==p)return O(i),r;for(var g,x=1;x<=p;){for(var b=x;0==m[x]&&x<=p;)++x;var v=x-b;if(v>=16){g=v>>4;for(var y=1;y<=g;++y)O(l);v&=15}s=32767+m[x],O(n[(v<<4)+h[s]]),O(u[s]),x++}return 63!=p&&O(i),r}function R(e){e=Math.min(Math.max(e,1),100),s!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var a=i((t[r]*e+50)/100);a=Math.min(Math.max(a,1),255),l[j[r]]=a}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=i((n[s]*e+50)/100);u=Math.min(Math.max(u,1),255),o[j[s]]=u}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,m=0;m<8;m++)for(var p=0;p<8;p++)c[f]=1/(l[j[f]]*h[m]*h[p]*8),d[f]=1/(o[j[f]]*h[m]*h[p]*8),f++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),s=e)}this.encode=function(e,s){s&&R(s),p=new Array,g=0,x=7,D(65496),D(65504),D(16),F(74),F(70),F(73),F(70),F(0),F(1),F(1),F(0),D(1),D(1),F(0),F(0),function(){D(65499),D(132),F(0);for(var e=0;e<64;e++)F(l[e]);F(1);for(var t=0;t<64;t++)F(o[t])}(),function(e,t){D(65472),D(17),F(8),D(t),D(e),F(3),F(1),F(17),F(0),F(2),F(17),F(1),F(3),F(17),F(1)}(e.width,e.height),function(){D(65476),D(418),F(0);for(var e=0;e<16;e++)F(k[e+1]);for(var t=0;t<=11;t++)F(S[t]);F(16);for(var r=0;r<16;r++)F(A[r+1]);for(var a=0;a<=161;a++)F(C[a]);F(1);for(var n=0;n<16;n++)F(_[n+1]);for(var s=0;s<=11;s++)F(T[s]);F(17);for(var i=0;i<16;i++)F(E[i+1]);for(var l=0;l<=161;l++)F(L[l])}(),D(65498),D(12),F(3),F(1),F(0),F(2),F(17),F(3),F(17),F(0),F(63),F(0);var i=0,u=0,h=0;g=0,x=7,this.encode.displayName="_encode_";for(var f,m,w,j,P,M,B,U,z,q=e.data,H=e.width,W=e.height,V=4*H,G=0;G<W;){for(f=0;f<V;){for(P=V*G+f,B=-1,U=0,z=0;z<64;z++)M=P+(U=z>>3)*V+(B=4*(7&z)),G+U>=W&&(M-=V*(G+1+U-W)),f+B>=V&&(M-=f+B-V+4),m=q[M++],w=q[M++],j=q[M++],b[z]=(N[m]+N[w+256|0]+N[j+512|0]>>16)-128,v[z]=(N[m+768|0]+N[w+1024|0]+N[j+1280|0]>>16)-128,y[z]=(N[m+1280|0]+N[w+1536|0]+N[j+1792|0]>>16)-128;i=I(b,c,i,t,a),u=I(v,d,u,r,n),h=I(y,d,h,r,n),f+=32}G+=8}if(x>=0){var K=[];K[1]=x+1,K[0]=(1<<x+1)-1,O(K)}return D(65497),new Uint8Array(p)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=P(k,S),r=P(_,T),a=P(A,C),n=P(E,L),function(){for(var e=1,t=2,r=1;r<=15;r++){for(var a=e;a<t;a++)h[32767+a]=r,u[32767+a]=[],u[32767+a][1]=r,u[32767+a][0]=a;for(var n=-(t-1);n<=-e;n++)h[32767+n]=r,u[32767+n]=[],u[32767+n][1]=r,u[32767+n][0]=t-1+n;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)N[e]=19595*e,N[e+256|0]=38470*e,N[e+512|0]=7471*e+32768,N[e+768|0]=-11059*e,N[e+1024|0]=-21709*e,N[e+1280|0]=32768*e+8421375,N[e+1536|0]=-27439*e,N[e+1792|0]=-5329*e}(),R(e)}function yC(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wC(e){function t(e){if(!e)throw Error("assert :P")}function r(e,t,r){for(var a=0;4>a;a++)if(e[t+a]!=r.charCodeAt(a))return!0;return!1}function a(e,t,r,a,n){for(var s=0;s<n;s++)e[t+s]=r[a+s]}function n(e,t,r,a){for(var n=0;n<a;n++)e[t+n]=r}function s(e){return new Int32Array(e)}function i(e,t){for(var r=[],a=0;a<e;a++)r.push(new t);return r}function l(e,t){var r=[];return function e(r,a,n){for(var s=n[a],i=0;i<s&&(r.push(n.length>a+1?[]:new t),!(n.length<a+1));i++)e(r[i],a+1,n)}(r,0,e),r}var o=function(){var e=this;function o(e,t){for(var r=1<<t-1>>>0;e&r;)r>>>=1;return r?(e&r-1)+r:e}function c(e,r,a,n,s){t(!(n%a));do{e[r+(n-=a)]=s}while(0<n)}function d(e,r,a,n,i){if(t(2328>=i),512>=i)var l=s(512);else if(null==(l=s(i)))return 0;return function(e,r,a,n,i,l){var d,h,f=r,m=1<<a,p=s(16),g=s(16);for(t(0!=i),t(null!=n),t(null!=e),t(0<a),h=0;h<i;++h){if(15<n[h])return 0;++p[n[h]]}if(p[0]==i)return 0;for(g[1]=0,d=1;15>d;++d){if(p[d]>1<<d)return 0;g[d+1]=g[d]+p[d]}for(h=0;h<i;++h)d=n[h],0<n[h]&&(l[g[d]++]=h);if(1==g[15])return(n=new u).g=0,n.value=l[0],c(e,f,1,m,n),m;var x,b=-1,v=m-1,y=0,w=1,N=1,j=1<<a;for(h=0,d=1,i=2;d<=a;++d,i<<=1){if(w+=N<<=1,0>(N-=p[d]))return 0;for(;0<p[d];--p[d])(n=new u).g=d,n.value=l[h++],c(e,f+y,i,j,n),y=o(y,d)}for(d=a+1,i=2;15>=d;++d,i<<=1){if(w+=N<<=1,0>(N-=p[d]))return 0;for(;0<p[d];--p[d]){if(n=new u,(y&v)!=b){for(f+=j,x=1<<(b=d)-a;15>b&&!(0>=(x-=p[b]));)++b,x<<=1;m+=j=1<<(x=b-a),e[r+(b=y&v)].g=x+a,e[r+b].value=f-r-b}n.g=d-a,n.value=l[h++],c(e,f+(y>>a),i,j,n),y=o(y,d)}}return w!=2*g[15]-1?0:m}(e,r,a,n,i,l)}function u(){this.value=this.g=0}function h(){this.value=this.g=0}function f(){this.G=i(5,u),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Rr,h)}function m(e,r,a,n){t(null!=e),t(null!=r),t(2147483648>n),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=r,e.pa=a,e.Jd=r,e.Yc=a+n,e.Zc=4<=n?a+n-4+1:a,A(e)}function p(e,t){for(var r=0;0<t--;)r|=_(e,128)<<t;return r}function g(e,t){var r=p(e,t);return C(e)?-r:r}function x(e,r,a,n){var s,i=0;for(t(null!=e),t(null!=r),t(4294967288>n),e.Sb=n,e.Ra=0,e.u=0,e.h=0,4<n&&(n=4),s=0;s<n;++s)i+=r[a+s]<<8*s;e.Ra=i,e.bb=n,e.oa=r,e.pa=a}function b(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Ur-8>>>0,++e.bb,e.u-=8;j(e)&&(e.h=1,e.u=0)}function v(e,r){if(t(0<=r),!e.h&&r<=Br){var a=N(e)&Mr[r];return e.u+=r,b(e),a}return e.h=1,e.u=0}function y(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function N(e){return e.Ra>>>(e.u&Ur-1)>>>0}function j(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Ur}function k(e,t){e.u=t,e.h=j(e)}function S(e){e.u>=zr&&(t(e.u>=zr),b(e))}function A(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function C(e){return p(e,1)}function _(e,t){var r=e.Ca;0>e.b&&A(e);var a=e.b,n=r*t>>>8,s=(e.I>>>a>n)+0;for(s?(r-=n,e.I-=n+1<<a>>>0):r=n+1,a=r,n=0;256<=a;)n+=8,a>>=8;return a=7^n+qr[a],e.b-=a,e.Ca=(r<<a)-1,s}function T(e,t,r){e[t+0]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function E(e,t){return e[t+0]|e[t+1]<<8}function L(e,t){return E(e,t)|e[t+2]<<16}function P(e,t){return E(e,t)|E(e,t+2)<<16}function O(e,r){var a=1<<r;return t(null!=e),t(0<r),e.X=s(a),null==e.X?0:(e.Mb=32-r,e.Xa=r,1)}function F(e,r){t(null!=e),t(null!=r),t(e.Xa==r.Xa),a(r.X,0,e.X,0,1<<r.Xa)}function D(){this.X=[],this.Xa=this.Mb=0}function I(e,r,a,n){t(null!=a),t(null!=n);var s=a[0],i=n[0];return 0==s&&(s=(e*i+r/2)/r),0==i&&(i=(r*s+e/2)/e),0>=s||0>=i?0:(a[0]=s,n[0]=i,1)}function R(e,t){return e+(1<<t)-1>>>t}function M(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function B(t,r){e[r]=function(r,a,n,s,i,l,o){var c;for(c=0;c<i;++c){var d=e[t](l[o+c-1],n,s+c);l[o+c]=M(r[a+c],d)}}}function U(){this.ud=this.hd=this.jd=0}function z(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function q(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function H(e,t){return q(e+(e-t+.5>>1))}function W(e,t,r){return Math.abs(t-r)-Math.abs(e-r)}function V(e,t,r,a,n,s,i){for(a=s[i-1],r=0;r<n;++r)s[i+r]=a=M(e[t+r],a)}function G(e,t,r,a,n){var s;for(s=0;s<r;++s){var i=e[t+s],l=i>>8&255,o=16711935&(o=(o=16711935&i)+((l<<16)+l));a[n+s]=(4278255360&i)+o>>>0}}function K(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function Y(e,t,r,a,n,s){var i;for(i=0;i<a;++i){var l=t[r+i],o=l>>>8,c=l,d=255&(d=(d=l>>>16)+((e.jd<<24>>24)*(o<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(o<<24>>24)>>>5)+((e.ud<<24>>24)*(d<<24>>24)>>>5)),n[s+i]=(4278255360&l)+(d<<16)+c}}function X(t,r,a,n,s){e[r]=function(e,t,r,a,i,l,o,c,d){for(a=o;a<c;++a)for(o=0;o<d;++o)i[l++]=s(r[n(e[t++])])},e[t]=function(t,r,i,l,o,c,d){var u=8>>t.b,h=t.Ea,f=t.K[0],m=t.w;if(8>u)for(t=(1<<t.b)-1,m=(1<<u)-1;r<i;++r){var p,g=0;for(p=0;p<h;++p)p&t||(g=n(l[o++])),c[d++]=s(f[g&m]),g>>=u}else e["VP8LMapColor"+a](l,o,f,m,c,d,r,i,h)}}function $(e,t,r,a,n){for(r=t+r;t<r;){var s=e[t++];a[n++]=s>>16&255,a[n++]=s>>8&255,a[n++]=255&s}}function J(e,t,r,a,n){for(r=t+r;t<r;){var s=e[t++];a[n++]=s>>16&255,a[n++]=s>>8&255,a[n++]=255&s,a[n++]=s>>24&255}}function Q(e,t,r,a,n){for(r=t+r;t<r;){var s=(i=e[t++])>>16&240|i>>12&15,i=240&i|i>>28&15;a[n++]=s,a[n++]=i}}function Z(e,t,r,a,n){for(r=t+r;t<r;){var s=(i=e[t++])>>16&248|i>>13&7,i=i>>5&224|i>>3&31;a[n++]=s,a[n++]=i}}function ee(e,t,r,a,n){for(r=t+r;t<r;){var s=e[t++];a[n++]=255&s,a[n++]=s>>8&255,a[n++]=s>>16&255}}function te(e,t,r,n,s,i){if(0==i)for(r=t+r;t<r;)T(n,((i=e[t++])[0]>>24|i[1]>>8&65280|i[2]<<8&16711680|i[3]<<24)>>>0),s+=32;else a(n,s,e,t,r)}function re(t,r){e[r][0]=e[t+"0"],e[r][1]=e[t+"1"],e[r][2]=e[t+"2"],e[r][3]=e[t+"3"],e[r][4]=e[t+"4"],e[r][5]=e[t+"5"],e[r][6]=e[t+"6"],e[r][7]=e[t+"7"],e[r][8]=e[t+"8"],e[r][9]=e[t+"9"],e[r][10]=e[t+"10"],e[r][11]=e[t+"11"],e[r][12]=e[t+"12"],e[r][13]=e[t+"13"],e[r][14]=e[t+"0"],e[r][15]=e[t+"0"]}function ae(e){return e==za||e==qa||e==Ha||e==Wa}function ne(){this.eb=[],this.size=this.A=this.fb=0}function se(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ie(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ne,this.f.kb=new se,this.sd=null}function le(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function oe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function de(e,t){var r=e.T,n=t.ba.f.RGBA,s=n.eb,i=n.fb+e.ka*n.A,l=gn[t.ba.S],o=e.y,c=e.O,d=e.f,u=e.N,h=e.ea,f=e.W,m=t.cc,p=t.dc,g=t.Mc,x=t.Nc,b=e.ka,v=e.ka+e.T,y=e.U,w=y+1>>1;for(0==b?l(o,c,null,null,d,u,h,f,d,u,h,f,s,i,null,null,y):(l(t.ec,t.fc,o,c,m,p,g,x,d,u,h,f,s,i-n.A,s,i,y),++r);b+2<v;b+=2)m=d,p=u,g=h,x=f,u+=e.Rc,f+=e.Rc,i+=2*n.A,l(o,(c+=2*e.fa)-e.fa,o,c,m,p,g,x,d,u,h,f,s,i-n.A,s,i,y);return c+=e.fa,e.j+v<e.o?(a(t.ec,t.fc,o,c,y),a(t.cc,t.dc,d,u,w),a(t.Mc,t.Nc,h,f,w),r--):1&v||l(o,c,null,null,d,u,h,f,d,u,h,f,s,i+n.A,null,null,y),r}function ue(e,r,a){var n=e.F,s=[e.J];if(null!=n){var i=e.U,l=r.ba.S,o=l==Ma||l==Ha;r=r.ba.f.RGBA;var c=[0],d=e.ka;c[0]=e.T,e.Kb&&(0==d?--c[0]:(--d,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-d));var u=r.eb;d=r.fb+d*r.A,e=ja(n,s[0],e.width,i,c,u,d+(o?0:3),r.A),t(a==c),e&&ae(l)&&wa(u,d,o,i,c,r.A)}return 0}function he(e){var t=e.ma,r=t.ba.S,a=11>r,n=r==Da||r==Ra||r==Ma||r==Ba||12==r||ae(r);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Fr(t.Oa,e,n?11:12))return 0;if(n&&ae(r)&&xr(),e.da)alert("todo:use_scaling");else{if(a){if(t.Ib=ce,e.Kb){if(r=e.U+1>>1,t.memory=s(e.U+2*r),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+r,t.Ib=de,xr()}}else alert("todo:EmitYUV");n&&(t.Jb=ue,a&&pr())}if(a&&!En){for(e=0;256>e;++e)Ln[e]=89858*(e-128)+Sn>>kn,Fn[e]=-22014*(e-128)+Sn,On[e]=-45773*(e-128),Pn[e]=113618*(e-128)+Sn>>kn;for(e=An;e<Cn;++e)t=76283*(e-16)+Sn>>kn,Dn[e-An]=Ve(t,255),In[e-An]=Ve(t+8>>4,15);En=1}return 1}function fe(e){var r=e.ma,a=e.U,n=e.T;return t(!(1&e.ka)),0>=a||0>=n?0:(a=r.Ib(e,r),null!=r.Jb&&r.Jb(e,r,a),r.Dc+=a,1)}function me(e){e.ma.memory=null}function pe(e,t,r,a){return 47!=v(e,8)?0:(t[0]=v(e,14)+1,r[0]=v(e,14)+1,a[0]=v(e,1),0!=v(e,3)?0:!e.h)}function ge(e,t){if(4>e)return e+1;var r=e-2>>1;return(2+(1&e)<<r)+v(t,r)+1}function xe(e,t){return 120<t?t-120:1<=(r=((r=$a[t-1])>>4)*e+(8-(15&r)))?r:1;var r}function be(e,t,r){var a=N(r),n=e[t+=255&a].g-8;return 0<n&&(k(r,r.u+8),a=N(r),t+=e[t].value,t+=a&(1<<n)-1),k(r,r.u+e[t].g),e[t].value}function ve(e,r,a){return a.g+=e.g,a.value+=e.value<<r>>>0,t(8>=a.g),e.g}function ye(e,r,a){var n=e.xc;return t((r=0==n?0:e.vc[e.md*(a>>n)+(r>>n)])<e.Wb),e.Ya[r]}function we(e,r,n,s){var i=e.ab,l=e.c*r,o=e.C;r=o+r;var c=n,d=s;for(s=e.Ta,n=e.Ua;0<i--;){var u=e.gc[i],h=o,f=r,m=c,p=d,g=(d=s,c=n,u.Ea);switch(t(h<f),t(f<=u.nc),u.hc){case 2:Vr(m,p,(f-h)*g,d,c);break;case 0:var x=h,b=f,v=d,y=c,w=(A=u).Ea;0==x&&(Hr(m,p,null,null,1,v,y),V(m,p+1,0,0,w-1,v,y+1),p+=w,y+=w,++x);for(var N=1<<A.b,j=N-1,k=R(w,A.b),S=A.K,A=A.w+(x>>A.b)*k;x<b;){var C=S,_=A,T=1;for(Wr(m,p,v,y-w,1,v,y);T<w;){var E=(T&~j)+N;E>w&&(E=w),(0,$r[C[_++]>>8&15])(m,p+ +T,v,y+T-w,E-T,v,y+T),T=E}p+=w,y+=w,++x&j||(A+=k)}f!=u.nc&&a(d,c-g,d,c+(f-h-1)*g,g);break;case 1:for(g=m,b=p,w=(m=u.Ea)-(y=m&~(v=(p=1<<u.b)-1)),x=R(m,u.b),N=u.K,u=u.w+(h>>u.b)*x;h<f;){for(j=N,k=u,S=new U,A=b+y,C=b+m;b<A;)K(j[k++],S),Jr(S,g,b,p,d,c),b+=p,c+=p;b<C&&(K(j[k++],S),Jr(S,g,b,w,d,c),b+=w,c+=w),++h&v||(u+=x)}break;case 3:if(m==d&&p==c&&0<u.b){for(b=d,m=g=c+(f-h)*g-(y=(f-h)*R(u.Ea,u.b)),p=d,v=c,x=[],y=(w=y)-1;0<=y;--y)x[y]=p[v+y];for(y=w-1;0<=y;--y)b[m+y]=x[y];Gr(u,h,f,d,g,d,c)}else Gr(u,h,f,m,p,d,c)}c=s,d=n}d!=n&&a(s,n,c,d,l)}function Ne(e,r){var a=e.V,n=e.Ba+e.c*e.C,s=r-e.C;if(t(r<=e.l.o),t(16>=s),0<s){var i=e.l,l=e.Ta,o=e.Ua,c=i.width;if(we(e,s,a,n),s=o=[o],t((a=e.C)<(n=r)),t(i.v<i.va),n>i.o&&(n=i.o),a<i.j){var d=i.j-a;a=i.j,s[0]+=d*c}if(a>=n?a=0:(s[0]+=4*i.v,i.ka=a-i.j,i.U=i.va-i.v,i.T=n-a,a=1),a){if(o=o[0],11>(a=e.ca).S){var u=a.f.RGBA,h=(n=a.S,s=i.U,i=i.T,d=u.eb,u.A),f=i;for(u=u.fb+e.Ma*u.A;0<f--;){var m=l,p=o,g=s,x=d,b=u;switch(n){case Fa:Qr(m,p,g,x,b);break;case Da:Zr(m,p,g,x,b);break;case za:Zr(m,p,g,x,b),wa(x,b,0,g,1,0);break;case Ia:ra(m,p,g,x,b);break;case Ra:te(m,p,g,x,b,1);break;case qa:te(m,p,g,x,b,1),wa(x,b,0,g,1,0);break;case Ma:te(m,p,g,x,b,0);break;case Ha:te(m,p,g,x,b,0),wa(x,b,1,g,1,0);break;case Ba:ea(m,p,g,x,b);break;case Wa:ea(m,p,g,x,b),Na(x,b,g,1,0);break;case Ua:ta(m,p,g,x,b);break;default:t(0)}o+=c,u+=h}e.Ma+=i}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=a.height)}}e.C=r,t(e.C<=e.i)}function je(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var r=e.Ya[t].G,a=e.Ya[t].H;if(0<r[1][a[1]+0].g||0<r[2][a[2]+0].g||0<r[3][a[3]+0].g)return 0}return 1}function ke(e,r,a,n,s,i){if(0!=e.Z){var l=e.qd,o=e.rd;for(t(null!=pn[e.Z]);r<a;++r)pn[e.Z](l,o,n,s,n,s,i),l=n,o=s,s+=i;e.qd=l,e.rd=o}}function Se(e,r){var a=e.l.ma,n=0==a.Z||1==a.Z?e.l.j:e.C;if(n=e.C<n?n:e.C,t(r<=e.l.o),r>n){var s=e.l.width,i=a.ca,l=a.tb+s*n,o=e.V,c=e.Ba+e.c*n,d=e.gc;t(1==e.ab),t(3==d[0].hc),Yr(d[0],n,r,o,c,i,l),ke(a,n,r,i,l,s)}e.C=e.Ma=r}function Ae(e,r,a,n,s,i,l){var o=e.$/n,c=e.$%n,d=e.m,u=e.s,h=a+e.$,f=h;s=a+n*s;var m=a+n*i,p=280+u.ua,g=e.Pb?o:16777216,x=0<u.ua?u.Wa:null,b=u.wc,v=h<m?ye(u,c,o):null;t(e.C<i),t(m<=s);var y=!1;e:for(;;){for(;y||h<m;){var w=0;if(o>=g){var A=h-a;t((g=e).Pb),g.wd=g.m,g.xd=A,0<g.s.ua&&F(g.s.Wa,g.s.vb),g=o+Qa}if(c&b||(v=ye(u,c,o)),t(null!=v),v.Qb&&(r[h]=v.qb,y=!0),!y)if(S(d),v.jc){w=d,A=r;var C=h,_=v.pd[N(w)&Rr-1];t(v.jc),256>_.g?(k(w,w.u+_.g),A[C]=_.value,w=0):(k(w,w.u+_.g-256),t(256<=_.value),w=_.value),0==w&&(y=!0)}else w=be(v.G[0],v.H[0],d);if(d.h)break;if(y||256>w){if(!y)if(v.nd)r[h]=(v.qb|w<<8)>>>0;else{if(S(d),y=be(v.G[1],v.H[1],d),S(d),A=be(v.G[2],v.H[2],d),C=be(v.G[3],v.H[3],d),d.h)break;r[h]=(C<<24|y<<16|w<<8|A)>>>0}if(y=!1,++h,++c>=n&&(c=0,++o,null!=l&&o<=i&&!(o%16)&&l(e,o),null!=x))for(;f<h;)w=r[f++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else if(280>w){if(w=ge(w-256,d),A=be(v.G[4],v.H[4],d),S(d),A=xe(n,A=ge(A,d)),d.h)break;if(h-a<A||s-h<w)break e;for(C=0;C<w;++C)r[h+C]=r[h+C-A];for(h+=w,c+=w;c>=n;)c-=n,++o,null!=l&&o<=i&&!(o%16)&&l(e,o);if(t(h<=s),c&b&&(v=ye(u,c,o)),null!=x)for(;f<h;)w=r[f++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else{if(!(w<p))break e;for(y=w-280,t(null!=x);f<h;)w=r[f++],x.X[(506832829*w&4294967295)>>>x.Mb]=w;w=h,t(!(y>>>(A=x).Xa)),r[w]=A.X[y],y=!0}y||t(d.h==j(d))}if(e.Pb&&d.h&&h<s)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&F(e.s.vb,e.s.Wa);else{if(d.h)break e;null!=l&&l(e,o>i?i:o),e.a=0,e.$=h-a}return 1}return e.a=3,0}function Ce(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var r=e.Wa;null!=r&&(r.X=null),e.vb=null,t(null!=e)}function _e(){var t=new sr;return null==t?null:(t.a=0,t.xb=mn,re("Predictor","VP8LPredictors"),re("Predictor","VP8LPredictors_C"),re("PredictorAdd","VP8LPredictorsAdd"),re("PredictorAdd","VP8LPredictorsAdd_C"),Vr=G,Jr=Y,Qr=$,Zr=J,ea=Q,ta=Z,ra=ee,e.VP8LMapColor32b=Kr,e.VP8LMapColor8b=Xr,t)}function Te(e,r,a,l,o){var c=1,h=[e],m=[r],p=l.m,g=l.s,x=null,b=0;e:for(;;){if(a)for(;c&&v(p,1);){var y=h,w=m,j=l,A=1,C=j.m,_=j.gc[j.ab],T=v(C,2);if(j.Oc&1<<T)c=0;else{switch(j.Oc|=1<<T,_.hc=T,_.Ea=y[0],_.nc=w[0],_.K=[null],++j.ab,t(4>=j.ab),T){case 0:case 1:_.b=v(C,3)+2,A=Te(R(_.Ea,_.b),R(_.nc,_.b),0,j,_.K),_.K=_.K[0];break;case 3:var E,L=v(C,8)+1,P=16<L?0:4<L?1:2<L?2:3;if(y[0]=R(_.Ea,P),_.b=P,E=A=Te(L,1,0,j,_.K)){var F,D=L,I=_,B=1<<(8>>I.b),U=s(B);if(null==U)E=0;else{var z=I.K[0],q=I.w;for(U[0]=I.K[0][0],F=1;F<1*D;++F)U[F]=M(z[q+F],U[F-1]);for(;F<4*B;++F)U[F]=0;I.K[0]=null,I.K[0]=U,E=1}}A=E;break;case 2:break;default:t(0)}c=A}}if(h=h[0],m=m[0],c&&v(p,1)&&!(c=1<=(b=v(p,4))&&11>=b)){l.a=3;break e}var H;if(H=c)t:{var W,V,G,K=l,Y=h,X=m,$=b,J=a,Q=K.m,Z=K.s,ee=[null],te=1,re=0,ae=Ja[$];r:for(;;){if(J&&v(Q,1)){var ne=v(Q,3)+2,se=R(Y,ne),ie=R(X,ne),le=se*ie;if(!Te(se,ie,0,K,ee))break r;for(ee=ee[0],Z.xc=ne,W=0;W<le;++W){var oe=ee[W]>>8&65535;ee[W]=oe,oe>=te&&(te=oe+1)}}if(Q.h)break r;for(V=0;5>V;++V){var ce=Ka[V];!V&&0<$&&(ce+=1<<$),re<ce&&(re=ce)}var de=i(te*ae,u),ue=te,he=i(ue,f);if(null==he)var fe=null;else t(65536>=ue),fe=he;var me=s(re);if(null==fe||null==me||null==de){K.a=1;break r}var pe=de;for(W=G=0;W<te;++W){var ge=fe[W],xe=ge.G,be=ge.H,ye=0,we=1,Ne=0;for(V=0;5>V;++V){ce=Ka[V],xe[V]=pe,be[V]=G,!V&&0<$&&(ce+=1<<$);a:{var je,ke=ce,Se=K,_e=me,Ee=pe,Le=G,Pe=0,Oe=Se.m,Fe=v(Oe,1);if(n(_e,0,0,ke),Fe){var De=v(Oe,1)+1,Ie=v(Oe,1),Re=v(Oe,0==Ie?1:8);_e[Re]=1,2==De&&(_e[Re=v(Oe,8)]=1);var Me=1}else{var Be=s(19),Ue=v(Oe,4)+4;if(19<Ue){Se.a=3;var ze=0;break a}for(je=0;je<Ue;++je)Be[Xa[je]]=v(Oe,3);var qe=void 0,He=void 0,We=Se,Ve=Be,Ge=ke,Ke=_e,Ye=0,Xe=We.m,$e=8,Je=i(128,u);n:for(;d(Je,0,7,Ve,19);){if(v(Xe,1)){var Qe=2+2*v(Xe,3);if((qe=2+v(Xe,Qe))>Ge)break n}else qe=Ge;for(He=0;He<Ge&&qe--;){S(Xe);var Ze=Je[0+(127&N(Xe))];k(Xe,Xe.u+Ze.g);var et=Ze.value;if(16>et)Ke[He++]=et,0!=et&&($e=et);else{var tt=16==et,rt=et-16,at=Ga[rt],nt=v(Xe,Va[rt])+at;if(He+nt>Ge)break n;for(var st=tt?$e:0;0<nt--;)Ke[He++]=st}}Ye=1;break n}Ye||(We.a=3),Me=Ye}(Me=Me&&!Oe.h)&&(Pe=d(Ee,Le,8,_e,ke)),Me&&0!=Pe?ze=Pe:(Se.a=3,ze=0)}if(0==ze)break r;if(we&&1==Ya[V]&&(we=0==pe[G].g),ye+=pe[G].g,G+=ze,3>=V){var it,lt=me[0];for(it=1;it<ce;++it)me[it]>lt&&(lt=me[it]);Ne+=lt}}if(ge.nd=we,ge.Qb=0,we&&(ge.qb=(xe[3][be[3]+0].value<<24|xe[1][be[1]+0].value<<16|xe[2][be[2]+0].value)>>>0,0==ye&&256>xe[0][be[0]+0].value&&(ge.Qb=1,ge.qb+=xe[0][be[0]+0].value<<8)),ge.jc=!ge.Qb&&6>Ne,ge.jc){var ot,ct=ge;for(ot=0;ot<Rr;++ot){var dt=ot,ut=ct.pd[dt],ht=ct.G[0][ct.H[0]+dt];256<=ht.value?(ut.g=ht.g+256,ut.value=ht.value):(ut.g=0,ut.value=0,dt>>=ve(ht,8,ut),dt>>=ve(ct.G[1][ct.H[1]+dt],16,ut),dt>>=ve(ct.G[2][ct.H[2]+dt],0,ut),ve(ct.G[3][ct.H[3]+dt],24,ut))}}}Z.vc=ee,Z.Wb=te,Z.Ya=fe,Z.yc=de,H=1;break t}H=0}if(!(c=H)){l.a=3;break e}if(0<b){if(g.ua=1<<b,!O(g.Wa,b)){l.a=1,c=0;break e}}else g.ua=0;var ft=l,mt=h,pt=m,gt=ft.s,xt=gt.xc;if(ft.c=mt,ft.i=pt,gt.md=R(mt,xt),gt.wc=0==xt?-1:(1<<xt)-1,a){l.xb=fn;break e}if(null==(x=s(h*m))){l.a=1,c=0;break e}c=(c=Ae(l,x,0,h,m,m,null))&&!p.h;break e}return c?(null!=o?o[0]=x:(t(null==x),t(a)),l.$=0,a||Ce(g)):Ce(g),c}function Ee(e,r){var a=e.c*e.i,n=a+r+16*r;return t(e.c<=r),e.V=s(n),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+a+r,1)}function Le(e,r){var a=e.C,n=r-a,s=e.V,i=e.Ba+e.c*a;for(t(r<=e.l.o);0<n;){var l=16<n?16:n,o=e.l.ma,c=e.l.width,d=c*l,u=o.ca,h=o.tb+c*a,f=e.Ta,m=e.Ua;we(e,l,s,i),ka(f,m,u,h,d),ke(o,a,a+l,u,h,c),n-=l,s+=l*e.c,a+=l}t(a==r),e.C=e.Ma=r}function Pe(){this.ub=this.yd=this.td=this.Rb=0}function Oe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Fe(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function De(){this.Yb=function(){var e=[];return function e(t,r,a){for(var n=a[r],s=0;s<n&&(t.push(a.length>r+1?[]:0),!(a.length<r+1));s++)e(t[s],r+1,a)}(e,0,[3,11]),e}()}function Ie(){this.jb=s(3),this.Wc=l([4,8],De),this.Xc=l([4,17],De)}function Re(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Me(){this.ld=this.La=this.dd=this.tc=0}function Be(){this.Na=this.la=0}function Ue(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ze(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qe(){this.uc=this.M=this.Nb=0,this.wa=Array(new Me),this.Y=0,this.ya=Array(new ze),this.aa=0,this.l=new Ge}function He(){this.y=s(16),this.f=s(8),this.ea=s(8)}function We(){this.cb=this.a=0,this.sc="",this.m=new y,this.Od=new Pe,this.Kc=new Oe,this.ed=new Re,this.Qa=new Fe,this.Ic=this.$c=this.Aa=0,this.D=new qe,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,y),this.ia=0,this.pb=i(4,Ue),this.Pa=new Ie,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new He),this.Hd=0,this.rb=Array(new Be),this.sb=0,this.wa=Array(new Me),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ze),this.L=this.aa=0,this.gd=l([4,2],Me),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ve(e,t){return 0>e?0:e>t?t:e}function Ge(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ke(){var e=new We;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,tn||(tn=Je)),e}function Ye(e,t,r){return 0==e.a&&(e.a=t,e.sc=r,e.cb=0),0}function Xe(e,t,r){return 3<=r&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function $e(e,r){if(null==e)return 0;if(e.a=0,e.sc="OK",null==r)return Ye(e,2,"null VP8Io passed to VP8GetHeaders()");var a=r.data,s=r.w,i=r.ha;if(4>i)return Ye(e,7,"Truncated header.");var l=a[s+0]|a[s+1]<<8|a[s+2]<<16,o=e.Od;if(o.Rb=!(1&l),o.td=l>>1&7,o.yd=l>>4&1,o.ub=l>>5,3<o.td)return Ye(e,3,"Incorrect keyframe parameters.");if(!o.yd)return Ye(e,4,"Frame not displayable.");s+=3,i-=3;var c=e.Kc;if(o.Rb){if(7>i)return Ye(e,7,"cannot parse picture header");if(!Xe(a,s,i))return Ye(e,3,"Bad code word");c.c=16383&(a[s+4]<<8|a[s+3]),c.Td=a[s+4]>>6,c.i=16383&(a[s+6]<<8|a[s+5]),c.Ud=a[s+6]>>6,s+=7,i-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,r.width=c.c,r.height=c.i,r.Da=0,r.j=0,r.v=0,r.va=r.width,r.o=r.height,r.da=0,r.ib=r.width,r.hb=r.height,r.U=r.width,r.T=r.height,n((l=e.Pa).jb,0,255,l.jb.length),t(null!=(l=e.Qa)),l.Cb=0,l.Bb=0,l.Fb=1,n(l.Zb,0,0,l.Zb.length),n(l.Lb,0,0,l.Lb)}if(o.ub>i)return Ye(e,7,"bad partition length");m(l=e.m,a,s,o.ub),s+=o.ub,i-=o.ub,o.Rb&&(c.Ld=C(l),c.Kd=C(l)),c=e.Qa;var d,u=e.Pa;if(t(null!=l),t(null!=c),c.Cb=C(l),c.Cb){if(c.Bb=C(l),C(l)){for(c.Fb=C(l),d=0;4>d;++d)c.Zb[d]=C(l)?g(l,7):0;for(d=0;4>d;++d)c.Lb[d]=C(l)?g(l,6):0}if(c.Bb)for(d=0;3>d;++d)u.jb[d]=C(l)?p(l,8):255}else c.Bb=0;if(l.Ka)return Ye(e,3,"cannot parse segment header");if((c=e.ed).zd=C(l),c.Tb=p(l,6),c.wb=p(l,3),c.Pc=C(l),c.Pc&&C(l)){for(u=0;4>u;++u)C(l)&&(c.vd[u]=g(l,6));for(u=0;4>u;++u)C(l)&&(c.od[u]=g(l,6))}if(e.L=0==c.Tb?0:c.zd?1:2,l.Ka)return Ye(e,3,"cannot parse filter header");var h=i;if(i=d=s,s=d+h,c=h,e.Xb=(1<<p(e.m,2))-1,h<3*(u=e.Xb))a=7;else{for(d+=3*u,c-=3*u,h=0;h<u;++h){var f=a[i+0]|a[i+1]<<8|a[i+2]<<16;f>c&&(f=c),m(e.Jc[+h],a,d,f),d+=f,c-=f,i+=3}m(e.Jc[+u],a,d,c),a=d<s?0:5}if(0!=a)return Ye(e,a,"cannot parse partitions");for(a=p(d=e.m,7),i=C(d)?g(d,4):0,s=C(d)?g(d,4):0,c=C(d)?g(d,4):0,u=C(d)?g(d,4):0,d=C(d)?g(d,4):0,h=e.Qa,f=0;4>f;++f){if(h.Cb){var x=h.Zb[f];h.Fb||(x+=a)}else{if(0<f){e.pb[f]=e.pb[0];continue}x=a}var b=e.pb[f];b.Sc[0]=Za[Ve(x+i,127)],b.Sc[1]=en[Ve(x+0,127)],b.Eb[0]=2*Za[Ve(x+s,127)],b.Eb[1]=101581*en[Ve(x+c,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=Za[Ve(x+u,117)],b.Qc[1]=en[Ve(x+d,127)],b.lc=x+d}if(!o.Rb)return Ye(e,4,"Not a key frame.");for(C(l),o=e.Pa,a=0;4>a;++a){for(i=0;8>i;++i)for(s=0;3>s;++s)for(c=0;11>c;++c)u=_(l,on[a][i][s][c])?p(l,8):sn[a][i][s][c],o.Wc[a][i].Yb[s][c]=u;for(i=0;17>i;++i)o.Xc[a][i]=o.Wc[a][cn[i]]}return e.kc=C(l),e.kc&&(e.Bd=p(l,8)),e.cb=1}function Je(e,t,r,a,n,s,i){var l=t[n].Yb[r];for(r=0;16>n;++n){if(!_(e,l[r+0]))return n;for(;!_(e,l[r+1]);)if(l=t[++n].Yb[0],r=0,16==n)return 16;var o=t[n+1].Yb;if(_(e,l[r+2])){var c=e,d=0;if(_(c,(h=l)[(u=r)+3]))if(_(c,h[u+6])){for(l=0,u=2*(d=_(c,h[u+8]))+(h=_(c,h[u+9+d])),d=0,h=rn[u];h[l];++l)d+=d+_(c,h[l]);d+=3+(8<<u)}else _(c,h[u+7])?(d=7+2*_(c,165),d+=_(c,145)):d=5+_(c,159);else d=_(c,h[u+4])?3+_(c,h[u+5]):2;l=o[2]}else d=1,l=o[1];o=i+an[n],0>(c=e).b&&A(c);var u,h=c.b,f=(u=c.Ca>>1)-(c.I>>h)>>31;--c.b,c.Ca+=f,c.Ca|=1,c.I-=(u+1&f)<<h,s[o]=((d^f)-f)*a[(0<n)+0]}return 16}function Qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,n(e.zc,0,0,e.zc.length),e.ja=0}function Ze(e,t,r,a,n){n=e[t+r+32*a]+(n>>3),e[t+r+32*a]=-256&n?0>n?0:255:n}function et(e,t,r,a,n,s){Ze(e,t,0,r,a+n),Ze(e,t,1,r,a+s),Ze(e,t,2,r,a-s),Ze(e,t,3,r,a-n)}function tt(e){return(20091*e>>16)+e}function rt(e,t,r,a){var n,i=0,l=s(16);for(n=0;4>n;++n){var o=e[t+0]+e[t+8],c=e[t+0]-e[t+8],d=(35468*e[t+4]>>16)-tt(e[t+12]),u=tt(e[t+4])+(35468*e[t+12]>>16);l[i+0]=o+u,l[i+1]=c+d,l[i+2]=c-d,l[i+3]=o-u,i+=4,t++}for(n=i=0;4>n;++n)o=(e=l[i+0]+4)+l[i+8],c=e-l[i+8],d=(35468*l[i+4]>>16)-tt(l[i+12]),Ze(r,a,0,0,o+(u=tt(l[i+4])+(35468*l[i+12]>>16))),Ze(r,a,1,0,c+d),Ze(r,a,2,0,c-d),Ze(r,a,3,0,o-u),i++,a+=32}function at(e,t,r,a){var n=e[t+0]+4,s=35468*e[t+4]>>16,i=tt(e[t+4]),l=35468*e[t+1]>>16;et(r,a,0,n+i,e=tt(e[t+1]),l),et(r,a,1,n+s,e,l),et(r,a,2,n-s,e,l),et(r,a,3,n-i,e,l)}function nt(e,t,r,a,n){rt(e,t,r,a),n&&rt(e,t+16,r,a+4)}function st(e,t,r,a){na(e,t+0,r,a,1),na(e,t+32,r,a+128,1)}function it(e,t,r,a){var n;for(e=e[t+0]+4,n=0;4>n;++n)for(t=0;4>t;++t)Ze(r,a,t,n,e)}function lt(e,t,r,a){e[t+0]&&la(e,t+0,r,a),e[t+16]&&la(e,t+16,r,a+4),e[t+32]&&la(e,t+32,r,a+128),e[t+48]&&la(e,t+48,r,a+128+4)}function ot(e,t,r,a){var n,i=s(16);for(n=0;4>n;++n){var l=e[t+0+n]+e[t+12+n],o=e[t+4+n]+e[t+8+n],c=e[t+4+n]-e[t+8+n],d=e[t+0+n]-e[t+12+n];i[0+n]=l+o,i[8+n]=l-o,i[4+n]=d+c,i[12+n]=d-c}for(n=0;4>n;++n)l=(e=i[0+4*n]+3)+i[3+4*n],o=i[1+4*n]+i[2+4*n],c=i[1+4*n]-i[2+4*n],d=e-i[3+4*n],r[a+0]=l+o>>3,r[a+16]=d+c>>3,r[a+32]=l-o>>3,r[a+48]=d-c>>3,a+=64}function ct(e,t,r){var a,n=t-32,s=Pa,i=255-e[n-1];for(a=0;a<r;++a){var l,o=s,c=i+e[t-1];for(l=0;l<r;++l)e[t+l]=o[c+e[n+l]];t+=32}}function dt(e,t){ct(e,t,4)}function ut(e,t){ct(e,t,8)}function ht(e,t){ct(e,t,16)}function ft(e,t){var r;for(r=0;16>r;++r)a(e,t+32*r,e,t-32,16)}function mt(e,t){var r;for(r=16;0<r;--r)n(e,t,e[t-1],16),t+=32}function pt(e,t,r){var a;for(a=0;16>a;++a)n(t,r+32*a,e,16)}function gt(e,t){var r,a=16;for(r=0;16>r;++r)a+=e[t-1+32*r]+e[t+r-32];pt(a>>5,e,t)}function xt(e,t){var r,a=8;for(r=0;16>r;++r)a+=e[t-1+32*r];pt(a>>4,e,t)}function bt(e,t){var r,a=8;for(r=0;16>r;++r)a+=e[t+r-32];pt(a>>4,e,t)}function vt(e,t){pt(128,e,t)}function yt(e,t,r){return e+2*t+r+2>>2}function wt(e,t){var r,n=t-32;for(n=new Uint8Array([yt(e[n-1],e[n+0],e[n+1]),yt(e[n+0],e[n+1],e[n+2]),yt(e[n+1],e[n+2],e[n+3]),yt(e[n+2],e[n+3],e[n+4])]),r=0;4>r;++r)a(e,t+32*r,n,0,n.length)}function Nt(e,t){var r=e[t-1],a=e[t-1+32],n=e[t-1+64],s=e[t-1+96];T(e,t+0,16843009*yt(e[t-1-32],r,a)),T(e,t+32,16843009*yt(r,a,n)),T(e,t+64,16843009*yt(a,n,s)),T(e,t+96,16843009*yt(n,s,s))}function jt(e,t){var r,a=4;for(r=0;4>r;++r)a+=e[t+r-32]+e[t-1+32*r];for(a>>=3,r=0;4>r;++r)n(e,t+32*r,a,4)}function kt(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1-32],i=e[t+0-32],l=e[t+1-32],o=e[t+2-32],c=e[t+3-32];e[t+0+96]=yt(a,n,e[t-1+96]),e[t+1+96]=e[t+0+64]=yt(r,a,n),e[t+2+96]=e[t+1+64]=e[t+0+32]=yt(s,r,a),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=yt(i,s,r),e[t+3+64]=e[t+2+32]=e[t+1+0]=yt(l,i,s),e[t+3+32]=e[t+2+0]=yt(o,l,i),e[t+3+0]=yt(c,o,l)}function St(e,t){var r=e[t+1-32],a=e[t+2-32],n=e[t+3-32],s=e[t+4-32],i=e[t+5-32],l=e[t+6-32],o=e[t+7-32];e[t+0+0]=yt(e[t+0-32],r,a),e[t+1+0]=e[t+0+32]=yt(r,a,n),e[t+2+0]=e[t+1+32]=e[t+0+64]=yt(a,n,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=yt(n,s,i),e[t+3+32]=e[t+2+64]=e[t+1+96]=yt(s,i,l),e[t+3+64]=e[t+2+96]=yt(i,l,o),e[t+3+96]=yt(l,o,o)}function At(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1-32],i=e[t+0-32],l=e[t+1-32],o=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=s+i+1>>1,e[t+1+0]=e[t+2+64]=i+l+1>>1,e[t+2+0]=e[t+3+64]=l+o+1>>1,e[t+3+0]=o+c+1>>1,e[t+0+96]=yt(n,a,r),e[t+0+64]=yt(a,r,s),e[t+0+32]=e[t+1+96]=yt(r,s,i),e[t+1+32]=e[t+2+96]=yt(s,i,l),e[t+2+32]=e[t+3+96]=yt(i,l,o),e[t+3+32]=yt(l,o,c)}function Ct(e,t){var r=e[t+0-32],a=e[t+1-32],n=e[t+2-32],s=e[t+3-32],i=e[t+4-32],l=e[t+5-32],o=e[t+6-32],c=e[t+7-32];e[t+0+0]=r+a+1>>1,e[t+1+0]=e[t+0+64]=a+n+1>>1,e[t+2+0]=e[t+1+64]=n+s+1>>1,e[t+3+0]=e[t+2+64]=s+i+1>>1,e[t+0+32]=yt(r,a,n),e[t+1+32]=e[t+0+96]=yt(a,n,s),e[t+2+32]=e[t+1+96]=yt(n,s,i),e[t+3+32]=e[t+2+96]=yt(s,i,l),e[t+3+64]=yt(i,l,o),e[t+3+96]=yt(l,o,c)}function _t(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1+96];e[t+0+0]=r+a+1>>1,e[t+2+0]=e[t+0+32]=a+n+1>>1,e[t+2+32]=e[t+0+64]=n+s+1>>1,e[t+1+0]=yt(r,a,n),e[t+3+0]=e[t+1+32]=yt(a,n,s),e[t+3+32]=e[t+1+64]=yt(n,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function Tt(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1+96],i=e[t-1-32],l=e[t+0-32],o=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=r+i+1>>1,e[t+0+32]=e[t+2+64]=a+r+1>>1,e[t+0+64]=e[t+2+96]=n+a+1>>1,e[t+0+96]=s+n+1>>1,e[t+3+0]=yt(l,o,c),e[t+2+0]=yt(i,l,o),e[t+1+0]=e[t+3+32]=yt(r,i,l),e[t+1+32]=e[t+3+64]=yt(a,r,i),e[t+1+64]=e[t+3+96]=yt(n,a,r),e[t+1+96]=yt(s,n,a)}function Et(e,t){var r;for(r=0;8>r;++r)a(e,t+32*r,e,t-32,8)}function Lt(e,t){var r;for(r=0;8>r;++r)n(e,t,e[t-1],8),t+=32}function Pt(e,t,r){var a;for(a=0;8>a;++a)n(t,r+32*a,e,8)}function Ot(e,t){var r,a=8;for(r=0;8>r;++r)a+=e[t+r-32]+e[t-1+32*r];Pt(a>>4,e,t)}function Ft(e,t){var r,a=4;for(r=0;8>r;++r)a+=e[t+r-32];Pt(a>>3,e,t)}function Dt(e,t){var r,a=4;for(r=0;8>r;++r)a+=e[t-1+32*r];Pt(a>>3,e,t)}function It(e,t){Pt(128,e,t)}function Rt(e,t,r){var a=e[t-r],n=e[t+0],s=3*(n-a)+Ea[1020+e[t-2*r]-e[t+r]],i=La[112+(s+4>>3)];e[t-r]=Pa[255+a+La[112+(s+3>>3)]],e[t+0]=Pa[255+n-i]}function Mt(e,t,r,a){var n=e[t+0],s=e[t+r];return Oa[255+e[t-2*r]-e[t-r]]>a||Oa[255+s-n]>a}function Bt(e,t,r,a){return 4*Oa[255+e[t-r]-e[t+0]]+Oa[255+e[t-2*r]-e[t+r]]<=a}function Ut(e,t,r,a,n){var s=e[t-3*r],i=e[t-2*r],l=e[t-r],o=e[t+0],c=e[t+r],d=e[t+2*r],u=e[t+3*r];return 4*Oa[255+l-o]+Oa[255+i-c]>a?0:Oa[255+e[t-4*r]-s]<=n&&Oa[255+s-i]<=n&&Oa[255+i-l]<=n&&Oa[255+u-d]<=n&&Oa[255+d-c]<=n&&Oa[255+c-o]<=n}function zt(e,t,r,a){var n=2*a+1;for(a=0;16>a;++a)Bt(e,t+a,r,n)&&Rt(e,t+a,r)}function qt(e,t,r,a){var n=2*a+1;for(a=0;16>a;++a)Bt(e,t+a*r,1,n)&&Rt(e,t+a*r,1)}function Ht(e,t,r,a){var n;for(n=3;0<n;--n)zt(e,t+=4*r,r,a)}function Wt(e,t,r,a){var n;for(n=3;0<n;--n)qt(e,t+=4,r,a)}function Vt(e,t,r,a,n,s,i,l){for(s=2*s+1;0<n--;){if(Ut(e,t,r,s,i))if(Mt(e,t,r,l))Rt(e,t,r);else{var o=e,c=t,d=r,u=o[c-2*d],h=o[c-d],f=o[c+0],m=o[c+d],p=o[c+2*d],g=27*(b=Ea[1020+3*(f-h)+Ea[1020+u-m]])+63>>7,x=18*b+63>>7,b=9*b+63>>7;o[c-3*d]=Pa[255+o[c-3*d]+b],o[c-2*d]=Pa[255+u+x],o[c-d]=Pa[255+h+g],o[c+0]=Pa[255+f-g],o[c+d]=Pa[255+m-x],o[c+2*d]=Pa[255+p-b]}t+=a}}function Gt(e,t,r,a,n,s,i,l){for(s=2*s+1;0<n--;){if(Ut(e,t,r,s,i))if(Mt(e,t,r,l))Rt(e,t,r);else{var o=e,c=t,d=r,u=o[c-d],h=o[c+0],f=o[c+d],m=La[112+(4+(p=3*(h-u))>>3)],p=La[112+(p+3>>3)],g=m+1>>1;o[c-2*d]=Pa[255+o[c-2*d]+g],o[c-d]=Pa[255+u+p],o[c+0]=Pa[255+h-m],o[c+d]=Pa[255+f-g]}t+=a}}function Kt(e,t,r,a,n,s){Vt(e,t,r,1,16,a,n,s)}function Yt(e,t,r,a,n,s){Vt(e,t,1,r,16,a,n,s)}function Xt(e,t,r,a,n,s){var i;for(i=3;0<i;--i)Gt(e,t+=4*r,r,1,16,a,n,s)}function $t(e,t,r,a,n,s){var i;for(i=3;0<i;--i)Gt(e,t+=4,1,r,16,a,n,s)}function Jt(e,t,r,a,n,s,i,l){Vt(e,t,n,1,8,s,i,l),Vt(r,a,n,1,8,s,i,l)}function Qt(e,t,r,a,n,s,i,l){Vt(e,t,1,n,8,s,i,l),Vt(r,a,1,n,8,s,i,l)}function Zt(e,t,r,a,n,s,i,l){Gt(e,t+4*n,n,1,8,s,i,l),Gt(r,a+4*n,n,1,8,s,i,l)}function er(e,t,r,a,n,s,i,l){Gt(e,t+4,1,n,8,s,i,l),Gt(r,a+4,1,n,8,s,i,l)}function tr(){this.ba=new ie,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new oe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ar(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function nr(){this.ua=0,this.Wa=new D,this.vb=new D,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new f,this.yc=new u}function sr(){this.xb=this.a=0,this.l=new Ge,this.ca=new ie,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new nr,this.ab=0,this.gc=i(4,ar),this.Oc=0}function ir(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ge,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function lr(e,t,r,a,n,s,i){for(e=null==e?0:e[t+0],t=0;t<i;++t)n[s+t]=e+r[a+t]&255,e=n[s+t]}function or(e,t,r,a,n,s,i){var l;if(null==e)lr(null,null,r,a,n,s,i);else for(l=0;l<i;++l)n[s+l]=e[t+l]+r[a+l]&255}function cr(e,t,r,a,n,s,i){if(null==e)lr(null,null,r,a,n,s,i);else{var l,o=e[t+0],c=o,d=o;for(l=0;l<i;++l)c=d+(o=e[t+l])-c,d=r[a+l]+(-256&c?0>c?0:255:c)&255,c=o,n[s+l]=d}}function dr(e,r,n,i){var l=r.width,o=r.o;if(t(null!=e&&null!=r),0>n||0>=i||n+i>o)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new ir,(c=null==e.ga)||(c=r.width*r.o,t(0==e.Gb.length),e.Gb=s(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var d=e.Fa,u=e.P,h=e.qc,f=e.mb,m=e.nb,p=u+1,g=h-1,b=c.l;if(t(null!=d&&null!=f&&null!=r),pn[0]=null,pn[1]=lr,pn[2]=or,pn[3]=cr,c.ca=f,c.tb=m,c.c=r.width,c.i=r.height,t(0<c.c&&0<c.i),1>=h)r=0;else if(c.$a=3&d[u+0],c.Z=d[u+0]>>2&3,c.Lc=d[u+0]>>4&3,u=d[u+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||u)r=0;else if(b.put=fe,b.ac=he,b.bc=me,b.ma=c,b.width=r.width,b.height=r.height,b.Da=r.Da,b.v=r.v,b.va=r.va,b.j=r.j,b.o=r.o,c.$a)e:{t(1==c.$a),r=_e();t:for(;;){if(null==r){r=0;break e}if(t(null!=c),c.mc=r,r.c=c.c,r.i=c.i,r.l=c.l,r.l.ma=c,r.l.width=c.c,r.l.height=c.i,r.a=0,x(r.m,d,p,g),!Te(c.c,c.i,1,r,null))break t;if(1==r.ab&&3==r.gc[0].hc&&je(r.s)?(c.ic=1,d=r.c*r.i,r.Ta=null,r.Ua=0,r.V=s(d),r.Ba=0,null==r.V?(r.a=1,r=0):r=1):(c.ic=0,r=Ee(r,c.c)),!r)break t;r=1;break e}c.mc=null,r=0}else r=g>=c.c*c.i;c=!r}if(c)return null;1!=e.ga.Lc?e.Ga=0:i=o-n}t(null!=e.ga),t(n+i<=o);e:{if(r=(d=e.ga).c,o=d.l.o,0==d.$a){if(p=e.rc,g=e.Vc,b=e.Fa,u=e.P+1+n*r,h=e.mb,f=e.nb+n*r,t(u<=e.P+e.qc),0!=d.Z)for(t(null!=pn[d.Z]),c=0;c<i;++c)pn[d.Z](p,g,b,u,h,f,r),p=h,g=f,f+=r,u+=r;else for(c=0;c<i;++c)a(h,f,b,u,r),p=h,g=f,f+=r,u+=r;e.rc=p,e.Vc=g}else{if(t(null!=d.mc),r=n+i,t(null!=(c=d.mc)),t(r<=c.i),c.C>=r)r=1;else if(d.ic||pr(),d.ic){d=c.V,p=c.Ba,g=c.c;var v=c.i,y=(b=1,u=c.$/g,h=c.$%g,f=c.m,m=c.s,c.$),w=g*v,N=g*r,k=m.wc,A=y<N?ye(m,h,u):null;t(y<=w),t(r<=v),t(je(m));t:for(;;){for(;!f.h&&y<N;){if(h&k||(A=ye(m,h,u)),t(null!=A),S(f),256>(v=be(A.G[0],A.H[0],f)))d[p+y]=v,++y,++h>=g&&(h=0,++u<=r&&!(u%16)&&Se(c,u));else{if(!(280>v)){b=0;break t}v=ge(v-256,f);var C,_=be(A.G[4],A.H[4],f);if(S(f),!(y>=(_=xe(g,_=ge(_,f)))&&w-y>=v)){b=0;break t}for(C=0;C<v;++C)d[p+y+C]=d[p+y+C-_];for(y+=v,h+=v;h>=g;)h-=g,++u<=r&&!(u%16)&&Se(c,u);y<N&&h&k&&(A=ye(m,h,u))}t(f.h==j(f))}Se(c,u>r?r:u);break t}!b||f.h&&y<w?(b=0,c.a=f.h?5:3):c.$=y,r=b}else r=Ae(c,c.V,c.Ba,c.c,c.i,r,Le);if(!r){i=0;break e}}n+i>=o&&(e.Cc=1),i=1}if(!i)return null;if(e.Cc&&(null!=(i=e.ga)&&(i.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+n*l}function ur(e,t,r,a,n,s){for(;0<n--;){var i,l=e,o=t+(r?1:0),c=e,d=t+(r?0:3);for(i=0;i<a;++i){var u=c[d+4*i];255!=u&&(u*=32897,l[o+4*i+0]=l[o+4*i+0]*u>>23,l[o+4*i+1]=l[o+4*i+1]*u>>23,l[o+4*i+2]=l[o+4*i+2]*u>>23)}t+=s}}function hr(e,t,r,a,n){for(;0<a--;){var s;for(s=0;s<r;++s){var i=e[t+2*s+0],l=15&(c=e[t+2*s+1]),o=4369*l,c=(240&c|c>>4)*o>>16;e[t+2*s+0]=(240&i|i>>4)*o>>16&240|(15&i|i<<4)*o>>16>>4&15,e[t+2*s+1]=240&c|l}t+=n}}function fr(e,t,r,a,n,s,i,l){var o,c,d=255;for(c=0;c<n;++c){for(o=0;o<a;++o){var u=e[t+o];s[i+4*o]=u,d&=u}t+=r,i+=l}return 255!=d}function mr(e,t,r,a,n){var s;for(s=0;s<n;++s)r[a+s]=e[t+s]>>8}function pr(){wa=ur,Na=hr,ja=fr,ka=mr}function gr(r,a,n){e[r]=function(e,r,s,i,l,o,c,d,u,h,f,m,p,g,x,b,v){var y,w=v-1>>1,N=l[o+0]|c[d+0]<<16,j=u[h+0]|f[m+0]<<16;t(null!=e);var k=3*N+j+131074>>2;for(a(e[r+0],255&k,k>>16,p,g),null!=s&&(k=3*j+N+131074>>2,a(s[i+0],255&k,k>>16,x,b)),y=1;y<=w;++y){var S=l[o+y]|c[d+y]<<16,A=u[h+y]|f[m+y]<<16,C=N+S+j+A+524296,_=C+2*(S+j)>>3;k=_+N>>1,N=(C=C+2*(N+A)>>3)+S>>1,a(e[r+2*y-1],255&k,k>>16,p,g+(2*y-1)*n),a(e[r+2*y-0],255&N,N>>16,p,g+(2*y-0)*n),null!=s&&(k=C+j>>1,N=_+A>>1,a(s[i+2*y-1],255&k,k>>16,x,b+(2*y-1)*n),a(s[i+2*y+0],255&N,N>>16,x,b+(2*y+0)*n)),N=S,j=A}1&v||(k=3*N+j+131074>>2,a(e[r+v-1],255&k,k>>16,p,g+(v-1)*n),null!=s&&(k=3*j+N+131074>>2,a(s[i+v-1],255&k,k>>16,x,b+(v-1)*n)))}}function xr(){gn[Fa]=xn,gn[Da]=vn,gn[Ia]=bn,gn[Ra]=yn,gn[Ma]=wn,gn[Ba]=Nn,gn[Ua]=jn,gn[za]=vn,gn[qa]=yn,gn[Ha]=wn,gn[Wa]=Nn}function br(e){return e&~Tn?0>e?0:255:e>>_n}function vr(e,t){return br((19077*e>>8)+(26149*t>>8)-14234)}function yr(e,t,r){return br((19077*e>>8)-(6419*t>>8)-(13320*r>>8)+8708)}function wr(e,t){return br((19077*e>>8)+(33050*t>>8)-17685)}function Nr(e,t,r,a,n){a[n+0]=vr(e,r),a[n+1]=yr(e,t,r),a[n+2]=wr(e,t)}function jr(e,t,r,a,n){a[n+0]=wr(e,t),a[n+1]=yr(e,t,r),a[n+2]=vr(e,r)}function kr(e,t,r,a,n){var s=yr(e,t,r);t=s<<3&224|wr(e,t)>>3,a[n+0]=248&vr(e,r)|s>>5,a[n+1]=t}function Sr(e,t,r,a,n){var s=240&wr(e,t)|15;a[n+0]=240&vr(e,r)|yr(e,t,r)>>4,a[n+1]=s}function Ar(e,t,r,a,n){a[n+0]=255,Nr(e,t,r,a,n+1)}function Cr(e,t,r,a,n){jr(e,t,r,a,n),a[n+3]=255}function _r(e,t,r,a,n){Nr(e,t,r,a,n),a[n+3]=255}function Tr(t,r,a){e[t]=function(e,t,n,s,i,l,o,c,d){for(var u=c+(-2&d)*a;c!=u;)r(e[t+0],n[s+0],i[l+0],o,c),r(e[t+1],n[s+0],i[l+0],o,c+a),t+=2,++s,++l,c+=2*a;1&d&&r(e[t+0],n[s+0],i[l+0],o,c)}}function Er(e,t,r){return 0==r?0==e?0==t?6:5:0==t?4:0:r}function Lr(e,t,r,a,n){switch(e>>>30){case 3:na(t,r,a,n,0);break;case 2:sa(t,r,a,n);break;case 1:la(t,r,a,n)}}function Pr(e,t){var r,s,i=t.M,l=t.Nb,o=e.oc,c=e.pc+40,d=e.oc,u=e.pc+584,h=e.oc,f=e.pc+600;for(r=0;16>r;++r)o[c+32*r-1]=129;for(r=0;8>r;++r)d[u+32*r-1]=129,h[f+32*r-1]=129;for(0<i?o[c-1-32]=d[u-1-32]=h[f-1-32]=129:(n(o,c-32-1,127,21),n(d,u-32-1,127,9),n(h,f-32-1,127,9)),s=0;s<e.za;++s){var m=t.ya[t.aa+s];if(0<s){for(r=-1;16>r;++r)a(o,c+32*r-4,o,c+32*r+12,4);for(r=-1;8>r;++r)a(d,u+32*r-4,d,u+32*r+4,4),a(h,f+32*r-4,h,f+32*r+4,4)}var p=e.Gd,g=e.Hd+s,x=m.ad,b=m.Hc;if(0<i&&(a(o,c-32,p[g].y,0,16),a(d,u-32,p[g].f,0,8),a(h,f-32,p[g].ea,0,8)),m.Za){var v=o,y=c-32+16;for(0<i&&(s>=e.za-1?n(v,y,p[g].y[15],4):a(v,y,p[g+1].y,0,4)),r=0;4>r;r++)v[y+128+r]=v[y+256+r]=v[y+384+r]=v[y+0+r];for(r=0;16>r;++r,b<<=2)v=o,y=c+Rn[r],un[m.Ob[r]](v,y),Lr(b,x,16*+r,v,y)}else if(v=Er(s,i,m.Ob[0]),dn[v](o,c),0!=b)for(r=0;16>r;++r,b<<=2)Lr(b,x,16*+r,o,c+Rn[r]);for(r=m.Gc,v=Er(s,i,m.Dd),hn[v](d,u),hn[v](h,f),b=x,v=d,y=u,255&(m=0|r)&&(170&m?ia(b,256,v,y):oa(b,256,v,y)),m=h,b=f,255&(r>>=8)&&(170&r?ia(x,320,m,b):oa(x,320,m,b)),i<e.Ub-1&&(a(p[g].y,0,o,c+480,16),a(p[g].f,0,d,u+224,8),a(p[g].ea,0,h,f+224,8)),r=8*l*e.B,p=e.sa,g=e.ta+16*s+16*l*e.R,x=e.qa,m=e.ra+8*s+r,b=e.Ha,v=e.Ia+8*s+r,r=0;16>r;++r)a(p,g+r*e.R,o,c+32*r,16);for(r=0;8>r;++r)a(x,m+r*e.B,d,u+32*r,8),a(b,v+r*e.B,h,f+32*r,8)}}function Or(e,a,n,s,i,l,o,c,d){var u=[0],h=[0],f=0,m=null!=d?d.kd:0,p=null!=d?d:new rr;if(null==e||12>n)return 7;p.data=e,p.w=a,p.ha=n,a=[a],n=[n],p.gb=[p.gb];e:{var g=a,b=n,v=p.gb;if(t(null!=e),t(null!=b),t(null!=v),v[0]=0,12<=b[0]&&!r(e,g[0],"RIFF")){if(r(e,g[0]+8,"WEBP")){v=3;break e}var y=P(e,g[0]+4);if(12>y||4294967286<y){v=3;break e}if(m&&y>b[0]-8){v=7;break e}v[0]=y,g[0]+=12,b[0]-=12}v=0}if(0!=v)return v;for(y=0<p.gb[0],n=n[0];;){e:{var N=e;b=a,v=n;var j=u,k=h,S=g=[0];if((_=f=[f])[0]=0,8>v[0])v=7;else{if(!r(N,b[0],"VP8X")){if(10!=P(N,b[0]+4)){v=3;break e}if(18>v[0]){v=7;break e}var A=P(N,b[0]+8),C=1+L(N,b[0]+12);if(2147483648<=C*(N=1+L(N,b[0]+15))){v=3;break e}null!=S&&(S[0]=A),null!=j&&(j[0]=C),null!=k&&(k[0]=N),b[0]+=18,v[0]-=18,_[0]=1}v=0}}if(f=f[0],g=g[0],0!=v)return v;if(b=!!(2&g),!y&&f)return 3;if(null!=l&&(l[0]=!!(16&g)),null!=o&&(o[0]=b),null!=c&&(c[0]=0),o=u[0],g=h[0],f&&b&&null==d){v=0;break}if(4>n){v=7;break}if(y&&f||!y&&!f&&!r(e,a[0],"ALPH")){n=[n],p.na=[p.na],p.P=[p.P],p.Sa=[p.Sa];e:{A=e,v=a,y=n;var _=p.gb;j=p.na,k=p.P,S=p.Sa,C=22,t(null!=A),t(null!=y),N=v[0];var T=y[0];for(t(null!=j),t(null!=S),j[0]=null,k[0]=null,S[0]=0;;){if(v[0]=N,y[0]=T,8>T){v=7;break e}var E=P(A,N+4);if(4294967286<E){v=3;break e}var O=8+E+1&-2;if(C+=O,0<_&&C>_){v=3;break e}if(!r(A,N,"VP8 ")||!r(A,N,"VP8L")){v=0;break e}if(T[0]<O){v=7;break e}r(A,N,"ALPH")||(j[0]=A,k[0]=N+8,S[0]=E),N+=O,T-=O}}if(n=n[0],p.na=p.na[0],p.P=p.P[0],p.Sa=p.Sa[0],0!=v)break}n=[n],p.Ja=[p.Ja],p.xa=[p.xa];e:if(_=e,v=a,y=n,j=p.gb[0],k=p.Ja,S=p.xa,A=v[0],N=!r(_,A,"VP8 "),C=!r(_,A,"VP8L"),t(null!=_),t(null!=y),t(null!=k),t(null!=S),8>y[0])v=7;else{if(N||C){if(_=P(_,A+4),12<=j&&_>j-12){v=3;break e}if(m&&_>y[0]-8){v=7;break e}k[0]=_,v[0]+=8,y[0]-=8,S[0]=C}else S[0]=5<=y[0]&&47==_[A+0]&&!(_[A+4]>>5),k[0]=y[0];v=0}if(n=n[0],p.Ja=p.Ja[0],p.xa=p.xa[0],a=a[0],0!=v)break;if(4294967286<p.Ja)return 3;if(null==c||b||(c[0]=p.xa?2:1),o=[o],g=[g],p.xa){if(5>n){v=7;break}c=o,m=g,b=l,null==e||5>n?e=0:5<=n&&47==e[a+0]&&!(e[a+4]>>5)?(y=[0],_=[0],j=[0],x(k=new w,e,a,n),pe(k,y,_,j)?(null!=c&&(c[0]=y[0]),null!=m&&(m[0]=_[0]),null!=b&&(b[0]=j[0]),e=1):e=0):e=0}else{if(10>n){v=7;break}c=g,null==e||10>n||!Xe(e,a+3,n-3)?e=0:(m=e[a+0]|e[a+1]<<8|e[a+2]<<16,b=16383&(e[a+7]<<8|e[a+6]),e=16383&(e[a+9]<<8|e[a+8]),1&m||3<(m>>1&7)||!(m>>4&1)||m>>5>=p.Ja||!b||!e?e=0:(o&&(o[0]=b),c&&(c[0]=e),e=1))}if(!e)return 3;if(o=o[0],g=g[0],f&&(u[0]!=o||h[0]!=g))return 3;null!=d&&(d[0]=p,d.offset=a-d.w,t(4294967286>a-d.w),t(d.offset==d.ha-n));break}return 0==v||7==v&&f&&null==d?(null!=l&&(l[0]|=null!=p.na&&0<p.na.length),null!=s&&(s[0]=o),null!=i&&(i[0]=g),0):v}function Fr(e,t,r){var a=t.width,n=t.height,s=0,i=0,l=a,o=n;if(t.Da=null!=e&&0<e.Da,t.Da&&(l=e.cd,o=e.bd,s=e.v,i=e.j,11>r||(s&=-2,i&=-2),0>s||0>i||0>=l||0>=o||s+l>a||i+o>n))return 0;if(t.v=s,t.j=i,t.va=s+l,t.o=i+o,t.U=l,t.T=o,t.da=null!=e&&0<e.da,t.da){if(!I(l,o,r=[e.ib],s=[e.hb]))return 0;t.ib=r[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*a/4&&t.hb<3*n/4,t.Kb=0),1}function Dr(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Ir(e,t,r,a){if(null==a||0>=e||0>=t)return 2;if(null!=r){if(r.Da){var n=r.cd,i=r.bd,l=-2&r.v,o=-2&r.j;if(0>l||0>o||0>=n||0>=i||l+n>e||o+i>t)return 2;e=n,t=i}if(r.da){if(!I(e,t,n=[r.ib],i=[r.hb]))return 2;e=n[0],t=i[0]}}a.width=e,a.height=t;e:{var c=a.width,d=a.height;if(e=a.S,0>=c||0>=d||!(e>=Fa&&13>e))e=2;else{if(0>=a.Rd&&null==a.sd){l=i=n=t=0;var u=(o=c*Un[e])*d;if(11>e||(i=(d+1)/2*(t=(c+1)/2),12==e&&(l=(n=c)*d)),null==(d=s(u+2*i+l))){e=1;break e}a.sd=d,11>e?((c=a.f.RGBA).eb=d,c.fb=0,c.A=o,c.size=u):((c=a.f.kb).y=d,c.O=0,c.fa=o,c.Fd=u,c.f=d,c.N=0+u,c.Ab=t,c.Cd=i,c.ea=d,c.W=0+u+i,c.Db=t,c.Ed=i,12==e&&(c.F=d,c.J=0+u+2*i),c.Tc=l,c.lb=n)}if(t=1,n=a.S,i=a.width,l=a.height,n>=Fa&&13>n)if(11>n)e=a.f.RGBA,t&=(o=Math.abs(e.A))*(l-1)+i<=e.size,t&=o>=i*Un[n],t&=null!=e.eb;else{e=a.f.kb,o=(i+1)/2,u=(l+1)/2,c=Math.abs(e.fa),d=Math.abs(e.Ab);var h=Math.abs(e.Db),f=Math.abs(e.lb),m=f*(l-1)+i;t&=c*(l-1)+i<=e.Fd,t&=d*(u-1)+o<=e.Cd,t=(t&=h*(u-1)+o<=e.Ed)&c>=i&d>=o&h>=o,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==n&&(t&=f>=i,t&=m<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=r&&r.fd&&(e=Dr(a)),e}var Rr=64,Mr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Br=24,Ur=32,zr=8,qr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,r){return t[r+0]},e.Predictor3=function(e,t,r){return t[r+1]},e.Predictor4=function(e,t,r){return t[r-1]},e.Predictor5=function(e,t,r){return z(z(e,t[r+1]),t[r+0])},e.Predictor6=function(e,t,r){return z(e,t[r-1])},e.Predictor7=function(e,t,r){return z(e,t[r+0])},e.Predictor8=function(e,t,r){return z(t[r-1],t[r+0])},e.Predictor9=function(e,t,r){return z(t[r+0],t[r+1])},e.Predictor10=function(e,t,r){return z(z(e,t[r-1]),z(t[r+0],t[r+1]))},e.Predictor11=function(e,t,r){var a=t[r+0];return 0>=W(a>>24&255,e>>24&255,(t=t[r-1])>>24&255)+W(a>>16&255,e>>16&255,t>>16&255)+W(a>>8&255,e>>8&255,t>>8&255)+W(255&a,255&e,255&t)?a:e},e.Predictor12=function(e,t,r){var a=t[r+0];return(q((e>>24&255)+(a>>24&255)-((t=t[r-1])>>24&255))<<24|q((e>>16&255)+(a>>16&255)-(t>>16&255))<<16|q((e>>8&255)+(a>>8&255)-(t>>8&255))<<8|q((255&e)+(255&a)-(255&t)))>>>0},e.Predictor13=function(e,t,r){var a=t[r-1];return(H((e=z(e,t[r+0]))>>24&255,a>>24&255)<<24|H(e>>16&255,a>>16&255)<<16|H(e>>8&255,a>>8&255)<<8|H(255&e,255&a))>>>0};var Hr=e.PredictorAdd0;e.PredictorAdd1=V,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var Wr=e.PredictorAdd2;X("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),X("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Vr,Gr=e.ColorIndexInverseTransform,Kr=e.MapARGB,Yr=e.VP8LColorIndexInverseTransformAlpha,Xr=e.MapAlpha,$r=e.VP8LPredictorsAdd=[];$r.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Jr,Qr,Zr,ea,ta,ra,aa,na,sa,ia,la,oa,ca,da,ua,ha,fa,ma,pa,ga,xa,ba,va,ya,wa,Na,ja,ka,Sa=s(511),Aa=s(2041),Ca=s(225),_a=s(767),Ta=0,Ea=Aa,La=Ca,Pa=_a,Oa=Sa,Fa=0,Da=1,Ia=2,Ra=3,Ma=4,Ba=5,Ua=6,za=7,qa=8,Ha=9,Wa=10,Va=[2,3,7],Ga=[3,3,11],Ka=[280,256,256,256,40],Ya=[0,1,1,1,0],Xa=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],$a=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ja=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Qa=8,Za=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],en=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],tn=null,rn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],an=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nn=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sn=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ln=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],on=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],dn=[],un=[],hn=[],fn=1,mn=2,pn=[],gn=[];gr("UpsampleRgbLinePair",Nr,3),gr("UpsampleBgrLinePair",jr,3),gr("UpsampleRgbaLinePair",_r,4),gr("UpsampleBgraLinePair",Cr,4),gr("UpsampleArgbLinePair",Ar,4),gr("UpsampleRgba4444LinePair",Sr,2),gr("UpsampleRgb565LinePair",kr,2);var xn=e.UpsampleRgbLinePair,bn=e.UpsampleBgrLinePair,vn=e.UpsampleRgbaLinePair,yn=e.UpsampleBgraLinePair,wn=e.UpsampleArgbLinePair,Nn=e.UpsampleRgba4444LinePair,jn=e.UpsampleRgb565LinePair,kn=16,Sn=1<<kn-1,An=-227,Cn=482,_n=6,Tn=(256<<_n)-1,En=0,Ln=s(256),Pn=s(256),On=s(256),Fn=s(256),Dn=s(Cn-An),In=s(Cn-An);Tr("YuvToRgbRow",Nr,3),Tr("YuvToBgrRow",jr,3),Tr("YuvToRgbaRow",_r,4),Tr("YuvToBgraRow",Cr,4),Tr("YuvToArgbRow",Ar,4),Tr("YuvToRgba4444Row",Sr,2),Tr("YuvToRgb565Row",kr,2);var Rn=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Mn=[0,2,8],Bn=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,r,l,o,c){var d=Da,u=new tr,h=new ie;u.ba=h,h.S=d,h.width=[h.width],h.height=[h.height];var f=h.width,m=h.height,p=new le;if(null==p||null==e)var g=2;else t(null!=p),g=Or(e,r,l,p.width,p.height,p.Pd,p.Qd,p.format,null);if(0!=g?f=0:(null!=f&&(f[0]=p.width[0]),null!=m&&(m[0]=p.height[0]),f=1),f){h.width=h.width[0],h.height=h.height[0],null!=o&&(o[0]=h.width),null!=c&&(c[0]=h.height);e:{if(o=new Ge,(c=new rr).data=e,c.w=r,c.ha=l,c.kd=1,r=[0],t(null!=c),(0==(e=Or(c.data,c.w,c.ha,null,null,null,r,null,c))||7==e)&&r[0]&&(e=4),0==(r=e)){if(t(null!=u),o.data=c.data,o.w=c.w+c.offset,o.ha=c.ha-c.offset,o.put=fe,o.ac=he,o.bc=me,o.ma=u,c.xa){if(null==(e=_e())){u=1;break e}if(function(e,r){var a=[0],n=[0],s=[0];t:for(;;){if(null==e)return 0;if(null==r)return e.a=2,0;if(e.l=r,e.a=0,x(e.m,r.data,r.w,r.ha),!pe(e.m,a,n,s)){e.a=3;break t}if(e.xb=mn,r.width=a[0],r.height=n[0],!Te(a[0],n[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,o)){if(o=0==(r=Ir(o.width,o.height,u.Oa,u.ba))){t:{o=e;r:for(;;){if(null==o){o=0;break t}if(t(null!=o.s.yc),t(null!=o.s.Ya),t(0<o.s.Wb),t(null!=(l=o.l)),t(null!=(c=l.ma)),0!=o.xb){if(o.ca=c.ba,o.tb=c.tb,t(null!=o.ca),!Fr(c.Oa,l,Ra)){o.a=2;break r}if(!Ee(o,l.width))break r;if(l.da)break r;if((l.da||ae(o.ca.S))&&pr(),11>o.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=o.ca.f.kb.F&&pr()),o.Pb&&0<o.s.ua&&null==o.s.vb.X&&!O(o.s.vb,o.s.Wa.Xa)){o.a=1;break r}o.xb=0}if(!Ae(o,o.V,o.Ba,o.c,o.i,l.o,Ne))break r;c.Dc=o.Ma,o=1;break t}t(0!=o.a),o=0}o=!o}o&&(r=e.a)}else r=e.a}else{if(null==(e=new Ke)){u=1;break e}if(e.Fa=c.na,e.P=c.P,e.qc=c.Sa,$e(e,o)){if(0==(r=Ir(o.width,o.height,u.Oa,u.ba))){if(e.Aa=0,l=u.Oa,t(null!=(c=e)),null!=l){if(0<(f=0>(f=l.Md)?0:100<f?255:255*f/100)){for(m=p=0;4>m;++m)12>(g=c.pb[m]).lc&&(g.ia=f*Bn[0>g.lc?0:g.lc]>>3),p|=g.ia;p&&(alert("todo:VP8InitRandom"),c.ia=1)}c.Ga=l.Id,100<c.Ga?c.Ga=100:0>c.Ga&&(c.Ga=0)}(function(e,r){if(null==e)return 0;if(null==r)return Ye(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!$e(e,r))return 0;if(t(e.cb),null==r.ac||r.ac(r)){r.ob&&(e.L=0);var l=Mn[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=r.v-l>>4,e.zb=r.j-l>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=r.o+15+l>>4,e.Hb=r.va+15+l>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var o=e.ed;for(l=0;4>l;++l){var c;if(e.Qa.Cb){var d=e.Qa.Lb[l];e.Qa.Fb||(d+=o.Tb)}else d=o.Tb;for(c=0;1>=c;++c){var u=e.gd[l][c],h=d;if(o.Pc&&(h+=o.vd[0],c&&(h+=o.od[0])),0<(h=0>h?0:63<h?63:h)){var f=h;0<o.wb&&(f=4<o.wb?f>>2:f>>1)>9-o.wb&&(f=9-o.wb),1>f&&(f=1),u.dd=f,u.tc=2*h+f,u.ld=40<=h?2:15<=h?1:0}else u.tc=0;u.La=c}}}l=0}else Ye(e,6,"Frame setup failed"),l=e.a;if(l=0==l){if(l){e.$c=0,0<e.Aa||(e.Ic=1);t:{l=e.Ic,o=4*(f=e.za);var m=32*f,p=f+1,g=0<e.L?f*(0<e.Aa?2:1):0,x=(2==e.Aa?2:1)*f;if((u=o+832+(c=3*(16*l+Mn[e.L])/2*m)+(d=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=u)l=0;else{if(u>e.Vb){if(e.Vb=0,e.Ec=s(u),e.Fc=0,null==e.Ec){l=Ye(e,1,"no memory during frame initialization.");break t}e.Vb=u}u=e.Ec,h=e.Fc,e.Ac=u,e.Bc=h,h+=o,e.Gd=i(m,He),e.Hd=0,e.rb=i(p+1,Be),e.sb=1,e.wa=g?i(g,Me):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=f),t(!0),e.oc=u,e.pc=h,h+=832,e.ya=i(x,ze),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=f),e.R=16*f,e.B=8*f,f=(m=Mn[e.L])*e.R,m=m/2*e.B,e.sa=u,e.ta=h+f,e.qa=e.sa,e.ra=e.ta+16*l*e.R+m,e.Ha=e.qa,e.Ia=e.ra+8*l*e.B+m,e.$c=0,h+=c,e.mb=d?u:null,e.nb=d?h:null,t(h+d<=e.Fc+e.Vb),Qe(e),n(e.Ac,e.Bc,0,o),l=1}}if(l){if(r.ka=0,r.y=e.sa,r.O=e.ta,r.f=e.qa,r.N=e.ra,r.ea=e.Ha,r.Vd=e.Ia,r.fa=e.R,r.Rc=e.B,r.F=null,r.J=0,!Ta){for(l=-255;255>=l;++l)Sa[255+l]=0>l?-l:l;for(l=-1020;1020>=l;++l)Aa[1020+l]=-128>l?-128:127<l?127:l;for(l=-112;112>=l;++l)Ca[112+l]=-16>l?-16:15<l?15:l;for(l=-255;510>=l;++l)_a[255+l]=0>l?0:255<l?255:l;Ta=1}aa=ot,na=nt,ia=st,la=it,oa=lt,sa=at,ca=Kt,da=Yt,ua=Jt,ha=Qt,fa=Xt,ma=$t,pa=Zt,ga=er,xa=zt,ba=qt,va=Ht,ya=Wt,un[0]=jt,un[1]=dt,un[2]=wt,un[3]=Nt,un[4]=kt,un[5]=At,un[6]=St,un[7]=Ct,un[8]=Tt,un[9]=_t,dn[0]=gt,dn[1]=ht,dn[2]=ft,dn[3]=mt,dn[4]=xt,dn[5]=bt,dn[6]=vt,hn[0]=Ot,hn[1]=ut,hn[2]=Et,hn[3]=Lt,hn[4]=Dt,hn[5]=Ft,hn[6]=It,l=1}else l=0}l&&(l=function(e,r){for(e.M=0;e.M<e.Va;++e.M){var i,l=e.Jc[e.M&e.Xb],o=e.m,c=e;for(i=0;i<c.za;++i){var d=o,u=c,h=u.Ac,f=u.Bc+4*i,m=u.zc,p=u.ya[u.aa+i];if(u.Qa.Bb?p.$b=_(d,u.Pa.jb[0])?2+_(d,u.Pa.jb[2]):_(d,u.Pa.jb[1]):p.$b=0,u.kc&&(p.Ad=_(d,u.Bd)),p.Za=!_(d,145)+0,p.Za){var g=p.Ob,x=0;for(u=0;4>u;++u){var b,v=m[0+u];for(b=0;4>b;++b){v=ln[h[f+b]][v];for(var y=nn[_(d,v[0])];0<y;)y=nn[2*y+_(d,v[y])];v=-y,h[f+b]=v}a(g,x,h,f,4),x+=4,m[0+u]=v}}else v=_(d,156)?_(d,128)?1:3:_(d,163)?2:0,p.Ob[0]=v,n(h,f,v,4),n(m,0,v,4);p.Dd=_(d,142)?_(d,114)?_(d,183)?1:3:2:0}if(c.m.Ka)return Ye(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=l,d=(o=e).rb[o.sb-1],h=o.rb[o.sb+o.ja],i=o.ya[o.aa+o.ja],f=o.kc?i.Ad:0)d.la=h.la=0,i.Za||(d.Na=h.Na=0),i.Hc=0,i.Gc=0,i.ia=0;else{var w,N;if(d=h,h=c,f=o.Pa.Xc,m=o.ya[o.aa+o.ja],p=o.pb[m.$b],u=m.ad,g=0,x=o.rb[o.sb-1],v=b=0,n(u,g,0,384),m.Za)var j=0,k=f[3];else{y=s(16);var S=d.Na+x.Na;if(S=tn(h,f[1],S,p.Eb,0,y,0),d.Na=x.Na=(0<S)+0,1<S)aa(y,0,u,g);else{var A=y[0]+3>>3;for(y=0;256>y;y+=16)u[g+y]=A}j=1,k=f[0]}var C=15&d.la,T=15&x.la;for(y=0;4>y;++y){var E=1&T;for(A=N=0;4>A;++A)C=C>>1|(E=(S=tn(h,k,S=E+(1&C),p.Sc,j,u,g))>j)<<7,N=N<<2|(3<S?3:1<S?2:0!=u[g+0]),g+=16;C>>=4,T=T>>1|E<<7,b=(b<<8|N)>>>0}for(k=C,j=T>>4,w=0;4>w;w+=2){for(N=0,C=d.la>>4+w,T=x.la>>4+w,y=0;2>y;++y){for(E=1&T,A=0;2>A;++A)S=E+(1&C),C=C>>1|(E=0<(S=tn(h,f[2],S,p.Qc,0,u,g)))<<3,N=N<<2|(3<S?3:1<S?2:0!=u[g+0]),g+=16;C>>=2,T=T>>1|E<<5}v|=N<<4*w,k|=C<<4<<w,j|=(240&T)<<w}d.la=k,x.la=j,m.Hc=b,m.Gc=v,m.ia=43690&v?0:p.ia,f=!(b|v)}if(0<o.L&&(o.wa[o.Y+o.ja]=o.gd[i.$b][i.Za],o.wa[o.Y+o.ja].La|=!f),c.Ka)return Ye(e,7,"Premature end-of-file encountered.")}if(Qe(e),o=r,c=1,i=(l=e).D,d=0<l.L&&l.M>=l.zb&&l.M<=l.Va,0==l.Aa)t:{if(i.M=l.M,i.uc=d,Pr(l,i),c=1,i=(N=l.D).Nb,d=(v=Mn[l.L])*l.R,h=v/2*l.B,y=16*i*l.R,A=8*i*l.B,f=l.sa,m=l.ta-d+y,p=l.qa,u=l.ra-h+A,g=l.Ha,x=l.Ia-h+A,T=0==(C=N.M),b=C>=l.Va-1,2==l.Aa&&Pr(l,N),N.uc)for(E=(S=l).D.M,t(S.D.uc),N=S.yb;N<S.Hb;++N){j=N,k=E;var L=(P=(z=S).D).Nb;w=z.R;var P=P.wa[P.Y+j],O=z.sa,F=z.ta+16*L*w+16*j,D=P.dd,I=P.tc;if(0!=I)if(t(3<=I),1==z.L)0<j&&ba(O,F,w,I+4),P.La&&ya(O,F,w,I),0<k&&xa(O,F,w,I+4),P.La&&va(O,F,w,I);else{var R=z.B,M=z.qa,B=z.ra+8*L*R+8*j,U=z.Ha,z=z.Ia+8*L*R+8*j;L=P.ld,0<j&&(da(O,F,w,I+4,D,L),ha(M,B,U,z,R,I+4,D,L)),P.La&&(ma(O,F,w,I,D,L),ga(M,B,U,z,R,I,D,L)),0<k&&(ca(O,F,w,I+4,D,L),ua(M,B,U,z,R,I+4,D,L)),P.La&&(fa(O,F,w,I,D,L),pa(M,B,U,z,R,I,D,L))}}if(l.ia&&alert("todo:DitherRow"),null!=o.put){if(N=16*C,C=16*(C+1),T?(o.y=l.sa,o.O=l.ta+y,o.f=l.qa,o.N=l.ra+A,o.ea=l.Ha,o.W=l.Ia+A):(N-=v,o.y=f,o.O=m,o.f=p,o.N=u,o.ea=g,o.W=x),b||(C-=v),C>o.o&&(C=o.o),o.F=null,o.J=null,null!=l.Fa&&0<l.Fa.length&&N<C&&(o.J=dr(l,o,N,C-N),o.F=l.mb,null==o.F&&0==o.F.length)){c=Ye(l,3,"Could not decode alpha data.");break t}N<o.j&&(v=o.j-N,N=o.j,t(!(1&v)),o.O+=l.R*v,o.N+=l.B*(v>>1),o.W+=l.B*(v>>1),null!=o.F&&(o.J+=o.width*v)),N<C&&(o.O+=o.v,o.N+=o.v>>1,o.W+=o.v>>1,null!=o.F&&(o.J+=o.v),o.ka=N-o.j,o.U=o.va-o.v,o.T=C-N,c=o.put(o))}i+1!=l.Ic||b||(a(l.sa,l.ta-d,f,m+16*l.R,d),a(l.qa,l.ra-h,p,u+8*l.B,h),a(l.Ha,l.Ia-h,g,x+8*l.B,h))}if(!c)return Ye(e,6,"Output aborted.")}return 1}(e,r)),null!=r.bc&&r.bc(r),l&=1}return l?(e.cb=0,l):0})(e,o)||(r=e.a)}}else r=e.a}0==r&&null!=u.Oa&&u.Oa.fd&&(r=Dr(u.ba))}u=r}d=0!=u?null:11>d?h.f.RGBA.eb:h.f.kb.y}else d=null;return d};var Un=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var r="",a=0;a<4;a++)r+=String.fromCharCode(e[t++]);return r}function d(e,t){return e[t+0]|e[t+1]<<8}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new o;var f=[0],m=[0],p=[],g=new o,x=e,b=function(e,t){var r={},a=0,n=!1,s=0,i=0;if(r.frames=[],!function(e,t){for(var r=0;r<4;r++)if(e[t+r]!="RIFF".charCodeAt(r))return!0;return!1}(e,t)){for(h(e,t+=4),t+=8;t<e.length;){var l=c(e,t),o=h(e,t+=4);t+=4;var f=o+(1&o);switch(l){case"VP8 ":case"VP8L":void 0===r.frames[a]&&(r.frames[a]={}),(g=r.frames[a]).src_off=n?i:t-8,g.src_size=s+o+8,a++,n&&(n=!1,s=0,i=0);break;case"VP8X":(g=r.header={}).feature_flags=e[t];var m=t+4;g.canvas_width=1+u(e,m),m+=3,g.canvas_height=1+u(e,m),m+=3;break;case"ALPH":n=!0,s=f+8,i=t-8;break;case"ANIM":(g=r.header).bgcolor=h(e,t),m=t+4,g.loop_count=d(e,m),m+=2;break;case"ANMF":var p,g;(g=r.frames[a]={}).offset_x=2*u(e,t),t+=3,g.offset_y=2*u(e,t),t+=3,g.width=1+u(e,t),t+=3,g.height=1+u(e,t),t+=3,g.duration=u(e,t),t+=3,p=e[t++],g.dispose=1&p,g.blend=p>>1&1}"ANMF"!=l&&(t+=f)}return r}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var v=b.header?b.header:null,y=b.frames?b.frames:null;if(v){v.loop_counter=v.loop_count,f=[v.canvas_height],m=[v.canvas_width];for(var w=0;w<y.length&&0!=y[w].blend;w++);}var N=y[0],j=g.WebPDecodeRGBA(x,N.src_off,N.src_size,m,f);N.rgba=j,N.imgwidth=m[0],N.imgheight=f[0];for(var k=0;k<m[0]*f[0]*4;k++)p[k]=j[k];return this.width=m,this.height=f,this.data=p,this}!function(e){var t,r,a,n,s,i,l,o,c,d=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new o,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new i,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new i,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,o=this.internal.Matrix,c=new d}]);var u=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var r=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var a=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return a},set:function(e){a=Boolean(e)}});var n=0;Object.defineProperty(this,"posX",{get:function(){return n},set:function(e){isNaN(e)||(n=e)}});var s=0;Object.defineProperty(this,"posY",{get:function(){return s},set:function(e){isNaN(e)||(s=e)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),c.margin=t}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=e}});var l=0;Object.defineProperty(this,"lastBreak",{get:function(){return l},set:function(e){l=e}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(e){o=e}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(e){e instanceof d&&(c=e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(e){c.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=h(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=h(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var f=null,m=null,p=null;Object.defineProperty(this,"fontFaces",{get:function(){return p},set:function(e){f=null,m=null,p=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(e))){var r=t[1];t[2];var a=t[3],n=t[4];t[5];var s=t[6],i=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(n)[2];n="px"===i?Math.floor(parseFloat(n)*this.pdf.internal.scaleFactor):"em"===i?Math.floor(parseFloat(n)*this.pdf.getFontSize()):Math.floor(parseFloat(n)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(n);var l=function(e){var t,r,a=[],n=e.trim();if(""===n)return sC;if(n in VA)return[VA[n]];for(;""!==n;){switch(r=null,t=(n=KA(n)).charAt(0)){case'"':case"'":r=YA(n.substring(1),t);break;default:r=XA(n)}if(null===r)return sC;if(a.push(r[0]),""!==(n=KA(r[1]))&&","!==n.charAt(0))return sC;n=n.replace(/^,/,"")}return a}(s);if(this.fontFaces){var o=function(e,t){var r=e.getFontList(),a=JSON.stringify(r);if(null===f||m!==a){var n=function(e){var t=[];return Object.keys(e).forEach(function(r){e[r].forEach(function(e){var a=null;switch(e){case"bold":a={family:r,weight:"bold"};break;case"italic":a={family:r,style:"italic"};break;case"bolditalic":a={family:r,weight:"bold",style:"italic"};break;case"":case"normal":a={family:r}}null!==a&&(a.ref={name:r,style:e},t.push(a))})}),t}(r);f=function(e){for(var t={},r=0;r<e.length;++r){var a=qA(e[r]),n=a.family,s=a.stretch,i=a.style,l=a.weight;t[n]=t[n]||{},t[n][s]=t[n][s]||{},t[n][s][i]=t[n][s][i]||{},t[n][s][i][l]=a}return t}(n.concat(t)),m=a}return f}(this.pdf,this.fontFaces),c=l.map(function(e){return{family:e,stretch:"normal",weight:a,style:r}}),d=function(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},WA,r.genericFontFamilies||{}),s=null,i=null,l=0;l<t.length;++l)if(n[(s=qA(t[l])).family]&&(s.family=n[s.family]),e.hasOwnProperty(s.family)){i=e[s.family];break}if(!(i=i||e[a]))throw new Error("Could not find a font-family for the rule '"+GA(s)+"' and default family '"+a+"'.");if(i=function(e,t){if(t[e])return t[e];var r=BA[e],a=r<=BA.normal?-1:1,n=HA(t,MA,r,a);if(!n)throw new Error("Could not find a matching font-stretch value for "+e);return n}(s.stretch,i),i=function(e,t){if(t[e])return t[e];for(var r=RA[e],a=0;a<r.length;++a)if(t[r[a]])return t[r[a]];throw new Error("Could not find a matching font-style for "+e)}(s.style,i),!(i=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var r=zA[e],a=HA(t,UA,r,e<400?-1:1);if(!a)throw new Error("Could not find a matching font-weight for value "+e);return a}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+GA(s)+"'.");return i}(o,c);this.pdf.setFont(d.ref.name,d.ref.style)}else{var u="";("bold"===a||parseInt(a,10)>=700||"bold"===r)&&(u="bold"),"italic"===r&&(u+="italic"),0===u.length&&(u="normal");for(var h="",p={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},g=0;g<l.length;g++){if(void 0!==this.pdf.internal.getFont(l[g],u,{noFallback:!0,disableWarning:!0})){h=l[g];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(l[g],"bold",{noFallback:!0,disableWarning:!0}))h=l[g],u="bold";else if(void 0!==this.pdf.internal.getFont(l[g],"normal",{noFallback:!0,disableWarning:!0})){h=l[g],u="normal";break}}if(""===h)for(var x=0;x<l.length;x++)if(p[l[x]]){h=p[l[x]];break}h=""===h?"Times":h,this.pdf.setFont(h,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,R.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,R.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};u.prototype.setLineDash=function(e){this.lineDash=e},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){y.call(this,"fill",!1)},u.prototype.stroke=function(){y.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw bS.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new i(e,t)},u.prototype.closePath=function(){var e=new i(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,sy.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new i(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(e.x,e.y)},u.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw bS.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new i(r.x,r.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),y.call(this,null,!0)},u.prototype.quadraticCurveTo=function(e,t,r,a){if(isNaN(r)||isNaN(a)||isNaN(e)||isNaN(t))throw bS.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var n=this.ctx.transform.applyToPoint(new i(r,a)),s=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"qct",x1:s.x,y1:s.y,x:n.x,y:n.y}),this.ctx.lastPoint=new i(n.x,n.y)},u.prototype.bezierCurveTo=function(e,t,r,a,n,s){if(isNaN(n)||isNaN(s)||isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw bS.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var l=this.ctx.transform.applyToPoint(new i(n,s)),o=this.ctx.transform.applyToPoint(new i(e,t)),c=this.ctx.transform.applyToPoint(new i(r,a));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:c.x,y2:c.y,x:l.x,y:l.y}),this.ctx.lastPoint=new i(l.x,l.y)},u.prototype.arc=function(e,t,r,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n))throw bS.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var l=this.ctx.transform.applyToPoint(new i(e,t));e=l.x,t=l.y;var o=this.ctx.transform.applyToPoint(new i(0,r)),c=this.ctx.transform.applyToPoint(new i(0,0));r=Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2))}Math.abs(n-a)>=2*Math.PI&&(a=0,n=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:r,startAngle:a,endAngle:n,counterclockwise:s})},u.prototype.arcTo=function(e,t,r,a,n){throw new Error("arcTo not implemented.")},u.prototype.rect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw bS.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+r,t),this.lineTo(e+r,t+a),this.lineTo(e,t+a),this.lineTo(e,t),this.lineTo(e+r,t),this.lineTo(e,t)},u.prototype.fillRect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw bS.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var n={};"butt"!==this.lineCap&&(n.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(n.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,r,a),this.fill(),n.hasOwnProperty("lineCap")&&(this.lineCap=n.lineCap),n.hasOwnProperty("lineJoin")&&(this.lineJoin=n.lineJoin)}},u.prototype.strokeRect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw bS.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(e,t,r,a),this.stroke())},u.prototype.clearRect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw bS.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,r,a))},u.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var a=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=a}},u.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(e){var t,r,a,n;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,r=0,a=0,n=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==s)t=parseInt(s[1]),r=parseInt(s[2]),a=parseInt(s[3]),n=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(s[1]),r=parseInt(s[2]),a=parseInt(s[3]),n=parseFloat(s[4]);else{if(n=1,"string"==typeof e&&"#"!==e.charAt(0)){var i=new jS(e);e=i.ok?i.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,r=e.substring(2,3),r+=r,a=e.substring(3,4),a+=a):(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7)),t=parseInt(t,16),r=parseInt(r,16),a=parseInt(a,16)}}return{r:t,g:r,b:a,a:n,style:e}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},m=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(e,t,r,a){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw bS.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(a=isNaN(a)?void 0:a,!f.call(this)){var n=F(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;_.call(this,{text:e,x:t,y:r,scale:s,angle:n,align:this.textAlign,maxWidth:a})}},u.prototype.strokeText=function(e,t,r,a){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw bS.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){a=isNaN(a)?void 0:a;var n=F(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;_.call(this,{text:e,x:t,y:r,scale:s,renderingMode:"stroke",angle:n,align:this.textAlign,maxWidth:a})}},u.prototype.measureText=function(e){if("string"!=typeof e)throw bS.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,r=this.pdf.internal.scaleFactor,a=t.internal.getFontSize(),n=t.getStringUnitWidth(e)*a/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:n*=Math.round(96*r/72*1e4)/1e4})},u.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw bS.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new o(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.rotate=function(e){if(isNaN(e))throw bS.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new o(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},u.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw bS.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new o(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.transform=function(e,t,r,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s))throw bS.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var i=new o(e,t,r,a,n,s);this.ctx.transform=this.ctx.transform.multiply(i)},u.prototype.setTransform=function(e,t,r,a,n,s){e=isNaN(e)?1:e,t=isNaN(t)?0:t,r=isNaN(r)?0:r,a=isNaN(a)?1:a,n=isNaN(n)?0:n,s=isNaN(s)?0:s,this.ctx.transform=new o(e,t,r,a,n,s)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(e,t,r,a,n,s,i,c,d){var u=this.pdf.getImageProperties(e),h=1,f=1,m=1,x=1;void 0!==a&&void 0!==c&&(m=c/a,x=d/n,h=u.width/a*c/a,f=u.height/n*d/n),void 0===s&&(s=t,i=r,t=0,r=0),void 0!==a&&void 0===c&&(c=a,d=n),void 0===a&&void 0===c&&(c=u.width,d=u.height);var y=this.ctx.transform.decompose(),N=F(y.rotate.shx),j=new o,k=(j=(j=(j=j.multiply(y.translate)).multiply(y.skew)).multiply(y.scale)).applyToRectangle(new l(s-t*m,i-r*x,a*h,n*f));if(this.autoPaging){for(var S,A=g.call(this,k),C=[],_=0;_<A.length;_+=1)-1===C.indexOf(A[_])&&C.push(A[_]);v(C);for(var T=C[0],E=C[C.length-1],L=T;L<E+1;L++){this.pdf.setPage(L);var P=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],O=1===L?this.posY+this.margin[0]:this.margin[0],D=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],I=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],R=1===L?0:D+(L-2)*I;if(0!==this.ctx.clip_path.length){var M=this.path;S=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(S,this.posX+this.margin[3],-R+O+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=M}var B=JSON.parse(JSON.stringify(k));B=b([B],this.posX+this.margin[3],-R+O+this.ctx.prevPageLastElemOffset)[0];var U=(L>T||L<E)&&p.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],P,I,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",B.x,B.y,B.w,B.h,null,null,N),U&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(e,"JPEG",k.x,k.y,k.w,k.h,null,null,N)};var g=function(e,t,r){var a=[];t=t||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var n=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":a.push(Math.floor((e.y+n)/r)+1);break;case"arc":a.push(Math.floor((e.y+n-e.radius)/r)+1),a.push(Math.floor((e.y+n+e.radius)/r)+1);break;case"qct":var s=D(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);a.push(Math.floor((s.y+n)/r)+1),a.push(Math.floor((s.y+s.h+n)/r)+1);break;case"bct":var i=I(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);a.push(Math.floor((i.y+n)/r)+1),a.push(Math.floor((i.y+i.h+n)/r)+1);break;case"rect":a.push(Math.floor((e.y+n)/r)+1),a.push(Math.floor((e.y+e.h+n)/r)+1)}for(var l=0;l<a.length;l+=1)for(;this.pdf.internal.getNumberOfPages()<a[l];)x.call(this);return a},x=function(){var e=this.fillStyle,t=this.strokeStyle,r=this.font,a=this.lineCap,n=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=r,this.lineCap=a,this.lineWidth=n,this.lineJoin=s},b=function(e,t,r){for(var a=0;a<e.length;a++)switch(e[a].type){case"bct":e[a].x2+=t,e[a].y2+=r;case"qct":e[a].x1+=t,e[a].y1+=r;default:e[a].x+=t,e[a].y+=r}return e},v=function(e){return e.sort(function(e,t){return e-t})},y=function(e,t){var r=this.fillStyle,a=this.strokeStyle,n=this.lineCap,s=this.lineWidth,i=Math.abs(s*this.ctx.transform.scaleX),l=this.lineJoin;if(this.autoPaging){for(var o,c,d=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),h=[],f=0;f<u.length;f++)if(void 0!==u[f].x)for(var m=g.call(this,u[f]),y=0;y<m.length;y+=1)-1===h.indexOf(m[y])&&h.push(m[y]);for(var N=0;N<h.length;N++)for(;this.pdf.internal.getNumberOfPages()<h[N];)x.call(this);v(h);for(var j=h[0],k=h[h.length-1],S=j;S<k+1;S++){this.pdf.setPage(S),this.fillStyle=r,this.strokeStyle=a,this.lineCap=n,this.lineWidth=i,this.lineJoin=l;var A=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],C=1===S?this.posY+this.margin[0]:this.margin[0],_=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],E=1===S?0:_+(S-2)*T;if(0!==this.ctx.clip_path.length){var L=this.path;o=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(o,this.posX+this.margin[3],-E+C+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=L}if(c=JSON.parse(JSON.stringify(d)),this.path=b(c,this.posX+this.margin[3],-E+C+this.ctx.prevPageLastElemOffset),!1===t||0===S){var P=(S>j||S<k)&&p.call(this);P&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],A,T,null).clip().discardPath()),w.call(this,e,t),P&&this.pdf.restoreGraphicsState()}this.lineWidth=s}this.path=d}else this.lineWidth=i,w.call(this,e,t),this.lineWidth=s},w=function(e,t){if(("stroke"!==e||t||!m.call(this))&&("stroke"===e||t||!f.call(this))){for(var r,a,n=[],s=this.path,i=0;i<s.length;i++){var l=s[i];switch(l.type){case"begin":n.push({begin:!0});break;case"close":n.push({close:!0});break;case"mt":n.push({start:l,deltas:[],abs:[]});break;case"lt":var o=n.length;if(s[i-1]&&!isNaN(s[i-1].x)&&(r=[l.x-s[i-1].x,l.y-s[i-1].y],o>0))for(;o>=0;o--)if(!0!==n[o-1].close&&!0!==n[o-1].begin){n[o-1].deltas.push(r),n[o-1].abs.push(l);break}break;case"bct":r=[l.x1-s[i-1].x,l.y1-s[i-1].y,l.x2-s[i-1].x,l.y2-s[i-1].y,l.x-s[i-1].x,l.y-s[i-1].y],n[n.length-1].deltas.push(r);break;case"qct":var c=s[i-1].x+2/3*(l.x1-s[i-1].x),d=s[i-1].y+2/3*(l.y1-s[i-1].y),u=l.x+2/3*(l.x1-l.x),h=l.y+2/3*(l.y1-l.y),p=l.x,g=l.y;r=[c-s[i-1].x,d-s[i-1].y,u-s[i-1].x,h-s[i-1].y,p-s[i-1].x,g-s[i-1].y],n[n.length-1].deltas.push(r);break;case"arc":n.push({deltas:[],abs:[],arc:!0}),Array.isArray(n[n.length-1].abs)&&n[n.length-1].abs.push(l)}}a=t?null:"stroke"===e?"stroke":"fill";for(var x=!1,b=0;b<n.length;b++)if(n[b].arc)for(var v=n[b].abs,y=0;y<v.length;y++){var w=v[y];"arc"===w.type?k.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,t,!x):T.call(this,w.x,w.y),x=!0}else if(!0===n[b].close)this.pdf.internal.out("h"),x=!1;else if(!0!==n[b].begin){var N=n[b].start.x,j=n[b].start.y;E.call(this,n[b].deltas,N,j),x=!0}a&&S.call(this,a),t&&A.call(this)}},N=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-r;case"top":return e+t-r;case"hanging":return e+t-2*r;case"middle":return e+t/2-r;default:return e}},j=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(e,t,r,a,n,s,i,l,o){for(var c=P.call(this,r,a,n,s),d=0;d<c.length;d++){var u=c[d];0===d&&(o?C.call(this,u.x1+e,u.y1+t):T.call(this,u.x1+e,u.y1+t)),L.call(this,e,t,u.x2,u.y2,u.x3,u.y3,u.x4,u.y4)}l?A.call(this):S.call(this,i)},S=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},A=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(e,t){this.pdf.internal.out(r(e)+" "+a(t)+" m")},_=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var r,a,n,s=this.pdf.getTextDimensions(e.text),c=N.call(this,e.y),d=j.call(this,c)-s.h,u=this.ctx.transform.applyToPoint(new i(e.x,c));if(this.autoPaging){var h=this.ctx.transform.decompose(),f=new o;f=(f=(f=f.multiply(h.translate)).multiply(h.skew)).multiply(h.scale);for(var m=this.ctx.transform.applyToRectangle(new l(e.x,c,s.w,s.h)),x=f.applyToRectangle(new l(e.x,d,s.w,s.h)),y=g.call(this,x),k=[],S=0;S<y.length;S+=1)-1===k.indexOf(y[S])&&k.push(y[S]);v(k);for(var A=k[0],C=k[k.length-1],_=A;_<C+1;_++){this.pdf.setPage(_);var T=1===_?this.posY+this.margin[0]:this.margin[0],E=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[2],P=L-this.margin[0],O=this.pdf.internal.pageSize.width-this.margin[1],F=O-this.margin[3],D=1===_?0:E+(_-2)*P;if(0!==this.ctx.clip_path.length){var I=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(r,this.posX+this.margin[3],-1*D+T),w.call(this,"fill",!0),this.path=I}var R=b([JSON.parse(JSON.stringify(x))],this.posX+this.margin[3],-D+T+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(a=this.pdf.internal.getFontSize(),this.pdf.setFontSize(a*e.scale),n=this.lineWidth,this.lineWidth=n*e.scale);var M="text"!==this.autoPaging;if(M||R.y+R.h<=L){if(M||R.y>=T&&R.x<=O){var B=M?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||O-R.x)[0],U=b([JSON.parse(JSON.stringify(m))],this.posX+this.margin[3],-D+T+this.ctx.prevPageLastElemOffset)[0],z=M&&(_>A||_<C)&&p.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],F,P,null).clip().discardPath()),this.pdf.text(B,U.x,U.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),z&&this.pdf.restoreGraphicsState()}}else R.y<L&&(this.ctx.prevPageLastElemOffset+=L-R.y);e.scale>=.01&&(this.pdf.setFontSize(a),this.lineWidth=n)}}else e.scale>=.01&&(a=this.pdf.internal.getFontSize(),this.pdf.setFontSize(a*e.scale),n=this.lineWidth,this.lineWidth=n*e.scale),this.pdf.text(e.text,u.x+this.posX,u.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(a),this.lineWidth=n)},T=function(e,t,n,s){n=n||0,s=s||0,this.pdf.internal.out(r(e+n)+" "+a(t+s)+" l")},E=function(e,t,r){return this.pdf.lines(e,t,r,null,null)},L=function(e,r,a,i,l,o,c,d){this.pdf.internal.out([t(n(a+e)),t(s(i+r)),t(n(l+e)),t(s(o+r)),t(n(c+e)),t(s(d+r)),"c"].join(" "))},P=function(e,t,r,a){for(var n=2*Math.PI,s=Math.PI/2;t>r;)t-=n;var i=Math.abs(r-t);i<n&&a&&(i=n-i);for(var l=[],o=a?-1:1,c=t;i>1e-5;){var d=c+o*Math.min(i,s);l.push(O.call(this,e,c,d)),i-=Math.abs(d-c),c=d}return l},O=function(e,t,r){var a=(r-t)/2,n=e*Math.cos(a),s=e*Math.sin(a),i=n,l=-s,o=i*i+l*l,c=o+i*n+l*s,d=4/3*(Math.sqrt(2*o*c)-c)/(i*s-l*n),u=i-d*l,h=l+d*i,f=u,m=-h,p=a+t,g=Math.cos(p),x=Math.sin(p);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:u*g-h*x,y2:u*x+h*g,x3:f*g-m*x,y3:f*x+m*g,x4:e*Math.cos(r),y4:e*Math.sin(r)}},F=function(e){return 180*e/Math.PI},D=function(e,t,r,a,n,s){var i=e+.5*(r-e),o=t+.5*(a-t),c=n+.5*(r-n),d=s+.5*(a-s),u=Math.min(e,n,i,c),h=Math.max(e,n,i,c),f=Math.min(t,s,o,d),m=Math.max(t,s,o,d);return new l(u,f,h-u,m-f)},I=function(e,t,r,a,n,s,i,o){var c,d,u,h,f,m,p,g,x,b,v,y,w,N,j=r-e,k=a-t,S=n-r,A=s-a,C=i-n,_=o-s;for(d=0;d<41;d++)x=(p=(u=e+(c=d/40)*j)+c*((f=r+c*S)-u))+c*(f+c*(n+c*C-f)-p),b=(g=(h=t+c*k)+c*((m=a+c*A)-h))+c*(m+c*(s+c*_-m)-g),0==d?(v=x,y=b,w=x,N=b):(v=Math.min(v,x),y=Math.min(y,b),w=Math.max(w,x),N=Math.max(N,b));return new l(Math.round(v),Math.round(y),Math.round(w-v),Math.round(N-y))},R=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,r=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==r&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=r)}}}(XS.API),function(e){var t=function(e){var t,r,a,n,s,i,l,o,c,d;for(/[^\x00-\xFF]/.test(e),r=[],a=0,n=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;n>a;a+=4)0!==(s=(e.charCodeAt(a)<<24)+(e.charCodeAt(a+1)<<16)+(e.charCodeAt(a+2)<<8)+e.charCodeAt(a+3))?(i=(s=((s=((s=((s=(s-(d=s%85))/85)-(c=s%85))/85)-(o=s%85))/85)-(l=s%85))/85)%85,r.push(i+33,l+33,o+33,c+33,d+33)):r.push(122);return function(e,t){for(var r=t;r>0;r--)e.pop()}(r,t.length),String.fromCharCode.apply(String,r)+"~>"},r=function(e){var t,r,a,n,s,i=String,l="length",o=255,c="charCodeAt",d="slice",u="replace";for(e[d](-2),e=e[d](0,-2)[u](/\s/g,"")[u]("z","!!!!!"),a=[],n=0,s=(e+=t="uuuuu"[d](e[l]%5||5))[l];s>n;n+=5)r=52200625*(e[c](n)-33)+614125*(e[c](n+1)-33)+7225*(e[c](n+2)-33)+85*(e[c](n+3)-33)+(e[c](n+4)-33),a.push(o&r>>24,o&r>>16,o&r>>8,o&r);return function(e,t){for(var r=t;r>0;r--)e.pop()}(a,t[l]),i.fromCharCode.apply(i,a)},a=function(e){return e.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var r="",a=0;a<e.length;a+=2)r+=String.fromCharCode("0x"+(e[a]+e[a+1]));return r},s=function(e){for(var t=new Uint8Array(e.length),r=e.length;r--;)t[r]=e.charCodeAt(r);return(t=Hy(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,i){var l=0,o=e||"",c=[];for("string"==typeof(i=i||[])&&(i=[i]),l=0;l<i.length;l+=1)switch(i[l]){case"ASCII85Decode":case"/ASCII85Decode":o=r(o),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":o=t(o),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":o=n(o),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":o=a(o),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":o=s(o),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[l]+'" is not implemented')}return{data:o,reverseChain:c.reverse().join(" ")}}}(XS.API),(nC=XS.API).loadFile=function(e,t,r){return function(e,t,r){t=!1!==t,r="function"==typeof r?r:function(){};var a=void 0;try{a=function(e,t,r){var a=new XMLHttpRequest,n=0,s=function(e){var t=e.length,r=[],a=String.fromCharCode;for(n=0;n<t;n+=1)r.push(a(255&e.charCodeAt(n)));return r.join("")};if(a.open("GET",e,!t),a.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(a.onload=function(){200===a.status?r(s(this.responseText)):r(void 0)}),a.send(null),t&&200===a.status)return s(a.responseText)}(e,t,r)}catch(vy){}return a}(e,t,r)},nC.loadImageFile=nC.loadFile,function(e){function t(){return(gS.html2canvas?Promise.resolve(gS.html2canvas):r.e(239).then(r.t.bind(r,5239,23))).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function a(){return(gS.DOMPurify?Promise.resolve(gS.DOMPurify):r.e(977).then(r.bind(r,7977))).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var n=function(e){var t=(0,sy.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},s=function(e,t){var r=document.createElement(e);for(var a in t.className&&(r.className=t.className),t.innerHTML&&t.dompurify&&(r.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)r.style[a]=t.style[a];return r},i=function e(t,r){for(var a=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),n=t.firstChild;n;n=n.nextSibling)!0!==r&&1===n.nodeType&&"SCRIPT"===n.nodeName||a.appendChild(e(n,r));return 1===t.nodeType&&("CANVAS"===t.nodeName?(a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(a.value=t.value),a.addEventListener("load",function(){a.scrollTop=t.scrollTop,a.scrollLeft=t.scrollLeft},!0)),a},l=function e(t){var r=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),a=e.convert(Promise.resolve(),r);return(a=a.setProgress(1,e,1,[e])).set(t)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(e,t){return e.__proto__=t||l.prototype,e},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(n(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e),t){case"string":return this.then(a).then(function(t){return this.set({src:s("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},l.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,r=this.opt.fontFaces,a="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,n=Object.assign({async:!0,allowTaint:!0,scale:a,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete n.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=r,r)for(var s=0;s<r.length;++s){var i=r[s],l=i.src.find(function(e){return"truetype"===e.format});l&&t.addFont(l.url,i.ref.name,i.ref.style)}return n.windowHeight=n.windowHeight||0,n.windowHeight=0==n.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):n.windowHeight,t.context2d.save(!0),e(this.prop.container,n)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(e,t,r){return"img"===(r=r||"pdf").toLowerCase()||"image"===r.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},l.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},l.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},l.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(e){if("object"!==n(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in l.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},l.prototype.get=function(e,t){return this.then(function(){var r=e in l.template.prop?this.prop[e]:this.opt[e];return t?t(r):r})},l.prototype.setMargin=function(e){return this.then(function(){switch(n(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},l.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||XS.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},l.prototype.setProgress=function(e,t,r,a){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=r&&(this.progress.n=r),null!=a&&(this.progress.stack=a),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(e,t,r,a){return this.setProgress(e?this.progress.val+e:null,t||null,r?this.progress.n+r:null,a?this.progress.stack.concat(a):null)},l.prototype.then=function(e,t){var r=this;return this.thenCore(e,t,function(e,t){return r.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return r.updateProgress(null,e),t}).then(e,t).then(function(e){return r.updateProgress(1),e})})},l.prototype.thenCore=function(e,t,r){r=r||Promise.prototype.then;var a=this;e&&(e=e.bind(a)),t&&(t=t.bind(a));var n=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?a:l.convert(Object.assign({},a),Promise.prototype),s=r.call(n,e,t);return l.convert(s,a.__proto__)},l.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},l.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},l.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return l.convert(t,this)},l.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},l.prototype.error=function(e){return this.then(function(){throw new Error(e)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,XS.getPageSize=function(e,t,r){if("object"===(0,sy.A)(e)){var a=e;e=a.orientation,t=a.unit||t,r=a.format||r}t=t||"mm",r=r||"a4",e=(""+(e||"P")).toLowerCase();var n,s=(""+r).toLowerCase(),i={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":n=1;break;case"mm":n=72/25.4;break;case"cm":n=72/2.54;break;case"in":n=72;break;case"px":n=.75;break;case"pc":case"em":n=12;break;case"ex":n=6;break;default:throw"Invalid unit: "+t}var l,o=0,c=0;if(i.hasOwnProperty(s))o=i[s][1]/n,c=i[s][0]/n;else try{o=r[1],c=r[0]}catch(jS){throw new Error("Invalid format: "+r)}if("p"===e||"portrait"===e)e="p",c>o&&(l=c,c=o,o=l);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",o>c&&(l=c,c=o,o=l)}return{width:c,height:o,unit:t,k:n,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(qA):null;var r=new l(t);return t.worker?r:r.from(e).doCallback()}}(XS.API),XS.API.addJS=function(e){return QA=e,this.internal.events.subscribe("postPutResources",function(){$A=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+($A+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),JA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+QA+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==$A&&void 0!==JA&&this.internal.out("/Names <</JavaScript "+$A+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=e.outline.render().split(/\r\n/),n=0;n<a.length;n++){var s=a[n],i=r.exec(s);if(null!=i){var l=i[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var o=this.internal.pages.length,c=[];for(n=0;n<o;n++){var d=e.internal.newObject();c.push(d);var u=e.internal.getPageInfo(n+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var h=e.internal.newObject();for(e.internal.write("<< /Names [ "),n=0;n<c.length;n++)e.internal.write("(page_"+(n+1)+")"+c[n]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+h+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,r){var a={title:t,options:r,children:[]};return null==e&&(e=this.root),e.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var r=0;r<t.children.length;r++)this.genIds_r(t.children[r])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<t.children.length;a++){var n=t.children[a];this.objStart(n),this.line("/Title "+this.makeString(n.title)),this.line("/Parent "+this.makeRef(t)),a>0&&this.line("/Prev "+this.makeRef(t.children[a-1])),a<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[a+1])),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1])));var s=this.count=this.count_r({count:0},n);if(s>0&&this.line("/Count "+s),n.options&&n.options.pageNumber){var i=e.internal.getPageInfo(n.options.pageNumber);this.line("/Dest ["+i.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var l=0;l<t.children.length;l++)this.renderItems(t.children[l])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var r=0;r<t.children.length;r++)e.count++,this.count_r(e,t.children[r]);return e.count}}])}(XS.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,r,a,n,s,i){var l,o=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,l=function(e){for(var r,a=256*e.charCodeAt(4)+e.charCodeAt(5),n=e.length,s={width:0,height:0,numcomponents:1},i=4;i<n;i+=2){if(i+=a,-1!==t.indexOf(e.charCodeAt(i+1))){r=256*e.charCodeAt(i+5)+e.charCodeAt(i+6),s={width:256*e.charCodeAt(i+7)+e.charCodeAt(i+8),height:r,numcomponents:e.charCodeAt(i+9)};break}a=256*e.charCodeAt(i+2)+e.charCodeAt(i+3)}return s}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),l.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}c={data:e,width:l.width,height:l.height,colorSpace:i,bitsPerComponent:8,filter:o,index:r,alias:a}}return c}}(XS.API),XS.API.processPNG=function(e,t,r,a){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var n,s=function(e,t){return new mS(e,t).decode()}(e,{checkCrc:!0}),i=s.width,l=s.height,o=s.channels,c=s.palette,d=s.depth;n=c&&1===o?function(e){for(var t=e.width,r=e.height,a=e.data,n=e.palette,s=e.depth,i=!1,l=[],o=[],c=void 0,d=!1,u=0,h=0;h<n.length;h++){var f=Gy(n[h],4),m=f[0],p=f[1],g=f[2],x=f[3];l.push(m,p,g),null!=x&&(0===x?(u++,o.length<1&&o.push(h)):x<255&&(d=!0))}if(d||u>1){i=!0,o=void 0;var b=t*r;c=new Uint8Array(b);for(var v=new DataView(a.buffer),y=0;y<b;y++){var w=Gy(n[mC(v,y,s)],4)[3];c[y]=w}}else 0===u&&(o=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:i?8:void 0,colorBytes:a,alphaBytes:c,needSMask:i,palette:l,mask:o}}(s):2===o||4===o?function(e){for(var t=e.data,r=e.width,a=e.height,n=e.channels,s=e.depth,i=2===n?"DeviceGray":"DeviceRGB",l=n-1,o=r*a,c=l,d=o*c,u=1*o,h=Math.ceil(d*s/8),f=Math.ceil(u*s/8),m=new Uint8Array(h),p=new Uint8Array(f),g=new DataView(t.buffer),x=new DataView(m.buffer),b=new DataView(p.buffer),v=!1,y=0;y<o;y++){for(var w=y*n,N=0;N<c;N++)pC(x,mC(g,w+N,s),y*c+N,s);var j=mC(g,w+c,s);j<(1<<s)-1&&(v=!0),pC(b,j,1*y,s)}return{colorSpace:i,colorsPerPixel:l,sMaskBitsPerComponent:v?s:void 0,colorBytes:m,alphaBytes:p,needSMask:v}}(s):function(e){var t=e.data,r=1===e.channels?"DeviceGray":"DeviceRGB";return{colorSpace:r,colorsPerPixel:"DeviceGray"===r?1:3,colorBytes:t instanceof Uint16Array?function(e){for(var t=e.length,r=new Uint8Array(2*t),a=new DataView(r.buffer,r.byteOffset,r.byteLength),n=0;n<t;n++)a.setUint16(2*n,e[n],!1);return r}(t):t,needSMask:!1}}(s);var u,h,f,m=n,p=m.colorSpace,g=m.colorsPerPixel,x=m.sMaskBitsPerComponent,b=m.colorBytes,v=m.alphaBytes,y=m.needSMask,w=m.palette,N=m.mask,j=null;return a!==XS.API.image_compression.NONE?(j=function(e){var t;switch(e){case XS.API.image_compression.FAST:t=11;break;case XS.API.image_compression.MEDIUM:t=13;break;case XS.API.image_compression.SLOW:t=14;break;default:t=12}return t}(a),u=this.decode.FLATE_DECODE,h="/Predictor ".concat(j," /Colors ").concat(g," /BitsPerComponent ").concat(d," /Columns ").concat(i),e=iC(b,Math.ceil(i*g*d/8),g,d,a),y&&(f=iC(v,Math.ceil(i*x/8),1,x,a))):(u=void 0,h=void 0,e=b,y&&(f=v)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:r,data:e,index:t,filter:u,decodeParameters:h,transparency:N,palette:w,sMask:f,predictor:j,width:i,height:l,bitsPerComponent:d,sMaskBitsPerComponent:x,colorSpace:p}}},function(e){e.processGIF89A=function(t,r,a,n){var s=new xC(t),i=s.width,l=s.height,o=[];s.decodeAndBlitFrameRGBA(0,o);var c={data:o,width:i,height:l},d=new vC(100).encode(c,100);return e.processJPEG.call(this,d,r,a,n)},e.processGIF87A=e.processGIF89A}(XS.API),yC.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yC.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){bS.log("bit decode error:"+r)}},yC.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),i=a*this.width*4+8*n*4,l=0;l<8&&8*n+l<this.width;l++){var o=this.palette[s>>7-l&1];this.data[i+4*l]=o.blue,this.data[i+4*l+1]=o.green,this.data[i+4*l+2]=o.red,this.data[i+4*l+3]=255}0!==r&&(this.pos+=4-r)}},yC.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var s=this.datav.getUint8(this.pos++,!0),i=a*this.width*4+2*n*4,l=s>>4,o=15&s,c=this.palette[l];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*n+1>=this.width)break;c=this.palette[o],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}0!==t&&(this.pos+=4-t)}},yC.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var i=this.palette[n];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==e&&(this.pos+=4-e)}},yC.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,o=(s>>10&t)/t*255|0,c=s>>15?255:0,d=a*this.width*4+4*n;this.data[d]=o,this.data[d+1]=l,this.data[d+2]=i,this.data[d+3]=c}this.pos+=e}},yC.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,o=(i>>5&r)/r*255|0,c=(i>>11)/t*255|0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},yC.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=s,this.data[i+1]=n,this.data[i+2]=a,this.data[i+3]=255}this.pos+=this.width%4}},yC.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=i}},yC.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var s=new yC(t,!1),i=s.width,l=s.height,o={data:s.getData(),width:i,height:l},c=new vC(100).encode(o,100);return e.processJPEG.call(this,c,r,a,n)}}(XS.API),wC.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var s=new wC(t),i=s.width,l=s.height,o={data:s.getData(),width:i,height:l},c=new vC(100).encode(o,100);return e.processJPEG.call(this,c,r,a,n)}}(XS.API),XS.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,s=new Uint8Array(n/4*3),i=new Uint8Array(n/4),l=0,o=0,c=0;c<n;c+=4){var d=a[c],u=a[c+1],h=a[c+2],f=a[c+3];s[l++]=d,s[l++]=u,s[l++]=h,i[o++]=f}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},XS.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ZA=XS.API,eC=ZA.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:n.metadata.Unicode.widths,o=l.fof?l.fof:1,c=t.kerning?t.kerning:n.metadata.Unicode.kerning,d=c.fof?c.fof:1,u=!1!==t.doKerning,h=0,f=e.length,m=0,p=l[0]||o,g=[];for(r=0;r<f;r++)a=e.charCodeAt(r),"function"==typeof n.metadata.widthOfString?g.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+i*(1e3/s)||0)/1e3):(h=u&&"object"===(0,sy.A)(c[a])&&!isNaN(parseInt(c[a][m],10))?c[a][m]/d:0,g.push((l[a]||p)/o+h)),m=a;return g},tC=ZA.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return ZA.processArabic&&(e=ZA.processArabic(e)),"function"==typeof a.metadata.widthOfString?a.metadata.widthOfString(e,r,n)/r:eC.apply(this,arguments).reduce(function(e,t){return e+t},0)},rC=function(e,t,r,a){for(var n=[],s=0,i=e.length,l=0;s!==i&&l+t[s]<r;)l+=t[s],s++;n.push(e.slice(0,s));var o=s;for(l=0;s!==i;)l+t[s]>a&&(n.push(e.slice(o,s)),l=0,o=s),l+=t[s],s++;return o!==s&&n.push(e.slice(o,s)),n},aC=function(e,t,r){r||(r={});var a,n,s,i,l,o,c,d=[],u=[d],h=r.textIndent||0,f=0,m=0,p=e.split(" "),g=eC.apply(this,[" ",r])[0];if(o=-1===r.lineIndent?p[0].length+2:r.lineIndent||0){var x=Array(o).join(" "),b=[];p.map(function(e){(e=e.split(/\s*\n/)).length>1?b=b.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):b.push(e[0])}),p=b,o=tC.apply(this,[x,r])}for(s=0,i=p.length;s<i;s++){var v=0;if(a=p[s],o&&"\n"==a[0]&&(a=a.substr(1),v=1),h+f+(m=(n=eC.apply(this,[a,r])).reduce(function(e,t){return e+t},0))>t||v){if(m>t){for(l=rC.apply(this,[a,n,t-(h+f),t]),d.push(l.shift()),d=[l.pop()];l.length;)u.push([l.shift()]);m=n.slice(a.length-(d[0]?d[0].length:0)).reduce(function(e,t){return e+t},0)}else d=[a];u.push(d),h=m+o,f=g}else d.push(a),h+=f+m,f=g}return c=o?function(e,t){return(t?x:"")+e.join(" ")}:function(e){return e.join(" ")},u.map(c)},ZA.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle),r="Unicode";return t.metadata[r]?{widths:t.metadata[r].widths||{0:1},kerning:t.metadata[r].kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var l,o,c=[];for(l=0,o=a.length;l<o;l++)c=c.concat(aC.apply(this,[a[l],i,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=t[s],n[t[s]]=r[s];var i=function(e){return"0x"+parseInt(e,10).toString(16)},l=e.__fontmetrics__.compress=function(e){var t,r,a,s,o=["{"];for(var c in e){if(t=e[c],isNaN(parseInt(c,10))?r="'"+c+"'":(c=parseInt(c,10),r=(r=i(c).slice(2)).slice(0,-1)+n[r.slice(-1)]),"number"==typeof t)t<0?(a=i(t).slice(3),s="-"):(a=i(t).slice(2),s=""),a=s+a.slice(0,-1)+n[a.slice(-1)];else{if("object"!==(0,sy.A)(t))throw new Error("Don't know what to do with value type "+(0,sy.A)(t)+".");a=l(t)}o.push(r+a)}return o.push("}"),o.join("")},o=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,r,n,s,i={},l=1,o=i,c=[],d="",u="",h=e.length-1,f=1;f<h;f+=1)"'"==(s=e[f])?t?(n=t.join(""),t=void 0):t=[]:t?t.push(s):"{"==s?(c.push([o,n]),o={},n=void 0):"}"==s?((r=c.pop())[0][r[1]]=o,n=void 0,o=r[0]):"-"==s?l=-1:void 0===n?a.hasOwnProperty(s)?(d+=a[s],n=parseInt(d,16)*l,l=1,d=""):d+=s:a.hasOwnProperty(s)?(u+=a[s],o[n]=parseInt(u,16)*l,l=1,n=void 0,u=""):u+=s;return i},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,r=u.Unicode[t.postScriptName];r&&(t.metadata.Unicode={},t.metadata.Unicode.widths=r.widths,t.metadata.Unicode.kerning=r.kerning);var a=d.Unicode[t.postScriptName];a&&(t.metadata.Unicode.encoding=a,t.encoding=a.codePages[0])}])}(XS.API),function(e){var t=function(e){for(var t=e.length,r=new Uint8Array(t),a=0;a<t;a++)r[a]=e.charCodeAt(a);return r};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if("string"!=typeof(a=!1===s.existsFileInVFS(n.postScriptName)?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");!function(r,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(kS(a)),r.metadata=e.API.TTFFont.open(a),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0]}(n,a)}}])}(XS),XS.API.addSvgAsImage=function(e,t,a,n,s,i,l,o){if(isNaN(t)||isNaN(a))throw bS.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw bS.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(gS.canvg?Promise.resolve(gS.canvg):r.e(455).then(r.bind(r,8455))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,a,n,s,l,o)})},XS.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},XS.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),o=[],c=0,d=0,u=0;function h(e,t){var r,a=!1;for(r=0;r<e.length;r+=1)e[r]===t&&(a=!0);return a}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var f=l.length;for(u=0;u<f;u+=1)r[l[u]].value=r[l[u]].defaultValue,r[l[u]].explicitSet=!1}if("object"===(0,sy.A)(e))for(n in e)if(s=e[n],h(l,n)&&void 0!==s){if("boolean"===r[n].type&&"boolean"==typeof s)r[n].value=s;else if("name"===r[n].type&&h(r[n].valueSet,s))r[n].value=s;else if("integer"===r[n].type&&Number.isInteger(s))r[n].value=s;else if("array"===r[n].type){for(c=0;c<s.length;c+=1)if(a=!0,1===s[c].length&&"number"==typeof s[c][0])o.push(String(s[c]-1));else if(s[c].length>1){for(d=0;d<s[c].length;d+=1)"number"!=typeof s[c][d]&&(a=!1);!0===a&&o.push([s[c][0]-1,s[c][1]-1].join(" "))}r[n].value="["+o.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in r)!0===r[e].explicitSet&&("name"===r[e].type?t.push("/"+e+" /"+r[e].value):t.push("/"+e+" "+r[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(e)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),n=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),i=r.length+a.length+n.length+t.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(t+r+a+n+s),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,a){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(XS.API),function(e){var t=e.API,r=t.pdfEscape16=function(e,t){for(var r,a=t.metadata.Unicode.widths,n=["","0","00","000","0000"],s=[""],i=0,l=e.length;i<l;++i){if(r=t.metadata.characterToGlyph(e.charCodeAt(i)),t.metadata.glyIdsUsed.push(r),t.metadata.toUnicode[r]=e.charCodeAt(i),-1==a.indexOf(r)&&(a.push(r),a.push([parseInt(t.metadata.widthOfGlyph(r),10)])),"0"==r)return s.join("");r=r.toString(16),s.push(n[4-r.length],r)}return s.join("")},a=function(e){var t,r,a,n,s,i,l;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",a=[],i=0,l=(r=Object.keys(e).sort(function(e,t){return e-t})).length;i<l;i++)t=r[i],a.length>=100&&(s+="\n"+a.length+" beginbfchar\n"+a.join("\n")+"\nendbfchar",a=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(n=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),a.push("<"+t+"><"+n+">"));return a.length&&(s+="\n"+a.length+" beginbfchar\n"+a.join("\n")+"\nendbfchar\n"),s+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var r=t.font,n=t.out,s=t.newObject,i=t.putStream;if(r.metadata instanceof e.API.TTFFont&&"Identity-H"===r.encoding){for(var l=r.metadata.Unicode.widths,o=r.metadata.subset.encode(r.metadata.glyIdsUsed,1),c="",d=0;d<o.length;d++)c+=String.fromCharCode(o[d]);var u=s();i({data:c,addLength1:!0,objectId:u}),n("endobj");var h=s();i({data:a(r.metadata.toUnicode),addLength1:!0,objectId:h}),n("endobj");var f=s();n("<<"),n("/Type /FontDescriptor"),n("/FontName /"+HS(r.fontName)),n("/FontFile2 "+u+" 0 R"),n("/FontBBox "+e.API.PDFObject.convert(r.metadata.bbox)),n("/Flags "+r.metadata.flags),n("/StemV "+r.metadata.stemV),n("/ItalicAngle "+r.metadata.italicAngle),n("/Ascent "+r.metadata.ascender),n("/Descent "+r.metadata.decender),n("/CapHeight "+r.metadata.capHeight),n(">>"),n("endobj");var m=s();n("<<"),n("/Type /Font"),n("/BaseFont /"+HS(r.fontName)),n("/FontDescriptor "+f+" 0 R"),n("/W "+e.API.PDFObject.convert(l)),n("/CIDToGIDMap /Identity"),n("/DW 1000"),n("/Subtype /CIDFontType2"),n("/CIDSystemInfo"),n("<<"),n("/Supplement 0"),n("/Registry (Adobe)"),n("/Ordering ("+r.encoding+")"),n(">>"),n(">>"),n("endobj"),r.objectNumber=s(),n("<<"),n("/Type /Font"),n("/Subtype /Type0"),n("/ToUnicode "+h+" 0 R"),n("/BaseFont /"+HS(r.fontName)),n("/Encoding /"+r.encoding),n("/DescendantFonts ["+m+" 0 R]"),n(">>"),n("endobj"),r.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var r=t.font,n=t.out,s=t.newObject,i=t.putStream;if(r.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===r.encoding){for(var l=r.metadata.rawData,o="",c=0;c<l.length;c++)o+=String.fromCharCode(l[c]);var d=s();i({data:o,addLength1:!0,objectId:d}),n("endobj");var u=s();i({data:a(r.metadata.toUnicode),addLength1:!0,objectId:u}),n("endobj");var h=s();n("<<"),n("/Descent "+r.metadata.decender),n("/CapHeight "+r.metadata.capHeight),n("/StemV "+r.metadata.stemV),n("/Type /FontDescriptor"),n("/FontFile2 "+d+" 0 R"),n("/Flags 96"),n("/FontBBox "+e.API.PDFObject.convert(r.metadata.bbox)),n("/FontName /"+HS(r.fontName)),n("/ItalicAngle "+r.metadata.italicAngle),n("/Ascent "+r.metadata.ascender),n(">>"),n("endobj"),r.objectNumber=s();for(var f=0;f<r.metadata.hmtx.widths.length;f++)r.metadata.hmtx.widths[f]=parseInt(r.metadata.hmtx.widths[f]*(1e3/r.metadata.head.unitsPerEm));n("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+HS(r.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+r.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(r.metadata.hmtx.widths)+">>"),n("endobj"),r.isAlreadyPutted=!0}}(t)}]);var n=function(e){var t,a=e.text||"",n=e.x,s=e.y,i=e.options||{},l=e.mutex||{},o=l.pdfEscape,c=l.activeFontKey,d=l.fonts,u=c,h="",f=0,m="",p=d[u].encoding;if("Identity-H"!==d[u].encoding)return{text:a,x:n,y:s,options:i,mutex:l};for(m=a,u=c,Array.isArray(a)&&(m=a[0]),f=0;f<m.length;f+=1)d[u].metadata.hasOwnProperty("cmap")&&(t=d[u].metadata.cmap.unicode.codeMap[m[f].charCodeAt(0)]),t||m[f].charCodeAt(0)<256&&d[u].metadata.hasOwnProperty("Unicode")?h+=m[f]:h+="";var g="";return parseInt(u.slice(1))<14||"WinAnsiEncoding"===p?g=o(h,u).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===p&&(g=r(h,d[u])),l.isHex=!0,{text:g,x:n,y:s,options:i,mutex:l}};t.events.push(["postProcessText",function(e){var t=e.text||"",r=[],a={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var s=0;for(s=0;s<t.length;s+=1)Array.isArray(t[s])&&3===t[s].length?r.push([n(Object.assign({},a,{text:t[s][0]})).text,t[s][1],t[s][2]]):r.push(n(Object.assign({},a,{text:t[s]})).text);e.text=r}else e.text=n(Object.assign({},a,{text:t})).text}])}(XS),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,r){return t.call(this),this.internal.vFS[e]=r,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(XS.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var r,a,n,s,i,l,o,c=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},m=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,x=0;this.__bidiEngine__={};var b=function(e){var t=e.charCodeAt(),r=t>>8,a=f[r];return void 0!==a?c[256*a+(255&t)]:252===r||253===r?"AL":p.test(r)?"L":8===r?"R":"N"},v=function(e){for(var t,r=0;r<e.length;r++){if("L"===(t=b(e.charAt(r))))return!1;if("R"===t)return!0}return!1},y=function(e,t,i,l){var o,c,d,u,h=t[l];switch(h){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(h="AN");break;case"AL":g=!0,h="R";break;case"WS":case"BN":h="N";break;case"CS":l<1||l+1>=t.length||"EN"!==(o=i[l-1])&&"AN"!==o||"EN"!==(c=t[l+1])&&"AN"!==c?h="N":g&&(c="AN"),h=c===o?c:"N";break;case"ES":h="EN"===(o=l>0?i[l-1]:"B")&&l+1<t.length&&"EN"===t[l+1]?"EN":"N";break;case"ET":if(l>0&&"EN"===i[l-1]){h="EN";break}if(g){h="N";break}for(d=l+1,u=t.length;d<u&&"ET"===t[d];)d++;h=d<u&&"EN"===t[d]?"EN":"N";break;case"NSM":if(n&&!s){for(u=t.length,d=l+1;d<u&&"NSM"===t[d];)d++;if(d<u){var f=e[l],m=f>=1425&&f<=2303||64286===f;if(o=t[d],m&&("R"===o||"AL"===o)){h="R";break}}}h=l<1||"B"===(o=t[l-1])?"N":i[l-1];break;case"B":g=!1,r=!0,h=x;break;case"S":a=!0,h="N"}return h},w=function(e,t,r){var a=e.split("");return r&&N(a,r,{hiLevel:x}),a.reverse(),t&&t.reverse(),a.join("")},N=function(e,t,n){var s,i,l,o,c,f=-1,m=e.length,p=0,v=[],w=x?u:d,N=[];for(g=!1,r=!1,a=!1,i=0;i<m;i++)N[i]=b(e[i]);for(l=0;l<m;l++){if(c=p,v[l]=y(e,N,v,l),s=240&(p=w[c][h[v[l]]]),p&=15,t[l]=o=w[p][5],s>0)if(16===s){for(i=f;i<l;i++)t[i]=1;f=-1}else f=-1;if(w[p][6])-1===f&&(f=l);else if(f>-1){for(i=f;i<l;i++)t[i]=o;f=-1}"B"===N[l]&&(t[l]=0),n.hiLevel|=o}a&&function(e,t,r){for(var a=0;a<r;a++)if("S"===e[a]){t[a]=x;for(var n=a-1;n>=0&&"WS"===e[n];n--)t[n]=x}}(N,t,m)},j=function(e,t,a,n,s){if(!(s.hiLevel<e)){if(1===e&&1===x&&!r)return t.reverse(),void(a&&a.reverse());for(var i,l,o,c,d=t.length,u=0;u<d;){if(n[u]>=e){for(o=u+1;o<d&&n[o]>=e;)o++;for(c=u,l=o-1;c<l;c++,l--)i=t[c],t[c]=t[l],t[l]=i,a&&(i=a[c],a[c]=a[l],a[l]=i);u=o}u++}}},k=function(e,t,r){var a=e.split(""),n={hiLevel:x};return r||(r=[]),N(a,r,n),function(e,t,r){if(0!==r.hiLevel&&o)for(var a,n=0;n<e.length;n++)1===t[n]&&(a=m.indexOf(e[n]))>=0&&(e[n]=m[a+1])}(a,r,n),j(2,a,t,r,n),j(1,a,t,r,n),a.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,r){if(function(e,t){if(t)for(var r=0;r<e.length;r++)t[r]=r;void 0===s&&(s=v(e)),void 0===l&&(l=v(e))}(e,t),n||!i||l)if(n&&i&&s^l)x=s?1:0,e=w(e,t,r);else if(!n&&i&&l)x=s?1:0,e=k(e,t,r),e=w(e,t);else if(!n||s||i||l){if(n&&!i&&s^l)e=w(e,t),s?(x=0,e=k(e,t,r)):(x=1,e=k(e,t,r),e=w(e,t));else if(n&&s&&!i&&l)x=1,e=k(e,t,r),e=w(e,t);else if(!n&&!i&&s^l){var a=o;s?(x=1,e=k(e,t,r),x=0,o=!1,e=k(e,t,r),o=a):(x=0,e=k(e,t,r),e=w(e,t),x=1,o=!1,e=k(e,t,r),o=a,e=w(e,t))}}else x=0,e=k(e,t,r);else x=s?1:0,e=k(e,t,r);return e},this.__bidiEngine__.setOptions=function(e){e&&(n=e.isInputVisual,i=e.isOutputVisual,s=e.isInputRtl,l=e.isOutputRtl,o=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var a=e.options||{};e.mutex,a.lang;var n=[];if(a.isInputVisual="boolean"!=typeof a.isInputVisual||a.isInputVisual,r.setOptions(a),"[object Array]"===Object.prototype.toString.call(t)){var s=0;for(n=[],s=0;s<t.length;s+=1)"[object Array]"===Object.prototype.toString.call(t[s])?n.push([r.doBidiReorder(t[s][0]),t[s][1],t[s][2]]):n.push([r.doBidiReorder(t[s])]);e.text=n}else e.text=r.doBidiReorder(t);r.setOptions({isInputVisual:!0})}])}(XS),XS.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new jC(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new qC(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new kC(this.contents),this.head=new CC(this),this.name=new FC(this),this.cmap=new TC(this),this.toUnicode={},this.hhea=new EC(this),this.maxp=new DC(this),this.hmtx=new IC(this),this.post=new PC(this),this.os2=new LC(this),this.loca=new zC(this),this.glyf=new MC(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,r,a,n;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,r,a,n;for(n=[],t=0,r=(a=this.bbox).length;t<r;t++)e=a[t],n.push(Math.round(e*this.scaleFactor));return n}.call(this),this.stemV=0,this.post.exists?(r=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(n=this.familyClass)||2===n||3===n||4===n||5===n||7===n,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,r){var a,n,s,i;for(s=0,n=0,i=(e=""+e).length;0<=i?n<i:n>i;n=0<=i?++n:--n)a=e.charCodeAt(n),s+=this.widthOfGlyph(this.characterToGlyph(a))+r*(1e3/t)||0;return s*(t/1e3)},e.prototype.lineHeight=function(e,t){var r;return null==t&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},e}();var NC,jC=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(e){var t,r,a;for(a=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)a.push(this.writeByte(e.charCodeAt(t)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,r,a,n,s,i,l;return e=this.readByte(),t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^a)+16777216*(255^n)+65536*(255^s)+256*(255^i)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*a+16777216*n+65536*s+256*i+l},e.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(e){var t,r,a,n;for(n=[],r=0,a=e.length;r<a;r++)t=e[r],n.push(this.writeByte(t));return n},e}(),kC=function(){var e;function t(e){var t,r,a;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,a=this.tableCount;0<=a?r<a:r>a;r=0<=a?++r:--r)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var r,a,n,s,i,l,o,c,d,u,h,f,m;for(m in h=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(h)/l),s=Math.floor(d/l),c=16*h-d,(a=new jC).writeInt(this.scalarType),a.writeShort(h),a.writeShort(d),a.writeShort(s),a.writeShort(c),n=16*h,o=a.pos+n,i=null,f=[],t)for(u=t[m],a.writeString(m),a.writeInt(e(u)),a.writeInt(o),a.writeInt(u.length),f=f.concat(u),"head"===m&&(i=o),o+=u.length;o%4;)f.push(0),o++;return a.write(f),r=2981146554-e(a.data),a.pos=i+8,a.writeUInt32(r),a.data},e=function(e){var t,r,a,n;for(e=RC.call(e);e.length%4;)e.push(0);for(a=new jC(e),r=0,t=0,n=e.length;t<n;t=t+=4)r+=a.readUInt32();return 4294967295&r},t}(),SC={}.hasOwnProperty,AC=function(e,t){for(var r in t)SC.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};NC=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var CC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new jC).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),_C=function(){function e(e,t){var r,a,n,s,i,l,o,c,d,u,h,f,m,p,g,x,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(h=e.readUInt16(),u=h/2,e.pos+=6,n=function(){var t,r;for(r=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)r.push(e.readUInt16());return r}(),e.pos+=2,m=function(){var t,r;for(r=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)r.push(e.readUInt16());return r}(),o=function(){var t,r;for(r=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)r.push(e.readUInt16());return r}(),c=function(){var t,r;for(r=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)r.push(e.readUInt16());return r}(),a=(this.length-e.pos+this.offset)/2,i=function(){var t,r;for(r=[],l=t=0;0<=a?t<a:t>a;l=0<=a?++t:--t)r.push(e.readUInt16());return r}(),l=g=0,b=n.length;g<b;l=++g)for(p=n[l],r=x=f=m[l];f<=p?x<=p:x>=p;r=f<=p?++x:--x)0===c[l]?s=r+o[l]:0!==(s=i[c[l]/2+(r-f)-(u-l)]||0)&&(s+=o[l]),this.codeMap[r]=65535&s}e.pos=d}return e.encode=function(e,t){var r,a,n,s,i,l,o,c,d,u,h,f,m,p,g,x,b,v,y,w,N,j,k,S,A,C,_,T,E,L,P,O,F,D,I,R,M,B,U,z,q,H,W,V,G,K;switch(T=new jC,s=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(m=0,p=function(){var e=[];for(f=0;f<256;++f)e.push(0);return e}(),x={0:0},n={},E=0,F=s.length;E<F;E++)null==x[W=e[a=s[E]]]&&(x[W]=++m),n[a]={old:e[a],new:x[e[a]]},p[a]=x[e[a]];return T.writeUInt16(1),T.writeUInt16(0),T.writeUInt32(12),T.writeUInt16(0),T.writeUInt16(262),T.writeUInt16(0),T.write(p),{charMap:n,subtable:T.data,maxGlyphID:m+1};case"unicode":for(C=[],d=[],b=0,x={},r={},g=o=null,L=0,D=s.length;L<D;L++)null==x[y=e[a=s[L]]]&&(x[y]=++b),r[a]={old:y,new:x[y]},i=x[y]-a,null!=g&&i===o||(g&&d.push(g),C.push(a),o=i),g=a;for(g&&d.push(g),d.push(65535),C.push(65535),S=2*(k=C.length),j=2*Math.pow(Math.log(k)/Math.LN2,2),u=Math.log(j/2)/Math.LN2,N=2*k-j,l=[],w=[],h=[],f=P=0,I=C.length;P<I;f=++P){if(A=C[f],c=d[f],65535===A){l.push(0),w.push(0);break}if(A-(_=r[A].new)>=32768)for(l.push(0),w.push(2*(h.length+k-f)),a=O=A;A<=c?O<=c:O>=c;a=A<=c?++O:--O)h.push(r[a].new);else l.push(_-A),w.push(0)}for(T.writeUInt16(3),T.writeUInt16(1),T.writeUInt32(12),T.writeUInt16(4),T.writeUInt16(16+8*k+2*h.length),T.writeUInt16(0),T.writeUInt16(S),T.writeUInt16(j),T.writeUInt16(u),T.writeUInt16(N),q=0,R=d.length;q<R;q++)a=d[q],T.writeUInt16(a);for(T.writeUInt16(0),H=0,M=C.length;H<M;H++)a=C[H],T.writeUInt16(a);for(V=0,B=l.length;V<B;V++)i=l[V],T.writeUInt16(i);for(G=0,U=w.length;G<U;G++)v=w[G],T.writeUInt16(v);for(K=0,z=h.length;K<z;K++)m=h[K],T.writeUInt16(m);return{charMap:r,subtable:T.data,maxGlyphID:b+1}}},e}(),TC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,r,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=a?r<a:r>a;r=0<=a?++r:--r)t=new _C(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var r,a;return null==t&&(t="macroman"),r=_C.encode(e,t),(a=new jC).writeUInt16(0),a.writeUInt16(1),r.table=a.data.concat(r.subtable),r},e}(),EC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),LC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r}(),this.charRange=function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),PC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="post",e.prototype.parse=function(e){var t,r,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var n;for(r=e.readUInt16(),this.glyphNameIndex=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)t=e.readByte(),a.push(this.names.push(e.readString(t)));return a;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=function(){var t,r,a;for(a=[],n=t=0,r=this.file.maxp.numGlyphs;0<=r?t<r:t>r;n=0<=r?++t:--t)a.push(e.readUInt32());return a}.call(this)}},e}(),OC=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},FC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="name",e.prototype.parse=function(e){var t,r,a,n,s,i,l,o,c,d,u;for(e.pos=this.offset,e.readShort(),t=e.readShort(),i=e.readShort(),r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+i+e.readShort()});for(l={},n=c=0,d=r.length;c<d;n=++c)a=r[n],e.pos=a.offset,o=e.readString(a.length),s=new OC(o,a),null==l[u=a.nameID]&&(l[u]=[]),l[a.nameID].push(s);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(kS){this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),DC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),IC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,r,a,n,s,i,l;for(e.pos=this.offset,this.metrics=[],t=0,i=this.file.hhea.numberOfMetrics;0<=i?t<i:t>i;t=0<=i?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var r,n;for(n=[],t=r=0;0<=a?r<a:r>a;t=0<=a?++r:--r)n.push(e.readInt16());return n}(),this.widths=function(){var e,t,r,a;for(a=[],e=0,t=(r=this.metrics).length;e<t;e++)n=r[e],a.push(n.advance);return a}.call(this),r=this.widths[this.widths.length-1],l=[],t=s=0;0<=a?s<a:s>a;t=0<=a?++s:--s)l.push(this.widths.push(r));return l},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),RC=[].slice,MC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,r,a,n,s,i,l,o,c,d;return e in this.cache?this.cache[e]:(n=this.file.loca,t=this.file.contents,r=n.indexOf(e),0===(a=n.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+r,s=(i=new jC(t.read(a))).readShort(),o=i.readShort(),d=i.readShort(),l=i.readShort(),c=i.readShort(),this.cache[e]=-1===s?new UC(i,o,d,l,c):new BC(i,s,o,d,l,c),this.cache[e]))},e.prototype.encode=function(e,t,r){var a,n,s,i,l;for(s=[],n=[],i=0,l=t.length;i<l;i++)a=e[t[i]],n.push(s.length),a&&(s=s.concat(a.encode(r)));return n.push(s.length),{table:s,offsets:n}},e}(),BC=function(){function e(e,t,r,a,n,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),UC=function(){function e(e,t,r,a,n){var s,i;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=a,this.yMax=n,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;i=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&i;)s.pos+=1&i?4:2,128&i?s.pos+=8:64&i?s.pos+=4:8&i&&(s.pos+=2)}return e.prototype.encode=function(){var e,t,r;for(t=new jC(RC.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),zC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return AC(e,NC),e.prototype.tag="loca",e.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,a;for(a=[],r=0,t=this.length;r<t;r+=2)a.push(2*e.readUInt16());return a}.call(this):function(){var t,a;for(a=[],r=0,t=this.length;r<t;r+=4)a.push(e.readUInt32());return a}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),a=0,n=0,s=0;s<r.length;++s)if(r[s]=a,n<t.length&&t[n]==s){++n,r[s]=a;var i=this.offsets[s],l=this.offsets[s+1]-i;l>0&&(a+=l)}for(var o=new Array(4*r.length),c=0;c<r.length;++c)o[4*c+3]=255&r[c],o[4*c+2]=(65280&r[c])>>8,o[4*c+1]=(16711680&r[c])>>16,o[4*c]=(4278190080&r[c])>>24;return o},e}(),qC=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,r,a,n;for(t in a=this.font.cmap.tables[0].codeMap,e={},n=this.subset)r=n[t],e[t]=a[r];return e},e.prototype.glyphsFor=function(e){var t,r,a,n,s,i,l;for(a={},s=0,i=e.length;s<i;s++)a[n=e[s]]=this.font.glyf.glyphFor(n);for(n in t=[],a)(null!=(r=a[n])?r.compound:void 0)&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(n in l=this.glyphsFor(t))r=l[n],a[n]=r;return a},e.prototype.encode=function(e,t){var r,a,n,s,i,l,o,c,d,u,h,f,m,p,g;for(a in r=TC.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),h={0:0},g=r.charMap)h[(l=g[a]).old]=l.new;for(f in u=r.maxGlyphID,s)f in h||(h[f]=u++);return c=function(e){var t,r;for(t in r={},e)r[e[t]]=t;return r}(h),d=Object.keys(c).sort(function(e,t){return e-t}),m=function(){var e,t,r;for(r=[],e=0,t=d.length;e<t;e++)i=d[e],r.push(c[i]);return r}(),n=this.font.glyf.encode(s,m,h),o=this.font.loca.encode(n.offsets,m),p={cmap:this.font.cmap.raw(),glyf:n.table,loca:o,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(p["OS/2"]=this.font.os2.raw()),this.font.directory.encode(p)},e}();function HC(e,t,r,a,n){a=a||{};var s=n.internal.scaleFactor,i=n.internal.getFontSize()/s,l=i*(n.getLineHeightFactor?n.getLineHeightFactor():1.15),o="",c=1;if("middle"!==a.valign&&"bottom"!==a.valign&&"center"!==a.halign&&"right"!==a.halign||(c=(o="string"===typeof e?e.split(/\r\n|\r|\n/g):e).length||1),r+=i*(2-1.15),"middle"===a.valign?r-=c/2*l:"bottom"===a.valign&&(r-=c*l),"center"===a.halign||"right"===a.halign){var d=i;if("center"===a.halign&&(d*=.5),o&&c>=1){for(var u=0;u<o.length;u++)n.text(o[u],t-n.getStringUnitWidth(o[u])*d,r),r+=l;return n}t-=n.getStringUnitWidth(e)*d}return"justify"===a.halign?n.text(e,t,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(e,t,r),n}XS.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(r){var a,n,s,i;if(Array.isArray(r))return"["+function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)a=r[e],s.push(t.convert(a));return s}().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(r)){for(n in s=["<<"],r)i=r[n],s.push("/"+n+" "+t.convert(i));return s.push(">>"),s.join("\n")}return""+r},t}();var WC={},VC=function(){function e(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(e,t){void 0===t&&(t=null),t?t.__autoTableDocumentDefaults=e:WC=e},e.unifyColor=function(e){return Array.isArray(e)?e:"number"===typeof e?[e,e,e]:"string"===typeof e?[e]:null},e.prototype.applyStyles=function(t,r){var a,n,s;void 0===r&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),l=i.fontStyle,o=i.fontName;if(t.font&&(o=t.font),t.fontStyle){l=t.fontStyle;var c=this.getFontList()[o];c&&-1===c.indexOf(l)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),l=c[0])}if(this.jsPDFDocument.setFont(o,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var d=e.unifyColor(t.fillColor);d&&(a=this.jsPDFDocument).setFillColor.apply(a,d),(d=e.unifyColor(t.textColor))&&(n=this.jsPDFDocument).setTextColor.apply(n,d),(d=e.unifyColor(t.lineColor))&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),"number"===typeof t.lineWidth&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(e,t,r){return this.jsPDFDocument.splitTextToSize(e,t,r)},e.prototype.rect=function(e,t,r,a,n){return this.jsPDFDocument.rect(e,t,r,a,n)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return WC||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return null==e.width&&(e={width:e.getWidth(),height:e.getHeight()}),e},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),GC=function(e,t){return GC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},GC(e,t)};function KC(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}GC(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}"function"===typeof SuppressedError&&SuppressedError;var YC=function(e){function t(t){var r=e.call(this)||this;return r._element=t,r}return KC(t,e),t}(Array);function XC(e,t,r){r.applyStyles(t,!0);var a=(Array.isArray(e)?e:[e]).map(function(e){return r.getTextWidth(e)}).reduce(function(e,t){return Math.max(e,t)},0);return a}function $C(e,t,r,a){var n=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:n,lineColor:s});var i=JC(n,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),a.y-r.y,i)}function JC(e,t){var r=e>0,a=t||0===t;return r&&a?"DF":r?"S":a?"F":null}function QC(e,t){var r,a,n,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:t}return"object"===typeof e?("number"===typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"===typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(r=e.left)&&void 0!==r?r:t,top:null!==(a=e.top)&&void 0!==a?a:t,right:null!==(n=e.right)&&void 0!==n?n:t,bottom:null!==(s=e.bottom)&&void 0!==s?s:t}):("number"!==typeof e&&(e=t),{top:e,right:e,bottom:e,left:e})}function ZC(e,t){var r=QC(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function e_(e,t,r,a,n){var s={},i=96/72,l=t_(t,function(e){return n.getComputedStyle(e).backgroundColor});null!=l&&(s.fillColor=l);var o=t_(t,function(e){return n.getComputedStyle(e).color});null!=o&&(s.textColor=o);var c=function(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],a=96/(72/t),n=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=r.map(function(e){return parseInt(e||"0")/a}),i=QC(s,0);n>i.top&&(i.top=n);n>i.bottom&&(i.bottom=n);return i}(a,r);c&&(s.cellPadding=c);var d="borderTopColor",u=i*r,h=a.borderTopWidth;if(a.borderBottomWidth===h&&a.borderRightWidth===h&&a.borderLeftWidth===h){var f=(parseFloat(h)||0)/u;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/u,right:(parseFloat(a.borderRightWidth)||0)/u,bottom:(parseFloat(a.borderBottomWidth)||0)/u,left:(parseFloat(a.borderLeftWidth)||0)/u},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=t_(t,function(e){return n.getComputedStyle(e)[d]});null!=m&&(s.lineColor=m);var p=["left","right","center","justify"];-1!==p.indexOf(a.textAlign)&&(s.halign=a.textAlign),-1!==(p=["middle","bottom","top"]).indexOf(a.verticalAlign)&&(s.valign=a.verticalAlign);var g=parseInt(a.fontSize||"");isNaN(g)||(s.fontSize=g/i);var x=function(e){var t="";("bold"===e.fontWeight||"bolder"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(t="bold");"italic"!==e.fontStyle&&"oblique"!==e.fontStyle||(t+="italic");return t}(a);x&&(s.fontStyle=x);var b=(a.fontFamily||"").toLowerCase();return-1!==e.indexOf(b)&&(s.font=b),s}function t_(e,t){var r=r_(e,t);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];return 0===parseInt(a[4])||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function r_(e,t){var r=t(e);return"rgba(0, 0, 0, 0)"===r||"transparent"===r||"initial"===r||"inherit"===r?null==e.parentElement?null:r_(e.parentElement,t):r}function a_(e,t,r,a,n){var s,i,l;void 0===a&&(a=!1),void 0===n&&(n=!1),l="string"===typeof t?r.document.querySelector(t):t;var o=Object.keys(e.getFontList()),c=e.scaleFactor(),d=[],u=[],h=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:d,body:u,foot:h};for(var f=0;f<l.rows.length;f++){var m=l.rows[f],p=null===(i=null===(s=null===m||void 0===m?void 0:m.parentElement)||void 0===s?void 0:s.tagName)||void 0===i?void 0:i.toLowerCase(),g=n_(o,c,r,m,a,n);g&&("thead"===p?d.push(g):"tfoot"===p?h.push(g):u.push(g))}return{head:d,body:u,foot:h}}function n_(e,t,r,a,n,s){for(var i=new YC(a),l=0;l<a.cells.length;l++){var o=a.cells[l],c=r.getComputedStyle(o);if(n||"none"!==c.display){var d=void 0;s&&(d=e_(e,o,t,c,r)),i.push({rowSpan:o.rowSpan,colSpan:o.colSpan,styles:d,_element:o,content:s_(o)})}}var u=r.getComputedStyle(a);if(i.length>0&&(n||"none"!==u.display))return i}function s_(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join("\n"),t.innerText||t.textContent||""}function i_(e,t,r,a,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),i=1;i<arguments.length;i++){var l=arguments[i];if(null!=l)for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(s[o]=l[o])}return s}function l_(e,t){var r=new VC(e),a=r.getDocumentOptions(),n=r.getGlobalOptions();!function(e,t,r){for(var a=0,n=[e,t,r];a<n.length;a++){var s=n[a];s&&"object"!==typeof s&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&"number"!==typeof s.startY&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}(n,a,t);var s,i=i_({},n,a,t);"undefined"!==typeof window&&(s=window);var l=function(e,t,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(n){if("columnStyles"===n){var s=e[n],i=t[n],l=r[n];a.columnStyles=i_({},s,i,l)}else{var o=[e,t,r].map(function(e){return e[n]||{}});a[n]=i_({},o[0],o[1],o[2])}},s=0,i=Object.keys(a);s<i.length;s++){n(i[s])}return a}(n,a,t),o=function(e,t,r){for(var a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},n=0,s=[e,t,r];n<s.length;n++){var i=s[n];i.didParseCell&&a.didParseCell.push(i.didParseCell),i.willDrawCell&&a.willDrawCell.push(i.willDrawCell),i.didDrawCell&&a.didDrawCell.push(i.didDrawCell),i.willDrawPage&&a.willDrawPage.push(i.willDrawPage),i.didDrawPage&&a.didDrawPage.push(i.didDrawPage)}return a}(n,a,t),c=function(e,t){var r,a,n,s,i,l,o,c,d,u,h,f,m,p,g=QC(t.margin,40/e.scaleFactor()),x=null!==(r=function(e,t){var r=e.getLastAutoTable(),a=e.scaleFactor(),n=e.pageNumber(),s=!1;if(r&&r.startPageNumber){s=r.startPageNumber+r.pageNumber-1===n}if("number"===typeof t)return t;if((null==t||!1===t)&&s&&null!=(null===r||void 0===r?void 0:r.finalY))return r.finalY+20/a;return null}(e,t.startY))&&void 0!==r?r:g.top;m=!0===t.showFoot?"everyPage":!1===t.showFoot?"never":null!==(a=t.showFoot)&&void 0!==a?a:"everyPage";p=!0===t.showHead?"everyPage":!1===t.showHead?"never":null!==(n=t.showHead)&&void 0!==n?n:"everyPage";var b=null!==(s=t.useCss)&&void 0!==s&&s,v=t.theme||(b?"plain":"striped"),y=!!t.horizontalPageBreak,w=null!==(i=t.horizontalPageBreakRepeat)&&void 0!==i?i:null;return{includeHiddenHtml:null!==(l=t.includeHiddenHtml)&&void 0!==l&&l,useCss:b,theme:v,startY:x,margin:g,pageBreak:null!==(o=t.pageBreak)&&void 0!==o?o:"auto",rowPageBreak:null!==(c=t.rowPageBreak)&&void 0!==c?c:"auto",tableWidth:null!==(d=t.tableWidth)&&void 0!==d?d:"auto",showHead:p,showFoot:m,tableLineWidth:null!==(u=t.tableLineWidth)&&void 0!==u?u:0,tableLineColor:null!==(h=t.tableLineColor)&&void 0!==h?h:200,horizontalPageBreak:y,horizontalPageBreakRepeat:w,horizontalPageBreakBehaviour:null!==(f=t.horizontalPageBreakBehaviour)&&void 0!==f?f:"afterAllRows"}}(r,i),d=function(e,t,r){var a=t.head||[],n=t.body||[],s=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var l=a_(e,t.html,r,i,t.useCss)||{};a=l.head||a,n=l.body||a,s=l.foot||a}else console.error("Cannot parse html in non browser environment")}var o=t.columns||function(e,t,r){var a=e[0]||t[0]||r[0]||[],n=[];return Object.keys(a).filter(function(e){return"_element"!==e}).forEach(function(e){var t,r=1;"object"!==typeof(t=Array.isArray(a)?a[parseInt(e)]:a[e])||Array.isArray(t)||(r=(null===t||void 0===t?void 0:t.colSpan)||1);for(var s=0;s<r;s++){var i={dataKey:Array.isArray(a)?n.length:e+(s>0?"_".concat(s):"")};n.push(i)}}),n}(a,n,s);return{columns:o,head:a,body:n,foot:s}}(r,i,s);return{id:t.tableId,content:d,hooks:o,styles:l,settings:c}}var o_,c_=function(e,t,r){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=r,this.doc=e.getDocument()},d_=function(e){function t(t,r,a,n,s,i){var l=e.call(this,t,r,i)||this;return l.cell=a,l.row=n,l.column=s,l.section=n.section,l}return KC(t,e),t}(c_),u_=function(){function e(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},e.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(e,t,r,a,n,s){for(var i=0,l=t;i<l.length;i++){var o=!1===(0,l[i])(new d_(e,this,r,a,n,s));if(r.text=Array.isArray(r.text)?r.text:[r.text],o)return!1}return!0},e.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var r=0,a=this.hooks.didDrawPage;r<a.length;r++){(0,a[r])(new c_(e,this,t))}},e.prototype.callWillDrawPageHooks=function(e,t){for(var r=0,a=this.hooks.willDrawPage;r<a.length;r++){(0,a[r])(new c_(e,this,t))}},e.prototype.getWidth=function(e){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(e,t){return e+t.wrappedWidth},0);var t=this.settings.margin;return e-t.left-t.right},e}(),h_=function(){function e(e,t,r,a,n){void 0===n&&(n=!1),this.height=0,this.raw=e,e instanceof YC&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=r,this.cells=a,this.spansMultiplePages=n}return e.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(e,r){var a;return Math.max(e,(null===(a=t.cells[r.index])||void 0===a?void 0:a.height)||0)},0)},e.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(e){var r=t.cells[e.index];return!!r&&r.rowSpan>1}).length>0},e.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},e.prototype.getMinimumRowHeight=function(e,t){var r=this;return e.reduce(function(e,a){var n=r.cells[a.index];if(!n)return 0;var s=t.getLineHeight(n.styles.fontSize),i=n.padding("vertical")+s;return i>e?i:e},0)},e}(),f_=function(){function e(e,t,r){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=r,this.raw=e;var n=e;null==e||"object"!==typeof e||Array.isArray(e)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,n=null!==(a=e.content)&&void 0!==a?a:e,e._element&&(this.raw=e._element));var s=null!=n?""+n:"";this.text=s.split(/\r\n|\r|\n/g)}return e.prototype.getTextPos=function(){var e,t;if("top"===this.styles.valign)e=this.y+this.padding("top");else if("bottom"===this.styles.valign)e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}if("right"===this.styles.halign)t=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var a=this.width-this.padding("horizontal");t=this.x+a/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},e.prototype.getContentHeight=function(e,t){void 0===t&&(t=1.15);var r=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/e*t)+this.padding("vertical");return Math.max(r,this.styles.minCellHeight)},e.prototype.padding=function(e){var t=QC(this.styles.cellPadding,0);return"vertical"===e?t.top+t.bottom:"horizontal"===e?t.left+t.right:t[e]},e}(),m_=function(){function e(e,t,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=r}return e.prototype.getMaxCustomCellWidth=function(e){for(var t=0,r=0,a=e.allRows();r<a.length;r++){var n=a[r].cells[this.index];n&&"number"===typeof n.styles.cellWidth&&(t=Math.max(t,n.styles.cellWidth))}return t},e}();function p_(e,t){!function(e,t){var r=e.scaleFactor(),a=t.settings.horizontalPageBreak,n=ZC(e,t);t.allRows().forEach(function(s){for(var i=0,l=t.columns;i<l.length;i++){var o=l[i],c=s.cells[o.index];if(c){var d=t.hooks.didParseCell;t.callCellHooks(e,d,c,s,o,null);var u=c.padding("horizontal");c.contentWidth=XC(c.text,c.styles,e)+u;var h=XC(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,e);if(c.minReadableWidth=h+c.padding("horizontal"),"number"===typeof c.styles.cellWidth)c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if("wrap"===c.styles.cellWidth||!0===a)c.contentWidth>n?(c.minWidth=n,c.wrappedWidth=n):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var f=10/r;c.minWidth=c.styles.minCellWidth||f,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(e){for(var r=0,a=t.columns;r<a.length;r++){var n=a[r],s=e.cells[n.index];if(s&&1===s.colSpan)n.wrappedWidth=Math.max(n.wrappedWidth,s.wrappedWidth),n.minWidth=Math.max(n.minWidth,s.minWidth),n.minReadableWidth=Math.max(n.minReadableWidth,s.minReadableWidth);else{var i=t.styles.columnStyles[n.dataKey]||t.styles.columnStyles[n.index]||{},l=i.cellWidth||i.minCellWidth;l&&"number"===typeof l&&(n.minWidth=l,n.wrappedWidth=l)}s&&(s.colSpan>1&&!n.minWidth&&(n.minWidth=s.minWidth),s.colSpan>1&&!n.wrappedWidth&&(n.wrappedWidth=s.minWidth))}})}(e,t);var r=[],a=0;t.columns.forEach(function(e){var n=e.getMaxCustomCellWidth(t);n?e.width=n:(e.width=e.wrappedWidth,r.push(e)),a+=e.width});var n=t.getWidth(e.pageSize().width)-a;n&&(n=g_(r,n,function(e){return Math.max(e.minReadableWidth,e.minWidth)})),n&&(n=g_(r,n,function(e){return e.minWidth})),n=Math.abs(n),!t.settings.horizontalPageBreak&&n>.1/e.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),function(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var a=t[r],n=null,s=0,i=0,l=0;l<e.columns.length;l++){var o=e.columns[l];if((i-=1)>1&&e.columns[l+1])s+=o.width,delete a.cells[o.index];else if(n){var c=n;delete a.cells[o.index],n=null,c.width=o.width+s}else{if(!(c=a.cells[o.index]))continue;if(i=c.colSpan,s=0,c.colSpan>1){n=c,s+=o.width;continue}c.width=o.width+s}}}(t),function(e,t){for(var r={count:0,height:0},a=0,n=e.allRows();a<n.length;a++){for(var s=n[a],i=0,l=e.columns;i<l.length;i++){var o=l[i],c=s.cells[o.index];if(c){t.applyStyles(c.styles,!0);var d=c.width-c.padding("horizontal");if("linebreak"===c.styles.overflow)c.text=t.splitTextToSize(c.text,d+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if("ellipsize"===c.styles.overflow)c.text=x_(c.text,d,c.styles,t,"...");else if("hidden"===c.styles.overflow)c.text=x_(c.text,d,c.styles,t,"");else if("function"===typeof c.styles.overflow){var u=c.styles.overflow(c.text,d);c.text="string"===typeof u?[u]:u}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=c.contentHeight/c.rowSpan;c.rowSpan>1&&r.count*r.height<h*c.rowSpan?r={height:h,count:c.rowSpan}:r&&r.count>0&&r.height>h&&(h=r.height),h>s.height&&(s.height=h)}}r.count--}}(t,e),function(e){for(var t={},r=1,a=e.allRows(),n=0;n<a.length;n++)for(var s=a[n],i=0,l=e.columns;i<l.length;i++){var o=l[i],c=t[o.index];if(r>1)r--,delete s.cells[o.index];else if(c)c.cell.height+=s.height,r=c.cell.colSpan,delete s.cells[o.index],c.left--,c.left<=1&&delete t[o.index];else{var d=s.cells[o.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var u=a.length-n,h=d.rowSpan>u?u:d.rowSpan;t[o.index]={cell:d,left:h,row:s}}}}}(t)}function g_(e,t,r){for(var a=t,n=e.reduce(function(e,t){return e+t.wrappedWidth},0),s=0;s<e.length;s++){var i=e[s],l=a*(i.wrappedWidth/n),o=i.width+l,c=r(i),d=o<c?c:o;t-=d-i.width,i.width=d}if(t=Math.round(1e10*t)/1e10){var u=e.filter(function(e){return!(t<0)||e.width>r(e)});u.length&&(t=g_(u,t,r))}return t}function x_(e,t,r,a,n){return e.map(function(e){return function(e,t,r,a,n){var s=1e4*a.scaleFactor();if(t=Math.ceil(t*s)/s,t>=XC(e,r,a))return e;for(;t<XC(e+n,r,a)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+n}(e,t,r,a,n)})}function b_(e,t){var r=new VC(e),a=function(e,t){var r=e.content,a=function(e){return e.map(function(e,t){var r,a;return a="object"===typeof e&&null!==(r=e.dataKey)&&void 0!==r?r:t,new m_(a,e,t)})}(r.columns);if(0===r.head.length){(n=y_(a,"head"))&&r.head.push(n)}if(0===r.foot.length){var n;(n=y_(a,"foot"))&&r.foot.push(n)}var s=e.settings.theme,i=e.styles;return{columns:a,head:v_("head",r.head,a,i,s,t),body:v_("body",r.body,a,i,s,t),foot:v_("foot",r.foot,a,i,s,t)}}(t,r.scaleFactor()),n=new u_(t,a);return p_(r,n),r.applyStyles(r.userStyles),n}function v_(e,t,r,a,n,s){var i={};return t.map(function(t,l){for(var o=0,c={},d=0,u=0,h=0,f=r;h<f.length;h++){var m=f[h];if(null==i[m.index]||0===i[m.index].left)if(0===u){var p=void 0,g={};"object"!==typeof(p=Array.isArray(t)?t[m.index-d-o]:t[m.dataKey])||Array.isArray(p)||(g=(null===p||void 0===p?void 0:p.styles)||{});var x=w_(e,m,l,n,a,s,g),b=new f_(p,x,e);c[m.dataKey]=b,c[m.index]=b,u=b.colSpan-1,i[m.index]={left:b.rowSpan-1,times:u}}else u--,d++;else i[m.index].left--,u=i[m.index].times,o++}return new h_(t,l,e,c)})}function y_(e,t){var r={};return e.forEach(function(e){if(null!=e.raw){var a=function(e,t){if("head"===e){if("object"===typeof t)return t.header||null;if("string"===typeof t||"number"===typeof t)return t}else if("foot"===e&&"object"===typeof t)return t.footer;return null}(t,e.raw);null!=a&&(r[e.dataKey]=a)}}),Object.keys(r).length>0?r:null}function w_(e,t,r,a,n,s,i){var l,o={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[a];"head"===e?l=n.headStyles:"body"===e?l=n.bodyStyles:"foot"===e&&(l=n.footStyles);var c=i_({},o.table,o[e],n.styles,l),d=n.columnStyles[t.dataKey]||n.columnStyles[t.index]||{},u="body"===e?d:{},h="body"===e&&r%2===0?i_({},o.alternateRow,n.alternateRowStyles):{},f=function(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(s),m=i_({},f,c,h,u);return i_(m,i)}function N_(e,t,r){var a;void 0===r&&(r={});var n=ZC(e,t),s=new Map,i=[],l=[],o=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?o=t.settings.horizontalPageBreakRepeat:"string"!==typeof t.settings.horizontalPageBreakRepeat&&"number"!==typeof t.settings.horizontalPageBreakRepeat||(o=[t.settings.horizontalPageBreakRepeat]),o.forEach(function(e){var r=t.columns.find(function(t){return t.dataKey===e||t.index===e});r&&!s.has(r.index)&&(s.set(r.index,!0),i.push(r.index),l.push(t.columns[r.index]),n-=r.wrappedWidth)});for(var c=!0,d=null!==(a=null===r||void 0===r?void 0:r.start)&&void 0!==a?a:0;d<t.columns.length;)if(s.has(d))d++;else{var u=t.columns[d].wrappedWidth;if(!(c||n>=u))break;c=!1,i.push(d),l.push(t.columns[d]),n-=u,d++}return{colIndexes:i,columns:l,lastIndex:d-1}}function j_(e,t){var r=t.settings,a=r.startY,n=r.margin,s={x:n.left,y:a},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=a+n.bottom+i;"avoid"===r.pageBreak&&(l+=t.body.reduce(function(e,t){return e+t.height},0));var o=new VC(e);("always"===r.pageBreak||null!=r.startY&&l>o.pageSize().height)&&(O_(o),s.y=n.top),t.callWillDrawPageHooks(o,s);var c=i_({},s);t.startPageNumber=o.pageNumber(),r.horizontalPageBreak?function(e,t,r,a){var n=function(e,t){for(var r=[],a=0;a<t.columns.length;a++){var n=N_(e,t,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}(e,t),s=t.settings;if("afterAllRows"===s.horizontalPageBreakBehaviour)n.forEach(function(n,s){e.applyStyles(e.userStyles),s>0?P_(e,t,r,a,n.columns,!0):k_(e,t,a,n.columns),function(e,t,r,a,n){e.applyStyles(e.userStyles),t.body.forEach(function(s,i){var l=i===t.body.length-1;__(e,t,s,l,r,a,n)})}(e,t,r,a,n.columns),A_(e,t,a,n.columns)});else for(var i=-1,l=n[0],o=function(){var s=i;if(l){e.applyStyles(e.userStyles);var o=l.columns;i>=0?P_(e,t,r,a,o,!0):k_(e,t,a,o),s=S_(e,t,i+1,a,o),A_(e,t,a,o)}var c=s-i;n.slice(1).forEach(function(n){e.applyStyles(e.userStyles),P_(e,t,r,a,n.columns,!0),S_(e,t,i+1,a,n.columns,c),A_(e,t,a,n.columns)}),i=s};i<t.body.length-1;)o()}(o,t,c,s):(o.applyStyles(o.userStyles),"firstPage"!==r.showHead&&"everyPage"!==r.showHead||t.head.forEach(function(e){return T_(o,t,e,s,t.columns)}),o.applyStyles(o.userStyles),t.body.forEach(function(e,r){var a=r===t.body.length-1;__(o,t,e,a,c,s,t.columns)}),o.applyStyles(o.userStyles),"lastPage"!==r.showFoot&&"everyPage"!==r.showFoot||t.foot.forEach(function(e){return T_(o,t,e,s,t.columns)})),$C(o,t,c,s),t.callEndPageHooks(o,s),t.finalY=s.y,e.lastAutoTable=t,o.applyStyles(o.userStyles)}function k_(e,t,r,a){var n=t.settings;e.applyStyles(e.userStyles),"firstPage"!==n.showHead&&"everyPage"!==n.showHead||t.head.forEach(function(n){return T_(e,t,n,r,a)})}function S_(e,t,r,a,n,s){e.applyStyles(e.userStyles),s=null!==s&&void 0!==s?s:t.body.length;var i=Math.min(r+s,t.body.length),l=-1;return t.body.slice(r,i).forEach(function(s,i){var o=r+i===t.body.length-1,c=L_(e,t,o,a);s.canEntireRowFit(c,n)&&(T_(e,t,s,a,n),l=r+i)}),l}function A_(e,t,r,a){var n=t.settings;e.applyStyles(e.userStyles),"lastPage"!==n.showFoot&&"everyPage"!==n.showFoot||t.foot.forEach(function(n){return T_(e,t,n,r,a)})}function C_(e,t,r){var a=r.getLineHeight(e.styles.fontSize),n=e.padding("vertical"),s=Math.floor((t-n)/a);return Math.max(0,s)}function __(e,t,r,a,n,s,i){var l=L_(e,t,a,s);if(r.canEntireRowFit(l,i))T_(e,t,r,s,i);else if(function(e,t,r,a){var n=e.pageSize().height,s=a.settings.margin,i=n-(s.top+s.bottom);"body"===t.section&&(i-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var l=t.getMinimumRowHeight(a.columns,e),o=l<r;if(l>i)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var c=t.hasRowSpan(a.columns);return t.getMaxCellHeight(a.columns)>i?(c&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!c&&"avoid"!==a.settings.rowPageBreak}(e,r,l,t)){var o=function(e,t,r,a){var n={};e.spansMultiplePages=!0,e.height=0;for(var s=0,i=0,l=r.columns;i<l.length;i++){var o=l[i];if(g=e.cells[o.index]){Array.isArray(g.text)||(g.text=[g.text]),(p=i_(p=new f_(g.raw,g.styles,g.section),g)).text=[];var c=C_(g,t,a);g.text.length>c&&(p.text=g.text.splice(c,g.text.length));var d=a.scaleFactor(),u=a.getLineHeightFactor();g.contentHeight=g.getContentHeight(d,u),g.contentHeight>=t&&(g.contentHeight=t,p.styles.minCellHeight-=t),g.contentHeight>e.height&&(e.height=g.contentHeight),p.contentHeight=p.getContentHeight(d,u),p.contentHeight>s&&(s=p.contentHeight),n[o.index]=p}}var h=new h_(e.raw,-1,e.section,n,!0);h.height=s;for(var f=0,m=r.columns;f<m.length;f++){var p,g;o=m[f],(p=h.cells[o.index])&&(p.height=h.height),(g=e.cells[o.index])&&(g.height=e.height)}return h}(r,l,t,e);T_(e,t,r,s,i),P_(e,t,n,s,i),__(e,t,o,a,n,s,i)}else P_(e,t,n,s,i),__(e,t,r,a,n,s,i)}function T_(e,t,r,a,n){a.x=t.settings.margin.left;for(var s=0,i=n;s<i.length;s++){var l=i[s],o=r.cells[l.index];if(o)if(e.applyStyles(o.styles),o.x=a.x,o.y=a.y,!1!==t.callCellHooks(e,t.hooks.willDrawCell,o,r,l,a)){E_(e,o,a);var c=o.getTextPos();HC(o.text,c.x,c.y,{halign:o.styles.halign,valign:o.styles.valign,maxWidth:Math.ceil(o.width-o.padding("left")-o.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,o,r,l,a),a.x+=l.width}else a.x+=l.width;else a.x+=l.width}a.y+=r.height}function E_(e,t,r){var a=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),"number"===typeof a.lineWidth){var n=JC(a.lineWidth,a.fillColor);n&&e.rect(t.x,r.y,t.width,t.height,n)}else"object"===typeof a.lineWidth&&(a.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),function(e,t,r,a){var n,s,i,l;a.top&&(n=r.x,s=r.y,i=r.x+t.width,l=r.y,a.right&&(i+=.5*a.right),a.left&&(n-=.5*a.left),o(a.top,n,s,i,l));a.bottom&&(n=r.x,s=r.y+t.height,i=r.x+t.width,l=r.y+t.height,a.right&&(i+=.5*a.right),a.left&&(n-=.5*a.left),o(a.bottom,n,s,i,l));a.left&&(n=r.x,s=r.y,i=r.x,l=r.y+t.height,a.top&&(s-=.5*a.top),a.bottom&&(l+=.5*a.bottom),o(a.left,n,s,i,l));a.right&&(n=r.x+t.width,s=r.y,i=r.x+t.width,l=r.y+t.height,a.top&&(s-=.5*a.top),a.bottom&&(l+=.5*a.bottom),o(a.right,n,s,i,l));function o(t,r,a,n,s){e.getDocument().setLineWidth(t),e.getDocument().line(r,a,n,s,"S")}}(e,t,r,a.lineWidth))}function L_(e,t,r,a){var n=t.settings.margin.bottom,s=t.settings.showFoot;return("everyPage"===s||"lastPage"===s&&r)&&(n+=t.getFootHeight(t.columns)),e.pageSize().height-a.y-n}function P_(e,t,r,a,n,s){void 0===n&&(n=[]),void 0===s&&(s=!1),e.applyStyles(e.userStyles),"everyPage"!==t.settings.showFoot||s||t.foot.forEach(function(r){return T_(e,t,r,a,n)}),t.callEndPageHooks(e,a);var i=t.settings.margin;$C(e,t,r,a),O_(e),t.pageNumber++,a.x=i.left,a.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,a),"everyPage"===t.settings.showHead&&(t.head.forEach(function(r){return T_(e,t,r,a,n)}),e.applyStyles(e.userStyles))}function O_(e){var t=e.pageNumber();return e.setPage(t+1),e.pageNumber()===t&&(e.addPage(),!0)}function F_(e,t){j_(e,b_(e,l_(e,t)))}try{if("undefined"!==typeof window&&window){var D_=window,I_=D_.jsPDF||(null===(o_=D_.jspdf)||void 0===o_?void 0:o_.jsPDF);I_&&function(e){e.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j_(this,b_(this,l_(this,e[0]))),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(e,t,r,a){HC(e,t,r,a,this)},e.API.autoTableSetDefaults=function(e){return VC.setDefaults(e,this),this},e.autoTableSetDefaults=function(e,t){VC.setDefaults(e,t)},e.API.autoTableHtmlToJson=function(e,t){var r;if(void 0===t&&(t=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=a_(new VC(this),e,window,t,!1),n=a.head,s=a.body,i=(null===(r=n[0])||void 0===r?void 0:r.map(function(e){return e.content}))||[];return{columns:i,rows:s,data:s}}}(I_)}}catch(gT){console.error("Could not apply autoTable plugin",gT)}function R_(e,t,r,a,n){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;const i=t.some(e=>e.carrier||e.unitType||e.amount),l=t.some(e=>e.chargeableWeight||e.weightBreaker||e.charge);if(a&&i&&!l)return function(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=[];Array.isArray(t)&&(t.length>0&&t[0].charges?t.forEach(e=>{e.charges&&(s=s.concat(e.charges))}):s=t);const i=s.filter(e=>e.carrier||e.unitType||e.amount);if(0===i.length)return r;r>230&&(e.addPage(),r=20),e.setFont("helvetica","bold"),e.setFontSize(9);const l=n?"Freight Charges - ".concat(n," (Segment ").concat(a,")"):"Freight Charges (Segment ".concat(a,")");e.text(l,15,r),r+=3;const o=new Set;i.forEach(e=>{e.unitType&&o.add(e.unitType)});const c=Array.from(o).sort((e,t)=>{const r=parseFloat(e.replace(/[^0-9.-]/g,"")),a=parseFloat(t.replace(/[^0-9.-]/g,""));return isNaN(r)||isNaN(a)?e.localeCompare(t):r-a});0===c.length&&c.push("-45","45","100","300","500","1000");const d={};i.forEach(e=>{const t=e.carrier||"";d[t]||(d[t]={carrier:t,currency:e.currency||"",minimum:e.minimum||"",unitTypes:{},surcharge:e.surcharge||"",transitTime:e.transitTime||"",frequency:e.frequency||"",routing:e.numberOfRouting||"",remarks:M_(e.remarks||"")});const r=e.unitType||"";r&&(d[t].unitTypes[r]=e.amount||"")});const u=Object.values(d).map(e=>{const t=[e.carrier,e.currency,e.minimum];return c.forEach(r=>{t.push(e.unitTypes[r]||"")}),t.push(e.surcharge),t.push(e.transitTime),t.push(e.frequency),t.push(e.routing),t.push(e.remarks),t}),h=["AIRLINE","CCY","M"];h.push(...c),h.push("SURCHARGES","T/T","FREQUENCY","ROUTING","REMARKS");const f=c.length,m=f>6?10:12,p={0:{cellWidth:15},1:{cellWidth:10},2:{cellWidth:10}};for(let g=0;g<f;g++)p[3+g]={cellWidth:m};return p[3+f]={cellWidth:16},p[4+f]={cellWidth:10},p[5+f]={cellWidth:13},p[6+f]={cellWidth:15},p[7+f]={cellWidth:28,overflow:"linebreak"},F_(e,{startY:r,head:[h],body:u,theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:6.5,fontStyle:"bold"},bodyStyles:{fontSize:6.5,overflow:"linebreak",cellPadding:1.5},columnStyles:p,margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}(e,t,r,n,s);if(i){const a=t.filter(e=>e.carrier||e.unitType||e.amount);if(0===a.length)return r;r>230&&(e.addPage(),r=20),e.setFont("helvetica","bold"),e.setFontSize(9);const i=s?"Freight Charges - ".concat(s," (Segment ").concat(n,")"):"Freight Charges (Segment ".concat(n,")");e.text(i,15,r);return F_(e,{startY:r+=3,head:[["Carrier","Unit Type","Units","Amount","Transit","Routing","Total","Remarks"]],body:a.map(e=>{const t=e.numberOfUnits||"",r=U_(e),a=e.currency||"",n=e.amount||"",s=a&&n?"".concat(a," ").concat(n):n,i=a?"".concat(a," ").concat(Math.round(r)):Math.round(r).toString(),l=[e.carrier||"",e.unitType||"",t,s,e.transitTime||"",e.numberOfRouting||""];return l.push(i),l.push(M_(e.remarks||"")),l}),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:7,fontStyle:"bold"},bodyStyles:{fontSize:6.5,overflow:"linebreak",cellPadding:1.5},columnStyles:{0:{cellWidth:16},1:{cellWidth:13},2:{cellWidth:8},3:{cellWidth:25},4:{cellWidth:12},5:{cellWidth:14},6:{cellWidth:24},7:{cellWidth:50,overflow:"linebreak",fontSize:6.5}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}if(l){const a=t.filter(e=>e.chargeableWeight||e.weightBreaker||e.charge);if(0===a.length)return r;r>230&&(e.addPage(),r=20),e.setFont("helvetica","bold"),e.setFontSize(9);const i=s?"Freight Charges - ".concat(s," (Segment ").concat(n,")"):"Freight Charges (Segment ".concat(n,")");e.text(i,15,r);return F_(e,{startY:r+=3,head:[["Chargeable Weight","Weight Breaker","Pricing Unit","Charge","Total","Remarks"]],body:a.map(e=>{const t=(parseFloat(e.chargeableWeight)||0)*(parseFloat(e.charge)||0),r=e.currency||"USD",a=e.charge||"",n=a?"".concat(r," ").concat(a):"",s="".concat(r," ").concat(Math.round(t));return[e.chargeableWeight||"",e.weightBreaker||"",e.pricingUnit||"",n,s,M_(e.remarks||"")]}),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:7,fontStyle:"bold"},bodyStyles:{fontSize:6.5,overflow:"linebreak",cellPadding:1.5},columnStyles:{0:{cellWidth:22},1:{cellWidth:22},2:{cellWidth:22},3:{cellWidth:28},4:{cellWidth:28},5:{cellWidth:48,overflow:"linebreak"}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}return r}const M_=e=>{if(!e||""===e.trim())return"";let t=e;return t=t.replace(/(\d{2}\.\s)/g,"\n$1"),t=t.replace(/^\n/,""),t.length>60&&(t=t.replace(/(\.\s)(?=\D)/g,"$1\n"),t=t.replace(/\n{3,}/g,"\n\n")),t.trim()},B_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"handling";if(!e||0===e.length)return[];const r=[];return e.forEach((e,a)=>{if(e.charges&&Array.isArray(e.charges))return void r.push(...e.charges);if("freight"===t&&(e.chargeableWeight||e.weightBreaker||e.charge))return void r.push(e);Object.keys(e.chargeNamePerLocation||{}).forEach(t=>{var a,n,s,i,l;const o=null===(a=e.chargeNamePerLocation)||void 0===a?void 0:a[t],c=null===(n=e.unitTypePerLocation)||void 0===n?void 0:n[t],d=null===(s=e.unitsPerLocation)||void 0===s?void 0:s[t],u=null===(i=e.amountPerLocation)||void 0===i?void 0:i[t],h=null===(l=e.currencyPerLocation)||void 0===l?void 0:l[t];(o||u)&&r.push({chargeName:o||"",unitType:c||"",numberOfUnits:d||"",amount:u||"",currency:h||"",total:0,remark:""})})}),r},U_=e=>{if(e.total&&parseFloat(e.total)>0)return parseFloat(e.total);return(parseFloat(e.numberOfUnits)||1)*(parseFloat(e.amount)||0)},z_=(e,t)=>{let r=15;return e.addImage(ya,"PNG",15,r,50,10),e.setFontSize(11),e.setFont("helvetica","bold"),e.text("Scanwell Logistics Colombo (Pvt) Ltd.",195,r+2,{align:"right"}),e.setFontSize(9),e.setFont("helvetica","normal"),e.text("67/1 Hudson Road Colombo 3 Sri Lanka.",195,r+7,{align:"right"}),e.text("Office #+94 11 2426600/4766400",195,r+12,{align:"right"}),r+=25,e.setFontSize(16),e.setFont("helvetica","bold"),e.text("QUOTATION",105,r,{align:"center"}),r+12},q_=(e,t,r)=>{var a,n,s;e.setFontSize(11),e.setFont("helvetica","bold"),e.text(t.quoteNumber||"N/A",15,r);const i="air"===t.freightCategory?"Air":"Sea",l=(null===(a=t.freightMode)||void 0===a?void 0:a.charAt(0).toUpperCase())+(null===(n=t.freightMode)||void 0===n?void 0:n.slice(1)),o=null===(s=t.freightType)||void 0===s?void 0:s.toUpperCase(),c="".concat(i," ").concat(l," ").concat(o);if(e.text(c,195,r,{align:"right"}),r+=5,e.setFontSize(9),e.setFont("helvetica","normal"),e.text("Credit Terms",195,r,{align:"right"}),t.rateValidity){r+=4;const a=new Date(t.rateValidity).toLocaleDateString("en-GB");e.text("Rate Validity: ".concat(a,", 05:30"),195,r,{align:"right"})}r+=10,e.setFontSize(9),e.setFont("helvetica","bold"),e.text("Customer",15,r),t.customerAddress&&""!==t.customerAddress.trim()&&e.text("Customer Address",130,r),e.setFont("helvetica","normal");const d=r+=4;e.text(t.customer||"N/A",15,r);let u=0;if(t.customerAddress&&""!==t.customerAddress.trim()){e.setFont("helvetica","normal");const r=e.splitTextToSize(t.customerAddress,70);r.forEach((t,r)=>{e.text(t,130,d+4*r)}),u=r.length}return r+=4*Math.max(1,u)+4,e.setFont("helvetica","bold"),e.text("Pickup Address",15,r),e.text("Delivery Address",130,r),e.setFont("helvetica","normal"),r+=4,e.text(t.pickupLocation||"N/A",15,r),e.text(t.deliveryLocation||"N/A",130,r),r+=8},H_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=new XS;let n=z_(a);n=q_(a,e,n);const s=e.equipment?JSON.parse(e.equipment):{},i=e.termsConditions?JSON.parse(e.termsConditions):[],l="air"===e.freightCategory;let o=[];if(e.carrierOptions)o=JSON.parse(e.carrierOptions);else{const t=e.carriers?JSON.parse(e.carriers):[],r=e.freightCharges?JSON.parse(e.freightCharges):[],a=e.destinationCharges?JSON.parse(e.destinationCharges):[],n=e.originHandling?JSON.parse(e.originHandling):[],s=e.destinationHandling?JSON.parse(e.destinationHandling):[];var c,d,u,h;if(t.length>0||r.length>0)o=[{carrier:(null===(c=t[0])||void 0===c?void 0:c.carrier)||"",incoterm:(null===(d=t[0])||void 0===d?void 0:d.incoterm)||"",currency:(null===(u=t[0])||void 0===u?void 0:u.currency)||"",cargoType:(null===(h=t[0])||void 0===h?void 0:h.cargoType)||"",freightCharges:r,destinationCharges:a,originHandling:n,destinationHandling:s}]}a.line(15,n,195,n),n+=5,a.setFont("helvetica","bold"),a.text("Port of Loading",15,n),a.text("Port of Discharge",130,n),a.setFont("helvetica","normal"),n+=4,a.text(e.portOfLoading||"N/A",15,n),a.text(e.portOfDischarge||"N/A",130,n),n+=8,a.setFont("helvetica","bold"),a.text("Equipment",15,n),a.text("Units",70,n),a.text("Gross Weight",95,n),a.text("Volume (m\xb3)",135,n),a.text("Chargeable Weight",165,n),n+=4,a.setFont("helvetica","normal"),a.text(s.equipment||"N/A",15,n),a.text(s.units||"0",70,n),a.text(s.grossWeight||"0",95,n),a.text(s.volume||"0",135,n),a.text(s.chargeableWeight||"0",165,n),n+=10,o.length>0&&o.forEach((e,t)=>{if(n>240&&(a.addPage(),n=20),o.length>1&&(a.setFillColor(230,230,230),a.rect(15,n-3,180,7,"F"),a.setFont("helvetica","bold"),a.setFontSize(10),a.text("".concat(l?"Airline":"Carrier"," Option [").concat(t+1,"]"),18,n+2),n+=10),e.carrier||e.incoterm||e.currency||e.cargoType){a.setFontSize(9),a.setFont("helvetica","bold"),n+=2,a.setFont("helvetica","normal");let t=[];e.carrier&&t.push("".concat(l?"Airline":"Carrier",": ").concat(e.carrier)),e.incoterm&&t.push("Incoterm: ".concat(e.incoterm)),e.currency&&t.push("Currency: ".concat(e.currency)),e.cargoType&&t.push("Cargo Type: ".concat(e.cargoType)),t.length>0&&(a.text(t.join("  |  "),15,n),n+=8)}n=function(e,t,r,a){if(a)return function(e,t,r){const a=t.filter(e=>e.carrier||e.unitType||e.amount);if(0===a.length)return r;r>230&&(e.addPage(),r=20);e.setFont("helvetica","bold"),e.setFontSize(9),e.text("Freight Charges",15,r),r+=3;const n=new Set;a.forEach(e=>{e.unitType&&n.add(e.unitType)});const s=Array.from(n).sort((e,t)=>{const r=parseFloat(e.replace(/[^0-9.-]/g,"")),a=parseFloat(t.replace(/[^0-9.-]/g,""));return isNaN(r)||isNaN(a)?e.localeCompare(t):r-a});0===s.length&&s.push("-45","45","100","300","500","1000");const i={};a.forEach(e=>{const t=e.carrier||"";i[t]||(i[t]={carrier:t,currency:e.currency||"",minimum:e.minimum||"",unitTypes:{},surcharge:e.surcharge||"",transitTime:e.transitTime||"",frequency:e.frequency||"",routing:e.numberOfRouting||"",remarks:M_(e.remarks||"")});const r=e.unitType||"";r&&(i[t].unitTypes[r]=e.amount||"")});const l=Object.values(i).map(e=>{const t=[e.carrier,e.currency,e.minimum];return s.forEach(r=>{t.push(e.unitTypes[r]||"")}),t.push(e.surcharge),t.push(e.transitTime),t.push(e.frequency),t.push(e.routing),t.push(e.remarks),t}),o=["AIRLINE","CCY","M"];o.push(...s),o.push("SURCHARGES","T/T","FREQUENCY","ROUTING","REMARKS");const c=s.length,d=c>6?10:12,u={0:{cellWidth:15},1:{cellWidth:10},2:{cellWidth:10}};for(let h=0;h<c;h++)u[3+h]={cellWidth:d};return u[3+c]={cellWidth:16},u[4+c]={cellWidth:10},u[5+c]={cellWidth:13},u[6+c]={cellWidth:15},u[7+c]={cellWidth:28,overflow:"linebreak"},F_(e,{startY:r,head:[o],body:l,theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:6.5,fontStyle:"bold"},bodyStyles:{fontSize:6.5,overflow:"linebreak",cellPadding:1.5},columnStyles:u,margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}(e,t,r);const n=t.filter(e=>e.carrier||e.unitType||e.amount);if(0===n.length)return r;r>230&&(e.addPage(),r=20);e.setFont("helvetica","bold"),e.setFontSize(9),e.text("Freight Charges",15,r),r+=3;const s=n.map(e=>{const t=e.numberOfUnits||"",r=U_(e),a=e.currency||"",n=e.amount||"",s=a&&n?"".concat(a," ").concat(n):n,i=a?"".concat(a," ").concat(Math.round(r)):Math.round(r).toString(),l=[e.carrier||"",e.unitType||"",t,s,e.transitTime||"",e.numberOfRouting||""];return l.push(i),l.push(M_(e.remarks||"")),l});return F_(e,{startY:r,head:[["Carrier","Unit Type","Units","Amount","Transit","Routing","Total","Remarks"]],body:s,theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:7,fontStyle:"bold"},bodyStyles:{fontSize:6.5,overflow:"linebreak",cellPadding:1.5},columnStyles:{0:{cellWidth:16},1:{cellWidth:13},2:{cellWidth:8},3:{cellWidth:25},4:{cellWidth:12},5:{cellWidth:14},6:{cellWidth:24},7:{cellWidth:50,overflow:"linebreak",fontSize:6.5}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}(a,e.freightCharges||[],n,l),n=W_(a,e.destinationCharges||[],"Destination Charges (POD)",n),n=W_(a,e.originHandling||[],"Origin Handling Charges",n),n=W_(a,e.destinationHandling||[],"Destination Handling Charges",n)}),i.length>0&&(n>240&&(a.addPage(),n=20),a.setFontSize(9),a.setFont("helvetica","bold"),a.text("Terms & Conditions:",15,n),n+=5,a.setFont("helvetica","normal"),a.setFontSize(8),i.forEach(e=>{a.splitTextToSize("- ".concat(e),170).forEach(e=>{n>280&&(a.addPage(),n=20),a.text(e,15,n),n+=4})})),n=280,a.setFontSize(8),a.setFont("helvetica","italic");const f=t?"".concat(t.firstName||""," ").concat(t.lastName||"").trim():"System",m=null!==t&&void 0!==t&&t.email?" (".concat(t.email,")"):"";if(a.text("Quotation generated by - ".concat(f).concat(m),15,n),a.text("This is a Computer generated Document and no Signature required.",15,n+4),r)return a;a.save("".concat(e.quoteNumber||"Quote",".pdf"))};function W_(e,t,r,a){const n=t.filter(e=>e.chargeName||e.amount);if(0===n.length)return a;a>230&&(e.addPage(),a=20),e.setFont("helvetica","bold"),e.setFontSize(9),e.text(r,15,a);return F_(e,{startY:a+=3,head:[["Charge Name","Unit Type","Units","Amount","Total","Remark"]],body:n.map(e=>{const t=e.numberOfUnits||("SHIPMENT"===e.unitType?"1":""),r=U_(e),a=e.currency||"",n=e.amount||"",s=a&&n?"".concat(a," ").concat(n):n,i=a?"".concat(a," ").concat(Math.round(r)):Math.round(r).toString();return[e.chargeName||"",e.unitType||"",t,s,i,M_(e.remark||"")]}),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:7,fontStyle:"bold"},bodyStyles:{fontSize:6.5,overflow:"linebreak",cellPadding:1.5},columnStyles:{0:{cellWidth:36},1:{cellWidth:22},2:{cellWidth:12},3:{cellWidth:28},4:{cellWidth:28},5:{cellWidth:44,overflow:"linebreak"}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}const V_=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=new XS;let s=z_(n);s=q_(n,e,s);const i=e.equipment?JSON.parse(e.equipment):{},l=e.termsConditions?JSON.parse(e.termsConditions):[];let o=[],c=[];const d=e.transitRoutes||e.routes;if(d){const e=JSON.parse(d);Array.isArray(e)&&e.length>0&&(o=e,c=e,e[0].routes&&(o=e[0].routes,c=e[0].routes))}if(n.line(15,s,195,s),s+=5,n.setFont("helvetica","bold"),n.setFontSize(9),n.text("Route Segments",15,s),s+=5,n.setFont("helvetica","normal"),o.length>0){var u;const e=o.map(e=>e.origin||"N/A").concat([(null===(u=o[o.length-1])||void 0===u?void 0:u.destination)||"N/A"]).join(" \u2192 ");n.splitTextToSize(e,170).forEach(e=>{n.text(e,15,s),s+=4})}s+=6;const h=i.equipment?i:(null===(t=c[0])||void 0===t?void 0:t.equipment)||{};n.setFont("helvetica","bold"),n.text("Equipment",15,s),n.text("Units",70,s),n.text("Gross Weight",95,s),n.text("Volume (m\xb3)",135,s),n.text("Chargeable Weight",165,s),s+=4,n.setFont("helvetica","normal"),n.text(h.equipment||i.equipment||"N/A",15,s),n.text(i.units||h.units||"0",70,s),n.text(h.grossWeight||i.grossWeight||"0",95,s),n.text(h.volume||i.volume||"0",135,s),n.text(h.chargeableWeight||i.chargeableWeight||"0",165,s),s+=10,c.forEach((e,t)=>{var r;s>240&&(n.addPage(),s=20),n.setFillColor(200,220,240),n.rect(15,s-3,180,7,"F"),n.setFont("helvetica","bold"),n.setFontSize(10);const a=(null===(r=e.mode)||void 0===r?void 0:r.toUpperCase())||"N/A",i="".concat(e.origin||"N/A"," \u2192 ").concat(e.destination||"N/A");if(n.text("Segment ".concat(t+1,": ").concat(a," (").concat(i,")"),18,s+2),s+=10,e.freightChargesTables&&Array.isArray(e.freightChargesTables)&&e.freightChargesTables.length>0){var l,o;if(e.freightChargesTables.length>1||(null===(l=e.freightChargesTables[0])||void 0===l?void 0:l.tableName)&&"Default"!==(null===(o=e.freightChargesTables[0])||void 0===o?void 0:o.tableName))e.freightChargesTables.forEach((r,a)=>{const i=r.charges||[];if(i.length>0){const l=r.tableName||"Table ".concat(a+1);s=R_(n,i,s,"air"===e.mode,t+1,l)}});else{const r=B_(e.freightChargesTables,"freight");r.length>0&&(s=R_(n,r,s,"air"===e.mode,t+1))}}else if(e.freightCharges){const r=e.freightCharges;r.length>0&&(s=R_(n,r,s,"air"===e.mode,t+1))}let c=[];e.originHandlingTables&&Array.isArray(e.originHandlingTables)?c=B_(e.originHandlingTables,"handling"):e.originHandling&&(c=e.originHandling),c.length>0&&(s=W_(n,c,"Seg".concat(t+1,": Origin Handling"),s));let d=[];e.destinationHandlingTables&&Array.isArray(e.destinationHandlingTables)?d=B_(e.destinationHandlingTables,"handling"):e.destinationHandling&&(d=e.destinationHandling),d.length>0&&(s=W_(n,d,"Seg".concat(t+1,": Destination Handling"),s));let u=[];e.destinationChargesTables&&Array.isArray(e.destinationChargesTables)?u=B_(e.destinationChargesTables,"handling"):e.destinationCharges&&(u=e.destinationCharges),u.length>0&&(s=W_(n,u,"Seg".concat(t+1,": Destination Charges (POD)"),s)),s+=5}),l.length>0&&(s+=10,s>250&&(n.addPage(),s=20),n.setFontSize(9),n.setFont("helvetica","bold"),n.text("Terms & Conditions:",15,s),s+=5,n.setFont("helvetica","normal"),n.setFontSize(8),l.forEach(e=>{n.splitTextToSize("- ".concat(e),170).forEach(e=>{s>280&&(n.addPage(),s=20),n.text(e,15,s),s+=4})}));n.setFontSize(8),n.setFont("helvetica","italic");const f=r?"".concat(r.firstName||""," ").concat(r.lastName||"").trim():"System",m=null!==r&&void 0!==r&&r.email?" (".concat(r.email,")"):"";if(n.text("Quotation generated by - ".concat(f).concat(m),15,280),n.text("This is a Computer generated Document and no Signature required.",15,284),a)return n;n.save("".concat(e.quoteNumber||"Transit-Quote",".pdf"))},G_=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=new XS;let s=z_(n);s=q_(n,e,s);const i=e.equipment?JSON.parse(e.equipment):{},l=e.termsConditions?JSON.parse(e.termsConditions):[];let o=[],c=[];const d=e.transitRoutes||e.routes;if(d){const e=JSON.parse(d);Array.isArray(e)&&e.length>0&&(o=e,c=e,e[0].routes&&(o=e[0].routes,c=e[0].routes))}if(n.line(15,s,195,s),s+=5,n.setFont("helvetica","bold"),n.setFontSize(9),n.text("Route Segments",15,s),s+=5,n.setFont("helvetica","normal"),o.length>0){const e=o.map((e,t)=>{var r;const a=(null===(r=e.mode)||void 0===r?void 0:r.toUpperCase())||"N/A",n="".concat(e.origin||"N/A"," \u2192 ").concat(e.destination||"N/A");return"Seg ".concat(t+1,": ").concat(a," (").concat(n,")")}).join("  |  ");n.splitTextToSize(e,170).forEach(e=>{n.text(e,15,s),s+=4})}s+=6;const u=i.equipment?i:(null===(t=c[0])||void 0===t?void 0:t.equipment)||{};n.setFont("helvetica","bold"),n.text("Equipment",15,s),n.text("Units",70,s),n.text("Gross Weight",95,s),n.text("Volume (m\xb3)",135,s),n.text("Chargeable Weight",165,s),s+=4,n.setFont("helvetica","normal"),n.text(u.equipment||i.equipment||"N/A",15,s),n.text(i.units||u.units||"0",70,s),n.text(u.grossWeight||i.grossWeight||"0",95,s),n.text(u.volume||i.volume||"0",135,s),n.text(u.chargeableWeight||i.chargeableWeight||"0",165,s),s+=10,c.forEach((e,t)=>{var r;s>240&&(n.addPage(),s=20),n.setFillColor(200,220,240),n.rect(15,s-3,180,7,"F"),n.setFont("helvetica","bold"),n.setFontSize(10);const a=(null===(r=e.mode)||void 0===r?void 0:r.toUpperCase())||"N/A",i="".concat(e.origin||"N/A"," \u2192 ").concat(e.destination||"N/A");if(n.text("Segment ".concat(t+1,": ").concat(a," (").concat(i,")"),18,s+2),s+=10,e.freightChargesTables&&Array.isArray(e.freightChargesTables)&&e.freightChargesTables.length>0){var l,o;if(e.freightChargesTables.length>1||(null===(l=e.freightChargesTables[0])||void 0===l?void 0:l.tableName)&&"Default"!==(null===(o=e.freightChargesTables[0])||void 0===o?void 0:o.tableName))e.freightChargesTables.forEach((r,a)=>{const i=r.charges||[];if(i.length>0){const l=r.tableName||"Table ".concat(a+1);s=R_(n,i,s,"air"===e.mode,t+1,l)}});else{const r=B_(e.freightChargesTables,"freight");r.length>0&&(s=R_(n,r,s,"air"===e.mode,t+1))}}else if(e.freightCharges){const r=e.freightCharges;r.length>0&&(s=R_(n,r,s,"air"===e.mode,t+1))}let c=[];e.originHandlingTables&&Array.isArray(e.originHandlingTables)?c=B_(e.originHandlingTables,"handling"):e.originHandling&&(c=e.originHandling),c.length>0&&(s=W_(n,c,"Seg".concat(t+1,": Origin Handling"),s));let d=[];e.destinationHandlingTables&&Array.isArray(e.destinationHandlingTables)?d=B_(e.destinationHandlingTables,"handling"):e.destinationHandling&&(d=e.destinationHandling),d.length>0&&(s=W_(n,d,"Seg".concat(t+1,": Destination Handling"),s));let u=[];e.destinationChargesTables&&Array.isArray(e.destinationChargesTables)?u=B_(e.destinationChargesTables,"handling"):e.destinationCharges&&(u=e.destinationCharges),u.length>0&&(s=W_(n,u,"Seg".concat(t+1,": Destination Charges (POD)"),s)),s+=5}),l.length>0&&(s+=10,s>250&&(n.addPage(),s=20),n.setFontSize(9),n.setFont("helvetica","bold"),n.text("Terms & Conditions:",15,s),s+=5,n.setFont("helvetica","normal"),n.setFontSize(8),l.forEach(e=>{n.splitTextToSize("- ".concat(e),170).forEach(e=>{s>280&&(n.addPage(),s=20),n.text(e,15,s),s+=4})}));n.setFontSize(8),n.setFont("helvetica","italic");const h=r?"".concat(r.firstName||""," ").concat(r.lastName||"").trim():"System",f=null!==r&&void 0!==r&&r.email?" (".concat(r.email,")"):"";if(n.text("Quotation generated by - ".concat(h).concat(f),15,280),n.text("This is a Computer generated Document and no Signature required.",15,284),a)return n;n.save("".concat(e.quoteNumber||"MultiModal-Quote",".pdf"))},K_=function(e){try{const t=e.output("blob"),r=URL.createObjectURL(t),a=document.createElement("iframe");a.style.position="fixed",a.style.right="0",a.style.bottom="0",a.style.width="0",a.style.height="0",a.style.border="none",document.body.appendChild(a),a.src=r,a.onload=function(){setTimeout(()=>{a.contentWindow.focus(),a.contentWindow.print(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(r)},1e3)},100)}}catch(gT){console.error("Error printing PDF:",gT),alert("Failed to print PDF. Please try downloading instead.")}},Y_=["quoteId"];function X_(e){let{category:t,mode:r}=e;const{user:a}=(0,s.useContext)(xa),n=ne(),[i]=ze(),l=i.get("id"),o="true"===i.get("edit"),c=l&&!o,[d,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a&&(console.log("Current user in header:",a),m(a.id))},[a]);const m=async e=>{try{const t=await Da(e);console.log("Fetched user data:",t),t&&t.length>0&&u(t[0])}catch(gT){console.error("Error fetching user details:",gT)}},[p,g]=(0,s.useState)({quoteNumber:"",createdDate:(new Date).toISOString().split("T")[0],rateValidity:"",customer:"",pickupLocation:"",deliveryLocation:"",portOfLoading:"",portOfDischarge:"",equipment:{equipment:"",units:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},carrierOptions:[{carrier:"",incoterm:"",currency:"",cargoType:"",freightCharges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0,remarks:""}],destinationCharges:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}],termsConditions:[]});(0,s.useEffect)(()=>{l?b():g(e=>We(We({},e),{},{quoteNumber:ny()}))},[l]);const x=e=>e?e.split("T")[0]:"",b=async()=>{try{f(!0);const e=await Dn(l);console.log("=== LOAD QUOTE DATA DEBUG ==="),console.log("Raw data from API:",e[0]);let t=[{carrier:"",incoterm:"",currency:"",cargoType:"",freightCharges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0,remarks:""}],destinationCharges:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}];const r=e[0].carrierOptions||e[0].CarrierOptions;if(r){console.log("carrierOptions exists, raw value:",r);try{const e=JSON.parse(r);console.log("Parsed carrierOptions:",e),Array.isArray(e)&&e.length>0?(console.log("Using new array format"),t=e):e&&"object"===typeof e&&!Array.isArray(e)&&(console.log("Converting from old object format"),t=Object.keys(e).map(t=>{const r=e[t];return{carrier:t,incoterm:r.incoterm||"",currency:r.currency||"",cargoType:r.cargoType||"",freightCharges:r.freightCharges||[{carrier:t,unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:r.destinationCharges||[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:r.originHandling||[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:r.destinationHandling||[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}}),console.log("Converted to array:",t))}catch(mT){console.error("Error parsing carrierOptions:",mT)}}else if(e[0].carriers||e[0].Carriers){console.log("Using very old format with separate fields");try{const r=e[0].carriers||e[0].Carriers,a=e[0].freightCharges||e[0].FreightCharges,n=e[0].destinationCharges||e[0].DestinationCharges,s=e[0].originHandling||e[0].OriginHandling,i=e[0].destinationHandling||e[0].DestinationHandling,l=r?JSON.parse(r):[],o=a?JSON.parse(a):[],c=n?JSON.parse(n):[],d=s?JSON.parse(s):[],u=i?JSON.parse(i):[];console.log("Old format carriers:",l),l.length>0&&(t=l.map((e,t)=>({carrier:e.carrier||"",incoterm:e.incoterm||"",currency:e.currency||"",cargoType:e.cargoType||"",freightCharges:o.length>0?o:[{carrier:e.carrier||"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:c.length>0?c:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:d.length>0?d:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:u.length>0?u:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]})),console.log("Converted old format to:",t))}catch(mT){console.error("Error converting old format:",mT)}}const a={quoteId:e[0].quoteId||e[0].QuoteId||"",quoteNumber:e[0].quoteNumber||e[0].QuoteNumber||"",createdDate:x(e[0].createdDate||e[0].CreatedDate),rateValidity:x(e[0].rateValidity||e[0].RateValidity),customer:e[0].customer||e[0].Customer||"",pickupLocation:e[0].pickupLocation||e[0].PickupLocation||"",deliveryLocation:e[0].deliveryLocation||e[0].DeliveryLocation||"",portOfLoading:e[0].portOfLoading||e[0].PortOfLoading||"",portOfDischarge:e[0].portOfDischarge||e[0].PortOfDischarge||"",equipment:e[0].equipment||e[0].Equipment?JSON.parse(e[0].equipment||e[0].Equipment):{equipment:"",units:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},carrierOptions:t,termsConditions:e[0].termsConditions||e[0].TermsConditions?JSON.parse(e[0].termsConditions||e[0].TermsConditions):[],createdAt:e[0].createdAt||e[0].CreatedAt||"",fullName:e[0].fullName||"",email:e[0].email||""};console.log("Final form data to set:",a),g(a)}catch(gT){console.error("Error loading quote:",gT),alert("Failed to load quote data")}finally{f(!1)}},v=async()=>{let e="";if(p.customer)try{e=await Fs(p.customer),console.log("Customer Address:",e)}catch(gT){console.error("Error fetching customer address:",gT)}return{quoteNumber:p.quoteNumber,freightCategory:t,freightMode:r,freightType:"direct",createdDate:p.createdDate,rateValidity:p.rateValidity,customer:p.customer,customerAddress:e,pickupLocation:p.pickupLocation,deliveryLocation:p.deliveryLocation,portOfLoading:p.portOfLoading,portOfDischarge:p.portOfDischarge,equipment:JSON.stringify(p.equipment),carrierOptions:JSON.stringify(p.carrierOptions),termsConditions:JSON.stringify(p.termsConditions)}},y=()=>{if(l&&p.fullName){const e=p.fullName.trim().split(" ");return{firstName:e[0]||"",lastName:e.slice(1).join(" ")||"",email:p.email||""}}return d?{firstName:d.fname||"",lastName:d.lname||"",email:d.email||""}:null},w=c;return h?(0,ga.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,ga.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):(0,ga.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),!p.customer||""===p.customer.trim())return void alert("Customer is required. Please enter a customer name.");const a={quoteId:p.quoteId,quoteNumber:p.quoteNumber,freightCategory:t,freightMode:r,freightType:"direct",createdDate:p.createdDate,rateValidity:p.rateValidity,customer:p.customer,pickupLocation:p.pickupLocation,deliveryLocation:p.deliveryLocation,portOfLoading:p.portOfLoading,portOfDischarge:p.portOfDischarge,equipment:JSON.stringify(p.equipment),carrierOptions:JSON.stringify(p.carrierOptions),termsConditions:JSON.stringify(p.termsConditions),status:"draft",createdBy:d.emp_id,createdAt:l&&p.createdAt||(new Date).toISOString()};try{if(l)console.log("Update payload:",a),await Rn(a),alert("Quote updated successfully!");else{const{quoteId:e}=a,t=Na(a,Y_);await In(t),alert("Quote created successfully!")}n(-1)}catch(gT){console.error("Error saving quote:",gT),alert("Failed to save quote")}},className:"space-y-6",children:(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[null===t||void 0===t?void 0:t.toUpperCase()," - ",null===r||void 0===r?void 0:r.toUpperCase()," (Direct)"]}),c&&(0,ga.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"View Mode"}),o&&(0,ga.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Edit Mode"})]}),(0,ga.jsxs)("div",{className:"flex gap-2",children:[l&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("button",{type:"button",onClick:async()=>{const e=await v(),t=y();H_(e,t)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,ga.jsx)(Cv,{size:18}),"Download PDF"]}),(0,ga.jsxs)("button",{type:"button",onClick:async()=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const r=H_(e,t,!0);K_(r,"Quote_".concat(e.quoteNumber,"_Direct.pdf"))}catch(gT){console.error("Error printing direct quote PDF:",gT),alert("Failed to print PDF")}}(await v(),y())},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,ga.jsx)(_v,{size:18}),"Print"]})]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>n(-1),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[(0,ga.jsx)(Tv,{size:18}),"Back"]})]})]}),(0,ga.jsx)(Xv,{formData:p,setFormData:g,disabled:w}),(0,ga.jsx)($v,{formData:p,setFormData:g,disabled:w}),(0,ga.jsx)(Jv,{formData:p,setFormData:g,category:t,disabled:w}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"air"===t?"Airline Options":"Sea Options"}),!w&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{w||g(e=>We(We({},e),{},{carrierOptions:[...e.carrierOptions,{carrier:"",incoterm:"",currency:"",cargoType:"",freightCharges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0,remarks:""}],destinationCharges:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}]}))},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md transition-all hover:shadow-lg",children:[(0,ga.jsx)(dn,{size:18}),"Add Option"]})]}),p.carrierOptions.map((e,r)=>(0,ga.jsx)(ry,{option:e,index:r,category:t,formData:p,setFormData:g,onRemove:()=>(e=>{w||p.carrierOptions.length<=1||g(t=>We(We({},t),{},{carrierOptions:t.carrierOptions.filter((t,r)=>r!==e)}))})(r),disabled:w,totalOptions:p.carrierOptions.length},r))]}),(0,ga.jsx)(ay,{formData:p,setFormData:g,disabled:w}),!w&&(0,ga.jsx)("div",{className:"flex justify-end mt-6",children:(0,ga.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,ga.jsx)(Yn,{size:18}),l?"Update Quote":"Save Quote"]})})]})})}function $_(e){let{routeOption:t,routeIdx:r,formData:a,setFormData:n,category:s,disabled:i=!1}=e;const l=(e=>"air"===e?Pv:"sea"===e?Ov:[...Pv,...Ov])(s),o=Gv(s),c=(e,t)=>{if(i)return;const s=[...a.routeOptions];s[r][e]=t,n(e=>We(We({},e),{},{routeOptions:s}))},d=(e,t,s)=>{if(i)return;const l=[...a.routeOptions];l[r].carriers[e][t]=s,n(e=>We(We({},e),{},{routeOptions:l}))};return(0,ga.jsxs)("div",{className:"space-y-6 mb-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Route Configuration"}),(0,ga.jsx)("div",{className:"bg-white rounded-lg p-4 border-2 border-blue-200 mb-4",children:(0,ga.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,ga.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ga.jsx)("span",{className:"text-xs text-gray-500 mb-1",children:"Origin"}),(0,ga.jsx)("div",{className:"px-4 py-2 bg-green-100 border-2 border-green-500 rounded-lg font-medium text-sm min-w-[120px] text-center",children:t.origin||"Not set"})]}),(0,ga.jsx)(_n,{className:"text-blue-500",size:20}),t.transits.map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ga.jsxs)("span",{className:"text-xs text-gray-500 mb-1",children:["Transit ",t+1]}),(0,ga.jsx)("div",{className:"px-4 py-2 bg-yellow-100 border-2 border-yellow-500 rounded-lg font-medium text-sm min-w-[120px] text-center",children:e||"Not set"})]}),(0,ga.jsx)(_n,{className:"text-blue-500",size:20})]},t)),(0,ga.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ga.jsx)("span",{className:"text-xs text-gray-500 mb-1",children:"Destination"}),(0,ga.jsx)("div",{className:"px-4 py-2 bg-red-100 border-2 border-red-500 rounded-lg font-medium text-sm min-w-[120px] text-center",children:t.destination||"Not set"})]})]})}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,ga.jsx)(Ev,{label:"Origin",value:t.origin,onChange:e=>c("origin",e),suggestions:l,disabled:i}),(0,ga.jsx)("div",{className:"flex items-end",children:!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(i)return;const e=[...a.routeOptions];e[r].transits.push(""),n(t=>We(We({},t),{},{routeOptions:e}))},className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700",children:[(0,ga.jsx)(dn,{size:18}),"Add Transit"]})}),(0,ga.jsx)(Ev,{label:"Destination",value:t.destination,onChange:e=>c("destination",e),suggestions:l,disabled:i})]}),t.transits.length>0&&(0,ga.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,ga.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Transit Stops"}),t.transits.map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ga.jsxs)("span",{className:"text-sm text-gray-600 min-w-[80px]",children:["Transit ",t+1,":"]}),(0,ga.jsx)("div",{className:"flex-1",children:(0,ga.jsx)(Ev,{value:e,onChange:e=>((e,t)=>{if(i)return;const s=[...a.routeOptions];s[r].transits[e]=t,n(e=>We(We({},e),{},{routeOptions:s}))})(t,e),suggestions:l,showLabel:!1,disabled:i})}),!i&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{if(i)return;const t=[...a.routeOptions];t[r].transits=t[r].transits.filter((t,r)=>r!==e),n(e=>We(We({},e),{},{routeOptions:t}))})(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,ga.jsx)(On,{size:18})})]},t))]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h4",{className:"text-md font-medium text-gray-700",children:"air"==s?"AirLine Options":"Carrier Options"}),!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(i)return;const e=[...a.routeOptions];e[r].carriers.push({carrier:"",incoterm:"",currency:"",cargoType:""}),n(t=>We(We({},t),{},{routeOptions:e}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"air"==s?"Add AirLine":"Add Carrier"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"air"==s?"AirLine":"Carrier"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Incoterm"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Cargo Type"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:t.carriers.map((e,s)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.carrier,onChange:e=>d(s,"carrier",e),suggestions:o,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.incoterm,onChange:e=>d(s,"incoterm",e),suggestions:Dv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>d(s,"currency",e),suggestions:Iv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.cargoType,onChange:e=>d(s,"cargoType",e),suggestions:Rv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.carriers.length>1&&!i&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{if(i)return;const t=[...a.routeOptions];t[r].carriers=t[r].carriers.filter((t,r)=>r!==e),n(e=>We(We({},e),{},{routeOptions:t}))})(s),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},s))})]})})]})]})}function J_(e){let{title:t,chargeData:r,routeOption:a,routeIdx:n,tableIdx:s,formData:i,setFormData:l,chargeType:o,showCarrier:c=!1,disabled:d=!1,category:u,onRemove:h=null}=e;const f=Gv(u),m="air"===u,p=e=>{if("origin"===e)return"Origin";if("destination"===e)return"Destination";if(e.startsWith("transit")){const t=e.replace("transit","");return"Transit ".concat(t)}return e},g=(e,t,r)=>{if(d)return;const a=[...i.routeOptions];a[n][o][s][e]||(a[n][o][s][e]={}),a[n][o][s][e][t]=r,l(e=>We(We({},e),{},{routeOptions:a}))},x=e=>{var t;return parseFloat((null===(t=r.amountPerLocation)||void 0===t?void 0:t[e])||0)},b=(()=>{const e=["origin"];return a.transits.forEach((t,r)=>{e.push("transit".concat(r+1))}),e.push("destination"),e})();return(0,ga.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:t}),h&&!d&&(0,ga.jsxs)("button",{type:"button",onClick:h,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,ga.jsx)(On,{size:16}),"Remove"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left w-48"}),b.map(e=>(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center font-semibold min-w-[150px]",children:p(e)},e))]})}),(0,ga.jsxs)("tbody",{children:[(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:c?"Carrier":"Charge Name"}),b.map(e=>{var t,a;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:c?(null===(t=r.carrierPerLocation)||void 0===t?void 0:t[e])||"":(null===(a=r.chargeNamePerLocation)||void 0===a?void 0:a[e])||"",onChange:t=>g(c?"carrierPerLocation":"chargeNamePerLocation",e,t),suggestions:c?f:Hv[o.replace("Tables","")]||Hv.handling,showLabel:!1,disabled:d})},e)})]}),(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Unit Type"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:(null===(t=r.unitTypePerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("unitTypePerLocation",e,t),suggestions:Bv,showLabel:!1,disabled:d})},e)})]}),(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Number of Units"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:(null===(t=r.unitsPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("unitsPerLocation",e,t.target.value),disabled:d,placeholder:"0",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Amount"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:(null===(t=r.amountPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("amountPerLocation",e,t.target.value),disabled:d,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Currency"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:(null===(t=r.currencyPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("currencyPerLocation",e,t),suggestions:Iv,showLabel:!1,disabled:d})},e)})]}),c&&(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Transit Time"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:(null===(t=r.transitTimePerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("transitTimePerLocation",e,t.target.value),disabled:d,placeholder:"e.g., 7-10 days",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),c&&(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Number of Routing"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:(null===(t=r.numberOfRoutingPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("numberOfRoutingPerLocation",e,t.target.value),disabled:d,placeholder:"e.g., Direct",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),c&&m&&(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Surcharge"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:(null===(t=r.surchargePerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("surchargePerLocation",e,t.target.value),disabled:d,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),c&&m&&(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Frequency"}),b.map(e=>{var t;return(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:(null===(t=r.frequencyPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("frequencyPerLocation",e,t.target.value),disabled:d,placeholder:"e.g., Daily",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),(0,ga.jsxs)("tr",{className:"bg-blue-50",children:[(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-100 font-bold",children:"Total"}),b.map(e=>(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:(x(e)||0).toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-blue-100 font-semibold text-center"})},e))]})]})]})}),(0,ga.jsx)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-3",children:(0,ga.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ga.jsxs)("span",{className:"font-semibold text-gray-700",children:["Total for ",t,":"]}),(0,ga.jsx)("span",{className:"text-2xl font-bold text-blue-900",children:(()=>{const e=r.amountPerLocation||{};return Object.values(e).reduce((e,t)=>e+(parseFloat(t)||0),0)})().toFixed(2)})]})})]})}function Q_(e){let{formData:t,setFormData:r,routeIdx:a,tableIdx:n,chargeData:i,tableName:l,disabled:o=!1,onRemove:c=null}=e;const d=["-45 Kg","+45 Kg","+100 kg","+300 kg","+500 kg","+1000 kg"],u=e=>{const t={};e.forEach(e=>{const r=e.carrier||"";t[r]||(t[r]={carrier:r,currency:e.currency||"",minimum:e.minimum||"",transitTime:e.transitTime||"",numberOfRouting:e.numberOfRouting||"",surcharge:e.surcharge||"",frequency:e.frequency||"",remarks:e.remarks||"",unitTypes:{}}),e.unitType&&(t[r].unitTypes[e.unitType]=e.amount||"")});const r=Object.values(t);return r.length>0?r:[{carrier:"",currency:"",minimum:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",remarks:"",unitTypes:{}}]},h=e=>{const t=[];return e.forEach(e=>{d.forEach(r=>{const a=e.unitTypes[r]||"";t.push({carrier:e.carrier,unitType:r,numberOfUnits:"",amount:a,currency:e.currency,minimum:e.minimum,transitTime:e.transitTime,numberOfRouting:e.numberOfRouting,surcharge:e.surcharge,frequency:e.frequency,total:0,remarks:e.remarks||""})})}),t},[f,m]=(0,s.useState)(()=>u(i.charges||[]));(0,s.useEffect)(()=>{const e=[...t.routeOptions];e[a].freightChargesTables[n].charges=h(f),r(t=>We(We({},t),{},{routeOptions:e}))},[f]),(0,s.useEffect)(()=>{const e=i.charges||[];if(e.length>0){JSON.stringify(h(f))!==JSON.stringify(e)&&m(u(e))}},[i.charges]);const p=(e,t,r)=>{o||m(a=>{const n=[...a];return n[e]=We(We({},n[e]),{},{[t]:r}),n})},g=Gv("air");return(0,ga.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsxs)("h3",{className:"text-lg font-medium text-gray-700",children:["Freight Charges (",l,")"]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[!o&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(o)return;const e={carrier:"",currency:"",minimum:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",remarks:"",unitTypes:{}};m(t=>[...t,e])},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Carrier"]}),c&&!o&&(0,ga.jsxs)("button",{type:"button",onClick:c,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,ga.jsx)(On,{size:16}),"Remove Table"]})]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"70px"},children:"AirLine"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"65px"},children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"60px"},children:"M"}),d.map(e=>(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"60px"},children:e},e)),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"90px"},children:"Surcharge"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"50px"},children:"T/T"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"85px"},children:"Frequency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"100px"},children:"Routing"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-left",style:{minWidth:"90px"},children:"Remarks"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-2 py-2 text-center",style:{width:"60px"},children:"Action"})]})}),(0,ga.jsx)("tbody",{children:f.map((e,t)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)(Ev,{value:e.carrier,onChange:e=>p(t,"carrier",e),suggestions:g,showLabel:!1,disabled:o})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>p(t,"currency",e),suggestions:Iv,showLabel:!1,disabled:o})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.minimum||"",onChange:e=>p(t,"minimum",e.target.value),disabled:o,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),d.map(r=>(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.unitTypes[r]||"",onChange:e=>((e,t,r)=>{o||m(a=>{const n=[...a];return n[e]=We(We({},n[e]),{},{unitTypes:We(We({},n[e].unitTypes),{},{[t]:r})}),n})})(t,r,e.target.value),disabled:o,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})},r)),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.surcharge||"",onChange:e=>p(t,"surcharge",e.target.value),disabled:o,placeholder:"e.g., ALL IN",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.transitTime||"",onChange:e=>p(t,"transitTime",e.target.value),disabled:o,placeholder:"e.g., 2",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.frequency||"",onChange:e=>p(t,"frequency",e.target.value),disabled:o,placeholder:"e.g., DAILY",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.numberOfRouting||"",onChange:e=>p(t,"numberOfRouting",e.target.value),disabled:o,placeholder:"e.g., CMB/KUL/KTI",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1",children:(0,ga.jsx)("input",{type:"text",value:e.remarks||"",onChange:e=>p(t,"remarks",e.target.value),disabled:o,placeholder:"Add remarks...",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100 text-sm"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-1 text-center",children:f.length>1&&!o&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{o||m(t=>t.filter((t,r)=>r!==e))})(t),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},t))})]})})]})}function Z_(e){let{formData:t,setFormData:r,routeIdx:a,tableIdx:n,chargeData:s,tableName:i,category:l,disabled:o=!1,onRemove:c=null}=e;if("air"===l)return(0,ga.jsx)(Q_,{formData:t,setFormData:r,routeIdx:a,tableIdx:n,chargeData:s,tableName:i,disabled:o,onRemove:c});const d=(e,s,i)=>{if(o)return;const l=[...t.routeOptions];if(l[a].freightChargesTables[n].charges[e][s]=i,"numberOfUnits"===s||"amount"===s){const t=l[a].freightChargesTables[n].charges[e],r=parseFloat(t.numberOfUnits)||0,s=parseFloat(t.amount)||0;t.total=r*s}r(e=>We(We({},e),{},{routeOptions:l}))},u=Gv(l),h=Yv(l),f="air"===l,m=s.charges||[];return(0,ga.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsxs)("h3",{className:"text-lg font-medium text-gray-700",children:["Freight Charges (",i,")"]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[!o&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(o)return;const e={carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",total:0,remarks:""};"air"===l&&(e.minimum="",e.surcharge="",e.frequency="");const s=[...t.routeOptions];s[a].freightChargesTables[n].charges.push(e),r(e=>We(We({},e),{},{routeOptions:s}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Charge"]}),c&&!o&&(0,ga.jsxs)("button",{type:"button",onClick:c,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,ga.jsx)(On,{size:16}),"Remove Table"]})]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"air"==l?"AirLine":"Carrier"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),f&&(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"M"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Transit Time"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Routing"}),f&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Surcharge"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Frequency"})]}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Remarks"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:m.map((e,s)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.carrier,onChange:e=>d(s,"carrier",e),suggestions:u,showLabel:!1,disabled:o})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.unitType,onChange:e=>d(s,"unitType",e),suggestions:h,showLabel:!1,disabled:o})}),f&&(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.minimum||"",onChange:e=>d(s,"minimum",e.target.value),disabled:o,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>d(s,"numberOfUnits",e.target.value),disabled:o,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>d(s,"amount",e.target.value),disabled:o,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>d(s,"currency",e),suggestions:Iv,showLabel:!1,disabled:o})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.transitTime||"",onChange:e=>d(s,"transitTime",e.target.value),disabled:o,placeholder:"e.g., 7-10 days",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.numberOfRouting||"",onChange:e=>d(s,"numberOfRouting",e.target.value),disabled:o,placeholder:"e.g., Direct",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),f&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.surcharge||"",onChange:e=>d(s,"surcharge",e.target.value),disabled:o,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.frequency||"",onChange:e=>d(s,"frequency",e.target.value),disabled:o,placeholder:"e.g., Daily",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})})]}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.remarks||"",onChange:e=>d(s,"remarks",e.target.value),disabled:o,placeholder:"Add remarks...",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:m.length>1&&!o&&(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{if(o)return;const s=[...t.routeOptions];s[a].freightChargesTables[n].charges=s[a].freightChargesTables[n].charges.filter((t,r)=>r!==e),r(e=>We(We({},e),{},{routeOptions:s}))})(s),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},s))}),(0,ga.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:f?"11":"8",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:(s.charges&&Array.isArray(s.charges)?s.charges.reduce((e,t)=>e+(parseFloat(t.total)||0),0):0).toFixed(2)}),(0,ga.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function eT(e){let{category:t,mode:r}=e;const{user:a}=(0,s.useContext)(xa),n=ne(),[i]=ze(),l=i.get("id"),o="true"===i.get("edit"),c=l&&!o,[d,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a&&(console.log("Current user in header:",a),m(a.id))},[a]);const m=async e=>{try{const t=await Da(e);console.log("Fetched user data:",t),t&&t.length>0&&u(t[0])}catch(gT){console.error("Error fetching user details:",gT)}},[p,g]=(0,s.useState)({quoteNumber:"",createdDate:(new Date).toISOString().split("T")[0],rateValidity:"",customer:"",pickupLocation:"",deliveryLocation:"",portOfLoading:"",portOfDischarge:"",routeOptions:[{routeName:"Option 1",origin:"",destination:"",transits:[],carriers:[{carrier:"",incoterm:"",currency:"",cargoType:""}],freightChargesTables:[{tableName:"Default",charges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0,remarks:""}]}],destinationChargesTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],originHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],destinationHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}]}],equipment:{equipment:"",units:"",grossWeight:"",volume:"",chargeableWeight:""},termsConditions:[]});(0,s.useEffect)(()=>{l?b():g(e=>We(We({},e),{},{quoteNumber:ny()}))},[l]);const x=e=>e?e.split("T")[0]:"",b=async()=>{try{f(!0);const e=await Dn(l);g({quoteNumber:e[0].quoteNumber||"",createdDate:x(e[0].createdDate)||"",rateValidity:x(e[0].rateValidity)||"",customer:e[0].customer||"",pickupLocation:e[0].pickupLocation||"",deliveryLocation:e[0].deliveryLocation||"",portOfLoading:e[0].portOfLoading||"",portOfDischarge:e[0].portOfDischarge||"",routeOptions:e[0].transitRoutes?JSON.parse(e[0].transitRoutes):p.routeOptions,equipment:e[0].equipment?JSON.parse(e[0].equipment):p.equipment,termsConditions:e[0].termsConditions?JSON.parse(e[0].termsConditions):[],fullName:e[0].fullName||"",email:e[0].email||""})}catch(gT){console.error("Error loading quote:",gT),alert("Failed to load quote data")}finally{f(!1)}},v=(e,t)=>{if(c)return;const r=[...p.routeOptions],a=r[e][t].length;let n;n="freightChargesTables"===t?{tableName:"Option ".concat(a),charges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0,remarks:""}]}:{tableName:"Option ".concat(a),chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}},r[e][t].push(n),g(e=>We(We({},e),{},{routeOptions:r}))},y=(e,t,r)=>{if(c||0===r)return;const a=[...p.routeOptions];a[e][t]=a[e][t].filter((e,t)=>t!==r),g(e=>We(We({},e),{},{routeOptions:a}))},w=async()=>{let e="";if(p.customer)try{e=await Fs(p.customer),console.log("Customer Address:",e)}catch(gT){console.error("Error fetching customer address:",gT)}return{quoteNumber:p.quoteNumber,freightCategory:t,freightMode:r,freightType:"transit",createdDate:p.createdDate,rateValidity:p.rateValidity,customer:p.customer,customerAddress:e,pickupLocation:p.pickupLocation,deliveryLocation:p.deliveryLocation,equipment:JSON.stringify(p.equipment),transitRoutes:JSON.stringify(p.routeOptions),termsConditions:JSON.stringify(p.termsConditions)}},N=()=>{if(l&&p.fullName){const e=p.fullName.trim().split(" ");return{firstName:e[0]||"",lastName:e.slice(1).join(" ")||"",email:p.email||""}}return d?{firstName:d.fname||"",lastName:d.lname||"",email:d.email||""}:null};return h?(0,ga.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,ga.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):(0,ga.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),!p.customer||""===p.customer.trim())return void alert("Customer is required. Please enter a customer name.");const a={quoteNumber:p.quoteNumber,freightCategory:t,freightMode:r,freightType:"transit",createdDate:p.createdDate,rateValidity:p.rateValidity,customer:p.customer,pickupLocation:p.pickupLocation,deliveryLocation:p.deliveryLocation,portOfLoading:p.portOfLoading,portOfDischarge:p.portOfDischarge,transitRoutes:JSON.stringify(p.routeOptions),equipment:JSON.stringify(p.equipment),termsConditions:JSON.stringify(p.termsConditions),status:"draft",createdBy:d.emp_id,createdAt:(new Date).toISOString()};l&&(a.quoteId=l);try{l?(await Rn(a),alert("Quote updated successfully!")):(await In(a),alert("Quote created successfully!")),n(-1)}catch(gT){console.error("Error saving quote:",gT),alert("Failed to save quote")}},className:"space-y-6",children:(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[null===t||void 0===t?void 0:t.toUpperCase()," - ",null===r||void 0===r?void 0:r.toUpperCase()," (Transit)"]}),c&&(0,ga.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"View Mode"}),o&&(0,ga.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Edit Mode"})]}),(0,ga.jsxs)("div",{className:"flex gap-2",children:[l&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("button",{type:"button",onClick:async()=>{const e=await w(),t=N();V_(e,t)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,ga.jsx)(Cv,{size:18}),"Download PDF"]}),(0,ga.jsxs)("button",{type:"button",onClick:async()=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const r=V_(e,t,!0);K_(r,"Quote_".concat(e.quoteNumber,"_Transit.pdf"))}catch(gT){console.error("Error printing transit quote PDF:",gT),alert("Failed to print PDF")}}(await w(),N())},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,ga.jsx)(_v,{size:18}),"Print"]})]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>n(-1),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[(0,ga.jsx)(Tv,{size:18}),"Back"]})]})]}),(0,ga.jsx)(Xv,{formData:p,setFormData:g,disabled:c}),(0,ga.jsxs)("div",{className:"mt-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Route Options"}),!c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{c||g(e=>We(We({},e),{},{routeOptions:[...e.routeOptions,{routeName:"Option ".concat(e.routeOptions.length+1),origin:"",destination:"",transits:[],carriers:[{carrier:"",incoterm:"",currency:"",cargoType:""}],freightChargesTables:[{tableName:"Default",charges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0,remarks:""}]}],destinationChargesTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],originHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],destinationHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}]}]}))},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,ga.jsx)(dn,{size:18}),"Add Option"]})]}),p.routeOptions.map((e,r)=>(0,ga.jsxs)("div",{className:"border-2 border-teal-200 rounded-lg p-6 mb-6 bg-gradient-to-br from-teal-50 to-blue-50",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("h4",{className:"text-lg font-semibold text-teal-900",children:e.routeName}),p.routeOptions.length>1&&!c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>(e=>{c||1===p.routeOptions.length||g(t=>We(We({},t),{},{routeOptions:t.routeOptions.filter((t,r)=>r!==e)}))})(r),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,ga.jsx)(On,{size:16}),"Remove Option"]})]}),(0,ga.jsx)($_,{routeOption:e,routeIdx:r,formData:p,setFormData:g,category:t,disabled:c}),(0,ga.jsx)(Jv,{formData:p,setFormData:g,category:t,disabled:c}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Freight Charges"}),!c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>v(r,"freightChargesTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Table"]})]}),e.freightChargesTables.map((e,a)=>(0,ga.jsx)("div",{className:"mb-4",children:(0,ga.jsx)(Z_,{formData:p,setFormData:g,routeIdx:r,tableIdx:a,chargeData:e,tableName:e.tableName,category:t,disabled:c,onRemove:a>0?()=>y(r,"freightChargesTables",a):null})},a))]}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Destination Charges (POD)"}),!c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>v(r,"destinationChargesTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Table"]})]}),e.destinationChargesTables.map((a,n)=>(0,ga.jsx)("div",{className:"mb-4",children:(0,ga.jsx)(J_,{title:"Destination Charges (".concat(a.tableName,")"),chargeData:a,routeOption:e,routeIdx:r,tableIdx:n,formData:p,setFormData:g,chargeType:"destinationChargesTables",showCarrier:!1,disabled:c,category:t,onRemove:n>0?()=>y(r,"destinationChargesTables",n):null})},n))]}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Origin Handling Charges"}),!c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>v(r,"originHandlingTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Table"]})]}),e.originHandlingTables.map((a,n)=>(0,ga.jsx)("div",{className:"mb-4",children:(0,ga.jsx)(J_,{title:"Origin Handling Charges (".concat(a.tableName,")"),chargeData:a,routeOption:e,routeIdx:r,tableIdx:n,formData:p,setFormData:g,chargeType:"originHandlingTables",showCarrier:!1,disabled:c,category:t,onRemove:n>0?()=>y(r,"originHandlingTables",n):null})},n))]}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Destination Handling Charges"}),!c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>v(r,"destinationHandlingTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Table"]})]}),e.destinationHandlingTables.map((a,n)=>(0,ga.jsx)("div",{className:"mb-4",children:(0,ga.jsx)(J_,{title:"Destination Handling Charges (".concat(a.tableName,")"),chargeData:a,routeOption:e,routeIdx:r,tableIdx:n,formData:p,setFormData:g,chargeType:"destinationHandlingTables",showCarrier:!1,disabled:c,category:t,onRemove:n>0?()=>y(r,"destinationHandlingTables",n):null})},n))]})]},r))]}),(0,ga.jsx)(ay,{formData:p,setFormData:g,disabled:c}),!c&&(0,ga.jsx)("div",{className:"flex justify-end mt-6",children:(0,ga.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,ga.jsx)(Yn,{size:18}),l?"Update Quote":"Save Quote"]})})]})})}const tT=["Per Kg","Per Lb","Per Container","Per CBM","Per Shipment","Flat Rate","Per Unit","Per Pallet"];function rT(e){let{title:t,chargeData:r,routeIdx:a,routeSegmentIdx:n,tableIdx:s,formData:i,setFormData:l,disabled:o=!1,onRemove:c=null}=e;const d=(e,t)=>{if(o)return;const r=[...i.routeOptions];r[a].routes[n].freightChargesTables[s][e]=t,l(e=>We(We({},e),{},{routeOptions:r}))},u=i.routeOptions[a].routes[n].mode,h="air"===(f=u)?qv.air:"sea"===f?qv.sea:"trucking"===f?qv.trucking:[...qv.air,...qv.sea,...qv.trucking];var f;return(0,ga.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:t}),c&&!o&&(0,ga.jsxs)("button",{type:"button",onClick:c,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,ga.jsx)(On,{size:16}),"Remove"]})]}),(0,ga.jsxs)("div",{className:"text-xs text-gray-600 mb-2",children:["Mode: ",(0,ga.jsx)("span",{className:"font-semibold capitalize",children:u})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chargeable Weight (Kg)"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:r.chargeableWeight||"",onChange:e=>d("chargeableWeight",e.target.value),disabled:o,placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100 focus:ring-2 focus:ring-purple-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight Breaker"}),(0,ga.jsx)(Ev,{value:r.weightBreaker||"",onChange:e=>d("weightBreaker",e),suggestions:h,showLabel:!1,disabled:o,placeholder:"Select ".concat(u," weight breaker")})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pricing Unit"}),(0,ga.jsx)(Ev,{value:r.pricingUnit||"",onChange:e=>d("pricingUnit",e),suggestions:tT,showLabel:!1,disabled:o,placeholder:"Select pricing unit"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Charge (Price)"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:r.charge||"",onChange:e=>d("charge",e.target.value),disabled:o,placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100 focus:ring-2 focus:ring-purple-500"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,ga.jsx)(Ev,{value:r.currency||"",onChange:e=>d("currency",e),suggestions:Iv,showLabel:!1,disabled:o,placeholder:"Select currency"})]})]}),(0,ga.jsxs)("div",{className:"bg-purple-50 border-2 border-purple-200 rounded-lg p-3",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ga.jsx)("span",{className:"font-semibold text-gray-700",children:"Total Freight Charge:"}),(0,ga.jsxs)("span",{className:"text-2xl font-bold text-purple-900",children:[((parseFloat(r.chargeableWeight)||0)*(parseFloat(r.charge)||0)).toFixed(2)," ",r.currency||""]})]}),(0,ga.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["(",r.chargeableWeight||"0"," \xd7 ",r.charge||"0"," ",r.pricingUnit||"",")"]})]})]})}function aT(e){let{route:t,routeIdx:r,routeSegmentIdx:a,formData:n,setFormData:s,disabled:i=!1,mode:l}=e;const o=(e,t)=>{if(i)return;const l=[...n.routeOptions];l[r].routes[a].equipment[e]=t,s(e=>We(We({},e),{},{routeOptions:l}))},c=e=>{if(i)return;const t=[...n.routeOptions],l="origin"===e?"originHandling":"destinationHandling";t[r].routes[a][l].push({chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}),s(e=>We(We({},e),{},{routeOptions:t}))},d=(e,t)=>{if(i)return;const l=[...n.routeOptions],o="origin"===e?"originHandling":"destinationHandling";l[r].routes[a][o]=l[r].routes[a][o].filter((e,r)=>r!==t),s(e=>We(We({},e),{},{routeOptions:l}))},u=(e,t,l,o)=>{if(i)return;const c=[...n.routeOptions],d="origin"===e?"originHandling":"destinationHandling";if(c[r].routes[a][d][t][l]=o,"numberOfUnits"===l||"amount"===l){const e=c[r].routes[a][d][t],n=parseFloat(e.numberOfUnits)||0,s=parseFloat(e.amount)||0;e.total=n*s}s(e=>We(We({},e),{},{routeOptions:c}))},h=e=>t["origin"===e?"originHandling":"destinationHandling"].reduce((e,t)=>e+(parseFloat(t.total)||0),0),f=Gv(t.mode),m=Kv(t.mode);return(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,ga.jsx)("h6",{className:"text-md font-semibold text-gray-700 mb-4",children:"Equipment Details"}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ga.jsx)(Ev,{label:"air"==l?"AirLine":"Carrier",value:t.equipment.carrier,onChange:e=>o("carrier",e),suggestions:f,disabled:i}),(0,ga.jsx)(Ev,{label:"Equipment",value:t.equipment.equipment,onChange:e=>o("equipment",e),suggestions:m,disabled:i}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transit Time (Days)"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.transitTime,onChange:e=>o("transitTime",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Net Weight (Kg)"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.netWeight,onChange:e=>o("netWeight",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gross Weight (Kg)"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.grossWeight,onChange:e=>o("grossWeight",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Volume (m\xb3)"}),(0,ga.jsx)("input",{type:"number",step:"0.01",value:t.equipment.volume,onChange:e=>o("volume",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chargeable Weight (Kg)"}),(0,ga.jsx)("input",{type:"number",value:t.equipment.chargeableWeight,onChange:e=>o("chargeableWeight",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h6",{className:"text-md font-semibold text-gray-700",children:"Freight Charges"}),!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(i)return;const e=[...n.routeOptions],t=e[r].routes[a].freightChargesTables.length;e[r].routes[a].freightChargesTables.push({tableName:"Option ".concat(t),chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}),s(t=>We(We({},t),{},{routeOptions:e}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Table"]})]}),t.freightChargesTables.map((e,t)=>(0,ga.jsx)("div",{className:"mb-4",children:(0,ga.jsx)(rT,{title:"Freight Charges (".concat(e.tableName,")"),chargeData:e,routeIdx:r,routeSegmentIdx:a,tableIdx:t,formData:n,setFormData:s,disabled:i,onRemove:t>0?()=>(e=>{if(i||0===e)return;const t=[...n.routeOptions];t[r].routes[a].freightChargesTables=t[r].routes[a].freightChargesTables.filter((t,r)=>r!==e),s(e=>We(We({},e),{},{routeOptions:t}))})(t):null})},t))]}),(0,ga.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h6",{className:"text-md font-semibold text-gray-700",children:"Origin Handling Charges"}),!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>c("origin"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Charge"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-100",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:t.originHandling.map((e,r)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.chargeName,onChange:e=>u("origin",r,"chargeName",e),suggestions:Hv.handling,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.unitType,onChange:e=>u("origin",r,"unitType",e),suggestions:Bv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>u("origin",r,"numberOfUnits",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>u("origin",r,"amount",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>u("origin",r,"currency",e),suggestions:Iv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.originHandling.length>1&&!i&&(0,ga.jsx)("button",{type:"button",onClick:()=>d("origin",r),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},r))}),(0,ga.jsx)("tfoot",{className:"bg-gray-100 font-semibold",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:"5",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:h("origin").toFixed(2)}),(0,ga.jsx)("td",{className:"border border-gray-300"})]})})]})})]}),(0,ga.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h6",{className:"text-md font-semibold text-gray-700",children:"Destination Handling Charges"}),!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>c("destination"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,ga.jsx)(dn,{size:16}),"Add Charge"]})]}),(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,ga.jsx)("thead",{className:"bg-gray-100",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,ga.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,ga.jsx)("tbody",{children:t.destinationHandling.map((e,r)=>(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.chargeName,onChange:e=>u("destination",r,"chargeName",e),suggestions:Hv.handling,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.unitType,onChange:e=>u("destination",r,"unitType",e),suggestions:Bv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>u("destination",r,"numberOfUnits",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>u("destination",r,"amount",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)(Ev,{value:e.currency,onChange:e=>u("destination",r,"currency",e),suggestions:Iv,showLabel:!1,disabled:i})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2",children:(0,ga.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,ga.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.destinationHandling.length>1&&!i&&(0,ga.jsx)("button",{type:"button",onClick:()=>d("destination",r),className:"text-red-600 hover:text-red-700",children:(0,ga.jsx)(On,{size:16})})})]},r))}),(0,ga.jsx)("tfoot",{className:"bg-gray-100 font-semibold",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:"5",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,ga.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:h("destination").toFixed(2)}),(0,ga.jsx)("td",{className:"border border-gray-300"})]})})]})})]})]})}function nT(e){let{routeOption:t,routeIdx:r,formData:a,setFormData:n,disabled:s=!1}=e;const i=(e,t,i)=>{if(s)return;const l=[...a.routeOptions];l[r].routes[e][t]=i,n(e=>We(We({},e),{},{routeOptions:l}))},l=e=>"air"===e?Pv:"sea"===e?Ov:["Los Angeles, CA","New York, NY","Chicago, IL","Houston, TX","Miami, FL","Atlanta, GA","Dallas, TX"],o=e=>"air"===e?"\u2708\ufe0f":"sea"===e?"\ud83d\udea2":"trucking"===e?"\ud83d\ude9b":"\ud83d\udce6",c=e=>"air"===e?{bg:"bg-blue-100",border:"border-blue-500",text:"text-blue-900",badgeBg:"bg-blue-200"}:"sea"===e?{bg:"bg-teal-100",border:"border-teal-500",text:"text-teal-900",badgeBg:"bg-teal-200"}:"trucking"===e?{bg:"bg-orange-100",border:"border-orange-500",text:"text-orange-900",badgeBg:"bg-orange-200"}:{bg:"bg-gray-100",border:"border-gray-500",text:"text-gray-900",badgeBg:"bg-gray-200"},d=e=>{const t=o(e.mode),r="air"===e.mode?"Air":"sea"===e.mode?"Sea":"Trucking",a=e.origin||"Origin",n=e.destination||"Destination";return"".concat(t," ").concat(r,": ").concat(a," \u2192 ").concat(n)};return(0,ga.jsxs)("div",{className:"space-y-6 mb-6",children:[(0,ga.jsxs)("div",{className:"bg-white rounded-lg p-6 border-2 border-purple-300 shadow-md",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("h4",{className:"text-lg font-semibold text-purple-900",children:"Create Route Segments"}),!s&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{if(s)return;const e=[...a.routeOptions];e[r].routes.push({mode:"air",origin:"",destination:"",equipment:{carrier:"",equipment:"",transitTime:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},freightChargesTables:[{tableName:"Default",chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}),n(t=>We(We({},t),{},{routeOptions:e}))},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 shadow-lg",children:[(0,ga.jsx)(dn,{size:18}),"Add Segment"]})]}),(0,ga.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Add your route segments here. Details for each segment will appear below."}),(0,ga.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border-2 border-purple-200 mb-6",children:(0,ga.jsx)("div",{className:"flex items-center gap-2 flex-wrap",children:t.routes.map((e,t)=>{const r=c(e.mode);return(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[t>0&&(0,ga.jsx)(_n,{className:"text-purple-500",size:24}),(0,ga.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ga.jsxs)("span",{className:"text-xs text-gray-500 mb-1 font-semibold",children:["Segment ",t+1]}),(0,ga.jsxs)("div",{className:"px-4 py-3 ".concat(r.bg," border-2 ").concat(r.border," rounded-lg font-semibold text-sm min-w-[140px] text-center shadow-sm"),children:[(0,ga.jsxs)("div",{className:"text-xs mb-1",children:[o(e.mode)," ","air"===e.mode?"Air":"sea"===e.mode?"Sea":"Trucking"]}),(0,ga.jsx)("div",{children:e.origin||"Origin"}),(0,ga.jsx)("div",{className:"text-xs text-gray-600",children:"\u2193"}),(0,ga.jsx)("div",{children:e.destination||"Dest"})]})]})]},t)})})}),(0,ga.jsx)("div",{className:"space-y-4",children:t.routes.map((e,o)=>{const d=c(e.mode);return(0,ga.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-300",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ga.jsx)("h5",{className:"font-semibold text-gray-800 flex items-center gap-2",children:(0,ga.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-bold ".concat(d.badgeBg," ").concat(d.text),children:["Segment ",o+1]})}),t.routes.length>1&&!s&&(0,ga.jsxs)("button",{type:"button",onClick:()=>(e=>{if(s||1===t.routes.length)return;const i=[...a.routeOptions];i[r].routes=i[r].routes.filter((t,r)=>r!==e),n(e=>We(We({},e),{},{routeOptions:i}))})(o),className:"flex items-center gap-1 px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[(0,ga.jsx)(On,{size:16}),"Remove"]})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode"}),(0,ga.jsxs)("select",{value:e.mode,onChange:e=>i(o,"mode",e.target.value),disabled:s,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100 focus:ring-2 focus:ring-purple-500",children:[(0,ga.jsx)("option",{value:"air",children:"\u2708\ufe0f Air"}),(0,ga.jsx)("option",{value:"sea",children:"\ud83d\udea2 Sea"}),(0,ga.jsx)("option",{value:"trucking",children:"\ud83d\ude9b Trucking"})]})]}),(0,ga.jsx)(Ev,{label:"Origin",value:e.origin,onChange:e=>i(o,"origin",e),suggestions:l(e.mode),disabled:s}),(0,ga.jsx)(Ev,{label:"Destination",value:e.destination,onChange:e=>i(o,"destination",e),suggestions:l(e.mode),disabled:s})]})]},o)})})]}),(0,ga.jsxs)("div",{className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,ga.jsx)("div",{className:"h-px bg-gradient-to-r from-purple-300 to-pink-300 flex-1"}),(0,ga.jsx)("h4",{className:"text-lg font-semibold text-purple-900 px-4",children:"Segment Details"}),(0,ga.jsx)("div",{className:"h-px bg-gradient-to-r from-pink-300 to-purple-300 flex-1"})]}),(0,ga.jsx)("p",{className:"text-sm text-gray-600 text-center mb-6",children:"Fill in the details for each segment below. Equipment, freight charges, and handling charges are specific to each segment."}),t.routes.map((e,t)=>{const i=c(e.mode);return(0,ga.jsxs)("div",{className:"bg-white rounded-lg p-6 border-2 border-gray-300 shadow-lg",id:"segment-detail-".concat(t),children:[(0,ga.jsx)("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-4 mb-6 border-2 border-purple-300",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ga.jsx)("span",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg ".concat("air"===e.mode?"bg-blue-600":"sea"===e.mode?"bg-teal-600":"bg-orange-600"),children:t+1}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h5",{className:"text-xl font-bold text-gray-800",children:["Segment ",t+1]}),(0,ga.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:d(e)})]})]}),(0,ga.jsxs)("div",{className:"px-4 py-2 rounded-lg font-semibold ".concat(i.badgeBg," ").concat(i.text),children:[o(e.mode)," ","air"===e.mode?"Air Freight":"sea"===e.mode?"Sea Freight":"Trucking"]})]})}),(0,ga.jsx)(aT,{route:e,routeIdx:r,routeSegmentIdx:t,formData:a,setFormData:n,disabled:s,mode:e.mode})]},t)})]})]})}function sT(){const{user:e}=(0,s.useContext)(xa),t=ne(),[r]=ze(),a=r.get("id"),n="true"===r.get("edit"),i=a&&!n,[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e&&(console.log("Current user in header:",e),u(e.id))},[e]);const u=async e=>{try{const t=await Da(e);console.log("Fetched user data:",t),t&&t.length>0&&o(t[0])}catch(gT){console.error("Error fetching user details:",gT)}},[h,f]=(0,s.useState)({quoteNumber:"",createdDate:(new Date).toISOString().split("T")[0],rateValidity:"",customer:"",pickupLocation:"",deliveryLocation:"",importExport:"import",routeOptions:[{routeName:"Option 1",routes:[{mode:"air",origin:"",destination:"",equipment:{carrier:"",equipment:"",transitTime:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},freightChargesTables:[{tableName:"Default",chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}]}],termsConditions:[]});(0,s.useEffect)(()=>{a?p():f(e=>We(We({},e),{},{quoteNumber:ny()}))},[a]);const m=e=>e?e.split("T")[0]:"",p=async()=>{try{d(!0);const e=await Dn(a);f({quoteNumber:e[0].quoteNumber||"",createdDate:m(e[0].createdDate)||"",rateValidity:m(e[0].rateValidity)||"",customer:e[0].customer||"",pickupLocation:e[0].pickupLocation||"",deliveryLocation:e[0].deliveryLocation||"",importExport:e[0].freightMode||"import",routeOptions:e[0].routes?JSON.parse(e[0].routes):h.routeOptions,termsConditions:e[0].termsConditions?JSON.parse(e[0].termsConditions):[],fullName:e[0].fullName||"",email:e[0].email||""})}catch(gT){console.error("Error loading quote:",gT),alert("Failed to load quote data")}finally{d(!1)}},g=()=>h.routeOptions.reduce((e,t)=>e+t.routes.reduce((e,t)=>e+(parseInt(t.equipment.transitTime)||0),0),0),x=async()=>{let e="";if(h.customer)try{e=await Fs(h.customer),console.log("Customer Address:",e)}catch(gT){console.error("Error fetching customer address:",gT)}return{quoteNumber:h.quoteNumber,freightMode:h.importExport,freightType:"multimodal",createdDate:h.createdDate,rateValidity:h.rateValidity,customer:h.customer,customerAddress:e,pickupLocation:h.pickupLocation,deliveryLocation:h.deliveryLocation,routes:JSON.stringify(h.routeOptions),termsConditions:JSON.stringify(h.termsConditions)}},b=()=>{if(a&&h.fullName){const e=h.fullName.trim().split(" ");return{firstName:e[0]||"",lastName:e.slice(1).join(" ")||"",email:h.email||""}}return l?{firstName:l.fname||"",lastName:l.lname||"",email:l.email||""}:null};return c?(0,ga.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,ga.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,ga.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),!h.customer||""===h.customer.trim())return void alert("Customer is required. Please enter a customer name.");const r={quoteNumber:h.quoteNumber,freightCategory:"multimodal",freightMode:h.importExport,freightType:"multimodal",createdDate:h.createdDate,rateValidity:h.rateValidity,customer:h.customer,pickupLocation:h.pickupLocation,deliveryLocation:h.deliveryLocation,routes:JSON.stringify(h.routeOptions),totalTransitTime:g(),termsConditions:JSON.stringify(h.termsConditions),status:"draft",createdBy:l.emp_id,createdAt:(new Date).toISOString()};a&&(r.quoteId=a);try{a?(await Rn(r),alert("Quote updated successfully!")):(await In(r),alert("Quote created successfully!")),t(-1)}catch(gT){console.error("Error saving quote:",gT),alert("Failed to save quote")}},className:"space-y-6",children:(0,ga.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Multi-Modal Freight Quote"}),(0,ga.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Quote Number: ",h.quoteNumber]}),i&&(0,ga.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"View Mode"}),n&&(0,ga.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Edit Mode"})]}),(0,ga.jsxs)("div",{className:"flex gap-2",children:[a&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("button",{type:"button",onClick:async()=>{const e=await x(),t=b();G_(e,t)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,ga.jsx)(Cv,{size:18}),"Download PDF"]}),(0,ga.jsxs)("button",{type:"button",onClick:async()=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const r=G_(e,t,!0);K_(r,"Quote_".concat(e.quoteNumber,"_MultiModal.pdf"))}catch(gT){console.error("Error printing multi-modal quote PDF:",gT),alert("Failed to print PDF")}}(await x(),b())},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,ga.jsx)(_v,{size:18}),"Print"]})]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>t(-1),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[(0,ga.jsx)(Tv,{size:18}),"Back"]})]})]}),(0,ga.jsxs)("div",{className:"mb-6",children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Import / Export"}),(0,ga.jsxs)("select",{value:h.importExport,onChange:e=>f(t=>We(We({},t),{},{importExport:e.target.value})),disabled:i,className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100",children:[(0,ga.jsx)("option",{value:"import",children:"Import"}),(0,ga.jsx)("option",{value:"export",children:"Export"})]})]}),(0,ga.jsx)(Xv,{formData:h,setFormData:f,disabled:i}),(0,ga.jsxs)("div",{className:"mt-6",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Route Options"}),!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{i||f(e=>We(We({},e),{},{routeOptions:[...e.routeOptions,{routeName:"Option ".concat(e.routeOptions.length+1),routes:[{mode:"air",origin:"",destination:"",equipment:{carrier:"",equipment:"",transitTime:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},freightChargesTables:[{tableName:"Default",chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}]}]}))},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,ga.jsx)(dn,{size:18}),"Add Option"]})]}),h.routeOptions.map((e,t)=>(0,ga.jsxs)("div",{className:"border-2 border-purple-200 rounded-lg p-6 mb-6 bg-gradient-to-br from-purple-50 to-pink-50",children:[(0,ga.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ga.jsx)("h4",{className:"text-lg font-semibold text-purple-900",children:e.routeName}),h.routeOptions.length>1&&!i&&(0,ga.jsxs)("button",{type:"button",onClick:()=>(e=>{i||1===h.routeOptions.length||f(t=>We(We({},t),{},{routeOptions:t.routeOptions.filter((t,r)=>r!==e)}))})(t),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,ga.jsx)(On,{size:16}),"Remove Option"]})]}),(0,ga.jsx)(nT,{routeOption:e,routeIdx:t,formData:h,setFormData:f,disabled:i})]},t))]}),(0,ga.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-200 rounded-lg p-4 mb-6",children:(0,ga.jsxs)("div",{className:"text-lg font-semibold text-blue-900",children:["Total Transit Time: ",g()," Days"]})}),(0,ga.jsx)(ay,{formData:h,setFormData:f,disabled:i}),!i&&(0,ga.jsx)("div",{className:"flex justify-end mt-6",children:(0,ga.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[(0,ga.jsx)(Yn,{size:18}),a?"Update Quote":"Save Quote"]})})]})})}function iT(e){let{disabled:t=!1}=e;const{user:r}=(0,s.useContext)(xa),a=ne(),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)([]),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)([]),[p,g]=(0,s.useState)(null);(0,s.useEffect)(()=>{r&&(console.log("Current user in header:",r),x(r.id))},[r]);const x=async e=>{try{const t=await Da(e);console.log("Fetched user data:",t),t&&t.length>0&&g(t[0])}catch(gT){console.error("Error fetching user details:",gT)}};(0,s.useEffect)(()=>{(async()=>{const e=await Rs();m(e)})()},[]);const[b,v]=(0,s.useState)({customerId:"",customerName:"",currency:"LKR",issuedDate:(new Date).toISOString().split("T")[0],validityDays:30,lineItems:[{id:Date.now(),category:"Storage",description:"Storage for CBM - PER DAY PER CBM",remarks:"",unitOfMeasurement:"",amount:""}],notes:["Rates are based on 2.5Ton Fork-lift. If any heavy equipment's are needed prices will be indicated at that time.","Working Hours will be 9.00 am to 5.00 pm on weekdays","Credit period: 15 days from the date of invoice.","Additional charges may apply for any special handling or value-added services requested.","Government Taxes will be applicable for warehouse rent (VAT & NBT)","Warehouse access and storage to be as per Scanwell Logistics policy","Customer must obtain All Risk Insurance cover for their goods.","Scanwell Logistics reserves the right to terminate or cancel the quotation at any time.","In the event of a price increase, Scanwell Logistics will inform the client in writing in advance.","General Terms and Conditions apply."]});(0,s.useEffect)(()=>{p&&p.emp_id&&v(e=>We(We({},e),{},{customerId:p.emp_id}))},[p]),(0,s.useEffect)(()=>{if(b.issuedDate&&b.validityDays){const e=new Date(b.issuedDate);e.setDate(e.getDate()+parseInt(b.validityDays)),v(t=>We(We({},t),{},{validityDate:e.toISOString().split("T")[0]}))}},[b.issuedDate,b.validityDays]),(0,s.useEffect)(()=>{y()},[]);const y=async()=>{try{const e=await fetch("/api/customers"),t=await e.json();o(t)}catch(gT){console.error("Error fetching customers:",gT)}},w=(l.filter(e=>{var t,r;return(null===(t=e.customerName)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||(null===(r=e.customerCode)||void 0===r?void 0:r.toLowerCase().includes(c.toLowerCase()))}),(e,t,r)=>{v(a=>We(We({},a),{},{lineItems:a.lineItems.map(a=>a.id===e?We(We({},a),{},{[t]:r}):a)}))}),N=["Storage","Warehouse Handling","Overtime Charges","Transport Charges","Picking & Packing","Insurance","Other"];return(0,ga.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,ga.jsx)("div",{className:"bg-gradient-to-r from-teal-50 to-emerald-50 rounded-xl p-6 mb-6 border border-teal-100",children:(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("div",{className:"w-14 h-14 rounded-xl bg-teal-600 flex items-center justify-center shadow-lg shadow-teal-200",children:(0,ga.jsx)(yn,{className:"w-8 h-8 text-white"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Warehouse Quotation"}),(0,ga.jsx)("p",{className:"text-slate-600 text-sm",children:"Create warehouse storage and handling quote"})]})]})}),(0,ga.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),b.customerName)if(b.lineItems.some(e=>!e.description||!e.amount))alert("Please fill in all line item descriptions and amounts");else{i(!0),console.log("this is form data: ",b);try{const e=await zn(b);alert("Warehouse quote created successfully! Quote ID: ".concat(e.quoteId||"N/A")),a(-1)}catch(gT){let t="Failed to save warehouse quote";if(gT.response){const r=gT.response.data;t=r.message||r.error||t}else t=gT.request?"Network error \u2013 please check your connection":gT.message||t;console.error("Error saving warehouse quote:",gT),alert("Error: ".concat(t))}finally{i(!1)}}else alert("Please select a customer")},className:"space-y-6",children:[(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,ga.jsxs)("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-5 h-5 text-teal-600"}),"Quote Information"]})}),(0,ga.jsxs)("div",{className:"p-6",children:[(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,ga.jsx)(Ev,{label:"Customer",value:b.customerName||"",onChange:e=>((e,t)=>{v(r=>We(We({},r),{},{[e]:t}))})("customerName",e),suggestions:f,disabled:t}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(Ln,{className:"w-4 h-4 text-teal-600"}),"Currency"]}),(0,ga.jsxs)("select",{value:b.currency,onChange:e=>v(t=>We(We({},t),{},{currency:e.target.value})),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors",children:[(0,ga.jsx)("option",{value:"LKR",children:"LKR - Sri Lankan Rupee"}),(0,ga.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,ga.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,ga.jsx)("option",{value:"GBP",children:"GBP - British Pound"})]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-teal-600"}),"Issued Date *"]}),(0,ga.jsx)("input",{type:"date",value:b.issuedDate,onChange:e=>v(t=>We(We({},t),{},{issuedDate:e.target.value})),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors",required:!0})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(nn,{className:"w-4 h-4 text-teal-600"}),"Validity (Days)"]}),(0,ga.jsx)("input",{type:"number",value:b.validityDays,onChange:e=>v(t=>We(We({},t),{},{validityDays:e.target.value})),min:"1",className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"})]})]}),b.validityDate&&(0,ga.jsx)("div",{className:"mt-4 p-4 bg-teal-50 rounded-lg border border-teal-100",children:(0,ga.jsxs)("p",{className:"text-sm text-teal-700",children:[(0,ga.jsx)("span",{className:"font-medium",children:"Valid Until:"})," ",new Date(b.validityDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})})]})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsxs)("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[(0,ga.jsxs)("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ka,{className:"w-5 h-5 text-teal-600"}),"Service Items"]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>{const e={id:Date.now(),category:"",description:"",remarks:"",unitOfMeasurement:"",amount:""};v(t=>We(We({},t),{},{lineItems:[...t.lineItems,e]}))},className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Item"]})]}),(0,ga.jsx)("div",{className:"p-6",children:(0,ga.jsx)("div",{className:"space-y-4",children:b.lineItems.map((e,t)=>(0,ga.jsxs)("div",{className:"p-5 border-2 border-slate-200 rounded-xl hover:border-teal-200 transition-colors",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,ga.jsxs)("span",{className:"px-3 py-1 bg-teal-100 text-teal-700 rounded-lg text-sm font-medium",children:["Item #",t+1]}),(0,ga.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void(1!==b.lineItems.length?v(e=>We(We({},e),{},{lineItems:e.lineItems.filter(e=>e.id!==t)})):alert("At least one line item is required"));var t},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",disabled:1===b.lineItems.length,children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),(0,ga.jsxs)("select",{value:e.category,onChange:t=>w(e.id,"category",t.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors text-sm",children:[(0,ga.jsx)("option",{value:"",children:"Select category"}),N.map(e=>(0,ga.jsx)("option",{value:e,children:e},e))]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Unit of Measurement"}),(0,ga.jsx)("input",{type:"text",value:e.unitOfMeasurement,onChange:t=>w(e.id,"unitOfMeasurement",t.target.value),placeholder:"e.g., Per CBM, Per Hour, Per Trip",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors text-sm"})]}),(0,ga.jsxs)("div",{className:"md:col-span-2",children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description *"}),(0,ga.jsx)("textarea",{value:e.description,onChange:t=>w(e.id,"description",t.target.value),placeholder:"Enter service description...",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors text-sm resize-none",required:!0})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Remarks"}),(0,ga.jsx)("textarea",{value:e.remarks,onChange:t=>w(e.id,"remarks",t.target.value),placeholder:"Additional remarks (optional)",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors text-sm resize-none"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Amount *"}),(0,ga.jsx)("input",{type:"number",value:e.amount,onChange:t=>w(e.id,"amount",t.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors text-sm",required:!0})]})]})]},e.id))})})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsxs)("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[(0,ga.jsxs)("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-5 h-5 text-teal-600"}),"Terms & Notes"]}),(0,ga.jsxs)("button",{type:"button",onClick:()=>{v(e=>We(We({},e),{},{notes:[...e.notes,""]}))},className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Note"]})]}),(0,ga.jsx)("div",{className:"p-6",children:(0,ga.jsx)("div",{className:"space-y-3",children:b.notes.map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)("span",{className:"text-teal-600 mt-2 font-medium",children:"@"}),(0,ga.jsx)("textarea",{value:e,onChange:e=>((e,t)=>{v(r=>We(We({},r),{},{notes:r.notes.map((r,a)=>a===e?t:r)}))})(t,e.target.value),placeholder:"Enter note...",rows:"2",className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors text-sm resize-none"}),(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{v(t=>We(We({},t),{},{notes:t.notes.filter((t,r)=>r!==e)}))})(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors mt-1",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]},t))})})]}),(0,ga.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,ga.jsx)("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors font-medium",children:"Cancel"}),(0,ga.jsxs)("button",{type:"submit",disabled:n,className:"px-8 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-medium shadow-lg shadow-teal-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,ga.jsx)(Yn,{className:"w-5 h-5"}),n?"Saving...":"Save Warehouse Quote"]})]})]})]})}function lT(){const[e]=ze(),t=e.get("category"),r=e.get("type"),a=e.get("mode");return(0,ga.jsx)("div",{className:"p-6",children:(console.log("this is catagory ",t),"direct"===r?(0,ga.jsx)(X_,{category:t,mode:a}):"transit"===r?(0,ga.jsx)(eT,{category:t,mode:a}):"multimodal"===r?(0,ga.jsx)(sT,{}):"warehouse"===r?(0,ga.jsx)(iT,{}):(0,ga.jsx)("div",{className:"p-6",children:"Please select a freight type"}))})}function oT(){const[e,t]=(0,s.useState)(!1);return(0,ga.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,ga.jsx)(Ra,{onMenuToggle:()=>{t(!e)},isMobileMenuOpen:e}),(0,ga.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,ga.jsx)($a,{isOpen:e,onClose:()=>{t(!1)}}),(0,ga.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,ga.jsx)(lT,{})})]}),(0,ga.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const cT=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{const n=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n=new XS,s=n.internal.pageSize.width,i=n.internal.pageSize.height,l=15;let o=15;if(n.addImage(ya,"PNG",l,o,50,10),n.setFontSize(11),n.setFont("helvetica","bold"),n.text("Scanwell Logistics Colombo (Pvt) Ltd.",s-l,o+2,{align:"right"}),n.setFontSize(9),n.setFont("helvetica","normal"),n.text("67/1 Hudson Road Colombo 3 Sri Lanka.",s-l,o+7,{align:"right"}),n.text("Office #+94 11 2426600/4766400",s-l,o+12,{align:"right"}),o+=25,n.setFontSize(16),n.setFont("helvetica","bold"),n.text("WAREHOUSE QUOTATION",s/2,o,{align:"center"}),o+=12,n.setFontSize(11),n.setFont("helvetica","bold"),n.text(e.quoteNumber||"N/A",l,o),n.text("Warehouse Services",s-l,o,{align:"right"}),o+=5,n.setFontSize(9),n.setFont("helvetica","normal"),e.validityDate){const t=new Date(e.validityDate).toLocaleDateString("en-GB");n.text("Valid Until: ".concat(t),s-l,o,{align:"right"})}o+=10,n.setFont("helvetica","bold"),n.text("Customer",l,o),n.setFont("helvetica","normal"),o+=4,n.text(e.customerName||"N/A",l,o),o+=8,n.setFont("helvetica","bold"),n.text("Currency",l,o),n.text("Issued Date",70,o),n.text("Validity Period",130,o),o+=4,n.setFont("helvetica","normal"),n.text(e.currency||"LKR",l,o),n.text(new Date(e.issuedDate).toLocaleDateString("en-GB"),70,o),n.text("".concat(e.validityDays," days"),130,o),o+=8,n.line(l,o,s-l,o),o+=8,n.setFont("helvetica","bold"),n.setFontSize(10),n.text("Service Items",l,o),o+=5;const c=t.map((e,t)=>[(t+1).toString(),e.category||"",e.description||"",e.remarks||"",e.unitOfMeasurement||"",parseFloat(e.amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]),d=t.reduce((e,t)=>e+(parseFloat(t.amount)||0),0);F_(n,{startY:o,head:[["#","Category","Description","Remarks","Unit","Amount (".concat(e.currency,")")]],body:c,theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontStyle:"bold",fontSize:8,halign:"center"},bodyStyles:{fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:10,halign:"center"},1:{cellWidth:28},2:{cellWidth:55},3:{cellWidth:35},4:{cellWidth:25},5:{cellWidth:27,halign:"right",fontStyle:"bold"}},margin:{left:l,right:l},foot:[["","","","",{content:"TOTAL:",styles:{halign:"right",fontStyle:"bold",fontSize:9}},{content:d.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold",fontSize:9,fillColor:[240,240,240]}}]],footStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold"}}),o=n.lastAutoTable.finalY+10,r&&r.length>0&&(o>i-80&&(n.addPage(),o=20),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("Terms & Conditions:",l,o),o+=5,n.setFontSize(8),n.setFont("helvetica","normal"),r.forEach(e=>{e&&e.trim()&&(o>i-25&&(n.addPage(),o=20),n.splitTextToSize("- ".concat(e),s-30).forEach(e=>{n.text(e,l,o),o+=4}))}));const u=i-15;n.setFontSize(8),n.setFont("helvetica","italic");const h=a?"".concat(a.firstName||""," ").concat(a.lastName||"").trim():"System",f=null!==a&&void 0!==a&&a.email?" (".concat(a.email,")"):"";return n.text("Quotation generated by - ".concat(h).concat(f),l,u),n.text("This is a Computer generated Document and no Signature required.",l,u+4),n.output("blob")}(e,t,r,a),s=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="fixed",i.style.right="0",i.style.bottom="0",i.style.width="0",i.style.height="0",i.style.border="none",document.body.appendChild(i),i.src=s,i.onload=function(){setTimeout(()=>{i.contentWindow.focus(),i.contentWindow.print(),setTimeout(()=>{document.body.removeChild(i),URL.revokeObjectURL(s)},1e3)},100)}}catch(gT){console.error("Error printing warehouse PDF:",gT),alert("Failed to print PDF. Please try downloading instead.")}},dT=["Storage","Handling","Loading/Unloading","Packing","Labeling","Transportation","Overtime Charges","Special Services","Other"];function uT(){var e,t;const{id:r}=function(){let{matches:e}=s.useContext(Z),t=e[e.length-1];return t?t.params:{}}(),a=ne(),[n]=ze(),i="true"===n.get("edit"),[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(i),[u,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[x,b]=(0,s.useState)({customerId:"",customerName:"",currency:"LKR",issuedDate:"",validityDays:30,validityDate:"",lineItems:[],notes:[]});(0,s.useEffect)(()=>{v()},[r]),(0,s.useEffect)(()=>{if(x.issuedDate&&x.validityDays){const e=new Date(x.issuedDate);e.setDate(e.getDate()+parseInt(x.validityDays)),b(t=>We(We({},t),{},{validityDate:e.toISOString().split("T")[0]}))}},[x.issuedDate,x.validityDays]);const v=async()=>{try{var e;o(!0);const t=await Un(r);m(t),g(t),b({customerId:t.customerId||"",customerName:t.customerName||"",currency:t.currency||"LKR",issuedDate:t.issuedDate?new Date(t.issuedDate).toISOString().split("T")[0]:"",validityDays:t.validityDays||30,validityDate:t.validityDate?new Date(t.validityDate).toISOString().split("T")[0]:"",lineItems:(null===(e=t.lineItems)||void 0===e?void 0:e.map(e=>({id:Date.now()+Math.random(),category:e.category||"",description:e.description||"",remarks:e.remarks||"",unitOfMeasurement:e.unitOfMeasurement||"",amount:e.amount||""})))||[],notes:t.notes||[]})}catch(gT){console.error("Error loading warehouse quote:",gT),alert("Failed to load warehouse quote"),a("/quotes-invoices")}finally{o(!1)}},y=()=>{var e;d(!1),b({customerId:p.customerId||"",customerName:p.customerName||"",currency:p.currency||"LKR",issuedDate:p.issuedDate?new Date(p.issuedDate).toISOString().split("T")[0]:"",validityDays:p.validityDays||30,validityDate:p.validityDate?new Date(p.validityDate).toISOString().split("T")[0]:"",lineItems:(null===(e=p.lineItems)||void 0===e?void 0:e.map(e=>({id:Date.now()+Math.random(),category:e.category||"",description:e.description||"",remarks:e.remarks||"",unitOfMeasurement:e.unitOfMeasurement||"",amount:e.amount||""})))||[],notes:p.notes||[]})},w=async()=>{if(x.customerName)if(x.lineItems.some(e=>!e.description||!e.amount))alert("Please fill in all line item descriptions and amounts");else try{h(!0),await qn(r,x),alert("Warehouse quote updated successfully!"),d(!1),v()}catch(gT){console.error("Error updating warehouse quote:",gT),alert("Failed to update warehouse quote")}finally{h(!1)}else alert("Please provide customer name")},N=(e,t,r)=>{b(a=>We(We({},a),{},{lineItems:a.lineItems.map(a=>a.id===e?We(We({},a),{},{[t]:r}):a)}))},j=()=>(c?x.lineItems:(null===f||void 0===f?void 0:f.lineItems)||[]).reduce((e,t)=>e+(parseFloat(t.amount)||0),0).toFixed(2);return l?(0,ga.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:(0,ga.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,ga.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})})}):f?(0,ga.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:(0,ga.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,ga.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,ga.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ga.jsx)("button",{onClick:()=>a("/quotes-invoices"),className:"p-2 hover:bg-white rounded-lg transition-colors",children:(0,ga.jsx)(Tv,{className:"w-6 h-6 text-gray-600"})}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[(0,ga.jsx)(yn,{className:"w-7 h-7 text-amber-600"}),"Warehouse Quote ",f.quoteNumber]}),(0,ga.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:c?"Edit warehouse quotation details":"View warehouse quotation details"})]})]}),(0,ga.jsxs)("div",{className:"flex items-center gap-2",children:[!c&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("button",{onClick:()=>{if(!f)return;!function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n=new XS,s=n.internal.pageSize.width,i=n.internal.pageSize.height,l=15;let o=15;if(n.addImage(ya,"PNG",l,o,50,10),n.setFontSize(11),n.setFont("helvetica","bold"),n.text("Scanwell Logistics Colombo (Pvt) Ltd.",s-l,o+2,{align:"right"}),n.setFontSize(9),n.setFont("helvetica","normal"),n.text("67/1 Hudson Road Colombo 3 Sri Lanka.",s-l,o+7,{align:"right"}),n.text("Office #+94 11 2426600/4766400",s-l,o+12,{align:"right"}),o+=25,n.setFontSize(16),n.setFont("helvetica","bold"),n.text("WAREHOUSE QUOTATION",s/2,o,{align:"center"}),o+=12,n.setFontSize(11),n.setFont("helvetica","bold"),n.text(e.quoteNumber||"N/A",l,o),n.text("Warehouse Services",s-l,o,{align:"right"}),o+=5,n.setFontSize(9),n.setFont("helvetica","normal"),e.validityDate){const t=new Date(e.validityDate).toLocaleDateString("en-GB");n.text("Valid Until: ".concat(t),s-l,o,{align:"right"})}o+=10,n.setFont("helvetica","bold"),n.text("Customer",l,o),n.setFont("helvetica","normal"),o+=4,n.text(e.customerName||"N/A",l,o),o+=8,n.setFont("helvetica","bold"),n.text("Currency",l,o),n.text("Issued Date",70,o),n.text("Validity Period",130,o),o+=4,n.setFont("helvetica","normal"),n.text(e.currency||"LKR",l,o),n.text(new Date(e.issuedDate).toLocaleDateString("en-GB"),70,o),n.text("".concat(e.validityDays," days"),130,o),o+=8,n.line(l,o,s-l,o),o+=8,n.setFont("helvetica","bold"),n.setFontSize(10),n.text("Service Items",l,o),o+=5;const c=t.map((e,t)=>[(t+1).toString(),e.category||"",e.description||"",e.remarks||"",e.unitOfMeasurement||"",parseFloat(e.amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]),d=t.reduce((e,t)=>e+(parseFloat(t.amount)||0),0);F_(n,{startY:o,head:[["#","Category","Description","Remarks","Unit","Amount (".concat(e.currency,")")]],body:c,theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontStyle:"bold",fontSize:8,halign:"center"},bodyStyles:{fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:10,halign:"center"},1:{cellWidth:28},2:{cellWidth:55},3:{cellWidth:35},4:{cellWidth:25},5:{cellWidth:27,halign:"right",fontStyle:"bold"}},margin:{left:l,right:l},foot:[["","","","",{content:"TOTAL:",styles:{halign:"right",fontStyle:"bold",fontSize:9}},{content:d.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold",fontSize:9,fillColor:[240,240,240]}}]],footStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold"}}),o=n.lastAutoTable.finalY+10,r&&r.length>0&&(o>i-80&&(n.addPage(),o=20),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("Terms & Conditions:",l,o),o+=5,n.setFontSize(8),n.setFont("helvetica","normal"),r.forEach(e=>{e&&e.trim()&&(o>i-25&&(n.addPage(),o=20),n.splitTextToSize("- ".concat(e),s-30).forEach(e=>{n.text(e,l,o),o+=4}))}));const u=i-15;n.setFontSize(8),n.setFont("helvetica","italic");const h=a?"".concat(a.firstName||""," ").concat(a.lastName||"").trim():"System",f=null!==a&&void 0!==a&&a.email?" (".concat(a.email,")"):"";n.text("Quotation generated by - ".concat(h).concat(f),l,u),n.text("This is a Computer generated Document and no Signature required.",l,u+4);const m=n.internal.getNumberOfPages();for(let g=1;g<=m;g++)n.setPage(g),n.setFontSize(8),n.setTextColor(100),n.text("Page ".concat(g," of ").concat(m),s-l-15,i-10,{align:"right"});const p="".concat(e.quoteNumber||"Warehouse-Quote",".pdf");n.save(p)}({quoteNumber:f.quoteNumber,customerName:f.customerName,currency:f.currency,issuedDate:f.issuedDate,validityDays:f.validityDays,validityDate:f.validityDate},f.lineItems||[],f.notes||[])},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,ga.jsx)(es,{size:18}),"Download PDF"]}),(0,ga.jsxs)("button",{onClick:()=>{if(!f)return;const e={quoteNumber:f.quoteNumber,customerName:f.customerName,currency:f.currency,issuedDate:f.issuedDate,validityDays:f.validityDays,validityDate:f.validityDate};cT(e,f.lineItems||[],f.notes||[])},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,ga.jsx)(_v,{size:18}),"Print"]}),(0,ga.jsxs)("button",{onClick:()=>{d(!0)},className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[(0,ga.jsx)(Pn,{size:18}),"Edit"]})]}),c&&(0,ga.jsxs)(ga.Fragment,{children:[(0,ga.jsxs)("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,ga.jsx)(Ea,{size:18}),"Cancel"]}),(0,ga.jsxs)("button",{onClick:w,disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50",children:[(0,ga.jsx)(Yn,{size:18}),u?"Saving...":"Save Changes"]})]})]})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsx)("div",{className:"p-6 border-b border-slate-200 bg-gradient-to-r from-amber-50 to-orange-50",children:(0,ga.jsxs)("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-5 h-5 text-amber-600"}),"Quote Information"]})}),(0,ga.jsx)("div",{className:"p-6",children:(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(Oa,{className:"w-4 h-4 text-amber-600"}),"Customer Name"]}),c?(0,ga.jsx)("input",{type:"text",value:x.customerName,onChange:e=>b(t=>We(We({},t),{},{customerName:e.target.value})),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors",required:!0}):(0,ga.jsx)("p",{className:"text-base font-semibold text-gray-800",children:f.customerName})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(Ln,{className:"w-4 h-4 text-amber-600"}),"Currency"]}),c?(0,ga.jsxs)("select",{value:x.currency,onChange:e=>b(t=>We(We({},t),{},{currency:e.target.value})),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors",children:[(0,ga.jsx)("option",{value:"LKR",children:"LKR - Sri Lankan Rupee"}),(0,ga.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,ga.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,ga.jsx)("option",{value:"GBP",children:"GBP - British Pound"})]}):(0,ga.jsx)("p",{className:"text-base font-semibold text-gray-800",children:f.currency})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status"}),c?(0,ga.jsxs)("select",{value:f.status,onChange:e=>(async e=>{try{await Hn(r,e),alert("Quote status updated to ".concat(e)),v()}catch(gT){console.error("Error updating status:",gT),alert("Failed to update status")}})(e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors",children:[(0,ga.jsx)("option",{value:"Active",children:"Active"}),(0,ga.jsx)("option",{value:"Inactive",children:"Inactive"}),(0,ga.jsx)("option",{value:"Expired",children:"Expired"})]}):(e=>{const t={Active:{bg:"bg-green-100",text:"text-green-800",icon:sn},Inactive:{bg:"bg-gray-100",text:"text-gray-800",icon:vn},Expired:{bg:"bg-red-100",text:"text-red-800",icon:vn}},r=t[e]||t.Active,a=r.icon;return(0,ga.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ".concat(r.bg," ").concat(r.text),children:[(0,ga.jsx)(a,{size:16}),e]})})(f.status)]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(En,{className:"w-4 h-4 text-amber-600"}),"Issued Date"]}),c?(0,ga.jsx)("input",{type:"date",value:x.issuedDate,onChange:e=>b(t=>We(We({},t),{},{issuedDate:e.target.value})),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors"}):(0,ga.jsx)("p",{className:"text-base text-gray-800",children:new Date(f.issuedDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,ga.jsx)(nn,{className:"w-4 h-4 text-amber-600"}),"Validity (Days)"]}),c?(0,ga.jsx)("input",{type:"number",value:x.validityDays,onChange:e=>b(t=>We(We({},t),{},{validityDays:e.target.value})),min:"1",className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors"}):(0,ga.jsxs)("p",{className:"text-base text-gray-800",children:[f.validityDays," days"]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Valid Until"}),(0,ga.jsx)("p",{className:"text-base font-semibold text-amber-600",children:new Date(c?x.validityDate:f.validityDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsxs)("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between bg-gradient-to-r from-amber-50 to-orange-50",children:[(0,ga.jsxs)("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ka,{className:"w-5 h-5 text-amber-600"}),"Service Items"]}),c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{const e={id:Date.now(),category:"",description:"",remarks:"",unitOfMeasurement:"",amount:""};b(t=>We(We({},t),{},{lineItems:[...t.lineItems,e]}))},className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Item"]})]}),(0,ga.jsxs)("div",{className:"p-6",children:[c?(0,ga.jsx)("div",{className:"space-y-4",children:x.lineItems.map((e,t)=>(0,ga.jsxs)("div",{className:"p-5 border-2 border-slate-200 rounded-xl hover:border-amber-200 transition-colors",children:[(0,ga.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,ga.jsxs)("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 rounded-lg text-sm font-medium",children:["Item #",t+1]}),(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{1!==x.lineItems.length?b(t=>We(We({},t),{},{lineItems:t.lineItems.filter(t=>t.id!==e)})):alert("At least one line item is required")})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",disabled:1===x.lineItems.length,children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]}),(0,ga.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),(0,ga.jsxs)("select",{value:e.category,onChange:t=>N(e.id,"category",t.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors text-sm",children:[(0,ga.jsx)("option",{value:"",children:"Select category"}),dT.map(e=>(0,ga.jsx)("option",{value:e,children:e},e))]})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Unit of Measurement"}),(0,ga.jsx)("input",{type:"text",value:e.unitOfMeasurement,onChange:t=>N(e.id,"unitOfMeasurement",t.target.value),placeholder:"e.g., Per CBM, Per Hour",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors text-sm"})]}),(0,ga.jsxs)("div",{className:"md:col-span-2",children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description *"}),(0,ga.jsx)("textarea",{value:e.description,onChange:t=>N(e.id,"description",t.target.value),placeholder:"Enter service description...",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors text-sm resize-none",required:!0})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Remarks"}),(0,ga.jsx)("textarea",{value:e.remarks,onChange:t=>N(e.id,"remarks",t.target.value),placeholder:"Additional remarks (optional)",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors text-sm resize-none"})]}),(0,ga.jsxs)("div",{children:[(0,ga.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Amount *"}),(0,ga.jsx)("input",{type:"number",value:e.amount,onChange:t=>N(e.id,"amount",t.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors text-sm",required:!0})]})]})]},e.id))}):(0,ga.jsx)("div",{className:"overflow-x-auto",children:(0,ga.jsxs)("table",{className:"w-full",children:[(0,ga.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"#"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Category"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Description"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Remarks"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Unit"}),(0,ga.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase",children:"Amount"})]})}),(0,ga.jsx)("tbody",{className:"divide-y divide-gray-200",children:null===(e=f.lineItems)||void 0===e?void 0:e.map((e,t)=>(0,ga.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,ga.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:t+1}),(0,ga.jsx)("td",{className:"px-4 py-3 text-sm text-gray-800",children:e.category||"-"}),(0,ga.jsx)("td",{className:"px-4 py-3 text-sm text-gray-800",children:e.description}),(0,ga.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.remarks||"-"}),(0,ga.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.unitOfMeasurement||"-"}),(0,ga.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900 text-right",children:parseFloat(e.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]},t))}),(0,ga.jsx)("tfoot",{className:"bg-amber-50",children:(0,ga.jsxs)("tr",{children:[(0,ga.jsx)("td",{colSpan:"5",className:"px-4 py-3 text-right text-sm font-bold text-gray-800",children:"Total Amount:"}),(0,ga.jsxs)("td",{className:"px-4 py-3 text-right text-lg font-bold text-amber-600",children:[f.currency," ",j()]})]})})]})}),c&&(0,ga.jsx)("div",{className:"mt-4 p-4 bg-amber-50 rounded-lg border border-amber-100",children:(0,ga.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ga.jsx)("span",{className:"text-sm font-bold text-gray-800",children:"Total Amount:"}),(0,ga.jsxs)("span",{className:"text-xl font-bold text-amber-600",children:[x.currency," ",j()]})]})})]})]}),(0,ga.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,ga.jsxs)("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between bg-gradient-to-r from-amber-50 to-orange-50",children:[(0,ga.jsxs)("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,ga.jsx)(Ha,{className:"w-5 h-5 text-amber-600"}),"Terms & Notes"]}),c&&(0,ga.jsxs)("button",{type:"button",onClick:()=>{b(e=>We(We({},e),{},{notes:[...e.notes,""]}))},className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-sm",children:[(0,ga.jsx)(dn,{className:"w-4 h-4"}),"Add Note"]})]}),(0,ga.jsx)("div",{className:"p-6",children:c?(0,ga.jsx)("div",{className:"space-y-3",children:x.notes.map((e,t)=>(0,ga.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ga.jsx)("span",{className:"text-amber-600 mt-2 font-medium",children:"@"}),(0,ga.jsx)("textarea",{value:e,onChange:e=>((e,t)=>{b(r=>We(We({},r),{},{notes:r.notes.map((r,a)=>a===e?t:r)}))})(t,e.target.value),placeholder:"Enter note...",rows:"2",className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors text-sm resize-none"}),(0,ga.jsx)("button",{type:"button",onClick:()=>(e=>{b(t=>We(We({},t),{},{notes:t.notes.filter((t,r)=>r!==e)}))})(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors mt-1",children:(0,ga.jsx)(On,{className:"w-4 h-4"})})]},t))}):(0,ga.jsx)("ul",{className:"space-y-2",children:null===(t=f.notes)||void 0===t?void 0:t.map((e,t)=>(0,ga.jsxs)("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[(0,ga.jsx)("span",{className:"text-amber-600 font-medium mt-0.5",children:"@"}),(0,ga.jsx)("span",{children:e})]},t))})})]}),c&&(0,ga.jsxs)("div",{className:"flex justify-end gap-4 pb-6",children:[(0,ga.jsx)("button",{onClick:y,className:"px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors font-medium",children:"Cancel"}),(0,ga.jsxs)("button",{onClick:w,disabled:u,className:"px-8 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors font-medium shadow-lg shadow-amber-200 flex items-center gap-2 disabled:opacity-50",children:[(0,ga.jsx)(Yn,{className:"w-5 h-5"}),u?"Saving...":"Save Changes"]})]})]})}):(0,ga.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:(0,ga.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,ga.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[(0,ga.jsx)(vn,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,ga.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Quote Not Found"}),(0,ga.jsx)("p",{className:"text-gray-600 mb-6",children:"The warehouse quote you're looking for doesn't exist."}),(0,ga.jsx)("button",{onClick:()=>a("/quotes-invoice"),className:"px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700",children:"Back to Quotes"})]})})})}const hT=function(){return(0,ga.jsx)(ba,{children:(0,ga.jsx)(Oe,{children:(0,ga.jsxs)(ke,{children:[(0,ga.jsx)(Ne,{path:"/login",element:(0,ga.jsx)($b,{})}),(0,ga.jsxs)(Ne,{element:(0,ga.jsx)(va,{}),children:[(0,ga.jsx)(Ne,{path:"/dashboard",element:(0,ga.jsx)(an,{})}),(0,ga.jsx)(Ne,{path:"/mail-tracking",element:(0,ga.jsx)(gn,{})}),(0,ga.jsx)(Ne,{path:"/quotes-invoices",element:(0,ga.jsx)(Zn,{})}),(0,ga.jsx)(Ne,{path:"/quotes",element:(0,ga.jsx)(oT,{})}),(0,ga.jsx)(Ne,{path:"/rates",element:(0,ga.jsx)(Db,{})}),(0,ga.jsx)(Ne,{path:"/rfq",element:(0,ga.jsx)(ls,{})}),(0,ga.jsx)(Ne,{path:"/leads",element:(0,ga.jsx)(_s,{})}),(0,ga.jsx)(Ne,{path:"/accounts",element:(0,ga.jsx)(Gs,{})}),(0,ga.jsx)(Ne,{path:"/sales-plans",element:(0,ga.jsx)(Kb,{})}),(0,ga.jsx)(Ne,{path:"/usefull-link",element:(0,ga.jsx)(pv,{})}),(0,ga.jsx)(Ne,{path:"/hr/manage-employee",element:(0,ga.jsx)(iv,{})}),(0,ga.jsx)(Ne,{path:"/hr/manage",element:(0,ga.jsx)(cv,{})}),(0,ga.jsx)(Ne,{path:"/rolebase",element:(0,ga.jsx)(kv,{})}),(0,ga.jsx)(Ne,{path:"/profile",element:(0,ga.jsx)(Av,{})}),(0,ga.jsx)(Ne,{path:"/warehouse-quotes/:id",element:(0,ga.jsx)(uT,{})}),(0,ga.jsx)(Ne,{path:"/",element:(0,ga.jsx)(ye,{to:"/dashboard",replace:!0})})]})]})})})},fT=e=>{e&&e instanceof Function&&r.e(453).then(r.bind(r,6453)).then(t=>{let{getCLS:r,getFID:a,getFCP:n,getLCP:s,getTTFB:i}=t;r(e),a(e),n(e),s(e),i(e)})};l.createRoot(document.getElementById("root")).render((0,ga.jsx)(s.StrictMode,{children:(0,ga.jsx)(hT,{})})),fT()})();
//# sourceMappingURL=main.d022c2fb.js.map