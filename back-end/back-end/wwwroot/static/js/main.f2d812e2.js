/*! For license information please see main.f2d812e2.js.LICENSE.txt */
(()=>{"use strict";var e={579:(e,t,r)=>{e.exports=r(2799)},2284:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{A:()=>n})},2799:(e,t)=>{var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(e,t,n){var a=null;if(void 0!==n&&(a=""+n),void 0!==t.key&&(a=""+t.key),"key"in t)for(var s in n={},t)"key"!==s&&(n[s]=t[s]);else n=t;return t=n.ref,{$$typeof:r,type:e,key:a,ref:void 0!==t?t:null,props:n}}t.Fragment=n,t.jsx=a,t.jsxs=a},4288:(e,t)=>{var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,x={};function b(e,t,r){this.props=e,this.context=t,this.refs=x,this.updater=r||p}function v(){}function y(e,t,r){this.props=e,this.context=t,this.refs=x,this.updater=r||p}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=b.prototype;var w=y.prototype=new v;w.constructor=y,g(w,b.prototype),w.isPureReactComponent=!0;var N=Array.isArray;function j(){}var k={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function A(e,t,n){var a=n.ref;return{$$typeof:r,type:e,key:t,ref:void 0!==a?a:null,props:n}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var _=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function E(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,d=!1;if(null===e)d=!0;else switch(o){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case r:case n:d=!0;break;case h:return E((d=e._init)(e._payload),t,a,s,i)}}if(d)return i=i(e),d=""===s?"."+T(e,0):s,N(i)?(a="",null!=d&&(a=d.replace(_,"$&/")+"/"),E(i,t,a,"",function(e){return e})):null!=i&&(C(i)&&(l=i,c=a+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+d,i=A(l.type,c,l.props)),t.push(i)),1;d=0;var u,f=""===s?".":s+":";if(N(e))for(var p=0;p<e.length;p++)d+=E(s=e[p],t,a,o=f+T(s,p),i);else if("function"===typeof(p=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=m&&u[m]||u["@@iterator"])?u:null))for(e=p.call(e),p=0;!(s=e.next()).done;)d+=E(s=s.value,t,a,o=f+T(s,p++),i);else if("object"===o){if("function"===typeof e.then)return E(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(j,j):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function L(e,t,r){if(null==e)return e;var n=[],a=0;return E(e,n,"","",function(e){return t.call(r,e,a++)}),n}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},F={map:L,forEach:function(e,t,r){L(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return L(e,function(){t++}),t},toArray:function(e){return L(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=F,t.Component=b,t.Fragment=a,t.Profiler=i,t.PureComponent=y,t.StrictMode=s,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return k.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var n=g({},e.props),a=e.key;if(null!=t)for(s in void 0!==t.key&&(a=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(n[s]=t[s]);var s=arguments.length-2;if(1===s)n.children=r;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];n.children=i}return A(e.type,a,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,r){var n,a={},s=null;if(null!=t)for(n in void 0!==t.key&&(s=""+t.key),t)S.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(a[n]=t[n]);var i=arguments.length-2;if(1===i)a.children=r;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(n in i=e.defaultProps)void 0===a[n]&&(a[n]=i[n]);return A(e,s,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=k.T,r={};k.T=r;try{var n=e(),a=k.S;null!==a&&a(r,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(j,O)}catch(s){O(s)}finally{null!==t&&null!==r.types&&(t.types=r.types),k.T=t}},t.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},t.use=function(e){return k.H.use(e)},t.useActionState=function(e,t,r){return k.H.useActionState(e,t,r)},t.useCallback=function(e,t){return k.H.useCallback(e,t)},t.useContext=function(e){return k.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return k.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return k.H.useEffect(e,t)},t.useEffectEvent=function(e){return k.H.useEffectEvent(e)},t.useId=function(){return k.H.useId()},t.useImperativeHandle=function(e,t,r){return k.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return k.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return k.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return k.H.useMemo(e,t)},t.useOptimistic=function(e,t){return k.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return k.H.useReducer(e,t,r)},t.useRef=function(e){return k.H.useRef(e)},t.useState=function(e){return k.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return k.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return k.H.useTransition()},t.version="19.2.0"},4391:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(7004)},4980:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(2284);function a(e){var t=function(e,t){if("object"!=(0,n.A)(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=(0,n.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,n.A)(t)?t:t+""}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},5043:(e,t,r)=>{e.exports=r(4288)},5896:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<s(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,i=a>>>1;n<i;){var o=2*(n+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,r))c<a&&0>s(d,l)?(e[n]=d,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<a&&0>s(d,r)))break e;e[n]=d,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,f=3,m=!1,p=!1,g=!1,x=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,r(c,t)}t=n(d)}}function N(e){if(g=!1,w(e),!p)if(null!==n(c))p=!0,k||(k=!0,j());else{var t=n(d);null!==t&&P(N,t.startTime-e)}}var j,k=!1,S=-1,A=5,C=-1;function _(){return!!x||!(t.unstable_now()-C<A)}function T(){if(x=!1,k){var e=t.unstable_now();C=e;var r=!0;try{e:{p=!1,g&&(g=!1,v(S),S=-1),m=!0;var s=f;try{t:{for(w(e),h=n(c);null!==h&&!(h.expirationTime>e&&_());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),r=!0;break t}h===n(c)&&a(c),w(e)}else a(c);h=n(c)}if(null!==h)r=!0;else{var l=n(d);null!==l&&P(N,l.startTime-e),r=!1}}break e}finally{h=null,f=s,m=!1}r=void 0}}finally{r?j():k=!1}}}if("function"===typeof y)j=function(){y(T)};else if("undefined"!==typeof MessageChannel){var E=new MessageChannel,L=E.port2;E.port1.onmessage=T,j=function(){L.postMessage(null)}}else j=function(){b(T,0)};function P(e,r){S=b(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,r(d,e),null===n(c)&&e===n(d)&&(g?(v(S),S=-1):g=!0,P(N,s-i))):(e.sortIndex=o,r(c,e),p||m||(p=!0,k||(k=!0,j()))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},6672:(e,t,r)=>{var n=r(5043);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=l.T,r=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=r,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:a,fetchPriority:s}):"script"===r&&i.d.X(e,{crossOrigin:n,integrity:a,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin);i.d.L(e,r,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var r=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return l.H.useFormState(e,t,r)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},7004:(e,t,r)=>{var n=r(8853),a=r(5043),s=r(7950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(i(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),w=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var T=Symbol.iterator;function E(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=T&&e[T]||e["@@iterator"])?e:null}var L=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===L?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case j:return"Suspense";case k:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case w:return e.displayName||"Context";case y:return(e._context.displayName||"Context")+".Consumer";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return P(e(t))}catch(ly){}}return null}var O=Array.isArray,F=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},D=[],M=-1;function B(e){return{current:e}}function U(e){0>M||(e.current=D[M],D[M]=null,M--)}function z(e,t){M++,D[M]=e.current,e.current=t}var q,H,W=B(null),V=B(null),G=B(null),K=B(null);function Y(e,t){switch(z(G,t),z(V,e),z(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?xu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=bu(t=xu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(W),z(W,e)}function X(){U(W),U(V),U(G)}function $(e){null!==e.memoizedState&&z(K,e);var t=W.current,r=bu(t,e.type);t!==r&&(z(V,e),z(W,r))}function J(e){V.current===e&&(U(W),U(V)),K.current===e&&(U(K),dh._currentValue=R)}function Q(e){if(void 0===q)try{throw Error()}catch(ly){var t=ly.stack.trim().match(/\n( *(at )?)/);q=t&&t[1]||"",H=-1<ly.stack.indexOf("\n    at")?" (<anonymous>)":-1<ly.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+q+e+H}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(ly){var n=ly}Reflect.construct(e,[],r)}else{try{r.call()}catch(a){n=a}e.call(r.prototype)}}else{try{throw Error()}catch(s){n=s}(r=e())&&"function"===typeof r.catch&&r.catch(function(){})}}catch(i){if(i&&n&&"string"===typeof i.stack)return[i.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=n.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(a=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(n===l.length||a===c.length)for(n=l.length-1,a=c.length-1;1<=n&&0<=a&&l[n]!==c[a];)a--;for(;1<=n&&0<=a;n--,a--)if(l[n]!==c[a]){if(1!==n||1!==a)do{if(n--,0>--a||l[n]!==c[a]){var d="\n"+l[n].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=n&&0<=a);break}}}finally{Z=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?Q(r):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return e.child!==t&&null!==t?Q("Suspense Fallback"):Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Q("Activity");default:return""}}function re(e){try{var t="",r=null;do{t+=te(e,r),r=e,e=e.return}while(e);return t}catch(ly){return"\nError generating stack: "+ly.message+"\n"+ly.stack}}var ne=Object.prototype.hasOwnProperty,ae=n.unstable_scheduleCallback,se=n.unstable_cancelCallback,ie=n.unstable_shouldYield,oe=n.unstable_requestPaint,le=n.unstable_now,ce=n.unstable_getCurrentPriorityLevel,de=n.unstable_ImmediatePriority,ue=n.unstable_UserBlockingPriority,he=n.unstable_NormalPriority,fe=n.unstable_LowPriority,me=n.unstable_IdlePriority,pe=n.log,ge=n.unstable_setDisableYieldValue,xe=null,be=null;function ve(e){if("function"===typeof pe&&ge(e),be&&"function"===typeof be.setStrictMode)try{be.setStrictMode(xe,e)}catch(t){}}var ye=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(we(e)/Ne|0)|0},we=Math.log,Ne=Math.LN2;var je=256,ke=262144,Se=4194304;function Ae(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t,r){var n=e.pendingLanes;if(0===n)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&n;return 0!==o?0!==(n=o&~s)?a=Ae(n):0!==(i&=o)?a=Ae(i):r||0!==(r=o&~e)&&(a=Ae(r)):0!==(o=n&~s)?a=Ae(o):0!==i?a=Ae(i):r||0!==(r=n&~e)&&(a=Ae(r)),0===a?0:0!==t&&t!==a&&0===(t&s)&&((s=a&-a)>=(r=t&-t)||32===s&&0!==(4194048&r))?t:a}function _e(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Te(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ee(){var e=Se;return 0===(62914560&(Se<<=1))&&(Se=4194304),e}function Le(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Pe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-ye(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|261930&r}function Fe(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ye(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}function Ie(e,t){var r=t&-t;return 0!==((r=0!==(42&r)?1:Re(r))&(e.suspendedLanes|t))?0:r}function Re(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function De(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Me(){var e=I.p;return 0!==e?e:void 0===(e=window.event)?32:Ah(e.type)}function Be(e,t){var r=I.p;try{return I.p=e,t()}finally{I.p=r}}var Ue=Math.random().toString(36).slice(2),ze="__reactFiber$"+Ue,qe="__reactProps$"+Ue,He="__reactContainer$"+Ue,We="__reactEvents$"+Ue,Ve="__reactListeners$"+Ue,Ge="__reactHandles$"+Ue,Ke="__reactResources$"+Ue,Ye="__reactMarker$"+Ue;function Xe(e){delete e[ze],delete e[qe],delete e[We],delete e[Ve],delete e[Ge]}function $e(e){var t=e[ze];if(t)return t;for(var r=e.parentNode;r;){if(t=r[He]||r[ze]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Ru(e);null!==e;){if(r=e[ze])return r;e=Ru(e)}return t}r=(e=r).parentNode}return null}function Je(e){if(e=e[ze]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ze(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ye]=!0}var tt=new Set,rt={};function nt(e,t){at(e,t),at(e+"Capture",t)}function at(e,t){for(rt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},ot={};function lt(e,t,r){if(a=t,ne.call(ot,a)||!ne.call(it,a)&&(st.test(a)?ot[a]=!0:(it[a]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var a}function ct(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function dt(e,t,r,n){if(null===n)e.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+n)}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,r){var n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ht(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function xt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function bt(e,t,r,n,a,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?yt(e,i,ut(t)):null!=r?yt(e,i,ut(r)):null!=n&&e.removeAttribute("value"),null==a&&null!=s&&(e.defaultChecked=!!s),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ut(o):e.removeAttribute("name")}function vt(e,t,r,n,a,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=r){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void ft(e);r=null!=r?""+ut(r):"",t=null!=t?""+ut(t):r,o||t===e.value||(e.value=t),e.defaultValue=t}n="function"!==typeof(n=null!=n?n:a)&&"symbol"!==typeof n&&!!n,e.checked=o?e.checked:!!n,e.defaultChecked=!!n,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i),ft(e)}function yt(e,t,r){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function wt(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ut(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Nt(e,t,r){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ut(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function jt(e,t,r,n){if(null==t){if(null!=n){if(null!=r)throw Error(i(92));if(O(n)){if(1<n.length)throw Error(i(93));n=n[0]}r=n}null==r&&(r=""),t=r}r=ut(t),e.defaultValue=r,(n=e.textContent)===r&&""!==n&&null!==n&&(e.value=n),ft(e)}function kt(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function At(e,t,r){var n=0===t.indexOf("--");null==r||"boolean"===typeof r||""===r?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,r):"number"!==typeof r||0===r||St.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Ct(e,t,r){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=r){for(var n in r)!r.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var a in t)n=t[a],t.hasOwnProperty(a)&&r[a]!==n&&At(e,a,n)}else for(var s in t)t.hasOwnProperty(s)&&At(e,s,t[s])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Et=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lt(e){return Et.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pt(){}var Ot=null;function Ft(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var It=null,Rt=null;function Dt(e){var t=Je(e);if(t&&(e=t.stateNode)){var r=e[qe]||null;e:switch(e=t.stateNode,t.type){case"input":if(bt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+xt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=n[qe]||null;if(!a)throw Error(i(90));bt(n,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<r.length;t++)(n=r[t]).form===e.form&&mt(n)}break e;case"textarea":Nt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&wt(e,!!r.multiple,t,!1)}}}var Mt=!1;function Bt(e,t,r){if(Mt)return e(t,r);Mt=!0;try{return e(t)}finally{if(Mt=!1,(null!==It||null!==Rt)&&(Zc(),It&&(t=It,e=Rt,Rt=It=null,Dt(t),e)))for(t=0;t<e.length;t++)Dt(e[t])}}function Ut(e,t){var r=e.stateNode;if(null===r)return null;var n=r[qe]||null;if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),qt=!1;if(zt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){qt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Jh){qt=!1}var Wt=null,Vt=null,Gt=null;function Kt(){if(Gt)return Gt;var e,t,r=Vt,n=r.length,a="value"in Wt?Wt.value:Wt.textContent,s=a.length;for(e=0;e<n&&r[e]===a[e];e++);var i=n-e;for(t=1;t<=i&&r[n-t]===a[s-t];t++);return Gt=a.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Xt(){return!0}function $t(){return!1}function Jt(e){function t(t,r,n,a,s){for(var i in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Xt:$t,this.isPropagationStopped=$t,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),t}var Qt,Zt,er,tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rr=Jt(tr),nr=f({},tr,{view:0,detail:0}),ar=Jt(nr),sr=f({},nr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==er&&(er&&"mousemove"===e.type?(Qt=e.screenX-er.screenX,Zt=e.screenY-er.screenY):Zt=Qt=0,er=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),ir=Jt(sr),or=Jt(f({},sr,{dataTransfer:0})),lr=Jt(f({},nr,{relatedTarget:0})),cr=Jt(f({},tr,{animationName:0,elapsedTime:0,pseudoElement:0})),dr=Jt(f({},tr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ur=Jt(f({},tr,{data:0})),hr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mr[e])&&!!t[e]}function gr(){return pr}var xr=Jt(f({},nr,{key:function(e){if(e.key){var t=hr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gr,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),br=Jt(f({},sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vr=Jt(f({},nr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gr})),yr=Jt(f({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0})),wr=Jt(f({},sr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Nr=Jt(f({},tr,{newState:0,oldState:0})),jr=[9,13,27,32],kr=zt&&"CompositionEvent"in window,Sr=null;zt&&"documentMode"in document&&(Sr=document.documentMode);var Ar=zt&&"TextEvent"in window&&!Sr,Cr=zt&&(!kr||Sr&&8<Sr&&11>=Sr),_r=String.fromCharCode(32),Tr=!1;function Er(e,t){switch(e){case"keyup":return-1!==jr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pr=!1;var Or={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Or[e.type]:"textarea"===t}function Ir(e,t,r,n){It?Rt?Rt.push(n):Rt=[n]:It=n,0<(t=nu(t,"onChange")).length&&(r=new rr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Rr=null,Dr=null;function Mr(e){Xd(e,0)}function Br(e){if(mt(Qe(e)))return e}function Ur(e,t){if("change"===e)return t}var zr=!1;if(zt){var qr;if(zt){var Hr="oninput"in document;if(!Hr){var Wr=document.createElement("div");Wr.setAttribute("oninput","return;"),Hr="function"===typeof Wr.oninput}qr=Hr}else qr=!1;zr=qr&&(!document.documentMode||9<document.documentMode)}function Vr(){Rr&&(Rr.detachEvent("onpropertychange",Gr),Dr=Rr=null)}function Gr(e){if("value"===e.propertyName&&Br(Dr)){var t=[];Ir(t,Dr,e,Ft(e)),Bt(Mr,t)}}function Kr(e,t,r){"focusin"===e?(Vr(),Dr=r,(Rr=t).attachEvent("onpropertychange",Gr)):"focusout"===e&&Vr()}function Yr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Br(Dr)}function Xr(e,t){if("click"===e)return Br(t)}function $r(e,t){if("input"===e||"change"===e)return Br(t)}var Jr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qr(e,t){if(Jr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ne.call(t,a)||!Jr(e[a],t[a]))return!1}return!0}function Zr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function en(e,t){var r,n=Zr(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zr(n)}}function tn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?tn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rn(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=pt((e=t.contentWindow).document)}return t}function nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var an=zt&&"documentMode"in document&&11>=document.documentMode,sn=null,on=null,ln=null,cn=!1;function dn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;cn||null==sn||sn!==pt(n)||("selectionStart"in(n=sn)&&nn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},ln&&Qr(ln,n)||(ln=n,0<(n=nu(on,"onSelect")).length&&(t=new rr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=sn)))}function un(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var hn={animationend:un("Animation","AnimationEnd"),animationiteration:un("Animation","AnimationIteration"),animationstart:un("Animation","AnimationStart"),transitionrun:un("Transition","TransitionRun"),transitionstart:un("Transition","TransitionStart"),transitioncancel:un("Transition","TransitionCancel"),transitionend:un("Transition","TransitionEnd")},fn={},mn={};function pn(e){if(fn[e])return fn[e];if(!hn[e])return e;var t,r=hn[e];for(t in r)if(r.hasOwnProperty(t)&&t in mn)return fn[e]=r[t];return e}zt&&(mn=document.createElement("div").style,"AnimationEvent"in window||(delete hn.animationend.animation,delete hn.animationiteration.animation,delete hn.animationstart.animation),"TransitionEvent"in window||delete hn.transitionend.transition);var gn=pn("animationend"),xn=pn("animationiteration"),bn=pn("animationstart"),vn=pn("transitionrun"),yn=pn("transitionstart"),wn=pn("transitioncancel"),Nn=pn("transitionend"),jn=new Map,kn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sn(e,t){jn.set(e,t),nt(t,[e])}kn.push("scrollEnd");var An="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Cn=[],_n=0,Tn=0;function En(){for(var e=_n,t=Tn=_n=0;t<e;){var r=Cn[t];Cn[t++]=null;var n=Cn[t];Cn[t++]=null;var a=Cn[t];Cn[t++]=null;var s=Cn[t];if(Cn[t++]=null,null!==n&&null!==a){var i=n.pending;null===i?a.next=a:(a.next=i.next,i.next=a),n.pending=a}0!==s&&Fn(r,a,s)}}function Ln(e,t,r,n){Cn[_n++]=e,Cn[_n++]=t,Cn[_n++]=r,Cn[_n++]=n,Tn|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Pn(e,t,r,n){return Ln(e,t,r,n),In(e)}function On(e,t){return Ln(e,null,null,t),In(e)}function Fn(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var a=!1,s=e.return;null!==s;)s.childLanes|=r,null!==(n=s.alternate)&&(n.childLanes|=r),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(a=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,a&&null!==t&&(a=31-ye(r),null===(n=(e=s.hiddenUpdates)[a])?e[a]=[t]:n.push(t),t.lane=536870912|r),s):null}function In(e){if(50<Wc)throw Wc=0,Vc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Rn={};function Dn(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(e,t,r,n){return new Dn(e,t,r,n)}function Bn(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Un(e,t){var r=e.alternate;return null===r?((r=Mn(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function zn(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function qn(e,t,r,n,a,s){var o=0;if(n=e,"function"===typeof e)Bn(e)&&(o=1);else if("string"===typeof e)o=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,r,W.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Mn(31,r,t,a)).elementType=C,e.lanes=s,e;case x:return Hn(r.children,a,s,t);case b:o=8,a|=24;break;case v:return(e=Mn(12,r,t,2|a)).elementType=v,e.lanes=s,e;case j:return(e=Mn(13,r,t,a)).elementType=j,e.lanes=s,e;case k:return(e=Mn(19,r,t,a)).elementType=k,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:o=10;break e;case y:o=9;break e;case N:o=11;break e;case S:o=14;break e;case A:o=16,n=null;break e}o=29,r=Error(i(130,null===e?"null":typeof e,"")),n=null}return(t=Mn(o,r,t,a)).elementType=e,t.type=n,t.lanes=s,t}function Hn(e,t,r,n){return(e=Mn(7,e,n,t)).lanes=r,e}function Wn(e,t,r){return(e=Mn(6,e,null,t)).lanes=r,e}function Vn(e){var t=Mn(18,null,null,0);return t.stateNode=e,t}function Gn(e,t,r){return(t=Mn(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Kn=new WeakMap;function Yn(e,t){if("object"===typeof e&&null!==e){var r=Kn.get(e);return void 0!==r?r:(t={value:e,source:t,stack:re(t)},Kn.set(e,t),t)}return{value:e,source:t,stack:re(t)}}var Xn=[],$n=0,Jn=null,Qn=0,Zn=[],ea=0,ta=null,ra=1,na="";function aa(e,t){Xn[$n++]=Qn,Xn[$n++]=Jn,Jn=e,Qn=t}function sa(e,t,r){Zn[ea++]=ra,Zn[ea++]=na,Zn[ea++]=ta,ta=e;var n=ra;e=na;var a=32-ye(n)-1;n&=~(1<<a),r+=1;var s=32-ye(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ra=1<<32-ye(t)+a|r<<a|n,na=s+e}else ra=1<<s|r<<a|n,na=e}function ia(e){null!==e.return&&(aa(e,1),sa(e,1,0))}function oa(e){for(;e===Jn;)Jn=Xn[--$n],Xn[$n]=null,Qn=Xn[--$n],Xn[$n]=null;for(;e===ta;)ta=Zn[--ea],Zn[ea]=null,na=Zn[--ea],Zn[ea]=null,ra=Zn[--ea],Zn[ea]=null}function la(e,t){Zn[ea++]=ra,Zn[ea++]=na,Zn[ea++]=ta,ra=t.id,na=t.overflow,ta=e}var ca=null,da=null,ua=!1,ha=null,fa=!1,ma=Error(i(519));function pa(e){throw wa(Yn(Error(i(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ma}function ga(e){var t=e.stateNode,r=e.type,n=e.memoizedProps;switch(t[ze]=e,t[qe]=n,r){case"dialog":$d("cancel",t),$d("close",t);break;case"iframe":case"object":case"embed":$d("load",t);break;case"video":case"audio":for(r=0;r<Kd.length;r++)$d(Kd[r],t);break;case"source":$d("error",t);break;case"img":case"image":case"link":$d("error",t),$d("load",t);break;case"details":$d("toggle",t);break;case"input":$d("invalid",t),vt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":$d("invalid",t);break;case"textarea":$d("invalid",t),jt(t,n.value,n.defaultValue,n.children)}"string"!==typeof(r=n.children)&&"number"!==typeof r&&"bigint"!==typeof r||t.textContent===""+r||!0===n.suppressHydrationWarning||cu(t.textContent,r)?(null!=n.popover&&($d("beforetoggle",t),$d("toggle",t)),null!=n.onScroll&&$d("scroll",t),null!=n.onScrollEnd&&$d("scrollend",t),null!=n.onClick&&(t.onclick=Pt),t=!0):t=!1,t||pa(e,!0)}function xa(e){for(ca=e.return;ca;)switch(ca.tag){case 5:case 31:case 13:return void(fa=!1);case 27:case 3:return void(fa=!0);default:ca=ca.return}}function ba(e){if(e!==ca)return!1;if(!ua)return xa(e),ua=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||vu(e.type,e.memoizedProps)),t=!t),t&&da&&pa(e),xa(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));da=Iu(e)}else if(31===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));da=Iu(e)}else 27===r?(r=da,Au(e.type)?(e=Fu,Fu=null,da=e):da=r):da=ca?Ou(e.stateNode.nextSibling):null;return!0}function va(){da=ca=null,ua=!1}function ya(){var e=ha;return null!==e&&(null===Ec?Ec=e:Ec.push.apply(Ec,e),ha=null),e}function wa(e){null===ha?ha=[e]:ha.push(e)}var Na=B(null),ja=null,ka=null;function Sa(e,t,r){z(Na,t._currentValue),t._currentValue=r}function Aa(e){e._currentValue=Na.current,U(Na)}function Ca(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function _a(e,t,r,n){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var s=a.dependencies;if(null!==s){var o=a.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),Ca(s.return,r,e),n||(o=null);break e}s=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=r,null!==(s=o.alternate)&&(s.lanes|=r),Ca(o,r,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Ta(e,t,r,n){e=null;for(var a=t,s=!1;null!==a;){if(!s)if(0!==(524288&a.flags))s=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=a.type;Jr(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===K.current){if(null===(o=a.alternate))throw Error(i(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(dh):e=[dh])}a=a.return}null!==e&&_a(t,e,r,n),t.flags|=262144}function Ea(e){for(e=e.firstContext;null!==e;){if(!Jr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function La(e){ja=e,ka=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pa(e){return Fa(ja,e)}function Oa(e,t){return null===ja&&La(e),Fa(e,t)}function Fa(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===ka){if(null===e)throw Error(i(308));ka=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ka=ka.next=t;return r}var Ia="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ra=n.unstable_scheduleCallback,Da=n.unstable_NormalPriority,Ma={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ba(){return{controller:new Ia,data:new Map,refCount:0}}function Ua(e){e.refCount--,0===e.refCount&&Ra(Da,function(){e.controller.abort()})}var za=null,qa=0,Ha=0,Wa=null;function Va(){if(0===--qa&&null!==za){null!==Wa&&(Wa.status="fulfilled");var e=za;za=null,Ha=0,Wa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ga=F.S;F.S=function(e,t){Oc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===za){var r=za=[];qa=0,Ha=qd(),Wa={status:"pending",value:void 0,then:function(e){r.push(e)}}}qa++,t.then(Va,Va)}(0,t),null!==Ga&&Ga(e,t)};var Ka=B(null);function Ya(){var e=Ka.current;return null!==e?e:mc.pooledCache}function Xa(e,t){z(Ka,null===t?Ka.current:t.pool)}function $a(){var e=Ya();return null===e?null:{parent:Ma._currentValue,pool:e}}var Ja=Error(i(460)),Qa=Error(i(474)),Za=Error(i(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function rs(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(Pt,Pt),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e;default:if("string"===typeof t.status)t.then(Pt,Pt);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e}throw as=t,Ja}}function ns(e){try{return(0,e._init)(e._payload)}catch(ly){if(null!==ly&&"object"===typeof ly&&"function"===typeof ly.then)throw as=ly,Ja;throw ly}}var as=null;function ss(){if(null===as)throw Error(i(459));var e=as;return as=null,e}function is(e){if(e===Ja||e===Za)throw Error(i(483))}var os=null,ls=0;function cs(e){var t=ls;return ls+=1,null===os&&(os=[]),rs(os,e,t)}function ds(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function us(e,t){if(t.$$typeof===m)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hs(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Un(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=67108866,r):n:(t.flags|=67108866,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Wn(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,n){var s=r.type;return s===x?u(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&ns(s)===t.type)?(ds(t=a(t,r.props),r),t.return=e,t):(ds(t=qn(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function d(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Gn(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function u(e,t,r,n,s){return null===t||7!==t.tag?((t=Hn(r,e.mode,n,s)).return=e,t):((t=a(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Wn(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return ds(r=qn(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case g:return(t=Gn(t,e.mode,r)).return=e,t;case A:return h(e,t=ns(t),r)}if(O(t)||E(t))return(t=Hn(t,e.mode,r,null)).return=e,t;if("function"===typeof t.then)return h(e,cs(t),r);if(t.$$typeof===w)return h(e,Oa(e,t),r);us(e,t)}return null}function f(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return r.key===a?c(e,t,r,n):null;case g:return r.key===a?d(e,t,r,n):null;case A:return f(e,t,r=ns(r),n)}if(O(r)||E(r))return null!==a?null:u(e,t,r,n,null);if("function"===typeof r.then)return f(e,t,cs(r),n);if(r.$$typeof===w)return f(e,t,Oa(e,r),n);us(e,r)}return null}function m(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case g:return d(t,e=e.get(null===n.key?r:n.key)||null,n,a);case A:return m(e,t,r,n=ns(n),a)}if(O(n)||E(n))return u(t,e=e.get(r)||null,n,a,null);if("function"===typeof n.then)return m(e,t,r,cs(n),a);if(n.$$typeof===w)return m(e,t,r,Oa(t,n),a);us(t,n)}return null}function b(l,c,d,u){if("object"===typeof d&&null!==d&&d.type===x&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case p:e:{for(var v=d.key;null!==c;){if(c.key===v){if((v=d.type)===x){if(7===c.tag){r(l,c.sibling),(u=a(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===A&&ns(v)===c.type){r(l,c.sibling),ds(u=a(c,d.props),d),u.return=l,l=u;break e}r(l,c);break}t(l,c),c=c.sibling}d.type===x?((u=Hn(d.props.children,l.mode,u,d.key)).return=l,l=u):(ds(u=qn(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return o(l);case g:e:{for(v=d.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){r(l,c.sibling),(u=a(c,d.children||[])).return=l,l=u;break e}r(l,c);break}t(l,c),c=c.sibling}(u=Gn(d,l.mode,u)).return=l,l=u}return o(l);case A:return b(l,c,d=ns(d),u)}if(O(d))return function(a,i,o,l){for(var c=null,d=null,u=i,p=i=0,g=null;null!==u&&p<o.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var x=f(a,u,o[p],l);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(a,u),i=s(x,i,p),null===d?c=x:d.sibling=x,d=x,u=g}if(p===o.length)return r(a,u),ua&&aa(a,p),c;if(null===u){for(;p<o.length;p++)null!==(u=h(a,o[p],l))&&(i=s(u,i,p),null===d?c=u:d.sibling=u,d=u);return ua&&aa(a,p),c}for(u=n(u);p<o.length;p++)null!==(g=m(u,a,p,o[p],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),i=s(g,i,p),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),ua&&aa(a,p),c}(l,c,d,u);if(E(d)){if("function"!==typeof(v=E(d)))throw Error(i(150));return function(a,o,l,c){if(null==l)throw Error(i(151));for(var d=null,u=null,p=o,g=o=0,x=null,b=l.next();null!==p&&!b.done;g++,b=l.next()){p.index>g?(x=p,p=null):x=p.sibling;var v=f(a,p,b.value,c);if(null===v){null===p&&(p=x);break}e&&p&&null===v.alternate&&t(a,p),o=s(v,o,g),null===u?d=v:u.sibling=v,u=v,p=x}if(b.done)return r(a,p),ua&&aa(a,g),d;if(null===p){for(;!b.done;g++,b=l.next())null!==(b=h(a,b.value,c))&&(o=s(b,o,g),null===u?d=b:u.sibling=b,u=b);return ua&&aa(a,g),d}for(p=n(p);!b.done;g++,b=l.next())null!==(b=m(p,a,g,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?g:b.key),o=s(b,o,g),null===u?d=b:u.sibling=b,u=b);return e&&p.forEach(function(e){return t(a,e)}),ua&&aa(a,g),d}(l,c,d=v.call(d),u)}if("function"===typeof d.then)return b(l,c,cs(d),u);if(d.$$typeof===w)return b(l,c,Oa(l,d),u);us(l,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(r(l,c.sibling),(u=a(c,d)).return=l,l=u):(r(l,c),(u=Wn(d,l.mode,u)).return=l,l=u),o(l)):r(l,c)}return function(e,t,r,n){try{ls=0;var a=b(e,t,r,n);return os=null,a}catch(ly){if(ly===Ja||ly===Za)throw ly;var s=Mn(29,ly,null,e.mode);return s.lanes=n,s.return=e,s}}}var fs=hs(!0),ms=hs(!1),ps=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function vs(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&fc)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,t=In(e),Fn(e,null,r),t}return Ln(e,n,t,r),In(e)}function ys(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Fe(e,r)}}function ws(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===s?a=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?a=s=t:s=s.next=t}else a=s=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Ns=!1;function js(){if(Ns){if(null!==Wa)throw Wa}}function ks(e,t,r,n){Ns=!1;var a=e.updateQueue;ps=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(i=0,d=c=l=null,o=s;;){var h=-536870913&o.lane,m=h!==o.lane;if(m?(gc&h)===h:(n&h)===h){0!==h&&h===Ha&&(Ns=!0),null!==d&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,g=o;h=t;var x=r;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){u=p.call(x,u,h);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(x,u,h):p)||void 0===h)break e;u=f({},u,h);break e;case 2:ps=!0}}null!==(h=o.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=a.callbacks)?a.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=m,l=u):d=d.next=m,i|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(m=o).next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null===s&&(a.shared.lanes=0),kc|=i,e.lanes=i,e.memoizedState=u}}function Ss(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function As(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)Ss(r[e],t)}var Cs=B(null),_s=B(0);function Ts(e,t){z(_s,e=Nc),z(Cs,t),Nc=e|t.baseLanes}function Es(){z(_s,Nc),z(Cs,Cs.current)}function Ls(){Nc=_s.current,U(Cs),U(_s)}var Ps=B(null),Os=null;function Fs(e){var t=e.alternate;z(Bs,1&Bs.current),z(Ps,e),null===Os&&(null===t||null!==Cs.current||null!==t.memoizedState)&&(Os=e)}function Is(e){z(Bs,Bs.current),z(Ps,e),null===Os&&(Os=e)}function Rs(e){22===e.tag?(z(Bs,Bs.current),z(Ps,e),null===Os&&(Os=e)):Ds()}function Ds(){z(Bs,Bs.current),z(Ps,Ps.current)}function Ms(e){U(Ps),Os===e&&(Os=null),U(Bs)}var Bs=B(0);function Us(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||Lu(r)||Pu(r)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zs=0,qs=null,Hs=null,Ws=null,Vs=!1,Gs=!1,Ks=!1,Ys=0,Xs=0,$s=null,Js=0;function Qs(){throw Error(i(321))}function Zs(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Jr(e[r],t[r]))return!1;return!0}function ei(e,t,r,n,a,s){return zs=s,qs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,F.H=null===e||null===e.memoizedState?go:xo,Ks=!1,s=r(n,a),Ks=!1,Gs&&(s=ri(t,r,n,a)),ti(e),s}function ti(e){F.H=po;var t=null!==Hs&&null!==Hs.next;if(zs=0,Ws=Hs=qs=null,Vs=!1,Xs=0,$s=null,t)throw Error(i(300));null===e||Oo||null!==(e=e.dependencies)&&Ea(e)&&(Oo=!0)}function ri(e,t,r,n){qs=e;var a=0;do{if(Gs&&($s=null),Xs=0,Gs=!1,25<=a)throw Error(i(301));if(a+=1,Ws=Hs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}F.H=bo,s=t(r,n)}while(Gs);return s}function ni(){var e=F.H,t=e.useState()[0];return t="function"===typeof t.then?ci(t):t,e=e.useState()[0],(null!==Hs?Hs.memoizedState:null)!==e&&(qs.flags|=1024),t}function ai(){var e=0!==Ys;return Ys=0,e}function si(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function ii(e){if(Vs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Vs=!1}zs=0,Ws=Hs=qs=null,Gs=!1,Xs=Ys=0,$s=null}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ws?qs.memoizedState=Ws=e:Ws=Ws.next=e,Ws}function li(){if(null===Hs){var e=qs.alternate;e=null!==e?e.memoizedState:null}else e=Hs.next;var t=null===Ws?qs.memoizedState:Ws.next;if(null!==t)Ws=t,Hs=e;else{if(null===e){if(null===qs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Hs=e).memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},null===Ws?qs.memoizedState=Ws=e:Ws=Ws.next=e}return Ws}function ci(e){var t=Xs;return Xs+=1,null===$s&&($s=[]),e=rs($s,e,t),t=qs,null===(null===Ws?t.memoizedState:Ws.next)&&(t=t.alternate,F.H=null===t||null===t.memoizedState?go:xo),e}function di(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ci(e);if(e.$$typeof===w)return Pa(e)}throw Error(i(438,String(e)))}function ui(e){var t=null,r=qs.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=qs.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=_;return t.index++,r}function hi(e,t){return"function"===typeof t?t(e):t}function fi(e){return mi(li(),Hs,e)}function mi(e,t,r){var n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=r;var a=e.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}t.baseQueue=a=s,n.pending=null}if(s=e.baseState,null===a)e.memoizedState=s;else{var l=o=null,c=null,d=t=a.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(gc&h)===h:(zs&h)===h){var f=d.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Ha&&(u=!0);else{if((zs&f)===f){d=d.next,f===Ha&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,qs.lanes|=f,kc|=f}h=d.action,Ks&&r(s,h),s=d.hasEagerState?d.eagerState:r(s,h)}else f={lane:h,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,qs.lanes|=h,kc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?o=s:c.next=l,!Jr(s,e.memoizedState)&&(Oo=!0,u&&null!==(r=Wa)))throw r;e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}return null===a&&(n.lanes=0),[e.memoizedState,n.dispatch]}function pi(e){var t=li(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(null!==a){r.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);Jr(s,t.memoizedState)||(Oo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function gi(e,t,r){var n=qs,a=li(),s=ua;if(s){if(void 0===r)throw Error(i(407));r=r()}else r=t();var o=!Jr((Hs||a).memoizedState,r);if(o&&(a.memoizedState=r,Oo=!0),a=a.queue,zi(vi.bind(null,n,a,e),[e]),a.getSnapshot!==t||o||null!==Ws&&1&Ws.memoizedState.tag){if(n.flags|=2048,Ri(9,{destroy:void 0},bi.bind(null,n,a,r,t),null),null===mc)throw Error(i(349));s||0!==(127&zs)||xi(n,t,r)}return r}function xi(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=qs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function bi(e,t,r,n){t.value=r,t.getSnapshot=n,yi(t)&&wi(e)}function vi(e,t,r){return r(function(){yi(t)&&wi(e)})}function yi(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Jr(e,r)}catch(n){return!0}}function wi(e){var t=On(e,2);null!==t&&Yc(t,e,2)}function Ni(e){var t=oi();if("function"===typeof e){var r=e;if(e=r(),Ks){ve(!0);try{r()}finally{ve(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:e},t}function ji(e,t,r,n){return e.baseState=r,mi(e,Hs,"function"===typeof n?n:hi)}function ki(e,t,r,n,a){if(ho(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==F.T?r(!0):s.isTransition=!1,n(s),null===(r=t.pending)?(s.next=t.pending=s,Si(t,s)):(s.next=r.next,t.pending=r.next=s)}}function Si(e,t){var r=t.action,n=t.payload,a=e.state;if(t.isTransition){var s=F.T,i={};F.T=i;try{var o=r(a,n),l=F.S;null!==l&&l(i,o),Ai(e,t,o)}catch(c){_i(e,t,c)}finally{null!==s&&null!==i.types&&(s.types=i.types),F.T=s}}else try{Ai(e,t,s=r(a,n))}catch(d){_i(e,t,d)}}function Ai(e,t,r){null!==r&&"object"===typeof r&&"function"===typeof r.then?r.then(function(r){Ci(e,t,r)},function(r){return _i(e,t,r)}):Ci(e,t,r)}function Ci(e,t,r){t.status="fulfilled",t.value=r,Ti(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,Si(e,r)))}function _i(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=r,Ti(t),t=t.next}while(t!==n)}e.action=null}function Ti(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ei(e,t){return t}function Li(e,t){if(ua){var r=mc.formState;if(null!==r){e:{var n=qs;if(ua){if(da){t:{for(var a=da,s=fa;8!==a.nodeType;){if(!s){a=null;break t}if(null===(a=Ou(a.nextSibling))){a=null;break t}}a="F!"===(s=a.data)||"F"===s?a:null}if(a){da=Ou(a.nextSibling),n="F!"===a.data;break e}}pa(n)}n=!1}n&&(t=r[0])}}return(r=oi()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:t},r.queue=n,r=lo.bind(null,qs,n),n.dispatch=r,n=Ni(!1),s=uo.bind(null,qs,!1,n.queue),a={state:t,dispatch:null,action:e,pending:null},(n=oi()).queue=a,r=ki.bind(null,qs,a,s,r),a.dispatch=r,n.memoizedState=e,[t,r,!1]}function Pi(e){return Oi(li(),Hs,e)}function Oi(e,t,r){if(t=mi(e,t,Ei)[0],e=fi(hi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var n=ci(t)}catch(ly){if(ly===Ja)throw Za;throw ly}else n=t;var a=(t=li()).queue,s=a.dispatch;return r!==t.memoizedState&&(qs.flags|=2048,Ri(9,{destroy:void 0},Fi.bind(null,a,r),null)),[n,s,e]}function Fi(e,t){e.action=t}function Ii(e){var t=li(),r=Hs;if(null!==r)return Oi(t,r,e);li(),t=t.memoizedState;var n=(r=li()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function Ri(e,t,r,n){return e={tag:e,create:r,deps:n,inst:t,next:null},null===(t=qs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Di(){return li().memoizedState}function Mi(e,t,r,n){var a=oi();qs.flags|=e,a.memoizedState=Ri(1|t,{destroy:void 0},r,void 0===n?null:n)}function Bi(e,t,r,n){var a=li();n=void 0===n?null:n;var s=a.memoizedState.inst;null!==Hs&&null!==n&&Zs(n,Hs.memoizedState.deps)?a.memoizedState=Ri(t,s,r,n):(qs.flags|=e,a.memoizedState=Ri(1|t,s,r,n))}function Ui(e,t){Mi(8390656,8,e,t)}function zi(e,t){Bi(2048,8,e,t)}function qi(e){var t=li().memoizedState;return function(e){qs.flags|=4;var t=qs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t,t.events=[e];else{var r=t.events;null===r?t.events=[e]:r.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fc))throw Error(i(440));return t.impl.apply(void 0,arguments)}}function Hi(e,t){return Bi(4,2,e,t)}function Wi(e,t){return Bi(4,4,e,t)}function Vi(e,t){if("function"===typeof t){e=e();var r=t(e);return function(){"function"===typeof r?r():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Gi(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Bi(4,4,Vi.bind(null,t,e),r)}function Ki(){}function Yi(e,t){var r=li();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&Zs(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Xi(e,t){var r=li();t=void 0===t?null:t;var n=r.memoizedState;if(null!==t&&Zs(t,n[1]))return n[0];if(n=e(),Ks){ve(!0);try{e()}finally{ve(!1)}}return r.memoizedState=[n,t],n}function $i(e,t,r){return void 0===r||0!==(1073741824&zs)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=r,e=Kc(),qs.lanes|=e,kc|=e,r)}function Ji(e,t,r,n){return Jr(r,t)?r:null!==Cs.current?(e=$i(e,r,n),Jr(e,t)||(Oo=!0),e):0===(42&zs)||0!==(1073741824&zs)&&0===(261930&gc)?(Oo=!0,e.memoizedState=r):(e=Kc(),qs.lanes|=e,kc|=e,t)}function Qi(e,t,r,n,a){var s=I.p;I.p=0!==s&&8>s?s:8;var i=F.T,o={};F.T=o,uo(e,!1,t,r);try{var l=a(),c=F.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var d=function(e,t){var r=[],n={status:"pending",value:null,reason:null,then:function(e){r.push(e)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var e=0;e<r.length;e++)(0,r[e])(t)},function(e){for(n.status="rejected",n.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)}),n}(l,n);co(e,t,d,Gc())}else co(e,t,n,Gc())}catch(u){co(e,t,{then:function(){},status:"rejected",reason:u},Gc())}finally{I.p=s,null!==i&&null!==o.types&&(i.types=o.types),F.T=i}}function Zi(){}function eo(e,t,r,n){if(5!==e.tag)throw Error(i(476));var a=to(e).queue;Qi(e,a,t,R,null===r?Zi:function(){return ro(e),r(n)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:R},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ro(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),co(e,t.next.queue,{},Gc())}function no(){return Pa(dh)}function ao(){return li().memoizedState}function so(){return li().memoizedState}function io(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=Gc(),n=vs(t,e=bs(r),r);return null!==n&&(Yc(n,t,r),ys(n,t,r)),t={cache:Ba()},void(e.payload=t)}t=t.return}}function oo(e,t,r){var n=Gc();r={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ho(e)?fo(t,r):null!==(r=Pn(e,t,r,n))&&(Yc(r,e,n),mo(r,t,n))}function lo(e,t,r){co(e,t,r,Gc())}function co(e,t,r,n){var a={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(ho(e))fo(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Jr(o,i))return Ln(e,t,a,0),null===mc&&En(),!1}catch(l){}if(null!==(r=Pn(e,t,a,n)))return Yc(r,e,n),mo(r,t,n),!0}return!1}function uo(e,t,r,n){if(n={lane:2,revertLane:qd(),gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ho(e)){if(t)throw Error(i(479))}else null!==(t=Pn(e,r,n,2))&&Yc(t,e,2)}function ho(e){var t=e.alternate;return e===qs||null!==t&&t===qs}function fo(e,t){Gs=Vs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function mo(e,t,r){if(0!==(4194048&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Fe(e,r)}}var po={readContext:Pa,use:di,useCallback:Qs,useContext:Qs,useEffect:Qs,useImperativeHandle:Qs,useLayoutEffect:Qs,useInsertionEffect:Qs,useMemo:Qs,useReducer:Qs,useRef:Qs,useState:Qs,useDebugValue:Qs,useDeferredValue:Qs,useTransition:Qs,useSyncExternalStore:Qs,useId:Qs,useHostTransitionStatus:Qs,useFormState:Qs,useActionState:Qs,useOptimistic:Qs,useMemoCache:Qs,useCacheRefresh:Qs};po.useEffectEvent=Qs;var go={readContext:Pa,use:di,useCallback:function(e,t){return oi().memoizedState=[e,void 0===t?null:t],e},useContext:Pa,useEffect:Ui,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Mi(4194308,4,Vi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mi(4194308,4,e,t)},useInsertionEffect:function(e,t){Mi(4,2,e,t)},useMemo:function(e,t){var r=oi();t=void 0===t?null:t;var n=e();if(Ks){ve(!0);try{e()}finally{ve(!1)}}return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=oi();if(void 0!==r){var a=r(t);if(Ks){ve(!0);try{r(t)}finally{ve(!1)}}}else a=t;return n.memoizedState=n.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},n.queue=e,e=e.dispatch=oo.bind(null,qs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},oi().memoizedState=e},useState:function(e){var t=(e=Ni(e)).queue,r=lo.bind(null,qs,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ki,useDeferredValue:function(e,t){return $i(oi(),e,t)},useTransition:function(){var e=Ni(!1);return e=Qi.bind(null,qs,e.queue,!0,!1),oi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var n=qs,a=oi();if(ua){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===mc)throw Error(i(349));0!==(127&gc)||xi(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Ui(vi.bind(null,n,s,e),[e]),n.flags|=2048,Ri(9,{destroy:void 0},bi.bind(null,n,s,r,t),null),r},useId:function(){var e=oi(),t=mc.identifierPrefix;if(ua){var r=na;t="_"+t+"R_"+(r=(ra&~(1<<32-ye(ra)-1)).toString(32)+r),0<(r=Ys++)&&(t+="H"+r.toString(32)),t+="_"}else t="_"+t+"r_"+(r=Js++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:no,useFormState:Li,useActionState:Li,useOptimistic:function(e){var t=oi();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=uo.bind(null,qs,!0,r),r.dispatch=t,[e,t]},useMemoCache:ui,useCacheRefresh:function(){return oi().memoizedState=io.bind(null,qs)},useEffectEvent:function(e){var t=oi(),r={impl:e};return t.memoizedState=r,function(){if(0!==(2&fc))throw Error(i(440));return r.impl.apply(void 0,arguments)}}},xo={readContext:Pa,use:di,useCallback:Yi,useContext:Pa,useEffect:zi,useImperativeHandle:Gi,useInsertionEffect:Hi,useLayoutEffect:Wi,useMemo:Xi,useReducer:fi,useRef:Di,useState:function(){return fi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){return Ji(li(),Hs.memoizedState,e,t)},useTransition:function(){var e=fi(hi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ao,useHostTransitionStatus:no,useFormState:Pi,useActionState:Pi,useOptimistic:function(e,t){return ji(li(),0,e,t)},useMemoCache:ui,useCacheRefresh:so};xo.useEffectEvent=qi;var bo={readContext:Pa,use:di,useCallback:Yi,useContext:Pa,useEffect:zi,useImperativeHandle:Gi,useInsertionEffect:Hi,useLayoutEffect:Wi,useMemo:Xi,useReducer:pi,useRef:Di,useState:function(){return pi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){var r=li();return null===Hs?$i(r,e,t):Ji(r,Hs.memoizedState,e,t)},useTransition:function(){var e=pi(hi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ao,useHostTransitionStatus:no,useFormState:Ii,useActionState:Ii,useOptimistic:function(e,t){var r=li();return null!==Hs?ji(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:ui,useCacheRefresh:so};function vo(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:f({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}bo.useEffectEvent=qi;var yo={enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Gc(),a=bs(n);a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=vs(e,a,n))&&(Yc(t,e,n),ys(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Gc(),a=bs(n);a.tag=1,a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=vs(e,a,n))&&(Yc(t,e,n),ys(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Gc(),n=bs(r);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=vs(e,n,r))&&(Yc(t,e,r),ys(t,e,r))}};function wo(e,t,r,n,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Qr(r,n)||!Qr(a,s))}function No(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&yo.enqueueReplaceState(t,t.state,null)}function jo(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var a in r===t&&(r=f({},r)),e)void 0===r[a]&&(r[a]=e[a]);return r}function ko(e){An(e)}function So(e){console.error(e)}function Ao(e){An(e)}function Co(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function _o(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function To(e,t,r){return(r=bs(r)).tag=3,r.payload={element:null},r.callback=function(){Co(e,t)},r}function Eo(e){return(e=bs(e)).tag=3,e}function Lo(e,t,r,n){var a=r.type.getDerivedStateFromError;if("function"===typeof a){var s=n.value;e.payload=function(){return a(s)},e.callback=function(){_o(t,r,n)}}var i=r.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){_o(t,r,n),"function"!==typeof a&&(null===Rc?Rc=new Set([this]):Rc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var Po=Error(i(461)),Oo=!1;function Fo(e,t,r,n){t.child=null===e?ms(t,null,r,n):fs(t,e.child,r,n)}function Io(e,t,r,n,a){r=r.render;var s=t.ref;if("ref"in n){var i={};for(var o in n)"ref"!==o&&(i[o]=n[o])}else i=n;return La(t),n=ei(e,t,r,i,s,a),o=ai(),null===e||Oo?(ua&&o&&ia(t),t.flags|=1,Fo(e,t,n,a),t.child):(si(e,t,a),al(e,t,a))}function Ro(e,t,r,n,a){if(null===e){var s=r.type;return"function"!==typeof s||Bn(s)||void 0!==s.defaultProps||null!==r.compare?((e=qn(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Do(e,t,s,n,a))}if(s=e.child,!sl(e,a)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:Qr)(i,n)&&e.ref===t.ref)return al(e,t,a)}return t.flags|=1,(e=Un(s,n)).ref=t.ref,e.return=t,t.child=e}function Do(e,t,r,n,a){if(null!==e){var s=e.memoizedProps;if(Qr(s,n)&&e.ref===t.ref){if(Oo=!1,t.pendingProps=n=s,!sl(e,a))return t.lanes=e.lanes,al(e,t,a);0!==(131072&e.flags)&&(Oo=!0)}}return Wo(e,t,r,n,a)}function Mo(e,t,r,n){var a=n.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===n.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|r:r,null!==e){for(n=t.child=e.child,a=0;null!==n;)a=a|n.lanes|n.childLanes,n=n.sibling;n=a&~s}else n=0,t.child=null;return Uo(e,t,s,r,n)}if(0===(536870912&r))return n=t.lanes=536870912,Uo(e,t,null!==s?s.baseLanes|r:r,r,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Xa(0,null!==s?s.cachePool:null),null!==s?Ts(t,s):Es(),Rs(t)}else null!==s?(Xa(0,s.cachePool),Ts(t,s),Ds(),t.memoizedState=null):(null!==e&&Xa(0,null),Es(),Ds());return Fo(e,t,a,r),t.child}function Bo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Uo(e,t,r,n,a){var s=Ya();return s=null===s?null:{parent:Ma._currentValue,pool:s},t.memoizedState={baseLanes:r,cachePool:s},null!==e&&Xa(0,null),Es(),Rs(t),null!==e&&Ta(e,t,n,!0),t.childLanes=a,null}function zo(e,t){return(t=Zo({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function qo(e,t,r){return fs(t,e.child,null,r),(e=zo(t,t.pendingProps)).flags|=2,Ms(t),t.memoizedState=null,e}function Ho(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof r&&"object"!==typeof r)throw Error(i(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function Wo(e,t,r,n,a){return La(t),r=ei(e,t,r,n,void 0,a),n=ai(),null===e||Oo?(ua&&n&&ia(t),t.flags|=1,Fo(e,t,r,a),t.child):(si(e,t,a),al(e,t,a))}function Vo(e,t,r,n,a,s){return La(t),t.updateQueue=null,r=ri(t,n,r,a),ti(e),n=ai(),null===e||Oo?(ua&&n&&ia(t),t.flags|=1,Fo(e,t,r,s),t.child):(si(e,t,s),al(e,t,s))}function Go(e,t,r,n,a){if(La(t),null===t.stateNode){var s=Rn,i=r.contextType;"object"===typeof i&&null!==i&&(s=Pa(i)),s=new r(n,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=yo,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=n,s.state=t.memoizedState,s.refs={},gs(t),i=r.contextType,s.context="object"===typeof i&&null!==i?Pa(i):Rn,s.state=t.memoizedState,"function"===typeof(i=r.getDerivedStateFromProps)&&(vo(t,r,i,n),s.state=t.memoizedState),"function"===typeof r.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&yo.enqueueReplaceState(s,s.state,null),ks(t,n,s,a),js(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=jo(r,o);s.props=l;var c=s.context,d=r.contextType;i=Rn,"object"===typeof d&&null!==d&&(i=Pa(d));var u=r.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&No(t,s,n,i),ps=!1;var h=t.memoizedState;s.state=h,ks(t,n,s,a),js(),c=t.memoizedState,o||h!==c||ps?("function"===typeof u&&(vo(t,r,u,n),c=t.memoizedState),(l=ps||wo(t,r,l,n,h,c,i))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=i,n=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,xs(e,t),d=jo(r,i=t.memoizedProps),s.props=d,u=t.pendingProps,h=s.context,c=r.contextType,l=Rn,"object"===typeof c&&null!==c&&(l=Pa(c)),(c="function"===typeof(o=r.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==u||h!==l)&&No(t,s,n,l),ps=!1,h=t.memoizedState,s.state=h,ks(t,n,s,a),js();var f=t.memoizedState;i!==u||h!==f||ps||null!==e&&null!==e.dependencies&&Ea(e.dependencies)?("function"===typeof o&&(vo(t,r,o,n),f=t.memoizedState),(d=ps||wo(t,r,d,n,h,f,l)||null!==e&&null!==e.dependencies&&Ea(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=l,n=d):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return s=n,Ho(e,t),n=0!==(128&t.flags),s||n?(s=t.stateNode,r=n&&"function"!==typeof r.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&n?(t.child=fs(t,e.child,null,a),t.child=fs(t,null,r,a)):Fo(e,t,r,a),t.memoizedState=s.state,e=t.child):e=al(e,t,a),e}function Ko(e,t,r,n){return va(),t.flags|=256,Fo(e,t,r,n),t.child}var Yo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xo(e){return{baseLanes:e,cachePool:$a()}}function $o(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=Cc),e}function Jo(e,t,r){var n,a=t.pendingProps,s=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&Bs.current)),n&&(s=!0,t.flags&=-129),n=0!==(32&t.flags),t.flags&=-33,null===e){if(ua){if(s?Fs(t):Ds(),(e=da)?null!==(e=null!==(e=Eu(e,fa))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:ra,overflow:na}:null,retryLane:536870912,hydrationErrors:null},(r=Vn(e)).return=t,t.child=r,ca=t,da=null):e=null,null===e)throw pa(t);return Pu(e)?t.lanes=32:t.lanes=536870912,null}var l=a.children;return a=a.fallback,s?(Ds(),l=Zo({mode:"hidden",children:l},s=t.mode),a=Hn(a,s,r,null),l.return=t,a.return=t,l.sibling=a,t.child=l,(a=t.child).memoizedState=Xo(r),a.childLanes=$o(e,n,r),t.memoizedState=Yo,Bo(null,a)):(Fs(t),Qo(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Fs(t),t.flags&=-257,t=el(e,t,r)):null!==t.memoizedState?(Ds(),t.child=e.child,t.flags|=128,t=null):(Ds(),l=a.fallback,s=t.mode,a=Zo({mode:"visible",children:a.children},s),(l=Hn(l,s,r,null)).flags|=2,a.return=t,l.return=t,a.sibling=l,t.child=a,fs(t,e.child,null,r),(a=t.child).memoizedState=Xo(r),a.childLanes=$o(e,n,r),t.memoizedState=Yo,t=Bo(null,a));else if(Fs(t),Pu(l)){if(n=l.nextSibling&&l.nextSibling.dataset)var d=n.dgst;n=d,(a=Error(i(419))).stack="",a.digest=n,wa({value:a,source:null,stack:null}),t=el(e,t,r)}else if(Oo||Ta(e,t,r,!1),n=0!==(r&e.childLanes),Oo||n){if(null!==(n=mc)&&(0!==(a=Ie(n,r))&&a!==c.retryLane))throw c.retryLane=a,On(e,a),Yc(n,e,a),Po;Lu(l)||id(),t=el(e,t,r)}else Lu(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,da=Ou(l.nextSibling),ca=t,ua=!0,ha=null,fa=!1,null!==e&&la(t,e),(t=Qo(t,a.children)).flags|=4096);return t}return s?(Ds(),l=a.fallback,s=t.mode,d=(c=e.child).sibling,(a=Un(c,{mode:"hidden",children:a.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?l=Un(d,l):(l=Hn(l,s,r,null)).flags|=2,l.return=t,a.return=t,a.sibling=l,t.child=a,Bo(null,a),a=t.child,null===(l=e.child.memoizedState)?l=Xo(r):(null!==(s=l.cachePool)?(c=Ma._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=$a(),l={baseLanes:l.baseLanes|r,cachePool:s}),a.memoizedState=l,a.childLanes=$o(e,n,r),t.memoizedState=Yo,Bo(e.child,a)):(Fs(t),e=(r=e.child).sibling,(r=Un(r,{mode:"visible",children:a.children})).return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r)}function Qo(e,t){return(t=Zo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zo(e,t){return(e=Mn(22,e,null,t)).lanes=0,e}function el(e,t,r){return fs(t,e.child,null,r),(e=Qo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ca(e.return,t,r)}function rl(e,t,r,n,a,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a,treeForkCount:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a,i.treeForkCount=s)}function nl(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;n=n.children;var i=Bs.current,o=0!==(2&i);if(o?(i=1&i|2,t.flags|=128):i&=1,z(Bs,i),Fo(e,t,n,r),n=ua?Qn:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,r,t);else if(19===e.tag)tl(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===Us(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),rl(t,!1,a,r,s,n);break;case"backwards":case"unstable_legacy-backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Us(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}rl(t,!0,r,null,s,n);break;case"together":rl(t,!1,null,null,void 0,n);break;default:t.memoizedState=null}return t.child}function al(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),kc|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(Ta(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Un(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Un(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ea(e))}function il(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)Oo=!0;else{if(!sl(e,r)&&0===(128&t.flags))return Oo=!1,function(e,t,r){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),Sa(0,Ma,e.memoizedState.cache),va();break;case 27:case 5:$(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:Sa(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Is(t),null;break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(Fs(t),t.flags|=128,null):0!==(r&t.child.childLanes)?Jo(e,t,r):(Fs(t),null!==(e=al(e,t,r))?e.sibling:null);Fs(t);break;case 19:var a=0!==(128&e.flags);if((n=0!==(r&t.childLanes))||(Ta(e,t,r,!1),n=0!==(r&t.childLanes)),a){if(n)return nl(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),z(Bs,Bs.current),n)break;return null;case 22:return t.lanes=0,Mo(e,t,r,t.pendingProps);case 24:Sa(0,Ma,e.memoizedState.cache)}return al(e,t,r)}(e,t,r);Oo=0!==(131072&e.flags)}else Oo=!1,ua&&0!==(1048576&t.flags)&&sa(t,Qn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var n=t.pendingProps;if(e=ns(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var a=e.$$typeof;if(a===N){t.tag=11,t=Io(null,t,e,n,r);break e}if(a===S){t.tag=14,t=Ro(null,t,e,n,r);break e}}throw t=P(e)||e,Error(i(306,t,""))}Bn(e)?(n=jo(e,n),t.tag=1,t=Go(null,t,e,n,r)):(t.tag=0,t=Wo(null,t,e,n,r))}return t;case 0:return Wo(e,t,t.type,t.pendingProps,r);case 1:return Go(e,t,n=t.type,a=jo(n,t.pendingProps),r);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(i(387));n=t.pendingProps;var s=t.memoizedState;a=s.element,xs(e,t),ks(t,n,null,r);var o=t.memoizedState;if(n=o.cache,Sa(0,Ma,n),n!==s.cache&&_a(t,[Ma],r,!0),js(),n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ko(e,t,n,r);break e}if(n!==a){wa(a=Yn(Error(i(424)),t)),t=Ko(e,t,n,r);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(da=Ou(e.firstChild),ca=t,ua=!0,ha=null,fa=!0,r=ms(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(va(),n===a){t=al(e,t,r);break e}Fo(e,t,n,r)}t=t.child}return t;case 26:return Ho(e,t),null===e?(r=Vu(t.type,null,t.pendingProps,null))?t.memoizedState=r:ua||(r=t.type,e=t.pendingProps,(n=gu(G.current).createElement(r))[ze]=t,n[qe]=e,hu(n,r,e),et(n),t.stateNode=n):t.memoizedState=Vu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&ua&&(n=t.stateNode=Du(t.type,t.pendingProps,G.current),ca=t,fa=!0,a=da,Au(t.type)?(Fu=a,da=Ou(n.firstChild)):da=a),Fo(e,t,t.pendingProps.children,r),Ho(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ua&&((a=n=da)&&(null!==(n=function(e,t,r,n){for(;1===e.nodeType;){var a=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===s)return e}if(null===(e=Ou(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,fa))?(t.stateNode=n,ca=t,da=Ou(n.firstChild),fa=!1,a=!0):a=!1),a||pa(t)),$(t),a=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,n=s.children,vu(a,s)?n=null:null!==o&&vu(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=ei(e,t,ni,null,null,r),dh._currentValue=a),Ho(e,t),Fo(e,t,n,r),t.child;case 6:return null===e&&ua&&((e=r=da)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=Ou(e.nextSibling)))return null}return e}(r,t.pendingProps,fa))?(t.stateNode=r,ca=t,da=null,e=!0):e=!1),e||pa(t)),null;case 13:return Jo(e,t,r);case 4:return Y(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=fs(t,null,n,r):Fo(e,t,n,r),t.child;case 11:return Io(e,t,t.type,t.pendingProps,r);case 7:return Fo(e,t,t.pendingProps,r),t.child;case 8:case 12:return Fo(e,t,t.pendingProps.children,r),t.child;case 10:return n=t.pendingProps,Sa(0,t.type,n.value),Fo(e,t,n.children,r),t.child;case 9:return a=t.type._context,n=t.pendingProps.children,La(t),n=n(a=Pa(a)),t.flags|=1,Fo(e,t,n,r),t.child;case 14:return Ro(e,t,t.type,t.pendingProps,r);case 15:return Do(e,t,t.type,t.pendingProps,r);case 19:return nl(e,t,r);case 31:return function(e,t,r){var n=t.pendingProps,a=0!==(128&t.flags);if(t.flags&=-129,null===e){if(ua){if("hidden"===n.mode)return e=zo(t,n),t.lanes=536870912,Bo(null,e);if(Is(t),(e=da)?null!==(e=null!==(e=Eu(e,fa))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:ra,overflow:na}:null,retryLane:536870912,hydrationErrors:null},(r=Vn(e)).return=t,t.child=r,ca=t,da=null):e=null,null===e)throw pa(t);return t.lanes=536870912,null}return zo(t,n)}var s=e.memoizedState;if(null!==s){var o=s.dehydrated;if(Is(t),a)if(256&t.flags)t.flags&=-257,t=qo(e,t,r);else{if(null===t.memoizedState)throw Error(i(558));t.child=e.child,t.flags|=128,t=null}else if(Oo||Ta(e,t,r,!1),a=0!==(r&e.childLanes),Oo||a){if(null!==(n=mc)&&0!==(o=Ie(n,r))&&o!==s.retryLane)throw s.retryLane=o,On(e,o),Yc(n,e,o),Po;id(),t=qo(e,t,r)}else e=s.treeContext,da=Ou(o.nextSibling),ca=t,ua=!0,ha=null,fa=!1,null!==e&&la(t,e),(t=zo(t,n)).flags|=4096;return t}return(e=Un(e.child,{mode:n.mode,children:n.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,r);case 22:return Mo(e,t,r,t.pendingProps);case 24:return La(t),n=Pa(Ma),null===e?(null===(a=Ya())&&(a=mc,s=Ba(),a.pooledCache=s,s.refCount++,null!==s&&(a.pooledCacheLanes|=r),a=s),t.memoizedState={parent:n,cache:a},gs(t),Sa(0,Ma,a)):(0!==(e.lanes&r)&&(xs(e,t),ks(t,null,null,r),js()),a=e.memoizedState,s=t.memoizedState,a.parent!==n?(a={parent:n,cache:n},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),Sa(0,Ma,n)):(n=s.cache,Sa(0,Ma,n),n!==a.cache&&_a(t,[Ma],r,!0))),Fo(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,r,n,a){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!nd())throw as=es,Qa;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ah(t)){if(!nd())throw as=es,Qa;e.flags|=8192}}function dl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ee():536870912,e.lanes|=t,_c|=t)}function ul(e,t){if(!ua)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=65011712&a.subtreeFlags,n|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function fl(e,t,r){var n=t.pendingProps;switch(oa(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return r=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Aa(Ma),X(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ba(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,ya())),hl(t),null;case 26:var a=t.type,s=t.memoizedState;return null===e?(ol(t),null!==s?(hl(t),cl(t,s)):(hl(t),ll(t,a,0,0,r))):s?s!==e.memoizedState?(ol(t),hl(t),cl(t,s)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==n&&ol(t),hl(t),ll(t,a,0,0,r)),null;case 27:if(J(t),r=G.current,a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if(!n){if(null===t.stateNode)throw Error(i(166));return hl(t),null}e=W.current,ba(t)?ga(t):(e=Du(a,n,r),t.stateNode=e,ol(t))}return hl(t),null;case 5:if(J(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if(!n){if(null===t.stateNode)throw Error(i(166));return hl(t),null}if(s=W.current,ba(t))ga(t);else{var o=gu(G.current);switch(s){case 1:s=o.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:s=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":s=o.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":s=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(s=o.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof n.is?o.createElement("select",{is:n.is}):o.createElement("select"),n.multiple?s.multiple=!0:n.size&&(s.size=n.size);break;default:s="string"===typeof n.is?o.createElement(a,{is:n.is}):o.createElement(a)}}s[ze]=t,s[qe]=n;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)s.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=s;e:switch(hu(s,a,n),a){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&ol(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(e=G.current,ba(t)){if(e=t.stateNode,r=t.memoizedProps,n=null,null!==(a=ca))switch(a.tag){case 27:case 5:n=a.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===r||null!==n&&!0===n.suppressHydrationWarning||cu(e.nodeValue,r)))||pa(t,!0)}else(e=gu(e).createTextNode(n))[ze]=t,t.stateNode=e}return hl(t),null;case 31:if(r=t.memoizedState,null===e||null!==e.memoizedState){if(n=ba(t),null!==r){if(null===e){if(!n)throw Error(i(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(i(557));e[ze]=t}else va(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else r=ya(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return 256&t.flags?(Ms(t),t):(Ms(t),null);if(0!==(128&t.flags))throw Error(i(558))}return hl(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=ba(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[ze]=t}else va(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),a=!1}else a=ya(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(Ms(t),t):(Ms(t),null)}return Ms(t),0!==(128&t.flags)?(t.lanes=r,t):(r=null!==n,e=null!==e&&null!==e.memoizedState,r&&(a=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(a=n.alternate.memoizedState.cachePool.pool),s=null,null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==a&&(n.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),dl(t,t.updateQueue),hl(t),null);case 4:return X(),null===e&&Zd(t.stateNode.containerInfo),hl(t),null;case 10:return Aa(t.type),hl(t),null;case 19:if(U(Bs),null===(n=t.memoizedState))return hl(t),null;if(a=0!==(128&t.flags),null===(s=n.rendering))if(a)ul(n,!1);else{if(0!==jc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Us(e))){for(t.flags|=128,ul(n,!1),e=s.updateQueue,t.updateQueue=e,dl(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)zn(r,e),r=r.sibling;return z(Bs,1&Bs.current|2),ua&&aa(t,n.treeForkCount),t.child}e=e.sibling}null!==n.tail&&le()>Fc&&(t.flags|=128,a=!0,ul(n,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=Us(s))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,dl(t,e),ul(n,!0),null===n.tail&&"hidden"===n.tailMode&&!s.alternate&&!ua)return hl(t),null}else 2*le()-n.renderingStartTime>Fc&&536870912!==r&&(t.flags|=128,a=!0,ul(n,!1),t.lanes=4194304);n.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=n.last)?e.sibling=s:t.child=s,n.last=s)}return null!==n.tail?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=le(),e.sibling=null,r=Bs.current,z(Bs,a?1&r|2:1&r),ua&&aa(t,n.treeForkCount),e):(hl(t),null);case 22:case 23:return Ms(t),Ls(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!==(536870912&r)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(r=t.updateQueue)&&dl(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==r&&(t.flags|=2048),null!==e&&U(Ka),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Aa(Ma),hl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function ml(e,t){switch(oa(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Aa(Ma),X(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(Ms(t),null===t.alternate)throw Error(i(340));va()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Ms(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));va()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(Bs),null;case 4:return X(),null;case 10:return Aa(t.type),null;case 22:case 23:return Ms(t),Ls(),null!==e&&U(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Aa(Ma),null;default:return null}}function pl(e,t){switch(oa(t),t.tag){case 3:Aa(Ma),X();break;case 26:case 27:case 5:J(t);break;case 4:X();break;case 31:null!==t.memoizedState&&Ms(t);break;case 13:Ms(t);break;case 19:U(Bs);break;case 10:Aa(t.type);break;case 22:case 23:Ms(t),Ls(),null!==e&&U(Ka);break;case 24:Aa(Ma)}}function gl(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var a=n.next;r=a;do{if((r.tag&e)===e){n=void 0;var s=r.create,i=r.inst;n=s(),i.destroy=n}r=r.next}while(r!==a)}}catch(o){jd(t,t.return,o)}}function xl(e,t,r){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var s=a.next;n=s;do{if((n.tag&e)===e){var i=n.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,a=t;var l=r,c=o;try{c()}catch(d){jd(a,l,d)}}}n=n.next}while(n!==s)}}catch(d){jd(t,t.return,d)}}function bl(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{As(t,r)}catch(n){jd(e,e.return,n)}}}function vl(e,t,r){r.props=jo(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(n){jd(e,t,n)}}function yl(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"===typeof r?e.refCleanup=r(n):r.current=n}}catch(a){jd(e,t,a)}}function wl(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"===typeof n)try{n()}catch(a){jd(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof r)try{r(null)}catch(s){jd(e,t,s)}else r.current=null}function Nl(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(a){jd(e,e.return,a)}}function jl(e,t,r){try{var n=e.stateNode;!function(e,t,r,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,o=null,l=null,c=null,d=null,u=null;for(m in r){var h=r[m];if(r.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:n.hasOwnProperty(m)||du(e,t,m,null,n,h)}}for(var f in n){var m=n[f];if(h=r[f],n.hasOwnProperty(f)&&(null!=m||null!=h))switch(f){case"type":s=m;break;case"name":a=m;break;case"checked":d=m;break;case"defaultChecked":u=m;break;case"value":o=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:m!==h&&du(e,t,f,m,n,h)}}return void bt(e,o,l,c,d,u,s,a);case"select":for(s in m=o=l=f=null,r)if(c=r[s],r.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":m=c;default:n.hasOwnProperty(s)||du(e,t,s,null,n,c)}for(a in n)if(s=n[a],c=r[a],n.hasOwnProperty(a)&&(null!=s||null!=c))switch(a){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&du(e,t,a,s,n,c)}return t=l,r=o,n=m,void(null!=f?wt(e,!!r,f,!1):!!n!==!!r&&(null!=t?wt(e,!!r,t,!0):wt(e,!!r,r?[]:"",!1)));case"textarea":for(l in m=f=null,r)if(a=r[l],r.hasOwnProperty(l)&&null!=a&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:du(e,t,l,null,n,a)}for(o in n)if(a=n[o],s=r[o],n.hasOwnProperty(o)&&(null!=a||null!=s))switch(o){case"value":f=a;break;case"defaultValue":m=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(i(91));break;default:a!==s&&du(e,t,o,a,n,s)}return void Nt(e,f,m);case"option":for(var p in r)if(f=r[p],r.hasOwnProperty(p)&&null!=f&&!n.hasOwnProperty(p))if("selected"===p)e.selected=!1;else du(e,t,p,null,n,f);for(c in n)if(f=n[c],m=r[c],n.hasOwnProperty(c)&&f!==m&&(null!=f||null!=m))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else du(e,t,c,f,n,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)f=r[g],r.hasOwnProperty(g)&&null!=f&&!n.hasOwnProperty(g)&&du(e,t,g,null,n,f);for(d in n)if(f=n[d],m=r[d],n.hasOwnProperty(d)&&f!==m&&(null!=f||null!=m))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(i(137,t));break;default:du(e,t,d,f,n,m)}return;default:if(_t(t)){for(var x in r)f=r[x],r.hasOwnProperty(x)&&void 0!==f&&!n.hasOwnProperty(x)&&uu(e,t,x,void 0,n,f);for(u in n)f=n[u],m=r[u],!n.hasOwnProperty(u)||f===m||void 0===f&&void 0===m||uu(e,t,u,f,n,m);return}}for(var b in r)f=r[b],r.hasOwnProperty(b)&&null!=f&&!n.hasOwnProperty(b)&&du(e,t,b,null,n,f);for(h in n)f=n[h],m=r[h],!n.hasOwnProperty(h)||f===m||null==f&&null==m||du(e,t,h,f,n,m)}(n,e.type,r,t),n[qe]=t}catch(a){jd(e,e.return,a)}}function kl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Au(e.type)||4===e.tag}function Sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||kl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Au(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Al(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Pt));else if(4!==n&&(27===n&&Au(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(Al(e,t,r),e=e.sibling;null!==e;)Al(e,t,r),e=e.sibling}function Cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&(27===n&&Au(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(Cl(e,t,r),e=e.sibling;null!==e;)Cl(e,t,r),e=e.sibling}function _l(e){var t=e.stateNode,r=e.memoizedProps;try{for(var n=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);hu(t,n,r),t[ze]=e,t[qe]=r}catch(s){jd(e,e.return,s)}}var Tl=!1,El=!1,Ll=!1,Pl="function"===typeof WeakSet?WeakSet:Set,Ol=null;function Fl(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:Yl(e,r),4&n&&gl(5,r);break;case 1:if(Yl(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(i){jd(r,r.return,i)}else{var a=jo(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){jd(r,r.return,o)}}64&n&&bl(r),512&n&&yl(r,r.return);break;case 3:if(Yl(e,r),64&n&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{As(e,t)}catch(i){jd(r,r.return,i)}}break;case 27:null===t&&4&n&&_l(r);case 26:case 5:Yl(e,r),null===t&&4&n&&Nl(r),512&n&&yl(r,r.return);break;case 12:Yl(e,r);break;case 31:Yl(e,r),4&n&&Ul(e,r);break;case 13:Yl(e,r),4&n&&zl(e,r),64&n&&(null!==(e=r.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==r.readyState)t();else{var n=function(){t(),r.removeEventListener("DOMContentLoaded",n)};r.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,r=Cd.bind(null,r))));break;case 22:if(!(n=null!==r.memoizedState||Tl)){t=null!==t&&null!==t.memoizedState||El,a=Tl;var s=El;Tl=n,(El=t)&&!s?$l(e,r,0!==(8772&r.subtreeFlags)):Yl(e,r),Tl=a,El=s}break;case 30:break;default:Yl(e,r)}}function Il(e){var t=e.alternate;null!==t&&(e.alternate=null,Il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Rl=null,Dl=!1;function Ml(e,t,r){for(r=r.child;null!==r;)Bl(e,t,r),r=r.sibling}function Bl(e,t,r){if(be&&"function"===typeof be.onCommitFiberUnmount)try{be.onCommitFiberUnmount(xe,r)}catch(s){}switch(r.tag){case 26:El||wl(r,t),Ml(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:El||wl(r,t);var n=Rl,a=Dl;Au(r.type)&&(Rl=r.stateNode,Dl=!1),Ml(e,t,r),Mu(r.stateNode),Rl=n,Dl=a;break;case 5:El||wl(r,t);case 6:if(n=Rl,a=Dl,Rl=null,Ml(e,t,r),Dl=a,null!==(Rl=n))if(Dl)try{(9===Rl.nodeType?Rl.body:"HTML"===Rl.nodeName?Rl.ownerDocument.body:Rl).removeChild(r.stateNode)}catch(i){jd(r,t,i)}else try{Rl.removeChild(r.stateNode)}catch(i){jd(r,t,i)}break;case 18:null!==Rl&&(Dl?(Cu(9===(e=Rl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),Wh(e)):Cu(Rl,r.stateNode));break;case 4:n=Rl,a=Dl,Rl=r.stateNode.containerInfo,Dl=!0,Ml(e,t,r),Rl=n,Dl=a;break;case 0:case 11:case 14:case 15:xl(2,r,t),El||xl(4,r,t),Ml(e,t,r);break;case 1:El||(wl(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount&&vl(r,t,n)),Ml(e,t,r);break;case 21:Ml(e,t,r);break;case 22:El=(n=El)||null!==r.memoizedState,Ml(e,t,r),El=n;break;default:Ml(e,t,r)}}function Ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wh(e)}catch(r){jd(t,t.return,r)}}}function zl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wh(e)}catch(r){jd(t,t.return,r)}}function ql(e,t){var r=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Pl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Pl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){if(!r.has(t)){r.add(t);var n=_d.bind(null,e,t);t.then(n,n)}})}function Hl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Au(l.type)){Rl=l.stateNode,Dl=!1;break e}break;case 5:Rl=l.stateNode,Dl=!1;break e;case 3:case 4:Rl=l.stateNode.containerInfo,Dl=!0;break e}l=l.return}if(null===Rl)throw Error(i(160));Bl(s,o,a),Rl=null,Dl=!1,null!==(s=a.alternate)&&(s.return=null),a.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Vl(t,e),t=t.sibling}var Wl=null;function Vl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Hl(t,e),Gl(e),4&n&&(xl(3,e,e.return),gl(3,e),xl(5,e,e.return));break;case 1:Hl(t,e),Gl(e),512&n&&(El||null===r||wl(r,r.return)),64&n&&Tl&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?n:r.concat(n))));break;case 26:var a=Wl;if(Hl(t,e),Gl(e),512&n&&(El||null===r||wl(r,r.return)),4&n){var s=null!==r?r.memoizedState:null;if(n=e.memoizedState,null===r)if(null===n)if(null===e.stateNode){e:{n=e.type,r=e.memoizedProps,a=a.ownerDocument||a;t:switch(n){case"title":(!(s=a.getElementsByTagName("title")[0])||s[Ye]||s[ze]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=a.createElement(n),a.head.insertBefore(s,a.querySelector("head > title"))),hu(s,n,r),s[ze]=e,et(s),n=s;break e;case"link":var o=rh("link","href",a).get(n+(r.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&s.getAttribute("rel")===(null==r.rel?null:r.rel)&&s.getAttribute("title")===(null==r.title?null:r.title)&&s.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){o.splice(l,1);break t}hu(s=a.createElement(n),n,r),a.head.appendChild(s);break;case"meta":if(o=rh("meta","content",a).get(n+(r.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&s.getAttribute("name")===(null==r.name?null:r.name)&&s.getAttribute("property")===(null==r.property?null:r.property)&&s.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&s.getAttribute("charset")===(null==r.charSet?null:r.charSet)){o.splice(l,1);break t}hu(s=a.createElement(n),n,r),a.head.appendChild(s);break;default:throw Error(i(468,n))}s[ze]=e,et(s),n=s}e.stateNode=n}else nh(a,e.type,e.stateNode);else e.stateNode=Ju(a,n,e.memoizedProps);else s!==n?(null===s?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):s.count--,null===n?nh(a,e.type,e.stateNode):Ju(a,n,e.memoizedProps)):null===n&&null!==e.stateNode&&jl(e,e.memoizedProps,r.memoizedProps)}break;case 27:Hl(t,e),Gl(e),512&n&&(El||null===r||wl(r,r.return)),null!==r&&4&n&&jl(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Hl(t,e),Gl(e),512&n&&(El||null===r||wl(r,r.return)),32&e.flags){a=e.stateNode;try{kt(a,"")}catch(p){jd(e,e.return,p)}}4&n&&null!=e.stateNode&&jl(e,a=e.memoizedProps,null!==r?r.memoizedProps:a),1024&n&&(Ll=!0);break;case 6:if(Hl(t,e),Gl(e),4&n){if(null===e.stateNode)throw Error(i(162));n=e.memoizedProps,r=e.stateNode;try{r.nodeValue=n}catch(p){jd(e,e.return,p)}}break;case 3:if(th=null,a=Wl,Wl=zu(t.containerInfo),Hl(t,e),Wl=a,Gl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Wh(t.containerInfo)}catch(p){jd(e,e.return,p)}Ll&&(Ll=!1,Kl(e));break;case 4:n=Wl,Wl=zu(e.stateNode.containerInfo),Hl(t,e),Gl(e),Wl=n;break;case 12:default:Hl(t,e),Gl(e);break;case 31:case 19:Hl(t,e),Gl(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,ql(e,n)));break;case 13:Hl(t,e),Gl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==r&&null!==r.memoizedState)&&(Pc=le()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,ql(e,n)));break;case 22:a=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,d=Tl,u=El;if(Tl=d||a,El=u||c,Hl(t,e),El=u,Tl=d,Gl(e),8192&n)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===r||c||Tl||El||Xl(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(s=c.stateNode,a)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){jd(c,c.return,p)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(p){jd(c,c.return,p)}}}else if(18===t.tag){if(null===r){c=t;try{var m=c.stateNode;a?_u(m,!0):_u(c.stateNode,!1)}catch(p){jd(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(r=n.retryQueue)&&(n.retryQueue=null,ql(e,r))));case 30:case 21:}}function Gl(e){var t=e.flags;if(2&t){try{for(var r,n=e.return;null!==n;){if(kl(n)){r=n;break}n=n.return}if(null==r)throw Error(i(160));switch(r.tag){case 27:var a=r.stateNode;Cl(e,Sl(e),a);break;case 5:var s=r.stateNode;32&r.flags&&(kt(s,""),r.flags&=-33),Cl(e,Sl(e),s);break;case 3:case 4:var o=r.stateNode.containerInfo;Al(e,Sl(e),o);break;default:throw Error(i(161))}}catch(l){jd(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Fl(e,t.alternate,t),t=t.sibling}function Xl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:xl(4,t,t.return),Xl(t);break;case 1:wl(t,t.return);var r=t.stateNode;"function"===typeof r.componentWillUnmount&&vl(t,t.return,r),Xl(t);break;case 27:Mu(t.stateNode);case 26:case 5:wl(t,t.return),Xl(t);break;case 22:null===t.memoizedState&&Xl(t);break;default:Xl(t)}e=e.sibling}}function $l(e,t,r){for(r=r&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,a=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:$l(a,s,r),gl(4,s);break;case 1:if($l(a,s,r),"function"===typeof(a=(n=s).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){jd(n,n.return,c)}if(null!==(a=(n=s).updateQueue)){var o=n.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)Ss(l[a],o)}catch(c){jd(n,n.return,c)}}r&&64&i&&bl(s),yl(s,s.return);break;case 27:_l(s);case 26:case 5:$l(a,s,r),r&&null===n&&4&i&&Nl(s),yl(s,s.return);break;case 12:$l(a,s,r);break;case 31:$l(a,s,r),r&&4&i&&Ul(a,s);break;case 13:$l(a,s,r),r&&4&i&&zl(a,s);break;case 22:null===s.memoizedState&&$l(a,s,r),yl(s,s.return);break;case 30:break;default:$l(a,s,r)}t=t.sibling}}function Jl(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Ua(r))}function Ql(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ua(e))}function Zl(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,r,n),t=t.sibling}function ec(e,t,r,n){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,r,n),2048&a&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,r,n);break;case 3:Zl(e,t,r,n),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ua(e)));break;case 12:if(2048&a){Zl(e,t,r,n),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){jd(t,t.return,l)}}else Zl(e,t,r,n);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Zl(e,t,r,n):rc(e,t):2&s._visibility?Zl(e,t,r,n):(s._visibility|=2,tc(e,t,r,n,0!==(10256&t.subtreeFlags)||!1)),2048&a&&Jl(i,t);break;case 24:Zl(e,t,r,n),2048&a&&Ql(t.alternate,t)}}function tc(e,t,r,n,a){for(a=a&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,i=t,o=r,l=n,c=i.flags;switch(i.tag){case 0:case 11:case 15:tc(s,i,o,l,a),gl(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?tc(s,i,o,l,a):rc(s,i):(d._visibility|=2,tc(s,i,o,l,a)),a&&2048&c&&Jl(i.alternate,i);break;case 24:tc(s,i,o,l,a),a&&2048&c&&Ql(i.alternate,i);break;default:tc(s,i,o,l,a)}t=t.sibling}}function rc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,n=t,a=n.flags;switch(n.tag){case 22:rc(r,n),2048&a&&Jl(n.alternate,n);break;case 24:rc(r,n),2048&a&&Ql(n.alternate,n);break;default:rc(r,n)}t=t.sibling}}var nc=8192;function ac(e,t,r){if(e.subtreeFlags&nc)for(e=e.child;null!==e;)sc(e,t,r),e=e.sibling}function sc(e,t,r){switch(e.tag){case 26:ac(e,t,r),e.flags&nc&&null!==e.memoizedState&&function(e,t,r,n){if("stylesheet"===r.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&r.state.loading)){if(null===r.instance){var a=Gu(n.href),s=t.querySelector(Ku(a));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ih.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=s,void et(s);s=t.ownerDocument||t,n=Yu(n),(a=Bu.get(a))&&Zu(n,a),et(s=s.createElement("link"));var i=s;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),hu(s,"link",n),r.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&0===(3&r.state.loading)&&(e.count++,r=ih.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}(r,Wl,e.memoizedState,e.memoizedProps);break;case 5:default:ac(e,t,r);break;case 3:case 4:var n=Wl;Wl=zu(e.stateNode.containerInfo),ac(e,t,r),Wl=n;break;case 22:null===e.memoizedState&&(null!==(n=e.alternate)&&null!==n.memoizedState?(n=nc,nc=16777216,ac(e,t,r),nc=n):ac(e,t,r))}}function ic(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function oc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Ol=n,dc(n,e)}ic(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:oc(e),2048&e.flags&&xl(9,e,e.return);break;case 3:case 12:default:oc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):oc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Ol=n,dc(n,e)}ic(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:xl(8,t,t.return),cc(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function dc(e,t){for(;null!==Ol;){var r=Ol;switch(r.tag){case 0:case 11:case 15:xl(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Ua(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,Ol=n;else e:for(r=e;null!==Ol;){var a=(n=Ol).sibling,s=n.return;if(Il(n),n===r){Ol=null;break e}if(null!==a){a.return=s,Ol=a;break e}Ol=s}}}var uc={getCacheForType:function(e){var t=Pa(Ma),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Pa(Ma).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,fc=0,mc=null,pc=null,gc=0,xc=0,bc=null,vc=!1,yc=!1,wc=!1,Nc=0,jc=0,kc=0,Sc=0,Ac=0,Cc=0,_c=0,Tc=null,Ec=null,Lc=!1,Pc=0,Oc=0,Fc=1/0,Ic=null,Rc=null,Dc=0,Mc=null,Bc=null,Uc=0,zc=0,qc=null,Hc=null,Wc=0,Vc=null;function Gc(){return 0!==(2&fc)&&0!==gc?gc&-gc:null!==F.T?qd():Me()}function Kc(){if(0===Cc)if(0===(536870912&gc)||ua){var e=ke;0===(3932160&(ke<<=1))&&(ke=262144),Cc=e}else Cc=536870912;return null!==(e=Ps.current)&&(e.flags|=32),Cc}function Yc(e,t,r){(e!==mc||2!==xc&&9!==xc)&&null===e.cancelPendingCommit||(td(e,0),Qc(e,gc,Cc,!1)),Pe(e,r),0!==(2&fc)&&e===mc||(e===mc&&(0===(2&fc)&&(Sc|=r),4===jc&&Qc(e,gc,Cc,!1)),Id(e))}function Xc(e,t,r){if(0!==(6&fc))throw Error(i(327));for(var n=!r&&0===(127&t)&&0===(t&e.expiredLanes)||_e(e,t),a=n?function(e,t){var r=fc;fc|=2;var n=ad(),a=sd();mc!==e||gc!==t?(Ic=null,Fc=le()+500,td(e,t)):yc=_e(e,t);e:for(;;)try{if(0!==xc&&null!==pc){t=pc;var s=bc;t:switch(xc){case 1:xc=0,bc=null,hd(e,t,s,1);break;case 2:case 9:if(ts(s)){xc=0,bc=null,ud(t);break}t=function(){2!==xc&&9!==xc||mc!==e||(xc=7),Id(e)},s.then(t,t);break e;case 3:xc=7;break e;case 4:xc=5;break e;case 7:ts(s)?(xc=0,bc=null,ud(t)):(xc=0,bc=null,hd(e,t,s,7));break;case 5:var o=null;switch(pc.tag){case 26:o=pc.memoizedState;case 5:case 27:var l=pc;if(o?ah(o):l.stateNode.complete){xc=0,bc=null;var c=l.sibling;if(null!==c)pc=c;else{var d=l.return;null!==d?(pc=d,fd(d)):pc=null}break t}}xc=0,bc=null,hd(e,t,s,5);break;case 6:xc=0,bc=null,hd(e,t,s,6);break;case 8:ed(),jc=6;break e;default:throw Error(i(462))}}cd();break}catch(u){rd(e,u)}return ka=ja=null,F.H=n,F.A=a,fc=r,null!==pc?0:(mc=null,gc=0,En(),jc)}(e,t):od(e,t,!0),s=n;;){if(0===a){yc&&!n&&Qc(e,t,0,!1);break}if(r=e.current.alternate,!s||Jc(r)){if(2===a){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=Tc;var c=l.current.memoizedState.isDehydrated;if(c&&(td(l,o).flags|=256),2!==(o=od(l,o,!1))){if(wc&&!c){l.errorRecoveryDisabledLanes|=s,Sc|=s,a=4;break e}s=Ec,Ec=a,null!==s&&(null===Ec?Ec=s:Ec.push.apply(Ec,s))}a=o}if(s=!1,2!==a)continue}}if(1===a){td(e,0),Qc(e,t,0,!0);break}e:{switch(n=e,s=a){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Qc(n,t,Cc,!vc);break e;case 2:Ec=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(a=Pc+300-le())){if(Qc(n,t,Cc,!vc),0!==Ce(n,0,!0))break e;Uc=t,n.timeoutHandle=wu($c.bind(null,n,r,Ec,Ic,Lc,t,Cc,Sc,_c,vc,s,"Throttled",-0,0),a)}else $c(n,r,Ec,Ic,Lc,t,Cc,Sc,_c,vc,s,null,-0,0)}break}a=od(e,t,!1),s=!1}Id(e)}function $c(e,t,r,n,a,s,i,o,l,c,d,u,h,f){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||16785408===(16785408&u)){sc(t,s,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pt});var m=(62914560&s)===s?Pc-le():(4194048&s)===s?Oc-le():0;if(m=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var n=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sh&&(sh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,r=performance.getEntriesByType("resource"),n=0;n<r.length;n++){var a=r[n],s=a.transferSize,i=a.initiatorType,o=a.duration;if(s&&o&&fu(i)){for(i=0,o=a.responseEnd,n+=1;n<r.length;n++){var l=r[n],c=l.startTime;if(c>o)break;var d=l.transferSize,u=l.initiatorType;d&&fu(u)&&(i+=d*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--n,t+=8*(s+i)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sh?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(n),clearTimeout(a)}}:null}(u,m),null!==m)return Uc=s,e.cancelPendingCommit=m(pd.bind(null,e,t,s,r,n,a,i,o,l,d,u,null,h,f)),void Qc(e,s,i,!c)}pd(e,t,s,r,n,a,i,o,l)}function Jc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Jr(s(),a))return!1}catch(i){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qc(e,t,r,n){t&=~Ac,t&=~Sc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var a=t;0<a;){var s=31-ye(a),i=1<<s;n[s]=-1,a&=~i}0!==r&&Oe(e,r,t)}function Zc(){return 0!==(6&fc)||(Rd(0,!1),!1)}function ed(){if(null!==pc){if(0===xc)var e=pc.return;else ka=ja=null,ii(e=pc),os=null,ls=0,e=pc;for(;null!==e;)pl(e.alternate,e),e=e.return;pc=null}}function td(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,Nu(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Uc=0,ed(),mc=e,pc=r=Un(e.current,null),gc=t,xc=0,bc=null,vc=!1,yc=_e(e,t),wc=!1,_c=Cc=Ac=Sc=kc=jc=0,Ec=Tc=null,Lc=!1,0!==(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var a=31-ye(n),s=1<<a;t|=e[a],n&=~s}return Nc=t,En(),r}function rd(e,t){qs=null,F.H=po,t===Ja||t===Za?(t=ss(),xc=3):t===Qa?(t=ss(),xc=4):xc=t===Po?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,bc=t,null===pc&&(jc=1,Co(e,Yn(t,e.current)))}function nd(){var e=Ps.current;return null===e||((4194048&gc)===gc?null===Os:((62914560&gc)===gc||0!==(536870912&gc))&&e===Os)}function ad(){var e=F.H;return F.H=po,null===e?po:e}function sd(){var e=F.A;return F.A=uc,e}function id(){jc=4,vc||(4194048&gc)!==gc&&null!==Ps.current||(yc=!0),0===(134217727&kc)&&0===(134217727&Sc)||null===mc||Qc(mc,gc,Cc,!1)}function od(e,t,r){var n=fc;fc|=2;var a=ad(),s=sd();mc===e&&gc===t||(Ic=null,td(e,t)),t=!1;var i=jc;e:for(;;)try{if(0!==xc&&null!==pc){var o=pc,l=bc;switch(xc){case 8:ed(),i=6;break e;case 3:case 2:case 9:case 6:null===Ps.current&&(t=!0);var c=xc;if(xc=0,bc=null,hd(e,o,l,c),r&&yc){i=0;break e}break;default:c=xc,xc=0,bc=null,hd(e,o,l,c)}}ld(),i=jc;break}catch(d){rd(e,d)}return t&&e.shellSuspendCounter++,ka=ja=null,fc=n,F.H=a,F.A=s,null===pc&&(mc=null,gc=0,En()),i}function ld(){for(;null!==pc;)dd(pc)}function cd(){for(;null!==pc&&!ie();)dd(pc)}function dd(e){var t=il(e.alternate,e,Nc);e.memoizedProps=e.pendingProps,null===t?fd(e):pc=t}function ud(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Vo(r,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Vo(r,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:ii(t);default:pl(r,t),t=il(r,t=pc=zn(t,Nc),Nc)}e.memoizedProps=e.pendingProps,null===t?fd(e):pc=t}function hd(e,t,r,n){ka=ja=null,ii(t),os=null,ls=0;var a=t.return;try{if(function(e,t,r,n,a){if(r.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(t=r.alternate)&&Ta(t,r,a,!0),null!==(r=Ps.current)){switch(r.tag){case 31:case 13:return null===Os?id():null===r.alternate&&0===jc&&(jc=3),r.flags&=-257,r.flags|=65536,r.lanes=a,n===es?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([n]):t.add(n),kd(e,n,a)),!1;case 22:return r.flags|=65536,n===es?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([n]):r.add(n),kd(e,n,a)),!1}throw Error(i(435,r.tag))}return kd(e,n,a),id(),!1}if(ua)return null!==(t=Ps.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,n!==ma&&wa(Yn(e=Error(i(422),{cause:n}),r))):(n!==ma&&wa(Yn(t=Error(i(423),{cause:n}),r)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,n=Yn(n,r),ws(e,a=To(e.stateNode,n,a)),4!==jc&&(jc=2)),!1;var s=Error(i(520),{cause:n});if(s=Yn(s,r),null===Tc?Tc=[s]:Tc.push(s),4!==jc&&(jc=2),null===t)return!0;n=Yn(n,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=a&-a,r.lanes|=e,ws(r,e=To(r.stateNode,n,e)),!1;case 1:if(t=r.type,s=r.stateNode,0===(128&r.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Rc||!Rc.has(s))))return r.flags|=65536,a&=-a,r.lanes|=a,Lo(a=Eo(a),e,r,n),ws(r,a),!1}r=r.return}while(null!==r);return!1}(e,a,t,r,gc))return jc=1,Co(e,Yn(r,e.current)),void(pc=null)}catch(s){if(null!==a)throw pc=a,s;return jc=1,Co(e,Yn(r,e.current)),void(pc=null)}32768&t.flags?(ua||1===n?e=!0:yc||0!==(536870912&gc)?e=!1:(vc=e=!0,(2===n||9===n||3===n||6===n)&&(null!==(n=Ps.current)&&13===n.tag&&(n.flags|=16384))),md(t,e)):fd(t)}function fd(e){var t=e;do{if(0!==(32768&t.flags))return void md(t,vc);e=t.return;var r=fl(t.alternate,t,Nc);if(null!==r)return void(pc=r);if(null!==(t=t.sibling))return void(pc=t);pc=t=e}while(null!==t);0===jc&&(jc=5)}function md(e,t){do{var r=ml(e.alternate,e);if(null!==r)return r.flags&=32767,void(pc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(pc=e);pc=e=r}while(null!==e);jc=6,pc=null}function pd(e,t,r,n,a,s,o,l,c){e.cancelPendingCommit=null;do{yd()}while(0!==Dc);if(0!==(6&fc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,r,n,a,s){var i=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=i&~r;0<r;){var d=31-ye(r),u=1<<d;o[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var f=h[d];null!==f&&(f.lane&=-536870913)}r&=~u}0!==n&&Oe(e,n,0),0!==s&&0===a&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,r,s|=Tn,o,l,c),e===mc&&(pc=mc=null,gc=0),Bc=t,Mc=e,Uc=r,zc=s,qc=a,Hc=n,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ae(he,function(){return wd(),null})):(e.callbackNode=null,e.callbackPriority=0),n=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||n){n=F.T,F.T=null,a=I.p,I.p=2,o=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,mu=vh,nn(e=rn(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(g){r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==r||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==n&&3!==h.nodeType||(c=o+n),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++d===a&&(l=o),f===s&&++u===n&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pu={focusedElem:e,selectionRange:r},vh=!1,Ol=t;null!==Ol;)if(e=(t=Ol).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ol=e;else for(;null!==Ol;){switch(s=(t=Ol).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(r=0;r<e.length;r++)(a=e[r]).ref.impl=a.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,r=t,a=s.memoizedProps,s=s.memoizedState,n=r.stateNode;try{var p=jo(r.type,a);e=n.getSnapshotBeforeUpdate(p,s),n.__reactInternalSnapshotBeforeUpdate=e}catch(x){jd(r,r.return,x)}}break;case 3:if(0!==(1024&e))if(9===(r=(e=t.stateNode.containerInfo).nodeType))Tu(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Tu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Ol=e;break}Ol=t.return}}(e,t)}finally{fc=o,I.p=a,F.T=n}}Dc=1,gd(),xd(),bd()}}function gd(){if(1===Dc){Dc=0;var e=Mc,t=Bc,r=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||r){r=F.T,F.T=null;var n=I.p;I.p=2;var a=fc;fc|=4;try{Vl(t,e);var s=pu,i=rn(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&tn(o.ownerDocument.documentElement,o)){if(null!==l&&nn(o)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var u=o.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var f=h.getSelection(),m=o.textContent.length,p=Math.min(l.start,m),g=void 0===l.end?p:Math.min(l.end,m);!f.extend&&p>g&&(i=g,g=p,p=i);var x=en(o,p),b=en(o,g);if(x&&b&&(1!==f.rangeCount||f.anchorNode!==x.node||f.anchorOffset!==x.offset||f.focusNode!==b.node||f.focusOffset!==b.offset)){var v=u.createRange();v.setStart(x.node,x.offset),f.removeAllRanges(),p>g?(f.addRange(v),f.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),f.addRange(v))}}}}for(u=[],f=o;f=f.parentNode;)1===f.nodeType&&u.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<u.length;o++){var y=u[o];y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}vh=!!mu,pu=mu=null}finally{fc=a,I.p=n,F.T=r}}e.current=t,Dc=2}}function xd(){if(2===Dc){Dc=0;var e=Mc,t=Bc,r=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||r){r=F.T,F.T=null;var n=I.p;I.p=2;var a=fc;fc|=4;try{Fl(e,t.alternate,t)}finally{fc=a,I.p=n,F.T=r}}Dc=3}}function bd(){if(4===Dc||3===Dc){Dc=0,oe();var e=Mc,t=Bc,r=Uc,n=Hc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Dc=5:(Dc=0,Bc=Mc=null,vd(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Rc=null),De(r),t=t.stateNode,be&&"function"===typeof be.onCommitFiberRoot)try{be.onCommitFiberRoot(xe,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==n){t=F.T,a=I.p,I.p=2,F.T=null;try{for(var s=e.onRecoverableError,i=0;i<n.length;i++){var o=n[i];s(o.value,{componentStack:o.stack})}}finally{F.T=t,I.p=a}}0!==(3&Uc)&&yd(),Id(e),a=e.pendingLanes,0!==(261930&r)&&0!==(42&a)?e===Vc?Wc++:(Wc=0,Vc=e):Wc=0,Rd(0,!1)}}function vd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ua(t)))}function yd(){return gd(),xd(),bd(),wd()}function wd(){if(5!==Dc)return!1;var e=Mc,t=zc;zc=0;var r=De(Uc),n=F.T,a=I.p;try{I.p=32>r?32:r,F.T=null,r=qc,qc=null;var s=Mc,o=Uc;if(Dc=0,Bc=Mc=null,Uc=0,0!==(6&fc))throw Error(i(331));var l=fc;if(fc|=4,lc(s.current),ec(s,s.current,o,r),fc=l,Rd(0,!1),be&&"function"===typeof be.onPostCommitFiberRoot)try{be.onPostCommitFiberRoot(xe,s)}catch(c){}return!0}finally{I.p=a,F.T=n,vd(e,t)}}function Nd(e,t,r){t=Yn(r,t),null!==(e=vs(e,t=To(e.stateNode,t,2),2))&&(Pe(e,2),Id(e))}function jd(e,t,r){if(3===e.tag)Nd(e,e,r);else for(;null!==t;){if(3===t.tag){Nd(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Rc||!Rc.has(n))){e=Yn(r,e),null!==(n=vs(t,r=Eo(2),2))&&(Lo(r,n,t,e),Pe(n,2),Id(n));break}}t=t.return}}function kd(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new hc;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(wc=!0,a.add(r),e=Sd.bind(null,e,t,r),t.then(e,e))}function Sd(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,mc===e&&(gc&r)===r&&(4===jc||3===jc&&(62914560&gc)===gc&&300>le()-Pc?0===(2&fc)&&td(e,0):Ac|=r,_c===gc&&(_c=0)),Id(e)}function Ad(e,t){0===t&&(t=Ee()),null!==(e=On(e,t))&&(Pe(e,t),Id(e))}function Cd(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ad(e,r)}function _d(e,t){var r=0;switch(e.tag){case 31:case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==n&&n.delete(t),Ad(e,r)}var Td=null,Ed=null,Ld=!1,Pd=!1,Od=!1,Fd=0;function Id(e){e!==Ed&&null===e.next&&(null===Ed?Td=Ed=e:Ed=Ed.next=e),Pd=!0,Ld||(Ld=!0,ku(function(){0!==(6&fc)?ae(de,Dd):Md()}))}function Rd(e,t){if(!Od&&Pd){Od=!0;do{for(var r=!1,n=Td;null!==n;){if(!t)if(0!==e){var a=n.pendingLanes;if(0===a)var s=0;else{var i=n.suspendedLanes,o=n.pingedLanes;s=(1<<31-ye(42|e)+1)-1,s=201326741&(s&=a&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(r=!0,zd(n,s))}else s=gc,0===(3&(s=Ce(n,n===mc?s:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||_e(n,s)||(r=!0,zd(n,s));n=n.next}}while(r);Od=!1}}function Dd(){Md()}function Md(){Pd=Ld=!1;var e=0;0!==Fd&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==yu&&(yu=e,!0);return yu=null,!1}()&&(e=Fd);for(var t=le(),r=null,n=Td;null!==n;){var a=n.next,s=Bd(n,t);0===s?(n.next=null,null===r?Td=a:r.next=a,null===a&&(Ed=r)):(r=n,(0!==e||0!==(3&s))&&(Pd=!0)),n=a}0!==Dc&&5!==Dc||Rd(e,!1),0!==Fd&&(Fd=0)}function Bd(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-ye(s),o=1<<i,l=a[i];-1===l?0!==(o&r)&&0===(o&n)||(a[i]=Te(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(r=gc,r=Ce(e,e===(t=mc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===r||e===t&&(2===xc||9===xc)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&se(n),e.callbackNode=null,e.callbackPriority=0;if(0===(3&r)||_e(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&se(n),De(r)){case 2:case 8:r=ue;break;case 32:default:r=he;break;case 268435456:r=me}return n=Ud.bind(null,e),r=ae(r,n),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&se(n),e.callbackPriority=2,e.callbackNode=null,2}function Ud(e,t){if(0!==Dc&&5!==Dc)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(yd()&&e.callbackNode!==r)return null;var n=gc;return 0===(n=Ce(e,e===mc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Xc(e,n,t),Bd(e,le()),null!=e.callbackNode&&e.callbackNode===r?Ud.bind(null,e):null)}function zd(e,t){if(yd())return null;Xc(e,t,!0)}function qd(){if(0===Fd){var e=Ha;0===e&&(e=je,0===(261888&(je<<=1))&&(je=256)),Fd=e}return Fd}function Hd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Lt(""+e)}function Wd(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var Vd=0;Vd<kn.length;Vd++){var Gd=kn[Vd];Sn(Gd.toLowerCase(),"on"+(Gd[0].toUpperCase()+Gd.slice(1)))}Sn(gn,"onAnimationEnd"),Sn(xn,"onAnimationIteration"),Sn(bn,"onAnimationStart"),Sn("dblclick","onDoubleClick"),Sn("focusin","onFocus"),Sn("focusout","onBlur"),Sn(vn,"onTransitionRun"),Sn(yn,"onTransitionStart"),Sn(wn,"onTransitionCancel"),Sn(Nn,"onTransitionEnd"),at("onMouseEnter",["mouseout","mouseover"]),at("onMouseLeave",["mouseout","mouseover"]),at("onPointerEnter",["pointerout","pointerover"]),at("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kd));function Xd(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(d){An(d)}a.currentTarget=null,s=l}else for(i=0;i<n.length;i++){if(l=(o=n[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(d){An(d)}a.currentTarget=null,s=l}}}}function $d(e,t){var r=t[We];void 0===r&&(r=t[We]=new Set);var n=e+"__bubble";r.has(n)||(eu(t,e,2,!1),r.add(n))}function Jd(e,t,r){var n=0;t&&(n|=4),eu(r,e,n,t)}var Qd="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[Qd]){e[Qd]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Yd.has(t)||Jd(t,!1,e),Jd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qd]||(t[Qd]=!0,Jd("selectionchange",!1,t))}}function eu(e,t,r,n){switch(Ah(t)){case 2:var a=yh;break;case 8:a=wh;break;default:a=Nh}r=a.bind(null,t,r,e),a=void 0,!qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function tu(e,t,r,n,a){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var o=n.stateNode.containerInfo;if(o===a)break;if(4===i)for(i=n.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===a)return;i=i.return}for(;null!==o;){if(null===(i=$e(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){n=s=i;continue e}o=o.parentNode}}n=n.return}Bt(function(){var n=s,a=Ft(r),i=[];e:{var o=jn.get(e);if(void 0!==o){var c=rr,d=e;switch(e){case"keypress":if(0===Yt(r))break e;case"keydown":case"keyup":c=xr;break;case"focusin":d="focus",c=lr;break;case"focusout":d="blur",c=lr;break;case"beforeblur":case"afterblur":c=lr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=or;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vr;break;case gn:case xn:case bn:c=cr;break;case Nn:c=yr;break;case"scroll":case"scrollend":c=ar;break;case"wheel":c=wr;break;case"copy":case"cut":case"paste":c=dr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=br;break;case"toggle":case"beforetoggle":c=Nr}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),f=u?null!==o?o+"Capture":null:o;u=[];for(var m,p=n;null!==p;){var g=p;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===f||null!=(g=Ut(p,f))&&u.push(ru(p,g,m)),h)break;p=p.return}0<u.length&&(o=new c(o,d,null,r,a),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===Ot||!(d=r.relatedTarget||r.fromElement)||!$e(d)&&!d[He])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=n,null!==(d=(d=r.relatedTarget||r.toElement)?$e(d):null)&&(h=l(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=n),c!==d)){if(u=ir,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=br,g="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==c?o:Qe(c),m=null==d?o:Qe(d),(o=new u(g,p+"leave",c,r,a)).target=h,o.relatedTarget=m,g=null,$e(a)===n&&((u=new u(f,p+"enter",d,r,a)).target=m,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(u=au,p=d,m=0,g=f=c;g;g=u(g))m++;g=0;for(var x=p;x;x=u(x))g++;for(;0<m-g;)f=u(f),m--;for(;0<g-m;)p=u(p),g--;for(;m--;){if(f===p||null!==p&&f===p.alternate){u=f;break e}f=u(f),p=u(p)}u=null}else u=null;null!==c&&su(i,o,c,u,!1),null!==d&&null!==h&&su(i,h,d,u,!0)}if("select"===(c=(o=n?Qe(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var b=Ur;else if(Fr(o))if(zr)b=$r;else{b=Yr;var v=Kr}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?n&&_t(n.elementType)&&(b=Ur):b=Xr;switch(b&&(b=b(e,n))?Ir(i,b,r,a):(v&&v(e,o,n),"focusout"===e&&n&&"number"===o.type&&null!=n.memoizedProps.value&&yt(o,"number",o.value)),v=n?Qe(n):window,e){case"focusin":(Fr(v)||"true"===v.contentEditable)&&(sn=v,on=n,ln=null);break;case"focusout":ln=on=sn=null;break;case"mousedown":cn=!0;break;case"contextmenu":case"mouseup":case"dragend":cn=!1,dn(i,r,a);break;case"selectionchange":if(an)break;case"keydown":case"keyup":dn(i,r,a)}var y;if(kr)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Pr?Er(e,r)&&(w="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(w="onCompositionStart");w&&(Cr&&"ko"!==r.locale&&(Pr||"onCompositionStart"!==w?"onCompositionEnd"===w&&Pr&&(y=Kt()):(Vt="value"in(Wt=a)?Wt.value:Wt.textContent,Pr=!0)),0<(v=nu(n,w)).length&&(w=new ur(w,e,null,r,a),i.push({event:w,listeners:v}),y?w.data=y:null!==(y=Lr(r))&&(w.data=y))),(y=Ar?function(e,t){switch(e){case"compositionend":return Lr(t);case"keypress":return 32!==t.which?null:(Tr=!0,_r);case"textInput":return(e=t.data)===_r&&Tr?null:e;default:return null}}(e,r):function(e,t){if(Pr)return"compositionend"===e||!kr&&Er(e,t)?(e=Kt(),Gt=Vt=Wt=null,Pr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(w=nu(n,"onBeforeInput")).length&&(v=new ur("onBeforeInput","beforeinput",null,r,a),i.push({event:v,listeners:w}),v.data=y)),function(e,t,r,n,a){if("submit"===t&&r&&r.stateNode===a){var s=Hd((a[qe]||null).action),i=n.submitter;i&&null!==(t=(t=i[qe]||null)?Hd(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new rr("action","action",null,n,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==Fd){var e=i?Wd(a,i):new FormData(a);eo(r,{pending:!0,data:e,method:a.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Wd(a,i):new FormData(a),eo(r,{pending:!0,data:e,method:a.method,action:s},s,e))},currentTarget:a}]})}}(i,e,n,r,a)}Xd(i,t)})}function ru(e,t,r){return{instance:e,listener:t,currentTarget:r}}function nu(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,s=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===s||(null!=(a=Ut(e,r))&&n.unshift(ru(e,a,s)),null!=(a=Ut(e,t))&&n.push(ru(e,a,s))),3===e.tag)return n;e=e.return}return[]}function au(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function su(e,t,r,n,a){for(var s=t._reactName,i=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===n)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Ut(r,s))&&i.unshift(ru(r,c,l)):a||null!=(c=Ut(r,s))&&i.push(ru(r,c,l))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var iu=/\r\n?/g,ou=/\u0000|\uFFFD/g;function lu(e){return("string"===typeof e?e:""+e).replace(iu,"\n").replace(ou,"")}function cu(e,t){return t=lu(t),lu(e)===t}function du(e,t,r,n,a,s){switch(r){case"children":"string"===typeof n?"body"===t||"textarea"===t&&""===n||kt(e,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==t&&kt(e,""+n);break;case"className":ct(e,"class",n);break;case"tabIndex":ct(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,r,n);break;case"style":Ct(e,n,s);break;case"data":if("object"!==t){ct(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=Lt(""+n),e.setAttribute(r,n);break;case"action":case"formAction":if("function"===typeof n){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===r?("input"!==t&&du(e,t,"name",a.name,a,null),du(e,t,"formEncType",a.formEncType,a,null),du(e,t,"formMethod",a.formMethod,a,null),du(e,t,"formTarget",a.formTarget,a,null)):(du(e,t,"encType",a.encType,a,null),du(e,t,"method",a.method,a,null),du(e,t,"target",a.target,a,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=Lt(""+n),e.setAttribute(r,n);break;case"onClick":null!=n&&(e.onclick=Pt);break;case"onScroll":null!=n&&$d("scroll",e);break;case"onScrollEnd":null!=n&&$d("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(i(61));if(null!=(r=n.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":e.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){e.removeAttribute("xlink:href");break}r=Lt(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""+n):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===n?e.setAttribute(r,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,n):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?e.setAttribute(r,n):e.removeAttribute(r);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?e.removeAttribute(r):e.setAttribute(r,n);break;case"popover":$d("beforetoggle",e),$d("toggle",e),lt(e,"popover",n);break;case"xlinkActuate":dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":dt(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":dt(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":dt(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":dt(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":lt(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&lt(e,r=Tt.get(r)||r,n)}}function uu(e,t,r,n,a,s){switch(r){case"style":Ct(e,n,s);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(i(61));if(null!=(r=n.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=r}}break;case"children":"string"===typeof n?kt(e,n):("number"===typeof n||"bigint"===typeof n)&&kt(e,""+n);break;case"onScroll":null!=n&&$d("scroll",e);break;case"onScrollEnd":null!=n&&$d("scrollend",e);break;case"onClick":null!=n&&(e.onclick=Pt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:rt.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(a=r.endsWith("Capture"),t=r.slice(2,a?r.length-7:void 0),"function"===typeof(s=null!=(s=e[qe]||null)?s[r]:null)&&e.removeEventListener(t,s,a),"function"!==typeof n)?r in e?e[r]=n:!0===n?e.setAttribute(r,""):lt(e,r,n):("function"!==typeof s&&null!==s&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,n,a)))}}function hu(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$d("error",e),$d("load",e);var n,a=!1,s=!1;for(n in r)if(r.hasOwnProperty(n)){var o=r[n];if(null!=o)switch(n){case"src":a=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,n,o,r,null)}}return s&&du(e,t,"srcSet",r.srcSet,r,null),void(a&&du(e,t,"src",r.src,r,null));case"input":$d("invalid",e);var l=n=o=s=null,c=null,d=null;for(a in r)if(r.hasOwnProperty(a)){var u=r[a];if(null!=u)switch(a){case"name":s=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":n=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:du(e,t,a,u,r,null)}}return void vt(e,n,l,c,d,o,s,!1);case"select":for(s in $d("invalid",e),a=o=n=null,r)if(r.hasOwnProperty(s)&&null!=(l=r[s]))switch(s){case"value":n=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:du(e,t,s,l,r,null)}return t=n,r=o,e.multiple=!!a,void(null!=t?wt(e,!!a,t,!1):null!=r&&wt(e,!!a,r,!0));case"textarea":for(o in $d("invalid",e),n=s=a=null,r)if(r.hasOwnProperty(o)&&null!=(l=r[o]))switch(o){case"value":a=l;break;case"defaultValue":s=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:du(e,t,o,l,r,null)}return void jt(e,a,s,n);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(a=r[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else du(e,t,c,a,r,null);return;case"dialog":$d("beforetoggle",e),$d("toggle",e),$d("cancel",e),$d("close",e);break;case"iframe":case"object":$d("load",e);break;case"video":case"audio":for(a=0;a<Kd.length;a++)$d(Kd[a],e);break;case"image":$d("error",e),$d("load",e);break;case"details":$d("toggle",e);break;case"embed":case"source":case"link":$d("error",e),$d("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in r)if(r.hasOwnProperty(d)&&null!=(a=r[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,d,a,r,null)}return;default:if(_t(t)){for(u in r)r.hasOwnProperty(u)&&(void 0!==(a=r[u])&&uu(e,t,u,a,r,void 0));return}}for(l in r)r.hasOwnProperty(l)&&(null!=(a=r[l])&&du(e,t,l,a,r,null))}function fu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var mu=null,pu=null;function gu(e){return 9===e.nodeType?e:e.ownerDocument}function xu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function vu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var yu=null;var wu="function"===typeof setTimeout?setTimeout:void 0,Nu="function"===typeof clearTimeout?clearTimeout:void 0,ju="function"===typeof Promise?Promise:void 0,ku="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ju?function(e){return ju.resolve(null).then(e).catch(Su)}:wu;function Su(e){setTimeout(function(){throw e})}function Au(e){return"head"===e}function Cu(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)||"/&"===r){if(0===n)return e.removeChild(a),void Wh(t);n--}else if("$"===r||"$?"===r||"$~"===r||"$!"===r||"&"===r)n++;else if("html"===r)Mu(e.ownerDocument.documentElement);else if("head"===r){Mu(r=e.ownerDocument.head);for(var s=r.firstChild;s;){var i=s.nextSibling,o=s.nodeName;s[Ye]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===s.rel.toLowerCase()||r.removeChild(s),s=i}}else"body"===r&&Mu(e.ownerDocument.body);r=a}while(r);Wh(t)}function _u(e,t){var r=e;e=0;do{var n=r.nextSibling;if(1===r.nodeType?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",""===r.getAttribute("style")&&r.removeAttribute("style")):3===r.nodeType&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===e)break;e--}else"$"!==r&&"$?"!==r&&"$~"!==r&&"$!"!==r||e++;r=n}while(r)}function Tu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Tu(r),Xe(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function Eu(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Ou(e.nextSibling)))return null}return e}function Lu(e){return"$?"===e.data||"$~"===e.data}function Pu(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Ou(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Fu=null;function Iu(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r||"/&"===r){if(0===t)return Ou(e.nextSibling);t--}else"$"!==r&&"$!"!==r&&"$?"!==r&&"$~"!==r&&"&"!==r||t++}e=e.nextSibling}return null}function Ru(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r||"$~"===r||"&"===r){if(0===t)return e;t--}else"/$"!==r&&"/&"!==r||t++}e=e.previousSibling}return null}function Du(e,t,r){switch(t=gu(r),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Mu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var Bu=new Map,Uu=new Set;function zu(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var qu=I.d;I.d={f:function(){var e=qu.f(),t=Zc();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?ro(t):qu.r(e)},D:function(e){qu.D(e),Wu("dns-prefetch",e,null)},C:function(e,t){qu.C(e,t),Wu("preconnect",e,t)},L:function(e,t,r){qu.L(e,t,r);var n=Hu;if(n&&e&&t){var a='link[rel="preload"][as="'+xt(t)+'"]';"image"===t&&r&&r.imageSrcSet?(a+='[imagesrcset="'+xt(r.imageSrcSet)+'"]',"string"===typeof r.imageSizes&&(a+='[imagesizes="'+xt(r.imageSizes)+'"]')):a+='[href="'+xt(e)+'"]';var s=a;switch(t){case"style":s=Gu(e);break;case"script":s=Xu(e)}Bu.has(s)||(e=f({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Bu.set(s,e),null!==n.querySelector(a)||"style"===t&&n.querySelector(Ku(s))||"script"===t&&n.querySelector($u(s))||(hu(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}},m:function(e,t){qu.m(e,t);var r=Hu;if(r&&e){var n=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+xt(n)+'"][href="'+xt(e)+'"]',s=a;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Xu(e)}if(!Bu.has(s)&&(e=f({rel:"modulepreload",href:e},t),Bu.set(s,e),null===r.querySelector(a))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector($u(s)))return}hu(n=r.createElement("link"),"link",e),et(n),r.head.appendChild(n)}}},X:function(e,t){qu.X(e,t);var r=Hu;if(r&&e){var n=Ze(r).hoistableScripts,a=Xu(e),s=n.get(a);s||((s=r.querySelector($u(a)))||(e=f({src:e,async:!0},t),(t=Bu.get(a))&&eh(e,t),et(s=r.createElement("script")),hu(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(a,s))}},S:function(e,t,r){qu.S(e,t,r);var n=Hu;if(n&&e){var a=Ze(n).hoistableStyles,s=Gu(e);t=t||"default";var i=a.get(s);if(!i){var o={loading:0,preload:null};if(i=n.querySelector(Ku(s)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Bu.get(s))&&Zu(e,r);var l=i=n.createElement("link");et(l),hu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Qu(i,t,n)}i={type:"stylesheet",instance:i,count:1,state:o},a.set(s,i)}}},M:function(e,t){qu.M(e,t);var r=Hu;if(r&&e){var n=Ze(r).hoistableScripts,a=Xu(e),s=n.get(a);s||((s=r.querySelector($u(a)))||(e=f({src:e,async:!0,type:"module"},t),(t=Bu.get(a))&&eh(e,t),et(s=r.createElement("script")),hu(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(a,s))}}};var Hu="undefined"===typeof document?null:document;function Wu(e,t,r){var n=Hu;if(n&&"string"===typeof t&&t){var a=xt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof r&&(a+='[crossorigin="'+r+'"]'),Uu.has(a)||(Uu.add(a),e={rel:e,crossOrigin:r,href:t},null===n.querySelector(a)&&(hu(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}}function Vu(e,t,r,n){var a,s,o,l,c=(c=G.current)?zu(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof r.precedence&&"string"===typeof r.href?(t=Gu(r.href),(n=(r=Ze(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"===typeof r.href&&"string"===typeof r.precedence){e=Gu(r.href);var d=Ze(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Ku(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Bu.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Bu.set(e,r),d||(a=c,s=e,o=r,l=u.state,a.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=a.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),hu(s,"link",o),et(s),a.head.appendChild(s))))),t&&null===n)throw Error(i(528,""));return u}if(t&&null!==n)throw Error(i(529,""));return null;case"script":return t=r.async,"string"===typeof(r=r.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Xu(r),(n=(r=Ze(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Gu(e){return'href="'+xt(e)+'"'}function Ku(e){return'link[rel="stylesheet"]['+e+"]"}function Yu(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Xu(e){return'[src="'+xt(e)+'"]'}function $u(e){return"script[async]"+e}function Ju(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+xt(r.href)+'"]');if(n)return t.instance=n,et(n),n;var a=f({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return et(n=(e.ownerDocument||e).createElement("style")),hu(n,"style",a),Qu(n,r.precedence,e),t.instance=n;case"stylesheet":a=Gu(r.href);var s=e.querySelector(Ku(a));if(s)return t.state.loading|=4,t.instance=s,et(s),s;n=Yu(r),(a=Bu.get(a))&&Zu(n,a),et(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),hu(s,"link",n),t.state.loading|=4,Qu(s,r.precedence,e),t.instance=s;case"script":return s=Xu(r.src),(a=e.querySelector($u(s)))?(t.instance=a,et(a),a):(n=r,(a=Bu.get(s))&&eh(n=f({},r),a),et(a=(e=e.ownerDocument||e).createElement("script")),hu(a,"link",n),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,Qu(n,r.precedence,e));return t.instance}function Qu(e,t,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=n.length?n[n.length-1]:null,s=a,i=0;i<n.length;i++){var o=n[i];if(o.dataset.precedence===t)s=o;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Zu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function rh(e,t,r){if(null===th){var n=new Map,a=th=new Map;a.set(r,n)}else(n=(a=th).get(r))||(n=new Map,a.set(r,n));if(n.has(e))return n;for(n.set(e,null),r=r.getElementsByTagName(e),a=0;a<r.length;a++){var s=r[a];if(!(s[Ye]||s[ze]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=n.get(i);o?o.push(s):n.set(i,[s])}}return n}function nh(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function ah(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sh=0;function ih(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var oh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,oh=new Map,t.forEach(ch,e),oh=null,ih.call(e))}function ch(e,t){if(!(4&t.state.loading)){var r=oh.get(e);if(r)var n=r.get(null);else{r=new Map,oh.set(e,r);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var i=a[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(r.set(i.dataset.precedence,i),n=i)}n&&r.set(null,n)}i=(a=t.instance).getAttribute("data-precedence"),(s=r.get(i)||n)===n&&r.set(null,a),r.set(i,a),this.count++,n=ih.bind(this),a.addEventListener("load",n),a.addEventListener("error",n),s?s.parentNode.insertBefore(a,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var dh={$$typeof:w,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function uh(e,t,r,n,a,s,i,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Le(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Le(0),this.hiddenUpdates=Le(null),this.identifierPrefix=n,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,r,n,a,s,i,o,l,c,d,u){return e=new uh(e,t,r,i,l,c,d,u,o),t=1,!0===s&&(t|=24),s=Mn(3,null,null,t),e.current=s,s.stateNode=e,(t=Ba()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:n,isDehydrated:r,cache:t},gs(s),e}function fh(e){return e?e=Rn:Rn}function mh(e,t,r,n,a,s){a=fh(a),null===n.context?n.context=a:n.pendingContext=a,(n=bs(t)).payload={element:r},null!==(s=void 0===s?null:s)&&(n.callback=s),null!==(r=vs(e,n,t))&&(Yc(r,0,t),ys(r,e,t))}function ph(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function gh(e,t){ph(e,t),(e=e.alternate)&&ph(e,t)}function xh(e){if(13===e.tag||31===e.tag){var t=On(e,67108864);null!==t&&Yc(t,0,67108864),gh(e,67108864)}}function bh(e){if(13===e.tag||31===e.tag){var t=Gc(),r=On(e,t=Re(t));null!==r&&Yc(r,0,t),gh(e,t)}}var vh=!0;function yh(e,t,r,n){var a=F.T;F.T=null;var s=I.p;try{I.p=2,Nh(e,t,r,n)}finally{I.p=s,F.T=a}}function wh(e,t,r,n){var a=F.T;F.T=null;var s=I.p;try{I.p=8,Nh(e,t,r,n)}finally{I.p=s,F.T=a}}function Nh(e,t,r,n){if(vh){var a=jh(n);if(null===a)tu(e,t,n,kh,r),Ih(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return _h=Rh(_h,e,t,r,n,a),!0;case"dragenter":return Th=Rh(Th,e,t,r,n,a),!0;case"mouseover":return Eh=Rh(Eh,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Lh.set(s,Rh(Lh.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Ph.set(s,Rh(Ph.get(s)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Ih(e,n),4&t&&-1<Fh.indexOf(e)){for(;null!==a;){var s=Je(a);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=Ae(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-ye(i);o.entanglements[1]|=l,i&=~l}Id(s),0===(6&fc)&&(Fc=le()+500,Rd(0,!1))}}break;case 31:case 13:null!==(o=On(s,2))&&Yc(o,0,2),Zc(),gh(s,2)}if(null===(s=jh(n))&&tu(e,t,n,kh,r),s===a)break;a=s}null!==a&&n.stopPropagation()}else tu(e,t,n,null,r)}}function jh(e){return Sh(e=Ft(e))}var kh=null;function Sh(e){if(kh=null,null!==(e=$e(e))){var t=l(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=c(t)))return e;e=null}else if(31===r){if(null!==(e=d(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return kh=e,null}function Ah(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case de:return 2;case ue:return 8;case he:case fe:return 32;case me:return 268435456;default:return 32}default:return 32}}var Ch=!1,_h=null,Th=null,Eh=null,Lh=new Map,Ph=new Map,Oh=[],Fh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ih(e,t){switch(e){case"focusin":case"focusout":_h=null;break;case"dragenter":case"dragleave":Th=null;break;case"mouseover":case"mouseout":Eh=null;break;case"pointerover":case"pointerout":Lh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ph.delete(t.pointerId)}}function Rh(e,t,r,n,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=Je(t))&&xh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Dh(e){var t=$e(e.target);if(null!==t){var r=l(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=c(r)))return e.blockedOn=t,void Be(e.priority,function(){bh(r)})}else if(31===t){if(null!==(t=d(r)))return e.blockedOn=t,void Be(e.priority,function(){bh(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Mh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=jh(e.nativeEvent);if(null!==r)return null!==(t=Je(r))&&xh(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Ot=n,r.target.dispatchEvent(n),Ot=null,t.shift()}return!0}function Bh(e,t,r){Mh(e)&&r.delete(t)}function Uh(){Ch=!1,null!==_h&&Mh(_h)&&(_h=null),null!==Th&&Mh(Th)&&(Th=null),null!==Eh&&Mh(Eh)&&(Eh=null),Lh.forEach(Bh),Ph.forEach(Bh)}function zh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ch||(Ch=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Uh)))}var qh=null;function Hh(e){qh!==e&&(qh=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){qh===e&&(qh=null);for(var t=0;t<e.length;t+=3){var r=e[t],n=e[t+1],a=e[t+2];if("function"!==typeof n){if(null===Sh(n||r))continue;break}var s=Je(r);null!==s&&(e.splice(t,3),t-=3,eo(s,{pending:!0,data:a,method:r.method,action:n},n,a))}}))}function Wh(e){function t(t){return zh(t,e)}null!==_h&&zh(_h,e),null!==Th&&zh(Th,e),null!==Eh&&zh(Eh,e),Lh.forEach(t),Ph.forEach(t);for(var r=0;r<Oh.length;r++){var n=Oh[r];n.blockedOn===e&&(n.blockedOn=null)}for(;0<Oh.length&&null===(r=Oh[0]).blockedOn;)Dh(r),null===r.blockedOn&&Oh.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<r.length;n+=3){var a=r[n],s=r[n+1],i=a[qe]||null;if("function"===typeof s)i||Hh(r);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(a=s,i=s[qe]||null)o=i.formAction;else if(null!==Sh(a))continue}else o=i.action;"function"===typeof o?r[n+1]=o:(r.splice(n,3),n-=3),Hh(r)}}}function Vh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),n||setTimeout(r,20)}function r(){if(!n&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var n=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){n=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function Gh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));mh(t.current,Gc(),e,t,null,null)},Kh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),Zc(),t[He]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Me();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Oh.length&&0!==t&&t<Oh[r].priority;r++);Oh.splice(r,0,e),0===r&&Dh(e)}};var Yh=a.version;if("19.2.0"!==Yh)throw Error(i(527,Yh,"19.2.0"));I.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(n=a.return)){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return u(a),e;if(s===n)return u(a),t;s=s.sibling}throw Error(i(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,c=a.child;c;){if(c===r){o=!0,r=a,n=s;break}if(c===n){o=!0,n=a,r=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===r){o=!0,r=s,n=a;break}if(c===n){o=!0,n=s,r=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Xh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{xe=$h.inject(Xh),be=$h}catch(Qh){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var r=!1,n="",a=ko,s=So,l=Ao;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,r,n,null,a,s,l,Vh),e[He]=t.current,Zd(e),new Gh(t)},t.hydrateRoot=function(e,t,r){if(!o(e))throw Error(i(299));var n=!1,a="",s=ko,l=So,c=Ao,d=null;return null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onUncaughtError&&(s=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.formState&&(d=r.formState)),(t=hh(e,1,!0,t,0,n,a,d,s,l,c,Vh)).context=fh(null),r=t.current,(a=bs(n=Re(n=Gc()))).callback=null,vs(r,a,n),r=n,t.current.lanes=r,Pe(t,r),Id(t),e[He]=t.current,Zd(e),new Kh(t)},t.version="19.2.0"},7950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(6672)},8853:(e,t,r)=>{e.exports=r(5896)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var s=Object.create(null);r.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&n;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,r.d(s,i),s}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,n)=>(r.f[n](e,t),t),[])),r.u=e=>"static/js/"+e+"."+{239:"759cdc61",453:"3fa3ea41",455:"8d2787b5",977:"294bee46"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="scanwell_crm:";r.l=(n,a,s,i)=>{if(e[n])e[n].push(a);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",t+s),o.src=n),e[n]=[a];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(f);var a=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(r)),t)return t(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/",(()=>{var e={792:0};r.f.j=(t,n)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var s=new Promise((r,n)=>a=e[t]=[r,n]);n.push(a[2]=s);var i=r.p+r.u(t),o=new Error;r.l(i,n=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,s,i=n[0],o=n[1],l=n[2],c=0;if(i.some(t=>0!==e[t])){for(a in o)r.o(o,a)&&(r.m[a]=o[a]);if(l)l(r)}for(t&&t(n);c<i.length;c++)s=i[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunkscanwell_crm=self.webpackChunkscanwell_crm||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n={};r.r(n),r.d(n,{hasBrowserEnv:()=>$t,hasStandardBrowserEnv:()=>Qt,hasStandardBrowserWebWorkerEnv:()=>Zt,navigator:()=>Jt,origin:()=>er});var a,s=r(5043),i=r.t(s,2),o=r(4391),l=r(7950),c=r.t(l,2);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function f(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,r,n){return void 0===r&&(r=null),d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?x(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function x(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function b(e,t,r,n){void 0===n&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l=a.Pop,c=null,f=x();function x(){return(o.state||{idx:null}).idx}function b(){l=a.Pop;let e=x(),t=null==e?null:e-f;f=e,c&&c({action:l,location:y.location,delta:t})}function v(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,r="string"===typeof e?e:g(e);return r=r.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==f&&(f=0,o.replaceState(d({},o.state,{idx:f}),""));let y={get action(){return l},get location(){return e(s,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(u,b),c=e,()=>{s.removeEventListener(u,b),c=null}},createHref:e=>t(s,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=a.Push;let n=p(y.location,e,t);r&&r(n,e),f=x()+1;let d=m(n,f),u=y.createHref(n);try{o.pushState(d,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;s.location.assign(u)}i&&c&&c({action:l,location:y.location,delta:1})},replace:function(e,t){l=a.Replace;let n=p(y.location,e,t);r&&r(n,e),f=x();let s=m(n,f),d=y.createHref(n);o.replaceState(s,"",d),i&&c&&c({action:l,location:y.location,delta:0})},go:e=>o.go(e)};return y}var v;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(v||(v={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,r){return void 0===r&&(r="/"),w(e,t,r,!1)}function w(e,t,r,n){let a=I(("string"===typeof t?x(t):t).pathname||"/",r);if(null==a)return null;let s=N(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=F(a);i=P(s[o],e,n)}return i}function N(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let a=(e,a,s)=>{let i={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(h(i.relativePath.startsWith(n),'Absolute route path "'+i.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(n.length));let o=U([n,i.relativePath]),l=r.concat(i);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),N(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:L(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of j(e.path))a(e,t,n);else a(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===n.length)return a?[s,""]:[s];let i=j(n.join("/")),o=[];return o.push(...i.map(e=>""===e?s:[s,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const k=/^:[\w-]+$/,S=3,A=2,C=1,_=10,T=-2,E=e=>"*"===e;function L(e,t){let r=e.split("/"),n=r.length;return r.some(E)&&(n+=T),t&&(n+=A),r.filter(e=>!E(e)).reduce((e,t)=>e+(k.test(t)?S:""===t?C:_),n)}function P(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===s?t:t.slice(s.length)||"/",d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&r&&!n[n.length-1].route.index&&(d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:U([s,d.pathname]),pathnameBase:z(U([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=U([s,d.pathnameBase]))}return i}function O(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);f("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let s=new RegExp(a,t?void 0:"i");return[s,n]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=o[r]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[r];return e[n]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:i,pattern:e}}function F(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return f(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function R(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function M(e,t){let r=D(e);return t?r.map((e,t)=>t===r.length-1?e.pathname:e.pathnameBase):r.map(e=>e.pathnameBase)}function B(e,t,r,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=x(e):(a=d({},e),h(!a.pathname||!a.pathname.includes("?"),R("?","pathname","search",a)),h(!a.pathname||!a.pathname.includes("#"),R("#","pathname","hash",a)),h(!a.search||!a.search.includes("#"),R("#","search","hash",a)));let s,i=""===e||""===a.pathname,o=i?"/":a.pathname;if(null==o)s=r;else{let e=t.length-1;if(!n&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:a=""}="string"===typeof e?x(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:q(n),hash:H(a)}}(a,s),c=o&&"/"!==o&&o.endsWith("/"),u=(i||"."===o)&&r.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const U=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",H=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],G=(new Set(V),["get",...V]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K.apply(this,arguments)}const Y=s.createContext(null);const X=s.createContext(null);const J=s.createContext(null);const Q=s.createContext(null);const Z=s.createContext({outlet:null,matches:[],isDataRoute:!1});const ee=s.createContext(null);function te(){return null!=s.useContext(Q)}function re(){return te()||h(!1),s.useContext(Q).location}function ne(e){s.useContext(J).static||s.useLayoutEffect(e)}function ae(){let{isDataRoute:e}=s.useContext(Z);return e?function(){let{router:e}=pe(fe.UseNavigateStable),t=xe(me.UseNavigateStable),r=s.useRef(!1);return ne(()=>{r.current=!0}),s.useCallback(function(n,a){void 0===a&&(a={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,K({fromRouteId:t},a)))},[e,t])}():function(){te()||h(!1);let e=s.useContext(Y),{basename:t,future:r,navigator:n}=s.useContext(J),{matches:a}=s.useContext(Z),{pathname:i}=re(),o=JSON.stringify(M(a,r.v7_relativeSplatPath)),l=s.useRef(!1);return ne(()=>{l.current=!0}),s.useCallback(function(r,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof r)return void n.go(r);let s=B(r,JSON.parse(o),i,"path"===a.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:U([t,s.pathname])),(a.replace?n.replace:n.push)(s,a.state,a)},[t,n,o,i,e])}()}const se=s.createContext(null);function ie(e,t){let{relative:r}=void 0===t?{}:t,{future:n}=s.useContext(J),{matches:a}=s.useContext(Z),{pathname:i}=re(),o=JSON.stringify(M(a,n.v7_relativeSplatPath));return s.useMemo(()=>B(e,JSON.parse(o),i,"path"===r),[e,o,i,r])}function oe(e,t,r,n){te()||h(!1);let{navigator:i}=s.useContext(J),{matches:o}=s.useContext(Z),l=o[o.length-1],c=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let u,f=re();if(t){var m;let e="string"===typeof t?x(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||h(!1),u=e}else u=f;let p=u.pathname||"/",g=p;if("/"!==d){let e=d.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=y(e,{pathname:g});let v=he(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:U([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,r,n);return t&&v?s.createElement(Q.Provider,{value:{location:K({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:a.Pop}},v):v}function le(){let e=function(){var e;let t=s.useContext(ee),r=ge(me.UseRouteError),n=xe(me.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[n]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),r?s.createElement("pre",{style:a},r):null,null)}const ce=s.createElement(le,null);class de extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(Z.Provider,{value:this.props.routeContext},s.createElement(ee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ue(e){let{routeContext:t,match:r,children:n}=e,a=s.useContext(Y);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),s.createElement(Z.Provider,{value:t},n)}function he(e,t,r,n){var a;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===n&&(n=null),null==e){var i;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(i=n)&&i.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let o=e,l=null==(a=r)?void 0:a.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||h(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let s=0;s<o.length;s++){let e=o[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=s),e.route.id){let{loaderData:t,errors:n}=r,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight((e,n,a)=>{let i,u=!1,h=null,f=null;var m;r&&(i=l&&n.route.id?l[n.route.id]:void 0,h=n.route.errorElement||ce,c&&(d<0&&0===a?(m="route-fallback",!1||be[m]||(be[m]=!0),u=!0,f=null):d===a&&(u=!0,f=n.route.hydrateFallbackElement||null)));let p=t.concat(o.slice(0,a+1)),g=()=>{let t;return t=i?h:u?f:n.route.Component?s.createElement(n.route.Component,null):n.route.element?n.route.element:e,s.createElement(ue,{match:n,routeContext:{outlet:e,matches:p,isDataRoute:null!=r},children:t})};return r&&(n.route.ErrorBoundary||n.route.errorElement||0===a)?s.createElement(de,{location:r.location,revalidation:r.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var fe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(fe||{}),me=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(me||{});function pe(e){let t=s.useContext(Y);return t||h(!1),t}function ge(e){let t=s.useContext(X);return t||h(!1),t}function xe(e){let t=function(){let e=s.useContext(Z);return e||h(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||h(!1),r.route.id}const be={};function ve(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function ye(e){let{to:t,replace:r,state:n,relative:a}=e;te()||h(!1);let{future:i,static:o}=s.useContext(J),{matches:l}=s.useContext(Z),{pathname:c}=re(),d=ae(),u=B(t,M(l,i.v7_relativeSplatPath),c,"path"===a),f=JSON.stringify(u);return s.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:a}),[d,f,a,r,n]),null}function we(e){return function(e){let t=s.useContext(Z).outlet;return t?s.createElement(se.Provider,{value:e},t):t}(e.context)}function Ne(e){h(!1)}function je(e){let{basename:t="/",children:r=null,location:n,navigationType:i=a.Pop,navigator:o,static:l=!1,future:c}=e;te()&&h(!1);let d=t.replace(/^\/*/,"/"),u=s.useMemo(()=>({basename:d,navigator:o,static:l,future:K({v7_relativeSplatPath:!1},c)}),[d,c,o,l]);"string"===typeof n&&(n=x(n));let{pathname:f="/",search:m="",hash:p="",state:g=null,key:b="default"}=n,v=s.useMemo(()=>{let e=I(f,d);return null==e?null:{location:{pathname:e,search:m,hash:p,state:g,key:b},navigationType:i}},[d,f,m,p,g,b,i]);return null==v?null:s.createElement(J.Provider,{value:u},s.createElement(Q.Provider,{children:r,value:v}))}function ke(e){let{children:t,location:r}=e;return oe(Se(t),r)}new Promise(()=>{});s.Component;function Se(e,t){void 0===t&&(t=[]);let r=[];return s.Children.forEach(e,(e,n)=>{if(!s.isValidElement(e))return;let a=[...t,n];if(e.type===s.Fragment)return void r.push.apply(r,Se(e.props.children,a));e.type!==Ne&&h(!1),e.props.index&&e.props.children&&h(!1);let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Se(e.props.children,a)),r.push(i)}),r}function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ae.apply(this,arguments)}function Ce(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function _e(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(e=>[r,e]):[[r,n]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Te=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ee=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(K_){}const Le=s.createContext({isTransitioning:!1});new Map;const Pe=i.startTransition;c.flushSync,i.useId;function Oe(e){let{basename:t,children:r,future:n,window:a}=e,i=s.useRef();var o;null==i.current&&(i.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),b(function(e,t){let{pathname:r,search:n,hash:a}=e.location;return p("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:g(t)},null,o)));let l=i.current,[c,d]=s.useState({action:l.action,location:l.location}),{v7_startTransition:u}=n||{},h=s.useCallback(e=>{u&&Pe?Pe(()=>d(e)):d(e)},[d,u]);return s.useLayoutEffect(()=>l.listen(h),[l,h]),s.useEffect(()=>ve(n),[n]),s.createElement(je,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:l,future:n})}const Fe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Re=s.forwardRef(function(e,t){let r,{onClick:n,relative:a,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f}=e,m=Ce(e,Te),{basename:p}=s.useContext(J),x=!1;if("string"===typeof d&&Ie.test(d)&&(r=d,Fe))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),r=I(t.pathname,p);t.origin===e.origin&&null!=r?d=r+t.search+t.hash:x=!0}catch(K_){}let b=function(e,t){let{relative:r}=void 0===t?{}:t;te()||h(!1);let{basename:n,navigator:a}=s.useContext(J),{hash:i,pathname:o,search:l}=ie(e,{relative:r}),c=o;return"/"!==n&&(c="/"===o?n:U([n,o])),a.createHref({pathname:c,search:l,hash:i})}(d,{relative:a}),v=function(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:l}=void 0===t?{}:t,c=ae(),d=re(),u=ie(e,{relative:o});return s.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();let r=void 0!==n?n:g(d)===g(u);c(e,{replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,n,a,r,e,i,o,l])}(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:f});return s.createElement("a",Ae({},m,{href:r||b,onClick:x||i?n:function(e){n&&n(e),e.defaultPrevented||v(e)},ref:t,target:c}))});const De=s.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:n=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:c,children:d}=e,u=Ce(e,Ee),f=ie(l,{relative:u.relative}),m=re(),p=s.useContext(X),{navigator:g,basename:x}=s.useContext(J),b=null!=p&&function(e,t){void 0===t&&(t={});let r=s.useContext(Le);null==r&&h(!1);let{basename:n}=Ue(Me.useViewTransitionState),a=ie(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=I(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=I(r.nextLocation.pathname,n)||r.nextLocation.pathname;return null!=O(a.pathname,o)||null!=O(a.pathname,i)}(f)&&!0===c,v=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,y=m.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(y=y.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&x&&(w=I(w,x)||w);const N="/"!==v&&v.endsWith("/")?v.length-1:v.length;let j,k=y===v||!i&&y.startsWith(v)&&"/"===y.charAt(N),S=null!=w&&(w===v||!i&&w.startsWith(v)&&"/"===w.charAt(v.length)),A={isActive:k,isPending:S,isTransitioning:b},C=k?r:void 0;j="function"===typeof a?a(A):[a,k?"active":null,S?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let _="function"===typeof o?o(A):o;return s.createElement(Re,Ae({},u,{"aria-current":C,className:j,ref:t,style:_,to:l,viewTransition:c}),"function"===typeof d?d(A):d)});var Me,Be;function Ue(e){let t=s.useContext(Y);return t||h(!1),t}function ze(e){let t=s.useRef(_e(e)),r=s.useRef(!1),n=re(),a=s.useMemo(()=>function(e,t){let r=_e(e);return t&&t.forEach((e,n)=>{r.has(n)||t.getAll(n).forEach(e=>{r.append(n,e)})}),r}(n.search,r.current?null:t.current),[n.search]),i=ae(),o=s.useCallback((e,t)=>{const n=_e("function"===typeof e?e(a):e);r.current=!0,i("?"+n,t)},[i,a]);return[a,o]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Me||(Me={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Be||(Be={}));var qe=r(4980);function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach(function(t){(0,qe.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ve(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ge}=Object.prototype,{getPrototypeOf:Ke}=Object,{iterator:Ye,toStringTag:Xe}=Symbol,$e=(Je=Object.create(null),e=>{const t=Ge.call(e);return Je[t]||(Je[t]=t.slice(8,-1).toLowerCase())});var Je;const Qe=e=>(e=e.toLowerCase(),t=>$e(t)===e),Ze=e=>t=>typeof t===e,{isArray:et}=Array,tt=Ze("undefined");function rt(e){return null!==e&&!tt(e)&&null!==e.constructor&&!tt(e.constructor)&&st(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const nt=Qe("ArrayBuffer");const at=Ze("string"),st=Ze("function"),it=Ze("number"),ot=e=>null!==e&&"object"===typeof e,lt=e=>{if("object"!==$e(e))return!1;const t=Ke(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Xe in e)&&!(Ye in e)},ct=Qe("Date"),dt=Qe("File"),ut=Qe("Blob"),ht=Qe("FileList"),ft=Qe("URLSearchParams"),[mt,pt,gt,xt]=["ReadableStream","Request","Response","Headers"].map(Qe);function bt(e,t){let r,n,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),et(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{if(rt(e))return;const n=a?Object.getOwnPropertyNames(e):Object.keys(e),s=n.length;let i;for(r=0;r<s;r++)i=n[r],t.call(null,e[i],i,e)}}function vt(e,t){if(rt(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n,a=r.length;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const yt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,wt=e=>!tt(e)&&e!==yt;const Nt=(jt="undefined"!==typeof Uint8Array&&Ke(Uint8Array),e=>jt&&e instanceof jt);var jt;const kt=Qe("HTMLFormElement"),St=(e=>{let{hasOwnProperty:t}=e;return(e,r)=>t.call(e,r)})(Object.prototype),At=Qe("RegExp"),Ct=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};bt(r,(r,a)=>{let s;!1!==(s=t(r,a,e))&&(n[a]=s||r)}),Object.defineProperties(e,n)};const _t=Qe("AsyncFunction"),Tt=((e,t)=>{return e?setImmediate:t?(r="axios@".concat(Math.random()),n=[],yt.addEventListener("message",e=>{let{source:t,data:a}=e;t===yt&&a===r&&n.length&&n.shift()()},!1),e=>{n.push(e),yt.postMessage(r,"*")}):e=>setTimeout(e);var r,n})("function"===typeof setImmediate,st(yt.postMessage)),Et="undefined"!==typeof queueMicrotask?queueMicrotask.bind(yt):"undefined"!==typeof process&&process.nextTick||Tt,Lt={isArray:et,isArrayBuffer:nt,isBuffer:rt,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||st(e.append)&&("formdata"===(t=$e(e))||"object"===t&&st(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&nt(e.buffer),t},isString:at,isNumber:it,isBoolean:e=>!0===e||!1===e,isObject:ot,isPlainObject:lt,isEmptyObject:e=>{if(!ot(e)||rt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(K_){return!1}},isReadableStream:mt,isRequest:pt,isResponse:gt,isHeaders:xt,isUndefined:tt,isDate:ct,isFile:dt,isBlob:ut,isRegExp:At,isFunction:st,isStream:e=>ot(e)&&st(e.pipe),isURLSearchParams:ft,isTypedArray:Nt,isFileList:ht,forEach:bt,merge:function e(){const{caseless:t,skipUndefined:r}=wt(this)&&this||{},n={},a=(a,s)=>{const i=t&&vt(n,s)||s;lt(n[i])&&lt(a)?n[i]=e(n[i],a):lt(a)?n[i]=e({},a):et(a)?n[i]=a.slice():r&&tt(a)||(n[i]=a)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&bt(arguments[s],a);return n},extend:function(e,t,r){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return bt(t,(t,n)=>{r&&st(t)?e[n]=Ve(t,r):e[n]=t},{allOwnKeys:n}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let a,s,i;const o={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],n&&!n(i,e,t)||o[i]||(t[i]=e[i],o[i]=!0);e=!1!==r&&Ke(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:$e,kindOfTest:Qe,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(et(e))return e;let t=e.length;if(!it(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Ye]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:kt,hasOwnProperty:St,hasOwnProp:St,reduceDescriptors:Ct,freezeMethods:e=>{Ct(e,(t,r)=>{if(st(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];st(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach(e=>{r[e]=!0})};return et(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:vt,global:yt,isContextDefined:wt,isSpecCompliantForm:function(e){return!!(e&&st(e.append)&&"FormData"===e[Xe]&&e[Ye])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(ot(e)){if(t.indexOf(e)>=0)return;if(rt(e))return e;if(!("toJSON"in e)){t[n]=e;const a=et(e)?[]:{};return bt(e,(e,t)=>{const s=r(e,n+1);!tt(s)&&(a[t]=s)}),t[n]=void 0,a}}return e};return r(e,0)},isAsyncFn:_t,isThenable:e=>e&&(ot(e)||st(e))&&st(e.then)&&st(e.catch),setImmediate:Tt,asap:Et,isIterable:e=>null!=e&&st(e[Ye])};function Pt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Lt.inherits(Pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Lt.toJSONObject(this.config),code:this.code,status:this.status}}});const Ot=Pt.prototype,Ft={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ft[e]={value:e}}),Object.defineProperties(Pt,Ft),Object.defineProperty(Ot,"isAxiosError",{value:!0}),Pt.from=(e,t,r,n,a,s)=>{const i=Object.create(Ot);Lt.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const o=e&&e.message?e.message:"Error",l=null==t&&e?e.code:t;return Pt.call(i,o,l,r,n,a),e&&null==i.cause&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",s&&Object.assign(i,s),i};const It=Pt;function Rt(e){return Lt.isPlainObject(e)||Lt.isArray(e)}function Dt(e){return Lt.endsWith(e,"[]")?e.slice(0,-2):e}function Mt(e,t,r){return e?e.concat(t).map(function(e,t){return e=Dt(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}const Bt=Lt.toFlatObject(Lt,{},null,function(e){return/^is[A-Z]/.test(e)});const Ut=function(e,t,r){if(!Lt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=Lt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Lt.isUndefined(t[e])})).metaTokens,a=r.visitor||c,s=r.dots,i=r.indexes,o=(r.Blob||"undefined"!==typeof Blob&&Blob)&&Lt.isSpecCompliantForm(t);if(!Lt.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Lt.isDate(e))return e.toISOString();if(Lt.isBoolean(e))return e.toString();if(!o&&Lt.isBlob(e))throw new It("Blob is not supported. Use a Buffer instead.");return Lt.isArrayBuffer(e)||Lt.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,r,a){let o=e;if(e&&!a&&"object"===typeof e)if(Lt.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(Lt.isArray(e)&&function(e){return Lt.isArray(e)&&!e.some(Rt)}(e)||(Lt.isFileList(e)||Lt.endsWith(r,"[]"))&&(o=Lt.toArray(e)))return r=Dt(r),o.forEach(function(e,n){!Lt.isUndefined(e)&&null!==e&&t.append(!0===i?Mt([r],n,s):null===i?r:r+"[]",l(e))}),!1;return!!Rt(e)||(t.append(Mt(a,r,s),l(e)),!1)}const d=[],u=Object.assign(Bt,{defaultVisitor:c,convertValue:l,isVisitable:Rt});if(!Lt.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!Lt.isUndefined(r)){if(-1!==d.indexOf(r))throw Error("Circular reference detected in "+n.join("."));d.push(r),Lt.forEach(r,function(r,s){!0===(!(Lt.isUndefined(r)||null===r)&&a.call(t,r,Lt.isString(s)?s.trim():s,n,u))&&e(r,n?n.concat(s):[s])}),d.pop()}}(e),t};function zt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function qt(e,t){this._pairs=[],e&&Ut(e,this,t)}const Ht=qt.prototype;Ht.append=function(e,t){this._pairs.push([e,t])},Ht.toString=function(e){const t=e?function(t){return e.call(this,t,zt)}:zt;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Wt=qt;function Vt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Gt(e,t,r){if(!t)return e;const n=r&&r.encode||Vt;Lt.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(s=a?a(t,r):Lt.isURLSearchParams(t)?t.toString():new Wt(t,r).toString(n),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const Kt=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Lt.forEach(this.handlers,function(t){null!==t&&e(t)})}},Yt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Xt={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Wt,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},$t="undefined"!==typeof window&&"undefined"!==typeof document,Jt="object"===typeof navigator&&navigator||void 0,Qt=$t&&(!Jt||["ReactNative","NativeScript","NS"].indexOf(Jt.product)<0),Zt="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,er=$t&&window.location.href||"http://localhost",tr=We(We({},n),Xt);const rr=function(e){function t(e,r,n,a){let s=e[a++];if("__proto__"===s)return!0;const i=Number.isFinite(+s),o=a>=e.length;if(s=!s&&Lt.isArray(n)?n.length:s,o)return Lt.hasOwnProp(n,s)?n[s]=[n[s],r]:n[s]=r,!i;n[s]&&Lt.isObject(n[s])||(n[s]=[]);return t(e,r,n[s],a)&&Lt.isArray(n[s])&&(n[s]=function(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}(n[s])),!i}if(Lt.isFormData(e)&&Lt.isFunction(e.entries)){const r={};return Lt.forEachEntry(e,(e,n)=>{t(function(e){return Lt.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),n,r,0)}),r}return null};const nr={transitional:Yt,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,a=Lt.isObject(e);a&&Lt.isHTMLForm(e)&&(e=new FormData(e));if(Lt.isFormData(e))return n?JSON.stringify(rr(e)):e;if(Lt.isArrayBuffer(e)||Lt.isBuffer(e)||Lt.isStream(e)||Lt.isFile(e)||Lt.isBlob(e)||Lt.isReadableStream(e))return e;if(Lt.isArrayBufferView(e))return e.buffer;if(Lt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ut(e,new tr.classes.URLSearchParams,We({visitor:function(e,t,r,n){return tr.isNode&&Lt.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=Lt.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ut(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||n?(t.setContentType("application/json",!1),function(e,t,r){if(Lt.isString(e))try{return(t||JSON.parse)(e),Lt.trim(e)}catch(K_){if("SyntaxError"!==K_.name)throw K_}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||nr.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(Lt.isResponse(e)||Lt.isReadableStream(e))return e;if(e&&Lt.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e,this.parseReviver)}catch(K_){if(r){if("SyntaxError"===K_.name)throw It.from(K_,It.ERR_BAD_RESPONSE,this,null,this.response);throw K_}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tr.classes.FormData,Blob:tr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Lt.forEach(["delete","get","head","post","put","patch"],e=>{nr.headers[e]={}});const ar=nr,sr=Lt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ir=Symbol("internals");function or(e){return e&&String(e).trim().toLowerCase()}function lr(e){return!1===e||null==e?e:Lt.isArray(e)?e.map(lr):String(e)}function cr(e,t,r,n,a){return Lt.isFunction(n)?n.call(this,t,r):(a&&(t=r),Lt.isString(t)?Lt.isString(n)?-1!==t.indexOf(n):Lt.isRegExp(n)?n.test(t):void 0:void 0)}class dr{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function a(e,t,r){const a=or(t);if(!a)throw new Error("header name must be a non-empty string");const s=Lt.findKey(n,a);(!s||void 0===n[s]||!0===r||void 0===r&&!1!==n[s])&&(n[s||t]=lr(e))}const s=(e,t)=>Lt.forEach(e,(e,r)=>a(e,r,t));if(Lt.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Lt.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let r,n,a;return e&&e.split("\n").forEach(function(e){a=e.indexOf(":"),r=e.substring(0,a).trim().toLowerCase(),n=e.substring(a+1).trim(),!r||t[r]&&sr[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t})(e),t);else if(Lt.isObject(e)&&Lt.isIterable(e)){let r,n,a={};for(const t of e){if(!Lt.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[n=t[0]]=(r=a[n])?Lt.isArray(r)?[...r,t[1]]:[r,t[1]]:t[1]}s(a,t)}else null!=e&&a(t,e,r);return this}get(e,t){if(e=or(e)){const r=Lt.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(Lt.isFunction(t))return t.call(this,e,r);if(Lt.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=or(e)){const r=Lt.findKey(this,e);return!(!r||void 0===this[r]||t&&!cr(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function a(e){if(e=or(e)){const a=Lt.findKey(r,e);!a||t&&!cr(0,r[a],a,t)||(delete r[a],n=!0)}}return Lt.isArray(e)?e.forEach(a):a(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const a=t[r];e&&!cr(0,this[a],a,e,!0)||(delete this[a],n=!0)}return n}normalize(e){const t=this,r={};return Lt.forEach(this,(n,a)=>{const s=Lt.findKey(r,a);if(s)return t[s]=lr(n),void delete t[a];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}(a):String(a).trim();i!==a&&delete t[a],t[i]=lr(n),r[i]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Lt.forEach(this,(r,n)=>{null!=r&&!1!==r&&(t[n]=e&&Lt.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,r]=e;return t+": "+r}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[ir]=this[ir]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=or(e);t[n]||(!function(e,t){const r=Lt.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(e,r,a){return this[n].call(this,t,e,r,a)},configurable:!0})})}(r,e),t[n]=!0)}return Lt.isArray(e)?e.forEach(n):n(e),this}}dr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Lt.reduceDescriptors(dr.prototype,(e,t)=>{let{value:r}=e,n=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(e){this[n]=e}}}),Lt.freezeMethods(dr);const ur=dr;function hr(e,t){const r=this||ar,n=t||r,a=ur.from(n.headers);let s=n.data;return Lt.forEach(e,function(e){s=e.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function fr(e){return!(!e||!e.__CANCEL__)}function mr(e,t,r){It.call(this,null==e?"canceled":e,It.ERR_CANCELED,t,r),this.name="CanceledError"}Lt.inherits(mr,It,{__CANCEL__:!0});const pr=mr;function gr(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new It("Request failed with status code "+r.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}const xr=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a,s=0,i=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),c=n[i];a||(a=l),r[s]=o,n[s]=l;let d=i,u=0;for(;d!==s;)u+=r[d++],d%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),l-a<t)return;const h=c&&l-c;return h?Math.round(1e3*u/h):void 0}};const br=function(e,t){let r,n,a=0,s=1e3/t;const i=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=s,r=null,n&&(clearTimeout(n),n=null),e(...t)};return[function(){const e=Date.now(),t=e-a;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t>=s?i(l,e):(r=l,n||(n=setTimeout(()=>{n=null,i(r)},s-t)))},()=>r&&i(r)]},vr=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=0;const a=xr(50,250);return br(r=>{const s=r.loaded,i=r.lengthComputable?r.total:void 0,o=s-n,l=a(o);n=s;e({loaded:s,total:i,progress:i?s/i:void 0,bytes:o,rate:l||void 0,estimated:l&&i&&s<=i?(i-s)/l:void 0,event:r,lengthComputable:null!=i,[t?"download":"upload"]:!0})},r)},yr=(e,t)=>{const r=null!=e;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},wr=e=>function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Lt.asap(()=>e(...r))},Nr=tr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,tr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(tr.origin),tr.navigator&&/(msie|trident)/i.test(tr.navigator.userAgent)):()=>!0,jr=tr.hasStandardBrowserEnv?{write(e,t,r,n,a,s){const i=[e+"="+encodeURIComponent(t)];Lt.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),Lt.isString(n)&&i.push("path="+n),Lt.isString(a)&&i.push("domain="+a),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function kr(e,t,r){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(n||0==r)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Sr=e=>e instanceof ur?We({},e):e;function Ar(e,t){t=t||{};const r={};function n(e,t,r,n){return Lt.isPlainObject(e)&&Lt.isPlainObject(t)?Lt.merge.call({caseless:n},e,t):Lt.isPlainObject(t)?Lt.merge({},t):Lt.isArray(t)?t.slice():t}function a(e,t,r,a){return Lt.isUndefined(t)?Lt.isUndefined(e)?void 0:n(void 0,e,0,a):n(e,t,0,a)}function s(e,t){if(!Lt.isUndefined(t))return n(void 0,t)}function i(e,t){return Lt.isUndefined(t)?Lt.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function o(r,a,s){return s in t?n(r,a):s in e?n(void 0,r):void 0}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(e,t,r)=>a(Sr(e),Sr(t),0,!0)};return Lt.forEach(Object.keys(We(We({},e),t)),function(n){const s=l[n]||a,i=s(e[n],t[n],n);Lt.isUndefined(i)&&s!==o||(r[n]=i)}),r}const Cr=e=>{const t=Ar({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:o}=t;if(t.headers=i=ur.from(i),t.url=Gt(kr(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Lt.isFormData(r))if(tr.hasStandardBrowserEnv||tr.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Lt.isFunction(r.getHeaders)){const e=r.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[r,n]=e;t.includes(r.toLowerCase())&&i.set(r,n)})}if(tr.hasStandardBrowserEnv&&(n&&Lt.isFunction(n)&&(n=n(t)),n||!1!==n&&Nr(t.url))){const e=a&&s&&jr.read(s);e&&i.set(a,e)}return t},_r="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,r){const n=Cr(e);let a=n.data;const s=ur.from(n.headers).normalize();let i,o,l,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:f}=n;function m(){c&&c(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(i),n.signal&&n.signal.removeEventListener("abort",i)}let p=new XMLHttpRequest;function g(){if(!p)return;const n=ur.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());gr(function(e){t(e),m()},function(e){r(e),m()},{data:u&&"text"!==u&&"json"!==u?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p}),p=null}p.open(n.method.toUpperCase(),n.url,!0),p.timeout=n.timeout,"onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(g)},p.onabort=function(){p&&(r(new It("Request aborted",It.ECONNABORTED,e,p)),p=null)},p.onerror=function(t){const n=t&&t.message?t.message:"Network Error",a=new It(n,It.ERR_NETWORK,e,p);a.event=t||null,r(a),p=null},p.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const a=n.transitional||Yt;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),r(new It(t,a.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,e,p)),p=null},void 0===a&&s.setContentType(null),"setRequestHeader"in p&&Lt.forEach(s.toJSON(),function(e,t){p.setRequestHeader(t,e)}),Lt.isUndefined(n.withCredentials)||(p.withCredentials=!!n.withCredentials),u&&"json"!==u&&(p.responseType=n.responseType),f&&([l,d]=vr(f,!0),p.addEventListener("progress",l)),h&&p.upload&&([o,c]=vr(h),p.upload.addEventListener("progress",o),p.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(i=t=>{p&&(r(!t||t.type?new pr(null,e,p):t),p.abort(),p=null)},n.cancelToken&&n.cancelToken.subscribe(i),n.signal&&(n.signal.aborted?i():n.signal.addEventListener("abort",i)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);x&&-1===tr.protocols.indexOf(x)?r(new It("Unsupported protocol "+x+":",It.ERR_BAD_REQUEST,e)):p.send(a||null)})},Tr=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,n=new AbortController;const a=function(e){if(!r){r=!0,i();const t=e instanceof Error?e:this.reason;n.abort(t instanceof It?t:new pr(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,a(new It("timeout ".concat(t," of ms exceeded"),It.ETIMEDOUT))},t);const i=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)}),e=null)};e.forEach(e=>e.addEventListener("abort",a));const{signal:o}=n;return o.unsubscribe=()=>Lt.asap(i),o}};function Er(e,t){this.v=e,this.k=t}function Lr(e){return function(){return new Pr(e.apply(this,arguments))}}function Pr(e){var t,r;function n(t,r){try{var s=e[t](r),i=s.value,o=i instanceof Er;Promise.resolve(o?i.v:i).then(function(r){if(o){var l="return"===t?"return":"next";if(!i.k||r.done)return n(l,r);r=e[l](r).value}a(s.done?"return":"normal",r)},function(e){n("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,a){return new Promise(function(s,i){var o={key:e,arg:a,resolve:s,reject:i,next:null};r?r=r.next=o:(t=r=o,n(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function Or(e){return new Er(e,0)}function Fr(e){var t={},r=!1;function n(t,n){return r=!0,n=new Promise(function(r){r(e[t](n))}),{done:!1,value:new Er(n,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):n("return",e)}),t}function Ir(e){var t,r,n,a=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);a--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new Rr(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Rr(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Rr=function(e){this.s=e,this.n=e.next},Rr.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new Rr(e)}Pr.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Pr.prototype.next=function(e){return this._invoke("next",e)},Pr.prototype.throw=function(e){return this._invoke("throw",e)},Pr.prototype.return=function(e){return this._invoke("return",e)};const Dr=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let n,a=0;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},Mr=function(){var e=Lr(function*(e,t){var r,n=!1,a=!1;try{for(var s,i=Ir(Br(e));n=!(s=yield Or(i.next())).done;n=!1){const e=s.value;yield*Fr(Ir(Dr(e,t)))}}catch(o){a=!0,r=o}finally{try{n&&null!=i.return&&(yield Or(i.return()))}finally{if(a)throw r}}});return function(t,r){return e.apply(this,arguments)}}(),Br=function(){var e=Lr(function*(e){if(e[Symbol.asyncIterator])return void(yield*Fr(Ir(e)));const t=e.getReader();try{for(;;){const{done:e,value:r}=yield Or(t.read());if(e)break;yield r}}finally{yield Or(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),Ur=(e,t,r,n)=>{const a=Mr(e,t);let s,i=0,o=e=>{s||(s=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await a.next();if(t)return o(),void e.close();let s=n.byteLength;if(r){let e=i+=s;r(e)}e.enqueue(new Uint8Array(n))}catch(t){throw o(t),t}},cancel:e=>(o(e),a.return())},{highWaterMark:2})},{isFunction:zr}=Lt,qr=(e=>{let{Request:t,Response:r}=e;return{Request:t,Response:r}})(Lt.global),{ReadableStream:Hr,TextEncoder:Wr}=Lt.global,Vr=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return!!e(...r)}catch(K_){return!1}},Gr=e=>{e=Lt.merge.call({skipUndefined:!0},qr,e);const{fetch:t,Request:r,Response:n}=e,a=t?zr(t):"function"===typeof fetch,s=zr(r),i=zr(n);if(!a)return!1;const o=a&&zr(Hr),l=a&&("function"===typeof Wr?(e=>t=>e.encode(t))(new Wr):async e=>new Uint8Array(await new r(e).arrayBuffer())),c=s&&o&&Vr(()=>{let e=!1;const t=new r(tr.origin,{body:new Hr,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),d=i&&o&&Vr(()=>Lt.isReadableStream(new n("").body)),u={stream:d&&(e=>e.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!u[e]&&(u[e]=(t,r)=>{let n=t&&t[e];if(n)return n.call(t);throw new It("Response type '".concat(e,"' is not supported"),It.ERR_NOT_SUPPORT,r)})});const h=async(e,t)=>{const n=Lt.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(Lt.isBlob(e))return e.size;if(Lt.isSpecCompliantForm(e)){const t=new r(tr.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Lt.isArrayBufferView(e)||Lt.isArrayBuffer(e)?e.byteLength:(Lt.isURLSearchParams(e)&&(e+=""),Lt.isString(e)?(await l(e)).byteLength:void 0)})(t):n};return async e=>{let{url:a,method:i,data:o,signal:l,cancelToken:f,timeout:m,onDownloadProgress:p,onUploadProgress:g,responseType:x,headers:b,withCredentials:v="same-origin",fetchOptions:y}=Cr(e),w=t||fetch;x=x?(x+"").toLowerCase():"text";let N=Tr([l,f&&f.toAbortSignal()],m),j=null;const k=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let S;try{if(g&&c&&"get"!==i&&"head"!==i&&0!==(S=await h(b,o))){let e,t=new r(a,{method:"POST",body:o,duplex:"half"});if(Lt.isFormData(o)&&(e=t.headers.get("content-type"))&&b.setContentType(e),t.body){const[e,r]=yr(S,vr(wr(g)));o=Ur(t.body,65536,e,r)}}Lt.isString(v)||(v=v?"include":"omit");const t=s&&"credentials"in r.prototype,l=We(We({},y),{},{signal:N,method:i.toUpperCase(),headers:b.normalize().toJSON(),body:o,duplex:"half",credentials:t?v:void 0});j=s&&new r(a,l);let f=await(s?w(j,y):w(a,l));const m=d&&("stream"===x||"response"===x);if(d&&(p||m&&k)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=f[t]});const t=Lt.toFiniteNumber(f.headers.get("content-length")),[r,a]=p&&yr(t,vr(wr(p),!0))||[];f=new n(Ur(f.body,65536,r,()=>{a&&a(),k&&k()}),e)}x=x||"text";let A=await u[Lt.findKey(u,x)||"text"](f,e);return!m&&k&&k(),await new Promise((t,r)=>{gr(t,r,{data:A,headers:ur.from(f.headers),status:f.status,statusText:f.statusText,config:e,request:j})})}catch(A){if(k&&k(),A&&"TypeError"===A.name&&/Load failed|fetch/i.test(A.message))throw Object.assign(new It("Network Error",It.ERR_NETWORK,e,j),{cause:A.cause||A});throw It.from(A,A&&A.code,e,j)}}},Kr=new Map,Yr=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let i,o,l=s.length,c=Kr;for(;l--;)i=s[l],o=c.get(i),void 0===o&&c.set(i,o=l?new Map:Gr(t)),c=o;return o},Xr=(Yr(),{http:null,xhr:_r,fetch:{get:Yr}});Lt.forEach(Xr,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(K_){}Object.defineProperty(e,"adapterName",{value:t})}});const $r=e=>"- ".concat(e),Jr=e=>Lt.isFunction(e)||null===e||!1===e,Qr=(e,t)=>{e=Lt.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let i=0;i<r;i++){let r;if(n=e[i],a=n,!Jr(n)&&(a=Xr[(r=String(n)).toLowerCase()],void 0===a))throw new It("Unknown adapter '".concat(r,"'"));if(a&&(Lt.isFunction(a)||(a=a.get(t))))break;s[r||"#"+i]=a}if(!a){const e=Object.entries(s).map(e=>{let[t,r]=e;return"adapter ".concat(t," ")+(!1===r?"is not supported by the environment":"is not available in the build")});let t=r?e.length>1?"since :\n"+e.map($r).join("\n"):" "+$r(e[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return a};function Zr(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new pr(null,e)}function en(e){Zr(e),e.headers=ur.from(e.headers),e.data=hr.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Qr(e.adapter||ar.adapter,e)(e).then(function(t){return Zr(e),t.data=hr.call(e,e.transformResponse,t),t.headers=ur.from(t.headers),t},function(t){return fr(t)||(Zr(e),t&&t.response&&(t.response.data=hr.call(e,e.transformResponse,t.response),t.response.headers=ur.from(t.response.headers))),Promise.reject(t)})}const tn="1.12.2",rn={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{rn[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const nn={};rn.transitional=function(e,t,r){function n(e,t){return"[Axios v"+tn+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,a,s)=>{if(!1===e)throw new It(n(a," has been removed"+(t?" in "+t:"")),It.ERR_DEPRECATED);return t&&!nn[a]&&(nn[a]=!0,console.warn(n(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,a,s)}},rn.spelling=function(e){return(t,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};const an={assertOptions:function(e,t,r){if("object"!==typeof e)throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],i=t[s];if(i){const t=e[s],r=void 0===t||i(t,s,e);if(!0!==r)throw new It("option "+s+" must be "+r,It.ERR_BAD_OPTION_VALUE);continue}if(!0!==r)throw new It("Unknown option "+s,It.ERR_BAD_OPTION)}},validators:rn},sn=an.validators;class on{constructor(e){this.defaults=e||{},this.interceptors={request:new Kt,response:new Kt}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{r.stack?t&&!String(r.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(r.stack+="\n"+t):r.stack=t}catch(K_){}}throw r}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Ar(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:a}=t;void 0!==r&&an.assertOptions(r,{silentJSONParsing:sn.transitional(sn.boolean),forcedJSONParsing:sn.transitional(sn.boolean),clarifyTimeoutError:sn.transitional(sn.boolean)},!1),null!=n&&(Lt.isFunction(n)?t.paramsSerializer={serialize:n}:an.assertOptions(n,{encode:sn.function,serialize:sn.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),an.assertOptions(t,{baseUrl:sn.spelling("baseURL"),withXsrfToken:sn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=a&&Lt.merge(a.common,a[t.method]);a&&Lt.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=ur.concat(s,a);const i=[];let o=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,u=0;if(!o){const e=[en.bind(this),void 0];for(e.unshift(...i),e.push(...l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=i.length;let h=t;for(;u<d;){const e=i[u++],t=i[u++];try{h=e(h)}catch(f){t.call(this,f);break}}try{c=en.call(this,h)}catch(f){return Promise.reject(f)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return Gt(kr((e=Ar(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Lt.forEach(["delete","get","head","options"],function(e){on.prototype[e]=function(t,r){return this.request(Ar(r||{},{method:e,url:t,data:(r||{}).data}))}}),Lt.forEach(["post","put","patch"],function(e){function t(t){return function(r,n,a){return this.request(Ar(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}on.prototype[e]=t(),on.prototype[e+"Form"]=t(!0)});const ln=on;class cn{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t;const n=new Promise(e=>{r.subscribe(e),t=e}).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e(function(e,n,a){r.reason||(r.reason=new pr(e,n,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new cn(function(t){e=t});return{token:t,cancel:e}}}const dn=cn;const un={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(un).forEach(e=>{let[t,r]=e;un[r]=t});const hn=un;const fn=function e(t){const r=new ln(t),n=Ve(ln.prototype.request,r);return Lt.extend(n,ln.prototype,r,{allOwnKeys:!0}),Lt.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return e(Ar(t,r))},n}(ar);fn.Axios=ln,fn.CanceledError=pr,fn.CancelToken=dn,fn.isCancel=fr,fn.VERSION=tn,fn.toFormData=Ut,fn.AxiosError=It,fn.Cancel=fn.CanceledError,fn.all=function(e){return Promise.all(e)},fn.spread=function(e){return function(t){return e.apply(null,t)}},fn.isAxiosError=function(e){return Lt.isObject(e)&&!0===e.isAxiosError},fn.mergeConfig=Ar,fn.AxiosHeaders=ur,fn.formToJSON=e=>rr(Lt.isHTMLForm(e)?new FormData(e):e),fn.getAdapter=Qr,fn.HttpStatusCode=hn,fn.default=fn;const mn=fn,pn="https://crm.scanwellapps.com/api",gn=mn.create({baseURL:pn,withCredentials:!0});var xn=r(579);const bn=(0,s.createContext)(),vn=e=>{let{children:t}=e;const[r,n]=(0,s.useState)(null),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(!0),c=async e=>{try{const t=await gn.get("/auth/info/".concat(e));console.log("this is permission: ",t),i(t.data)}catch(t){i(null)}finally{l(!1)}};(0,s.useEffect)(()=>{(async()=>{try{const e=await gn.get("/auth/me");n({id:e.data.id,username:e.data.username,isAuthenticated:!0}),c(e.data.id)}catch(e){n(null)}finally{l(!1)}})()},[]);return(0,xn.jsx)(bn.Provider,{value:{user:r,login:e=>{n(We(We({},e),{},{isAuthenticated:!0}))},logout:()=>{n(null),window.location.href="/login"},loading:o,permission:a},children:t})},yn=()=>{const{user:e,loading:t}=(0,s.useContext)(bn);return console.log("ProtectedRoute:",{user:e,loading:t}),t?(0,xn.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),(0,xn.jsx)("p",{className:"text-xl font-semibold text-blue-800",children:"Loading your dashboard..."})]})}):e?(0,xn.jsx)(we,{}):(0,xn.jsx)(ye,{to:"/login",replace:!0})},wn=r.p+"static/media/logo.2605e2b8067f593472b6.png",Nn=r.p+"static/media/app_logo.47e8e89d0a34644ec486.png";function jn(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const kn=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},Sn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var An={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Cn=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],_n=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:l,iconNode:c}=e,d=jn(e,Cn);return(0,s.createElement)("svg",We(We(We({ref:t},An),{},{width:n,height:n,stroke:r,strokeWidth:i?24*Number(a)/Number(n):a,className:Sn("lucide",o)},!l&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"}),d),[...c.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(l)?l:[l]])}),Tn=["className"],En=(e,t)=>{const r=(0,s.forwardRef)((r,n)=>{let{className:a}=r,i=jn(r,Tn);return(0,s.createElement)(_n,We({ref:n,iconNode:t,className:Sn("lucide-".concat((o=kn(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),a)},i));var o});return r.displayName=kn(e),r},Ln=En("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Pn=En("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),On=En("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),Fn=En("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),In=En("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),Rn=async e=>(await mn.get("".concat(pn,"/UserRole/employee-details/").concat(e))).data,Dn={fetchUserRoles:async()=>(await mn.get("".concat(pn,"/UserRole/user-roles"))).data,fetchUserRoleById:async e=>(await mn.get("".concat(pn,"/UserRole/user-roles/").concat(e))).data,createUserRole:async e=>(await mn.post("".concat(pn,"/UserRole/user-roles"),e)).data,updateUserRole:async(e,t)=>(await mn.put("".concat(pn,"/UserRole/user-roles/").concat(e),t)).data,deleteUserRole:async e=>(await mn.delete("".concat(pn,"/UserRole/user-roles/").concat(e))).data,fetchUserDetailsByRoleID:Rn};const Mn=function(e){let{onMenuToggle:t,isMobileMenuOpen:r}=e;const[n,a]=(0,s.useState)(!1),[i,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)(null),d=(0,s.useRef)(null),{user:u}=(0,s.useContext)(bn);(0,s.useEffect)(()=>{console.log("Current user in header:",u),h(u.id)},[u]);const h=async e=>{try{const t=await Rn(e);console.log("Fetched user data:",t),t&&t.length>0&&c(t[0])}catch(t){console.error("Error fetching user details:",t)}},f=()=>{var e,t;if(!l)return"K";return((null===(e=l.firstName)||void 0===e?void 0:e.charAt(0).toUpperCase())||"")+((null===(t=l.lastName)||void 0===t?void 0:t.charAt(0).toUpperCase())||"")};return(0,s.useEffect)(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&o(!1)};return i&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[i]),(0,xn.jsxs)("header",{className:"fixed top-0 left-0 right-0 w-full h-14 bg-white/95 backdrop-blur-md border-b border-slate-200 flex items-center justify-between px-4 md:px-6 z-50 shadow-sm",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-slate-100 transition-all duration-200 active:scale-95","aria-label":r?"Close menu":"Open menu",children:r?(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-600"}):(0,xn.jsx)(Pn,{className:"w-5 h-5 text-slate-600"})}),(0,xn.jsx)("div",{className:"flex items-center",children:(0,xn.jsx)("img",{src:Nn,alt:"Company Logo",className:"h-12 w-auto transition-transform hover:scale-105"})})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,xn.jsxs)("div",{className:"relative group",children:[(0,xn.jsx)("button",{onClick:()=>a(!n),className:"p-2 rounded-lg hover:bg-slate-100 transition-all duration-200 active:scale-95 relative","aria-label":"Notifications",children:(0,xn.jsx)(On,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,xn.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"Notifications"})]}),(0,xn.jsxs)("div",{className:"relative",ref:d,children:[(0,xn.jsx)("button",{onClick:()=>o(!i),className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 active:scale-95","aria-label":"User profile",children:(0,xn.jsx)("span",{className:"text-sm font-semibold",children:f()})}),i&&(0,xn.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-slate-200 py-2 z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,xn.jsx)("div",{className:"px-4 py-3 border-b border-slate-100",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center",children:(0,xn.jsx)("span",{className:"text-sm font-semibold",children:f()})}),(0,xn.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,xn.jsx)("p",{className:"text-sm font-semibold text-slate-900 truncate",children:u.username}),(0,xn.jsx)("p",{className:"text-xs text-slate-500 truncate",children:(null===l||void 0===l?void 0:l.email)||"Loading..."})]})]})}),(0,xn.jsxs)("div",{className:"py-1",children:[(0,xn.jsxs)("button",{className:"w-full px-4 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 transition-colors flex items-center gap-3",onClick:()=>{o(!1),console.log("Navigate to profile")},children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-slate-500"}),(0,xn.jsx)("span",{children:"My Profile"})]}),(0,xn.jsxs)("button",{className:"w-full px-4 py-2.5 text-left text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center gap-3",onClick:()=>{o(!1),(async()=>{try{const e=await gn.post("".concat(pn,"/auth/logout"));console.log("Logging out...",e),window.location.href="/login"}catch(e){console.log("error when logout",e)}})()},children:[(0,xn.jsx)(In,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Logout"})]})]})]})]})]})]})},Bn=En("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),Un=En("chart-line",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),zn=En("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),qn=En("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Hn=En("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),Wn=En("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Vn=En("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),Gn=En("circle-dollar-sign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]),Kn=En("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Yn=En("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Xn=En("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),$n=En("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);function Jn(e){let{isOpen:t,onClose:r,scrollBottom:n=!1}=e;const a=(0,s.useRef)(null),{permission:i}=(0,s.useContext)(bn);(0,s.useEffect)(()=>{n&&a.current&&(a.current.scrollTop=a.current.scrollHeight)},[]);const o=[{path:"/dashboard",icon:Bn,label:"Dashboard"},{path:"/rates",icon:Un,label:"Rates Manage",permissionKey:"RateManageView"},{path:"/usefull-link",icon:zn,label:"Useful Links",permissionKey:"UsefulLinksView"},{path:"/leads",icon:qn,label:"Social Leads"},{path:"/mail-tracking",icon:Hn,label:"Email Leads"}],l=[{path:"/sales-plans",icon:Wn,label:"Sales Plans",permissionKey:"SalesPlanView"},{path:"/quotes-invoices",icon:Vn,label:"Quotes",permissionKey:"QuotesView"},{path:"/rfq",icon:Gn,label:"RFQ",permissionKey:"RfqView"},{path:"/accounts",icon:Kn,label:"Accounts",permissionKey:"AccountView"}],c=[{path:"/hr/manage",icon:Yn,label:"Resources",permissionKey:"SystemManagementView"},{path:"/hr/manage-employee",icon:Xn,label:"Employee",permissionKey:"SystemManagementView"},{path:"/rolebase",icon:$n,label:"Role Manage",permissionKey:"SystemManagementView"}],d=(e,t)=>t?e.filter(e=>!e.permissionKey||t[e.permissionKey]):[],u=e=>{let{path:t,icon:n,label:a}=e;return(0,xn.jsx)(De,{to:t,onClick:()=>{window.innerWidth<1024&&(null===r||void 0===r||r())},className:e=>{let{isActive:t}=e;return"flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 group ".concat(t?"bg-blue-50 text-blue-700 border-l-4 border-blue-600 shadow-sm":"hover:bg-slate-50 text-slate-700 hover:text-slate-900")},children:e=>{let{isActive:t}=e;return(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(n,{className:"w-5 h-5 transition-colors ".concat(t?"text-blue-600":"text-slate-500 group-hover:text-slate-700")}),(0,xn.jsx)("span",{className:"font-medium truncate",children:a})]})}})};return(0,xn.jsxs)(xn.Fragment,{children:[t&&(0,xn.jsx)("div",{className:"fixed inset-0 top-14 bg-black/20 backdrop-blur-sm z-40 lg:hidden",onClick:r}),(0,xn.jsxs)("aside",{className:"\n        fixed lg:relative \n        top-14 lg:top-0 left-0 \n        z-50 lg:z-auto\n        w-72 lg:w-64 \n        h-[calc(100vh-3.5rem)] lg:min-h-full\n        bg-white \n        shadow-xl lg:shadow-md \n        border-r border-slate-200\n        transform transition-transform duration-300 ease-in-out lg:transform-none\n        ".concat(t?"translate-x-0":"-translate-x-full lg:translate-x-0","\n        flex flex-col\n        overflow-y-auto\n      "),children:[(0,xn.jsx)("div",{className:"lg:hidden px-4 py-4 border-b border-slate-200",children:(0,xn.jsx)("h2",{className:"text-lg font-semibold text-slate-800",children:"Navigation"})}),(0,xn.jsxs)("div",{ref:a,className:"flex-1 p-4 overflow-y-auto",children:[(0,xn.jsxs)("nav",{className:"space-y-1 mb-6",children:[(0,xn.jsx)("div",{className:"flex items-center justify-between",children:(0,xn.jsx)("h3",{className:"text-sm font-semibold text-slate-600 uppercase tracking-wider",children:"Info"})}),(0,xn.jsx)("div",{className:"h-px bg-slate-200"}),d(o,i).map(e=>(0,xn.jsx)(u,{path:e.path,icon:e.icon,label:e.label},e.path))]}),(0,xn.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,xn.jsx)("div",{className:"flex items-center justify-between",children:(0,xn.jsx)("h3",{className:"text-sm font-semibold text-slate-600 uppercase tracking-wider",children:"Workspaces"})}),(0,xn.jsx)("div",{className:"h-px bg-slate-200"}),(0,xn.jsx)("nav",{className:"space-y-1",children:d(l,i).map(e=>(0,xn.jsx)(u,{path:e.path,icon:e.icon,label:e.label},e.path))})]}),i&&(i.IsAdmin||i.SystemManagementView)&&(0,xn.jsxs)("div",{className:"space-y-3",children:[(0,xn.jsx)("div",{className:"flex items-center justify-between",children:(0,xn.jsx)("h3",{className:"text-sm font-semibold text-orange-600 uppercase tracking-wider",children:"System Management"})}),(0,xn.jsx)("div",{className:"h-px bg-orange-200"}),(0,xn.jsx)("nav",{className:"space-y-1",children:d(c,i).map(e=>(0,xn.jsx)(u,{path:e.path,icon:e.icon,label:e.label},e.path))})]})]})]})]})}const Qn=En("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),Zn=En("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),ea=En("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),ta=En("newspaper",[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]]),ra=En("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);function na(){const[e,t]=(0,s.useState)(""),[r,n]=(0,s.useState)(!0),[a,i]=(0,s.useState)("dashboard");(0,s.useEffect)(()=>{const e=setTimeout(()=>{n(!1)},1500);return()=>clearTimeout(e)},[]);const o=()=>(0,xn.jsxs)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm p-5 h-full flex flex-col justify-between animate-pulse",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/3"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded w-4"})]}),(0,xn.jsx)("div",{className:"flex-1 bg-slate-100 rounded"})]}),l=e=>{let{title:t,children:r,className:n="",loading:a=!1,hasFilter:s=!0}=e;return a?(0,xn.jsx)(o,{}):(0,xn.jsxs)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm hover:shadow-md transition-shadow flex flex-col ".concat(n),style:{animation:"fadeIn 0.5s ease-out"},children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 pb-2",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("h3",{className:"font-medium text-[#323338] text-lg truncate tracking-tight",children:t}),s&&(0,xn.jsx)(Qn,{className:"w-3 h-3 text-[#676879] cursor-pointer hover:text-[#323338]"})]}),(0,xn.jsx)("button",{className:"text-[#676879] hover:text-[#323338] transition-colors",children:(0,xn.jsx)(Zn,{className:"w-5 h-5"})})]}),(0,xn.jsx)("div",{className:"p-4 flex-1 flex flex-col",children:r})]})},c=[{id:"dashboard",label:"Dashboard",icon:ea},{id:"marketplace",label:"MarketPlace Info",icon:Bn},{id:"newsfeed",label:"News Feed",icon:ta}];return(0,xn.jsxs)("main",{className:"w-full bg-[#f6f8fb] min-h-screen text-[#323338] font-sans selection:bg-[#0086C0] selection:text-white",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          from { opacity: 0; transform: translateY(10px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n        /* Custom scrollbar for light theme */\n        ::-webkit-scrollbar { width: 8px; }\n        ::-webkit-scrollbar-track { background: #f6f8fb; }\n        ::-webkit-scrollbar-thumb { background: #c3c6d4; border-radius: 4px; }\n        ::-webkit-scrollbar-thumb:hover { background: #a8abbd; }\n      "}),(0,xn.jsxs)("div",{className:"p-6 max-w-[1600px] mx-auto pb-12",children:[(0,xn.jsx)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-6 border-b border-[#d0d4e4] pb-6",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("h1",{className:"text-2xl font-semibold text-[#323338] tracking-wide",children:"Sales Dashboard"}),(0,xn.jsx)("button",{className:"text-[#676879] hover:text-yellow-400 transition-colors",children:(0,xn.jsx)(ra,{className:"w-5 h-5"})})]})}),(0,xn.jsx)("div",{className:"mb-6",children:(0,xn.jsx)("div",{className:"flex gap-2 border-b border-[#d0d4e4]",children:c.map(e=>{const t=e.icon,r=a===e.id;return(0,xn.jsxs)("button",{onClick:()=>i(e.id),className:"\n                    flex items-center gap-2 px-6 py-3 font-medium transition-all relative\n                    ".concat(r?"text-[#0086C0] border-b-2 border-[#0086C0]":"text-[#676879] hover:text-[#323338] hover:bg-white/50","\n                  "),children:[(0,xn.jsx)(t,{className:"w-4 h-4"}),e.label]},e.id)})})}),"dashboard"===a&&(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,xn.jsx)(l,{title:"Annual Target",className:"lg:col-span-1 h-64",loading:r,children:(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-end h-full relative pb-4",children:[(0,xn.jsxs)("div",{className:"relative w-48 h-24 overflow-hidden mb-2",children:[(0,xn.jsx)("div",{className:"absolute top-0 left-0 w-48 h-48 rounded-full border-[20px] border-[#e6e9ef]"}),(0,xn.jsx)("div",{className:"absolute top-0 left-0 w-48 h-48 rounded-full border-[20px] border-transparent border-t-[#00C875] border-l-[#0086C0]",style:{transform:"rotate(45deg)",opacity:1}}),(0,xn.jsx)("div",{className:"absolute bottom-0 left-1/2 w-1 h-24 bg-[#323338] origin-bottom transform -rotate-12 rounded-full z-10 shadow-sm"}),(0,xn.jsx)("div",{className:"absolute bottom-0 left-1/2 w-4 h-4 bg-[#323338] rounded-full transform -translate-x-1/2 translate-y-1/2 z-20 border-2 border-white"})]}),(0,xn.jsxs)("div",{className:"flex justify-between w-full mt-6 px-2",children:[(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"ACTUAL"}),(0,xn.jsx)("div",{className:"text-xl font-bold text-[#323338]",children:"85K"})]}),(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"TARGET"}),(0,xn.jsx)("div",{className:"text-xl font-bold text-[#323338]",children:"100K"})]})]})]})}),(0,xn.jsx)(l,{title:"Monthly Target",className:"lg:col-span-1 h-64",loading:r,children:(0,xn.jsxs)("div",{className:"flex flex-col justify-center h-full gap-8",children:[(0,xn.jsxs)("div",{className:"relative h-12 w-full bg-[#e6e9ef] rounded-md overflow-hidden flex",children:[(0,xn.jsx)("div",{className:"h-full bg-gradient-to-r from-[#0086C0] to-[#A25DDC]",style:{width:"100%"}}),(0,xn.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white font-bold text-lg drop-shadow-md",children:"300%"})]}),(0,xn.jsxs)("div",{className:"flex justify-between w-full px-2",children:[(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"MONTHLY ACTUAL"}),(0,xn.jsx)("div",{className:"text-xl font-bold text-[#00C875]",children:"55K"})]}),(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("div",{className:"text-[10px] text-[#676879] font-bold uppercase tracking-wider mb-1",children:"THIS MONTH'S TARGET"}),(0,xn.jsx)("div",{className:"text-xl font-bold text-[#323338]",children:"10K"})]})]})]})}),(0,xn.jsx)(l,{title:"Average Sales Value",className:"lg:col-span-1 h-64",loading:r,children:(0,xn.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,xn.jsx)("div",{className:"text-5xl font-light text-[#323338] mb-2",children:"$42,500"})})}),(0,xn.jsx)(l,{title:"Active Sales - Forecasted Rev...",className:"lg:col-span-1 h-64",loading:r,children:(0,xn.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,xn.jsx)("div",{className:"text-5xl font-light text-[#323338] mb-2",children:"$133,000"})})}),(0,xn.jsx)(l,{title:"Sales status distribution",className:"lg:col-span-2 min-h-[300px]",loading:r,children:(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center h-full gap-8",children:[(0,xn.jsx)("div",{className:"relative w-48 h-48 flex-shrink-0",children:(0,xn.jsxs)("svg",{viewBox:"0 0 100 100",className:"transform -rotate-90 w-full h-full",children:[(0,xn.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#00C875",strokeWidth:"50",strokeDasharray:"78.5 78.5",strokeDashoffset:"0"}),(0,xn.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#0086C0",strokeWidth:"50",strokeDasharray:"39.25 117.75",strokeDashoffset:"-78.5"}),(0,xn.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#FDAB3D",strokeWidth:"50",strokeDasharray:"19.625 137.375",strokeDashoffset:"-117.75"}),(0,xn.jsx)("circle",{cx:"50",cy:"50",r:"25",fill:"transparent",stroke:"#A25DDC",strokeWidth:"50",strokeDasharray:"19.625 137.375",strokeDashoffset:"-137.375"})]})}),(0,xn.jsx)("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4",children:[{status:"Won",percentage:50,color:"bg-[#00C875]",count:8},{status:"Discovery",percentage:25,color:"bg-[#0086C0]",count:4},{status:"Working on it",percentage:12.5,color:"bg-[#FDAB3D]",count:2},{status:"Proposal",percentage:12.5,color:"bg-[#A25DDC]",count:2}].map((e,t)=>(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.color)}),(0,xn.jsx)("div",{className:"flex flex-col",children:(0,xn.jsxs)("span",{className:"text-sm text-[#323338]",children:[e.status,": ",(0,xn.jsxs)("span",{className:"text-[#676879]",children:[e.percentage,"%"]})]})})]},t))})]})}),(0,xn.jsx)(l,{title:"Actual Revenue by Month (Deals won)",className:"lg:col-span-2 min-h-[300px]",loading:r,children:(0,xn.jsxs)("div",{className:"h-full w-full flex flex-col justify-end pt-8 px-4 relative",children:[[0,10,20,30,40,50,60].map((e,t)=>(0,xn.jsx)("div",{className:"absolute w-full border-t border-slate-100",style:{bottom:"".concat(e/60*80+20,"%"),left:0},children:(0,xn.jsxs)("span",{className:"absolute -left-0 -top-2.5 text-[10px] text-[#676879]",children:["$",e,",000"]})},t)),(0,xn.jsxs)("div",{className:"flex justify-around items-end h-[80%] z-10 pl-8",children:[[{month:"Sep",value:3e4,trend:"up"},{month:"Oct",value:55e3,trend:"up"}].map((e,t)=>(0,xn.jsxs)("div",{className:"flex flex-col items-center gap-2 group w-24",children:[(0,xn.jsxs)("div",{className:"mb-1 text-xs text-[#323338] opacity-0 group-hover:opacity-100 transition-opacity font-medium",children:["$",e.value.toLocaleString()]}),(0,xn.jsx)("div",{className:"w-full bg-[#579BFC] hover:bg-[#4680d3] transition-all rounded-t-sm relative",style:{height:"".concat(e.value/6e4*100,"%")}}),(0,xn.jsx)("div",{className:"text-xs text-[#676879] mt-2",children:e.month})]},t)),(0,xn.jsxs)("div",{className:"flex flex-col items-center gap-2 w-24 opacity-50",children:[(0,xn.jsx)("div",{className:"w-full bg-[#e6e9ef] border border-dashed border-[#c3c6d4] rounded-t-sm",style:{height:"5px"}}),(0,xn.jsx)("div",{className:"text-xs text-[#676879] mt-2",children:"Nov"})]})]}),(0,xn.jsx)("div",{className:"absolute bottom-4 right-4 z-20",children:(0,xn.jsx)("button",{className:"bg-[#0086C0] hover:bg-[#0071a1] text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-1 shadow-md",children:"Help"})})]})})]}),"marketplace"===a&&(0,xn.jsx)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm p-8 min-h-[500px] flex items-center justify-center",children:(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)(Bn,{className:"w-16 h-16 text-[#676879] mx-auto mb-4"}),(0,xn.jsx)("h2",{className:"text-2xl font-semibold text-[#323338] mb-2",children:"MarketPlace Info"}),(0,xn.jsx)("p",{className:"text-[#676879]",children:"Content coming soon..."})]})}),"newsfeed"===a&&(0,xn.jsx)("div",{className:"bg-white rounded-lg border border-[#d0d4e4] shadow-sm p-8 min-h-[500px] flex items-center justify-center",children:(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)(ta,{className:"w-16 h-16 text-[#676879] mx-auto mb-4"}),(0,xn.jsx)("h2",{className:"text-2xl font-semibold text-[#323338] mb-2",children:"News Feed"}),(0,xn.jsx)("p",{className:"text-[#676879]",children:"Content coming soon..."})]})})]})]})}function aa(){const[e,t]=(0,s.useState)(!1);return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{t(!e)},isMobileMenuOpen:e}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:e,onClose:()=>{t(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(na,{})})]})]})}const sa=En("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ia=En("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),oa=En("message-square-share",[["path",{d:"M12 3H4a2 2 0 0 0-2 2v16.286a.71.71 0 0 0 1.212.502l2.202-2.202A2 2 0 0 1 6.828 19H20a2 2 0 0 0 2-2v-4",key:"11da1y"}],["path",{d:"M16 3h6v6",key:"1bx56c"}],["path",{d:"m16 9 6-6",key:"m4dnic"}]]),la=En("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),ca=En("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),da=En("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ua=En("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ha=En("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),fa=En("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ma=En("mouse",[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]]);function pa(){const[e,t]=(0,s.useState)("sent"),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(""),o=e=>{t(e)},l=()=>{n(!0),setTimeout(()=>n(!1),1500)},c=[{id:1,launched:"2025-12-15",subject:"Winter Sale Announcement",sentBy:"Kavindu Tharaka",status:"Ongoing",recipients:1250,delivered:1248,opened:856,clicked:342},{id:2,launched:"2025-12-14",subject:"Product Update Newsletter",sentBy:"Kavindu Tharaka",status:"Completed",recipients:980,delivered:978,opened:654,clicked:198},{id:3,launched:"2025-12-13",subject:"Customer Feedback Survey",sentBy:"Kavindu Tharaka",status:"Completed",recipients:2100,delivered:2095,opened:1256,clicked:567}],d=[{id:1,sendTime:"2025-12-20 09:00",subject:"Holiday Special Offer",sentBy:"Kavindu Tharaka",status:"Scheduled",recipients:1500},{id:2,sendTime:"2025-12-22 14:00",subject:"Year-End Clearance",sentBy:"Kavindu Tharaka",status:"Scheduled",recipients:2200}],u=e=>{const t="px-3 py-1 rounded-full text-xs font-medium inline-flex items-center gap-1";switch(e){case"Ongoing":return(0,xn.jsxs)("span",{className:"".concat(t," bg-blue-100 text-blue-700"),children:[(0,xn.jsx)(sa,{className:"w-3 h-3"}),"Ongoing"]});case"Completed":return(0,xn.jsxs)("span",{className:"".concat(t," bg-green-100 text-green-700"),children:[(0,xn.jsx)(ia,{className:"w-3 h-3"}),"Completed"]});case"Scheduled":return(0,xn.jsxs)("span",{className:"".concat(t," bg-amber-100 text-amber-700"),children:[(0,xn.jsx)(sa,{className:"w-3 h-3"}),"Scheduled"]});default:return(0,xn.jsx)("span",{className:"".concat(t," bg-gray-100 text-gray-700"),children:e})}};return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            background-position: -1000px 0;\n          }\n          100% {\n            background-position: 1000px 0;\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .skeleton {\n          animation: shimmer 2s infinite;\n          background: linear-gradient(\n            90deg,\n            #f0f0f0 25%,\n            #e0e0e0 50%,\n            #f0f0f0 75%\n          );\n          background-size: 1000px 100%;\n        }\n\n        .table-row-hover:hover {\n          background-color: rgba(59, 130, 246, 0.02);\n        }\n      "}),(0,xn.jsxs)("main",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto",children:[(0,xn.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Hn,{className:"w-8 h-8 text-blue-600"}),(0,xn.jsx)("div",{children:(0,xn.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Email Leads"})})]})}),(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"More information",children:(0,xn.jsx)(zn,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share campaigns",children:(0,xn.jsx)(oa,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,xn.jsxs)("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group active:scale-95",children:[(0,xn.jsx)(la,{className:"w-4 h-4 ".concat(r?"animate-spin":"group-hover:rotate-180 transition-transform")}),(0,xn.jsx)("span",{children:"Refresh"})]})]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-8 mb-6 border-b border-slate-200 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"150ms",animationFillMode:"both"},children:[(0,xn.jsxs)("button",{className:"px-1 py-3 font-medium text-sm transition-all duration-200 relative ".concat("sent"===e?"text-blue-600":"text-slate-600 hover:text-slate-800"),onClick:()=>o("sent"),children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(ca,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Sent"}),(0,xn.jsx)("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-semibold",children:c.length})]}),"sent"===e&&(0,xn.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full"})]}),(0,xn.jsxs)("button",{className:"px-1 py-3 font-medium text-sm transition-all duration-200 relative ".concat("scheduled"===e?"text-blue-600":"text-slate-600 hover:text-slate-800"),onClick:()=>o("scheduled"),children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(sa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Scheduled"}),(0,xn.jsx)("span",{className:"bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full text-xs font-semibold",children:d.length})]}),"scheduled"===e&&(0,xn.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full"})]})]}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),(0,xn.jsx)("span",{children:"New Campaign"})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",children:[(0,xn.jsx)(Qn,{className:"w-4 h-4 text-slate-600"}),(0,xn.jsx)("span",{children:"Filter"}),(0,xn.jsx)(ua,{className:"w-4 h-4 text-slate-400"})]})]}),(0,xn.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search campaigns...",value:a,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}),(0,xn.jsxs)("div",{className:"flex flex-col bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:["sent"===e?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Launched"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Subject"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Sent by"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Status"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Recipients"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Delivered"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Opened"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Clicked"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-200",children:r?Array(3).fill(0).map((e,t)=>(0,xn.jsxs)("tr",{className:"table-row-hover",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-20"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded-full skeleton w-24"})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-right",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-right",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-right",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-right",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded skeleton w-8"})})]},t)):c.map(e=>(0,xn.jsxs)("tr",{className:"table-row-hover hover:bg-slate-50 transition-colors duration-150",children:[(0,xn.jsx)("td",{className:"px-6 py-4 text-sm",children:e.launched}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm font-medium truncate max-w-xs hover:text-blue-600 cursor-pointer",children:e.subject}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.sentBy}),(0,xn.jsx)("td",{className:"px-6 py-4",children:u(e.status)}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-right font-medium",children:e.recipients}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-right text-green-600 font-medium",children:e.delivered}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-right",children:(0,xn.jsxs)("div",{className:"flex items-center justify-end gap-1 text-blue-600 font-medium",children:[(0,xn.jsx)(fa,{className:"w-4 h-4"}),e.opened," (",Math.round(e.opened/e.delivered*100),"%)"]})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-right",children:(0,xn.jsxs)("div",{className:"flex items-center justify-end gap-1 text-purple-600 font-medium",children:[(0,xn.jsx)(ma,{className:"w-4 h-4"}),e.clicked," (",Math.round(e.clicked/e.opened*100),"%)"]})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-center",children:(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors duration-150 text-slate-500 hover:text-slate-700",children:(0,xn.jsx)(Zn,{className:"w-5 h-5"})})})]},e.id))})]})}),(0,xn.jsx)("div",{className:"md:hidden space-y-4 p-4",children:r?Array(3).fill(0).map((e,t)=>(0,xn.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:(0,xn.jsxs)("div",{className:"space-y-3",children:[(0,xn.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton"})]})]})},t)):c.map(e=>(0,xn.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,xn.jsxs)("div",{className:"p-4 border-b border-slate-100",children:[(0,xn.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,xn.jsx)("h3",{className:"text-base font-semibold text-slate-900 flex-1 pr-2",children:e.subject}),(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors flex-shrink-0",children:(0,xn.jsx)(Zn,{className:"w-5 h-5 text-slate-500"})})]}),(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,xn.jsx)(sa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:e.launched})]}),u(e.status)]})]}),(0,xn.jsxs)("div",{className:"p-4 space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,xn.jsx)("span",{className:"text-slate-500",children:"Sent by"}),(0,xn.jsx)("span",{className:"font-medium text-slate-900",children:e.sentBy})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Recipients"}),(0,xn.jsx)("div",{className:"text-lg font-bold text-slate-900",children:e.recipients})]}),(0,xn.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-green-600 mb-1",children:"Delivered"}),(0,xn.jsx)("div",{className:"text-lg font-bold text-green-700",children:e.delivered})]}),(0,xn.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,xn.jsxs)("div",{className:"text-xs text-blue-600 mb-1 flex items-center gap-1",children:[(0,xn.jsx)(fa,{className:"w-3 h-3"}),"Opened"]}),(0,xn.jsxs)("div",{className:"text-lg font-bold text-blue-700",children:[e.opened,(0,xn.jsxs)("span",{className:"text-xs font-normal ml-1",children:["(",Math.round(e.opened/e.delivered*100),"%)"]})]})]}),(0,xn.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3",children:[(0,xn.jsxs)("div",{className:"text-xs text-purple-600 mb-1 flex items-center gap-1",children:[(0,xn.jsx)(ma,{className:"w-3 h-3"}),"Clicked"]}),(0,xn.jsxs)("div",{className:"text-lg font-bold text-purple-700",children:[e.clicked,(0,xn.jsxs)("span",{className:"text-xs font-normal ml-1",children:["(",Math.round(e.clicked/e.opened*100),"%)"]})]})]})]})]})]},e.id))})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Send Time"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Subject"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Sent by"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Status"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600 text-right",children:"Recipients"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-200",children:r?Array(2).fill(0).map((e,t)=>(0,xn.jsxs)("tr",{className:"table-row-hover",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded-full skeleton w-24"})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-right",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-16 ml-auto"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded skeleton w-8"})})]},t)):d.map(e=>(0,xn.jsxs)("tr",{className:"table-row-hover hover:bg-slate-50 transition-colors duration-150",children:[(0,xn.jsx)("td",{className:"px-6 py-4 text-sm",children:e.sendTime}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm font-medium truncate max-w-xs hover:text-blue-600 cursor-pointer",children:e.subject}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.sentBy}),(0,xn.jsx)("td",{className:"px-6 py-4",children:u(e.status)}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-right font-medium",children:e.recipients}),(0,xn.jsx)("td",{className:"px-6 py-4 text-center",children:(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors duration-150 text-slate-500 hover:text-slate-700",children:(0,xn.jsx)(Zn,{className:"w-5 h-5"})})})]},e.id))})]})}),(0,xn.jsx)("div",{className:"md:hidden space-y-4 p-4",children:r?Array(2).fill(0).map((e,t)=>(0,xn.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:(0,xn.jsxs)("div",{className:"space-y-3",children:[(0,xn.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-full"})]})},t)):d.map(e=>(0,xn.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,xn.jsxs)("div",{className:"p-4 border-b border-slate-100",children:[(0,xn.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,xn.jsx)("h3",{className:"text-base font-semibold text-slate-900 flex-1 pr-2",children:e.subject}),(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded-lg transition-colors flex-shrink-0",children:(0,xn.jsx)(Zn,{className:"w-5 h-5 text-slate-500"})})]}),(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,xn.jsx)(sa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:e.sendTime})]}),u(e.status)]})]}),(0,xn.jsxs)("div",{className:"p-4 space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,xn.jsx)("span",{className:"text-slate-500",children:"Sent by"}),(0,xn.jsx)("span",{className:"font-medium text-slate-900",children:e.sentBy})]}),(0,xn.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-blue-600 mb-1",children:"Recipients"}),(0,xn.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:e.recipients})]})]})]},e.id))})]}),!r&&"sent"===e&&0===c.length&&(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,xn.jsx)(Hn,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-500 font-medium",children:"No sent campaigns yet"}),(0,xn.jsx)("p",{className:"text-slate-400 text-sm",children:"Start by creating a new campaign"})]})]}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:l,className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh",children:(0,xn.jsx)(la,{className:"w-5 h-5 ".concat(r?"animate-spin":"group-hover:rotate-180 transition-transform duration-300")})})}),(0,xn.jsx)("div",{className:"h-8"})]})]})}function ga(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),o=()=>{t(!1),i(null)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(pa,{modalOpen:()=>{i(null),t(!0)},onEdit:e=>{i(e),t(!0)}})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:o}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn"})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const xa=En("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ba=En("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),va=En("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ya=En("plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]),wa=En("container",[["path",{d:"M22 7.7c0-.6-.4-1.2-.8-1.5l-6.3-3.9a1.72 1.72 0 0 0-1.7 0l-10.3 6c-.5.2-.9.8-.9 1.4v6.6c0 .5.4 1.2.8 1.5l6.3 3.9a1.72 1.72 0 0 0 1.7 0l10.3-6c.5-.3.9-1 .9-1.5Z",key:"1t2lqe"}],["path",{d:"M10 21.9V14L2.1 9.1",key:"o7czzq"}],["path",{d:"m10 14 11.9-6.9",key:"zm5e20"}],["path",{d:"M14 19.8v-8.1",key:"159ecu"}],["path",{d:"M18 17.5V9.4",key:"11uown"}]]),Na=En("ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]),ja=En("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),ka=En("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),Sa=En("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),Aa=En("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),Ca=En("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),_a=En("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ta=En("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Ea=En("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),La=En("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),Pa=En("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Oa=async()=>(await mn.get("".concat(pn,"/quote/quote"))).data,Fa=async e=>(await mn.get("".concat(pn,"/quote/quote/").concat(e))).data,Ia=async e=>(await mn.post("".concat(pn,"/quote/quote"),e)).data,Ra=async e=>{try{console.log("Payload being sent:",JSON.stringify(e,null,2));return(await mn.put("".concat(pn,"/quote/quote"),e,{headers:{"Content-Type":"application/json"}})).data}catch(r){var t;throw console.error("Error updating quote:",r),console.error("Error response:",null===(t=r.response)||void 0===t?void 0:t.data),r}},Da=async e=>(await mn.delete("".concat(pn,"/quote/quote/").concat(e))).data,Ma=async e=>{try{return(await mn.post("".concat(pn,"/QuoteOutcome"),e)).data}catch(t){throw new Error("Failed to save quote outcome")}};function Ba(e){let{modalOpen:t}=e;const r=ae(),[n,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[l,c]=(0,s.useState)(""),[d,u]=(0,s.useState)("all"),[h,f]=(0,s.useState)("all"),[m,p]=(0,s.useState)({show:!1,quoteId:null,quoteNumber:""}),[g,x]=(0,s.useState)(!1),[b,v]=(0,s.useState)(!1),[y,w]=(0,s.useState)(null),[N,j]=(0,s.useState)({}),[k,S]=(0,s.useState)({wonAmount:""}),[A,C]=(0,s.useState)({lostReason:"",lostNote:""}),_=async e=>{try{const t=await(async e=>{try{return(await mn.get("".concat(pn,"/QuoteOutcome/").concat(e))).data}catch(r){var t;if(404===(null===(t=r.response)||void 0===t?void 0:t.status))return null;throw new Error("Failed to fetch outcome")}})(e);j(r=>We(We({},r),{},{[e]:t}))}catch(t){j(t=>We(We({},t),{},{[e]:null}))}},T=e=>{const t=N[e];return t?"won"===t.outcomeStatus?(0,xn.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,xn.jsx)(ba,{size:14}),"Won"]}),t.wonAmount>0&&(0,xn.jsxs)("span",{className:"text-xs text-gray-600 font-semibold",children:["LKR ",parseFloat(t.wonAmount).toLocaleString()]})]}):"lost"===t.outcomeStatus?(0,xn.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,xn.jsx)(va,{size:14}),"Lost"]}),t.lostReason&&(0,xn.jsx)("span",{className:"text-xs text-gray-600",children:t.lostReason})]}):null:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsxs)("button",{onClick:()=>{const t=n.find(t=>t.quoteId===e);w(t),S({wonAmount:""}),x(!0)},className:"flex items-center gap-1 px-3 py-1 bg-green-50 text-green-700 rounded-lg text-xs font-medium hover:bg-green-100 transition-colors",children:[(0,xn.jsx)(ia,{size:14}),"Win"]}),(0,xn.jsxs)("button",{onClick:()=>{const t=n.find(t=>t.quoteId===e);w(t),C({lostReason:"",lostNote:""}),v(!0)},className:"flex items-center gap-1 px-3 py-1 bg-red-50 text-red-700 rounded-lg text-xs font-medium hover:bg-red-100 transition-colors",children:[(0,xn.jsx)(xa,{size:14}),"Lost"]})]})};(0,s.useEffect)(()=>{E()},[]);const E=async()=>{try{o(!0);const e=await Oa();a(e),e.forEach(e=>{_(e.quoteId)})}catch(e){console.error("Error loading quotes:",e)}finally{o(!1)}},L=e=>{if("multimodal"===e.freightType)r("/quotes?type=multimodal&id=".concat(e.quoteId,"&edit=true"));else{const t=new URLSearchParams({category:e.freightCategory,type:e.freightType,mode:e.freightMode,id:e.quoteId,edit:"true"});r("/quotes?".concat(t.toString()))}},P=e=>{p({show:!0,quoteId:e.quoteId,quoteNumber:e.quoteNumber})},O=(e,t)=>"air"===e&&"import"===t?{icon:ya,color:"text-sky-600",bg:"bg-sky-50",badge:"bg-sky-100 text-sky-800"}:"air"===e&&"export"===t?{icon:ya,color:"text-blue-600",bg:"bg-blue-50",badge:"bg-blue-100 text-blue-800"}:"sea"!==e||"import"!==t&&"fcl"!==t&&"lcl"!==t?"sea"===e&&"export"===t?{icon:Na,color:"text-indigo-600",bg:"bg-indigo-50",badge:"bg-indigo-100 text-indigo-800"}:"multimodal"===e?{icon:ja,color:"text-purple-600",bg:"bg-purple-50",badge:"bg-purple-100 text-purple-800"}:{icon:ka,color:"text-gray-600",bg:"bg-gray-50",badge:"bg-gray-100 text-gray-800"}:{icon:wa,color:"text-teal-600",bg:"bg-teal-50",badge:"bg-teal-100 text-teal-800"},F=e=>"direct"===e?{icon:Sa,color:"text-green-600",badge:"bg-green-100 text-green-800"}:"transit"===e?{icon:Aa,color:"text-orange-600",badge:"bg-orange-100 text-orange-800"}:"multimodal"===e?{icon:ja,color:"text-purple-600",badge:"bg-purple-100 text-purple-800"}:{icon:Sa,color:"text-gray-600",badge:"bg-gray-100 text-gray-800"},I=e=>{const t={draft:{bg:"bg-gray-100",text:"text-gray-800",label:"Draft"},pending:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Pending"},approved:{bg:"bg-green-100",text:"text-green-800",label:"Approved"},rejected:{bg:"bg-red-100",text:"text-red-800",label:"Rejected"}},r=t[e]||t.draft;return(0,xn.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text),children:r.label})},R=e=>{try{var t;if("multimodal"!==e.freightType||!e.routes)return null;const r=JSON.parse(e.routes);if(!r||!r[0]||!r[0].routes)return null;const n=r[0].routes,a=e=>"air"===e?"\u2708\ufe0f":"sea"===e?"\ud83d\udea2":"trucking"===e?"\ud83d\ude9b":"\ud83d\udce6";return(0,xn.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[n.map((e,t)=>(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[t>0&&(0,xn.jsx)(Ca,{size:12,className:"text-gray-400"}),(0,xn.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded flex items-center gap-1",children:[a(e.mode),(0,xn.jsx)("span",{className:"font-medium",children:e.origin||"N/A"})]})]},t)),(0,xn.jsx)(Ca,{size:12,className:"text-gray-400"}),(0,xn.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded font-medium",children:(null===(t=n[n.length-1])||void 0===t?void 0:t.destination)||"N/A"})]})}catch(r){return console.error("Error parsing multimodal route:",r),(0,xn.jsx)("span",{className:"text-xs text-gray-500",children:"Multi-segment route"})}},D=e=>{try{let t=0;if("multimodal"===e.freightType&&e.routes){return JSON.parse(e.routes).forEach(e=>{e.routes&&Array.isArray(e.routes)&&e.routes.forEach(e=>{e.freightChargesTables&&e.freightChargesTables.forEach(e=>{const r=parseFloat(e.chargeableWeight)||0,n=parseFloat(e.charge)||0;t+=r*n}),e.originHandling&&Array.isArray(e.originHandling)&&e.originHandling.forEach(e=>{t+=parseFloat(e.total)||0}),e.destinationHandling&&Array.isArray(e.destinationHandling)&&e.destinationHandling.forEach(e=>{t+=parseFloat(e.total)||0})})}),t.toFixed(2)}if(e.freightCharges){const r=JSON.parse(e.freightCharges);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}if(e.destinationCharges){const r=JSON.parse(e.destinationCharges);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}if(e.originHandling){const r=JSON.parse(e.originHandling);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}if(e.destinationHandling){const r=JSON.parse(e.destinationHandling);Array.isArray(r)&&(t+=r.reduce((e,t)=>e+(parseFloat(t.total)||0),0))}return t.toFixed(2)}catch(t){return console.error("Error calculating total:",t),"0.00"}},M=n.filter(e=>{var t,r;const n=(null===(t=e.quoteNumber)||void 0===t?void 0:t.toLowerCase().includes(l.toLowerCase()))||(null===(r=e.customer)||void 0===r?void 0:r.toLowerCase().includes(l.toLowerCase())),a="all"===d||e.freightType===d,s="all"===h||e.freightCategory===h;return n&&a&&s});return(0,xn.jsxs)("div",{className:"p-6 space-y-6",children:[(0,xn.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Freight Quotes"}),(0,xn.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage and track all your freight quotations"})]}),(0,xn.jsxs)("button",{onClick:()=>t("quote"),className:"flex items-center gap-2 px-4 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 shadow-lg shadow-teal-200 transition-all",children:[(0,xn.jsx)(da,{size:20}),"Create Quote"]})]}),(0,xn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,xn.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,xn.jsxs)("div",{className:"flex-1 relative",children:[(0,xn.jsx)(ha,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,xn.jsx)("input",{type:"text",placeholder:"Search by quote number or customer...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Qn,{className:"text-gray-400",size:20}),(0,xn.jsxs)("select",{value:h,onChange:e=>f(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[(0,xn.jsx)("option",{value:"all",children:"All Categories"}),(0,xn.jsx)("option",{value:"air",children:"Air"}),(0,xn.jsx)("option",{value:"sea",children:"Sea"}),(0,xn.jsx)("option",{value:"multimodal",children:"MultiModal"})]}),(0,xn.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[(0,xn.jsx)("option",{value:"all",children:"All Types"}),(0,xn.jsx)("option",{value:"direct",children:"Direct"}),(0,xn.jsx)("option",{value:"transit",children:"Transit"}),(0,xn.jsx)("option",{value:"multimodal",children:"MultiModal"})]})]})]})}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,xn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"text-sm text-gray-600",children:"Total Quotes"}),(0,xn.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:n.length})]}),(0,xn.jsx)("div",{className:"w-12 h-12 bg-teal-50 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(ka,{className:"text-teal-600",size:24})})]})}),(0,xn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"text-sm text-gray-600",children:"Air Freight"}),(0,xn.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:n.filter(e=>"air"===e.freightCategory).length})]}),(0,xn.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(ya,{className:"text-blue-600",size:24})})]})}),(0,xn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"text-sm text-gray-600",children:"Sea Freight"}),(0,xn.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:n.filter(e=>"sea"===e.freightCategory).length})]}),(0,xn.jsx)("div",{className:"w-12 h-12 bg-teal-50 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(Na,{className:"text-teal-600",size:24})})]})}),(0,xn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"text-sm text-gray-600",children:"MultiModal"}),(0,xn.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:n.filter(e=>"multimodal"===e.freightCategory).length})]}),(0,xn.jsx)("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(ja,{className:"text-purple-600",size:24})})]})})]}),i?(0,xn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,xn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):0===M.length?(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,xn.jsx)(ka,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,xn.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No quotes found"}),(0,xn.jsx)("p",{className:"text-gray-500 mb-4",children:l||"all"!==d||"all"!==h?"Try adjusting your search or filters":"Create your first quote to get started"}),!l&&"all"===d&&"all"===h&&(0,xn.jsxs)("button",{onClick:()=>t("quote"),className:"inline-flex items-center gap-2 px-6 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700",children:[(0,xn.jsx)(da,{size:20}),"Create Quote"]})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"hidden lg:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Quote Details"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Freight Info"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Customer"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Route"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Dates"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Amount"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Status"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Outcome"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-gray-200",children:M.map(e=>{const t=O(e.freightCategory,e.freightMode),r=F(e.freightType),n=t.icon,a=r.icon;return(0,xn.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 rounded-lg ".concat(t.bg," ").concat(t.color," flex items-center justify-center flex-shrink-0"),children:(0,xn.jsx)(n,{size:20})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"font-semibold text-gray-900",children:e.quoteNumber}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,xn.jsx)(a,{size:14,className:r.color}),(0,xn.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(r.badge),children:e.freightType})]})]})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{children:[(0,xn.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t.badge," capitalize"),children:e.freightCategory}),(0,xn.jsx)("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:e.freightMode})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Fn,{size:14,className:"text-gray-400"}),(0,xn.jsx)("span",{className:"text-sm text-gray-700",children:e.customer||"-"})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:"multimodal"===e.freightType?(0,xn.jsx)("div",{className:"max-w-xs",children:R(e)}):(0,xn.jsxs)("div",{className:"space-y-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,xn.jsx)(_a,{size:14,className:"text-green-500"}),(0,xn.jsx)("span",{className:"truncate max-w-[150px]",children:e.portOfLoading||"-"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,xn.jsx)(_a,{size:14,className:"text-red-500"}),(0,xn.jsx)("span",{className:"truncate max-w-[150px]",children:e.portOfDischarge||"-"})]})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"space-y-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,xn.jsx)(Ta,{size:14,className:"text-gray-400"}),(0,xn.jsx)("span",{className:"text-gray-700",children:new Date(e.createdDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.rateValidity&&(0,xn.jsxs)("div",{className:"text-xs text-gray-500",children:["Valid till: ",new Date(e.rateValidity).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Ea,{size:14,className:"text-green-600"}),(0,xn.jsx)("span",{className:"font-semibold text-gray-900",children:D(e)})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:I(e.status)}),(0,xn.jsx)("td",{className:"px-6 py-4",children:T(e.quoteId)}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,xn.jsx)("button",{onClick:()=>L(e),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Edit Quote",children:(0,xn.jsx)(La,{size:18})}),(0,xn.jsx)("button",{onClick:()=>P(e),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Quote",children:(0,xn.jsx)(Pa,{size:18})})]})})]},e.quoteId)})})]})})}),(0,xn.jsx)("div",{className:"lg:hidden space-y-4",children:M.map(e=>{const t=O(e.freightCategory,e.freightMode),r=F(e.freightType),n=t.icon;r.icon;return(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[(0,xn.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 rounded-lg ".concat(t.bg," ").concat(t.color," flex items-center justify-center"),children:(0,xn.jsx)(n,{size:20})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"font-semibold text-gray-900",children:e.quoteNumber}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,xn.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(t.badge," capitalize"),children:e.freightCategory}),(0,xn.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(r.badge),children:e.freightType})]})]})]}),I(e.status)]}),(0,xn.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,xn.jsx)(Fn,{size:14,className:"text-gray-400"}),(0,xn.jsx)("span",{className:"text-gray-700",children:e.customer||"-"})]}),"multimodal"===e.freightType?R(e):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,xn.jsx)(_a,{size:14,className:"text-green-500"}),(0,xn.jsx)("span",{className:"text-gray-600",children:e.portOfLoading||"-"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,xn.jsx)(_a,{size:14,className:"text-red-500"}),(0,xn.jsx)("span",{className:"text-gray-600",children:e.portOfDischarge||"-"})]})]}),(0,xn.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Ta,{size:14,className:"text-gray-400"}),(0,xn.jsx)("span",{className:"text-gray-600",children:new Date(e.createdDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-1 font-semibold text-gray-900",children:[(0,xn.jsx)(Ea,{size:16,className:"text-green-600"}),D(e)]})]})]}),(0,xn.jsx)("div",{className:"border-t border-gray-200 pt-3",children:T(e.quoteId)}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-100 mt-3",children:[(0,xn.jsxs)("button",{onClick:()=>L(e),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-green-600 bg-green-50 rounded-lg text-sm font-medium hover:bg-green-100",children:[(0,xn.jsx)(La,{size:16}),"Edit"]}),(0,xn.jsx)("button",{onClick:()=>P(e),className:"flex items-center justify-center gap-2 px-3 py-2 text-red-600 bg-red-50 rounded-lg text-sm font-medium hover:bg-red-100",children:(0,xn.jsx)(Pa,{size:16})})]})]},e.quoteId)})})]}),m.show&&(0,xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,xn.jsx)(Pa,{className:"text-red-600",size:24})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Quote"}),(0,xn.jsx)("p",{className:"text-sm text-gray-500",children:"This action cannot be undone"})]})]}),(0,xn.jsxs)("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete quote ",(0,xn.jsx)("span",{className:"font-semibold",children:m.quoteNumber}),"? All associated data will be permanently removed."]}),(0,xn.jsxs)("div",{className:"flex gap-3",children:[(0,xn.jsx)("button",{onClick:()=>p({show:!1,quoteId:null,quoteNumber:""}),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,xn.jsx)("button",{onClick:async()=>{try{await Da(m.quoteId),p({show:!1,quoteId:null,quoteNumber:""}),E(),alert("Quote deleted successfully!")}catch(e){console.error("Error deleting quote:",e),alert("Failed to delete quote")}},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete Quote"})]})]})}),g&&y&&(0,xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,xn.jsx)(ba,{className:"text-green-600",size:24})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Quote Won!"}),(0,xn.jsxs)("p",{className:"text-sm text-gray-500",children:["Quote: ",y.quoteNumber]})]})]}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Won Amount (LKR) ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"LKR"}),(0,xn.jsx)("input",{type:"number",value:k.wonAmount,onChange:e=>S(We(We({},k),{},{wonAmount:e.target.value})),placeholder:"0.00",className:"w-full pl-14 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),(0,xn.jsxs)("div",{className:"flex gap-3",children:[(0,xn.jsx)("button",{onClick:()=>{x(!1),w(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,xn.jsx)("button",{onClick:async()=>{if(!k.wonAmount||parseFloat(k.wonAmount)<=0)alert("Please enter a valid won amount");else try{const e={quoteId:y.quoteId,outcomeStatus:"won",wonAmount:parseFloat(k.wonAmount),lostReason:null,lostNote:null};await Ma(e),await _(y.quoteId),x(!1),w(null),alert("Quote marked as won successfully!")}catch(e){console.error("Error saving win outcome:",e),alert("Failed to save win outcome")}},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Save"})]})]})}),b&&y&&(0,xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,xn.jsx)(va,{className:"text-red-600",size:24})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Quote Lost"}),(0,xn.jsxs)("p",{className:"text-sm text-gray-500",children:["Quote: ",y.quoteNumber]})]})]}),(0,xn.jsxs)("div",{className:"mb-4",children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsxs)("select",{value:A.lostReason,onChange:e=>C(We(We({},A),{},{lostReason:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[(0,xn.jsx)("option",{value:"",children:"Select reason..."}),["High Prices","Late Submissions","Poor Transit Times","Destination free time","Flight cancelation","Others"].map(e=>(0,xn.jsx)("option",{value:e,children:e},e))]})]}),"Others"===A.lostReason&&(0,xn.jsxs)("div",{className:"mb-4",children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Note ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("textarea",{value:A.lostNote,onChange:e=>C(We(We({},A),{},{lostNote:e.target.value})),placeholder:"Please provide details...",rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"})]}),(0,xn.jsxs)("div",{className:"flex gap-3",children:[(0,xn.jsx)("button",{onClick:()=>{v(!1),w(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,xn.jsx)("button",{onClick:async()=>{if(A.lostReason)if("Others"!==A.lostReason||A.lostNote)try{const e={quoteId:y.quoteId,outcomeStatus:"lost",wonAmount:0,lostReason:A.lostReason,lostNote:"Others"===A.lostReason?A.lostNote:null};await Ma(e),await _(y.quoteId),v(!1),w(null),alert("Quote marked as lost successfully!")}catch(e){console.error("Error saving lost outcome:",e),alert("Failed to save lost outcome")}else alert("Please provide a note");else alert("Please select a reason")},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Save"})]})]})})]})}function Ua(e){let{onClose:t,type:r="quote",editDocument:n=null,onSuccess:a}=e;const i=ae(),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),u=[{id:"air-import",label:"Air Import",icon:ya,color:"text-sky-600",bg:"bg-sky-50",category:"air",mode:"import"},{id:"air-export",label:"Air Export",icon:ya,color:"text-blue-600",bg:"bg-blue-50",category:"air",mode:"export"},{id:"sea-import-fcl",label:"Sea Import FCL",icon:wa,color:"text-teal-600",bg:"bg-teal-50",category:"sea",mode:"import"},{id:"sea-import-lcl",label:"Sea Import LCL",icon:ka,color:"text-emerald-600",bg:"bg-emerald-50",category:"sea",mode:"import"},{id:"sea-export-fcl",label:"Sea Export FCL",icon:Na,color:"text-indigo-600",bg:"bg-indigo-50",category:"sea",mode:"export"},{id:"sea-export-lcl",label:"Sea Export LCL",icon:Aa,color:"text-purple-600",bg:"bg-purple-50",category:"sea",mode:"export"}],h=[{id:"direct",label:"Direct",icon:Sa,description:"Single route without stops"},{id:"transit",label:"Transshipment",icon:Aa,description:"Multiple transit points"},{id:"multimodal",label:"MultiModal",icon:ja,description:"Combined air and sea"}];return(0,xn.jsxs)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto backdrop-blur-sm",children:[(0,xn.jsxs)("div",{className:"w-full max-w-7xl bg-white rounded-2xl shadow-2xl max-h-[95vh] flex flex-col my-8",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-teal-50 to-emerald-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-12 h-12 rounded-lg bg-teal-600 flex items-center justify-center shadow-lg shadow-teal-200",children:(0,xn.jsx)(Wn,{className:"w-6 h-6 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h1",{className:"text-2xl font-bold text-slate-800",children:[n?"Edit":"Create New"," ","quote"===r?"Quote":"Invoice"]}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Select freight mode and routing type"})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors",children:(0,xn.jsx)(Ln,{className:"w-6 h-6 text-slate-500"})})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-y-auto p-6 scroll-smooth",children:(0,xn.jsxs)("div",{className:"space-y-8",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Step 1: Select Freight Mode"}),(0,xn.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Choose your shipping method"}),(0,xn.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:u.map(e=>(0,xn.jsxs)("button",{onClick:()=>(e=>{l(e),d("")})(e.id),className:"p-4 rounded-xl border-2 text-left transition-all hover:shadow-md ".concat(o===e.id?"border-teal-500 ring-2 ring-teal-200 bg-teal-50":"border-slate-200 hover:border-teal-200"),children:[(0,xn.jsx)("div",{className:"w-10 h-10 rounded-lg ".concat(e.bg," ").concat(e.color," flex items-center justify-center mb-3"),children:(0,xn.jsx)(e.icon,{className:"w-6 h-6"})}),(0,xn.jsx)("span",{className:"font-semibold text-slate-700 block",children:e.label})]},e.id))})]}),o&&(0,xn.jsxs)("div",{className:"pt-6 border-t border-slate-100 animate-fadeIn",children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Step 2: Select Routing Type"}),(0,xn.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Choose how your cargo will be transported"}),(0,xn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:h.map(e=>(0,xn.jsxs)("button",{onClick:()=>{return t=e.id,void d(t);var t},className:"p-5 rounded-xl border-2 flex flex-col items-center gap-3 transition-all hover:shadow-md ".concat(c===e.id?"border-teal-500 bg-teal-50 text-teal-700 ring-2 ring-teal-200":"border-slate-200 hover:bg-slate-50"),children:[(0,xn.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(c===e.id?"bg-teal-100":"bg-slate-100"),children:(0,xn.jsx)(e.icon,{className:"w-7 h-7 ".concat(c===e.id?"text-teal-700":"text-slate-600")})}),(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("span",{className:"font-semibold block text-base",children:e.label}),(0,xn.jsx)("span",{className:"text-xs block mt-1 ".concat(c===e.id?"text-teal-600":"text-slate-500"),children:e.description})]})]},e.id))})]}),o&&(0,xn.jsxs)("div",{className:"flex justify-between items-center pt-6 border-t border-slate-100 animate-fadeIn",children:[(0,xn.jsx)("button",{onClick:t,className:"px-6 py-2.5 border-2 border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors font-medium",children:"Cancel"}),(0,xn.jsx)("button",{disabled:!c,onClick:()=>{if(!o||!c)return;const e=u.find(e=>e.id===o);i("multimodal"===c?"/quotes?type=multimodal":"/quotes?category=".concat(e.category,"&type=").concat(c,"&mode=").concat(e.mode)),t()},className:"px-8 py-2.5 rounded-lg font-medium transition-all ".concat(c?"bg-teal-600 text-white hover:bg-teal-700 shadow-lg shadow-teal-200":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:"Continue to Quote Form"})]})]})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.3s ease-out;\n        }\n      "})]})}const za=En("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),qa=En("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Ha=("".concat(pn,"/Quote"),async()=>{try{return(await mn.get("".concat(pn,"/rates/rates"))).data}catch(e){throw new Error("Failed to fetch rates")}}),Wa=async e=>{try{return(await mn.post("".concat(pn,"/rates/rates"),e)).data}catch(t){throw new Error("Failed to create rate")}},Va=async(e,t)=>{try{return(await mn.put("".concat(pn,"/rates/rates/").concat(e),t)).data}catch(r){throw new Error("Failed to update rate")}};function Ga(e){let{onClose:t}=e;const[r,n]=(0,s.useState)(1),[a,i]=(0,s.useState)(""),o="quote",[l,c]=(0,s.useState)({origin:"",destination:"",route:"",weight:"",containerType:"",volume:""}),[d,u]=(0,s.useState)([]),[h,f]=(0,s.useState)(null),[m,p]=(0,s.useState)(""),[g,x]=(0,s.useState)(0),[b,v]=(0,s.useState)({documentNumber:"",recipient:"",recipientEmail:"",recipientAddress:"",issueDate:"",dueDate:"",expiryDate:"",currency:"USD",notes:"",terms:"",templateName:"",validUntil:""}),[y,w]=(0,s.useState)({airline:"",liner:"",routing:"",surcharges:"",transitTime:"",frequency:"",routingType:"DIRECT",rate45Minus:"",rate45Plus:"",rateM:"",rate45KG:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:"",validateDate:""}),[N,j]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),[A,C]=(0,s.useState)({}),[_,T]=(0,s.useState)(!1),[E,L]=(0,s.useState)(!1),[P,O]=(0,s.useState)([]),[F,I]=(0,s.useState)(!1),[R,D]=(0,s.useState)(""),[M,B]=(0,s.useState)(null),[U,z]=(0,s.useState)(""),[q,H]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a&&2===r&&W()},[a,r]);const W=async()=>{I(!0),D("");try{const e=(await Ha()).filter(e=>e.freightType===a).map(e=>{let t={};if(e.rateDataJson)try{t=JSON.parse(e.rateDataJson)}catch(K_){console.error("Error parsing rateDataJson:",K_)}return We(We({},e),t)});O(e||[])}catch(e){console.error("Error fetching rates:",e),D("Failed to load rates. Please try again.")}finally{I(!1)}},V=()=>{B(null),w({airline:"",liner:"",routing:"",surcharges:"",transitTime:"",frequency:"",routingType:"DIRECT",rate45Minus:"",rate45Plus:"",rateM:"",rate45KG:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:"",validateDate:""})},G=async e=>{if(window.confirm("Are you sure you want to delete this rate?"))try{await(async e=>{try{return(await mn.delete("".concat(pn,"/rates/rates/").concat(e))).data}catch(t){throw new Error("Failed to delete rate")}})(e),W(),p("Rate deleted successfully!"),setTimeout(()=>p(""),3e3)}catch(n){var t,r;console.error("Error deleting rate:",n),D((null===(t=n.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||n.message||"Failed to delete rate.")}},K=e=>{const{name:t,value:r}=e.target;w(e=>We(We({},e),{},{[t]:r}))},Y=e=>{const{name:t,value:r}=e.target;c(e=>We(We({},e),{},{[t]:r}))};return(0,xn.jsxs)("div",{className:"w-full max-w-6xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 rounded-t-2xl ".concat("bg-gradient-to-r from-amber-50 to-orange-50"),children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("bg-amber-500"),children:(0,xn.jsx)(Wn,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h1",{className:"text-xl font-bold text-slate-800",children:["Rate Management - ",q?"Edit":"Create"," ",o.charAt(0).toUpperCase()+o.slice(1)]}),(0,xn.jsxs)("p",{className:"text-sm text-slate-600",children:["Manage rates and generate ",o,"s"]})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500"})})]}),(0,xn.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(R||A.submit)&&(0,xn.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:(0,xn.jsxs)("div",{className:"flex items-center",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-red-500 mr-3"}),(0,xn.jsx)("p",{className:"text-sm text-red-700",children:R||A.submit}),(0,xn.jsx)("button",{onClick:()=>{D(""),C(e=>We(We({},e),{},{submit:""}))},className:"ml-auto text-red-500 hover:text-red-700",children:(0,xn.jsx)(Ln,{className:"w-4 h-4"})})]})}),m&&(0,xn.jsx)("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-6",children:(0,xn.jsxs)("div",{className:"flex items-center",children:[(0,xn.jsx)(ia,{className:"w-5 h-5 text-green-500 mr-3"}),(0,xn.jsx)("p",{className:"text-sm text-green-700",children:m}),(0,xn.jsx)("button",{onClick:()=>p(""),className:"ml-auto text-green-500 hover:text-green-700",children:(0,xn.jsx)(Ln,{className:"w-4 h-4"})})]})}),(0,xn.jsxs)("div",{className:"space-y-8",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,xn.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full ".concat(r>=1?"bg-teal-600 text-white":"bg-slate-200 text-slate-600"),children:"1"}),(0,xn.jsx)("div",{className:"h-1 flex-1 ".concat(r>=2?"bg-teal-600":"bg-slate-200")}),(0,xn.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full ".concat(r>=2?"bg-teal-600 text-white":"bg-slate-200 text-slate-600"),children:"2"}),(0,xn.jsx)("div",{className:"h-1 flex-1 ".concat(r>=3?"bg-teal-600":"bg-slate-200")}),(0,xn.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full ".concat(r>=3?"bg-teal-600 text-white":"bg-slate-200 text-slate-600"),children:"3"})]}),1===r&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Select Freight Type"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{className:"border-2 border-slate-200 rounded-lg p-4 hover:border-teal-500 transition-all",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,xn.jsx)(ya,{className:"w-6 h-6 text-blue-500"}),(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Air Freight"})]}),(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsx)("button",{onClick:()=>{i("air-import"),n(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-blue-50 rounded-lg transition-colors",children:"Air Import"}),(0,xn.jsx)("button",{onClick:()=>{i("air-export"),n(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-blue-50 rounded-lg transition-colors",children:"Air Export"})]})]}),(0,xn.jsxs)("div",{className:"border-2 border-slate-200 rounded-lg p-4 hover:border-teal-500 transition-all",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,xn.jsx)(Na,{className:"w-6 h-6 text-teal-500"}),(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Freight"})]}),(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsxs)("button",{onClick:()=>{i("sea-import-fcl"),n(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,xn.jsx)("span",{children:"Sea Import FCL"}),(0,xn.jsx)(wa,{className:"w-4 h-4 text-slate-400"})]}),(0,xn.jsxs)("button",{onClick:()=>{i("sea-import-lcl"),n(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,xn.jsx)("span",{children:"Sea Import LCL"}),(0,xn.jsx)(ka,{className:"w-4 h-4 text-slate-400"})]}),(0,xn.jsxs)("button",{onClick:()=>{i("sea-export-fcl"),n(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,xn.jsx)("span",{children:"Sea Export FCL"}),(0,xn.jsx)(wa,{className:"w-4 h-4 text-slate-400"})]}),(0,xn.jsxs)("button",{onClick:()=>{i("sea-export-lcl"),n(2)},className:"w-full text-left px-4 py-3 bg-slate-50 hover:bg-teal-50 rounded-lg transition-colors flex items-center justify-between",children:[(0,xn.jsx)("span",{children:"Sea Export LCL"}),(0,xn.jsx)(ka,{className:"w-4 h-4 text-slate-400"})]})]})]})]}),A.freightType&&(0,xn.jsxs)("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),A.freightType]})]}),2===r&&(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg p-6 border border-blue-200",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(_a,{className:"w-5 h-5 text-blue-600"}),"Route Information"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Origin"}),(0,xn.jsx)("input",{name:"origin",value:l.origin,onChange:Y,placeholder:"e.g., CMB",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Destination"}),(0,xn.jsx)("input",{name:"destination",value:l.destination,onChange:Y,placeholder:"e.g., IND",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Route"}),(0,xn.jsx)("input",{name:"route",value:l.route,onChange:Y,placeholder:"e.g., CMB/DXB/IND",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]})]}),(0,xn.jsxs)("div",{className:"bg-white rounded-lg border-2 border-slate-200 p-6",children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Available Rates"}),F?(0,xn.jsxs)("div",{className:"text-center py-8",children:[(0,xn.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-teal-600 border-t-transparent rounded-full animate-spin"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600 mt-3",children:"Loading rates..."})]}):0===P.length?(0,xn.jsxs)("div",{className:"text-center py-8 bg-slate-50 rounded-lg",children:[(0,xn.jsx)(va,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"No rates found for this freight type."}),(0,xn.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Create a new rate below to get started."})]}):(0,xn.jsx)("div",{className:"space-y-3",children:P.map(e=>(0,xn.jsx)("div",{className:"p-4 border-2 rounded-lg transition-all ".concat((null===h||void 0===h?void 0:h.id)===e.id?"border-green-500 bg-green-50":"border-slate-200 hover:border-teal-300 bg-white"),children:(0,xn.jsxs)("div",{className:"flex justify-between items-start",children:[(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(null===h||void 0===h?void 0:h.id)===e.id&&(0,xn.jsx)(ia,{className:"w-5 h-5 text-green-600"}),(0,xn.jsxs)("p",{className:"font-semibold text-slate-800",children:[e.airline||e.liner||"Rate"," - ",e.route||"N/A"]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[(0,xn.jsxs)("span",{className:"flex items-center gap-1",children:[(0,xn.jsx)(Ta,{className:"w-3 h-3"}),"Valid until: ",new Date(e.validateDate).toLocaleDateString()]}),(0,xn.jsxs)("span",{className:"flex items-center gap-1",children:[(0,xn.jsx)(_a,{className:"w-3 h-3"}),e.origin," \u2192 ",e.destination]})]})]}),(0,xn.jsxs)("div",{className:"flex gap-2",children:[(0,xn.jsx)("button",{onClick:()=>(e=>{B(e.id);let t=e;if(e.rateDataJson&&"string"===typeof e.rateDataJson)try{const r=JSON.parse(e.rateDataJson);t=We(We({},e),r)}catch(K_){console.error("Error parsing rate data:",K_)}w({airline:t.airline||"",liner:t.liner||"",routing:t.routing||t.route||"",surcharges:t.surcharges||"",transitTime:t.transitTime||"",frequency:t.frequency||"",routingType:t.routingType||"DIRECT",rate45Minus:t.rate45Minus||"",rate45Plus:t.rate45Plus||"",rateM:t.rateM||"",rate45KG:t.rate45KG||"",rate100:t.rate100||"",rate300:t.rate300||"",rate500:t.rate500||"",rate1000:t.rate1000||"",rate20GP:t.rate20GP||"",rate40GP:t.rate40GP||"",rate40HQ:t.rate40HQ||"",lclRate:t.lclRate||"",validateDate:e.validateDate||""}),c(t=>We(We({},t),{},{origin:e.origin||"",destination:e.destination||"",route:e.route||""}))})(e),className:"p-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-colors",title:"Edit Rate",children:(0,xn.jsx)(za,{className:"w-4 h-4"})}),(0,xn.jsx)("button",{onClick:()=>G(e.id),className:"p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",title:"Delete Rate",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})]})]})},e.id))})]}),(0,xn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),z(""),!y.validateDate)return void z("Validation date is required.");if(!l.origin||!l.destination)return void z("Origin and Destination are required.");const t={airline:y.airline||null,liner:y.liner||null,routing:y.routing||null,surcharges:y.surcharges||null,transitTime:0,frequency:y.frequency||null,routingType:y.routingType||"DIRECT",rate45Minus:y.rate45Minus?parseFloat(y.rate45Minus):null,rate45Plus:y.rate45Plus?parseFloat(y.rate45Plus):null,rateM:y.rateM?parseFloat(y.rateM):null,rate45KG:y.rate45KG?parseFloat(y.rate45KG):null,rate100:y.rate100?parseFloat(y.rate100):null,rate300:y.rate300?parseFloat(y.rate300):null,rate500:y.rate500?parseFloat(y.rate500):null,rate1000:y.rate1000?parseFloat(y.rate1000):null,rate20GP:y.rate20GP?parseFloat(y.rate20GP):null,rate40GP:y.rate40GP?parseFloat(y.rate40GP):null,rate40HQ:y.rate40HQ?parseFloat(y.rate40HQ):null,lclRate:y.lclRate?parseFloat(y.lclRate):null},r={freightType:a,origin:l.origin,destination:l.destination,route:l.route||"".concat(l.origin,"/").concat(l.destination),rateDataJson:JSON.stringify(t),validateDate:y.validateDate,owner:"System"};console.log("Sending to backend:",r),console.log("Rate Data:",t);try{if(M){H(!0);const e=We(We({},r),{},{id:M});await Va(e)}else await Wa(r);V(),c({origin:"",destination:"",route:"",weight:"",containerType:"",volume:""}),W(),p(M?"Rate updated successfully!":"Rate created successfully!"),setTimeout(()=>p(""),3e3)}catch(i){var n,s;console.error("Error saving rate:",i),z((null===(n=i.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||i.message||"Failed to save rate.")}},className:"bg-slate-50 rounded-lg p-6 border-2 border-slate-200",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[M?(0,xn.jsx)(za,{className:"w-5 h-5 text-amber-600"}):(0,xn.jsx)(da,{className:"w-5 h-5 text-teal-600"}),M?"Update Rate":"Create New Rate"]}),U&&(0,xn.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(va,{className:"w-4 h-4 text-red-600"}),(0,xn.jsx)("p",{className:"text-sm text-red-600",children:U})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 inline mr-1"}),"Valid Until *"]}),(0,xn.jsx)("input",{name:"validateDate",type:"date",value:y.validateDate,onChange:K,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0})]}),a.startsWith("air")&&(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[(0,xn.jsx)(ya,{className:"w-4 h-4 inline mr-1"}),"Airline"]}),(0,xn.jsx)("input",{name:"airline",value:y.airline,onChange:K,placeholder:"e.g., EK, QR, UL",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),a.startsWith("sea")&&(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[(0,xn.jsx)(Na,{className:"w-4 h-4 inline mr-1"}),"Liner/Carrier"]}),(0,xn.jsx)("input",{name:"liner",value:y.liner,onChange:K,placeholder:"e.g., MSC, MAERSK",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]}),"air-import"===a&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h4",{className:"font-medium text-slate-700",children:"Air Import Rates"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"M (-45KG)"}),(0,xn.jsx)("input",{name:"rateM",type:"number",step:"0.01",value:y.rateM,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"+45KG"}),(0,xn.jsx)("input",{name:"rate45KG",type:"number",step:"0.01",value:y.rate45KG,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]})]}),"air-export"===a&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h4",{className:"font-medium text-slate-700",children:"Air Export Rates"}),(0,xn.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[{name:"rate45Minus",label:"-45KG"},{name:"rate45Plus",label:"+45KG"},{name:"rate100",label:"+100KG"},{name:"rate300",label:"+300KG"},{name:"rate500",label:"+500KG"},{name:"rate1000",label:"+1000KG"}].map(e=>(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:e.label}),(0,xn.jsx)("input",{name:e.name,type:"number",step:"0.01",value:y[e.name],onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]},e.name))})]}),a.includes("fcl")&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h4",{className:"font-medium text-slate-700",children:"FCL Container Rates"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"20' GP"}),(0,xn.jsx)("input",{name:"rate20GP",type:"number",step:"0.01",value:y.rate20GP,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' GP"}),(0,xn.jsx)("input",{name:"rate40GP",type:"number",step:"0.01",value:y.rate40GP,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' HQ"}),(0,xn.jsx)("input",{name:"rate40HQ",type:"number",step:"0.01",value:y.rate40HQ,onChange:K,placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]})]}),a.includes("lcl")&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h4",{className:"font-medium text-slate-700",children:"LCL Rate"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"LCL Rate (USD/CBM or W/M)"}),(0,xn.jsx)("input",{name:"lclRate",type:"number",step:"0.01",value:y.lclRate,onChange:K,placeholder:"0.00",className:"w-full md:w-1/3 px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]})]}),(0,xn.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,xn.jsxs)("button",{type:"submit",className:"px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-all font-medium flex items-center gap-2",children:[(0,xn.jsx)(qa,{className:"w-4 h-4"}),M?"Update Rate":"Create Rate"]}),M&&(0,xn.jsx)("button",{type:"button",onClick:V,className:"px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-all font-medium",children:"Cancel"})]})]}),h&&(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-6 border-2 border-green-200",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(Ea,{className:"w-5 h-5 text-green-600"}),"Shipment Details & Cost Calculation"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(a.includes("air")||a.includes("lcl"))&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Weight (KG)"}),(0,xn.jsx)("input",{name:"weight",type:"number",value:l.weight,onChange:Y,placeholder:"Enter weight",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),a.includes("fcl")&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Container Type"}),(0,xn.jsxs)("select",{name:"containerType",value:l.containerType,onChange:Y,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,xn.jsx)("option",{value:"",children:"Select Container Type"}),(0,xn.jsx)("option",{value:"20GP",children:"20' GP"}),(0,xn.jsx)("option",{value:"40GP",children:"40' GP"}),(0,xn.jsx)("option",{value:"40HQ",children:"40' HQ"})]})]}),a.includes("lcl")&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Volume (CBM)"}),(0,xn.jsx)("input",{name:"volume",type:"number",value:l.volume,onChange:Y,placeholder:"Enter volume",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),g>0&&(0,xn.jsx)("div",{className:"bg-white rounded-lg p-6 border-2 border-green-300 shadow-sm",children:(0,xn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"text-sm text-slate-600 mb-1",children:"Estimated Freight Cost"}),(0,xn.jsx)("p",{className:"text-3xl font-bold text-green-600",children:(X=g,new Intl.NumberFormat("en-US",{style:"currency",currency:b.currency,minimumFractionDigits:2}).format(X))})]}),(0,xn.jsx)(ia,{className:"w-12 h-12 text-green-500"})]})})]})]})]})]}),2===r&&(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all font-medium",disabled:_,children:"Cancel"}),(0,xn.jsx)("div",{className:"flex flex-col sm:flex-row gap-2",children:(0,xn.jsx)("button",{onClick:()=>(async()=>{})(),disabled:_,className:"px-6 py-3 text-white bg-slate-600 hover:bg-slate-700 disabled:bg-slate-400 rounded-lg transition-all font-medium flex items-center gap-2 justify-center",children:_?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Close..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(qa,{className:"w-4 h-4"}),"Close"]})})})]})]});var X}function Ka(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)("quote"),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(0),f=()=>{t(!1),d(null)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{i(!a)},isMobileMenuOpen:a}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:a,onClose:()=>{i(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(Ba,{modalOpen:function(){l(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"quote"),d(null),t(!0)},onEditDocument:e=>{var r;d(e),l((null===(r=e.type)||void 0===r?void 0:r.toLowerCase())||"quote"),t(!0)},refreshTrigger:u,openRateModal:()=>{n(!0)}})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:f}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Ua,{onClose:f,type:o,editDocument:c,onSuccess:()=>{h(e=>e+1)}})})})]}),r&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:f}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Ga,{onClose:()=>{n(!1)}})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Ya=En("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),Xa=En("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),$a=En("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function Ja(e){let{rfqId:t,onClose:r}=e;const[n,a]=(0,s.useState)(!0),[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)([]);(0,s.useEffect)(()=>{h()},[t]);const h=async()=>{a(!0),o(null);try{const e=await(async e=>{try{return(await mn.get("".concat(pn,"/rfq/").concat(e))).data}catch(i){throw new Error("Failed to get obj from rfq")}})(t);let r;if(console.log("Raw response:",e),r="string"===typeof e?JSON.parse(e):e,console.log("Parsed data:",r),Array.isArray(r)&&r.length>0){const e=Object.keys(r[0]);u(e),c(r)}else o("No data available for this RFQ")}catch(e){console.error("Error fetching RFQ data:",e),o("Failed to load RFQ data. Please try again.")}finally{a(!1)}};return(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col overflow-hidden animate-fadeIn",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n          @keyframes fadeIn {\n            from {\n              opacity: 0;\n              transform: scale(0.95);\n            }\n            to {\n              opacity: 1;\n              transform: scale(1);\n            }\n          }\n          \n          @keyframes shimmer {\n            0% {\n              background-position: -1000px 0;\n            }\n            100% {\n              background-position: 1000px 0;\n            }\n          }\n          \n          .animate-fadeIn {\n            animation: fadeIn 0.2s ease-out;\n          }\n          \n          .skeleton {\n            animation: shimmer 2s infinite;\n            background: linear-gradient(\n              90deg,\n              #f0f0f0 25%,\n              #e0e0e0 50%,\n              #f0f0f0 75%\n            );\n            background-size: 1000px 100%;\n          }\n\n          .data-table {\n            font-size: 0.875rem;\n          }\n\n          .data-table th {\n            position: sticky;\n            top: 0;\n            z-index: 10;\n            background: #f8fafc;\n          }\n\n          .data-table tbody tr:hover {\n            background-color: rgba(59, 130, 246, 0.03);\n          }\n        "}),(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,xn.jsx)(Xa,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h2",{className:"text-xl font-bold text-white",children:"RFQ Data"}),(0,xn.jsx)("p",{className:"text-blue-100 text-sm",children:n?"Loading data...":"".concat(l.length," rows")})]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[!n&&!i&&l.length>0&&(0,xn.jsxs)("button",{onClick:()=>{if(0===l.length)return;const e=[d.join(","),...l.map(e=>d.map(t=>{const r=e[t];return r&&r.toString().includes(",")?'"'.concat(r,'"'):r||""}).join(","))].join("\n"),r=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(r);n.setAttribute("href",a),n.setAttribute("download","rfq_".concat(t,"_data.csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors duration-200 text-sm font-medium",children:[(0,xn.jsx)(Ya,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Download CSV"})]}),(0,xn.jsx)("button",{onClick:r,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors duration-200",children:(0,xn.jsx)(Ln,{className:"w-5 h-5"})})]})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-auto p-6",children:n?(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,xn.jsx)($a,{className:"w-8 h-8 text-blue-600 animate-spin"})}),(0,xn.jsx)("div",{className:"space-y-3",children:Array(5).fill(0).map((e,t)=>(0,xn.jsxs)("div",{className:"flex gap-4",children:[(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton flex-1"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton flex-1"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton flex-1"})]},t))})]}):i?(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,xn.jsx)(va,{className:"w-12 h-12 text-red-500 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-700 font-medium mb-2",children:"Error Loading Data"}),(0,xn.jsx)("p",{className:"text-slate-500 text-sm",children:i}),(0,xn.jsx)("button",{onClick:h,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Try Again"})]}):0===l.length?(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,xn.jsx)(Xa,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-500 font-medium",children:"No data available"}),(0,xn.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:"This RFQ has no associated data"})]}):(0,xn.jsx)("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full data-table border-collapse",children:[(0,xn.jsx)("thead",{children:(0,xn.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider bg-slate-50",children:"#"}),d.map(e=>(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider bg-slate-50 whitespace-nowrap",children:e},e))]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-200 bg-white",children:l.map((e,t)=>(0,xn.jsxs)("tr",{className:"transition-colors duration-150",children:[(0,xn.jsx)("td",{className:"px-4 py-3 text-sm text-slate-500 font-medium",children:t+1}),d.map(t=>(0,xn.jsx)("td",{className:"px-4 py-3 text-sm text-slate-700 whitespace-nowrap",children:null!==e[t]&&void 0!==e[t]&&""!==e[t]?e[t].toString():"-"},t))]},t))})]})})})}),!n&&!i&&l.length>0&&(0,xn.jsx)("div",{className:"px-6 py-4 border-t border-slate-200 bg-slate-50",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between text-sm text-slate-600",children:[(0,xn.jsxs)("div",{children:["Showing ",(0,xn.jsx)("span",{className:"font-medium text-slate-800",children:l.length})," rows",d.length>0&&(0,xn.jsxs)("span",{className:"ml-2",children:["with ",(0,xn.jsx)("span",{className:"font-medium text-slate-800",children:d.length})," columns"]})]}),(0,xn.jsx)("button",{onClick:r,className:"px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-white transition-colors duration-200 font-medium",children:"Close"})]})})]})})}function Qa(e){let{modalOpen:t,onEdit:r}=e;const[n,a]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{m()},[]);const m=async()=>{a(!0);try{const e=await(async()=>{try{return(await mn.get("".concat(pn,"/rfq"))).data}catch(e){throw new Error("Failed to fetch rfqs")}})();console.log("Fetched RFQ data:",e),c(e)}catch(e){console.error("Error fetching RFQ items:",e)}finally{a(!1)}},p=e=>{f(e),u(!0)},g=async e=>{console.log("Download RFQ:",e)},x=l.filter(e=>{var t,r;const n=i.toLowerCase(),a=(null===(t=e.rfq_number)||void 0===t?void 0:t.toLowerCase())||"",s=(null===(r=e.customer)||void 0===r?void 0:r.toLowerCase())||"";return a.includes(n)||s.includes(n)}),b=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},v=e=>{if(!e)return!1;const t=new Date(e),r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t<r};return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            background-position: -1000px 0;\n          }\n          100% {\n            background-position: 1000px 0;\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .skeleton {\n          animation: shimmer 2s infinite;\n          background: linear-gradient(\n            90deg,\n            #f0f0f0 25%,\n            #e0e0e0 50%,\n            #f0f0f0 75%\n          );\n          background-size: 1000px 100%;\n        }\n\n        .table-row-hover:hover {\n          background-color: rgba(59, 130, 246, 0.02);\n        }\n\n        .expired-row {\n          background-color: rgba(239, 68, 68, 0.05);\n        }\n\n        .expired-row:hover {\n          background-color: rgba(239, 68, 68, 0.08);\n        }\n\n        .expired-date {\n          color: #dc2626;\n          font-weight: 600;\n        }\n\n        .expired-badge {\n          display: inline-flex;\n          align-items: center;\n          gap: 4px;\n          padding: 2px 8px;\n          background-color: #fee2e2;\n          color: #991b1b;\n          border-radius: 6px;\n          font-size: 0.75rem;\n          font-weight: 500;\n        }\n      "}),(0,xn.jsxs)("main",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto",children:[(0,xn.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Gn,{className:"w-8 h-8 text-blue-600"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"RFQ"}),(0,xn.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Request for Quotation Data"})]})]})}),(0,xn.jsx)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:(0,xn.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg font-medium text-sm",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Add New RFQ"})]})})]}),(0,xn.jsx)("div",{className:"mb-6 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:(0,xn.jsxs)("div",{className:"relative max-w-md",children:[(0,xn.jsx)(ha,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search by RFQ number or customer...",value:i,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})}),(0,xn.jsxs)("div",{className:"flex flex-col bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"RFQ Number"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Customer"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Valid Date"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-200",children:n?Array(5).fill(0).map((e,t)=>(0,xn.jsxs)("tr",{className:"table-row-hover",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-28"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"h-8 w-8 bg-slate-200 rounded skeleton"}),(0,xn.jsx)("div",{className:"h-8 w-8 bg-slate-200 rounded skeleton"}),(0,xn.jsx)("div",{className:"h-8 w-8 bg-slate-200 rounded skeleton"})]})})]},t)):x.length>0?x.map((e,t)=>{const r=v(e.valid_date);return(0,xn.jsxs)("tr",{className:"table-row-hover transition-colors duration-150 ".concat(r?"expired-row":""),style:{animation:"fadeInUp 0.4s ease-out",animationDelay:"".concat(50*t,"ms"),animationFillMode:"both"},children:[(0,xn.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-slate-800",children:e.rfq_number||"N/A"}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.customer||"N/A"}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,xn.jsx)("span",{className:"text-sm ".concat(r?"expired-date":"text-slate-600"),children:b(e.valid_date)}),r&&(0,xn.jsxs)("span",{className:"expired-badge",children:[(0,xn.jsx)(va,{className:"w-3 h-3"}),"Expired"]})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("button",{onClick:()=>p(e.sysID),className:"p-1.5 hover:bg-blue-50 rounded-lg transition-colors duration-150 text-blue-600 hover:text-blue-700",title:"View Data",children:(0,xn.jsx)(fa,{className:"w-4 h-4"})}),(0,xn.jsx)("button",{onClick:()=>g(e),className:"p-1.5 hover:bg-green-50 rounded-lg transition-colors duration-150 text-green-600 hover:text-green-700",title:"Download",children:(0,xn.jsx)(Ya,{className:"w-4 h-4"})})]})})]},e.sysID)}):(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"4",className:"px-6 py-12",children:(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,xn.jsx)(Gn,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-500 font-medium",children:"No RFQ found"}),(0,xn.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new RFQ"})]})})})})]})}),(0,xn.jsx)("div",{className:"md:hidden space-y-4 p-4",children:n?Array(5).fill(0).map((e,t)=>(0,xn.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:(0,xn.jsxs)("div",{className:"space-y-3",children:[(0,xn.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-2/3"}),(0,xn.jsxs)("div",{className:"flex gap-2",children:[(0,xn.jsx)("div",{className:"h-9 bg-slate-200 rounded skeleton flex-1"}),(0,xn.jsx)("div",{className:"h-9 bg-slate-200 rounded skeleton flex-1"})]})]})},t)):x.length>0?x.map((e,t)=>{const r=v(e.valid_date);return(0,xn.jsxs)("div",{className:"border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 ".concat(r?"border-red-200 bg-red-50/50":"bg-white"),style:{animation:"fadeInUp 0.4s ease-out",animationDelay:"".concat(50*t,"ms"),animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"p-4 border-b ".concat(r?"border-red-100 bg-red-100/50":"border-slate-100 bg-blue-50"),children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,xn.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"RFQ Number"}),r&&(0,xn.jsxs)("span",{className:"expired-badge",children:[(0,xn.jsx)(va,{className:"w-3 h-3"}),"Expired"]})]}),(0,xn.jsx)("h3",{className:"text-base font-bold text-slate-900",children:e.rfq_number||"N/A"})]}),(0,xn.jsxs)("div",{className:"p-4 space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsx)("span",{className:"text-xs text-slate-500",children:"Customer"}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.customer||"N/A"})]}),(0,xn.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100",children:[(0,xn.jsx)("span",{className:"text-xs text-slate-500",children:"Valid Date"}),(0,xn.jsx)("span",{className:"text-sm font-semibold ".concat(r?"expired-date":"text-slate-900"),children:b(e.valid_date)})]})]}),(0,xn.jsxs)("div",{className:"px-4 py-3 bg-slate-50 border-t border-slate-100 flex items-center gap-2",children:[(0,xn.jsxs)("button",{onClick:()=>p(e.sysID),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,xn.jsx)(fa,{className:"w-4 h-4"}),"View Data"]}),(0,xn.jsxs)("button",{onClick:()=>g(e),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-sm font-medium text-green-600 hover:bg-green-50 rounded-lg transition-colors",children:[(0,xn.jsx)(Ya,{className:"w-4 h-4"}),"Download"]})]})]},e.sysID)}):(0,xn.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-12",children:(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,xn.jsx)(Gn,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-500 font-medium",children:"No RFQ found"}),(0,xn.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new RFQ"})]})})})]}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:()=>{m()},disabled:n,className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh",children:(0,xn.jsx)(la,{className:"w-5 h-5 ".concat(n?"animate-spin":"group-hover:rotate-180 transition-transform duration-300")})})}),(0,xn.jsx)("div",{className:"h-8"})]}),d&&(0,xn.jsx)(Ja,{rfqId:h,onClose:()=>{u(!1),f(null)}})]})}const Za=En("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var es={version:"0.18.5"},ts=1200,rs=1252,ns=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],as={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ss=function(e){-1!=ns.indexOf(e)&&(rs=as[0]=e)};var is=function(e){ts=e,ss(e)};function os(){is(1200),ss(1252)}function ls(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function cs(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ds,us=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?cs(e.slice(2)):65279==t?e.slice(1):e},hs=function(e){return String.fromCharCode(e)},fs=function(e){return String.fromCharCode(e)};var ms="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ps(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=ms.charAt(s)+ms.charAt(i)+ms.charAt(o)+ms.charAt(l);return t}function gs(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=ms.indexOf(e.charAt(l++))<<2|(s=ms.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&s)<<4|(i=ms.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(n)),a=(3&i)<<6|(o=ms.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var xs=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),bs=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(K_){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function vs(e){return xs?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function ys(e){return xs?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var ws=function(e){return xs?bs(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Ns(e){if("undefined"===typeof ArrayBuffer)return ws(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function js(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function ks(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ks(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ss=xs?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:bs(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var As=/\u0000/g,Cs=/[\u0001-\u0006]/g;function _s(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ts(e,t){var r=""+e;return r.length>=t?r:Hi("0",t-r.length)+r}function Es(e,t){var r=""+e;return r.length>=t?r:Hi(" ",t-r.length)+r}function Ls(e,t){var r=""+e;return r.length>=t?r:r+Hi(" ",t-r.length)}var Ps=Math.pow(2,32);function Os(e,t){return e>Ps||e<-Ps?function(e,t){var r=""+Math.round(e);return r.length>=t?r:Hi("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:Hi("0",t-r.length)+r}(Math.round(e),t)}function Fs(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Is=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rs=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Ds={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Ms={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Bs={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Us(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,d=0,u=Math.floor(a);c<t&&(o=(u=Math.floor(a))*i+s,d=u*c+l,!(a-u<5e-8));)a=1/(a-u),s=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=s):(d=c,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function zs(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++n,++o.D)),60===n)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var qs=new Date(1899,11,31,0,0,0),Hs=qs.getTime(),Ws=new Date(1900,2,1,0,0,0);function Vs(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Ws&&(r+=864e5),(r-(Hs+6e4*(e.getTimezoneOffset()-qs.getTimezoneOffset())))/864e5}function Gs(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ks(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=Gs(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=Gs(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Gs(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Ys(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Ks(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return pi(14,Vs(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Xs(e,t,r,n){var a,s="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return Rs[r.m-1][1];case 5:return Rs[r.m-1][0];default:return Rs[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return Is[r.q][0];default:return Is[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,(i=Math.round(o*(r.S+r.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Ts(i,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Ts(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Ts(a,c):""}function $s(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var Js=/%/g;function Qs(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Qs(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Zs=/# (\?+)( ?)\/( ?)(\d+)/;var ei=/^#*0*\.([0#]+)/,ti=/\).*[0#]/,ri=/\(###\) ###\\?-####/;function ni(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function ai(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function si(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ii(e,t,r){if(40===e.charCodeAt(0)&&!t.match(ti)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ii("n",n,r):"("+ii("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return ci(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(Js,""),a=t.length-n.length;return ci(e,n,r*Math.pow(10,2*a))+Hi("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Qs(t,r);if(36===t.charCodeAt(0))return"$"+ii(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Os(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Os(r,0))&&(a=""),a.length>t.length?a:ni(t.substr(0,t.length-a.length))+a;if(s=t.match(Zs))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(0===s?"":""+s)+" "+(0===i?Hi(" ",e[1].length+1+e[4].length):Es(i,e[1].length)+e[2]+"/"+e[3]+Ts(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+Os(l,t.length-t.indexOf("0"));if(s=t.match(ei))return a=ai(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ni(s[1])).replace(/\.$/,"."+ni(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Hi("0",ni(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+ai(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$s(Os(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ii(e,t,-r):$s(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+Ts(si(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ii(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(ii(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(ri))return"("+(a=ii(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Us(l,Math.pow(10,i)-1,!1),a=""+c," "==(d=ci("n",s[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],(d=Ls(o[2],i)).length<s[4].length&&(d=ni(s[4].substr(s[4].length-d.length))+d),a+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=Us(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Es(o[1],i)+s[2]+"/"+s[3]+Ls(o[2],i):Hi(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Os(r,0),t.length<=a.length?a:ni(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=t.indexOf(".")-i,h=t.length-a.length-u;return ni(t.substr(0,u)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=si(r,s[1].length),r<0?"-"+ii(e,t,-r):$s(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Ts(0,3-e.length):"")+e})+"."+Ts(i,s[1].length);switch(t){case"###,##0.00":return ii(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=$s(Os(l,0));return"0"!==f?c+f:"";case"###,###.00":return ii(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ii(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function oi(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+oi(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function li(e,t,r){if(40===e.charCodeAt(0)&&!t.match(ti)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?li("n",n,r):"("+li("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return ci(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(Js,""),a=t.length-n.length;return ci(e,n,r*Math.pow(10,2*a))+Hi("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return oi(t,r);if(36===t.charCodeAt(0))return"$"+li(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ts(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:ni(t.substr(0,t.length-a.length))+a;if(s=t.match(Zs))return function(e,t,r){return r+(0===t?"":""+t)+Hi(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Ts(l,t.length-t.indexOf("0"));if(s=t.match(ei))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+ni(s[1])).replace(/\.$/,"."+ni(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Hi("0",ni(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$s(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+li(e,t,-r):$s(""+r)+"."+Hi("0",s[1].length);if(s=t.match(/^#,#*,#0/))return li(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(li(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(ri))return"("+(a=li(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Us(l,Math.pow(10,i)-1,!1),a=""+c," "==(d=ci("n",s[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],(d=Ls(o[2],i)).length<s[4].length&&(d=ni(s[4].substr(s[4].length-d.length))+d),a+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=Us(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Es(o[1],i)+s[2]+"/"+s[3]+Ls(o[2],i):Hi(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ni(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=t.indexOf(".")-i,h=t.length-a.length-u;return ni(t.substr(0,u)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+li(e,t,-r):$s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Ts(0,3-e.length):"")+e})+"."+Ts(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=$s(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return li(e,t.slice(0,t.lastIndexOf(".")),r)+ni(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ci(e,t,r){return(0|r)===r?li(e,t,r):ii(e,t,r)}var di=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ui(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Fs(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(di))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var hi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function fi(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function mi(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(hi),o=r[1].match(hi);return fi(t,i)?[n,r[0]]:fi(t,o)?[n,r[1]]:[n,r[null!=i&&null!=o?2:1]]}return[n,s]}function pi(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Ds)[e])&&(n=r.table&&r.table[Ms[e]]||Ds[Ms[e]]),null==n&&(n=Bs[e]||"General")}if(Fs(n,0))return Ys(t,r);t instanceof Date&&(t=Vs(t,r.date1904));var a=mi(n,t);if(Fs(a[1]))return Ys(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,s,i,o=[],l="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Fs(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=zs(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=zs(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"\u4e0a":var p={t:d,v:d};if(null==a&&(a=zs(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(p.v=a.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==a&&"T"===p.t)return"";o[o.length]=p,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(di)){if(null==a&&null==(a=zs(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ui(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===n?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,x=0,b=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,u="h",x<1&&(x=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&o[c].v.match(/[Hh]/)&&(x=1),x<2&&o[c].v.match(/[Mm]/)&&(x=2),x<3&&o[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var v,y="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Xs(o[c].t.charCodeAt(0),o[c].v,a,b),o[c].t="t";break;case"n":case"?":for(v=c+1;null!=o[v]&&("?"===(d=o[v].t)||"D"===d||(" "===d||"t"===d)&&null!=o[v+1]&&("?"===o[v+1].t||"t"===o[v+1].t&&"/"===o[v+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[v].v||" "===o[v].v&&null!=o[v+1]&&"?"==o[v+1].t));)o[c].v+=o[v].v,o[v]={v:"",t:";"},++v;y+=o[c].v,c=v-1;break;case"G":o[c].t="t",o[c].v=Ys(t,r)}var w,N,j="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,N=ci("n",y,w)):(N=ci("n",y,w=t<0&&n>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(N=N.substr(1),o[0].v="-"+o[0].v)),v=N.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var S=o.length;if(k===o.length&&-1===N.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(v>=o[c].v.length-1?(v-=o[c].v.length,o[c].v=N.substr(v+1,o[c].v.length)):v<0?o[c].v="":(o[c].v=N.substr(0,v+1),v=-1),o[c].t="t",S=c);v>=0&&S<o.length&&(o[S].v=N.substr(0,v+1)+o[S].v)}else if(k!==o.length&&-1===N.indexOf("E")){for(v=N.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,j=o[c].v.substr(s+1);s>=0;--s)v>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(j=N.charAt(v--)+j);o[c].v=j,o[c].t="t",S=c}for(v>=0&&S<o.length&&(o[S].v=N.substr(0,v+1)+o[S].v),v=N.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(s=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,j=o[c].v.substr(0,s);s<o[c].v.length;++s)v<N.length&&(j+=N.charAt(v++));o[c].v=j,o[c].t="t",S=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=n>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=ci(o[c].t,o[c].v,w),o[c].t="t");var A="";for(c=0;c!==o.length;++c)null!=o[c]&&(A+=o[c].v);return A}(a[1],t,r,a[0])}function gi(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=Ds[r]){if(Ds[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Ds[t]=e,t}function xi(e){for(var t=0;392!=t;++t)void 0!==e[t]&&gi(e[t],t)}function bi(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Ds=e}var vi={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},yi=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var wi=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!==typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return s}(t),n=r[0],a=r[1],s=r[2],i=r[3],o=r[4],l=r[5],c=r[6],d=r[7],u=r[8],h=r[9],f=r[10],m=r[11],p=r[12],g=r[13],x=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,a=0,s=e.length;a<s;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var b=-1^r,v=e.length-15,y=0;y<v;)b=x[e[y++]^255&b]^g[e[y++]^b>>8&255]^p[e[y++]^b>>16&255]^m[e[y++]^b>>>24]^f[e[y++]]^h[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^l[e[y++]]^o[e[y++]]^i[e[y++]]^s[e[y++]]^a[e[y++]]^n[e[y++]]^t[e[y++]];for(v+=15;y<v;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,r){for(var n=-1^r,a=0,s=e.length,i=0,o=0;a<s;)(i=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^i)]:i<2048?n=(n=n>>>8^t[255&(n^(192|i>>6&31))])>>>8^t[255&(n^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|i>>8&7))])>>>8^t[255&(n^(128|i>>2&63))])>>>8^t[255&(n^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(n^(128|63&o))]):n=(n=(n=n>>>8^t[255&(n^(224|i>>12&15))])>>>8^t[255&(n^(128|i>>6&63))])>>>8^t[255&(n^(128|63&i))];return~n},e}(),Ni=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function s(e){Gl(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};if(21589===n)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[n]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=N(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(xs&&Buffer.isBuffer(e)?e.toString("binary"):N(e)).split("\r\n"),a=0,s="";for(a=0;a<n.length;++a)if(s=n[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(n[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};h(d);var u,f=0;for(a=0;a<n.length;++a){var m=n[a];m!==o&&m!==o+"--"||(f++&&ce(d,n.slice(u,a),r),u=a)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,s,i,o,f=512,m=[],p=e.slice(0,512);Gl(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&Gl(p=e.slice(0,f),28);var v=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var y=p.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),n=p.read_shift(4,"i"),o=p.read_shift(4,"i"),a=p.read_shift(4,"i");for(var w=-1,j=0;j<109&&!((w=p.read_shift(4,"i"))<0);++j)m[j]=w;var k=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);c(o,a,k,f,m);var S=function(e,t,r,n){var a=e.length,s=[],i=[],o=[],l=[],c=n-1,d=0,u=0,h=0,f=0;for(d=0;d<a;++d)if(o=[],(h=d+t)>=a&&(h-=a),!i[h]){l=[];var m=[];for(u=h;u>=0;){m[u]=!0,i[u]=!0,o[o.length]=u,l.push(e[u]);var p=r[Math.floor(4*u/n)];if(n<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+n);if(!e[p])break;if(m[u=Ml(e[p],f)])break}s[h]={nodes:o,data:fl([l])}}return s}(k,s,m,f);S[s].name="!Directory",n>0&&i!==x&&(S[i].name="!MiniFAT"),S[m[0]].name="!FAT",S.fat_addrs=m,S.ssz=f;var A=[],C=[],_=[];!function(e,t,r,n,a,s,i,o){for(var c,h=0,f=n.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var b=m.slice(p,p+128);Gl(b,64),g=b.read_shift(2),c=pl(b,0,g-f),n.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=u(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=u(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=x,v.name=""),5===v.type?(h=v.start,a>0&&h!==x&&(t[h].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=d(r,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:h!==x&&v.start!==x&&t[h]&&(v.content=l(v,t[h].data,(t[o]||{}).data))),v.content&&Gl(v.content,0),s[c]=v,i.push(v)}}(s,S,k,A,n,{},C,i),function(e,t,r){for(var n=0,a=0,s=0,i=0,o=0,l=r.length,c=[],d=[];n<l;++n)c[n]=d[n]=n,t[n]=r[n];for(;o<d.length;++o)a=e[n=d[o]].L,s=e[n].R,i=e[n].C,c[n]===n&&(-1!==a&&c[a]!==a&&(c[n]=c[a]),-1!==s&&c[s]!==s&&(c[n]=c[s])),-1!==i&&(c[i]=n),-1!==a&&n!=c[n]&&(c[a]=c[n],d.lastIndexOf(a)<o&&d.push(a)),-1!==s&&n!=c[n]&&(c[s]=c[n],d.lastIndexOf(s)<o&&d.push(s));for(n=1;n<l;++n)c[n]===n&&(-1!==s&&c[s]!==s?c[n]=c[s]:-1!==a&&c[a]!==a&&(c[n]=c[a]));for(n=1;n<l;++n)if(0!==e[n].type){if((o=n)!=c[o])do{o=c[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(C,_,A),A.shift();var T={FileIndex:C,FullPaths:_};return t&&t.raw&&(T.raw={header:v,sectors:k}),T}function l(e,t,r){for(var n=e.start,a=e.size,s=[],i=n;r&&a>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),a-=g,i=Ml(r,4*i);return 0===s.length?Yl(0):Ss(s).slice(0,e.size)}function c(e,t,r,n,a){var s=x;if(e===x){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],o=(n>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=Ml(i,4*l))!==x;++l)a.push(s);c(Ml(i,n-4),t-1,r,n,a)}}function d(e,t,r,n,a){var s=[],i=[];a||(a=[]);var o=n-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,i.push(e[l]);var d=r[Math.floor(4*l/n)];if(n<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[d])break;l=Ml(e[d],c)}return{nodes:s,data:fl([i])}}function u(e,t){return new Date(1e3*(Dl(e,t+4)/1e7*Math.pow(2,32)+Dl(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Ni.find(e,"/"+t))return;var r=Yl(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var f=r(u[i][0]);(s=d[f])||(u.push([f,{name:n(f).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),d[f]=!0)}for(u.sort(function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,s=0,i=Math.min(r.length,n.length);a<i;++a){if(s=r[a].length-n[a].length)return s;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=n(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||y,0===i)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=i+1;c<u.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=u.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=xs&&Buffer.isBuffer(c)?c.toString("binary"):N(c),u=0,h=Math.min(1024,d.length),f=0,m=0;m<=h;++m)(f=d.charCodeAt(m))>=32&&f<128&&++u;var p=u>=4*h/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),a.push("Content-Type: "+ie(o,i)),a.push(""),a.push(p?le(d):oe(d))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],s=[],i=Yl(1),o=r.compression?8:0,l=0;0;var c=0,d=0,u=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var b=u,v=Yl(m.length);for(d=0;d<m.length;++d)v.write_shift(1,127&m.charCodeAt(d));v=v.slice(0,v.l),g[h]=wi.buf(p.content,0);var y=p.content;8==o&&(y=j(y)),(i=Yl(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?a(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[h]),i.write_shift(4,8&l?0:y.length),i.write_shift(4,8&l?0:p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),u+=i.length,n.push(i),u+=v.length,n.push(v),u+=y.length,n.push(y),8&l&&((i=Yl(12)).write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),u+=i.l,n.push(i)),(i=Yl(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),x+=i.l,s.push(i),x+=v.length,s.push(v),++h}return i=Yl(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,x),i.write_shift(4,u),i.write_shift(2,0),Ss([Ss(n),Ss(s),i])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+i+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,o,i,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),s=Yl(n[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,v[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:x),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:x),s.write_shift(4,n[1]),i=0;i<109;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);if(n[1])for(o=0;o<n[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);s.write_shift(-4,o===n[1]-1?x:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,x))};for(o=i=0,o+=n[1];i<o;++i)s.write_shift(-4,w.DIFSECT);for(o+=n[2];i<o;++i)s.write_shift(-4,w.FATSECT);l(n[3]),l(n[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=o,l(d+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=o,l(d+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<n[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:x);var m=0===i&&r.root||u.name;if(d=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,d),s.write_shift(1,u.type),s.write_shift(1,u.color),s.write_shift(-4,u.L),s.write_shift(-4,u.R),s.write_shift(-4,u.C),u.clsid)s.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,u.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,u.start),s.write_shift(4,u.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(s.l=u.start+1<<9,xs&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(xs&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(xs)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var p,g=64,x=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function j(e){return p?p.deflateRawSync(e):Y(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var _="undefined"!==typeof Uint8Array,T=_?new Uint8Array(256):[],E=0;E<256;++E)T[E]=C(E);function L(e,t){var r=T[255&e];return t<=8?r>>>8-t:(r=r<<8|T[e>>8&255],t<=16?r>>>16-t:(r=r<<8|T[e>>16&255])>>>24-t)}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function O(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function F(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function I(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function R(e,t,r){var n=7&t,a=t>>>3,s=(1<<r)-1,i=e[a]>>>n;return r<8-n?i&s:(i|=e[a+1]<<8-n,r<16-n?i&s:(i|=e[a+2]<<16-n,r<24-n?i&s:(i|=e[a+3]<<24-n)&s))}function D(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function M(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function U(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function z(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(xs){var s=ys(n);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(_){var i=new Uint8Array(n);if(i.set)i.set(e);else for(;a<r;++a)i[a]=e[a];return i}return e.length=n,e}function q(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var n=1,a=0,s=0,i=0,o=0,l=e.length,c=_?new Uint16Array(32):q(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var d=_?new Uint16Array(l):q(l);for(s=0;s<l;++s)c[a=e[s]]++,n<a&&(n=a),d[s]=0;for(c[0]=0,s=1;s<=n;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(d[s]=c[o+16]++);var u=0;for(s=0;s<l;++s)if(0!=(u=e[s]))for(o=L(d[s],n)>>n-u,i=(1<<n+4-u)-1;i>=0;--i)t[o|i<<u]=15&u|s<<4;return n}var W=_?new Uint16Array(512):q(512),V=_?new Uint16Array(32):q(32);if(!_){for(var G=0;G<512;++G)W[G]=0;for(G=0;G<32;++G)V[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,V,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,W,288)}();var K=function(){for(var e=_?new Uint8Array(32768):[],t=0,r=0;t<A.length-1;++t)for(;r<A[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=_?new Uint8Array(259):[];for(t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,s=0,i=_?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=D(r,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[s++];a=8*r.l}else{a=D(r,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],d=-1,u=0;if((d=i[l=32767&(l<<5^c)])&&((d|=-32768&s)>s&&(d-=32768),d<s))for(;t[d+u]==t[s+u]&&u<250;)++u;if(u>2){(c=n[u])<=22?a=B(r,a,T[c+1]>>1)-1:(B(r,a,3),B(r,a+=5,T[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(U(r,a,u-S[c]),a+=h),c=e[s-d],a=B(r,a,T[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(U(r,a,s-d-A[c]),a+=f);for(var m=0;m<u;++m)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=u-1}else c<=143?c+=48:a=M(r,a,1),a=B(r,a,T[c]),i[l]=32767&s,++s}a=B(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function Y(e){var t=Yl(50+Math.floor(1.1*e.length)),r=K(e,t);return t.slice(0,r)}var X=_?new Uint16Array(32768):q(32768),$=_?new Uint16Array(32768):q(32768),J=_?new Uint16Array(128):q(128),Q=1,Z=1;function ee(e,t){var r=F(e,t)+257,n=F(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,i=_?new Uint8Array(19):q(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=_?new Uint8Array(8):q(8),d=_?new Uint8Array(8):q(8),u=i.length,h=0;h<a;++h)i[k[h]]=s=O(e,t),l<s&&(l=s),c[s]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)d[h]=f=f+c[h-1]<<1;for(h=0;h<u;++h)0!=(f=i[h])&&(o[h]=d[f]++);var m=0;for(h=0;h<u;++h)if(0!=(m=i[h])){f=T[o[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)J[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<r+n;)switch(t+=7&(f=J[I(e,t)]),f>>>=3){case 16:for(s=3+P(e,t),t+=2,f=g[g.length-1];s-- >0;)g.push(f);break;case 17:for(s=3+O(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+I(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var x=g.slice(0,r),b=g.slice(r);for(h=r;h<286;++h)x[h]=0;for(h=n;h<30;++h)b[h]=0;return Q=H(x,X,286),Z=H(b,$,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[vs(t),2];for(var r=0,n=0,a=ys(t||1<<18),s=0,i=a.length>>>0,o=0,l=0;0==(1&n);)if(n=O(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(r=ee(e,r),o=Q,l=Z);;){!t&&i<s+32767&&(i=(a=z(a,s+32767)).length);var c=R(e,r,o),d=n>>>1==1?W[c]:X[c];if(r+=15&d,0===((d>>>=4)>>>8&255))a[s++]=d;else{if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=s+S[d];u>0&&(h+=R(e,r,u),r+=u),c=R(e,r,l),r+=15&(d=n>>>1==1?V[c]:$[c]);var f=(d>>>=4)<4?0:d-2>>1,m=A[d];for(f>0&&(m+=R(e,r,f),r+=f),!t&&i<h&&(i=(a=z(a,h+100)).length);s<h;)a[s]=a[s-m],++s}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<s+p&&(i=(a=z(a,s+p)).length);p-- >0;)a[s++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;Gl(r,0);var n={FileIndex:[],FullPaths:[]};h(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,a=0;a<i;++a){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),u=r.read_shift(2),f=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=s(r.slice(r.l+d,r.l+d+u));r.l+=d+u+f;var g=r.l;r.l=m+4,ae(r,l,c,n,p),r.l=g}return n}function ae(e,t,r,n,a){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,s=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(a);var i=31&t,o=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(i<<1),n}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<u;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=s(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=h;var x=e.slice(e.l,e.l+c);switch(o){case 8:x=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&re(b,"Bad compressed size: "+t+" != "+c),d!=r&&re(b,"Bad uncompressed size: "+r+" != "+d),de(n,f,x,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&se[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[n[1]]?se[n[1]]:"application/octet-stream"}function oe(e){for(var t=ps(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var s=n[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,a="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":n=ws(gs(t.slice(o).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return ws(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var d=de(e,a.slice(r.length),n,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,r,a){var s=a&&a.unsafe;s||h(e);var i=!s&&Ni.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:n(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||Ni.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),n=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?r.indexOf(s):n.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Cs);for(s=s.replace(As,""),o&&(s=s.replace(Cs,"!")),i=0;i<r.length;++i){if((o?r[i].replace(Cs,"!"):r[i]).replace(As,"")==s)return e.FileIndex[i];if((o?n[i].replace(Cs,"!"):n[i]).replace(As,"")==s)return e.FileIndex[i]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||xs&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return i(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(ws(gs(t)),r);case"binary":return o(ws(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var n=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:N(n);case"base64":return ps("string"==typeof n?n:N(n));case"buffer":if(xs)return Buffer.isBuffer(n)?n:bs(n);case"array":return"string"==typeof n?ws(n):n}return n},t.writeFile=function(t,r,n){i();var a=m(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var r=Ni.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var a=Ni.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ul,CheckField:Vl,prep_blob:Gl,bconcat:Ss,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(K_){console.error("cannot use native zlib: "+(K_.message||K_))}},_deflateRaw:Y,_inflateRaw:te,consts:w},t}();let ji;function ki(e){return"string"===typeof e?Ns(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Si(e,t,r){if("undefined"!==typeof ji&&ji.writeFileSync)return r?ji.writeFileSync(e,t,r):ji.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ns(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?Lo(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!==typeof Blob){var a=new Blob([ki(n)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=js(t)),o.write(t),o.close(),t}catch(K_){if(!K_.message||!K_.message.match(/onstruct/))throw K_}throw new Error("cannot save file "+e)}function Ai(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ci(e,t){for(var r=[],n=Ai(e),a=0;a!==n.length;++a)null==r[e[n[a]][t]]&&(r[e[n[a]][t]]=n[a]);return r}function _i(e){for(var t=[],r=Ai(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Ti(e){for(var t=[],r=Ai(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}var Ei=new Date(1899,11,30,0,0,0);function Li(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Ei.getTime()+6e4*(e.getTimezoneOffset()-Ei.getTimezoneOffset())))/864e5}var Pi=new Date,Oi=Ei.getTime()+6e4*(Pi.getTimezoneOffset()-Ei.getTimezoneOffset()),Fi=Pi.getTimezoneOffset();function Ii(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Oi),t.getTimezoneOffset()!==Fi&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Fi)),t}function Ri(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(a[s],10)}return t}var Di=new Date("2017-02-19T19:06:09.000Z"),Mi=isNaN(Di.getFullYear())?new Date("2/19/17"):Di,Bi=2017==Mi.getFullYear();function Ui(e,t){var r=new Date(e);if(Bi)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Mi.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function zi(e,t){if(xs&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Lo(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Lo(cs(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Lo(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Lo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(K_){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function qi(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=qi(e[r]));return t}function Hi(e,t){for(var r="";r.length<t;)r+=e;return r}function Wi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(n))?t:t/r):t/r}var Vi=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Vi.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Ki=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),s=[a[0]],i=1;i<a.length;++i)s.push(n),s.push(a[i]);return s}}();function Yi(e){return e?e.content&&e.type?zi(e.content,!0):e.data?us(e.data):e.asNodeBuffer&&xs?us(e.asNodeBuffer().toString("binary")):e.asBinary?us(e.asBinary()):e._data&&e._data.getContent?us(zi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Xi(e){if(!e)return null;if(e.data)return ls(e.data);if(e.asNodeBuffer&&xs)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?ls(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function $i(e,t){for(var r=e.FullPaths||Ai(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ji(e,t){var r=$i(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Qi(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?Xi(e):Yi(e)}(Ji(e,t));if(!t)return null;try{return Qi(e,t)}catch(K_){return null}}function Zi(e,t,r){if(!r)return Yi(Ji(e,t));if(!t)return null;try{return Zi(e,t)}catch(K_){return null}}function eo(e,t,r){if(!r)return Xi(Ji(e,t));if(!t)return null;try{return eo(e,t)}catch(K_){return null}}function to(e){for(var t=e.FullPaths||Ai(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ro(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=xs?bs(r):function(e){for(var t=[],r=0,n=e.length+250,a=vs(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(3&i)<<4,a[r++]=128|63&o}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|63&i;r>n&&(t.push(a.slice(0,r)),r=0,a=vs(65535),n=65530)}return t.push(a.slice(0,r)),Ss(t)}(r),Ni.utils.cfb_add(e,t,n);Ni.utils.cfb_add(e,t,r)}else e.file(t,r)}function no(){return Ni.utils.cfb_new()}function ao(e,t){switch(t.type){case"base64":return Ni.read(e,{type:"base64"});case"binary":return Ni.read(e,{type:"binary"});case"buffer":case"array":return Ni.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function so(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var io='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',oo=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,lo=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,co=io.match(lo)?lo:/<[^>]*>/g,uo=/<\w*:/,ho=/<(\/?)\w+:/;function fo(e,t,r){for(var n={},a=0,s=0;a!==e.length&&(32!==(s=e.charCodeAt(a))&&10!==s&&13!==s);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(oo),o=0,l="",c=0,d="",u="",h=1;if(i)for(c=0;c!=i.length;++c){for(u=i[c],s=0;s!=u.length&&61!==u.charCodeAt(s);++s);for(d=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(h=34==(a=u.charCodeAt(s+1))||39==a?1:0,l=u.slice(s+1+h,u.length-h),o=0;o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,r||(n[d.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(n[f]&&"ext"==d.slice(o-3,o))continue;n[f]=l,r||(n[f.toLowerCase()]=l)}}return n}function mo(e){return e.replace(ho,"<$1")}var po={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},go=_i(po),xo=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,function(e,t){return po[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),bo=/[&<>'"]/g,vo=/[\u0000-\u0008\u000b-\u001f]/g;function yo(e){return(e+"").replace(bo,function(e){return go[e]}).replace(vo,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wo(e){return yo(e).replace(/ /g,"_x0020_")}var No=/[\u0000-\u001f]/g;function jo(e){return(e+"").replace(bo,function(e){return go[e]}).replace(/\n/g,"<br/>").replace(No,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var ko=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function So(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ao(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(i=(31&n)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s):(o=((7&n)<<18|(63&a)<<12|(63&s)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Co(e){var t,r,n,a=vs(2*e.length),s=1,i=0,o=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function _o(e){return bs(e,"binary").toString("utf8")}var To="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Eo=xs&&(_o(To)==Ao(To)&&_o||Co(To)==Ao(To)&&Co)||Ao,Lo=xs?function(e){return bs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},Po=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Oo=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),Fo=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Io=/<\/?(?:vt:)?variant>/g,Ro=/<(?:vt:)([^>]*)>([\s\S]*)</;function Do(e,t){var r=fo(e),n=e.match(Fo(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(e){var t=e.replace(Io,"").match(Ro);t&&a.push({v:Eo(t[2]),t:t[1]})}),a}var Mo=/(^\s|\s$|\n)/;function Bo(e,t){return"<"+e+(t.match(Mo)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Uo(e){return Ai(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function zo(e,t,r){return"<"+e+(null!=r?Uo(r):"")+(null!=t?(t.match(Mo)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qo(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(K_){if(t)throw K_}return""}function Ho(e){if(xs&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Eo(js(ks(e)));throw new Error("Bad input format: expected Buffer or string")}var Wo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Vo="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Go="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Ko="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Yo="http://schemas.openxmlformats.org/package/2006/content-types",Xo="http://schemas.openxmlformats.org/package/2006/relationships",$o="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Jo="http://purl.org/dc/elements/1.1/",Qo="http://purl.org/dc/terms/",Zo="http://purl.org/dc/dcmitype/",el="http://schemas.openxmlformats.org/officeDocument/2006/relationships",tl="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",rl="http://www.w3.org/2001/XMLSchema-instance",nl="http://www.w3.org/2001/XMLSchema",al=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sl="urn:schemas-microsoft-com:office:office",il="urn:schemas-microsoft-com:office:excel",ol="urn:schemas-microsoft-com:office:spreadsheet",ll="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",cl="http://macVmlSchemaUri",dl="urn:schemas-microsoft-com:vml",ul="http://www.w3.org/TR/REC-html40";var hl=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},fl=xs?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:bs(e)})):hl(e)}:hl,ml=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Il(e,a)));return n.join("").replace(As,"")},pl=xs?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(As,""):ml(e,t,r)}:ml,gl=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},xl=xs?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gl(e,t,r)}:gl,bl=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Fl(e,a)));return n.join("")},vl=xs?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):bl(e,t,r)}:bl,yl=function(e,t){var r=Dl(e,t);return r>0?vl(e,t+4,t+4+r-1):""},wl=yl,Nl=function(e,t){var r=Dl(e,t);return r>0?vl(e,t+4,t+4+r-1):""},jl=Nl,kl=function(e,t){var r=2*Dl(e,t);return r>0?vl(e,t+4,t+4+r-1):""},Sl=kl,Al=function(e,t){var r=Dl(e,t);return r>0?pl(e,t+4,t+4+r):""},Cl=Al,_l=function(e,t){var r=Dl(e,t);return r>0?vl(e,t+4,t+4+r):""},Tl=_l,El=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},Ll=El,Pl=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Ol(){pl=function(e,t,r){return ds.utils.decode(1200,e.slice(t,r)).replace(As,"")},vl=function(e,t,r){return ds.utils.decode(65001,e.slice(t,r))},wl=function(e,t){var r=Dl(e,t);return r>0?ds.utils.decode(rs,e.slice(t+4,t+4+r-1)):""},jl=function(e,t){var r=Dl(e,t);return r>0?ds.utils.decode(ts,e.slice(t+4,t+4+r-1)):""},Sl=function(e,t){var r=2*Dl(e,t);return r>0?ds.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Cl=function(e,t){var r=Dl(e,t);return r>0?ds.utils.decode(1200,e.slice(t+4,t+4+r)):""},Tl=function(e,t){var r=Dl(e,t);return r>0?ds.utils.decode(65001,e.slice(t+4,t+4+r)):""}}xs&&(wl=function(e,t){if(!Buffer.isBuffer(e))return yl(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},jl=function(e,t){if(!Buffer.isBuffer(e))return Nl(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Sl=function(e,t){if(!Buffer.isBuffer(e))return kl(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Cl=function(e,t){if(!Buffer.isBuffer(e))return Al(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Tl=function(e,t){if(!Buffer.isBuffer(e))return _l(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Ll=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):El(e,t)},Pl=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ds&&Ol();var Fl=function(e,t){return e[t]},Il=function(e,t){return 256*e[t+1]+e[t]},Rl=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Dl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ml=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Bl=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ul(e,t){var r,n,a,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,xs&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Il(this,o)),o+=2;e*=2;break;case"utf8":l=vl(this,this.l,this.l+e);break;case"utf16le":e*=2,l=pl(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ds)return Ul.call(this,e,"dbcs");l=ds.utils.decode(ts,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=wl(this,this.l),e=4+Dl(this,this.l);break;case"lpstr-cp":l=jl(this,this.l),e=4+Dl(this,this.l);break;case"lpwstr":l=Sl(this,this.l),e=4+2*Dl(this,this.l);break;case"lpp4":e=4+Dl(this,this.l),l=Cl(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Dl(this,this.l),l=Tl(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Fl(this,this.l+e++));)c.push(hs(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Il(this,this.l+e));)c.push(hs(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Fl(this,o),this.l=o+1,s=Ul.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(hs(Il(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ds){l=ds.utils.decode(ts,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Fl(this,o),this.l=o+1,s=Ul.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(hs(Fl(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=Fl(this,this.l),this.l++,r;case 2:return r=("i"===t?Rl:Il)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Ml:Bl)(this,this.l),this.l+=4,r):(n=Dl(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?Ll(this,this.l):Ll([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=xl(this,this.l,e)}}return this.l+=e,l}var zl=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ql=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Hl=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Wl(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)Hl(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof ds&&874==rs)for(a=0;a!=t.length;++a){var s=ds.utils.encode(rs,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,zl(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=255&s;e[r+6]=(15&a)<<4|15&s,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,ql(this,t,this.l)}}return this.l+=n,this}function Vl(e,t){var r=xl(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Gl(e,t){e.l=t,e.read_shift=Ul,e.chk=Vl,e.write_shift=Wl}function Kl(e,t){e.l+=t}function Yl(e){var t=vs(e);return Gl(t,0),t}function Xl(e,t,r){if(e){var n,a,s;Gl(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=ag[o]||ag[65535];for(s=127&(n=e.read_shift(1)),a=1;a<4&&128&n;++a)s+=(127&(n=e.read_shift(1)))<<7*a;l=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=l,t(d,c,o))return}}}function $l(){var e=[],t=xs?256:2048,r=function(e){var t=Yl(e);return Gl(t,0),t},n=r(t),a=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},s=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(n=e).l&&(n.l=n.length),s(t)},end:function(){return a(),Ss(e)},_bufs:e}}function Jl(e,t,r,n){var a,s=+t;if(!isNaN(s)){n||(n=ag[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,128+(127&s)),i.write_shift(1,s>>7));for(var o=0;4!=o;++o){if(!(n>=128)){i.write_shift(1,n);break}i.write_shift(1,128+(127&n)),n>>=7}n>0&&Pl(r)&&e.push(r)}}function Ql(e,t,r){var n=qi(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Zl(e,t,r){var n=qi(e);return n.s=Ql(n.s,t.s,r),n.e=Ql(n.e,t.s,r),n}function ec(e,t){if(e.cRel&&e.c<0)for(e=qi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=oc(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function tc(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?ec(e.s,t.biff)+":"+ec(e.e,t.biff):(e.s.rRel?"":"$")+nc(e.s.r)+":"+(e.e.rRel?"":"$")+nc(e.e.r):(e.s.cRel?"":"$")+sc(e.s.c)+":"+(e.e.cRel?"":"$")+sc(e.e.c)}function rc(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function nc(e){return""+(e+1)}function ac(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sc(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ic(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function oc(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function lc(e){var t=e.indexOf(":");return-1==t?{s:ic(e),e:ic(e)}:{s:ic(e.slice(0,t)),e:ic(e.slice(t+1))}}function cc(e,t){return"undefined"===typeof t||"number"===typeof t?cc(e.s,e.e):("string"!==typeof e&&(e=oc(e)),"string"!==typeof t&&(t=oc(t)),e==t?e:e+":"+t)}function dc(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function uc(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=pi(e.z,r?Li(t):t)}catch(K_){}try{return e.w=pi((e.XF||{}).numFmtId||(r?14:0),r?Li(t):t)}catch(K_){return""+t}}function hc(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Jc[e.v]||e.v:uc(e,void 0==t?e.v:t))}function fc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function mc(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense;var s=e||(a?[]:{}),i=0,o=0;if(s&&null!=n.origin){if("number"==typeof n.origin)i=n.origin;else{var l="string"==typeof n.origin?ic(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=dc(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if("undefined"!==typeof t[u][h]){var f={v:t[u][h]},m=i+u,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!==typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Ds[14],n.cellDates?(f.t="d",f.w=pi(f.z,Li(f.v))):(f.t="n",f.v=Li(f.v),f.w=pi(f.z,f.v))):f.t="s";else f=t[u][h];if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(f.z=s[m][p].z),s[m][p]=f;else{var g=oc({c:p,r:m});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=cc(c)),s}function pc(e,t){return mc(null,e,t)}function gc(e,t){return t||(t=Yl(4)),t.write_shift(4,e),t}function xc(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function bc(e,t){var r=!1;return null==t&&(r=!0,t=Yl(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function vc(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yc(e,t){var r=e.l,n=e.read_shift(1),a=xc(e),s=[],i={t:a,h:a};if(0!==(1&n)){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(vc(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var wc=yc;function Nc(e,t){var r=!1;return null==t&&(r=!0,t=Yl(23+4*e.t.length)),t.write_shift(1,1),bc(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Yl(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function jc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function kc(e,t){return null==t&&(t=Yl(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Sc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ac(e,t){return null==t&&(t=Yl(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Cc=xc,_c=bc;function Tc(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Ec(e,t){var r=!1;return null==t&&(r=!0,t=Yl(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Lc=xc,Pc=Tc,Oc=Ec;function Fc(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?Ll([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Ml(t,0)>>2;return r?a/100:a}function Ic(e,t){null==t&&(t=Yl(4));var r=0,n=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?a:e)<<2)+(r+2))}function Rc(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Dc=Rc,Mc=function(e,t){return t||(t=Yl(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Bc(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Uc(e,t){return(t||Yl(8)).write_shift(8,e,"f")}function zc(e,t){if(t||(t=Yl(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function qc(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Hc=80,Wc=[Hc,81],Vc={1:{n:"CodePage",t:2},2:{n:"Category",t:Hc},3:{n:"PresentationFormat",t:Hc},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Hc},15:{n:"Company",t:Hc},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Hc},27:{n:"ContentStatus",t:Hc},28:{n:"Language",t:Hc},29:{n:"Version",t:Hc},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Gc={1:{n:"CodePage",t:2},2:{n:"Title",t:Hc},3:{n:"Subject",t:Hc},4:{n:"Author",t:Hc},5:{n:"Keywords",t:Hc},6:{n:"Comments",t:Hc},7:{n:"Template",t:Hc},8:{n:"LastAuthor",t:Hc},9:{n:"RevNumber",t:Hc},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Hc},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Kc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Yc=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Xc(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var $c=qi(Xc([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Jc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qc={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ed={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function td(e,t){var r,n=function(e){for(var t=[],r=Ai(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}(Zc),a=[];a[a.length]=io,a[a.length]=zo("Types",null,{xmlns:Yo,"xmlns:xsd":nl,"xmlns:xsi":rl}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return zo("Default",null,{Extension:e[0],ContentType:e[1]})}));var s=function(n){e[n]&&e[n].length>0&&(r=e[n][0],a[a.length]=zo("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:ed[n][t.bookType]||ed[n].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){a[a.length]=zo("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ed[r][t.bookType]||ed[r].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){a[a.length]=zo("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:n[t][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var rd={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function nd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ad(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(co)||[]).forEach(function(e){var a=fo(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var i="External"===a.TargetMode?a.Target:so(a.Target,t);r[i]=s,n[a.Id]=s}}),r["!id"]=n,r}function sd(e){var t=[io,zo("Relationships",null,{xmlns:Xo})];return Ai(e["!id"]).forEach(function(r){t[t.length]=zo("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function id(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,s?a.TargetMode=s:[rd.HLINK,rd.XPATH,rd.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function od(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function ld(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function cd(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+es.version+"</meta:generator></office:meta></office:document-meta>"}var dd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ud=function(){for(var e=new Array(dd.length),t=0;t<dd.length;++t){var r=dd[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function hd(e){var t={};e=Eo(e);for(var r=0;r<dd.length;++r){var n=dd[r],a=e.match(ud[r]);null!=a&&a.length>0&&(t[n[1]]=xo(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=Ui(t[n[1]]))}return t}function fd(e,t,r,n,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=yo(t),n[n.length]=r?zo(e,t,r):Bo(e,t))}function md(e,t){var r=t||{},n=[io,zo("cp:coreProperties",null,{"xmlns:cp":Vo,"xmlns:dc":Jo,"xmlns:dcterms":Qo,"xmlns:dcmitype":Zo,"xmlns:xsi":rl})],a={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&fd("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:qo(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),null!=e.ModifiedDate&&fd("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:qo(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=dd.length;++s){var i=dd[s],o=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&fd(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var pd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gd=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xd(e,t,r,n){var a=[];if("string"==typeof e)a=Do(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?Do(t,n).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l)}o+=l}}function bd(e){var t=[],r=zo;return e||(e={}),e.Application="SheetJS",t[t.length]=io,t[t.length]=zo("Properties",null,{xmlns:Ko,"xmlns:vt":tl}),pd.forEach(function(n){if(void 0!==e[n[1]]){var a;switch(n[2]){case"string":a=yo(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false"}void 0!==a&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+yo(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var vd=/<[^>]+>[^<]*/g;function yd(e){var t=[io,zo("Properties",null,{xmlns:Go,"xmlns:vt":tl})];if(!e)return t.join("");var r=1;return Ai(e).forEach(function(n){++r,t[t.length]=zo("property",function(e,t){switch(typeof e){case"string":var r=zo("vt:lpwstr",yo(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return zo((0|e)==e?"vt:i4":"vt:r8",yo(String(e)));case"boolean":return zo("vt:bool",e?"true":"false")}if(e instanceof Date)return zo("vt:filetime",qo(e));throw new Error("Unable to serialize "+e)}(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:yo(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var wd,Nd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function jd(e,t,r){wd||(wd=_i(Nd)),e[t=wd[t]||t]=r}function kd(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Sd(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Ad(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Cd(e,t,r){return 31===t?Ad(e):Sd(e,0,r)}function _d(e,t,r){return Cd(e,t,!1===r?0:4)}function Td(e){var t=e.l,r=Pd(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,Pd(e,3)]}function Ed(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(As,"").replace(Cs,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Ld(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function Pd(e,t,r){var n,a=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&a!==t&&-1===Wc.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return Sd(e,0,4).replace(As,"");case 31:return Ad(e);case 64:return kd(e);case 65:return Ld(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return _d(e,a,!s.raw).replace(As,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Cd(e,t,0)}(e,a).replace(As,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Td(e));return r}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(As,""),e.l-a&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(As,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Od(e,t){var r=Yl(4),n=Yl(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=Yl(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);n*=1e7;var a=(r*=1e7)/Math.pow(2,32)|0;a>0&&(r%=Math.pow(2,32),n+=a);var s=Yl(8);return s.write_shift(4,r),s.write_shift(4,n),s}(t);break;case 31:case 80:for((n=Yl(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ss([r,n])}function Fd(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var d=e.read_shift(4),u=e.read_shift(4);s[i]=[d,u+r]}s.sort(function(e,t){return e[1]-t[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var f=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],f=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(f=!1,e.l=s[i][1]),f)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(h[m.n]=Pd(e,m.t,{raw:!0}),"version"===m.p&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(65535&h[m.n])).slice(-4)),"CodePage"==m.n)switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:is(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(1===s[i][0]){if(o=h.CodePage=Pd(e,2),is(o),-1!==l){var p=e.l;e.l=s[l][1],c=Ed(e,o),e.l=p}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=Ed(e,o)}else{var g,x=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=Ld(e);break;case 30:case 31:e.l+=4,g=_d(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=zd(e,4);break;case 64:e.l+=4,g=Ui(kd(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=g}}return e.l=r+n,h}var Id=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Rd(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Dd(e,t,r){var n=Yl(8),a=[],s=[],i=8,o=0,l=Yl(8),c=Yl(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){(c=Yl(8)).write_shift(4,0),a.unshift(c);var d=[Yl(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=Yl(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Ss(d),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Id.indexOf(e[o][0])>-1||gd.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],f=0;if(t){var m=r[f=+t[e[o][0]]];if("version"==m.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=Od(m.t,h)}else{var g=Rd(h);-1==g&&(g=31,h=String(h)),l=Od(g,h)}s.push(l),(c=Yl(8)).write_shift(4,t?f:2+o),a.push(c),i+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),Ss([n].concat(a).concat(s))}function Md(e,t,r){var n=e.content;if(!n)return{};Gl(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Ni.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(1!==(a=n.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),1===a&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===a&&(i=n.read_shift(16),l=n.read_shift(4));var u,h=Fd(n,t),f={SystemIdentifier:c};for(var m in h)f[m]=h[m];if(f.FMTID=s,1===a)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{u=Fd(n,null)}catch(K_){}for(m in u)f[m]=u[m];return f.FMTID=[s,i],f}function Bd(e,t,r,n,a,s){var i=Yl(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ni.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=Dd(e,r,n);if(o.push(l),a){var c=Dd(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return Ss(o)}function Ud(e,t){return e.read_shift(t),null}function zd(e,t){return 1===e.read_shift(t)}function qd(e,t){return t||(t=Yl(2)),t.write_shift(2,+!!e),t}function Hd(e){return e.read_shift(2,"u")}function Wd(e,t){return t||(t=Yl(2)),t.write_shift(2,e),t}function Vd(e,t){return function(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}(e,t,Hd)}function Gd(e,t,r){return r||(r=Yl(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function Kd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=ts;(r&&r.biff>=8&&(ts=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return ts=s,i}function Yd(e){var t=ts;ts=1200;var r,n=e.read_shift(2),a=e.read_shift(1),s=4&a,i=8&a,o=1+(1&a),l=0,c={};i&&(l=e.read_shift(2)),s&&(r=e.read_shift(4));var d=2==o?"dbcs-cont":"sbcs-cont",u=0===n?"":e.read_shift(n,d);return i&&(e.l+=4*l),s&&(e.l+=r),c.t=u,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),ts=t,c}function Xd(e){var t=e.t||"",r=Yl(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Yl(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),Ss([r,n])}function $d(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Jd(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):$d(e,n,r)}function Qd(e,t,r){if(r.biff>5)return Jd(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Zd(e,t,r){return r||(r=Yl(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function eu(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(As,"");return n&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(a>>1,"utf16le").replace(As,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function tu(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(As,""):""}function ru(e,t){t||(t=Yl(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function nu(e){var t=Yl(512),r=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==s)ru(n=n.slice(1),t);else if(2&s){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&s&&ru(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,255&n.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function au(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function su(e,t){var r=au(e);return r[3]=0,r}function iu(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function ou(e,t,r,n){return n||(n=Yl(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function lu(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function cu(e){return[e.read_shift(2),Fc(e)]}function du(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function uu(e,t){return t||(t=Yl(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function hu(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var fu=hu;function mu(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function pu(e){e.l+=2,e.l+=e.read_shift(2)}var gu={0:pu,4:pu,5:pu,6:pu,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:pu,9:pu,10:pu,11:pu,12:pu,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:pu,15:pu,16:pu,17:pu,18:pu,19:pu,20:pu,21:mu};function xu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function bu(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;default:throw new Error("unsupported BIFF version")}var s=Yl(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function vu(e,t){var r=!t||t.biff>=8?2:1,n=Yl(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function yu(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);return r&&2==r.biff&&(n=1-(a>>15),a&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},a]}function wu(e,t,r,n){var a=r&&5==r.biff;n||(n=Yl(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return null==s.l&&(s.l=s.length),s}var Nu=Qd;function ju(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function ku(e,t,r,n){var a=r&&5==r.biff;n||(n=Yl(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Su(e,t,r){var n=iu(e);2!=r.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}var Au=function(e,t,r){return 0===t?"":Qd(e,0,r)};function Cu(e,t,r){var n,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Kd(e,0,r),s=e.read_shift(2);if(s!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}(e,t-2,r)),s.body=n||e.read_shift(t-2),"string"===typeof n&&(s.Name=n),s}var _u=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Tu(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=$d(e,i,r);32&a&&(c=_u[c.charCodeAt(0)]);var d=n-e.l;r&&2==r.biff&&--d;var u=n!=e.l&&0!==o&&d>0?function(e,t,r,n){var a,s=e.l+t,i=Vf(e,n,r);s!==e.l&&(a=Wf(e,s-e.l,i,r));return[i,a]}(e,d,r,o):[];return{chKey:s,Name:c,itab:l,rgce:u}}function Eu(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=Kd(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)n.push(lu(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Lu(e,t,r){var n=fu(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Jf(e,t,r)]}var Pu={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Ou(e){var t=Yl(24),r=ic(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Ss([t,nu(e[1])])}function Fu(e){var t=e[1].Tooltip,r=Yl(10+2*(t.length+1));r.write_shift(2,2048);var n=ic(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Iu(e,t,r){if(!r.cellStyles)return Kl(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var Ru=iu,Du=Vd,Mu=Jd;var Bu=[2,3,48,49,131,139,140,245],Uu=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_i({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=pc(function(t,r){var n=[],a=vs(1);switch(r.type){case"base64":a=ws(gs(t));break;case"binary":a=ws(t);break;case"buffer":case"array":a=t}Gl(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,d=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(d=a.read_shift(2));var u=a.read_shift(2),h=r.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],m={},p=Math.min(a.length,2==s?521:d-10-(o?264:0)),g=l?32:11;a.l<p&&13!=a[a.l];)switch((m={}).name=ds.utils.decode(h,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,m.type=String.fromCharCode(a.read_shift(1)),2==s||l||(m.offset=a.read_shift(4)),m.len=a.read_shift(1),2==s&&(m.offset=a.read_shift(2)),m.dec=a.read_shift(1),m.name.length&&f.push(m),2!=s&&(a.l+=l?13:14),m.type){case"B":o&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==a[a.l]&&(a.l=d-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=d;var x=0,b=0;for(n[0]=[],b=0;b!=f.length;++b)n[0][b]=f[b].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,n[++x]=[],b=0,b=0;b!=f.length;++b){var v=a.slice(a.l,a.l+f[b].len);a.l+=f[b].len,Gl(v,0);var y=ds.utils.decode(h,v);switch(f[b].type){case"C":y.trim().length&&(n[x][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?n[x][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):n[x][b]=y;break;case"F":n[x][b]=parseFloat(y.trim());break;case"+":case"I":n[x][b]=l?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":n[x][b]=!0;break;case"N":case"F":n[x][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[x][b]="##MEMO##"+(l?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(n[x][b]=+y||0);break;case"@":n[x][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":n[x][b]=new Date(864e5*(v.read_shift(4)-2440588)+v.read_shift(4));break;case"Y":n[x][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[x][b]=-v.read_shift(-8,"f");break;case"B":if(o&&8==f[b].len){n[x][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else a.l+=u;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return a["!cols"]=n.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return fc(r(e,t),t)}catch(K_){if(t&&t.WTF)throw K_}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var a=r||{};if(+a.codepage>=0&&is(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var s=$l(),i=Ax(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<o.length;++d)if(((c[d]||{}).DBF||{}).name)o[d]=c[d].DBF.name,++h;else if(null!=o[d]){if(++h,"number"===typeof o[d]&&(o[d]=o[d].toString(10)),"string"!==typeof o[d])throw new Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d)for(u=0;u<1024;++u)if(-1==o.indexOf(o[d]+"_"+u)){o[d]+="_"+u;break}}var m=dc(e["!ref"]),p=[],g=[],x=[];for(d=0;d<=m.e.c-m.s.c;++d){var b="",v="",y=0,w=[];for(u=0;u<l.length;++u)null!=l[u][d]&&w.push(l[u][d]);if(0!=w.length&&null!=o[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":v="B";break;case"string":default:v="C";break;case"boolean":v="L";break;case"object":v=w[u]instanceof Date?"D":"C"}y=Math.max(y,String(w[u]).length),b=b&&b!=v?"C":v}y>250&&(y=250),"C"==(v=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==v&&(b="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),g[d]="C"==b||"N"==v?y:n[b]||0,f+=g[d],p[d]=b}else p[d]="?"}var N=s.next(32);for(N.write_shift(4,318902576),N.write_shift(4,l.length),N.write_shift(2,296+32*h),N.write_shift(2,f),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+t[rs]||3)<<8),d=0,u=0;d<o.length;++d)if(null!=o[d]){var j=s.next(32),k=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,k,"sbcs"),j.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),j.write_shift(4,u),j.write_shift(1,g[d]||n[p[d]]||0),j.write_shift(1,x[d]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),u+=g[d]||n[p[d]]||0}var S=s.next(264);for(S.write_shift(4,13),d=0;d<65;++d)S.write_shift(4,0);for(d=0;d<l.length;++d){var A=s.next(f);for(A.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(p[u]){case"L":A.write_shift(1,null==l[d][u]?63:l[d][u]?84:70);break;case"B":A.write_shift(8,l[d][u]||0,"f");break;case"N":var C="0";for("number"==typeof l[d][u]&&(C=l[d][u].toFixed(x[u]||0)),h=0;h<g[u]-C.length;++h)A.write_shift(1,32);A.write_shift(1,C,"sbcs");break;case"D":l[d][u]?(A.write_shift(4,("0000"+l[d][u].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(l[d][u].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+l[d][u].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var _=String(null!=l[d][u]?l[d][u]:"").slice(0,g[u]);for(A.write_shift(1,_,"sbcs"),h=0;h<g[u]-_.length;++h)A.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),zu=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Ai(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?fs(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:fs(n)};function a(e,a){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],h=[],f=null,m={},p=[],g=[],x=[],b=0;for(+a.codepage>=0&&is(+a.codepage);c!==i.length;++c){b=0;var v,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),N=w[0];if(y.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,k=!1,S=!1,A=!1,C=-1,_=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,k||(l=0),s=u.length;s<=o;++s)u[s]=[];break;case"K":'"'===(v=w[d].slice(1)).charAt(0)?v=v.slice(1,v.length-1):"TRUE"===v?v=!0:"FALSE"===v?v=!1:isNaN(Wi(v))?isNaN(Gi(v).getDate())||(v=Ui(v)):(v=Wi(v),null!==f&&ui(f)&&(v=Ii(v))),"undefined"!==typeof ds&&"string"==typeof v&&"string"!=(a||{}).type&&(a||{}).codepage&&(v=ds.utils.decode(a.codepage,v)),j=!0;break;case"E":A=!0;var T=vf(w[d].slice(1),{r:o,c:l});u[o][l]=[u[o][l],T];break;case"S":S=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":C=parseInt(w[d].slice(1))-1;break;case"C":_=parseInt(w[d].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}if(j&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=v:u[o][l]=v,f=null),S){if(A)throw new Error("SYLK shared formula cannot have own formula");var E=C>-1&&u[C][_];if(!E||!E[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=Nf(E[1],{r:o-C,c:l-_})}break;case"F":var L=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++L;break;case"Y":for(o=parseInt(w[d].slice(1))-1,s=u.length;s<=o;++s)u[s]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[d].slice(1))];break;case"W":for(x=w[d].slice(1).split(" "),s=parseInt(x[0],10);s<=parseInt(x[1],10);++s)b=parseInt(x[2],10),g[s-1]=0===b?{hidden:!0}:{wch:b},Ch(g[s-1]);break;case"C":g[l=parseInt(w[d].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(w[d].slice(1))-1]||(p[o]={}),b>0?(p[o].hpt=b,p[o].hpx=Eh(b)):0===b&&(p[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}L<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),[u,m]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return a(gs(e),t);case"binary":return a(e,t);case"buffer":return a(xs&&Buffer.isBuffer(e)?e.toString("binary"):js(e),t);case"array":return a(zi(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],s=r[1],i=pc(n,t);return Ai(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+wf(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return fc(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,n,a=["ID;PWXL;N;E"],s=[],o=dc(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=a,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Nh(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=jh(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*Th(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var d=o.s.r;d<=o.e.r;++d)for(var u=o.s.c;u<=o.e.c;++u){var h=oc({r:d,c:u});(r=l?(e[d]||[])[u]:e[h])&&(null!=r.v||r.f&&!r.F)&&s.push(i(r,0,d,u))}return a.join(c)+c+s.join(c)+c+"E"+c}}}(),qu=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){for(var o=r[s].trim().split(","),l=o[0],c=o[1],d=r[++s]||"";1&(d.match(/["]/g)||[]).length&&s<r.length-1;)d+="\n"+r[++s];switch(d=d.trim(),+l){case-1:if("BOT"===d){i[++n]=[],a=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[n][a]=!0:"FALSE"===d?i[n][a]=!1:isNaN(Wi(c))?isNaN(Gi(c).getDate())?i[n][a]=c:i[n][a]=Ui(c):i[n][a]=Wi(c),++a;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[n][a++]=""!==d?d:null}if("EOD"===d)break}}else i[++n]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return pc(function(t,r){switch(r.type){case"base64":return e(gs(t),r);case"binary":return e(t,r);case"buffer":return e(xs&&Buffer.isBuffer(t)?t.toString("binary"):js(t),r);case"array":return e(zi(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}var r=function(){var e=function(e,t,r,n,a){e.push(t),e.push(r+","+n),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,a=[],s=dc(r["!ref"]),i=Array.isArray(r);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,s.e.r-s.s.r+1,""),e(a,"TUPLES",0,s.e.c-s.s.c+1,""),e(a,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(a,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=oc({r:o,c:l});if(n=i?(r[o]||[])[l]:r[c])switch(n.t){case"n":var d=n.w;d||null==n.v||(d=n.v),null==d?n.f&&!n.F?t(a,1,0,"="+n.f):t(a,1,0,""):t(a,0,d,"V");break;case"b":t(a,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=pi(n.z||Ds[14],Li(Ui(n.v)))),t(a,0,n.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,r){return fc(t(e,r),r)},to_sheet:t,from_sheet:r}}(),Hu=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return pc(function(t,r){for(var n=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==n.length;++i){var l=n[i].trim().split(":");if("cell"===l[0]){var c=ic(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,s=c.c,l[2]){case"t":o[a][s]=e(l[3]);break;case"v":o[a][s]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?o[a][s]=!!+l[4]:o[a][s]=+l[4],"vtf"==l[2]&&(o[a][s]=[o[a][s],d])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}(t,r),r)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var r,n=[],a=[],s="",i=lc(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=oc({r:l,c:c}),(r=o?(e[l]||[])[c]:e[s])&&null!=r.v&&"z"!==r.t){switch(a=["cell",s,"t"],r.t){case"s":case"str":a.push(t(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=t(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=Li(Ui(r.v));a[2]="vtc",a[3]="nd",a[4]=""+d,a[5]=r.w||pi(r.z||Ds[14],d);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return fc(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[n,a,s,a,o(e),i].join("\n")}}}(),Wu=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(Wi(e))?isNaN(Gi(e).getDate())?t[r][n]=e:t[r][n]=Ui(e):t[r][n]=Wi(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in t&&(n[i]=(n[i]||0)+1);for(s in i=[],n)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);if(!i.length)for(s in n=r)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function a(e,t){var r=t||{},a="";var s=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var o=0,l=0,c=0,d=0,u=0,h=a.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=r.dateNF?function(e){var t="number"==typeof e?Ds[e]:e;return t=t.replace(yi,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function x(){var t=e.slice(d,u),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(n.t="s",n.v=t):(n.t="n",n.f=t.slice(1));else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=Wi(t)))if(!isNaN(Gi(t).getDate())||g&&t.match(g)){n.z=r.dateNF||Ds[14];var a=0;g&&t.match(g)&&(t=function(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(yi)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==n&&-1==a&&-1==s?d:c+"T"+d}(0,r.dateNF,t.match(g)||[]),a=1),r.cellDates?(n.t="d",n.v=Ui(t,a)):(n.t="n",n.v=Li(Ui(t,a))),!1!==r.cellText&&(n.w=pi(n.z,n.v instanceof Date?Li(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(s[o]||(s[o]=[]),s[o][l]=n):s[oc({c:l,r:o})]=n),d=u+1,p=e.charCodeAt(d),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==h)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&x())break e}return u-d>0&&x(),s["!ref"]=cc(i),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):pc(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){a[c]=[];var d=0;for(e(s[c].slice(0,o).trim(),a,c,d,n),d=1;d<=(s[c].length-o)/10+1;++d)e(s[c].slice(o+10*(d-1),o+10*d).trim(),a,c,d,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function i(e,t){var r="",n="string"==t.type?[0,0,0,0]:px(e,t);switch(t.type){case"base64":r=gs(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ds?ds.utils.decode(t.codepage,e):xs&&Buffer.isBuffer(e)?e.toString("binary"):js(e);break;case"array":r=zi(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Eo(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Eo(r):"binary"==t.type&&"undefined"!==typeof ds&&t.codepage&&(r=ds.utils.decode(t.codepage,ds.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Hu.to_sheet("string"==t.type?r:Eo(r),t):s(r,t)}return{to_workbook:function(e,t){return fc(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],n=dc(e["!ref"]),a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var i=[],o=n.s.c;o<=n.e.c;++o){var l=oc({r:s,c:o});if((t=a?(e[s]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(hc(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var Vu=function(){function e(e,t,r){if(e){Gl(e,e.l||0);for(var n=r.Enum||x;e.l<e.length;){var a=e.read_shift(2),s=n[a]||n[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,r);if(e.l=o,t(l,s,a))return}}}function t(t,r){if(!t)return t;var n=r||{};var a=n.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=x,e(t,function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||Ds[14],n.cellDates&&(e[1].t="d",e[1].v=Ii(e[1].v))),n.qpro&&e[3]>o&&(a["!ref"]=cc(u),l[s]=a,c.push(s),a=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var d=n.dense?(a[e[0].r]||[])[e[0].c]:a[oc(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[oc(e[0])]=e[1]}},n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=b,14==t[2]&&(n.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=cc(u),l[s]=a,c.push(s),a=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),h>0&&e[0].r>=h)break;n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[oc(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(s=e[1])}},n)}if(a["!ref"]=cc(u),l[i||s]=a,c.push(i||s),!d.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],p=0;p<d.length;++p)l[c[p]]?(m.push(d[p]||c[p]),f[d[p]]=l[d[p]]||l[c[p]]):(m.push(d[p]),f[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var a=e.l+t,s=r(e,0,n);if(s[1].t="s",20768==n.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return n.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}function a(e,t,r){var n=Yl(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var s=r.charCodeAt(a);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function s(e,t,r){var n=Yl(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function i(e,t,r){var n=Yl(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function o(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?sc(t):nc(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,r,n){var a=Yl(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<n.length;++s){var i=n.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function h(e,t){var r=d(e),n=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(a*Math.pow(2,s+32)+n*Math.pow(2,s)),r}function f(e,t,r,n){var a=Yl(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,i=0,o=0,l=0;return n<0&&(i=1,n=-n),o=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,o-31))>>>0))&&(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,s=(n*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(i?32768:0),a.write_shift(2,o),a}function m(e,t){var r=d(e),n=e.read_shift(8,"f");return r[1].v=n,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=Yl(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var x={0:{n:"BOF",f:Hd},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var a=e.l+t,s=r(e,0,n);if(s[1].v=e.read_shift(8,"f"),n.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){Gl(e,0);var r=[],n=0,a="",s="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(s+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),i=r.pop(),r.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=r.pop(),i=r.pop(),r.push(i+c[u]+d);else{if(!l[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(n=l[u][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-n);r.length-=n,r.push(l[u][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&is(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=$l(),o=dc(e["!ref"]),l=Array.isArray(e),c=[];ig(n,0,function(e){var t=Yl(2);return t.write_shift(2,e),t}(1030)),ig(n,6,function(e){var t=Yl(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var d=Math.min(o.e.r,8191),u=o.s.r;u<=d;++u)for(var h=nc(u),f=o.s.c;f<=o.e.c;++f){u===o.s.r&&(c[f]=sc(f));var m=c[f]+h,p=l?(e[u]||[])[f]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?ig(n,13,s(u,f,p.v)):ig(n,14,i(u,f,p.v));else ig(n,15,a(u,f,hc(p).slice(0,239)))}return ig(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&is(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=$l();ig(n,0,function(e){var t=Yl(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var l=lc(o["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&ig(n,27,g(e.SheetNames[a],s++));var i=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=dc(o["!ref"]),c=Array.isArray(o),d=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var p=nc(m),x=l.s.c;x<=l.e.c;++x){m===l.s.r&&(d[x]=sc(x));var b=d[x]+p,v=c?(o[m]||[])[x]:o[b];if(v&&"z"!=v.t)if("n"==v.t)ig(n,23,f(m,x,i,v.v));else ig(n,22,u(m,x,i,hc(v).slice(0,239)))}++i}}return ig(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(ws(gs(e)),r);case"binary":return t(ws(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Gu=function(){var e=Po("t"),t=Po("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:xo(n[1])},s=r.match(t);return s&&(a.s=function(e){var t={},r=e.match(co),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=fo(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=as[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter(function(e){return e.v})}}(),Ku=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Yu=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Xu=/<(?:\w+:)?r>/,$u=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ju(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=xo(Eo(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Eo(e),r&&(n.h=jo(n.t))):e.match(Xu)&&(n.r=Eo(e),n.t=xo(Eo((e.replace($u,"").match(Yu)||[]).join("").replace(co,""))),r&&(n.h=Ku(Gu(n.r)))),n):{t:""}}var Qu=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Zu=/<(?:\w+:)?(?:si|sstItem)>/g,eh=/<\/(?:\w+:)?(?:si|sstItem)>/;var th=/^\s|\s$|[\t\n\r]/;function rh(e,t){if(!t.bookSST)return"";var r=[io];r[r.length]=zo("sst",null,{xmlns:al[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(th)&&(s+=' xml:space="preserve"'),s+=">"+yo(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var nh=function(e,t){var r=!1;return null==t&&(r=!0,t=Yl(15+4*e.t.length)),t.write_shift(1,0),bc(e.t,t),r?t.slice(0,t.l):t};function ah(e){var t=$l();Jl(t,159,function(e,t){return t||(t=Yl(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Jl(t,19,nh(e[r]));return Jl(t,160),t.end()}function sh(e){if("undefined"!==typeof ds)return ds.utils.encode(rs,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ih(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function oh(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function lh(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ih(e,4),t.U=ih(e,4),t.W=ih(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function ch(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function dh(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function uh(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:ch(e,t),v:dh(e,e.length-e.l)}}function hh(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fh(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(co,function(e){var r=fo(e);switch(mo(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){n[e]=r[e]});break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}}),n}function mh(e){var t,r,n=0,a=sh(e),s=a.length+1;for((t=vs(s))[0]=a.length,r=1;r!=s;++r)t[r]=a[r-1];for(r=s-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var ph=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(a){for(var s,i,o,l=sh(a),c=function(e){for(var n=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(n^=r[a]),i*=2,--a;return n}(l),d=l.length,u=vs(16),h=0;16!=h;++h)u[h]=0;for(1===(1&d)&&(s=c>>8,u[d]=n(e[0],s),--d,s=255&c,i=l[l.length-1],u[d]=n(i,s));d>0;)s=c>>8,u[--d]=n(l[d],s),s=255&c,u[--d]=n(l[d],s);for(d=15,o=15-l.length;o>0;)s=c>>8,u[d]=n(e[o],s),--o,s=255&c,u[--d]=n(l[d],s),--d,--o;return u}}(),gh=function(e){var t=0,r=ph(e);return function(e){var n=function(e,t,r,n,a){var s,i;for(a||(a=t),n||(n=ph(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=n[r])>>5|i<<3),a[s]=i,++r;return[a,r,n]}("",e,t,r);return t=n[1],n[0]}};function xh(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=ih(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=ih(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=ch(e,a),t-=a,r.EncryptionVerifier=dh(e,t),r}(e,t),n}var bh=function(){function e(e,r){switch(r.type){case"base64":return t(gs(e),r);case"binary":return t(e,r);case"buffer":return t(xs&&Buffer.isBuffer(e)?e.toString("binary"):js(e),r);case"array":return t(zi(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,s=/\\\w+\b/g,i=0,o=-1;n=s.exec(e);){if("\\cell"===n[0]){var l=e.slice(i,s.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[oc({r:t,c:o})]=c}}i=s.lastIndex}o>a.e.c&&(a.e.c=o)}),r["!ref"]=cc(a),r}return{to_workbook:function(t,r){return fc(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=dc(e["!ref"]),a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){r.push("\\trowd\\trautofit1");for(var i=n.s.c;i<=n.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=n.s.c;i<=n.e.c;++i){var o=oc({r:s,c:i});(t=a?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(hc(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function vh(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function yh(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(0===i)return[0,0,t];var o,l=0,c=a+s;switch(o=i/(c>1?2-c:c),a){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),vh(function(e){var t,r=e[0],n=e[1],a=e[2],s=2*n*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(r))}var wh=6;function Nh(e){return Math.floor((e+Math.round(128/wh)/256)*wh)}function jh(e){return Math.floor((e-5)/wh*100+.5)/100}function kh(e){return Math.round((e*wh+5)/wh*256)/256}function Sh(e){return kh(jh(Nh(e)))}function Ah(e){var t=Math.abs(e-Sh(e)),r=wh;if(t>.005)for(wh=1;wh<15;++wh)Math.abs(e-Sh(e))<=t&&(t=Math.abs(e-Sh(e)),r=wh);wh=r}function Ch(e){e.width?(e.wpx=Nh(e.width),e.wch=jh(e.wpx),e.MDW=wh):e.wpx?(e.wch=jh(e.wpx),e.width=kh(e.wch),e.MDW=wh):"number"==typeof e.wch&&(e.width=kh(e.wch),e.wpx=Nh(e.width),e.MDW=wh),e.customWidth&&delete e.customWidth}var _h=96;function Th(e){return 96*e/_h}function Eh(e){return e*_h/96}var Lh={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Ph=["numFmtId","fillId","fontId","borderId","xfId"],Oh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Fh=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=Ai(Ds),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ds[n[a]];var s=e[0].match(co);if(s)for(a=0;a<s.length;++a){var i=fo(s[a]);switch(mo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=xo(Eo(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}gi(o,l)}break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=s.match(n))&&function(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(co)||[]).forEach(function(e){var i=fo(e);switch(mo(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=Eo(i.val));break;case"<b":a.bold=i.val?So(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?So(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?So(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?So(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?So(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?So(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?So(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=as[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=So(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var o=$c[a.color.index];81==a.color.index&&(o=$c[1]),o||(o=$c[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=yh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=s.match(r))&&function(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(co)||[]).forEach(function(e){var r=fo(e);switch(mo(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}})}(l,c,0,o),(l=s.match(a))&&function(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(co)||[]).forEach(function(e){var r=fo(e);switch(mo(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=So(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=So(r.diagonalDown)),t.Borders.push(a);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}})}(l,c,0,o),(l=s.match(t))&&function(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(co)||[]).forEach(function(e){var s=fo(e),i=0;switch(mo(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=s)[0],i=0;i<Ph.length;++i)n[Ph[i]]&&(n[Ph[i]]=parseInt(n[Ph[i]],10));for(i=0;i<Oh.length;++i)n[Oh[i]]&&(n[Oh[i]]=So(n[Oh[i]]));if(t.NumberFmt&&n.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[i]){n.numFmtId=i;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=So(s.wrapText)),n.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(l,c,o),c):c}}();function Ih(e,t){var r,n=[io,zo("styleSheet",null,{xmlns:al[0],"xmlns:vt":tl})];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=zo("numFmt",null,{numFmtId:n,formatCode:yo(e[n])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=zo("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=zo("cellXfs",null),e.forEach(function(e){t[t.length]=zo("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=zo("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Rh(e,t,r){r||(r=Yl(6+4*t.length)),r.write_shift(2,e),bc(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}function Dh(e,t){t||(t=Yl(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Yl(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),zc(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),bc(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Mh,Bh=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Uh=Kl;function zh(e,t){t||(t=Yl(84)),Mh||(Mh=_i(Bh));var r=Mh[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(zc({auto:1},t),zc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function qh(e,t,r){r||(r=Yl(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Hh(e,t){return t||(t=Yl(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Wh=Kl;function Vh(e){Jl(e,613,gc(1)),Jl(e,46,function(e,t){return t||(t=Yl(51)),t.write_shift(1,0),Hh(0,t),Hh(0,t),Hh(0,t),Hh(0,t),Hh(0,t),t.length>t.l?t.slice(0,t.l):t}()),Jl(e,614)}function Gh(e){Jl(e,619,gc(1)),Jl(e,48,function(e,t){return t||(t=Yl(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Ec(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),Jl(e,620)}function Kh(e){Jl(e,508,function(e,t,r){var n=Yl(2052);return n.write_shift(4,e),Ec(t,n),Ec(r,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),Jl(e,509)}function Yh(e,t){var r=$l();return Jl(r,278),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r}),0!=r&&(Jl(e,615,gc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&Jl(e,44,Rh(n,t[n]))}),Jl(e,616))}}(r,e.SSF),function(e){Jl(e,611,gc(1)),Jl(e,43,Dh({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Jl(e,612)}(r),function(e){Jl(e,603,gc(2)),Jl(e,45,zh({patternType:"none"})),Jl(e,45,zh({patternType:"gray125"})),Jl(e,604)}(r),Vh(r),function(e){Jl(e,626,gc(1)),Jl(e,47,qh({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Jl(e,627)}(r),function(e,t){Jl(e,617,gc(t.length)),t.forEach(function(t){Jl(e,47,qh(t,0))}),Jl(e,618)}(r,t.cellXfs),Gh(r),function(e){Jl(e,505,gc(0)),Jl(e,506)}(r),Kh(r),Jl(r,279),r.end()}var Xh=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $h(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(co)||[]).forEach(function(e){var a=fo(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[Xh.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Jh(){}function Qh(){}var Zh=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ef=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,tf=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var rf=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function nf(e,t){var r;e&&0!==e.length||(e=af());var n={};if(!(r=e.match(rf)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",Zh,$h],["fontScheme",ef,Jh],["fmtScheme",tf,Qh]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}(r[0],n,t),n.raw=e,n}function af(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[io];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function sf(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Kl(e,t)}(e,4);break;case 2:t.xclrValue=au(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function of(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=sf(e);break;case 6:n[1]=function(e,t){return Kl(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function lf(e,t){t.forEach(function(e){e[0]})}function cf(){var e=$l();return Jl(e,332),Jl(e,334,gc(1)),Jl(e,335,function(e){var t=Yl(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),bc(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Jl(e,336),Jl(e,339,function(e,t){var r=Yl(8+2*t.length);return r.write_shift(4,e),bc(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Jl(e,52),Jl(e,35,gc(514)),Jl(e,4096,gc(0)),Jl(e,4097,Wd(1)),Jl(e,36),Jl(e,53),Jl(e,340),Jl(e,337,function(e,t){var r=Yl(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Jl(e,51,function(e){var t=Yl(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Jl(e,338),Jl(e,333),e.end()}function df(){var e=[io];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var uf=1024;function hf(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[zo("xml",null,{"xmlns:v":dl,"xmlns:o":sl,"xmlns:x":il,"xmlns:mv":cl}).replace(/\/>/,">"),zo("o:shapelayout",zo("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),zo("v:shapetype",[zo("v:stroke",null,{joinstyle:"miter"}),zo("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];uf<1e3*e;)uf+=1e3;return t.forEach(function(e){var t=ic(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var n="gradient"==r.type?zo("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=zo("v:fill",n,r);++uf,a=a.concat(["<v:shape"+Uo({id:"_x0000_s"+uf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,zo("v:shadow",null,{on:"t",obscured:"t"}),zo("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Bo("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Bo("x:AutoFill","False"),Bo("x:Row",String(t.r)),Bo("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ff(e,t,r,n){var a,s=Array.isArray(e);t.forEach(function(t){var i=ic(t.ref);if(s?(e[i.r]||(e[i.r]=[]),a=e[i.r][i.c]):a=e[t.ref],!a){a={t:"z"},s?e[i.r][i.c]=a:e[t.ref]=a;var o=dc(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=cc(o);l!==e["!ref"]&&(e["!ref"]=l)}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n)for(d=0;d<n.length;++d)if(c.a==n[d].id){c.a=n[d].name||c.a;break}a.c.push(c)})}function mf(e){var t=[io,zo("comments",null,{xmlns:al[0]})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var n=yo(e.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var n=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?n=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(n=r.indexOf(yo(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>'),a.length<=1)t.push(Bo("t",yo(a[0]||"")));else{for(var s="Comment:\n    "+a[0]+"\n",i=1;i<a.length;++i)s+="Reply:\n    "+a[i]+"\n";t.push(Bo("t",yo(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function pf(e,t,r){var n=[io,zo("ThreadedComments",null,{xmlns:$o}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(s,i){if(s.T){s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?a=o.id:o.parentId=a,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(zo("threadedComment",Bo("text",s.t||""),o))}else delete s.ID})}),n.push("</ThreadedComments>"),n.join("")}var gf=xc;function xf(e){var t=$l(),r=[];return Jl(t,628),Jl(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Jl(t,632,function(e){return bc(e.slice(0,54))}(e.a)))})}),Jl(t,631),Jl(t,633),e.forEach(function(e){e[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var a={s:ic(e[0]),e:ic(e[0])};Jl(t,635,function(e,t){return null==t&&(t=Yl(36)),t.write_shift(4,e[1].iauthor),Mc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,n])),n.t&&n.t.length>0&&Jl(t,637,Nc(n)),Jl(t,636),delete n.iauthor})}),Jl(t,634),Jl(t,629),t.end()}var bf=["xlsb","xlsm","xlam","biff8","xla"];var vf=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var s=!1,i=!1;0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,r+(s?"":"$")+sc(l)+(i?"":"$")+nc(o)}return function(n,a){return t=a,n.replace(e,r)}}(),yf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wf=function(){return function(e,t){return e.replace(yf,function(e,r,n,a,s,i){var o=ac(a)-(n?0:t.c),l=rc(i)-(s?0:t.r);return r+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":n?o+1:"["+o+"]")})}}();function Nf(e,t){return e.replace(yf,function(e,r,n,a,s,i){return r+("$"==n?n+a:sc(ac(a)+t.c))+("$"==s?s+i:nc(rc(i)+t.r))})}function jf(e,t,r){var n=lc(t).s,a=ic(r);return Nf(e,{r:a.r-n.r,c:a.c-n.c})}function kf(e){return e.replace(/_xlfn\./g,"")}function Sf(e){e.l+=1}function Af(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function Cf(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return _f(e);12==r.biff&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Af(e,2),o=Af(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function _f(e){var t=Af(e,2),r=Af(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Tf(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=Af(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=Af(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ef(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function Lf(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Pf(e){return[e.read_shift(1),e.read_shift(1)]}function Of(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=zd(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Jc[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Bc(e);break;case 2:r[1]=Qd(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Ff(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],s=0;s!=n;++s)a.push((12==r.biff?Dc:du)(e,8));return a}function If(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=Of(e,r.biff);return i}function Rf(e,t,r){return e.l+=2,[Ef(e)]}function Df(e){return e.l+=6,[]}function Mf(e){return e.l+=2,[Hd(e),1&e.read_shift(2)]}var Bf=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Uf={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Kl},3:{n:"PtgAdd",f:Sf},4:{n:"PtgSub",f:Sf},5:{n:"PtgMul",f:Sf},6:{n:"PtgDiv",f:Sf},7:{n:"PtgPower",f:Sf},8:{n:"PtgConcat",f:Sf},9:{n:"PtgLt",f:Sf},10:{n:"PtgLe",f:Sf},11:{n:"PtgEq",f:Sf},12:{n:"PtgGe",f:Sf},13:{n:"PtgGt",f:Sf},14:{n:"PtgNe",f:Sf},15:{n:"PtgIsect",f:Sf},16:{n:"PtgUnion",f:Sf},17:{n:"PtgRange",f:Sf},18:{n:"PtgUplus",f:Sf},19:{n:"PtgUminus",f:Sf},20:{n:"PtgPercent",f:Sf},21:{n:"PtgParen",f:Sf},22:{n:"PtgMissArg",f:Sf},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Kd(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Jc[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Bc(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[lm[a],om[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?om:im)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,Tf(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Cf(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Kl},40:{n:"PtgMemNoMem",f:Kl},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return _f(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),s=Af(e,2),i=Af(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,Tf(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,a,Cf(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,a]}},255:{}},zf={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},qf={1:{n:"PtgElfLel",f:Mf},2:{n:"PtgElfRw",f:Rf},3:{n:"PtgElfCol",f:Rf},6:{n:"PtgElfRwV",f:Rf},7:{n:"PtgElfColV",f:Rf},10:{n:"PtgElfRadical",f:Rf},11:{n:"PtgElfRadicalS",f:Df},13:{n:"PtgElfColS",f:Df},15:{n:"PtgElfColSV",f:Df},16:{n:"PtgElfRadicalLel",f:Mf},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:Bf[r>>2&31],idx:n,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Hf={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Lf},33:{n:"PtgAttrBaxcel",f:Lf},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Pf(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Pf(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Wf(e,t,r,n){if(n.biff<8)return Kl(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=If(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Ff(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&12==n.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=a-e.l)&&s.push(Kl(e,t)),s}function Vf(e,t,r){for(var n,a,s=e.l+t,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=Uf[a]||Uf[zf[a]],24!==a&&25!==a||(n=(24===a?qf:Hf)[e[e.l+1]]),n&&n.f?i.push([n.n,n.f(e,t,r)]):Kl(e,t);return i}function Gf(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var Kf={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Yf(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Xf(e,t,r){var n=Yf(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function $f(e,t,r,n,a){var s,i,o,l,c=a&&a.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,b=e[0].length;x<b;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Hi(" ",e[0][p][1][1]);break;case 1:g=Hi("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}u.push(i+Kf[v[0]]+s);break;case"PtgIsect":s=u.pop(),i=u.pop(),u.push(i+" "+s);break;case"PtgUnion":s=u.pop(),i=u.pop(),u.push(i+","+s);break;case"PtgRange":s=u.pop(),i=u.pop(),u.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Ql(v[1][1],d,a),u.push(ec(o,c));break;case"PtgRefN":o=r?Ql(v[1][1],r,a):v[1][1],u.push(ec(o,c));break;case"PtgRef3d":h=v[1][1],o=Ql(v[1][2],d,a);m=Xf(n,h,a);u.push(m+"!"+ec(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],w=v[1][1];y||(y=0);var N=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=N.shift()),u.push(w+"("+N.join(",")+")");break;case"PtgBool":u.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(v[1]);break;case"PtgNum":u.push(String(v[1]));break;case"PtgStr":u.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Zl(v[1][1],r?{s:r}:d,a),u.push(tc(l,a));break;case"PtgArea":l=Zl(v[1][1],d,a),u.push(tc(l,a));break;case"PtgArea3d":h=v[1][1],l=v[1][2],m=Xf(n,h,a),u.push(m+"!"+tc(l,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=v[1][2];var j=(n.names||[])[f-1]||(n[0]||[])[f],k=j?j.Name:"SH33TJSNAME"+String(f);k&&"_xlfn."==k.slice(0,6)&&!a.xlfn&&(k=k.slice(6)),u.push(k);break;case"PtgNameX":var S,A=v[1][1];if(f=v[1][2],!(a.biff<=5)){var C="";if(14849==((n[A]||[])[0]||[])[0]||(1025==((n[A]||[])[0]||[])[0]?n[A][f]&&n[A][f].itab>0&&(C=n.SheetNames[n[A][f].itab-1]+"!"):C=n.SheetNames[f-1]+"!"),n[A]&&n[A][f])C+=n[A][f].Name;else if(n[0]&&n[0][f])C+=n[0][f].Name;else{var _=(Yf(n,A,a)||"").split(";;");_[f-1]?C=_[f-1]:C+="SH33TJSERRX"}u.push(C);break}A<0&&(A=-A),n[A]&&(S=n[A][f]),S||(S={Name:"SH33TJSERRY"}),u.push(S.Name);break;case"PtgParen":var T="(",E=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:T=Hi(" ",e[0][p][1][1])+T;break;case 3:T=Hi("\r",e[0][p][1][1])+T;break;case 4:E=Hi(" ",e[0][p][1][1])+E;break;case 5:E=Hi("\r",e[0][p][1][1])+E;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(T+u.pop()+E);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:v[1][1],r:v[1][0]};var L={c:r.c,r:r.r};if(n.sharedf[oc(o)]){var P=n.sharedf[oc(o)];u.push($f(P,d,L,n,a))}else{var O=!1;for(s=0;s!=n.arrayf.length;++s)if(i=n.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){u.push($f(i[1],d,L,n,a)),O=!0;break}O||u.push(v[1])}break;case"PtgArray":u.push("{"+Gf(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=a.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var F=!0;switch((v=e[0][p])[1][0]){case 4:F=!1;case 0:g=Hi(" ",v[1][1]);break;case 5:F=!1;case 1:g=Hi("\r",v[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}u.push((F?g:"")+u.pop()+(F?"":g)),p=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function Jf(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Kl(e,t-2)];var o=Vf(e,i,r);return t!==i+s&&(n=Wf(e,t-i-s,o,r)),e.l=a,[o,n]}function Qf(e,t,r){var n,a=e.l+t,s=e.read_shift(2),i=Vf(e,s,r);return 65535==s?[[],Kl(e,t-2)]:(t!==s+2&&(n=Wf(e,a-s-2,i,r)),[i,n])}function Zf(e,t,r){var n=e.l+t,a=iu(e);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==Il(e,e.l+6))return[Bc(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=function(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Kl(e,t-2)];var o=Vf(e,i,r);return t!==i+s&&(n=Wf(e,t-i-s,o,r)),e.l=a,[o,n]}(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function em(e,t,r,n,a){var s=ou(t,r,a),i=function(e){if(null==e){var t=Yl(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Uc("number"==typeof e?e:0)}(e.v),o=Yl(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Yl(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return Ss([s,i,o,l])}function tm(e,t,r){var n=e.read_shift(4),a=Vf(e,n,r),s=e.read_shift(4);return[a,s>0?Wf(e,s,a,r):null]}var rm=tm,nm=tm,am=tm,sm=tm,im={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},om={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lm={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cm(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function dm(e){return("of:="+e.replace(yf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function um(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function hm(e){return e.replace(/\./,"!")}var fm={},mm={},pm="undefined"!==typeof Map;function gm(e,t,r){var n=0,a=e.length;if(r){if(pm?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var s=pm?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t:t},e.Count++,e.Unique++,r&&(pm?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function xm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(wh=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=jh(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=kh(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function bm(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function vm(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],a=60,s=e.length;if(null==n&&r.ssf)for(;a<392;++a)if(null==r.ssf[a]){gi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function ym(e,t,r,n,a,s){try{n.cellNF&&(e.z=Ds[t])}catch(K_){if(n.WTF)throw K_}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Ui(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==Ds[t]&&gi(vi[t]||"General",t),"e"===e.t)e.w=e.w||Jc[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ks(e.v);else if("d"===e.t){var i=Li(e.v);e.w=(0|i)===i?i.toString(10):Ks(i)}else{if(void 0===e.v)return"";e.w=Ys(e.v,mm)}else"d"===e.t?e.w=pi(t,Li(e.v),mm):e.w=pi(t,e.v,mm)}catch(K_){if(n.WTF)throw K_}if(n.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=yh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=yh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(K_){if(n.WTF&&s.Fills)throw K_}}}function wm(e,t,r){if(e&&e["!ref"]){var n=dc(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var Nm=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jm=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,km=/<(?:\w:)?hyperlink [^>]*>/gm,Sm=/"(\w*:\w*)"/,Am=/<(?:\w:)?col\b[^>]*[\/]?>/g,Cm=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_m=/<(?:\w:)?pageMargins[^>]*\/>/g,Tm=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Em=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Lm=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Pm(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(jm);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var h=c.match(Tm);h?Om(h[0],o,a,r):(h=c.match(Em))&&function(e,t,r,n,a){Om(e.slice(0,e.indexOf(">")),r,n,a)}(h[0],h[1],o,a,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(Sm);m&&function(e,t){var r=dc(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=cc(r))}(o,m[1])}var p=c.match(Lm);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Rm)||[]).forEach(function(e,r){var n=fo(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),So(n.rightToLeft)&&(t.Views[r].RTL=!0)})}(p[1],a);var g=[];if(t.cellStyles){var x=c.match(Am);x&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=fo(t[n],!0);a.hidden&&(a.hidden=So(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ah(a.width)),Ch(a);s<=i;)e[s++]=qi(a)}}(g,x)}u&&Mm(u[1],o,t,l,s,i);var b=d.match(Cm);b&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(b[0]));var v=[],y=d.match(Nm);if(y)for(f=0;f!=y.length;++f)v[f]=dc(y[f].slice(y[f].indexOf('"')+1));var w=d.match(km);w&&function(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=fo(Eo(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+xo(s.location))):(s.Target="#"+xo(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=dc(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=oc({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}(o,w,n);var N=d.match(_m);if(N&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}(fo(N[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=cc(l)),t.sheetRows>0&&o["!ref"]){var j=dc(o["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>l.e.r&&(j.e.r=l.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>l.e.c&&(j.e.c=l.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),o["!fullref"]=o["!ref"],o["!ref"]=cc(j))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function Om(e,t,r,n){var a=fo(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=xo(Eo(a.codeName)))}var Fm=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Im=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Rm=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Dm(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Jc[e.v];break;case"d":n&&n.cellDates?a=Ui(e.v,-1).toISOString():((e=qi(e)).t="n",a=""+(e.v=Li(Ui(e.v)))),"undefined"===typeof e.z&&(e.z=Ds[14]);break;default:a=e.v}var o=Bo("v",yo(a)),l={r:t},c=vm(n.cellXfs,e,n);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Bo("v",""+gm(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str"}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=zo("f",yo(e.f),d)+(null!=e.v?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),zo("c",o,l)}var Mm=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Po("v"),i=Po("f");return function(o,l,c,d,u,h){for(var f,m,p,g,x,b=0,v="",y=[],w=[],N=0,j=0,k=0,S="",A=0,C=0,_=0,T=0,E=Array.isArray(h.CellXf),L=[],P=[],O=Array.isArray(l),F=[],I={},R=!1,D=!!c.sheetStubs,M=o.split(t),B=0,U=M.length;B!=U;++B){var z=(v=M[B].trim()).length;if(0!==z){var q=0;e:for(b=0;b<z;++b)switch(v[b]){case">":if("/"!=v[b-1]){++b;break e}if(c&&c.cellStyles){if(A=null!=(m=fo(v.slice(q,b),!0)).r?parseInt(m.r,10):A+1,C=-1,c.sheetRows&&c.sheetRows<A)continue;I={},R=!1,m.ht&&(R=!0,I.hpt=parseFloat(m.ht),I.hpx=Eh(I.hpt)),"1"==m.hidden&&(R=!0,I.hidden=!0),null!=m.outlineLevel&&(R=!0,I.level=+m.outlineLevel),R&&(F[A-1]=I)}break;case"<":q=b}if(q>=b)break;if(A=null!=(m=fo(v.slice(q,b),!0)).r?parseInt(m.r,10):A+1,C=-1,!(c.sheetRows&&c.sheetRows<A)){d.s.r>A-1&&(d.s.r=A-1),d.e.r<A-1&&(d.e.r=A-1),c&&c.cellStyles&&(I={},R=!1,m.ht&&(R=!0,I.hpt=parseFloat(m.ht),I.hpx=Eh(I.hpt)),"1"==m.hidden&&(R=!0,I.hidden=!0),null!=m.outlineLevel&&(R=!0,I.level=+m.outlineLevel),R&&(F[A-1]=I)),y=v.slice(b).split(e);for(var H=0;H!=y.length&&"<"==y[H].trim().charAt(0);++H);for(y=y.slice(H),b=0;b!=y.length;++b)if(0!==(v=y[b].trim()).length){if(w=v.match(r),N=b,j=0,k=0,v="<c "+("<"==v.slice(0,1)?">":"")+v,null!=w&&2===w.length){for(N=0,S=w[1],j=0;j!=S.length&&!((k=S.charCodeAt(j)-64)<1||k>26);++j)N=26*N+k;C=--N}else++C;for(j=0;j!=v.length&&62!==v.charCodeAt(j);++j);if(++j,(m=fo(v.slice(0,j),!0)).r||(m.r=oc({r:A-1,c:C})),f={t:""},null!=(w=(S=v.slice(j)).match(s))&&""!==w[1]&&(f.v=xo(w[1])),c.cellFormula){if(null!=(w=S.match(i))&&""!==w[1]){if(f.f=xo(Eo(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=kf(f.f)),w[0].indexOf('t="array"')>-1)f.F=(S.match(a)||[])[1],f.F.indexOf(":")>-1&&L.push([dc(f.F),f.F]);else if(w[0].indexOf('t="shared"')>-1){g=fo(w[0]);var W=xo(Eo(w[1]));c.xlfn||(W=kf(W)),P[parseInt(g.si,10)]=[g,W,m.r]}}else(w=S.match(/<f[^>]*\/>/))&&P[(g=fo(w[0])).si]&&(f.f=jf(P[g.si][1],P[g.si][2],m.r));var V=ic(m.r);for(j=0;j<L.length;++j)V.r>=L[j][0].s.r&&V.r<=L[j][0].e.r&&V.c>=L[j][0].s.c&&V.c<=L[j][0].e.c&&(f.F=L[j][1])}if(null==m.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!D)continue;f.t="z"}else f.t=m.t||"n";switch(d.s.c>C&&(d.s.c=C),d.e.c<C&&(d.e.c=C),f.t){case"n":if(""==f.v||null==f.v){if(!D)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!D)continue;f.t="z"}else p=fm[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?Eo(f.v):"",c.cellHTML&&(f.h=jo(f.v));break;case"inlineStr":w=S.match(n),f.t="s",null!=w&&(p=Ju(w[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=So(f.v);break;case"d":c.cellDates?f.v=Ui(f.v,1):(f.v=Li(Ui(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=Qc[f.v]}if(_=T=0,x=null,E&&void 0!==m.s&&null!=(x=h.CellXf[m.s])&&(null!=x.numFmtId&&(_=x.numFmtId),c.cellStyles&&null!=x.fillId&&(T=x.fillId)),ym(f,_,T,c,u,h),c.cellDates&&E&&"n"==f.t&&ui(Ds[_])&&(f.t="d",f.v=Ii(f.v)),m.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+m.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(O){var K=ic(m.r);l[K.r]||(l[K.r]=[]),l[K.r][K.c]=f}else l[m.r]=f}}}}F.length>0&&(l["!rows"]=F)}}();function Bm(e,t,r,n){var a,s=[io,zo("worksheet",null,{xmlns:al[0],"xmlns:r":el})],i=r.SheetNames[e],o="",l=r.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",d=dc(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=cc(d)}n||(n={}),l["!comments"]=[];var u=[];!function(e,t,r,n,a){var s=!1,i={},o=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(K_){}s=!0,i.codeName=Lo(yo(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+zo("outlinePr",null,c)}(s||o)&&(a[a.length]=zo("sheetPr",o,i))}(l,r,e,t,s),s[s.length]=zo("dimension",null,{ref:c}),s[s.length]=function(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),zo("sheetViews",zo("sheetView",null,a),{})}(0,0,0,r),t.sheetFormat&&(s[s.length]=zo("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function(e,t){for(var r,n=["<cols>"],a=0;a!=t.length;++a)(r=t[a])&&(n[n.length]=zo("col",null,xm(a,r)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var r,n,a=[],s=[],i=dc(e["!ref"]),o="",l="",c=[],d=0,u=0,h=e["!rows"],f=Array.isArray(e),m={r:l},p=-1;for(u=i.s.c;u<=i.e.c;++u)c[u]=sc(u);for(d=i.s.r;d<=i.e.r;++d){for(s=[],l=nc(d),u=i.s.c;u<=i.e.c;++u){r=c[u]+l;var g=f?(e[d]||[])[u]:e[r];void 0!==g&&null!=(o=Dm(g,r,e,t))&&s.push(o)}(s.length>0||h&&h[d])&&(m={r:l},h&&h[d]&&((n=h[d]).hidden&&(m.hidden=1),p=-1,n.hpx?p=Th(n.hpx):n.hpt&&(p=n.hpt),p>-1&&(m.ht=p,m.customHeight=1),n.level&&(m.outlineLevel=n.level)),a[a.length]=zo("row",s.join(""),m))}if(h)for(;d<h.length;++d)h&&h[d]&&(m={r:d+1},(n=h[d]).hidden&&(m.hidden=1),p=-1,n.hpx?p=Th(n.hpx):n.hpt&&(p=n.hpt),p>-1&&(m.ht=p,m.customHeight=1),n.level&&(m.outlineLevel=n.level),a[a.length]=zo("row","",m));return a.join("")}(l,t,0,0),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=function(e){var t={sheet:1};return Fm.forEach(function(r){null!=e[r]&&e[r]&&(t[r]="1")}),Im.forEach(function(r){null==e[r]||e[r]||(t[r]="0")}),e.password&&(t.password=mh(e.password).toString(16).toUpperCase()),zo("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function(e,t,r,n){var a="string"==typeof e.ref?e.ref:cc(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=lc(a);i.s.r==i.e.r&&(i.e.r=lc(t["!ref"]).e.r,a=cc(i));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),zo("autoFilter",null,{ref:a})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+cc(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,m=-1,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=id(n,-1,yo(e[1].Target).replace(/#.*$/,""),rd.HLINK),h["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(h.location=yo(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=yo(e[1].Tooltip)),s[s.length]=zo("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(bm(f=l["!margins"]),zo("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(s[s.length]=Bo("ignoredErrors",zo("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=id(n,-1,"../drawings/drawing"+(e+1)+".xml",rd.DRAW),s[s.length]=zo("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=u),l["!comments"].length>0&&(p=id(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",rd.VML),s[s.length]=zo("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Um(e,t,r,n){var a=function(e,t,r){var n=Yl(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=20*Th(a.hpx):a.hpt&&(s=20*a.hpt),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,f=d<<10;f<d+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[oc(c)])&&(u<0&&(u=f),h=f);u<0||(++o,n.write_shift(4,u),n.write_shift(4,h))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Jl(e,0,a)}var zm=Dc,qm=Mc;function Hm(e){return[Sc(e),Bc(e),"n"]}var Wm=Dc,Vm=Mc;var Gm=["left","right","top","bottom","header","footer"];function Km(e,t,r,n,a,s,i){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=qi(t)).z=t.z||Ds[14],t.v=Li(Ui(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:r,c:n};switch(l.s=vm(a.cellXfs,t,a),t.l&&s["!links"].push([oc(l),t.l]),t.c&&s["!comments"].push([oc(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=gm(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?Jl(e,18,function(e,t,r){return null==r&&(r=Yl(8)),Ac(t,r),r.write_shift(4,t.v),r}(0,l)):Jl(e,7,function(e,t,r){return null==r&&(r=Yl(12)),kc(t,r),r.write_shift(4,t.v),r}(0,l))):(l.t="str",i?Jl(e,17,function(e,t,r){return null==r&&(r=Yl(8+4*e.v.length)),Ac(t,r),bc(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l)):Jl(e,6,function(e,t,r){return null==r&&(r=Yl(12+4*e.v.length)),kc(t,r),bc(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Jl(e,13,function(e,t,r){return null==r&&(r=Yl(8)),Ac(t,r),Ic(e.v,r),r}(t,l)):Jl(e,2,function(e,t,r){return null==r&&(r=Yl(12)),kc(t,r),Ic(e.v,r),r}(t,l)):i?Jl(e,16,function(e,t,r){return null==r&&(r=Yl(12)),Ac(t,r),Uc(e.v,r),r}(t,l)):Jl(e,5,function(e,t,r){return null==r&&(r=Yl(16)),kc(t,r),Uc(e.v,r),r}(t,l)),!0;case"b":return l.t="b",i?Jl(e,15,function(e,t,r){return null==r&&(r=Yl(5)),Ac(t,r),r.write_shift(1,e.v?1:0),r}(t,l)):Jl(e,4,function(e,t,r){return null==r&&(r=Yl(9)),kc(t,r),r.write_shift(1,e.v?1:0),r}(t,l)),!0;case"e":return l.t="e",i?Jl(e,14,function(e,t,r){return null==r&&(r=Yl(8)),Ac(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,l)):Jl(e,3,function(e,t,r){return null==r&&(r=Yl(9)),kc(t,r),r.write_shift(1,e.v),r}(t,l)),!0}return i?Jl(e,12,function(e,t,r){return null==r&&(r=Yl(4)),Ac(t,r)}(0,l)):Jl(e,1,function(e,t,r){return null==r&&(r=Yl(8)),kc(t,r)}(0,l)),!0}function Ym(e,t){t&&t["!merges"]&&(Jl(e,177,function(e,t){return null==t&&(t=Yl(4)),t.write_shift(4,e),t}(t["!merges"].length)),t["!merges"].forEach(function(t){Jl(e,176,Vm(t))}),Jl(e,178))}function Xm(e,t){t&&t["!cols"]&&(Jl(e,390),t["!cols"].forEach(function(t,r){t&&Jl(e,60,function(e,t,r){null==r&&(r=Yl(18));var n=xm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof n.width&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}(r,t))}),Jl(e,391))}function $m(e,t){t&&t["!ref"]&&(Jl(e,648),Jl(e,649,function(e){var t=Yl(24);return t.write_shift(4,4),t.write_shift(4,1),Mc(e,t),t}(dc(t["!ref"]))),Jl(e,650))}function Jm(e,t,r){t["!links"].forEach(function(t){if(t[1].Target){var n=id(r,-1,t[1].Target.replace(/#.*$/,""),rd.HLINK);Jl(e,494,function(e,t){var r=Yl(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mc({s:ic(e[0]),e:ic(e[0])},r),Oc("rId"+t,r);var n=e[1].Target.indexOf("#");return bc((-1==n?"":e[1].Target.slice(n+1))||"",r),bc(e[1].Tooltip||"",r),bc("",r),r.slice(0,r.l)}(t,n))}}),delete t["!links"]}function Qm(e,t,r){Jl(e,133),Jl(e,137,function(e,t,r){null==r&&(r=Yl(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Jl(e,138),Jl(e,134)}function Zm(e,t){t["!protect"]&&Jl(e,535,function(e,t){return null==t&&(t=Yl(66)),t.write_shift(2,e.password?mh(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,null==e[r[0]]||e[r[0]]?0:1):t.write_shift(4,null!=e[r[0]]&&e[r[0]]?0:1)}),t}(t["!protect"]))}function ep(e,t,r,n){var a=$l(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(K_){}var l=dc(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Jl(a,129),(r.vbaraw||i["!outline"])&&Jl(a,147,function(e,t,r){null==r&&(r=Yl(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return zc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),_c(e,r),r.slice(0,r.l)}(o,i["!outline"])),Jl(a,148,qm(l)),Qm(a,0,r.Workbook),Xm(a,i),function(e,t,r,n){var a,s=dc(t["!ref"]||"A1"),i="",o=[];Jl(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=c;++d){i=nc(d),Um(e,t,s,d);var u=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=sc(h)),a=o[h]+i;var f=l?(t[d]||[])[h]:t[a];u=!!f&&Km(e,f,d,h,n,t,u)}}Jl(e,146)}(a,i,0,t),Zm(a,i),function(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s="string"===typeof a.ref?a.ref:cc(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=lc(s);o.s.r==o.e.r&&(o.e.r=lc(t["!ref"]).e.r,s=cc(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Jl(e,161,Mc(dc(s))),Jl(e,162)}}(a,i,r,e),Ym(a,i),Jm(a,i,n),i["!margins"]&&Jl(a,476,function(e,t){return null==t&&(t=Yl(48)),bm(e),Gm.forEach(function(r){Uc(e[r],t)}),t}(i["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||$m(a,i),function(e,t,r,n){if(t["!comments"].length>0){var a=id(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rd.VML);Jl(e,551,Oc("rId"+a)),t["!legacy"]=a}}(a,i,e,n),Jl(a,130),a.end()}function tp(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])});var a=xo((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,a,t]}(e);d.s.r=d.s.c=0,d.e.c=o,c=sc(o),t[0].forEach(function(e,r){i[c+nc(r)]={t:"n",v:e,z:t[1]},l=r}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=cc(d)),i}var rp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],np=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ap=[],sp=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ip(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=So(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function op(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=So(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function lp(e){op(e.WBProps,rp),op(e.CalcPr,sp),ip(e.WBView,np),ip(e.Sheets,ap),mm.date1904=So(e.WBProps.date1904)}var cp="][*?/\\".split("");function dp(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return cp.forEach(function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function up(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,r){e.forEach(function(n,a){dp(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)wm(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var hp=/<\w+:workbook/;function fp(e){var t=[io];t[t.length]=zo("workbook",null,{xmlns:al[0],"xmlns:r":el});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(rp.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=zo("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&a[s]&&a[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:yo(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=zo("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=zo("definedName",yo(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function mp(e,t){return t||(t=Yl(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Oc(e.strRelID,t),bc(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function pp(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function gp(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&-1==a?a=n:1==r[n].Hidden&&-1==s&&(s=n);s>a||(Jl(e,135),Jl(e,158,function(e,t){return t||(t=Yl(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}(a)),Jl(e,136))}}function xp(e,t){var r=$l();return Jl(r,131),Jl(r,128,function(e,t){t||(t=Yl(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return bc("SheetJS",t),bc(es.version,t),bc(es.version,t),bc("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Jl(r,153,function(e,t){t||(t=Yl(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),_c(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),gp(r,e),function(e,t){Jl(e,143);for(var r=0;r!=t.SheetNames.length;++r)Jl(e,156,mp({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Jl(e,144)}(r,e),Jl(r,132),r.end()}function bp(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ag[16]={n:"BrtFRTArchID$",f:pp},Xl(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=$f(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:n.push(l),a=!0;break;case 36:case 38:n.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),lp(r),r.Names=s,r.supbooks=i,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(co,function(o,l){var c=fo(o);switch(mo(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(hp)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[a];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":rp.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=So(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=Eo(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=xo(Eo(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=Eo(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),So(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=xo(Eo(e.slice(i,l))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===al.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return lp(r),r}(e,r)}function vp(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l,c,d,u,h,f,m,p,g,x,b=o.dense?[]:{},v={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=[],w=!1,N=!1,j=[];o.biff=12,o["!row"]=0;var k=0,S=!1,A=[],C={},_=o.supbooks||a.supbooks||[[]];if(_.sharedf=C,_.arrayf=A,_.SheetNames=a.SheetNames||a.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=_,a.Names))for(var T=0;T<a.Names.length;++T)_[0][T+1]=a.Names[T];var E,L,P=[],O=[],F=!1;if(ag[16]={n:"BrtShortReal",f:Hm},Xl(e,function(e,t,T){if(!N)switch(T){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(N=!0),g=nc(h=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Eh(e.hpt)),O[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=fm[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==o.cellText&&(d.w=Jc[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((u=i.CellXf[e[0].iStyleRef])&&ym(d,u.numFmtId,null,o,s,i),f=-1==e[0].c?f+1:e[0].c,o.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[sc(f)+g]=d,o.cellFormula){for(S=!1,k=0;k<A.length;++k){var I=A[k];c.r>=I[0].s.r&&c.r<=I[0].e.r&&f>=I[0].s.c&&f<=I[0].e.c&&(d.F=cc(I[0]),S=!0)}!S&&e.length>3&&(d.f=e[3])}if(v.s.r>c.r&&(v.s.r=c.r),v.s.c>f&&(v.s.c=f),v.e.r<c.r&&(v.e.r=c.r),v.e.c<f&&(v.e.c=f),o.cellDates&&u&&"n"==d.t&&ui(Ds[u.numFmtId])){var R=zs(d.v);R&&(d.t="d",d.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}E&&("XLDAPR"==E.type&&(d.D=!0),E=void 0),L&&(L=void 0);break;case 1:case 12:if(!o.sheetStubs||w)break;d={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[sc(f)+g]=d,v.s.r>c.r&&(v.s.r=c.r),v.s.c>f&&(v.s.c=f),v.e.r<c.r&&(v.e.r=c.r),v.e.c<f&&(v.e.c=f),E&&("XLDAPR"==E.type&&(d.D=!0),E=void 0),L&&(L=void 0);break;case 176:j.push(e);break;case 49:E=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var D=n["!id"][e.relId];for(D?(e.Target=D.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=D):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(b[h]||(b[h]=[]),b[h][f]||(b[h][f]={t:"z",v:void 0}),b[h][f].l=e):(m=oc({c:f,r:h}),b[m]||(b[m]={t:"z",v:void 0}),b[m].l=e);break;case 426:if(!o.cellFormula)break;A.push(e),(x=o.dense?b[h][f]:b[sc(f)+g]).f=$f(e[1],0,{r:c.r,c:f},_,o),x.F=cc(e[0]);break;case 427:if(!o.cellFormula)break;C[oc(e[0].s)]=e[1],(x=o.dense?b[h][f]:b[sc(f)+g]).f=$f(e[1],0,{r:c.r,c:f},_,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)P[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},F||(F=!0,Ah(e.w/256)),Ch(P[e.e+1]);break;case 161:b["!autofilter"]={ref:cc(e)};break;case 476:b["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:y.push(T),w=!0;break;case 38:y.pop(),w=!1;break;default:if(t.T);else if(!w||o.WTF)throw new Error("Unexpected record 0x"+T.toString(16))}},o),delete o.supbooks,delete o["!row"],!b["!ref"]&&(v.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(b["!ref"]=cc(l||v)),o.sheetRows&&b["!ref"]){var I=dc(b["!ref"]);o.sheetRows<=+I.e.r&&(I.e.r=o.sheetRows-1,I.e.r>v.e.r&&(I.e.r=v.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>v.e.c&&(I.e.c=v.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),b["!fullref"]=b["!ref"],b["!ref"]=cc(I))}return j.length>0&&(b["!merges"]=j),P.length>0&&(b["!cols"]=P),O.length>0&&(b["!rows"]=O),b}(e,n,r,a,s,i,o):Pm(e,n,r,a,s,i,o)}function yp(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return Xl(e,function(e,n,l){switch(l){case 550:s["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(l);break;case 38:i.pop();break;default:if(n.T>0)i.push(l);else if(n.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,n,r,a,s):function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(Tm);return o&&Om(o[0],0,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,0,r,a,s)}function wp(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var a in Ds)n.NumberFmt[a]=Ds[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Xl(e,function(e,a,o){switch(o){case 44:n.NumberFmt[e[0]]=e[1],gi(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=yh(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&n.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!i||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,r,n):Fh(e,r,n)}function Np(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return Xl(e,function(e,a,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var a=e.match(Qu);if(a){n=a[2].replace(Zu,"").split(eh);for(var s=0;s!=n.length;++s){var i=Ju(n[s].trim(),t);null!=i&&(r[r.length]=i)}a=fo(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}(e,r)}function jp(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],a={},s=!1;return Xl(e,function(e,i,o){switch(o){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var s=fo(a[0]),i={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=ic(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Ju(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),n.push(i)}}}}),n}(e,r)}function kp(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Xl(e,function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(co)||[]).forEach(function(e){var n=fo(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}}),t}(e)}function Sp(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Xl(e,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},a)}(e,0,0,n)}function Ap(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Xl(e,function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==o&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,s=!1,i=2;return e.replace(co,function(e){var t=fo(e);switch(mo(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==t.name&&(a=n.Types[o]);break;case"<rc":1==i?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==i&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),n}(e,0,r)}function Cp(e,t,r,n,a){return(".bin"===t.slice(-4)?ep:Bm)(e,r,n,a)}function _p(e,t,r){return(".bin"===t.slice(-4)?xf:mf)(e,r)}var Tp,Ep=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Lp=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Pp(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var a,s,i,o=e.match(Ep);if(o)for(i=0;i!=o.length;++i)-1===(s=(a=o[i].match(Lp))[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):n["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return n}function Op(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,a,s=e.match(Ep);if(s)for(a=0;a!=s.length;++a)-1===(n=(r=s[a].match(Lp))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function Fp(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=So(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ui(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xo(t)]=a}function Ip(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Jc[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ks(e.v):e.w=Ys(e.v):e.w=function(e,t){var r=Tp[e]||xo(e);return"General"===r?Ys(t):pi(r,t)}(t||"General",e.v)}catch(K_){if(r.WTF)throw K_}try{var n=Tp[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&ui(n)){var a=zs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(K_){if(r.WTF)throw K_}}}function Rp(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Lh[n.Pattern]||n.Pattern)}e[t.ID]=t}function Dp(e,t,r,n,a,s,i,o,l,c){var d="General",u=n.StyleID,h={};c=c||{};var f=[],m=0;for(void 0===u&&o&&(u=o.StyleID),void 0===u&&i&&(u=i.StyleID);void 0!==s[u]&&(s[u].nf&&(d=s[u].nf),s[u].Interior&&f.push(s[u].Interior),s[u].Parent);)u=s[u].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=So(e);break;case"String":n.t="s",n.r=ko(xo(e)),n.v=e.indexOf("<")>-1?xo(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(Ui(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=xo(e):n.v<60&&(n.v=n.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Qc[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=ko(t||e))}if(Ip(n,d,c),!1!==c.cellFormula)if(n.Formula){var p=xo(n.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),n.f=vf(p,a),delete n.Formula,"RC"==n.ArrayRange?n.F=vf("RC:RC",a):n.ArrayRange&&(n.F=vf(n.ArrayRange,a),l.push([dc(n.F),n.F]))}else for(m=0;m<l.length;++m)a.r>=l[m][0].s.r&&a.r<=l[m][0].e.r&&a.c>=l[m][0].s.c&&a.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(f.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),n.s=h),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function Mp(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Bp(e,t){var r=t||{};bi();var n=us(Ho(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof ds?ds.utils.decode(65001,ls(n)):Eo(n));var a,s=n.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=qi(r);return o.type="string",Wu.to_workbook(n,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return fc(gg(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach(function(e,r){Fx(n,gg(e,t),"Sheet"+(r+1))}),n}(n,r);Tp={"General Number":"General","General Date":Ds[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ds[15],"Short Date":Ds[14],"Long Time":Ds[19],"Medium Time":Ds[18],"Short Time":Ds[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ds[2],Standard:Ds[4],Percent:Ds[10],Scientific:Ds[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var d,u={},h=[],f=r.dense?[]:{},m="",p={},g={},x=Pp('<Data ss:Type="String">'),b=0,v=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},j={},k="",S=0,A=[],C={},_={},T=0,E=[],L=[],P={},O=[],F=!1,I=[],R=[],D={},M=0,B=0,U={Sheets:[],WBProps:{date1904:!1}},z={};Wo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var q="";a=Wo.exec(n);)switch(a[3]=(q=a[3]).toLowerCase()){case"data":if("data"==q){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?Dp(n.slice(b,a.index),k,x,"comment"==c[c.length-1][0]?P:p,{c:v,r:y},N,O[v],g,I,r):(k="",x=Pp(a[0]),b=a.index+a[0].length);break;case"cell":if("/"===a[1])if(L.length>0&&(p.c=L),(!r.sheetRows||r.sheetRows>y)&&void 0!==p.v&&(r.dense?(f[y]||(f[y]=[]),f[y][v]=p):f[sc(v)+nc(y)]=p),p.HRef&&(p.l={Target:xo(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(M=v+(0|parseInt(p.MergeAcross,10)),B=y+(0|parseInt(p.MergeDown,10)),A.push({s:{c:v,r:y},e:{c:M,r:B}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=v;H<=M;++H)for(var W=y;W<=B;++W)(H>v||W>y)&&(r.dense?(f[W]||(f[W]=[]),f[W][H]={t:"z"}):f[sc(H)+nc(W)]={t:"z"});v=M+1}else++v;else p.MergeAcross?v=M+1:++v;else(p=Op(a[0])).Index&&(v=+p.Index-1),v<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),"/>"===a[0].slice(-2)&&++v,L=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===a[0].slice(-2)&&(g=Pp(a[0])).Index&&(y=+g.Index-1),v=0,++y):((g=Pp(a[0])).Index&&(y=+g.Index-1),D={},("0"==g.AutoFitHeight||g.Height)&&(D.hpx=parseInt(g.Height,10),D.hpt=Th(D.hpx),R[y]=D),"1"==g.Hidden&&(D.hidden=!0,R[y]=D));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));h.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=cc(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=cc(w))),A.length&&(f["!merges"]=A),O.length>0&&(f["!cols"]=O),R.length>0&&(f["!rows"]=R),u[m]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,c.push([a[3],!1]),l=Pp(a[0]),m=xo(l.Name),f=r.dense?[]:{},A=[],I=[],R=[],z={name:m,Hidden:0},U.Sheets.push(z);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),O=[],F=!1}break;case"style":"/"===a[1]?Rp(N,j,r):j=Pp(a[0]);break;case"numberformat":j.nf=xo(Pp(a[0]).Format||"General"),Tp[j.nf]&&(j.nf=Tp[j.nf]);for(var V=0;392!=V&&Ds[V]!=j.nf;++V);if(392==V)for(V=57;392!=V;++V)if(null==Ds[V]){gi(j.nf,V);break}break;case"column":if("table"!==c[c.length-1][0])break;if((d=Pp(a[0])).Hidden&&(d.hidden=!0,delete d.Hidden),d.Width&&(d.wpx=parseInt(d.Width,10)),!F&&d.wpx>10){F=!0,wh=6;for(var G=0;G<O.length;++G)O[G]&&Ch(O[G])}F&&Ch(d),O[d.Index-1||O.length]=d;for(var K=0;K<+d.Span;++K)O[O.length]=qi(d);break;case"namedrange":if("/"===a[1])break;U.Names||(U.Names=[]);var Y=fo(a[0]),X={Name:Y.Name,Ref:vf(Y.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(X.Sheet=U.Sheets.length-1),U.Names.push(X);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?k+=n.slice(S,a.index):S=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Pp(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?jd(C,q,n.slice(T,a.index)):T=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));Mp(P),L.push(P)}else c.push([a[3],!1]),P={a:(l=Pp(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var $=Pp(a[0]);f["!autofilter"]={ref:vf($.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return Tg(n,r);if(0==c.length&&"uof"==a[3])return Tg(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(T,a.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else T=a.index+a[0].length;break;case"header":f["!margins"]||bm(f["!margins"]={},"xlml"),isNaN(+fo(a[0]).Margin)||(f["!margins"].header=+fo(a[0]).Margin);break;case"footer":f["!margins"]||bm(f["!margins"]={},"xlml"),isNaN(+fo(a[0]).Margin)||(f["!margins"].footer=+fo(a[0]).Margin);break;case"pagemargins":var Q=fo(a[0]);f["!margins"]||bm(f["!margins"]={},"xlml"),isNaN(+Q.Top)||(f["!margins"].top=+Q.Top),isNaN(+Q.Left)||(f["!margins"].left=+Q.Left),isNaN(+Q.Right)||(f["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(f["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?Fp(_,q,E,n.slice(T,a.index)):(E=a,T=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=u),Z.SheetNames=h,Z.Workbook=U,Z.SSF=qi(Ds),Z.Props=C,Z.Custprops=_,Z}function Up(e,t){switch(ox(t=t||{}),t.type||"base64"){case"base64":return Bp(gs(e),t);case"binary":case"buffer":case"file":return Bp(e,t);case"array":return Bp(js(e),t)}}function zp(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return Ai(Nd).map(function(e){for(var t=0;t<dd.length;++t)if(dd[t][1]==e)return dd[t];for(t=0;t<pd.length;++t)if(pd[t][1]==e)return pd[t];throw e}).forEach(function(n){if(null!=e[n[1]]){var a=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Bo(Nd[n[1]]||n[1],a))}}),zo("DocumentProperties",r.join(""),{xmlns:sl})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Ai(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<dd.length;++n)if(t==dd[n][1])return;for(n=0;n<pd.length;++n)if(t==pd[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var s=e[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s=String(s),a.push(zo(wo(t),s,{"dt:dt":i}))}}),t&&Ai(t).forEach(function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],s="string";"number"==typeof n?(s="float",n=String(n)):!0===n||!1===n?(s="boolean",n=n?"1":"0"):n instanceof Date?(s="dateTime.tz",n=n.toISOString()):n=String(n),a.push(zo(wo(r),n,{"dt:dt":s}))}}),"<"+n+' xmlns="'+sl+'">'+a.join("")+"</"+n+">"}(e.Props,e.Custprops)),r.join("")}function qp(e){return zo("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+wf(e.Ref,{r:0,c:0})})}function Hp(e,t,r,n,a,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+yo(wf(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=ic(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=yo(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=yo(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=Jc[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Ds[14]);break;case"s":u="String",h=((e.v||"")+"").replace(bo,function(e){return go[e]}).replace(No,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=vm(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=i.c+1;var m=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=zo("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return zo("Comment",t,{"ss:Author":e.a})}).join("")),zo("Cell",p,o)}function Wp(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Eh(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Vp(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?function(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(qp(o)))}return s.join("")}(s,0,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?function(e,t){if(!e["!ref"])return"";var r=dc(e["!ref"]),n=e["!merges"]||[],a=0,s=[];e["!cols"]&&e["!cols"].forEach(function(e,t){Ch(e);var r=!!e.width,n=xm(t,e),a={"ss:Index":t+1};r&&(a["ss:Width"]=Nh(n.width)),e.hidden&&(a["ss:Hidden"]="1"),s.push(zo("Column",null,a))});for(var i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var l=[Wp(o,(e["!rows"]||[])[o])],c=r.s.c;c<=r.e.c;++c){var d=!1;for(a=0;a!=n.length;++a)if(!(n[a].s.c>c)&&!(n[a].s.r>o)&&!(n[a].e.c<c)&&!(n[a].e.r<o)){n[a].s.c==c&&n[a].s.r==o||(d=!0);break}if(!d){var u={r:o,c:c},h=oc(u),f=i?(e[o]||[])[c]:e[h];l.push(Hp(f,h,e,t,0,0,u))}}l.push("</Row>"),l.length>2&&s.push(l.join(""))}return s.join("")}(s,t):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(function(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(zo("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(zo("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(zo("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(zo("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&(!n.Workbook.Sheets[s]||n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Bo("ProtectContents","True")),e["!protect"].objects&&a.push(Bo("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Bo("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(Bo("EnableSelection","UnlockedCells")):a.push(Bo("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":zo("WorksheetOptions",a.join(""),{xmlns:il})}(s,0,e,r)),n.join("")}function Gp(e,t){t||(t={}),e.SSF||(e.SSF=qi(Ds)),e.SSF&&(bi(),xi(e.SSF),t.revssf=Ti(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],vm(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(zp(e,t)),r.push(""),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(zo("Worksheet",Vp(n,t,e),{"ss:Name":yo(e.SheetNames[n])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var n=[];n.push(zo("NumberFormat",null,{"ss:Format":yo(Ds[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};r.push(zo("Style",n.join(""),a))}),zo("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||r.push(qp(a)))}return zo("Names",r.join(""))}(e),io+zo("Workbook",r.join(""),{xmlns:ol,"xmlns:o":sl,"xmlns:x":il,"xmlns:ss":ol,"xmlns:dt":ll,"xmlns:html":ul})}function Kp(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return qc(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return qc(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Yp=[60,1084,2066,2165,2175];function Xp(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Il(r,r.l),c=sg[l],d=0;null!=c&&Yp.indexOf(l)>-1;)s=Il(r,r.l+2),d=r.l+4,2066==l?d+=4:2165!=l&&2175!=l||(d+=12),o=r.slice(d,r.l+4+s),i.push(o),r.l+=4+s,c=sg[l=Il(r,r.l)];var u=Ss(i);Gl(u,0);var h=0;u.lens=[];for(var f=0;f<i.length;++f)u.lens.push(h),h+=i[f].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return t.f(u,u.length,a)}function $p(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ds[n])}catch(K_){if(t.WTF)throw K_}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Jc[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ks(e.v):e.w=Ys(e.v):e.w=pi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(K_){if(t.WTF)throw K_}if(t.cellDates&&n&&"n"==e.t&&ui(Ds[n]||String(n))){var a=zs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Jp(e,t,r){return{v:e,ixfe:t,t:r}}function Qp(e,t){var r={opts:{}},n={};var a,s,i,o,l,c,d,u,h=t.dense?[]:{},f={},m={},p=null,g=[],x="",b={},v="",y={},w=[],N=[],j=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},A=function(e){return e<8?$c[e]:e<64&&j[e-8]||$c[e]},C=function(e,t,r){if(!(D>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=vh(A(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=vh(A(a.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,a=e,v=oc(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<w.length;++n)if(!(w[n][0].s.c>e.c||w[n][0].s.r>e.r)&&!(w[n][0].e.c<e.c||w[n][0].e.r<e.r)){t.F=cc(w[n][0]),w[n][0].s.c==e.c&&w[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+$f(w[n][1],0,e,F,_));break}r.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[v]=t}},_={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(_.password=t.password);var T=[],E=[],L=[],P=[],O=!1,F=[];F.SheetNames=_.snames,F.sharedf=_.sharedf,F.arrayf=_.arrayf,F.names=[],F.XTI=[];var I,R=0,D=0,M=0,B=[],U=[];_.codepage=1200,is(1200);for(var z=!1;e.l<e.length-1;){var q=e.l,H=e.read_shift(2);if(0===H&&10===R)break;var W=e.l===e.length?0:e.read_shift(2),V=sg[H];if(V&&V.f){if(t.bookSheets&&133===R&&133!==H)break;if(R=H,2===V.r||12==V.r){var G=e.read_shift(2);if(W-=2,!_.enc&&G!==H&&((255&G)<<8|G>>8)!==H)throw new Error("rt mismatch: "+G+"!="+H);12==V.r&&(e.l+=10,W-=10)}var K={};if(K=10===H?V.f(e,W,_):Xp(H,V,e,W,_),0==D&&-1===[9,521,1033,2057].indexOf(R))continue;switch(H){case 34:r.opts.Date1904=k.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=K;break;case 66:var Y=Number(K);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}is(_.codepage=Y),z=!0;break;case 317:_.rrtabid=K;break;case 25:_.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:_.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(h["!type"]="dialog"),K.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),K.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:N.push(K);break;case 430:F.push([K]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(K);break;case 24:case 536:I={Name:K.Name,Ref:$f(K.rgce,0,null,F,_)},K.itab>0&&(I.Sheet=K.itab-1),F.names.push(I),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(U[K.itab-1]={ref:cc(K.rgce[0][0][1][2])});break;case 22:_.ExternCount=K;break;case 23:0==F.length&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(K),F.XTI=F.XTI.concat(K);break;case 2196:if(_.biff<8)break;null!=I&&(I.Comment=K[1]);break;case 18:h["!protect"]=K;break;case 19:0!==K&&_.WTF&&console.error("Password verifier: "+K);break;case 133:f[K.pos]=K,_.snames.push(K.name);break;case 10:if(--D)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,h["!ref"]=cc(m),t.sheetRows&&t.sheetRows<=m.e.r){var X=m.e.r;m.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=cc(m),m.e.r=X}m.e.r++,m.e.c++}T.length>0&&(h["!merges"]=T),E.length>0&&(h["!objects"]=E),L.length>0&&(h["!cols"]=L),P.length>0&&(h["!rows"]=P),k.Sheets.push(S)}""===x?b=h:n[x]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===_.biff&&(_.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),_.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(_.biff=5,z=!0,is(_.codepage=28591)),8==_.biff&&0==K.BIFFVer&&16==K.dt&&(_.biff=2),D++)break;if(h=t.dense?[]:{},_.biff<8&&!z&&(z=!0,is(_.codepage=t.codepage||1252)),_.biff<5||0==K.BIFFVer&&4096==K.dt){""===x&&(x="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var $={pos:e.l-W,name:x};f[$.pos]=$,_.snames.push(x)}else x=(f[q]||{name:""}).name;32==K.dt&&(h["!type"]="chart"),64==K.dt&&(h["!type"]="macro"),T=[],E=[],_.arrayf=w=[],L=[],P=[],O=!1,S={Hidden:(f[q]||{hs:0}).hs,name:x};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[K.r]||[])[K.c]:h[oc({c:K.c,r:K.r})])&&++K.c,c={ixfe:K.ixfe,XF:N[K.ixfe]||{},v:K.val,t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 5:case 517:c={ixfe:K.ixfe,XF:N[K.ixfe],v:K.val,t:K.t},M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 638:c={ixfe:K.ixfe,XF:N[K.ixfe],v:K.rknum,t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 189:for(var J=K.c;J<=K.C;++J){var Q=K.rkrec[J-K.c][0];c={ixfe:Q,XF:N[Q],v:K.rkrec[J-K.c][1],t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:J,r:K.r},c,t)}break;case 6:case 518:case 1030:if("String"==K.val){p=K;break}if((c=Jp(K.val,K.cell.ixfe,K.tt)).XF=N[c.ixfe],t.cellFormula){var Z=K.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=oc({r:ee,c:te});y[re]?c.f=""+$f(K.formula,0,K.cell,F,_):c.F=((t.dense?(h[ee]||[])[te]:h[re])||{}).F}else c.f=""+$f(K.formula,0,K.cell,F,_)}M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C(K.cell,c,t),p=K;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=K,(c=Jp(K,p.cell.ixfe,"s")).XF=N[c.ixfe],t.cellFormula&&(c.f=""+$f(p.formula,0,p.cell,F,_)),M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C(p.cell,c,t),p=null;break;case 33:case 545:w.push(K);var ne=oc(K[0].s);if(s=t.dense?(h[K[0].s.r]||[])[K[0].s.c]:h[ne],t.cellFormula&&s){if(!p)break;if(!ne||!s)break;s.f=""+$f(K[1],0,K[0],F,_),s.F=cc(K[0])}break;case 1212:if(!t.cellFormula)break;if(v){if(!p)break;y[oc(p.cell)]=K[0],((s=t.dense?(h[p.cell.r]||[])[p.cell.c]:h[oc(p.cell)])||{}).f=""+$f(K[0],0,a,F,_)}break;case 253:c=Jp(g[K.isst].t,K.ixfe,"s"),g[K.isst].h&&(c.h=g[K.isst].h),c.XF=N[c.ixfe],M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:K.ixfe,XF:N[K.ixfe],t:"z"},M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t));break;case 190:if(t.sheetStubs)for(var ae=K.c;ae<=K.C;++ae){var se=K.ixfe[ae-K.c];c={ixfe:se,XF:N[se],t:"z"},M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:ae,r:K.r},c,t)}break;case 214:case 516:case 4:(c=Jp(K.val,K.ixfe,"s")).XF=N[c.ixfe],M>0&&(c.z=B[c.ixfe>>8&63]),$p(c,t,r.opts.Date1904),C({c:K.c,r:K.r},c,t);break;case 0:case 512:1===D&&(m=K);break;case 252:g=K;break;case 1054:if(4==_.biff){B[M++]=K[1];for(var ie=0;ie<M+163&&Ds[ie]!=K[1];++ie);ie>=163&&gi(K[1],M+163)}else gi(K[1],K[0]);break;case 30:B[M++]=K;for(var oe=0;oe<M+163&&Ds[oe]!=K;++oe);oe>=163&&gi(K,M+163);break;case 229:T=T.concat(K);break;case 93:E[K.cmo[0]]=_.lastobj=K;break;case 438:_.lastobj.TxO=K;break;case 127:_.lastobj.ImData=K;break;case 440:for(l=K[0].s.r;l<=K[0].e.r;++l)for(o=K[0].s.c;o<=K[0].e.c;++o)(s=t.dense?(h[l]||[])[o]:h[oc({c:o,r:l})])&&(s.l=K[1]);break;case 2048:for(l=K[0].s.r;l<=K[0].e.r;++l)for(o=K[0].s.c;o<=K[0].e.c;++o)(s=t.dense?(h[l]||[])[o]:h[oc({c:o,r:l})])&&s.l&&(s.l.Tooltip=K[1]);break;case 28:if(_.biff<=5&&_.biff>=2)break;s=t.dense?(h[K[0].r]||[])[K[0].c]:h[oc(K[0])];var le=E[K[2]];s||(t.dense?(h[K[0].r]||(h[K[0].r]=[]),s=h[K[0].r][K[0].c]={t:"z"}):s=h[oc(K[0])]={t:"z"},m.e.r=Math.max(m.e.r,K[0].r),m.s.r=Math.min(m.s.r,K[0].r),m.e.c=Math.max(m.e.c,K[0].c),m.s.c=Math.min(m.s.c,K[0].c)),s.c||(s.c=[]),i={a:K[1],t:le.TxO.t},s.c.push(i);break;case 2173:lf(N[K.ixfe],K.ext);break;case 125:if(!_.cellStyles)break;for(;K.e>=K.s;)L[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},O||(O=!0,Ah(K.w/256)),Ch(L[K.e+1]);break;case 520:var ce={};null!=K.level&&(P[K.r]=ce,ce.level=K.level),K.hidden&&(P[K.r]=ce,ce.hidden=!0),K.hpt&&(P[K.r]=ce,ce.hpt=K.hpt,ce.hpx=Eh(K.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||bm(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=K;break;case 161:h["!margins"]||bm(h["!margins"]={}),h["!margins"].header=K.header,h["!margins"].footer=K.footer;break;case 574:K.RTL&&(k.Views[0].RTL=!0);break;case 146:j=K;break;case 2198:u=K;break;case 140:d=K;break;case 442:x?S.CodeName=K||S.name:k.WBProps.CodeName=K||"ThisWorkbook"}}else V||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=W}return r.SheetNames=Ai(f).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return f[e].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&b["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=b)):r.Preamble=b,r.Sheets&&U.forEach(function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e}),r.Strings=g,r.SSF=qi(Ds),_.enc&&(r.Encryption=_.enc),u&&(r.Themes=u),r.Metadata={},void 0!==d&&(r.Metadata.Country=d),F.names.length>0&&(k.Names=F.names),r.Workbook=k,r}var Zp="e0859ff2f94f6810ab9108002b27b3d9",eg="02d5cdd59c2e1b10939708002b2cf9ae",tg="05d5cdd59c2e1b10939708002b2cf9ae";function rg(e,t){var r,n,a,s;if(t||(t={}),ox(t),os(),t.codepage&&ss(t.codepage),e.FullPaths){if(Ni.find(e,"/encryption"))throw new Error("File is password-protected");r=Ni.find(e,"!CompObj"),n=Ni.find(e,"/Workbook")||Ni.find(e,"/Book")}else{switch(t.type){case"base64":e=ws(gs(e));break;case"binary":e=ws(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Gl(e,0),n={content:e}}if(r&&Kp(r),t.bookProps&&!t.bookSheets)a={};else{var i=xs?"buffer":"array";if(n&&n.content)a=Qp(n.content,t);else if((s=Ni.find(e,"PerfectOffice_MAIN"))&&s.content)a=Vu.to_workbook(s.content,(t.type=i,t));else{if(!(s=Ni.find(e,"NativeContent_MAIN"))||!s.content)throw(s=Ni.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Vu.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&Ni.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Ni.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ni.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ni.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,r){var n=Ni.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Md(n,Vc,eg);for(var s in a)t[s]=a[s]}catch(K_){if(r.WTF)throw K_}var i=Ni.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Md(i,Gc,Zp);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(K_){if(r.WTF)throw K_}t.HeadingPairs&&t.TitlesOfParts&&(xd(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function ng(e,t){var r=t||{},n=Ni.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ni.utils.cfb_add(n,a,pg(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,n=[],a=[],s=[],i=0,o=Ci(Vc,"n"),l=Ci(Gc,"n");if(e.Props)for(r=Ai(e.Props),i=0;i<r.length;++i)(Object.prototype.hasOwnProperty.call(o,r[i])?n:Object.prototype.hasOwnProperty.call(l,r[i])?a:s).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(r=Ai(e.Custprops),i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(o,r[i])?n:Object.prototype.hasOwnProperty.call(l,r[i])?a:s).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<s.length;++i)Id.indexOf(s[i][0])>-1||gd.indexOf(s[i][0])>-1||null!=s[i][1]&&c.push(s[i]);a.length&&Ni.utils.cfb_add(t,"/\x05SummaryInformation",Bd(a,Zp,l,Gc)),(n.length||c.length)&&Ni.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Bd(n,eg,o,Vc,c.length?c:null,tg))}(e,n),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(r,n){if(0!=n){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&Ni.utils.cfb_add(e,a,t.FileIndex[n].content)}})}(n,Ni.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var ag={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=a/20),r}},1:{f:function(e){return[jc(e)]}},2:{f:function(e){return[jc(e),Fc(e),"n"]}},3:{f:function(e){return[jc(e),e.read_shift(1),"e"]}},4:{f:function(e){return[jc(e),e.read_shift(1),"b"]}},5:{f:function(e){return[jc(e),Bc(e),"n"]}},6:{f:function(e){return[jc(e),xc(e),"str"]}},7:{f:function(e){return[jc(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=jc(e);a.r=r["!row"];var s=[a,xc(e),"str"];if(r.cellFormula){e.l+=2;var i=nm(e,n-e.l,r);s[3]=$f(i,0,a,r.supbooks,r)}else e.l=n;return s}},9:{f:function(e,t,r){var n=e.l+t,a=jc(e);a.r=r["!row"];var s=[a,Bc(e),"n"];if(r.cellFormula){e.l+=2;var i=nm(e,n-e.l,r);s[3]=$f(i,0,a,r.supbooks,r)}else e.l=n;return s}},10:{f:function(e,t,r){var n=e.l+t,a=jc(e);a.r=r["!row"];var s=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=nm(e,n-e.l,r);s[3]=$f(i,0,a,r.supbooks,r)}else e.l=n;return s}},11:{f:function(e,t,r){var n=e.l+t,a=jc(e);a.r=r["!row"];var s=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=nm(e,n-e.l,r);s[3]=$f(i,0,a,r.supbooks,r)}else e.l=n;return s}},12:{f:function(e){return[Sc(e)]}},13:{f:function(e){return[Sc(e),Fc(e),"n"]}},14:{f:function(e){return[Sc(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Sc(e),e.read_shift(1),"b"]}},16:{f:Hm},17:{f:function(e){return[Sc(e),xc(e),"str"]}},18:{f:function(e){return[Sc(e),e.read_shift(4),"s"]}},19:{f:yc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=Lc(e),i=am(e,0,r),o=Tc(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(n.underline=s);var i=e.read_shift(1);i>0&&(n.family=i);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=$c[n];l&&(t.rgb=vh(l));break;case 2:t.rgb=vh([s,i,o]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=xc(e),n}},44:{f:function(e,t){return[e.read_shift(2),xc(e)]}},45:{f:Uh},46:{f:Wh},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Iu},62:{f:function(e){return[jc(e),yc(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=oc(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=Cc(e,t-19),r}},148:{f:zm,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?xc(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pc(e,t-8),r.name=xc(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Dc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Wm},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:xc(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Eu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=Rc(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=rm(e,n-e.l,r);i[1]=o}else e.l=n;return i}},427:{f:function(e,t,r){var n=e.l+t,a=[Dc(e,16)];if(r.cellFormula){var s=sm(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Gm.forEach(function(r){t[r]=Bc(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=Dc(e,16),a=Tc(e),s=xc(e),i=xc(e),o=xc(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:gf},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Dc(e,16);return t.rfx=r.s,t.ref=oc(r.s),e.l+=16,t}},636:{T:-1},637:{f:wc},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:xc(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sg={6:{f:Zf},10:{f:Ud},12:{f:Hd},13:{f:Hd},14:{f:zd},15:{f:zd},16:{f:Bc},17:{f:zd},18:{f:zd},19:{f:Hd},20:{f:Au},21:{f:Au},23:{f:Eu},24:{f:Tu},25:{f:zd},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Qd(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}(e,0,r)}},29:{},34:{f:zd},35:{f:Cu},38:{f:Bc},39:{f:Bc},40:{f:Bc},41:{f:Bc},42:{f:zd},43:{f:zd},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?xh(e,t-2,n):function(e,t,r,n){var a={key:Hd(e),verificationBytes:Hd(e)};r.password&&(a.verifier=mh(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=gh(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=Kd(e,0,r),n}},51:{f:Hd},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:zd},65:{f:function(){}},66:{f:Hd},77:{},80:{},81:{},82:{},85:{f:Hd},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Qd(e,0,r);return e.read_shift(t+n-e.l),a}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Pu[n]||Kl)(e,t,r)),{cmo:[a,n,s],ft:i}}(e,t,r);var n=mu(e),a=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(gu[a](e,r-e.l))}catch(K_){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:a}}},94:{},95:{f:zd},96:{},97:{},99:{f:zd},125:{f:Iu},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:Hd},131:{f:zd},132:{f:zd},133:{f:function(e,t,r){var n=e.read_shift(4),a=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=Kd(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Kc[t]||t,t=e.read_shift(2),r[1]=Kc[t]||t,r}},141:{f:Hd},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(su(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Hd},157:{},158:{},160:{f:Du},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Bc(e),r.footer=Bc(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(cu(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}},193:{f:Ud},197:{},198:{},199:{},200:{},201:{},202:{f:zd},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Hd},220:{},221:{f:zd},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Yc[o>>26],n.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&i,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Ud},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(du(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(Yd(e));return s.Count=n,s.Unique=a,s}},253:{f:function(e){var t=iu(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Vd},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zd},353:{f:Ud},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=$d(e,s),o=[];n>e.l;)o.push(Jd(e));return[s,a,i,o]}},431:{f:zd},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var i=e.read_shift(2);e.read_shift(2),Hd(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=$d(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(a.length!==i&&a.length!==2*i)throw new Error("cchText: "+i+" != "+a.length);return e.l=n+t,{t:a}}catch(K_){return e.l=n+t,{t:a}}}},439:{f:zd},440:{f:function(e,t){var r=du(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c,d,u="";16&a&&(s=tu(e,e.l)),128&a&&(i=tu(e,e.l)),257===(257&a)&&(o=tu(e,e.l)),1===(257&a)&&(l=eu(e,e.l)),8&a&&(u=tu(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(d=kd(e)),e.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),2&a&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),d&&(f.time=d),s&&(f.Tooltip=s),f}(e,t-24);return[r,n]}},441:{},442:{f:Jd},443:{},444:{f:Hd},445:{},446:{},448:{f:Ud},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Ud},512:{f:ju},513:{f:Ru},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=iu(e),a=Bc(e);return n.val=a,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=iu(e);2==r.biff&&e.l++;var a=Jd(e,e.l,r);return n.val=a,n}},517:{f:Su},519:{f:Mu},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:Lu},549:{f:yu},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=cu(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),Qd(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=hu(e);e.l++;var a=e.read_shift(1);return[Qf(e,t-=8,r),a,n]}},2048:{f:function(e,t){e.read_shift(2);var r=du(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(As,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ud},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(of(e,e.l));return{ixfe:r,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zd,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2);return[$d(e,n,r),$d(e,a,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var a,s=e.slice(e.l);e.l=n;try{a=ao(s,{type:"array"})}catch(K_){return}var i=Zi(a,"theme/theme/theme1.xml",!0);if(i)return nf(i,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Ud},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Hd},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(su(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ju},1:{},2:{f:function(e){var t=iu(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=iu(e);++e.l;var r=Bc(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=iu(e);++e.l;var a=Qd(e,0,r);return n.t="str",n.val=a,n}},5:{f:Su},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:xu},11:{},22:{f:Hd},30:{f:Nu},31:{},32:{},33:{f:Lu},36:{},37:{f:yu},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Hd},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,a=iu(e),s=e.read_shift(2),i=$d(e,s,r);return e.l=n,a.t="str",a.val=i,a}},223:{},234:{},354:{},421:{},518:{f:Zf},521:{f:xu},536:{f:Tu},547:{f:Cu},561:{},579:{},1030:{f:Zf},1033:{f:xu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ig(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Pl(r)&&e.push(r)}}function og(e,t,r){return e||(e=Yl(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function lg(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?Li(Ui(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?ig(e,2,function(e,t,r){var n=Yl(9);return og(n,e,t),n.write_shift(2,r),n}(r,n,a)):ig(e,3,function(e,t,r){var n=Yl(15);return og(n,e,t),n.write_shift(8,r,"f"),n}(r,n,a)));case"b":case"e":return void ig(e,5,function(e,t,r,n){var a=Yl(9);return og(a,e,t),Gd(r,n||"b",a),a}(r,n,t.v,t.t));case"s":case"str":return void ig(e,4,function(e,t,r){var n=Yl(8+2*r.length);return og(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(r,n,(t.v||"").slice(0,255)))}ig(e,1,og(null,r,n))}function cg(e,t){var r=t||{};for(var n=$l(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(0==a&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ig(n,4==r.biff?1033:3==r.biff?521:9,bu(0,16,r)),function(e,t,r,n){var a,s=Array.isArray(t),i=dc(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=cc(i)}for(var c=i.s.r;c<=i.e.r;++c){o=nc(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(l[d]=sc(d)),a=l[d]+o;var u=s?(t[c]||[])[d]:t[a];u&&lg(e,u,c,d)}}}(n,e.Sheets[e.SheetNames[a]],0,r),ig(n,10),n.end()}function dg(e,t,r){ig(e,49,function(e,t){var r=e.name||"Arial",n=t&&5==t.biff,a=Yl(n?15+r.length:16+2*r.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function ug(e,t){if(t){var r=0;t.forEach(function(t,n){++r<=256&&t&&ig(e,125,function(e,t){var r=Yl(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}(xm(n,t),n))})}}function hg(e,t,r,n,a){var s=16+vm(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)ig(e,6,em(t,r,n,0,s));else switch(t.t){case"d":case"n":ig(e,515,function(e,t,r,n){var a=Yl(14);return ou(e,t,n,a),Uc(r,a),a}(r,n,"d"==t.t?Li(Ui(t.v)):t.v,s));break;case"b":case"e":ig(e,517,function(e,t,r,n,a,s){var i=Yl(8);return ou(e,t,n,i),Gd(r,s,i),i}(r,n,t.v,s,0,t.t));break;case"s":case"str":if(a.bookSST)ig(e,253,function(e,t,r,n){var a=Yl(10);return ou(e,t,n,a),a.write_shift(4,r),a}(r,n,gm(a.Strings,t.v,a.revStrings),s));else ig(e,516,function(e,t,r,n,a){var s=!a||8==a.biff,i=Yl(+s+8+(1+s)*r.length);return ou(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}(r,n,(t.v||"").slice(0,255),s,a));break;default:ig(e,513,ou(r,n,s))}else ig(e,513,ou(r,n,s))}function fg(e,t,r){var n,a=$l(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=8==t.biff,u="",h=[],f=dc(i["!ref"]||"A1"),m=d?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}ig(a,2057,bu(0,16,t)),ig(a,13,Wd(1)),ig(a,12,Wd(100)),ig(a,15,qd(!0)),ig(a,17,qd(!1)),ig(a,16,Uc(.001)),ig(a,95,qd(!0)),ig(a,42,qd(!1)),ig(a,43,qd(!1)),ig(a,130,Wd(1)),ig(a,128,function(e){var t=Yl(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),ig(a,131,qd(!1)),ig(a,132,qd(!1)),d&&ug(a,i["!cols"]),ig(a,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,n=Yl(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(f,t)),d&&(i["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){u=nc(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=sc(g)),n=h[g]+u;var x=c?(i[p]||[])[g]:i[n];x&&(hg(a,x,p,g,t),d&&x.l&&i["!links"].push([n,x.l]))}}var b=l.CodeName||l.name||s;return d&&ig(a,574,function(e){var t=Yl(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ig(a,229,function(e){var t=Yl(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)uu(e[r],t);return t}(i["!merges"])),d&&function(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ig(e,440,Ou(n)),n[1].Tooltip&&ig(e,2048,Fu(n))}delete t["!links"]}(a,i),ig(a,442,Zd(b)),d&&function(e,t){var r=Yl(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ig(e,2151,r),(r=Yl(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uu(dc(t["!ref"]||"A1"),r),r.write_shift(4,4),ig(e,2152,r)}(a,i),ig(a,10),a.end()}function mg(e,t,r){var n=$l(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=8==r.biff,l=5==r.biff;(ig(n,2057,bu(0,5,r)),"xla"==r.bookType&&ig(n,135),ig(n,225,o?Wd(1200):null),ig(n,193,function(e,t){t||(t=Yl(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),l&&ig(n,191),l&&ig(n,192),ig(n,226),ig(n,92,function(e,t){var r=!t||8==t.biff,n=Yl(r?112:54);for(n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}(0,r)),ig(n,66,Wd(o?1200:1252)),o&&ig(n,353,Wd(0)),o&&ig(n,448),ig(n,317,function(e){for(var t=Yl(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&ig(n,211),o&&e.vbaraw)&&ig(n,442,Zd(i.CodeName||"ThisWorkbook"));ig(n,156,Wd(17)),ig(n,25,qd(!1)),ig(n,18,qd(!1)),ig(n,19,Wd(0)),o&&ig(n,431,qd(!1)),o&&ig(n,444,Wd(0)),ig(n,61,function(){var e=Yl(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),ig(n,64,qd(!1)),ig(n,141,Wd(0)),ig(n,34,qd("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&So(e.Workbook.WBProps.date1904)?"true":"false"}(e))),ig(n,14,qd(!0)),o&&ig(n,439,qd(!1)),ig(n,218,Wd(0)),dg(n,0,r),function(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)null!=t[a]&&ig(e,1054,wu(a,t[a],r))})}(n,e.SSF,r),function(e,t){for(var r=0;r<16;++r)ig(e,224,ku({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){ig(e,224,ku(r,0,t))})}(n,r),o&&ig(n,352,qd(!1));var c=n.end(),d=$l();o&&ig(d,140,function(e){return e||(e=Yl(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),o&&r.Strings&&function(e,t,r,n){var a=n||(r||[]).length||0;if(a<=8224)return ig(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for((d=e.next(4)).write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=Yl(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],n=0;n<e.length;++n)r[n]=Xd(e[n]);var a=Ss([t].concat(r));return a.parts=[t.length].concat(r.map(function(e){return e.length})),a}(r.Strings)),ig(d,10);var u=d.end(),h=$l(),f=0,m=0;for(m=0;m<e.SheetNames.length;++m)f+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var p=c.length+f+u.length;for(m=0;m<e.SheetNames.length;++m){ig(h,133,vu({pos:p,hs:(s[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},r)),p+=t[m].length}var g=h.end();if(f!=g.length)throw new Error("BS8 "+f+" != "+g.length);var x=[];return c.length&&x.push(c),g.length&&x.push(g),u.length&&x.push(u),Ss(x)}function pg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(n&&n["!ref"])lc(n["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=qi(Ds)),e&&e.SSF&&(bi(),xi(e.SSF),r.revssf=Ti(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,lx(r),r.cellXfs=[],vm(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=fg(a,r,e);return n.unshift(mg(e,n,r)),Ss(n)}(e,t);case 4:case 3:case 2:return cg(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function gg(e,t){var r=t||{};var n=r.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Ki(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var p=l[i].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var b=x[o].trim();if(b.match(/<t[dh]/i)){for(var v=b,y=0;"<"==v.charAt(0)&&(y=v.indexOf(">"))>-1;)v=v.slice(y+1);for(var w=0;w<m.length;++w){var N=m[w];N.s.c==d&&N.s.r<c&&c<=N.e.r&&(d=N.e.c+1,w=-1)}var j=fo(b.slice(0,b.indexOf(">")));h=j.colspan?+j.colspan:1,((u=+j.rowspan)>1||h>1)&&m.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+h-1}});var k=j.t||j["data-t"]||"";if(v.length)if(v=Oo(v),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>d&&(f.s.c=d),f.e.c<d&&(f.e.c=d),v.length){var S={t:"s",v:v};r.raw||!v.trim().length||"s"==k||("TRUE"===v?S={t:"b",v:!0}:"FALSE"===v?S={t:"b",v:!1}:isNaN(Wi(v))?isNaN(Gi(v).getDate())||(S={t:"d",v:Ui(v)},r.cellDates||(S={t:"n",v:Li(S.v)}),S.z=r.dateNF||Ds[14]):S={t:"n",v:Wi(v)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=S):n[oc({r:c,c:d})]=S,d+=h}else d+=h;else d+=h}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0}}return n["!ref"]=cc(f),m.length&&(n["!merges"]=m),n}function xg(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var d=oc({r:r,c:i}),u=n.dense?(e[r]||[])[i]:e[d],h=u&&null!=u.v&&(u.h||jo(u.w||(hc(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(n.id||"sjs")+"-"+d,s.push(zo("td",h,f))}}return"<tr>"+s.join("")+"</tr>"}var bg='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vg="</body></html>";function yg(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function wg(e,t){var r=t||{},n=null!=r.header?r.header:bg,a=null!=r.footer?r.footer:vg,s=[n],i=lc(e["!ref"]);r.dense=Array.isArray(e),s.push(yg(0,0,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(xg(e,i,o,r));return s.push("</table>"+a),s.join("")}function Ng(e,t,r){var n=r||{};var a=0,s=0;if(null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var i="string"==typeof n.origin?ic(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=lc(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==a&&(c.e.r=a=d.e.r+1)}var u=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var y=o[m];if(kg(y)){if(n.display)continue;f[p]={hidden:!0}}var w=y.children;for(g=x=0;g<w.length;++g){var N=w[g];if(!n.display||!kg(N)){var j=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Oo(N.innerHTML),k=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<u.length;++h){var S=u[h];S.s.c==x+s&&S.s.r<p+a&&p+a<=S.e.r&&(x=S.e.c+1-s,h=-1)}v=+N.getAttribute("colspan")||1,((b=+N.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+a,c:x+s},e:{r:p+a+(b||1)-1,c:x+s+(v||1)-1}});var A={t:"s",v:j},C=N.getAttribute("data-t")||N.getAttribute("t")||"";null!=j&&(0==j.length?A.t=C||"z":n.raw||0==j.trim().length||"s"==C||("TRUE"===j?A={t:"b",v:!0}:"FALSE"===j?A={t:"b",v:!1}:isNaN(Wi(j))?isNaN(Gi(j).getDate())||(A={t:"d",v:Ui(j)},n.cellDates||(A={t:"n",v:Li(A.v)}),A.z=n.dateNF||Ds[14]):A={t:"n",v:Wi(j)})),void 0===A.z&&null!=k&&(A.z=k);var _="",T=N.getElementsByTagName("A");if(T&&T.length)for(var E=0;E<T.length&&(!T[E].hasAttribute("href")||"#"==(_=T[E].getAttribute("href")).charAt(0));++E);_&&"#"!=_.charAt(0)&&(A.l={Target:_}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][x+s]=A):e[oc({c:x+s,r:p+a})]=A,c.e.c<x+s&&(c.e.c=x+s),x+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=cc(c),p>=l&&(e["!fullref"]=cc((c.e.r=o.length-m+p-1+a,c))),e}function jg(e,t){return Ng((t||{}).dense?[]:{},e,t)}function kg(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Sg(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[xo(t.replace(/<[^>]*>/g,""))]}var Ag={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Cg(e,t){var r=t||{};var n,a,s,i,o,l,c=Ho(e),d=[],u={name:""},h="",f=0,m={},p=[],g=r.dense?[]:{},x={value:""},b="",v=0,y=[],w=-1,N=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},A=[],C={},_=[],T=1,E=1,L=[],P={Names:[]},O={},F=["",""],I=[],R={},D="",M=0,B=!1,U=!1,z=0;for(Wo.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=Wo.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(j.e.c>=j.s.c&&j.e.r>=j.s.r?g["!ref"]=cc(j):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(g["!fullref"]=g["!ref"],j.e.r=r.sheetRows-1,g["!ref"]=cc(j)),A.length&&(g["!merges"]=A),_.length&&(g["!rows"]=_),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),p.push(s.name),m[s.name]=g,U=!1):"/"!==o[0].charAt(o[0].length-2)&&(s=fo(o[0],!1),w=N=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,g=r.dense?[]:{},A=[],_=[],U=!0);break;case"table-row-group":"/"===o[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===o[1]){w+=T,T=1;break}if((i=fo(o[0],!1))["\u884c\u53f7"]?w=i["\u884c\u53f7"]-1:-1==w&&(w=0),(T=+i["number-rows-repeated"]||1)<10)for(z=0;z<T;++z)k>0&&(_[w+z]={level:k});N=-1;break;case"covered-table-cell":"/"!==o[1]&&++N,r.sheetStubs&&(r.dense?(g[w]||(g[w]=[]),g[w][N]={t:"z"}):g[oc({r:w,c:N})]={t:"z"}),b="",y=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++N,x=fo(o[0],!1),E=parseInt(x["number-columns-repeated"]||"1",10),l={t:"z",v:null},x.formula&&0!=r.cellFormula&&(l.f=cm(xo(x.formula))),"string"==(x["\u6570\u636e\u7c7b\u578b"]||x["value-type"])&&(l.t="s",l.v=xo(x["string-value"]||""),r.dense?(g[w]||(g[w]=[]),g[w][N]=l):g[oc({r:w,c:N})]=l),N+=E-1;else if("/"!==o[1]){b="",v=0,y=[],E=1;var q=T?w+T-1:w;if(++N>j.e.c&&(j.e.c=N),N<j.s.c&&(j.s.c=N),w<j.s.r&&(j.s.r=w),q>j.e.r&&(j.e.r=q),I=[],R={},l={t:(x=fo(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=xo(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(C={s:{r:w,c:N},e:{r:w+(parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},l.F=cc(C),L.push([C,l.F])),x.formula)l.f=cm(x.formula);else for(z=0;z<L.length;++z)w>=L[z][0].s.r&&w<=L[z][0].e.r&&N>=L[z][0].s.c&&N<=L[z][0].e.c&&(l.F=L[z][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(C={s:{r:w,c:N},e:{r:w+(parseInt(x["number-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-columns-spanned"],10)||0)-1}},A.push(C)),x["number-columns-repeated"]&&(E=parseInt(x["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=So(x["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(x.value);break;case"date":l.t="d",l.v=Ui(x["date-value"]),r.cellDates||(l.t="n",l.v=Li(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=Ri(x["time-value"])/86400,r.cellDates&&(l.t="d",l.v=Ii(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(x["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=x["string-value"]&&(b=xo(x["string-value"]),y=[])}}else{if(B=!1,"s"===l.t&&(l.v=b||"",y.length&&(l.R=y),B=0==v),O.Target&&(l.l=O),I.length>0&&(l.c=I,I=[]),b&&!1!==r.cellText&&(l.w=b),B&&(l.t="z",delete l.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var H=0;H<T;++H){if(E=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[w+H]||(g[w+H]=[]),g[w+H][N]=0==H?l:qi(l);--E>0;)g[w+H][N+E]=qi(l);else for(g[oc({r:w+H,c:N})]=l;--E>0;)g[oc({r:w+H,c:N+E})]=qi(l);j.e.c<=N&&(j.e.c=N)}N+=(E=parseInt(x["number-columns-repeated"]||"1",10))-1,E=0,l={},b="",y=[]}O={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((n=d.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((n=d.pop())[0]!==o[3])throw"Bad state: "+n;R.t=b,y.length&&(R.R=y),R.a=D,I.push(R)}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);D="",M=0,b="",v=0,y=[];break;case"creator":"/"===o[1]?D=c.slice(M,o.index):M=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((n=d.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);b="",v=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(S[u.name]=h,(n=d.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&(h="",u=fo(o[0],!1),d.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":a=fo(o[0],!1),h+=Ag[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(f,o.index)}else f=o.index+o[0].length;break;case"named-range":F=um((a=fo(o[0],!1))["cell-range-address"]);var W={Name:a.name,Ref:F[0]+"!"+F[1]};U&&(W.Sheet=p.length),P.Names.push(W);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==o[1]||x&&x["string-value"])fo(o[0],!1),v=o.index+o[0].length;else{var V=Sg(c.slice(v,o.index));b=(b.length>0?b+"\n":"")+V[0]}break;case"database-range":if("/"===o[1])break;try{m[(F=um(fo(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:F[1]}}catch(K_){}break;case"a":if("/"!==o[1]){if(!(O=fo(o[0],!1)).href)break;O.Target=xo(O.href),delete O.href,"#"==O.Target.charAt(0)&&O.Target.indexOf(".")>-1?(F=um(O.Target.slice(1)),O.Target="#"+F[0]+"!"+F[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(o)}}var G={Sheets:m,SheetNames:p,Workbook:P};return r.bookSheets&&delete G.Sheets,G}function _g(e,t){t=t||{},$i(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,a=Ho(e);r=Wo.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=fo(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Qi(e,"META-INF/manifest.xml"),t);var r=Zi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Cg(Eo(r),t);return $i(e,"meta.xml")&&(n.Props=hd(Qi(e,"meta.xml"))),n}function Tg(e,t){return Cg(e,t)}var Eg=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Uo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return io+t}}(),Lg=function(){var e=function(e){return yo(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r=function(r,n,a){var s=[];s.push('      <table:table table:name="'+yo(n.SheetNames[a])+'" table:style-name="ta1">\n');var i=0,o=0,l=lc(r["!ref"]||"A1"),c=r["!merges"]||[],d=0,u=Array.isArray(r);if(r["!cols"])for(o=0;o<=l.e.c;++o)s.push("        <table:table-column"+(r["!cols"][o]?' table:style-name="co'+r["!cols"][o].ods+'"':"")+"></table:table-column>\n");var h="",f=r["!rows"]||[];for(i=0;i<l.s.r;++i)h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",s.push("        <table:table-row"+h+"></table:table-row>\n");for(;i<=l.e.r;++i){for(h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",s.push("        <table:table-row"+h+">\n"),o=0;o<l.s.c;++o)s.push(t);for(;o<=l.e.c;++o){var m=!1,p={},g="";for(d=0;d!=c.length;++d)if(!(c[d].s.c>o)&&!(c[d].s.r>i)&&!(c[d].e.c<o)&&!(c[d].e.r<i)){c[d].s.c==o&&c[d].s.r==i||(m=!0),p["table:number-columns-spanned"]=c[d].e.c-c[d].s.c+1,p["table:number-rows-spanned"]=c[d].e.r-c[d].s.r+1;break}if(m)s.push("          <table:covered-table-cell/>\n");else{var x=oc({r:i,c:o}),b=u?(r[i]||[])[o]:r[x];if(b&&b.f&&(p["table:formula"]=yo(dm(b.f)),b.F&&b.F.slice(0,x.length)==x)){var v=lc(b.F);p["table:number-matrix-columns-spanned"]=v.e.c-v.s.c+1,p["table:number-matrix-rows-spanned"]=v.e.r-v.s.r+1}if(b){switch(b.t){case"b":g=b.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=b.v?"true":"false";break;case"n":g=b.w||String(b.v||0),p["office:value-type"]="float",p["office:value"]=b.v||0;break;case"s":case"str":g=null==b.v?"":b.v,p["office:value-type"]="string";break;case"d":g=b.w||Ui(b.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Ui(b.v).toISOString(),p["table:style-name"]="ce1";break;default:s.push(t);continue}var y=e(g);if(b.l&&b.l.Target){var w=b.l.Target;"#"==(w="#"==w.charAt(0)?"#"+hm(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),y=zo("text:a",y,{"xlink:href":w.replace(/&/g,"&amp;")})}s.push("          "+zo("table:table-cell",zo("text:p",y,{}),p)+"\n")}else s.push(t)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")};return function(e,t){var n=[io],a=Uo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=Uo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(n.push("<office:document"+a+s+">\n"),n.push(cd().replace(/office:document-meta/g,"office:meta"))):n.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var a=t["!cols"][n];if(null==a.width&&null==a.wpx&&null==a.wch)continue;Ch(a),a.ods=r;var s=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++r}});var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=n;var a=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++n}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(n,e),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)n.push(r(e.Sheets[e.SheetNames[i]],e,i));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function Pg(e,t){if("fods"==t.bookType)return Lg(e,t);var r=no(),n="",a=[],s=[];return ro(r,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),ro(r,n="content.xml",Lg(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),ro(r,n="styles.xml",Eg(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),ro(r,n="meta.xml",io+cd()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),ro(r,n="manifest.rdf",function(e){var t=[io];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(od(e[r][0],e[r][1])),t.push(ld("",e[r][0]));return t.push(od("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),a.push([n,"application/rdf+xml"]),ro(r,n="META-INF/manifest.xml",function(e){var t=[io];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),r}function Og(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fg(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Eo(js(e))}function Ig(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):ws(Lo(e))}function Rg(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(e,n),n+=e.length}),r}function Dg(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Mg(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function Bg(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ug(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function zg(e){for(var t=[],r=[0];r[0]<e.length;){var n,a=r[0],s=Mg(e,r),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:o=4,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Mg(e,r),n=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var c={data:n,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function qg(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(Bg(8*r+e.type)),2==e.type&&t.push(Bg(e.data.length)),t.push(e.data))})}),Rg(t)}function Hg(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Wg(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Mg(e,n),s=zg(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ug(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=zg(t.data),a=Ug(r[3][0].data);i.messages.push({meta:r,data:e.slice(n[0],n[0]+a)}),n[0]+=a}),(null==(t=s[3])?void 0:t[0])&&(i.merge=Ug(s[3][0].data)>>>0>0),r.push(i)}return r}function Vg(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:Bg(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:Bg(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(e){n.push(e.data),e.meta[3]=[{type:0,data:Bg(e.data.length)}],r[2].push({data:qg(e.meta),type:2})});var a=qg(r);t.push(Bg(a.length)),t.push(a),n.forEach(function(e){return t.push(e)})}),Rg(t)}function Gg(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Mg(t,r),a=[];r[0]<t.length;){var s=3&t[r[0]];if(0!=s){var i=0,o=0;if(1==s?(o=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(o=1+(t[r[0]++]>>2),2==s?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Rg(a)],0==i)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(a.push(a[0].slice(-i)),o-=i;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-i,-i+o))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}a.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var d=Rg(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Kg(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Gg(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Rg(t)}function Yg(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Bg(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=255&i,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Rg(t)}function Xg(e,t,r){var n,a=Og(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,i),i+=16),2&s&&(d=a.getFloat64(i,!0),i+=8),4&s&&(u.setTime(u.getTime()+1e3*a.getFloat64(i,!0)),i+=8),8&s&&(l=a.getUint32(i,!0),i+=4),16&s&&(o=a.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:d>0};break;case 7:n={t:"n",v:d/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));n={t:"s",v:r[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return n}function $g(e,t){var r=new Uint8Array(32),n=Og(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var n=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=255&a;e[t+15]|=r>=0?0:128}(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Jg(e,t){var r=new Uint8Array(32),n=Og(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Qg(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var a,s=Og(e),i=s.getUint32(4,!0),o=(n>1?12:8)+4*Dg(i&(n>1?3470:398)),l=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&i&&(l=s.getUint32(o,!0),o+=4),o+=4*Dg(i&(n>1?12288:4096)),16&i&&(c=s.getUint32(o,!0),o+=4),32&i&&(d=s.getFloat64(o,!0),o+=8),64&i&&(u.setTime(u.getTime()+1e3*s.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:d};break;case 3:a={t:"s",v:t[c]};break;case 5:a={t:"d",v:u};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(l>-1)a={t:"s",v:r[l]};else if(c>-1)a={t:"s",v:t[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,r,e[0]);case 5:return Xg(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Zg(e){return Mg(zg(e)[1][0].data)}function ex(e,t){var r=zg(t.data),n=Ug(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(t){var r=zg(t.data),a=Ug(r[1][0].data)>>>0;switch(n){case 1:s[a]=Fg(r[3][0].data);break;case 8:var i=zg(e[Zg(r[9][0].data)][0].data),o=e[Zg(i[1][0].data)][0],l=Ug(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=zg(o.data);s[a]=c[3].map(function(e){return Fg(e.data)}).join("")}}),s}function tx(e,t){var r,n=zg(t.data),a=(null==(r=null==n?void 0:n[7])?void 0:r[0])?Ug(n[7][0].data)>>>0>0?1:0:-1,s=Hg(n[5],function(e){return function(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,b=zg(e),v=Ug(b[1][0].data)>>>0,y=Ug(b[2][0].data)>>>0,w=(null==(n=null==(r=b[8])?void 0:r[0])?void 0:n.data)&&Ug(b[8][0].data)>0||!1;if((null==(s=null==(a=b[7])?void 0:a[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=b[7])?void 0:i[0])?void 0:o.data,x=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(u=null==(d=b[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=b[4])?void 0:h[0])?void 0:f.data,x=null==(p=null==(m=b[3])?void 0:m[0])?void 0:p.data}for(var N=w?4:1,j=Og(g),k=[],S=0;S<g.length/2;++S){var A=j.getUint16(2*S,!0);A<65535&&k.push([S,A])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var C=[];for(S=0;S<k.length-1;++S)C[k[S][0]]=x.subarray(k[S][1]*N,k[S+1][1]*N);return k.length>=1&&(C[k[k.length-1][0]]=x.subarray(k[k.length-1][1]*N)),{R:v,cells:C}}(e,a)});return{nrows:Ug(n[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r}),e},[])}}function rx(e,t){var r={"!ref":"A1"},n=e[Zg(zg(t.data)[2][0].data)],a=Ug(n[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,r){var n,a=zg(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ug(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ug(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=cc(s);var i=zg(a[4][0].data),o=ex(e,e[Zg(i[4][0].data)][0]),l=(null==(n=i[17])?void 0:n[0])?ex(e,e[Zg(i[17][0].data)][0]):[],c=zg(i[3][0].data),d=0;c[1].forEach(function(t){var n=zg(t.data),a=e[Zg(n[2][0].data)][0],s=Ug(a.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=tx(0,a);i.data.forEach(function(e,t){e.forEach(function(e,n){var a=oc({r:d+t,c:n}),s=Qg(e,o,l);s&&(r[a]=s)})}),d+=i.nrows})}(e,n[0],r),r}function nx(e,t){var r={SheetNames:[],Sheets:{}};if(Hg(zg(t.data)[1],Zg).forEach(function(t){e[t].forEach(function(t){if(2==Ug(t.meta[1][0].data)){var n=function(e,t){var r,n=zg(t.data),a={name:(null==(r=n[1])?void 0:r[0])?Fg(n[1][0].data):"",sheets:[]};return Hg(n[2],Zg).forEach(function(t){e[t].forEach(function(t){6e3==Ug(t.meta[1][0].data)&&a.sheets.push(rx(e,t))})}),a}(e,t);n.sheets.forEach(function(e,t){Fx(r,e,0==t?n.name:n.name+"_"+t,!0)})}})}),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function ax(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=Kg(e.content)}catch(K_){return console.log("?? "+e.content.length+" "+(K_.message||K_))}try{r=Wg(t)}catch(K_){return console.log("## "+(K_.message||K_))}r.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var o=(null==(a=null==(n=null==(r=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:a[0].data)&&1==Ug(s[1][0].meta[1][0].data)&&s[1][0];if(o||i.forEach(function(e){s[e].forEach(function(e){if(1==Ug(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return nx(s,o)}function sx(e,t,r){var n,a,s,i;if(!(null==(n=e[6])?void 0:n[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(s=e[8])?void 0:s[0])?void 0:i.data)&&Ug(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=Og(e[7][0].data),c=0,d=[],u=Og(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(l.setUint16(2*m,c,!0),u.setUint16(2*m,h,!0),typeof t[m]){case"string":p=$g({t:"s",v:t[m]},r),g=Jg({t:"s",v:t[m]},r);break;case"number":p=$g({t:"n",v:t[m]},r),g=Jg({t:"n",v:t[m]},r);break;case"boolean":p=$g({t:"b",v:t[m]},r),g=Jg({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(p),c+=p.length,f.push(g),h+=g.length,++o}else l.setUint16(2*m,65535,!0),u.setUint16(2*m,65535);for(e[2][0].data=Bg(o);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),u.setUint16(2*m,65535,!0);return e[6][0].data=Rg(d),e[3][0].data=Rg(f),o}function ix(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function ox(e){ix([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function lx(e){ix([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function cx(e,t,r,n,a,s,i,o,l,c,d,u){try{s[n]=ad(Zi(e,r,!0),t);var h,f=Qi(e,t);switch(o){case"sheet":h=vp(f,t,a,l,s[n],c,d,u);break;case"chart":if(!(h=yp(f,t,a,l,s[n],c))||!h["!drawel"])break;var m=so(h["!drawel"].Target,t),p=nd(m),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(Zi(e,m,!0),ad(Zi(e,p,!0),m)),x=so(g,m),b=nd(x);h=tp(Zi(e,x,!0),0,0,ad(Zi(e,b,!0),x),0,h);break;case"macro":y=t,s[n],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[n]);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var v=[];s&&s[n]&&Ai(s[n]).forEach(function(r){var a="";if(s[n][r].Type==rd.CMNT){a=so(s[n][r].Target,t);var i=jp(Qi(e,a,!0),a,l);if(!i||!i.length)return;ff(h,i,!1)}s[n][r].Type==rd.TCMNT&&(a=so(s[n][r].Target,t),v=v.concat(function(e,t){var r=[],n=!1,a={},s=0;return e.replace(co,function(i,o){var l=fo(i);switch(mo(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}(Qi(e,a,!0),l)))}),v&&v.length&&ff(h,v,!0,l.people||[])}catch(K_){if(l.WTF)throw K_}var y}function dx(e){return"/"==e.charAt(0)?e.slice(1):e}function ux(e,t){if(bi(),ox(t=t||{}),$i(e,"META-INF/manifest.xml"))return _g(e,t);if($i(e,"objectdata.xml"))return _g(e,t);if($i(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return ax(e);var r=Ni.utils.cfb_new();return to(e).forEach(function(t){ro(r,t,eo(e,t))}),ax(r)}if(!$i(e,"[Content_Types].xml")){if($i(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if($i(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,a,s=to(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(co)||[]).forEach(function(e){var n=fo(e);switch(n[0].replace(uo,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[Zc[n.ContentType]]&&t[Zc[n.ContentType]].push(n.PartName)}}),t.xmlns!==Yo)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(Zi(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&Qi(e,a="xl/workbook.xml",!0)&&i.workbooks.push(a),0===i.workbooks.length){if(!Qi(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(a),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(fm=[],i.sst)try{fm=Np(Qi(e,dx(i.sst)),i.sst,t)}catch(K_){if(t.WTF)throw K_}t.cellStyles&&i.themes.length&&(l=function(e,t,r){return nf(e,r)}(Zi(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=wp(Qi(e,dx(i.style)),i.style,l,t))}i.links.map(function(r){try{ad(Zi(e,nd(dx(r))),r);return Sp(Qi(e,dx(r)),0,r,t)}catch(K_){}});var d=bp(Qi(e,dx(i.workbooks[0])),i.workbooks[0],t),u={},h="";i.coreprops.length&&((h=Qi(e,dx(i.coreprops[0]),!0))&&(u=hd(h)),0!==i.extprops.length&&(h=Qi(e,dx(i.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=Eo(e),pd.forEach(function(r){var a=(e.match(Po(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=xo(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(n[r[1]]=s[1])}}),n.HeadingPairs&&n.TitlesOfParts&&xd(n.HeadingPairs,n.TitlesOfParts,t,r)}(h,u,t));var f={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(h=Zi(e,dx(i.custprops[0]),!0))&&(f=function(e,t){var r={},n="",a=e.match(vd);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=fo(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":n=xo(o.name);break;case"</property>":n=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=xo(d);break;case"bool":r[n]=So(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Ui(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}(h,t));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?n=d.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(n=u.SheetNames),t.bookProps&&(m.Props=u,m.Custprops=f),t.bookSheets&&"undefined"!==typeof n&&(m.SheetNames=n),t.bookSheets?m.SheetNames:t.bookProps))return m;n={};var p={};t.bookDeps&&i.calcchain&&(p=kp(Qi(e,dx(i.calcchain)),i.calcchain));var g,x,b=0,v={},y=d.Sheets;u.Worksheets=y.length,u.SheetNames=[];for(var w=0;w!=y.length;++w)u.SheetNames[w]=y[w].name;var N=o?"bin":"xml",j=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,j+1)+"_rels/"+i.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");$i(e,k)||(k="xl/_rels/workbook."+N+".rels");var S=ad(Zi(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Ap(Qi(e,dx(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(co,function(e){var a=fo(e);switch(mo(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e}),r}(Qi(e,dx(i.people[0])),t)),S&&(S=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,rd.WS.indexOf(r)>-1?"sheet":rd.CS&&r==rd.CS?"chart":rd.DS&&r==rd.DS?"dialog":rd.MS&&r==rd.MS?"macro":r&&r.length?r:"sheet")];var r})}catch(K_){return null}return e&&0!==e.length?e:null}(S,d.Sheets));var A=Qi(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=u.Worksheets;++b){var C="sheet";if(S&&S[b]?(g="xl/"+S[b][1].replace(/[\/]?xl\//,""),$i(e,g)||(g=S[b][1]),$i(e,g)||(g=k.replace(/_rels\/.*$/,"")+S[b][1]),C=S[b][2]):g=(g="xl/worksheets/sheet"+(b+1-A)+"."+N).replace(/sheet0\./,"sheet."),x=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(u.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var _=!1,T=0;T!=t.sheets.length;++T)"number"==typeof t.sheets[T]&&t.sheets[T]==b&&(_=1),"string"==typeof t.sheets[T]&&t.sheets[T].toLowerCase()==u.SheetNames[b].toLowerCase()&&(_=1);if(!_)continue e}}cx(e,g,x,u.SheetNames[b],b,v,n,C,t,d,l,c)}return m={Directory:i,Workbook:d,Props:u,Custprops:f,Deps:p,Sheets:n,SheetNames:u.SheetNames,Strings:fm,Styles:c,Themes:l,SSF:qi(Ds)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Qi(e,dx(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(m.vbaraw=Qi(e,"xl/vbaProject.bin",!0))),m}function hx(e,t){var r=t||{},n="Workbook",a=Ni.find(e,n);try{if(n="/!DataSpaces/Version",!(a=Ni.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=ih(e,4),t.U=ih(e,4),t.W=ih(e,4)}(a.content),n="/!DataSpaces/DataSpaceMap",!(a=Ni.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(oh(e));return t}(a.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Ni.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Ni.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);lh(a.content)}catch(K_){}if(n="/EncryptionInfo",!(a=Ni.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=ih(e);switch(t.Minor){case 2:return[t.Minor,uh(e)];case 3:return[t.Minor,hh()];case 4:return[t.Minor,fh(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(n="/EncryptedPackage",!(a=Ni.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,r.password||"",r);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function fx(e,t){return"ods"==t.bookType?Pg(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=lc(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(cc(n)));var s=Ax(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var o={},l=[],c=Ni.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&Wg(Kg(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:r,type:Ug(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var d=l.filter(function(e){return e>1}).map(function(e){return[e,Bg(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Wg(Kg(t.content)).forEach(function(e){e.messages.forEach(function(t){d.forEach(function(t){e.messages.some(function(e){return 11006!=Ug(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var u,h=Ni.find(c,o[1].location),f=Wg(Kg(h.content)),m=0;m<f.length;++m){var p=f[m];1==p.id&&(u=p)}var g=Zg(zg(u.messages[0].data)[1][0].data);for(f=Wg(Kg((h=Ni.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Zg(zg(u.messages[0].data)[2][0].data),f=Wg(Kg((h=Ni.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Zg(zg(u.messages[0].data)[2][0].data),f=Wg(Kg((h=Ni.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);var x=zg(u.messages[0].data);x[6][0].data=Bg(n.e.r+1),x[7][0].data=Bg(n.e.c+1);for(var b=Zg(x[46][0].data),v=Ni.find(c,o[b].location),y=Wg(Kg(v.content)),w=0;w<y.length&&y[w].id!=b;++w);if(y[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var N=zg(y[w].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var j=0;j<=n.e.c;++j){var k=[];k[1]=k[2]=[{type:0,data:Bg(j+420690)}],N[1].push({type:2,data:qg(k)}),N[2].push({type:0,data:Bg(j)}),N[3].push({type:0,data:Bg(j)})}N[4]=[],N[5]=[],N[6]=[];for(var S=0;S<=n.e.r;++S)(k=[])[1]=k[2]=[{type:0,data:Bg(S+726270)}],N[4].push({type:2,data:qg(k)}),N[5].push({type:0,data:Bg(S)}),N[6].push({type:0,data:Bg(S)});y[w].messages[0].data=qg(N),v.content=Yg(Vg(y)),v.size=v.content.length,delete x[46];var A=zg(x[4][0].data);A[7][0].data=Bg(n.e.r+1);var C=Zg(zg(A[1][0].data)[2][0].data);if((y=Wg(Kg((v=Ni.find(c,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var _=zg(y[0].messages[0].data);for(S=0;S<s.length;++S){var T=zg(_[2][0].data);T[1][0].data=Bg(S),T[4][0].data=Bg(s[S].length),_[2][S]={type:_[2][0].type,data:qg(T)}}y[0].messages[0].data=qg(_),v.content=Yg(Vg(y)),v.size=v.content.length;var E=Zg(A[2][0].data);if((y=Wg(Kg((v=Ni.find(c,o[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";for(_=zg(y[0].messages[0].data),j=0;j<=n.e.c;++j)(T=zg(_[2][0].data))[1][0].data=Bg(j),T[4][0].data=Bg(n.e.r+1),_[2][j]={type:_[2][0].type,data:qg(T)};y[0].messages[0].data=qg(_),v.content=Yg(Vg(y)),v.size=v.content.length;var L=Zg(A[4][0].data);!function(){for(var e,t=Ni.find(c,o[L].location),r=Wg(Kg(t.content)),n=0;n<r.length;++n){var a=r[n];a.id==L&&(e=a)}var s=zg(e.messages[0].data);s[3]=[];var l=[];i.forEach(function(e,t){l[1]=[{type:0,data:Bg(t)}],l[2]=[{type:0,data:Bg(1)}],l[3]=[{type:2,data:Ig(e)}],s[3].push({type:2,data:qg(l)})}),e.messages[0].data=qg(s);var d=Yg(Vg(r));t.content=d,t.size=t.content.length}();var P=zg(A[3][0].data),O=P[1][0];delete P[2];var F=zg(O.data),I=Zg(F[2][0].data);!function(){for(var e,t=Ni.find(c,o[I].location),r=Wg(Kg(t.content)),a=0;a<r.length;++a){var l=r[a];l.id==I&&(e=l)}var d=zg(e.messages[0].data);delete d[6],delete P[7];var u=new Uint8Array(d[5][0].data);d[5]=[];for(var h=0,f=0;f<=n.e.r;++f){var m=zg(u);h+=sx(m,s[f],i),m[1][0].data=Bg(f),d[5].push({data:qg(m),type:2})}d[1]=[{type:0,data:Bg(n.e.c+1)}],d[2]=[{type:0,data:Bg(n.e.r+1)}],d[3]=[{type:0,data:Bg(h)}],d[4]=[{type:0,data:Bg(n.e.r+1)}],e.messages[0].data=qg(d);var p=Yg(Vg(r));t.content=p,t.size=t.content.length}(),O.data=qg(F),A[3][0].data=qg(P),x[4][0].data=qg(A),u.messages[0].data=qg(x);var R=Yg(Vg(f));return h.content=R,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){uf=1024,e&&!e.SSF&&(e.SSF=qi(Ds));e&&e.SSF&&(bi(),xi(e.SSF),t.revssf=Ti(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",n=bf.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};lx(t=t||{});var s=no(),i="",o=0;t.cellXfs=[],vm(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(i="docProps/core.xml",ro(s,i,md(e.Props,t)),a.coreprops.push(i),id(t.rels,2,i,rd.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,ro(s,i,bd(e.Props)),a.extprops.push(i),id(t.rels,3,i,rd.EXT_PROPS),e.Custprops!==e.Props&&Ai(e.Custprops||{}).length>0&&(ro(s,i="docProps/custom.xml",yd(e.Custprops)),a.custprops.push(i),id(t.rels,4,i,rd.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},u=e.Sheets[e.SheetNames[o-1]];(u||{})["!type"];if(ro(s,i="xl/worksheets/sheet"+o+"."+r,Cp(o-1,i,t,e,d)),a.sheets.push(i),id(t.wbrels,-1,"worksheets/sheet"+o+"."+r,rd.WS[0]),u){var h=u["!comments"],f=!1,m="";h&&h.length>0&&(ro(s,m="xl/comments"+o+"."+r,_p(h,m,t)),a.comments.push(m),id(d,-1,"../comments"+o+"."+r,rd.CMNT),f=!0),u["!legacy"]&&f&&ro(s,"xl/drawings/vmlDrawing"+o+".vml",hf(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&ro(s,nd(i),sd(d))}null!=t.Strings&&t.Strings.length>0&&(ro(s,i="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?ah:rh)(e,r)}(t.Strings,i,t)),a.strs.push(i),id(t.wbrels,-1,"sharedStrings."+r,rd.SST));i="xl/workbook."+r,ro(s,i,function(e,t,r){return(".bin"===t.slice(-4)?xp:fp)(e,r)}(e,i,t)),a.workbooks.push(i),id(t.rels,1,i,rd.WB),i="xl/theme/theme1.xml",ro(s,i,af(e.Themes,t)),a.themes.push(i),id(t.wbrels,-1,"theme/theme1.xml",rd.THEME),i="xl/styles."+r,ro(s,i,function(e,t,r){return(".bin"===t.slice(-4)?Yh:Ih)(e,r)}(e,i,t)),a.styles.push(i),id(t.wbrels,-1,"styles."+r,rd.STY),e.vbaraw&&n&&(ro(s,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),id(t.wbrels,-1,"vbaProject.bin",rd.VBA));return i="xl/metadata."+r,ro(s,i,function(e){return(".bin"===e.slice(-4)?cf:df)()}(i)),a.metadata.push(i),id(t.wbrels,-1,"metadata."+r,rd.XLMETA),ro(s,"[Content_Types].xml",td(a,t)),ro(s,"_rels/.rels",sd(t.rels)),ro(s,"xl/_rels/workbook."+r+".rels",sd(t.wbrels)),delete t.revssf,delete t.ssf,s}(e,t):mx(e,t)}function mx(e,t){uf=1024,e&&!e.SSF&&(e.SSF=qi(Ds)),e&&e.SSF&&(bi(),xi(e.SSF),t.revssf=Ti(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=bf.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};lx(t=t||{});var s=no(),i="",o=0;if(t.cellXfs=[],vm(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),ro(s,i="docProps/core.xml",md(e.Props,t)),a.coreprops.push(i),id(t.rels,2,i,rd.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,ro(s,i,bd(e.Props)),a.extprops.push(i),id(t.rels,3,i,rd.EXT_PROPS),e.Custprops!==e.Props&&Ai(e.Custprops||{}).length>0&&(ro(s,i="docProps/custom.xml",yd(e.Custprops)),a.custprops.push(i),id(t.rels,4,i,rd.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(ro(s,i="xl/worksheets/sheet"+o+"."+r,Bm(o-1,t,e,u)),a.sheets.push(i),id(t.wbrels,-1,"worksheets/sheet"+o+"."+r,rd.WS[0]),h){var f=h["!comments"],m=!1,p="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(ro(s,p="xl/threadedComments/threadedComment"+o+"."+r,pf(f,d,t)),a.threadedcomments.push(p),id(u,-1,"../threadedComments/threadedComment"+o+"."+r,rd.TCMNT)),ro(s,p="xl/comments"+o+"."+r,mf(f)),a.comments.push(p),id(u,-1,"../comments"+o+"."+r,rd.CMNT),m=!0}h["!legacy"]&&m&&ro(s,"xl/drawings/vmlDrawing"+o+".vml",hf(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&ro(s,nd(i),sd(u))}return null!=t.Strings&&t.Strings.length>0&&(ro(s,i="xl/sharedStrings."+r,rh(t.Strings,t)),a.strs.push(i),id(t.wbrels,-1,"sharedStrings."+r,rd.SST)),ro(s,i="xl/workbook."+r,fp(e)),a.workbooks.push(i),id(t.rels,1,i,rd.WB),ro(s,i="xl/theme/theme1.xml",af(e.Themes,t)),a.themes.push(i),id(t.wbrels,-1,"theme/theme1.xml",rd.THEME),ro(s,i="xl/styles."+r,Ih(e,t)),a.styles.push(i),id(t.wbrels,-1,"styles."+r,rd.STY),e.vbaraw&&n&&(ro(s,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),id(t.wbrels,-1,"vbaProject.bin",rd.VBA)),ro(s,i="xl/metadata."+r,df()),a.metadata.push(i),id(t.wbrels,-1,"metadata."+r,rd.XLMETA),d.length>1&&(ro(s,i="xl/persons/person.xml",function(e){var t=[io,zo("personList",null,{xmlns:$o,"xmlns:x":al[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,r){t.push(zo("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),a.people.push(i),id(t.wbrels,-1,"persons/person.xml",rd.PEOPLE)),ro(s,"[Content_Types].xml",td(a,t)),ro(s,"_rels/.rels",sd(t.rels)),ro(s,"xl/_rels/workbook.xml.rels",sd(t.wbrels)),delete t.revssf,delete t.ssf,s}function px(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=gs(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gx(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Up(e.slice(r),t);default:break e}return Wu.to_workbook(e,t)}function xx(e,t,r,n){return n?(r.type="string",Wu.to_workbook(e,r)):Wu.to_workbook(t,r)}function bx(e,t){os();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return bx(new Uint8Array(e),((r=qi(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,a=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),mm={},r.dateNF&&(mm.dateNF=r.dateNF),r.type||(r.type=xs&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=xs?"buffer":"binary",a=function(e){if("undefined"!==typeof ji)return ji.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(K_){if(!K_.message||!K_.message.match(/onstruct/))throw K_}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||xs||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Lo(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(r=qi(r)).type="array",bx(ks(a),r)}switch((n=px(a,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return Ni.find(e,"EncryptedPackage")?hx(e,t):rg(e,t)}(Ni.read(a,r),r);break;case 9:if(n[1]<=8)return rg(a,r);break;case 60:return Up(a,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=zu.to_workbook(e,r);return r.WTF=n,a}catch(K_){if(r.WTF=n,!K_.message.match(/SYLK bad record ID/)&&n)throw K_;return Wu.to_workbook(e,t)}}(a,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return qu.to_workbook(a,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=xs&&Buffer.isBuffer(e)?"buffer":"base64"),ux(ao(r,n),n)}(a,r):xx(e,a,r,s);case 239:return 60===n[3]?Up(a,r):xx(e,a,r,s);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=gs(r)),r=ds.utils.decode(1200,r.slice(2),"str"),t.type="binary",gx(r,t)}(a,r);if(0===n[1]&&2===n[2]&&0===n[3])return Vu.to_workbook(a,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return Vu.to_workbook(a,r);if(0===n[2]&&(8===n[3]||9===n[3]))return Vu.to_workbook(a,r)}break;case 3:case 131:case 139:case 140:return Uu.to_workbook(a,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return bh.to_workbook(a,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=px(e,t);switch(t.type){case"base64":r=gs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=zi(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=Eo(r)),t.type="binary",gx(r,t)}(a,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return Bu.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Uu.to_workbook(a,r):xx(e,a,r,s)}function vx(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Si(t.file,Ni.write(e,{type:xs?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ni.write(e,t)}function yx(e,t){var r={},n=xs?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ni.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(Ns(a))}return t.password&&"undefined"!==typeof encrypt_agile?vx(encrypt_agile(a,t.password),t):"file"===t.type?Si(t.file,a):"string"==t.type?Eo(a):a}function wx(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return ps(Lo(n));case"binary":return Lo(n);case"string":return e;case"file":return Si(t.file,n,"utf8");case"buffer":return xs?bs(n,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(n):wx(n,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Nx(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?ps(r):"string"==t.type?Eo(r):r;case"file":return Si(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function jx(e,t){os(),up(e);var r=qi(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=jx(e,r);return r.type="array",Ns(n)}var a=0;if(r.sheet&&(a="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wx(Gp(e,r),r);case"slk":case"sylk":return wx(zu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return wx(wg(e.Sheets[e.SheetNames[a]],r),r);case"txt":return function(e,t){switch(t.type){case"base64":return ps(e);case"binary":case"string":return e;case"file":return Si(t.file,e,"binary");case"buffer":return xs?bs(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(Ex(e.Sheets[e.SheetNames[a]],r),r);case"csv":return wx(Tx(e.Sheets[e.SheetNames[a]],r),r,"\ufeff");case"dif":return wx(qu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Nx(Uu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return wx(Wu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return wx(bh.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return wx(Hu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return wx(Pg(e,r),r);case"wk1":return Nx(Vu.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Nx(Vu.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Nx(pg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return vx(ng(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r=qi(t||{});return yx(fx(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kx(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function Sx(e,t,r,n,a,s,i,o){var l=nc(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(K_){h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var m=i?e[r][f]:e[n[f]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[f]){if(null==p)if("e"==m.t&&null===p)h[s[f]]=null;else if(void 0!==c)h[s[f]]=c;else{if(!d||null!==p)continue;h[s[f]]=null}else h[s[f]]=d&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?p:hc(m,p,o);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=s[f]&&(h[s[f]]=c)}}return{row:h,isempty:u}}function Ax(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof d){case"string":l=dc(d);break;case"number":(l=dc(e["!ref"])).s.r=d;break;default:l=d}n>0&&(a=0);var u=nc(l.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),x=l.s.r,b=0,v={};g&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(h[b]=sc(b),r=g?e[x][b]:e[h[b]+u],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=h[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=hc(r,null,c),p=v[i]||0){do{o=i+"_"+p++}while(v[o]);v[i]=p,v[o]=1}else v[i]=1;s[b]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(w[x]||{}).hidden){var N=Sx(e,l,x,h,n,s,g,c);(!1===N.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(f[m++]=N.row)}return f.length=m,f}var Cx=/"/g;function _x(e,t,r,n,a,s,i,o){for(var l=!0,c=[],d="",u=nc(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var f=o.dense?(e[r]||[])[h]:e[n[h]+u];if(null==f)d="";else if(null!=f.v){l=!1,d=""+(o.rawNumbers&&"n"==f.t?f.v:hc(f,null,o));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||34===p||o.forceQuotes){d='"'+d.replace(Cx,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(Cx,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}function Tx(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=dc(e["!ref"]),s=void 0!==n.FS?n.FS:",",i=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),d="",u=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(u[m]=sc(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||null!=(d=_x(e,a,g,u,i,l,s,n))&&(n.strip&&(d=d.replace(c,"")),(d||!1!==n.blankrows)&&r.push((p++?o:"")+d));return delete n.dense,r.join("")}function Ex(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=Tx(e,t);if("undefined"==typeof ds||"string"==t.type)return r;var n=ds.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function Lx(e,t,r){var n,a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?ic(a.origin):a.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var u=dc(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+s)}else-1==o&&(o=0,d.e.r=t.length-1+s);var h=a.header||[],f=0;t.forEach(function(e,t){Ai(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],d="z",u="",m=oc({c:l+f,r:o+t+s});n=Px(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",a.cellDates||(d="n",c=Li(c)),u=a.dateNF||Ds[14]):null===c&&a.nullError&&(d="e",c=0),n?(n.t=d,n.v=c,delete n.w,delete n.R,u&&(n.z=u)):i[m]=n={t:d,v:c},u&&(n.z=u)):i[m]=c})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=nc(o);if(s)for(f=0;f<h.length;++f)i[sc(f+l)+m]={t:"s",v:h[f]};return i["!ref"]=cc(d),i}function Px(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=ic(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Px(e,oc("number"!=typeof t?t:{r:t,c:r||0}))}function Ox(){return{SheetNames:[],Sheets:{}}}function Fx(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=i+a);++a);}if(dp(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Ix(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Rx={encode_col:sc,encode_row:nc,encode_cell:oc,encode_range:cc,decode_col:ac,decode_row:rc,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ic,decode_range:lc,format_cell:hc,sheet_add_aoa:mc,sheet_add_json:Lx,sheet_add_dom:Ng,aoa_to_sheet:pc,json_to_sheet:function(e,t){return Lx(null,e,t)},table_to_sheet:jg,table_to_book:function(e,t){return fc(jg(e,t),t)},sheet_to_csv:Tx,sheet_to_txt:Ex,sheet_to_json:Ax,sheet_to_html:wg,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,s=dc(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=sc(a);for(var d=s.s.r;d<=s.e.r;++d)for(i=nc(d),a=s.s.c;a<=s.e.c;++a)if(r=o[a]+i,n="",void 0!==(t=c?(e[d]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:Ax,sheet_get_cell:Px,book_new:Ox,book_append_sheet:Fx,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Ix,cell_set_internal_link:function(e,t,r){return Ix(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:dc(t),s="string"==typeof t?t:cc(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Px(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};es.version;function Dx(e){let{onClose:t,initialItem:r,isEditMode:n}=e;const[a,i]=(0,s.useState)({rfq_number:"",customer:"",valid_date:"",file:null}),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)({}),[u,h]=(0,s.useState)("");(0,s.useEffect)(()=>{n&&r&&(i({rfq_number:r.rfq_number||"",customer:r.customer||"",valid_date:r.valid_date||"",file:r.file||null}),r.file&&h(r.file.name||""))},[n,r]);const f=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),c[t]&&d(e=>We(We({},e),{},{[t]:""}))};return(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,xn.jsx)(Ea,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h2",{className:"text-xl font-bold text-white",children:n?"Edit RFQ":"Add New RFQ"}),(0,xn.jsx)("p",{className:"text-blue-100 text-sm",children:n?"Update RFQ information":"Add a new Request for Quotation"})]})]}),(0,xn.jsx)("button",{onClick:()=>t(),className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors duration-200",children:(0,xn.jsx)(Ln,{className:"w-5 h-5"})})]}),(0,xn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!(()=>{const e={};return a.rfq_number.trim()||(e.rfq_number="RFQ Number is required"),a.customer.trim()||(e.customer="Customer is required"),a.valid_date.trim()||(e.valid_date="Valid Date is required"),n||a.file||(e.file="File is required"),d(e),0===Object.keys(e).length})())return;const r=a.file,s=bx(await r.arrayBuffer(),{type:"array"}),i=s.SheetNames[0],o=s.Sheets[i],c=Rx.sheet_to_json(o);try{const e={rfq_number:a.rfq_number,customer:a.customer,valid_date:a.valid_date,data_obj:JSON.stringify(c),added_by:"Kavindu Tharaka"};console.log("Saving item:",e);const r=await(async e=>{try{return(await mn.post("".concat(pn,"/rfq"),e)).data}catch(t){throw new Error("Failed to create rfq")}})(e);console.log(r),r&&window.location.reload(),t(e)}catch(u){console.error("Error saving item:",u),d({submit:"Failed to save. Please try again."})}finally{l(!1)}},className:"p-6 space-y-5",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["RFQ Number ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",name:"rfq_number",value:a.rfq_number,onChange:f,placeholder:"Enter RFQ Number...",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(c.rfq_number?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),c.rfq_number&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.rfq_number})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Customer ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("div",{className:"relative",children:(0,xn.jsx)("input",{type:"text",name:"customer",value:a.customer,onChange:f,placeholder:"Enter customer",className:"w-full pl-4 pr-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(c.customer?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")})}),c.customer&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.customer})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Valid Date ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"date",name:"valid_date",value:a.valid_date,onChange:f,className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(c.valid_date?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),c.valid_date&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.valid_date})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["File (.xlsx, .xls, .csv) ",!n&&(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsxs)("div",{className:"space-y-2",children:[!a.file&&(0,xn.jsx)("div",{children:(0,xn.jsxs)("label",{htmlFor:"file-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed rounded-lg cursor-pointer transition-all duration-200 ".concat(c.file?"border-red-300 bg-red-50 hover:bg-red-100":"border-slate-300 bg-slate-50 hover:bg-slate-100"),children:[(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center pt-2 pb-2",children:[(0,xn.jsx)(Za,{className:"w-6 h-6 mb-1 ".concat(c.file?"text-red-400":"text-slate-400")}),(0,xn.jsxs)("p",{className:"text-xs ".concat(c.file?"text-red-600":"text-slate-500"),children:[(0,xn.jsx)("span",{className:"font-medium",children:"Click to upload"})," or drag and drop"]}),(0,xn.jsx)("p",{className:"text-xs text-slate-400 mt-0.5",children:"Excel (.xlsx, .xls) or CSV files only"})]}),(0,xn.jsx)("input",{id:"file-upload",type:"file",accept:".xlsx,.xls,.csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv",onChange:e=>{const t=e.target.files[0];if(t){const r=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],n=[".xls",".xlsx",".csv"],a=t.name.toLowerCase().substring(t.name.lastIndexOf("."));if(!r.includes(t.type)&&!n.includes(a))return d(e=>We(We({},e),{},{file:"Please select a valid spreadsheet file (.xlsx, .xls, or .csv)"})),void(e.target.value=null);if(t.size>20971520)return d(e=>We(We({},e),{},{file:"File size must be less than 20MB"})),void(e.target.value=null);i(e=>We(We({},e),{},{file:t})),h(t.name),c.file&&d(e=>We(We({},e),{},{file:""}))}},className:"hidden"})]})}),u&&(0,xn.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,xn.jsx)(Za,{className:"w-4 h-4 text-blue-600"}),(0,xn.jsx)("span",{className:"text-sm text-blue-700 font-medium truncate",children:u})]})]}),c.file&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:c.file})]}),c.submit&&(0,xn.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:c.submit}),(0,xn.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[(0,xn.jsx)("button",{type:"button",onClick:()=>t(),disabled:o,className:"px-5 py-2.5 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",disabled:o,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)($a,{className:"w-4 h-4 animate-spin"}),(0,xn.jsx)("span",{children:"Saving..."})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(qa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:n?"Update":"Save"})]})})]})]})]})}function Mx(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),o=()=>{t(!1),i(null)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(Qa,{modalOpen:()=>{i(null),t(!0)},onEdit:e=>{i(e),t(!0)}})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:o}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full max-w-2xl animate-fadeIn",children:(0,xn.jsx)(Dx,{onClose:e=>{o()},initialItem:a,isEditMode:!!a})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Bx=En("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ux=En("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),zx=En("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),qx=En("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),Hx=En("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Wx=async e=>{try{return(await mn.patch("".concat(pn,"/Lead/bulk/approve"),{leadIds:e})).data}catch(t){throw new Error("Failed to bulk approve leads")}},Vx=async(e,t)=>{try{return(await mn.patch("".concat(pn,"/Lead/bulk/reject"),{leadIds:e,reason:t})).data}catch(r){throw new Error("Failed to bulk reject leads")}};function Gx(e){let{onClose:t,createGLeadId:r}=e;const[n,a]=(0,s.useState)({leadName:"",status:"",company:"",title:"",email:"",phone:"",lastInteraction:"",activeSequences:"",notes:"",priority:"medium",score:50}),[i,o]=(0,s.useState)({}),[l,c]=(0,s.useState)(!1),d=e=>{const{name:t,value:r}=e.target;a(e=>We(We({},e),{},{[t]:r})),i[t]&&o(e=>We(We({},e),{},{[t]:""}))};return(0,xn.jsxs)("div",{className:"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-orange-50 to-amber-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(Bx,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:"Add New Lead"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Capture and track potential customers"})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,xn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return n.leadName.trim()||(e.leadName="Lead name is required"),n.status||(e.status="Status is required"),n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(e.email="Please enter a valid email address"):e.email="Email is required",n.phone&&!/^[\+]?[1-9][\d]{0,15}$/.test(n.phone.replace(/[\s\-\(\)]/g,""))&&(e.phone="Please enter a valid phone number"),n.company.trim()||(e.company="Company name is required"),o(e),0===Object.keys(e).length})()){c(!0);try{const e={name:n.leadName,status:n.status,company:n.company,title:n.title,email:n.email,phone:n.phone,lastInteraction:n.lastInteraction,activeSequences:n.activeSequences,notes:n.notes,priority:n.priority,score:parseInt(n.score),approvalStatus:"pending",assignedTo:null};console.log("ll",e);const a=await(async e=>{try{return(await mn.post("".concat(pn,"/Lead"),e)).data}catch(t){throw new Error("Failed to create lead")}})(e);console.log("Created lead response",a),console.log("Going to lead save",a.id,r),alert("Lead created successfully!"),t(),window.location.reload()}catch(a){alert("Failed to create lead. Please try again.")}finally{c(!1)}}},className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Bx,{className:"w-4 h-4 text-orange-600"}),"Lead Name *"]}),(0,xn.jsx)("input",{type:"text",name:"leadName",value:n.leadName,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.leadName?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter lead's full name"}),i.leadName&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.leadName]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ux,{className:"w-4 h-4 text-orange-600"}),"Status *"]}),(0,xn.jsxs)("select",{name:"status",value:n.status,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.status?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,xn.jsx)("option",{value:"",children:"Select status"}),[{value:"new",label:"New Lead",color:"bg-orange-500"},{value:"contacted",label:"Contacted",color:"bg-blue-500"},{value:"qualified",label:"Qualified",color:"bg-green-500"},{value:"unqualified",label:"Unqualified",color:"bg-red-500"},{value:"nurturing",label:"Nurturing",color:"bg-purple-500"},{value:"converted",label:"Converted",color:"bg-emerald-500"},{value:"lost",label:"Lost",color:"bg-gray-500"}].map(e=>(0,xn.jsx)("option",{value:e.value,children:e.label},e.value))]}),i.status&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.status]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(zx,{className:"w-4 h-4 text-orange-600"}),"Company *"]}),(0,xn.jsx)("input",{type:"text",name:"company",value:n.company,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.company?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter company name"}),i.company&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.company]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-orange-600"}),"Title"]}),(0,xn.jsx)("input",{type:"text",name:"title",value:n.title,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",placeholder:"Enter lead's title"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Hn,{className:"w-4 h-4 text-orange-600"}),"Email *"]}),(0,xn.jsx)("input",{type:"email",name:"email",value:n.email,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.email?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter lead's email"}),i.email&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.email]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(qx,{className:"w-4 h-4 text-orange-600"}),"Phone"]}),(0,xn.jsx)("input",{type:"text",name:"phone",value:n.phone,onChange:d,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all ".concat(i.phone?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter lead's phone number"}),i.phone&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),i.phone]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-orange-600"}),"Last Interaction"]}),(0,xn.jsx)("input",{type:"date",name:"lastInteraction",value:n.lastInteraction,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Hx,{className:"w-4 h-4 text-orange-600"}),"Active Sequences"]}),(0,xn.jsxs)("select",{name:"activeSequences",value:n.activeSequences,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",children:[(0,xn.jsx)("option",{value:"",children:"Select sequence"}),[{value:"welcome",label:"Welcome Series"},{value:"demo",label:"Product Demo Flow"},{value:"nurture",label:"Lead Nurturing"},{value:"trial",label:"Free Trial Follow-up"},{value:"webinar",label:"Webinar Series"},{value:"consultation",label:"Consultation Booking"},{value:"custom",label:"Custom Sequence"}].map(e=>(0,xn.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Hx,{className:"w-4 h-4 text-orange-600"}),"Priority"]}),(0,xn.jsxs)("select",{name:"priority",value:n.priority,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",children:[(0,xn.jsx)("option",{value:"low",children:"Low"}),(0,xn.jsx)("option",{value:"medium",children:"Medium"}),(0,xn.jsx)("option",{value:"high",children:"High"})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-orange-600"}),"Notes"]}),(0,xn.jsx)("textarea",{name:"notes",value:n.notes,onChange:d,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all hover:border-slate-400",placeholder:"Add any additional notes about the lead"})]}),(0,xn.jsxs)("div",{className:"flex gap-4 pt-4 border-t border-slate-200",children:[(0,xn.jsxs)("button",{type:"submit",disabled:l,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ".concat(l?"bg-slate-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-700 text-white"),children:[(0,xn.jsx)(Bx,{className:"w-5 h-5"}),l?"Creating...":"Create Lead"]}),(0,xn.jsx)("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300 transition-all duration-200",children:"Cancel"})]})]})})]})}const Kx=En("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),Yx=En("message-circle-heart",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}],["path",{d:"M7.828 13.07A3 3 0 0 1 12 8.764a3 3 0 0 1 5.004 2.224 3 3 0 0 1-.832 2.083l-3.447 3.62a1 1 0 0 1-1.45-.001z",key:"hoo97p"}]]),Xx=En("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),$x=En("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Jx=En("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Qx=En("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Zx=En("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),eb=En("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),tb=En("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),rb=async()=>(await mn.get("".concat(pn,"/Employee/emp"))).data;function nb(e){let{onOpen:t,loading:r=!1,delay:n=0,reviewMode:a=!1,selectedLeads:i=[],setSelectedLeads:o=()=>{},filterStatus:l=null,setFilterStatus:c=()=>{},setLeadCounts:d=()=>{}}=e;const[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),[x,b]=(0,s.useState)([]),[v,y]=(0,s.useState)(!1),[w,N]=(0,s.useState)(null),[j,k]=(0,s.useState)(!0),S=Array(15).fill().map((e,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t%7],status:"inactive"})),A=async()=>{try{y(!0),N(null);const e=await(async()=>{try{return await mn.get("".concat(pn,"/Lead/facebook-leads")),(await mn.get("".concat(pn,"/Lead"))).data}catch(e){return console.warn("Facebook import failed, falling back to existing leads:",e.message),(await mn.get("".concat(pn,"/Lead"))).data}})();if(console.log("Fetched leads:",e),!Array.isArray(e))return console.warn("fetchLeads returned non-array response:",e),void b([]);const t=e.map(e=>{const t={new:{label:"New Lead",color:"bg-orange-500"},contacted:{label:"Contacted",color:"bg-blue-500"},qualified:{label:"Qualified",color:"bg-green-500"},converted:{label:"Converted",color:"bg-purple-500"},lost:{label:"Lost",color:"bg-red-500"}}[(e.status||"new").toLowerCase()]||{label:"New Lead",color:"bg-orange-500"};const r=(n=e.assignedTo)&&u.find(e=>e.id===n)||null;var n;return{id:e.id||Date.now()+Math.random(),name:e.name||"Unknown Lead",status:(e.status||"new").toLowerCase(),statusLabel:t.label,statusColor:t.color,company:e.company||"Unknown Company",title:e.title||"Unknown Title",email:e.email||"",phone:e.phone||"",lastInteraction:e.lastInteraction||"",activeSequences:e.activeSequences||"",approvalStatus:e.approvalStatus||"pending",assignedTo:r,priority:e.priority||"medium",source:e.source||"Unknown",score:e.score||0,notes:e.notes||"",timeline:e.timeline||S,createdAt:e.createdAt,updatedAt:e.updatedAt}});b(t)}catch(e){console.error("Error fetching leads:",e),N("Failed to load leads. Please try again."),b([])}finally{y(!1)}};(0,s.useEffect)(()=>{(async()=>{try{m(!0),g(null);const e=await rb();console.log("Fetched employees:",e);const t=e.map(e=>({id:e.sysID,name:"".concat(e.fname," ").concat(e.lname).trim(),email:e.email,role:e.position,avatar:"".concat(e.fname[0]).concat(e.lname[0]).toUpperCase(),department:e.department,status:e.status}));h(t)}catch(e){console.error("Error fetching employees:",e),g("Failed to load employees. Please try again.")}finally{m(!1)}})()},[]),(0,s.useEffect)(()=>{u.length>0&&A()},[u]),(0,s.useEffect)(()=>{const e=x.filter(e=>"pending"===e.approvalStatus).length,t=x.filter(e=>"pending"===e.approvalStatus&&!e.assignedTo).length;d({pending:e,quickReview:t})},[x,d]);const[C,_]=(0,s.useState)(null),[T,E]=(0,s.useState)(null),[L,P]=(0,s.useState)(null),[O,F]=(0,s.useState)(null),[I,R]=(0,s.useState)(""),D=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=e=>{D.current&&!D.current.contains(e.target)&&(P(null),F(null))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const M=x.filter(e=>"pending"===l?"pending"===e.approvalStatus:"quick-review"!==l||"pending"===e.approvalStatus&&!e.assignedTo),B=async e=>{try{var t;await(async e=>{try{return(await mn.patch("".concat(pn,"/Lead/").concat(e,"/approve"))).data}catch(t){throw new Error("Failed to approve lead with id ".concat(e))}})(e),b(t=>t.map(t=>t.id===e?We(We({},t),{},{approvalStatus:"approved"}):t));const r=(null===(t=x.find(t=>t.id===e))||void 0===t?void 0:t.name)||"Lead";alert("".concat(r," approved successfully!"))}catch(r){console.error("Error approving lead:",r),alert("Failed to approve lead. Please try again.")}},U=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{var r;await(async(e,t)=>{try{return(await mn.patch("".concat(pn,"/Lead/").concat(e,"/reject"),{reason:t})).data}catch(r){throw new Error("Failed to reject lead with id ".concat(e))}})(e,t),b(r=>r.map(r=>r.id===e?We(We({},r),{},{approvalStatus:"rejected",rejectionReason:t}):r));const n=(null===(r=x.find(t=>t.id===e))||void 0===r?void 0:r.name)||"Lead";alert("".concat(n," rejected successfully!"))}catch(n){console.error("Error rejecting lead:",n),alert("Failed to reject lead. Please try again.")}},z=async(e,t)=>{try{1===e.length?await(async(e,t)=>{try{return(await mn.patch("".concat(pn,"/Lead/").concat(e,"/assign"),{employeeId:t})).data}catch(r){throw new Error("Failed to assign lead with id ".concat(e))}})(e[0],t.id):await(async(e,t)=>{try{return(await mn.patch("".concat(pn,"/Lead/bulk/assign"),{leadIds:e,employeeId:t})).data}catch(r){throw new Error("Failed to bulk assign leads")}})(e,t.id),b(r=>r.map(r=>e.includes(r.id)?We(We({},r),{},{assignedTo:t}):r));const r=e.length,n=1===r?"lead":"leads";alert("".concat(r," ").concat(n," assigned to ").concat(t.name," successfully!")),P(null),F(null),o([])}catch(r){console.error("Error assigning leads:",r),alert("Failed to assign leads. Please try again.")}},q=async(e,t)=>{try{const r=We(We({},x.find(t=>t.id===e)),t);await(async(e,t)=>{try{return(await mn.put("".concat(pn,"/Lead/").concat(e),t)).data}catch(r){throw new Error("Failed to update lead with id ".concat(e))}})(e,r),b(r=>r.map(r=>r.id===e?We(We({},r),t):r)),_(null),alert("Lead updated successfully!")}catch(r){console.error("Error updating lead:",r),alert("Failed to update lead. Please try again.")}},H=async(e,t)=>{if(window.confirm("Convert ".concat(t," to a contact? This will move them to your contacts board.")))try{await(async e=>{try{return(await mn.post("".concat(pn,"/Lead/").concat(e,"/convert"))).data}catch(t){throw new Error("Failed to convert lead with id ".concat(e," to contact"))}})(e),b(t=>t.filter(t=>t.id!==e)),alert("".concat(t," has been successfully converted to a contact!"))}catch(r){console.error("Error converting lead:",r),alert("Failed to convert lead. Please try again.")}},W=u.filter(e=>e.name.toLowerCase().includes(I.toLowerCase())||e.email.toLowerCase().includes(I.toLowerCase())),V=(x.filter(e=>"pending"===e.approvalStatus).length,x.filter(e=>"pending"===e.approvalStatus&&!e.assignedTo).length,()=>(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded w-24"}),(0,xn.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("div",{className:"min-w-full",children:[(0,xn.jsx)("div",{className:"grid grid-cols-12 gap-4 p-4 bg-slate-50 border-b border-slate-200",children:Array.from({length:12}).map((e,t)=>(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))}),Array.from({length:2}).map((e,t)=>(0,xn.jsx)("div",{className:"grid grid-cols-12 gap-4 p-4 border-b border-slate-100",children:Array.from({length:12}).map((e,t)=>(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))},t))]})})]})),G=e=>{let{status:t}=e;const r={pending:{icon:sa,color:"bg-amber-100 text-amber-800",label:"Pending"},approved:{icon:ia,color:"bg-green-100 text-green-800",label:"Approved"},rejected:{icon:xa,color:"bg-red-100 text-red-800",label:"Rejected"}},n=r[t]||r.pending,a=n.icon;return(0,xn.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(n.color),children:[(0,xn.jsx)(a,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:n.label})]})},K=e=>{let{priority:t}=e;const r={high:"bg-red-100 text-red-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-green-100 text-green-800"};return(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(r[t]||r.medium),children:[(0,xn.jsx)(ra,{className:"w-3 h-3"}),(t||"medium").charAt(0).toUpperCase()+(t||"medium").slice(1)]})},Y=e=>{let{status:t,color:r,label:n}=e;return(0,xn.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(r||"bg-orange-500"),children:[(()=>{switch(t){case"qualified":return(0,xn.jsx)(Qx,{className:"w-3 h-3"});case"contacted":return(0,xn.jsx)(Hn,{className:"w-3 h-3"});case"new":return(0,xn.jsx)(Bx,{className:"w-3 h-3"});case"converted":return(0,xn.jsx)(ia,{className:"w-3 h-3"});case"lost":return(0,xn.jsx)(xa,{className:"w-3 h-3"});default:return(0,xn.jsx)(sa,{className:"w-3 h-3"})}})(),(0,xn.jsx)("span",{children:n||"New Lead"})]})},X=e=>{let{timeline:t}=e;return(0,xn.jsx)("div",{className:"flex gap-1 justify-center items-center",children:(t||S).map((e,t)=>{let r="bg-slate-200";return"qualified"===e.status?r="bg-green-500":"contacted"===e.status?r="bg-blue-500":"new"===e.status?r="bg-orange-500":"pending"===e.status?r="bg-amber-500":"inactive"===e.status&&(r="bg-slate-300"),(0,xn.jsx)("div",{className:"h-6 w-2 rounded-sm ".concat(r," transition-all duration-200 hover:scale-110"),title:"".concat(e.day,": ").concat(e.status)},t)})})},$=e=>{let{leadId:t,currentAssignee:r}=e;return(0,xn.jsx)("div",{className:"absolute z-20 mt-2 w-64 bg-white border border-slate-200 rounded-lg shadow-lg",children:(0,xn.jsxs)("div",{className:"p-2",children:[(0,xn.jsxs)("div",{className:"relative mb-2",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search employees...",value:I,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),f?(0,xn.jsx)("div",{className:"text-center text-sm text-slate-500",children:"Loading employees..."}):p?(0,xn.jsx)("div",{className:"text-center text-sm text-red-500",children:p}):0===W.length?(0,xn.jsx)("div",{className:"text-center text-sm text-slate-500",children:"No employees found"}):(0,xn.jsx)("div",{className:"max-h-40 overflow-y-auto",children:W.map(e=>(0,xn.jsxs)("button",{onClick:()=>z([t],e),className:"w-full p-2 text-left flex items-center gap-2 hover:bg-slate-100 rounded transition-colors ".concat((null===r||void 0===r?void 0:r.id)===e.id?"bg-orange-50":""),children:[(0,xn.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:e.avatar}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-sm font-medium text-slate-900",children:e.name}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:e.email})]})]},e.id))})]})})},J=e=>{let{leadIds:t,onClose:r}=e;const[n,a]=(0,s.useState)(null),i=x.filter(e=>t.includes(e.id));return(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[(0,xn.jsxs)("h3",{className:"text-xl font-semibold text-slate-900",children:["Assign Leads (",t.length,")"]}),(0,xn.jsx)("button",{onClick:r,className:"p-1 hover:bg-slate-100 rounded",children:(0,xn.jsx)(xa,{className:"w-5 h-5 text-slate-400"})})]}),(0,xn.jsxs)("div",{className:"p-6",children:[(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-3",children:"Selected Leads:"}),(0,xn.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:i.map(e=>(0,xn.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,xn.jsx)(Bx,{className:"w-4 h-4 text-orange-600"}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,xn.jsxs)("div",{className:"text-sm text-slate-600",children:[e.company," \u2022 ",e.title]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(K,{priority:e.priority}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-700",children:e.score})]})]},e.id))})]}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-3",children:"Assign to Employee:"}),(0,xn.jsxs)("div",{className:"relative mb-3",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search employees...",value:I,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),f?(0,xn.jsx)("div",{className:"text-center text-sm text-slate-500",children:"Loading employees..."}):p?(0,xn.jsx)("div",{className:"text-center text-sm text-red-500",children:p}):0===W.length?(0,xn.jsx)("div",{className:"text-center text-sm text-slate-500",children:"No employees found"}):(0,xn.jsx)("div",{className:"grid gap-2 max-h-64 overflow-y-auto",children:W.map(e=>(0,xn.jsx)("button",{onClick:()=>a(e),className:"w-full p-3 text-left rounded-lg border-2 transition-all ".concat((null===n||void 0===n?void 0:n.id)===e.id?"border-orange-500 bg-orange-50":"border-slate-200 hover:border-slate-300 bg-white"),children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-orange-600 text-white rounded-full flex items-center justify-center text-sm font-medium",children:e.avatar}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,xn.jsx)("div",{className:"text-sm text-slate-600",children:e.role}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:e.email})]}),(null===n||void 0===n?void 0:n.id)===e.id&&(0,xn.jsx)(Zx,{className:"w-5 h-5 text-orange-600"})]})},e.id))})]}),(0,xn.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[(0,xn.jsxs)("button",{onClick:()=>{n?z(t,n):alert("Please select an employee to assign.")},className:"flex-1 flex items-center justify-center gap-2 bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed",disabled:!n,children:[(0,xn.jsx)($x,{className:"w-5 h-5"}),n?"Assign to ".concat(n.name):"Select an Employee"]}),(0,xn.jsx)("button",{onClick:r,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"Cancel"})]})]})]})})},Q=e=>{let{lead:t,onClose:r}=e;const[n,a]=(0,s.useState)({priority:t.priority||"medium",notes:t.notes||"",source:t.source||""});return x&&0!==x.length?(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-900",children:["Quick Edit: ",t.name]}),(0,xn.jsx)("button",{onClick:r,className:"p-1 hover:bg-slate-100 rounded",children:(0,xn.jsx)(xa,{className:"w-5 h-5 text-slate-400"})})]}),(0,xn.jsxs)("form",{onSubmit:e=>{e.preventDefault(),q(t.id,n)},className:"p-4 space-y-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Priority"}),(0,xn.jsxs)("select",{value:n.priority,onChange:e=>a(We(We({},n),{},{priority:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[(0,xn.jsx)("option",{value:"low",children:"Low"}),(0,xn.jsx)("option",{value:"medium",children:"Medium"}),(0,xn.jsx)("option",{value:"high",children:"High"})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source"}),(0,xn.jsx)("input",{type:"text",value:n.source,onChange:e=>a(We(We({},n),{},{source:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,xn.jsx)("textarea",{value:n.notes,onChange:e=>a(We(We({},n),{},{notes:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,xn.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,xn.jsx)("button",{type:"submit",className:"flex-1 bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700 transition-colors",children:"Save Changes"}),(0,xn.jsx)("button",{type:"button",onClick:r,className:"flex-1 bg-slate-200 text-slate-700 py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors",children:"Cancel"})]})]})]})}):null};if(r||f||v)return(0,xn.jsx)(V,{});if(p||w)return(0,xn.jsx)(xn.Fragment,{});const Z=M.length>0&&i.length===M.length&&M.every(e=>i.includes(e.id)),ee=i.length>0&&i.length<M.length;return(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300 animate-slideInLeft",style:{animationDelay:"".concat(n,"ms"),animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 gap-4",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,xn.jsx)("button",{onClick:()=>k(!j),className:"p-1 hover:bg-slate-100 rounded transition-colors group",children:j?(0,xn.jsx)(ua,{className:"w-4 h-4 text-slate-400 group-hover:text-slate-600"}):(0,xn.jsx)(eb,{className:"w-4 h-4 text-slate-400 group-hover:text-slate-600"})}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("h2",{className:"text-lg font-bold text-slate-800",children:["All Leads"," ",a&&(0,xn.jsx)("span",{className:"text-sm text-orange-600",children:"(Review Mode)"}),l&&(0,xn.jsxs)("span",{className:"text-sm text-blue-600",children:[" ","- ","pending"===l?"Pending":"Quick Review"]})]}),(0,xn.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:l?"Showing ".concat(M.length," filtered lead(s)"):"Manage all your leads in one place (".concat(x.length," total)")})]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[i.length>0&&(0,xn.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-orange-50 rounded-lg border border-orange-200",children:[(0,xn.jsxs)("span",{className:"text-sm text-orange-800 font-medium",children:[i.length," selected"]}),(0,xn.jsx)("button",{onClick:async()=>{if(0!==i.length)try{await Wx(i),b(e=>e.map(e=>i.includes(e.id)?We(We({},e),{},{approvalStatus:"approved"}):e)),alert("".concat(i.length," lead(s) approved successfully!")),o([])}catch(e){console.error("Error bulk approving leads:",e),alert("Failed to approve leads. Please try again.")}else alert("Please select leads to approve")},className:"p-1 hover:bg-green-100 rounded transition-colors",title:"Approve selected",children:(0,xn.jsx)(ia,{className:"w-4 h-4 text-green-600"})}),(0,xn.jsx)("button",{onClick:async()=>{if(0===i.length)return void alert("Please select leads to reject");const e=window.prompt("Enter rejection reason (optional):");if(null!==e)try{await Vx(i,e),b(t=>t.map(t=>i.includes(t.id)?We(We({},t),{},{approvalStatus:"rejected",rejectionReason:e}):t)),alert("".concat(i.length," lead(s) rejected successfully!")),o([])}catch(t){console.error("Error bulk rejecting leads:",t),alert("Failed to reject leads. Please try again.")}},className:"p-1 hover:bg-red-100 rounded transition-colors",title:"Reject selected",children:(0,xn.jsx)(xa,{className:"w-4 h-4 text-red-600"})}),(0,xn.jsx)("button",{onClick:()=>{0!==i.length?P([...i]):alert("Please select leads to assign")},className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Assign selected leads",children:(0,xn.jsx)($x,{className:"w-4 h-4 text-blue-600"})})]}),(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors",children:(0,xn.jsx)(Zn,{className:"w-4 h-4 text-slate-400"})})]})]}),0===M.length?(0,xn.jsxs)("div",{className:"text-center py-12 bg-white rounded-b-xl",children:[(0,xn.jsx)(Bx,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),(0,xn.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:l?"No Leads Match Filter":"No Leads Available"}),(0,xn.jsx)("p",{className:"text-slate-600 mb-6 text-lg",children:l?"Try adjusting your filter criteria.":"Start by adding leads to manage your prospects effectively."}),!l&&t&&(0,xn.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-orange-600 text-white rounded-lg font-medium hover:bg-orange-700 transition-colors shadow-md",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),"Add Your First Lead"]})]}):(0,xn.jsx)("div",{className:"overflow-x-auto",children:j&&(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-4 py-3 text-left bg-slate-50 sticky left-0 z-10 border-r border-slate-200",children:(0,xn.jsx)("input",{type:"checkbox",checked:Z,ref:e=>{e&&(e.indeterminate=ee)},onChange:e=>(e=>{const t=e?M.map(e=>e.id):[];o(t)})(e.target.checked),className:"w-4 h-4 text-orange-600 border-slate-300 rounded focus:ring-orange-500 focus:ring-2"})}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider bg-slate-50 sticky left-16 z-10 border-r border-slate-200 min-w-48",children:"Lead"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Status"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Approval"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Priority"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Score"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Assigned To"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Timeline"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Company"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Email"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Source"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-100",children:M.map(e=>(0,xn.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,xn.jsx)("td",{className:"px-4 py-4 bg-white sticky left-0 z-10 border-r border-slate-200 shadow-sm group-hover:bg-slate-50",children:(0,xn.jsx)("input",{type:"checkbox",checked:i.includes(e.id),onChange:t=>((e,t)=>{const r=t?[...i,e]:i.filter(t=>t!==e);o(r)})(e.id,t.target.checked),className:"w-4 h-4 text-orange-600 border-slate-300 rounded focus:ring-orange-500 focus:ring-2"})}),(0,xn.jsx)("td",{className:"px-4 py-4 bg-white sticky left-16 z-10 border-r border-slate-200 min-w-48 shadow-sm group-hover:bg-slate-50",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Bx,{className:"w-4 h-4 text-orange-600"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:e.title})]})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(Y,{status:e.status,color:e.statusColor,label:e.statusLabel})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(G,{status:e.approvalStatus})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(K,{priority:e.priority})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.score>=80?"bg-green-500":e.score>=60?"bg-yellow-500":"bg-red-500")}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.score})]})}),(0,xn.jsx)("td",{className:"px-4 py-4 relative",children:e.assignedTo?(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:e.assignedTo.avatar}),(0,xn.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,xn.jsx)("div",{className:"text-sm font-medium text-slate-900 truncate",children:e.assignedTo.name}),(0,xn.jsx)("div",{className:"text-xs text-slate-500 truncate",children:e.assignedTo.role})]}),(0,xn.jsx)("button",{onClick:()=>F(O===e.id?null:e.id),className:"p-1 hover:bg-slate-100 rounded transition-colors",children:(0,xn.jsx)(ua,{className:"w-3 h-3 text-slate-400"})})]}):(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsxs)("button",{onClick:()=>F(O===e.id?null:e.id),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm text-slate-600 transition-colors",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Assign"}),(0,xn.jsx)(ua,{className:"w-3 h-3"})]}),O===e.id&&(0,xn.jsx)($,{leadId:e.id,currentAssignee:e.assignedTo})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(X,{timeline:e.timeline})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)("div",{className:"flex items-center gap-1",children:a?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("button",{onClick:()=>E(e),className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Review details",children:(0,xn.jsx)(fa,{className:"w-4 h-4 text-blue-600"})}),(0,xn.jsx)("button",{onClick:()=>B(e.id),className:"p-1 hover:bg-green-100 rounded transition-colors",title:"Approve",children:(0,xn.jsx)(ia,{className:"w-4 h-4 text-green-600"})}),(0,xn.jsx)("button",{onClick:()=>U(e.id),className:"p-1 hover:bg-red-100 rounded transition-colors",title:"Reject",children:(0,xn.jsx)(xa,{className:"w-4 h-4 text-red-600"})})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("button",{onClick:()=>_(e),className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Quick edit",children:(0,xn.jsx)(tb,{className:"w-4 h-4 text-blue-600"})}),(0,xn.jsx)("button",{onClick:()=>H(e.id,e.name),className:"p-1 hover:bg-green-100 rounded transition-colors",title:"Convert to contact",children:(0,xn.jsx)(Ca,{className:"w-4 h-4 text-green-600"})}),(0,xn.jsx)("button",{className:"p-1 hover:bg-orange-100 rounded transition-colors",title:"Add note",children:(0,xn.jsx)(Xx,{className:"w-4 h-4 text-orange-600"})})]})})}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(zx,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.company})]})}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate max-w-32",children:e.email})]})}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,xn.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-slate-100 text-slate-700",children:e.source})})]},e.id))})]})})]}),L&&(0,xn.jsx)(J,{leadIds:L,onClose:()=>{P(null),o([])}}),C&&(0,xn.jsx)(Q,{lead:C,onClose:()=>_(null)}),T&&(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[(0,xn.jsxs)("h3",{className:"text-xl font-semibold text-slate-900",children:["Review Lead: ",T.name]}),(0,xn.jsx)("button",{onClick:()=>E(null),className:"p-1 hover:bg-slate-100 rounded",children:(0,xn.jsx)(xa,{className:"w-5 h-5 text-slate-400"})})]}),(0,xn.jsxs)("div",{className:"p-6 space-y-6",children:[(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Company"}),(0,xn.jsx)("p",{className:"text-slate-900",children:T.company})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Title"}),(0,xn.jsx)("p",{className:"text-slate-900",children:T.title})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),(0,xn.jsx)("p",{className:"text-slate-900",children:T.email})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone"}),(0,xn.jsx)("p",{className:"text-slate-900",children:T.phone})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source"}),(0,xn.jsx)("p",{className:"text-slate-900",children:T.source})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Score"}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(T.score>=80?"bg-green-500":T.score>=60?"bg-yellow-500":"bg-red-500")}),(0,xn.jsxs)("span",{className:"font-medium",children:[T.score,"/100"]})]})]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Priority:"}),(0,xn.jsx)(K,{priority:T.priority})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Status:"}),(0,xn.jsx)(Y,{status:T.status,color:T.statusColor,label:T.statusLabel})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Approval:"}),(0,xn.jsx)(G,{status:T.approvalStatus})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),(0,xn.jsx)("p",{className:"text-slate-900 bg-slate-50 p-3 rounded-lg",children:T.notes||"No notes available"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Recent Activity"}),(0,xn.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,xn.jsx)(X,{timeline:T.timeline}),(0,xn.jsx)("p",{className:"text-xs text-slate-600 mt-2 text-center",children:"Last 15 days of activity"})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Assignment"}),(0,xn.jsx)("div",{className:"flex items-center gap-2",children:T.assignedTo?(0,xn.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 rounded-lg",children:[(0,xn.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:T.assignedTo.avatar}),(0,xn.jsxs)("span",{className:"text-sm text-green-800",children:["Assigned to ",T.assignedTo.name]})]}):(0,xn.jsx)("span",{className:"text-sm text-slate-500 px-3 py-2 bg-slate-100 rounded-lg",children:"Not assigned"})})]}),(0,xn.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[(0,xn.jsxs)("button",{onClick:()=>{B(T.id),E(null)},className:"flex-1 flex items-center justify-center gap-2 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors",children:[(0,xn.jsx)(ia,{className:"w-5 h-5"}),"Approve Lead"]}),(0,xn.jsxs)("button",{onClick:()=>{U(T.id),E(null)},className:"flex-1 flex items-center justify-center gap-2 bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition-colors",children:[(0,xn.jsx)(xa,{className:"w-5 h-5"}),"Reject Lead"]})]})]})]})})]})}function ab(e){let{modalOpen:t}=e;const[r,n]=(0,s.useState)(!0),[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(null),[f,m]=(0,s.useState)({pending:0,quickReview:0});(0,s.useEffect)(()=>{const e=setTimeout(()=>{n(!1)},1500);return()=>clearTimeout(e)},[]);return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-orange-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% { opacity: 0; transform: translateX(-100px); }\n          100% { opacity: 1; transform: translateX(0); }\n        }\n        @keyframes fadeInUp {\n          0% { opacity: 0; transform: translateY(30px); }\n          100% { opacity: 1; transform: translateY(0); }\n        }\n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,xn.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,xn.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Bx,{className:"w-6 h-6 text-orange-600"}),(0,xn.jsxs)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:["Social Leads ",o&&(0,xn.jsx)("span",{className:"text-lg text-orange-600",children:"(Review Mode)"})]})]})}),(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,xn.jsxs)("button",{onClick:()=>{l(!o),d([])},className:"flex items-center gap-2 px-3 py-2 border rounded-lg text-sm font-medium transition-all duration-200 shadow-sm group ".concat(o?"bg-orange-100 border-orange-300 text-orange-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"),title:"Toggle review mode",children:[(0,xn.jsx)(Kx,{className:"w-4 h-4"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:o?"Exit Review":"Review Mode"})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Provide feedback",children:[(0,xn.jsx)(Yx,{className:"w-4 h-4 text-pink-500 group-hover:text-pink-600"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Messages",children:(0,xn.jsx)(Xx,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,xn.jsx)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm",children:(0,xn.jsx)("span",{className:"text-sm font-semibold",children:"K"})}),(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-l-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Invite team members",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-orange-500 group-hover:text-orange-600"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Invite"}),(0,xn.jsx)("span",{className:"bg-orange-100 text-orange-700 px-1.5 py-0.5 rounded text-xs font-medium",children:"1"})]}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 border-l-0 rounded-r-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share leads",children:(0,xn.jsx)(Jx,{className:"w-4 h-4 text-slate-600 group-hover:text-slate-800"})})]})]})]}),(0,xn.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:o?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsxs)("button",{onClick:async()=>{if(0!==c.length){if(window.confirm("Approve ".concat(c.length," selected lead(s)?")))try{await Wx(c),alert("".concat(c.length," lead(s) approved successfully!")),d([])}catch(e){alert("Failed to approve leads. Please try again.")}}else alert("Please select leads to approve")},disabled:0===c.length,className:"flex items-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Approve selected leads",children:[(0,xn.jsx)(ia,{className:"w-5 h-5"}),(0,xn.jsxs)("span",{children:["Approve (",c.length,")"]})]}),(0,xn.jsxs)("button",{onClick:async()=>{if(0!==c.length){if(window.confirm("Reject ".concat(c.length," selected lead(s)?")))try{await Vx(c),alert("".concat(c.length," lead(s) rejected successfully!")),d([])}catch(e){alert("Failed to reject leads. Please try again.")}}else alert("Please select leads to reject")},disabled:0===c.length,className:"flex items-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Reject selected leads",children:[(0,xn.jsx)(xa,{className:"w-5 h-5"}),(0,xn.jsxs)("span",{children:["Reject (",c.length,")"]})]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 bg-blue-50 px-3 py-2 rounded-lg",children:[(0,xn.jsx)(va,{className:"w-4 h-4 text-blue-600"}),(0,xn.jsx)("span",{children:"Select leads to review and approve/reject"})]})]}),(0,xn.jsx)("div",{className:"flex-1 flex items-center justify-end",children:(0,xn.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search leads to review...",value:a,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[t&&(0,xn.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-orange-600 text-white rounded-lg text-sm font-medium hover:bg-orange-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Add new lead",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Add Lead"})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 shadow-sm ".concat("quick-review"===u?"bg-blue-600 text-white":"bg-white border border-slate-300 text-slate-700 hover:bg-slate-50"),title:"Quick review pending leads",onClick:()=>h("quick-review"===u?null:"quick-review"),children:[(0,xn.jsx)(fa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Quick Review"}),f.quickReview>0&&(0,xn.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium ".concat("quick-review"===u?"bg-blue-500 text-white":"bg-blue-100 text-blue-800"),children:f.quickReview})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 ".concat("pending"===u?"bg-amber-600 text-white":"bg-amber-100 text-amber-800 border border-amber-300 hover:bg-amber-200"),title:"View pending approvals",onClick:()=>h("pending"===u?null:"pending"),children:[(0,xn.jsx)(sa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Pending"}),f.pending>0&&(0,xn.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium ".concat("pending"===u?"bg-amber-500 text-white":"bg-amber-200 text-amber-900"),children:f.pending})]}),u&&(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-red-100 text-red-800 border border-red-300 rounded-lg text-sm font-medium hover:bg-red-200 transition-all duration-200",title:"Clear filter",onClick:()=>h(null),children:[(0,xn.jsx)(Ln,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Clear Filter"})]})]}),(0,xn.jsx)("div",{className:"flex-1 flex items-center justify-end",children:(0,xn.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search leads...",value:a,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]})}),o&&(0,xn.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6 ".concat(r?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:(0,xn.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-6",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Approved: 15"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-3 h-3 bg-amber-500 rounded-full"}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Pending: 7"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Rejected: 3"})]})]}),(0,xn.jsxs)("div",{className:"text-sm text-slate-600",children:["Total Selected: ",(0,xn.jsx)("span",{className:"font-medium text-orange-600",children:c.length})]})]})}),(0,xn.jsx)("div",{className:"space-y-6",children:(0,xn.jsx)(nb,{onOpen:t,loading:r,delay:300,reviewMode:o,selectedLeads:c,setSelectedLeads:d,filterStatus:u,setFilterStatus:h,setLeadCounts:m})}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:()=>{n(!0),setTimeout(()=>n(!1),1500)},className:"bg-orange-600 hover:bg-orange-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Leads",children:(0,xn.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(r?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,xn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,xn.jsx)("div",{className:"h-8"})]})]})}function sb(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),a=()=>{t(!1)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(ab,{modalOpen:()=>{t(!0)}})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:a}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Gx,{onClose:a})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const ib=En("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),ob=En("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),lb=En("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),cb=En("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),db=async()=>(await mn.get("".concat(pn,"/Account/account"))).data,ub=async e=>(await mn.post("".concat(pn,"/Account/account-address"),{accountName:e})).data,hb=async e=>(await mn.post("".concat(pn,"/Account/account"),e)).data,fb=async e=>(await mn.put("".concat(pn,"/Account/account"),e)).data,mb=async()=>(await mn.get("".concat(pn,"/Account/account-names"))).data,pb=["sysID"];function gb(e){let{onClose:t,account:r=null,onSuccess:n,loadAccounts:a,setOpenContactModal:i,contacts:o=[]}=e;const[l,c]=(0,s.useState)({sysID:"",accountName:"",accountType:"",domain:"",fmsCode:"",industry:"",tp:"",location:"",salesPerson:"",description:""}),[d,u]=(0,s.useState)({}),[h,f]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[b,v]=(0,s.useState)([]),[y,w]=(0,s.useState)(!1),[N,j]=(0,s.useState)([]),k=(0,s.useRef)(null),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{A()},[]);const A=async()=>{try{const e=(await rb()).filter(e=>"Active"===e.status);v(e)}catch(e){console.error("Error fetching employees:",e)}};(0,s.useEffect)(()=>{const e=e=>{S.current&&!S.current.contains(e.target)&&k.current&&!k.current.contains(e.target)&&w(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{r&&r.sysID&&(c({sysID:r.sysID||"",accountName:r.accountName||"",accountType:r.accountType||"",domain:r.domain||"",fmsCode:r.fmsCode||"",industry:r.industry||"",tp:r.tp||"",location:r.location||"",salesPerson:r.salesPerson||"",description:r.description||""}),x(!0),console.log(r))},[r]);const C=e=>{const{name:t,value:r}=e.target;if(c(e=>We(We({},e),{},{[t]:r})),d[t]&&u(e=>We(We({},e),{},{[t]:""})),m&&p(null),"salesPerson"===t)if(r.trim()){const e=b.filter(e=>{const t="".concat(e.fname," ").concat(e.lname).toLowerCase(),n=r.toLowerCase();return t.includes(n)||e.email.toLowerCase().includes(n)||e.position.toLowerCase().includes(n)});j(e),w(!0)}else j([]),w(!1)},_=(()=>{try{if(r&&r.contactsJson){const e=JSON.parse(r.contactsJson);return Array.isArray(e)?e:[]}}catch(K_){console.error("Error parsing contactsJson:",K_)}return[]})(),T=o.length>0?o:_;return(0,xn.jsxs)("div",{className:"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(zx,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:g?"Edit Account":"Add New Account"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:g?"Update account information and business details":"Create a new account to manage business relationships"})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),m&&(0,xn.jsxs)("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,xn.jsx)("span",{className:"text-red-500 text-lg",children:"\u26a0\ufe0f"}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsx)("h3",{className:"text-sm font-semibold text-red-800",children:"Submission Error"}),(0,xn.jsx)("p",{className:"text-sm text-red-700 mt-1",children:m})]})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"bg-blue-50 rounded-xl p-5 border border-blue-200",children:[(0,xn.jsxs)("h2",{className:"text-base font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(zx,{className:"w-4 h-4 text-blue-600"}),"Company Information"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{className:"lg:col-span-2",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(zx,{className:"w-4 h-4 text-blue-600"}),"Account Name ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",name:"accountName",value:l.accountName,onChange:C,className:"w-full px-4 py-3 border ".concat(d.accountName?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all"),placeholder:"Enter company or account name"}),d.accountName&&(0,xn.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.accountName})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(ib,{className:"w-4 h-4 text-purple-600"}),"Account Type"]}),(0,xn.jsxs)("select",{name:"accountType",value:l.accountType,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",children:[(0,xn.jsx)("option",{value:"",children:"Select account type"}),(0,xn.jsx)("option",{value:"import",children:"Import"}),(0,xn.jsx)("option",{value:"export",children:"Export"}),(0,xn.jsx)("option",{value:"both",children:"Both Import & Export"})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(ob,{className:"w-4 h-4 text-green-600"}),"Domain / Website"]}),(0,xn.jsx)("input",{type:"url",name:"domain",value:l.domain,onChange:C,className:"w-full px-4 py-3 border ".concat(d.domain?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all"),placeholder:"https://www.example.com"}),d.domain&&(0,xn.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.domain})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(lb,{className:"w-4 h-4 text-indigo-600"}),"FMS Code"]}),(0,xn.jsx)("input",{type:"text",name:"fmsCode",value:l.fmsCode,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"Enter FMS code"}),d.fmsCode&&(0,xn.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.fmsCode})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ux,{className:"w-4 h-4 text-yellow-600"}),"Industry"]}),(0,xn.jsxs)("select",{name:"industry",value:l.industry,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",children:[(0,xn.jsx)("option",{value:"",children:"Select industry"}),[{value:"technology",label:"Technology"},{value:"software",label:"Software & SaaS"},{value:"data-analytics",label:"Data & Analytics"},{value:"healthcare",label:"Healthcare"},{value:"finance",label:"Finance & Banking"},{value:"manufacturing",label:"Manufacturing"},{value:"retail",label:"Retail & E-commerce"},{value:"education",label:"Education"},{value:"real-estate",label:"Real Estate"},{value:"consulting",label:"Consulting"},{value:"media",label:"Media & Entertainment"},{value:"automotive",label:"Automotive"},{value:"energy",label:"Energy & Utilities"},{value:"telecommunications",label:"Telecommunications"},{value:"agriculture",label:"Agriculture"},{value:"construction",label:"Construction"},{value:"logistics",label:"Logistics & Transportation"},{value:"government",label:"Government"},{value:"nonprofit",label:"Non-profit"},{value:"other",label:"Other"}].map(e=>(0,xn.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(qx,{className:"w-4 h-4 text-teal-600"}),"Company Phone"]}),(0,xn.jsx)("input",{type:"tel",name:"tp",value:l.tp,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"+1 (555) 000-0000"})]}),(0,xn.jsxs)("div",{className:"lg:col-span-1",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-red-600"}),"Location"]}),(0,xn.jsx)("input",{type:"text",name:"location",value:l.location,onChange:C,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"City, State/Province, Country"})]}),(0,xn.jsxs)("div",{className:"lg:col-span-1 relative",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(cb,{className:"w-4 h-4 text-orange-600"}),"Sales Person"]}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("input",{ref:k,type:"text",name:"salesPerson",value:l.salesPerson,onChange:C,onFocus:()=>{l.salesPerson.trim()&&N.length>0&&w(!0)},className:"w-full px-4 py-3 pr-10 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"Type to search employee...",autoComplete:"off"}),(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2"})]}),y&&N.length>0&&(0,xn.jsx)("div",{ref:S,className:"absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:N.map(e=>(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{const t="".concat(e.fname," ").concat(e.lname);c(e=>We(We({},e),{},{salesPerson:t})),w(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-purple-50 transition-colors border-b border-slate-100 last:border-b-0",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,xn.jsx)(Fn,{className:"w-4 h-4 text-purple-600"})}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("p",{className:"text-sm font-medium text-slate-900",children:[e.fname," ",e.lname]}),(0,xn.jsxs)("p",{className:"text-xs text-slate-500",children:[e.position," \u2022 ",e.department]})]})]})},e.sysID))})]})]})]}),(0,xn.jsxs)("div",{className:"bg-orange-50 rounded-xl p-5 border border-orange-200",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,xn.jsxs)("h2",{className:"text-base font-semibold text-slate-800 flex items-center gap-2",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-orange-600"}),"Contact Information"]}),(0,xn.jsxs)("button",{type:"button",onClick:()=>{i&&i(!0)},className:"px-4 py-2 text-orange-700 bg-white border-2 border-orange-300 hover:bg-orange-50 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 text-sm",disabled:h,children:[(0,xn.jsx)($x,{className:"w-4 h-4"}),T.length>0?"Edit Contacts":"Add Contacts"]})]}),T.length>0?(0,xn.jsx)("div",{className:"space-y-3",children:T.map((e,t)=>(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:(0,xn.jsx)("div",{className:"flex items-start justify-between",children:(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-orange-600"}),(0,xn.jsx)("span",{className:"font-semibold text-slate-800",children:e.contactName||"Unnamed Contact"}),0===t&&(0,xn.jsx)("span",{className:"text-xs px-2 py-1 bg-orange-100 text-orange-700 rounded-full",children:"Primary"})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-slate-600",children:[e.email&&(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3 text-orange-500"}),(0,xn.jsx)("span",{children:e.email})]}),e.position&&(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Ux,{className:"w-3 h-3 text-orange-500"}),(0,xn.jsx)("span",{children:e.position})]}),e.mobile&&(0,xn.jsxs)("div",{className:"flex items-center gap-2 md:col-span-2",children:[(0,xn.jsx)(qx,{className:"w-3 h-3 text-orange-500"}),(0,xn.jsx)("span",{children:e.mobile})]})]})]})})},t))}):(0,xn.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,xn.jsx)($x,{className:"w-12 h-12 mx-auto mb-3 text-slate-300"}),(0,xn.jsx)("p",{className:"text-sm",children:"No contacts added yet"}),(0,xn.jsx)("p",{className:"text-xs mt-1",children:'Click "Add Contacts" to add contact information'})]})]}),(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[(0,xn.jsxs)("h2",{className:"text-base font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-gray-600"}),"Additional Details"]}),(0,xn.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-gray-600"}),"Company Description"]}),(0,xn.jsx)("textarea",{name:"description",value:l.description,onChange:C,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-slate-400 transition-all resize-none",placeholder:"Enter company description, business overview, services, or important notes about this account..."})]})})]})]})}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:h,children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),(()=>{const e={};return l.accountName.trim()||(e.accountName="Account name is required"),l.fmsCode.trim()||(e.fmsCode="FMS code is required"),l.domain&&!l.domain.match(/^https?:\/\/.+/)&&(e.domain="Please enter a valid URL (starting with http:// or https://)"),u(e),0===Object.keys(e).length})()){f(!0),p(null);try{const e=o.length>0?o[0]:{},r=We(We({},l),{},{primaryContact:e.contactName||"",primaryEmail:e.email||"",primaryPosition:e.position||"",primaryMobile:e.mobile||"",contactsJson:JSON.stringify(o)});let s;if(g)s=await fb(r);else{const{sysID:e}=r,t=jn(r,pb);console.log("this is gonee ",t),s=await hb(t)}a&&a(),console.log("Account saved successfully:",s),n&&n(s),t()}catch(i){var r,s;console.error("Error submitting form:",i);const e=(null===(r=i.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||i.message||"Failed to ".concat(g?"update":"create"," account. Please try again.");p(e)}finally{f(!1)}}},disabled:h,className:"px-6 py-3 text-white bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:h?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),g?"Updating...":"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(zx,{className:"w-4 h-4"}),g?"Update Account":"Save Account"]})})]})]})}const xb=En("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),bb=En("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),vb=En("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);function yb(e){let{onOpen:t,onEdit:r,setSelectedAccount:n,accounts:a,error:i,loading:o,loadAccounts:l}=e;const[c,d]=(0,s.useState)(new Set),u=e=>{try{if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(K_){return console.error("Error parsing contacts:",K_),[]}},h=()=>(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded w-24"}),(0,xn.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("div",{className:"min-w-full",children:[(0,xn.jsx)("div",{className:"grid grid-cols-11 gap-4 p-4 bg-slate-50 border-b border-slate-200",children:Array.from({length:11}).map((e,t)=>(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))}),Array.from({length:3}).map((e,t)=>(0,xn.jsx)("div",{className:"grid grid-cols-11 gap-4 p-4 border-b border-slate-100",children:Array.from({length:11}).map((e,t)=>(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))},t))]})})]}),f=e=>{let{industry:t}=e;return t?(0,xn.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:[(0,xn.jsx)(Xn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate max-w-32",children:t})]}):null},m=e=>{let{domain:t}=e;return t?(0,xn.jsxs)("a",{href:t.startsWith("http")?t:"https://".concat(t),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-purple-600 hover:text-purple-800 transition-colors group",children:[(0,xn.jsx)(ob,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"text-sm truncate max-w-32",children:t.replace(/^https?:\/\//,"")}),(0,xn.jsx)(xb,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]}):(0,xn.jsx)("span",{className:"text-sm text-slate-400",children:"-"})},p=e=>{let{contact:t,isPrimary:r=!1}=e;return(0,xn.jsxs)("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200",children:[(0,xn.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-orange-600"}),(0,xn.jsx)("span",{className:"font-medium text-slate-800",children:t.contactName||"Unnamed"}),r&&(0,xn.jsx)("span",{className:"text-xs px-2 py-0.5 bg-orange-600 text-white rounded-full",children:"Primary"})]})}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[t.email&&(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-slate-600",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3 text-orange-500"}),(0,xn.jsx)("span",{className:"truncate",children:t.email})]}),t.position&&(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-slate-600",children:[(0,xn.jsx)(Ux,{className:"w-3 h-3 text-orange-500"}),(0,xn.jsx)("span",{className:"truncate",children:t.position})]}),t.mobile&&(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-slate-600 md:col-span-2",children:[(0,xn.jsx)(qx,{className:"w-3 h-3 text-orange-500"}),(0,xn.jsx)("span",{children:t.mobile})]})]})]})},g=e=>{let{account:t}=e;const r=u(t.contactsJson);return(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"10",className:"px-4 py-4 bg-slate-50",children:(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-orange-600"}),"Contact Information (",r.length," ",1===r.length?"contact":"contacts",")"]}),r.length>0?(0,xn.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:r.map((e,t)=>(0,xn.jsx)(p,{contact:e,isPrimary:0===t},t))}):(0,xn.jsxs)("div",{className:"text-center py-6 text-slate-500",children:[(0,xn.jsx)($x,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),(0,xn.jsx)("p",{className:"text-sm",children:"No contacts added"})]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-slate-200",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Account Type"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.accountType||"-"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"FMS Code"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.fmsCode||"-"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Company Phone"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.tp||"-"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Sales Person"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.salesPerson||"-"})]}),(0,xn.jsxs)("div",{className:"md:col-span-2",children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Description"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800 mt-1",children:t.description||"-"})]})]})]})})})},x=e=>{let{account:r}=e;const a=c.has(r.sysID);u(r.contactsJson);return(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("button",{onClick:()=>{return e=r.sysID,void d(t=>{const r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r});var e},className:"p-2 text-slate-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-all duration-200",title:a?"Collapse details":"Expand details",children:a?(0,xn.jsx)(ua,{className:"w-4 h-4"}):(0,xn.jsx)(bb,{className:"w-4 h-4"})}),(0,xn.jsx)("button",{onClick:()=>(e=>{n(e),t()})(r),className:"p-2 text-slate-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-all duration-200",title:"Edit account",children:(0,xn.jsx)(za,{className:"w-4 h-4"})})]})};return o?(0,xn.jsx)(h,{}):i?(0,xn.jsx)("div",{className:"bg-white rounded-xl border border-red-200 shadow-sm p-8",children:(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,xn.jsx)(vb,{className:"w-6 h-6 text-red-600"})}),(0,xn.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Failed to load accounts"}),(0,xn.jsx)("p",{className:"text-slate-500 mb-4",children:i}),(0,xn.jsx)("button",{onClick:l,className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:"Try Again"})]})}):(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300",children:[(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("div",{className:"min-w-full",children:[(0,xn.jsx)("div",{className:"hidden xl:block",children:(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-4 py-3 text-left",children:(0,xn.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600 border-slate-300 rounded focus:ring-purple-500 focus:ring-2"})}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Account"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Domain"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Industry"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Primary Contact"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Email"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Location"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Type"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Contacts"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-100",children:a.map(e=>{const t=c.has(e.sysID),r=u(e.contactsJson);return(0,xn.jsxs)(s.Fragment,{children:[(0,xn.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group ".concat(t?"bg-slate-50":""),children:[(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600 border-slate-300 rounded focus:ring-purple-500 focus:ring-2"})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(zx,{className:"w-4 h-4 text-purple-600"}),(0,xn.jsx)("span",{className:"font-medium text-slate-900",children:e.accountName||"-"})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(m,{domain:e.domain})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(f,{industry:e.industry})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(Fn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate max-w-32",children:e.primaryContact||"-"})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:e.primaryEmail?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate max-w-32",children:e.primaryEmail})]}):(0,xn.jsx)("span",{className:"text-sm text-slate-400",children:"-"})}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(_a,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate max-w-32",children:e.location||"-"})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:e.accountType&&(0,xn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700",children:e.accountType})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)($x,{className:"w-3 h-3 text-orange-600"}),(0,xn.jsx)("span",{className:"text-sm font-medium text-slate-700",children:r.length})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(x,{account:e})})]}),t&&(0,xn.jsx)(g,{account:e})]},e.sysID)})})]})}),(0,xn.jsx)("div",{className:"xl:hidden p-4 space-y-4",children:a.map(e=>{const t=c.has(e.sysID),r=u(e.contactsJson);return(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 space-y-4",children:[(0,xn.jsxs)("div",{className:"flex items-start justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,xn.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600 border-slate-300 rounded focus:ring-purple-500 focus:ring-2"}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,xn.jsx)(zx,{className:"w-4 h-4 text-purple-600"}),(0,xn.jsx)("h3",{className:"font-medium text-slate-900",children:e.accountName})]}),(0,xn.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,xn.jsx)(m,{domain:e.domain})}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,xn.jsx)(f,{industry:e.industry}),e.accountType&&(0,xn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700",children:e.accountType})]})]})]}),(0,xn.jsx)(x,{account:e})]}),(0,xn.jsx)("div",{className:"space-y-2",children:(0,xn.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm text-slate-600",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4"}),(0,xn.jsxs)("span",{children:["Primary: ",e.primaryContact||"-"]})]}),e.primaryEmail&&(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Hn,{className:"w-4 h-4"}),(0,xn.jsx)("span",{className:"truncate",children:e.primaryEmail})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(_a,{className:"w-4 h-4"}),(0,xn.jsxs)("span",{children:["Location: ",e.location||"-"]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-orange-600"}),(0,xn.jsxs)("span",{children:["Contacts: ",r.length]})]})]})}),t&&(0,xn.jsxs)("div",{className:"pt-4 border-t border-slate-200 space-y-3",children:[(0,xn.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 flex items-center gap-2",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-orange-600"}),"All Contacts (",r.length,")"]}),r.length>0?(0,xn.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,xn.jsx)(p,{contact:e,isPrimary:0===t},t))}):(0,xn.jsxs)("div",{className:"text-center py-4 text-slate-500",children:[(0,xn.jsx)($x,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),(0,xn.jsx)("p",{className:"text-sm",children:"No contacts added"})]}),(0,xn.jsxs)("div",{className:"pt-3 border-t border-slate-200 space-y-2",children:[e.fmsCode&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"FMS Code"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800",children:e.fmsCode})]}),e.tp&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"Company Phone"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800",children:e.tp})]}),e.salesPerson&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"Sales Person"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800",children:e.salesPerson})]}),e.description&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"Description"}),(0,xn.jsx)("p",{className:"text-sm text-slate-800",children:e.description})]})]})]})]},e.sysID)})})]})}),0===a.length&&!o&&(0,xn.jsxs)("div",{className:"text-center py-12",children:[(0,xn.jsx)(zx,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),(0,xn.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No accounts yet"}),(0,xn.jsx)("p",{className:"text-slate-500 mb-4",children:"Get started by adding your first account"}),t&&(0,xn.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),"Add Account"]})]})]})}function wb(e){let{modalOpen:t,setSelectedAccount:r,error:n,accounts:a,loadAccounts:i}=e;const[o,l]=(0,s.useState)(!0),[c,d]=(0,s.useState)("");(0,s.useEffect)(()=>{const e=setTimeout(()=>{l(!1)},1500);return()=>clearTimeout(e)},[]);const u=(0,s.useMemo)(()=>{if(!c.trim())return a;const e=c.toLowerCase();return a.filter(t=>{var r;return[t.accountName,t.domain,t.industry,t.description,t.headquartersLocation,null===(r=t.numberOfEmployees)||void 0===r?void 0:r.toString()].some(t=>null===t||void 0===t?void 0:t.toLowerCase().includes(e))})},[a,c]);return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-purple-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,xn.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,xn.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(o?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(zx,{className:"w-6 h-6 text-purple-600"}),(0,xn.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Accounts"}),c&&(0,xn.jsxs)("span",{className:"text-sm text-slate-500 font-normal",children:["(",u.length," of ",a.length,")"]})]})}),(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Provide feedback",children:[(0,xn.jsx)(Yx,{className:"w-4 h-4 text-pink-500 group-hover:text-pink-600"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Messages",children:(0,xn.jsx)(Xx,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,xn.jsx)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm",children:(0,xn.jsx)("span",{className:"text-sm font-semibold",children:"K"})}),(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-l-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Invite team members",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-purple-500 group-hover:text-purple-600"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Invite"}),(0,xn.jsx)("span",{className:"bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded text-xs font-medium",children:"1"})]}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 border-l-0 rounded-r-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share account",children:(0,xn.jsx)(Jx,{className:"w-4 h-4 text-slate-600 group-hover:text-slate-800"})})]})]})]}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(o?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,xn.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Create a new account",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),(0,xn.jsx)("span",{children:"New Account"})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",title:"Filter accounts",children:[(0,xn.jsx)(Qn,{className:"w-4 h-4 text-slate-600"}),(0,xn.jsx)("span",{children:"Filter"}),(0,xn.jsx)(ua,{className:"w-4 h-4 text-slate-400"})]})]}),(0,xn.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search accounts...",value:c,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 text-sm"}),c&&(0,xn.jsx)("button",{onClick:()=>d(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600",title:"Clear search",children:"\u2715"})]})})]}),(0,xn.jsx)("div",{className:"space-y-6",children:c&&0===u.length?(0,xn.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border border-slate-200",children:[(0,xn.jsx)(ha,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,xn.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No accounts found"}),(0,xn.jsx)("p",{className:"text-slate-500",children:"Try adjusting your search query"})]}):(0,xn.jsx)(yb,{onOpen:t,loading:o,delay:300,setSelectedAccount:r,error:n,accounts:u,loadAccounts:i})}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:()=>{l(!0),i(),setTimeout(()=>l(!1),1500)},className:"bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Accounts",children:(0,xn.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(o?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,xn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,xn.jsx)("div",{className:"h-8"})]})]})}function Nb(e){let{onClose:t,account:r=null,setSecContacts:n,existingContacts:a=[]}=e;const[i,o]=(0,s.useState)([{id:Date.now(),contactName:"",email:"",position:"",mobile:""}]),[l,c]=(0,s.useState)({}),[d,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{a&&a.length>0&&o(a.map((e,t)=>({id:Date.now()+t,contactName:e.contactName||"",email:e.email||"",position:e.position||"",mobile:e.mobile||""})))},[a]);const m=(e,t,r)=>{o(n=>n.map(n=>n.id===e?We(We({},n),{},{[t]:r}):n));const n="".concat(e,"_").concat(t);l[n]&&c(e=>We(We({},e),{},{[n]:""})),h&&f(null)};return(0,xn.jsxs)("div",{className:"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-orange-50 to-amber-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center",children:(0,xn.jsx)($x,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:a.length>0?"Edit Contacts":"Add New Contacts"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:a.length>0?"Update contact information details":"Add multiple contacts for this account"})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),h&&(0,xn.jsxs)("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,xn.jsx)("span",{className:"text-red-500 text-lg",children:"\u26a0\ufe0f"}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsx)("h3",{className:"text-sm font-semibold text-red-800",children:"Submission Error"}),(0,xn.jsx)("p",{className:"text-sm text-red-700 mt-1",children:h})]})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Add multiple contacts for this account. First contact is primary."}),(0,xn.jsxs)("button",{type:"button",onClick:()=>{const e={id:Date.now(),contactName:"",email:"",position:"",mobile:""};o([...i,e])},className:"px-4 py-2 text-orange-700 bg-white border-2 border-orange-300 hover:bg-orange-50 rounded-lg transition-all duration-200 font-medium flex items-center gap-2",disabled:d,children:[(0,xn.jsx)($x,{className:"w-4 h-4"}),"Add Contact"]})]}),i.map((e,t)=>(0,xn.jsxs)("div",{className:"bg-orange-50 rounded-xl p-5 border-2 border-orange-200 relative",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,xn.jsxs)("h3",{className:"text-base font-semibold text-slate-800 flex items-center gap-2",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-orange-600"}),"Contact ",t+1," ",0===t&&(0,xn.jsx)("span",{className:"text-xs font-normal text-orange-600",children:"(Primary)"})]}),i.length>1&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{if(i.length>1){o(i.filter(t=>t.id!==e));const t=We({},l);Object.keys(t).forEach(r=>{r.startsWith("".concat(e,"_"))&&delete t[r]}),c(t)}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200",title:"Remove contact",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{className:"lg:col-span-2",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-orange-600"}),"Contact Name ",0===t&&(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",value:e.contactName,onChange:t=>m(e.id,"contactName",t.target.value),className:"w-full px-4 py-3 border ".concat(l["".concat(e.id,"_contactName")]?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white"),placeholder:"Enter contact person name"}),l["".concat(e.id,"_contactName")]&&(0,xn.jsx)("p",{className:"mt-1 text-sm text-red-600",children:l["".concat(e.id,"_contactName")]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Hn,{className:"w-4 h-4 text-orange-600"}),"Email"]}),(0,xn.jsx)("input",{type:"email",value:e.email,onChange:t=>m(e.id,"email",t.target.value),className:"w-full px-4 py-3 border ".concat(l["".concat(e.id,"_email")]?"border-red-500":"border-slate-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white"),placeholder:"contact@company.com"}),l["".concat(e.id,"_email")]&&(0,xn.jsx)("p",{className:"mt-1 text-sm text-red-600",children:l["".concat(e.id,"_email")]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ux,{className:"w-4 h-4 text-orange-600"}),"Position"]}),(0,xn.jsx)("input",{type:"text",value:e.position,onChange:t=>m(e.id,"position",t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",placeholder:"Job title or position"})]}),(0,xn.jsxs)("div",{className:"lg:col-span-2",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(qx,{className:"w-4 h-4 text-orange-600"}),"Mobile Number"]}),(0,xn.jsx)("input",{type:"tel",value:e.mobile,onChange:t=>m(e.id,"mobile",t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-slate-400 transition-all bg-white",placeholder:"+1 (555) 000-0000"})]})]})]},e.id)),(0,xn.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[(0,xn.jsx)("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,xn.jsx)("span",{className:"text-white text-xs font-bold",children:"i"})}),(0,xn.jsx)("div",{className:"flex-1",children:(0,xn.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,xn.jsx)("strong",{children:"Tip:"}),' You can add multiple contacts for this account. The first contact will be set as the primary contact. Click "Add Contact" to add more contacts.']})})]})]})}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:d,children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),(()=>{const e={};return i.forEach((t,r)=>{0!==r||t.contactName.trim()||(e["".concat(t.id,"_contactName")]="At least one contact name is required"),t.email&&!t.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)&&(e["".concat(t.id,"_email")]="Please enter a valid email address"),!t.contactName.trim()&&(t.email||t.position||t.mobile)&&(e["".concat(t.id,"_contactName")]="Contact name is required when other fields are filled")}),c(e),0===Object.keys(e).length})()){u(!0),f(null);try{const e=i.filter(e=>e.contactName.trim()||e.email.trim()||e.position.trim()||e.mobile.trim()).map(e=>({contactName:e.contactName||"",email:e.email||"",position:e.position||"",mobile:e.mobile||""}));n(e),console.log("Contacts to save:",e),t()}catch(s){var r,a;console.error("Error submitting form:",s);const e=(null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||s.message||"Failed to save contacts. Please try again.";f(e)}finally{u(!1)}}},disabled:d,className:"px-6 py-3 text-white bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:d?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)($x,{className:"w-4 h-4"}),"Save Contacts"]})})]})]})}function jb(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(!0),[f,m]=(0,s.useState)(null),[p,g]=(0,s.useState)([]),x=()=>{t(!1),g([])};(0,s.useEffect)(()=>{b()},[]);const b=async()=>{try{h(!0),m(null);const e=await db();d(e)}catch(e){console.error("Error fetching accounts:",e),m(e.message||"Failed to load accounts")}finally{h(!1)}},v=()=>{n(!1)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{i(!a)},isMobileMenuOpen:a}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:a,onClose:()=>{i(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(wb,{modalOpen:()=>{t(!0)},setSelectedAccount:l,loading:u,error:f,accounts:c,loadAccounts:b})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:x}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(gb,{onClose:x,account:o,loadAccounts:b,setOpenContactModal:n,contacts:p})})})]}),r&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:v}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Nb,{onClose:v,setSecContacts:g,existingContacts:(()=>{try{if(o&&o.contactsJson){const e=JSON.parse(o.contactsJson);return Array.isArray(e)?e:[]}}catch(K_){console.error("Error parsing contactsJson:",K_)}return[]})()})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const kb=En("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function Sb(e){let{modalOpen:t,onEditRate:r,refreshTrigger:n}=e;const[a,i]=(0,s.useState)("all"),[o,l]=(0,s.useState)(!0),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(new Set),[x,b]=(0,s.useState)(null),[v,y]=(0,s.useState)([]),[w,N]=(0,s.useState)(!1),[j,k]=(0,s.useState)(!1),[S,A]=(0,s.useState)(null),[C,_]=(0,s.useState)(!1),T=[{code:"MSC",name:"MSC",color:"bg-red-600"},{code:"ONE",name:"ONE",color:"bg-purple-600"},{code:"YML",name:"YML",color:"bg-orange-600"},{code:"UNIFEEDER",name:"UNIFEEDER",color:"bg-teal-600"},{code:"OOCL",name:"OOCL",color:"bg-cyan-600"},{code:"RCL",name:"RCL",color:"bg-pink-600"},{code:"CMA",name:"CMA",color:"bg-amber-600"}],E=async()=>{l(!0),m(null);try{const e=(await Ha()).map(e=>{let t={};if(e.rateDataJson)try{t=JSON.parse(e.rateDataJson)}catch(K_){console.error("Error parsing rateDataJson:",K_)}return We(We({},e),t)});h(e)}catch(e){console.error("Error fetching rates:",e),m("Failed to load rates. Please try again.")}finally{l(!1)}},L=async e=>{N(!0);try{const t=await fetch("".concat(pn,"/rates/linear?category=").concat(e)),r=(await t.json()).map(e=>({id:e.Id||e.id,pol:e.Pol||e.pol,pod:e.Pod||e.pod,gp20Usd:e.Gp20Usd||e.gp20Usd||e.gp20_usd,hq40Usd:e.Hq40Usd||e.hq40Usd||e.hq40_usd,ttRouting:e.TtRouting||e.ttRouting||e.tt_routing,valid:e.Valid||e.valid,category:e.Category||e.category,origin:e.Pol||e.pol,destination:e.Pod||e.pod,rate20GP:e.Gp20Usd||e.gp20Usd||e.gp20_usd,rate40HQ:e.Hq40Usd||e.hq40Usd||e.hq40_usd,transitTime:e.TtRouting||e.ttRouting||e.tt_routing,validateDate:e.Valid||e.valid,freightType:"SEA-EXPORT-FCL",liner:e.Category||e.category,route:"".concat(e.Pol||e.pol||"","-").concat(e.Pod||e.pod||""),currency:"USD"}));y(r)}catch(t){console.error("Error fetching liner rates:",t),y([])}finally{N(!1)}};(0,s.useEffect)(()=>{E()},[n]);const P=e=>{i(e),b(null)},O=e=>{const t=new Set(p);t.has(e)?t.delete(e):t.add(e),g(t)},F=()=>{x?L(x):E()},I=async e=>{if(window.confirm("Are you sure you want to delete this rate?"))try{const t=x?"".concat(pn,"/rates/linear/").concat(e):"".concat(pn,"/rates/").concat(e);if(!(await fetch(t,{method:"DELETE"})).ok)throw new Error("Delete failed");x?L(x):E()}catch(t){alert("Failed to delete rate.")}},R=e=>{const t=null===e||void 0===e?void 0:e.toUpperCase();return null!==t&&void 0!==t&&t.includes("AIR-IMPORT")?"bg-yellow-500":null!==t&&void 0!==t&&t.includes("AIR-EXPORT")?"bg-yellow-300":null!==t&&void 0!==t&&t.includes("SEA-IMPORT-FCL")?"bg-blue-600":null!==t&&void 0!==t&&t.includes("SEA-EXPORT-FCL")?"bg-indigo-600":null!==t&&void 0!==t&&t.includes("SEA-IMPORT-LCL")?"bg-teal-600":null!==t&&void 0!==t&&t.includes("SEA-EXPORT-LCL")?"bg-cyan-600":null!==t&&void 0!==t&&t.includes("AIR")?"bg-yellow-500":null!==t&&void 0!==t&&t.includes("SEA")?"bg-blue-500":"bg-slate-500"},D=e=>{let{type:t}=e;const r=null===t||void 0===t?void 0:t.toLowerCase();return null!==r&&void 0!==r&&r.includes("air")?(0,xn.jsx)(ya,{className:"w-4 h-4"}):null!==r&&void 0!==r&&r.includes("sea")?(0,xn.jsx)(Na,{className:"w-4 h-4"}):null},M=e=>null===e||void 0===e||""===e?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),B=e=>{if(!e)return"-";const t=new Date(e),r=new Date,n=Math.ceil((t-r)/864e5),a=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return n<0?(0,xn.jsxs)("span",{className:"text-red-600 font-medium",children:[a," (Expired)"]}):n<=7?(0,xn.jsxs)("span",{className:"text-orange-600 font-medium",children:[a," (",n,"d left)"]}):a},U=e=>{var t,r,n,a,s,i,o,l,c,d,u,h;return null!==(t=e.freightType)&&void 0!==t&&t.toLowerCase().includes("air")?null!==(a=null!==(s=null!==(i=null!==(o=null!==(l=e.rate45Plus)&&void 0!==l?l:e.rate45MinusM)&&void 0!==o?o:e.rate45Minus)&&void 0!==i?i:e.rate100)&&void 0!==s?s:e.rateM)&&void 0!==a?a:"-":null!==(r=e.freightType)&&void 0!==r&&r.toLowerCase().includes("fcl")?null!==(c=null!==(d=null!==(u=e.rate20GP)&&void 0!==u?u:e.rate40GP)&&void 0!==d?d:e.rate40HQ)&&void 0!==c?c:"-":null!==(n=e.freightType)&&void 0!==n&&n.toLowerCase().includes("lcl")&&null!==(h=e.lclRate)&&void 0!==h?h:"-"},z=e=>{if(!e)return null;const t="DIRECT"===(null===e||void 0===e?void 0:e.toUpperCase());return(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ".concat(t?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"),children:[(0,xn.jsx)(Ca,{className:"w-3 h-3"}),t?"Direct":"Transshipment"]})},q=(()=>{let e=u;if("liner"!==a){switch(a){case"air":e=u.filter(e=>{var t;return null===(t=e.freightType)||void 0===t?void 0:t.toLowerCase().includes("air")});break;case"sea":e=u.filter(e=>{var t;return null===(t=e.freightType)||void 0===t?void 0:t.toLowerCase().includes("sea")});break;default:e=u}c.trim()&&(e=e.filter(e=>{var t,r,n,a,s;return(null===(t=e.origin)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||(null===(r=e.destination)||void 0===r?void 0:r.toLowerCase().includes(c.toLowerCase()))||(null===(n=e.airline)||void 0===n?void 0:n.toLowerCase().includes(c.toLowerCase()))||(null===(a=e.liner)||void 0===a?void 0:a.toLowerCase().includes(c.toLowerCase()))||(null===(s=e.route)||void 0===s?void 0:s.toLowerCase().includes(c.toLowerCase()))}))}return e})(),H=x?v:q,W=x?w:o,V=T.find(e=>e.code===x);return(0,xn.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 bg-slate-50 min-h-screen",children:[(0,xn.jsxs)("div",{className:"max-w-[1800px] mx-auto",children:[(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 flex items-center gap-2",children:[(0,xn.jsx)(Ea,{className:"w-8 h-8 text-indigo-600"}),"Rates Management"]}),(0,xn.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage and compare freight rates across routes"})]}),x?(0,xn.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-6 py-3 ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-lg font-medium hover:opacity-90 transition-all shadow-lg hover:shadow-xl"),children:[(0,xn.jsx)(Za,{className:"w-5 h-5"}),"Create New Rate for ",x]}):(0,xn.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-lg hover:shadow-xl",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),"Create New Rate"]})]}),(0,xn.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,xn.jsxs)("button",{onClick:()=>P("all"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("all"===a?"bg-indigo-600 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:["All Rates (",u.length,")"]}),(0,xn.jsxs)("button",{onClick:()=>P("air"),className:"px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ".concat("air"===a?"bg-yellow-500 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:[(0,xn.jsx)(ya,{className:"w-4 h-4"})," Air Freight"]}),(0,xn.jsxs)("button",{onClick:()=>P("sea"),className:"px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ".concat("sea"===a?"bg-blue-500 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:[(0,xn.jsx)(Na,{className:"w-4 h-4"})," Sea Freight"]}),(0,xn.jsx)("div",{className:"w-px bg-slate-300 mx-2"}),T.map(e=>(0,xn.jsxs)("button",{onClick:()=>{return t=e.code,b(t),i("liner"),void L(t);var t},className:"px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ".concat(x===e.code?"".concat(e.color," text-white shadow-md"):"bg-white text-slate-600 hover:bg-slate-50 border border-slate-200"),children:[(0,xn.jsx)(Na,{className:"w-4 h-4"})," ",e.name]},e.code))]}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(ha,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search by origin, destination, carrier, or route...",value:c,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white"})]})]}),f&&(0,xn.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded",children:(0,xn.jsxs)("div",{className:"flex items-start gap-3",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"font-medium text-red-800",children:"Error Loading Rates"}),(0,xn.jsx)("p",{className:"text-red-600 text-sm mt-1",children:f}),(0,xn.jsx)("button",{onClick:F,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Try Again"})]})]})}),W&&!f&&(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-8 text-center",children:[(0,xn.jsx)(kb,{className:"w-8 h-8 text-indigo-600 animate-spin mx-auto mb-4"}),(0,xn.jsx)("p",{className:"text-slate-600",children:"Loading rates..."})]}),!W&&!f&&(0,xn.jsxs)("div",{className:"space-y-3",children:[x&&(0,xn.jsx)("div",{className:"".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-xl p-4 mb-4 shadow-md"),children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)(Na,{className:"w-6 h-6"}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h3",{className:"text-lg font-bold",children:[x," Rates"]}),(0,xn.jsxs)("p",{className:"text-sm opacity-90",children:["Showing ",v.length," rates for ",x]})]})]}),(0,xn.jsxs)("button",{onClick:()=>k(!0),className:"bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-all flex items-center gap-2",children:[(0,xn.jsx)(Za,{className:"w-4 h-4"}),"Upload Excel"]})]})}),H.map(e=>{var t,n,a,s,i;const o=p.has(e.sysID||e.id),l=null===(t=e.freightType)||void 0===t?void 0:t.toLowerCase().includes("air"),c=null===(n=e.freightType)||void 0===n?void 0:n.toLowerCase().includes("fcl"),d=null===(a=e.freightType)||void 0===a?void 0:a.toLowerCase().includes("lcl"),u=x&&e.category;return(0,xn.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,xn.jsxs)("div",{className:"p-4",children:[u?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 items-center",children:[(0,xn.jsx)("div",{className:"col-span-2",children:(0,xn.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"),children:[(0,xn.jsx)(Na,{className:"w-4 h-4"}),(0,xn.jsx)("span",{className:"uppercase",children:x})]})}),(0,xn.jsxs)("div",{className:"col-span-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-indigo-600"}),(0,xn.jsx)("span",{className:"font-bold",children:e.pol||e.origin||"-"})]}),(0,xn.jsx)("div",{className:"flex-1 h-px bg-slate-300 relative",children:(0,xn.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,xn.jsx)(Ca,{className:"w-4 h-4 text-slate-400 bg-white"})})}),(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-emerald-600"}),(0,xn.jsx)("span",{className:"font-bold",children:e.pod||e.destination||"-"})]})]}),(e.ttRouting||e.transitTime)&&(0,xn.jsxs)("div",{className:"mt-1 text-xs text-slate-500 flex items-center gap-1",children:[(0,xn.jsx)(sa,{className:"w-3 h-3"}),e.ttRouting||e.transitTime]})]}),(0,xn.jsxs)("div",{className:"col-span-2",children:[(0,xn.jsx)("div",{className:"text-sm font-semibold text-slate-600",children:"20' GP"}),(0,xn.jsx)("div",{className:"text-lg font-bold text-indigo-600",children:e.gp20Usd||e.rate20GP?M(e.gp20Usd||e.rate20GP):"-"})]}),(0,xn.jsxs)("div",{className:"col-span-2",children:[(0,xn.jsx)("div",{className:"text-sm font-semibold text-slate-600",children:"40' HQ"}),(0,xn.jsx)("div",{className:"text-lg font-bold text-emerald-600",children:e.hq40Usd||e.rate40HQ?M(e.hq40Usd||e.rate40HQ):"-"})]}),(0,xn.jsxs)("div",{className:"col-span-1",children:[(0,xn.jsx)("div",{className:"text-sm font-semibold text-slate-700",children:"USD"}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Currency"})]}),(0,xn.jsx)("div",{className:"col-span-1",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-slate-400"}),B(e.valid||e.validateDate)]})}),(0,xn.jsx)("div",{className:"col-span-1 flex items-center justify-end gap-2",children:(0,xn.jsx)("button",{onClick:()=>I(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Rate",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})})]}),(0,xn.jsxs)("div",{className:"md:hidden space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"),children:[(0,xn.jsx)(Na,{className:"w-4 h-4"}),(0,xn.jsx)("span",{className:"uppercase",children:x})]}),(0,xn.jsx)("button",{onClick:()=>I(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Rate",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})]}),(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-indigo-600"}),(0,xn.jsx)("span",{className:"font-bold text-sm",children:e.pol||e.origin||"-"}),(0,xn.jsx)(Ca,{className:"w-4 h-4 text-slate-400"}),(0,xn.jsx)(_a,{className:"w-4 h-4 text-emerald-600"}),(0,xn.jsx)("span",{className:"font-bold text-sm",children:e.pod||e.destination||"-"})]}),(e.ttRouting||e.transitTime)&&(0,xn.jsxs)("div",{className:"mt-2 text-xs text-slate-500 flex items-center gap-1",children:[(0,xn.jsx)(sa,{className:"w-3 h-3"}),e.ttRouting||e.transitTime]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,xn.jsxs)("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[(0,xn.jsx)("div",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"20' GP"}),(0,xn.jsx)("div",{className:"text-lg font-bold text-indigo-700",children:e.gp20Usd||e.rate20GP?M(e.gp20Usd||e.rate20GP):"-"})]}),(0,xn.jsxs)("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3",children:[(0,xn.jsx)("div",{className:"text-xs font-semibold text-emerald-600 mb-1",children:"40' HQ"}),(0,xn.jsx)("div",{className:"text-lg font-bold text-emerald-700",children:e.hq40Usd||e.rate40HQ?M(e.hq40Usd||e.rate40HQ):"-"})]})]}),(0,xn.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,xn.jsx)("span",{className:"text-slate-600 font-medium",children:"USD"}),(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-slate-500",children:[(0,xn.jsx)(Ta,{className:"w-3 h-3"}),B(e.valid||e.validateDate)]})]})]})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 items-center",children:[(0,xn.jsx)("div",{className:"col-span-2",children:(0,xn.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat(R(e.freightType)),children:[(0,xn.jsx)(D,{type:e.freightType}),(0,xn.jsx)("span",{className:"uppercase",children:null===(s=e.freightType)||void 0===s?void 0:s.replace(/-/g," ")})]})}),(0,xn.jsxs)("div",{className:"col-span-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-indigo-600"}),(0,xn.jsx)("span",{className:"font-bold",children:e.origin||e.Origin||"-"})]}),(0,xn.jsx)("div",{className:"flex-1 h-px bg-slate-300 relative",children:(0,xn.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,xn.jsx)(Ca,{className:"w-4 h-4 text-slate-400 bg-white"})})}),(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-emerald-600"}),(0,xn.jsx)("span",{className:"font-bold",children:e.destination||e.Destination||"-"})]})]}),(0,xn.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[z(e.routingType||e.RoutingType),(e.transitTime||e.TransitTime)>0&&(0,xn.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,xn.jsx)(sa,{className:"w-3 h-3"}),e.transitTime||e.TransitTime," days"]})]})]}),(0,xn.jsxs)("div",{className:"col-span-2",children:[(0,xn.jsx)("div",{className:"text-sm font-semibold",children:e.airline||e.liner||e.Airline||e.Liner||"-"}),(e.frequency||e.Frequency)&&(0,xn.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:e.frequency||e.Frequency})]}),(0,xn.jsxs)("div",{className:"col-span-1",children:[(0,xn.jsx)("div",{className:"text-sm font-semibold text-slate-700",children:e.currency||e.Currency||"USD"}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Currency"})]}),(0,xn.jsxs)("div",{className:"col-span-2",children:[(0,xn.jsx)("div",{className:"text-lg font-bold text-indigo-600",children:M(U(e))}),(0,xn.jsxs)("div",{className:"text-xs text-slate-500",children:[l&&"per kg (+45)",c&&"per container",d&&"per CBM"]})]}),(0,xn.jsx)("div",{className:"col-span-1",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-slate-400"}),B(e.validateDate||e.ValidateDate)]})}),(0,xn.jsxs)("div",{className:"col-span-1 flex items-center justify-end gap-2",children:[(0,xn.jsx)("button",{onClick:()=>r(e),className:"p-2 hover:bg-indigo-50 rounded-lg",children:(0,xn.jsx)(za,{className:"w-4 h-4 text-slate-600 hover:text-indigo-600"})}),(0,xn.jsx)("button",{onClick:()=>I(e.sysID||e.id),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,xn.jsx)(Pa,{className:"w-4 h-4 text-slate-600 hover:text-red-600"})}),(0,xn.jsx)("button",{onClick:()=>O(e.sysID||e.id),className:"p-2 hover:bg-slate-100 rounded-lg",children:o?(0,xn.jsx)(eb,{className:"w-5 h-5"}):(0,xn.jsx)(ua,{className:"w-5 h-5"})})]})]}),(0,xn.jsxs)("div",{className:"md:hidden space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-white ".concat(R(e.freightType)),children:[(0,xn.jsx)(D,{type:e.freightType}),(0,xn.jsx)("span",{className:"uppercase",children:null===(i=e.freightType)||void 0===i?void 0:i.replace(/-/g," ")})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsx)("button",{onClick:()=>r(e),className:"p-2 hover:bg-indigo-50 rounded-lg",children:(0,xn.jsx)(za,{className:"w-4 h-4 text-slate-600 hover:text-indigo-600"})}),(0,xn.jsx)("button",{onClick:()=>I(e.sysID||e.id),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,xn.jsx)(Pa,{className:"w-4 h-4 text-slate-600 hover:text-red-600"})}),(0,xn.jsx)("button",{onClick:()=>O(e.sysID||e.id),className:"p-2 hover:bg-slate-100 rounded-lg",children:o?(0,xn.jsx)(eb,{className:"w-5 h-5"}):(0,xn.jsx)(ua,{className:"w-5 h-5"})})]})]}),(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-indigo-600"}),(0,xn.jsx)("span",{className:"font-bold text-sm",children:e.origin||e.Origin||"-"}),(0,xn.jsx)(Ca,{className:"w-4 h-4 text-slate-400"}),(0,xn.jsx)(_a,{className:"w-4 h-4 text-emerald-600"}),(0,xn.jsx)("span",{className:"font-bold text-sm",children:e.destination||e.Destination||"-"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[z(e.routingType||e.RoutingType),(e.transitTime||e.TransitTime)>0&&(0,xn.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,xn.jsx)(sa,{className:"w-3 h-3"}),e.transitTime||e.TransitTime," days"]})]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Carrier"}),(0,xn.jsx)("div",{className:"text-sm font-semibold",children:e.airline||e.liner||e.Airline||e.Liner||"-"}),(e.frequency||e.Frequency)&&(0,xn.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:e.frequency||e.Frequency})]}),(0,xn.jsxs)("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[(0,xn.jsxs)("div",{className:"text-xs text-indigo-600 mb-1",children:[l&&"per kg (+45)",c&&"per container",d&&"per CBM"]}),(0,xn.jsx)("div",{className:"text-lg font-bold text-indigo-700",children:M(U(e))})]})]}),(0,xn.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,xn.jsx)("span",{className:"text-slate-600 font-medium",children:e.currency||e.Currency||"USD"}),(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-slate-500",children:[(0,xn.jsx)(Ta,{className:"w-3 h-3"}),B(e.validateDate||e.ValidateDate)]})]})]})]}),!u&&o&&(0,xn.jsx)("div",{className:"border-t border-slate-200 bg-slate-50 p-6",children:(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(ka,{className:"w-4 h-4"})," Rate Breakdown"]}),(0,xn.jsxs)("div",{className:"bg-white rounded-lg p-5",children:[l&&(0,xn.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:[null!=e.rate45MinusM&&""!==e.rate45MinusM&&(0,xn.jsxs)("div",{className:"bg-amber-50 border border-amber-300 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs font-semibold text-amber-700",children:"Minimum (M)"}),(0,xn.jsx)("div",{className:"text-xl font-bold text-amber-800 mt-1",children:M(e.rate45MinusM)})]}),null!=e.rate45Minus&&""!==e.rate45Minus&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-600",children:"-45 kg"}),(0,xn.jsx)("div",{className:"text-xl font-bold text-slate-900 mt-1",children:M(e.rate45Minus)})]}),null!=e.rate45Plus&&""!==e.rate45Plus&&(0,xn.jsxs)("div",{className:"bg-indigo-50 border-2 border-indigo-400 rounded-lg p-4 text-center shadow-sm",children:[(0,xn.jsx)("div",{className:"text-sm font-bold text-indigo-700",children:"+45 kg"}),(0,xn.jsx)("div",{className:"text-2xl font-bold text-indigo-600 mt-1",children:M(e.rate45Plus)})]}),e.rate100&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-600",children:"+100 kg"}),(0,xn.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate100)})]}),e.rate300&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-600",children:"+300 kg"}),(0,xn.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate300)})]}),e.rate500&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-600",children:"+500 kg"}),(0,xn.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate500)})]}),e.rate1000&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-600",children:"+1000 kg"}),(0,xn.jsx)("div",{className:"text-xl font-bold mt-1",children:M(e.rate1000)})]})]}),c&&(0,xn.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.rate20GP&&(0,xn.jsxs)("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs font-semibold text-blue-700",children:"20' GP"}),(0,xn.jsx)("div",{className:"text-2xl font-bold text-blue-800 mt-1",children:M(e.rate20GP)})]}),e.rate40GP&&(0,xn.jsxs)("div",{className:"bg-indigo-50 border-2 border-indigo-400 rounded-lg p-4 text-center shadow-sm",children:[(0,xn.jsx)("div",{className:"text-xs font-semibold text-indigo-700",children:"40' GP"}),(0,xn.jsx)("div",{className:"text-2xl font-bold text-indigo-600 mt-1",children:M(e.rate40GP)})]}),e.rate40HQ&&(0,xn.jsxs)("div",{className:"bg-purple-50 border border-purple-300 rounded-lg p-4 text-center",children:[(0,xn.jsx)("div",{className:"text-xs font-semibold text-purple-700",children:"40' HQ"}),(0,xn.jsx)("div",{className:"text-2xl font-bold text-purple-800 mt-1",children:M(e.rate40HQ)})]})]}),d&&e.lclRate&&(0,xn.jsxs)("div",{className:"bg-emerald-50 border-2 border-emerald-400 rounded-lg p-4 text-center max-w-xs",children:[(0,xn.jsx)("div",{className:"text-sm font-semibold text-emerald-700",children:"LCL Rate per CBM"}),(0,xn.jsx)("div",{className:"text-3xl font-bold text-emerald-600 mt-2",children:M(e.lclRate)})]}),x&&!l&&!c&&!d&&(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsx)("p",{className:"text-sm text-slate-600 mb-3",children:"All rate fields from Excel:"}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[e.rate45Minus&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"-45 kg"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate45Minus)})]}),e.rate45MinusM&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Min (M)"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate45MinusM)})]}),e.rate45Plus&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"+45 kg"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate45Plus)})]}),e.rate100&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"+100 kg"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate100)})]}),e.rate300&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"+300 kg"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate300)})]}),e.rate500&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"+500 kg"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate500)})]}),e.rate1000&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"+1000 kg"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate1000)})]}),e.rate20GP&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"20' GP"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate20GP)})]}),e.rate40GP&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"40' GP"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate40GP)})]}),e.rate40HQ&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"40' HQ"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.rate40HQ)})]}),e.lclRate&&(0,xn.jsxs)("div",{className:"bg-slate-50 rounded p-3",children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"LCL per CBM"}),(0,xn.jsx)("div",{className:"text-lg font-bold",children:M(e.lclRate)})]})]})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h4",{className:"text-sm font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(zn,{className:"w-4 h-4"})," Additional Information"]}),(0,xn.jsxs)("div",{className:"bg-white rounded-lg p-5 space-y-4",children:[e.routing&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Routing"}),(0,xn.jsx)("div",{className:"text-sm font-medium",children:e.routing})]}),e.surcharges&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Surcharges"}),(0,xn.jsx)("div",{className:"text-sm font-medium",children:e.surcharges})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t border-slate-100",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Created"}),(0,xn.jsx)("div",{className:"text-sm font-medium",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:"Owner"}),(0,xn.jsx)("div",{className:"text-sm font-medium",children:e.owner||"\u2014"})]})]})]})]})]})})]})},e.sysID||e.id)})]}),!W&&!f&&0===H.length&&(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-12 text-center",children:[(0,xn.jsx)(Ea,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,xn.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No rates found"}),(0,xn.jsx)("p",{className:"text-slate-500 mb-6",children:x?"No rates available for ".concat(x,". Upload an Excel file to get started."):c?"Try adjusting your search":"Create your first rate"}),!c&&!x&&(0,xn.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),"Create New Rate"]}),x&&(0,xn.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-6 py-3 ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-lg hover:opacity-90"),children:[(0,xn.jsx)(Za,{className:"w-5 h-5"}),"Upload Excel for ",x]})]}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:F,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg",children:(0,xn.jsx)(kb,{className:"w-5 h-5 ".concat(W?"animate-spin":"")})})})]}),j&&(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,xn.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,xn.jsx)("div",{className:"".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," p-6 text-white"),children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)(Xa,{className:"w-8 h-8"}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h2",{className:"text-2xl font-bold",children:["Upload Rates for ",x]}),(0,xn.jsx)("p",{className:"text-sm opacity-90 mt-1",children:"Upload an Excel file with your rate data"})]})]}),(0,xn.jsx)("button",{onClick:()=>{k(!1),A(null)},className:"p-2 hover:bg-white/20 rounded-lg transition-all",children:(0,xn.jsx)(Ln,{className:"w-6 h-6"})})]})}),(0,xn.jsxs)("div",{className:"p-6 space-y-6",children:[(0,xn.jsxs)("div",{className:"border-2 border-dashed border-slate-300 rounded-xl p-8 text-center hover:border-indigo-400 transition-all",children:[(0,xn.jsx)("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls",onChange:e=>{const t=e.target.files[0];if(t){if(!t.name.match(/\.(xlsx|xls)$/))return void alert("Please upload a valid Excel file (.xlsx or .xls)");A(t)}},className:"hidden"}),(0,xn.jsxs)("label",{htmlFor:"excel-upload",className:"cursor-pointer",children:[(0,xn.jsx)(Za,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),(0,xn.jsx)("p",{className:"text-lg font-semibold text-slate-700 mb-2",children:S?S.name:"Click to upload or drag and drop"}),(0,xn.jsx)("p",{className:"text-sm text-slate-500",children:"Excel files (.xlsx, .xls) only"})]})]}),(0,xn.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,xn.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,xn.jsxs)("h4",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[(0,xn.jsx)(zn,{className:"w-5 h-5"}),"Upload Instructions"]}),(0,xn.jsxs)("button",{onClick:()=>{const e=[{freightType:"SEA-EXPORT-FCL",origin:"COLOMBO",destination:"CHENNAI",airline:"",liner:x||"MSC",route:"CMB-MAA",surcharges:"FSC: $50, THC: $100",transitTime:5,transshipmentTime:"",frequency:"3x Weekly",routingType:"DIRECT",validateDate:"2025-12-31",note:"Sample note",remark:"",owner:"John Doe",currency:"USD",category:x||"MSC",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:850,rate40GP:1200,rate40HQ:1300,lclRate:""},{freightType:"AIR-IMPORT",origin:"DUBAI",destination:"COLOMBO",airline:"EMIRATES",liner:"",route:"DXB-CMB",surcharges:"",transitTime:1,transshipmentTime:"",frequency:"Daily",routingType:"DIRECT",validateDate:"2025-06-30",note:"",remark:"Contact sales for bulk",owner:"Jane Smith",currency:"USD",category:x||"MSC",rate45Minus:3.5,rate45MinusM:200,rate45Plus:3.2,rate100:2.8,rate300:2.5,rate500:2.2,rate1000:2,rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:""},{freightType:"SEA-EXPORT-LCL",origin:"COLOMBO",destination:"SINGAPORE",airline:"",liner:x||"MSC",route:"CMB-SIN",surcharges:"",transitTime:7,transshipmentTime:"2 days",frequency:"2x Weekly",routingType:"TRANSSHIPMENT",validateDate:"2025-09-30",note:"",remark:"",owner:"Admin",currency:"USD",category:x||"MSC",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:55}],t=Rx.json_to_sheet(e);t["!cols"]=[{wch:18},{wch:12},{wch:12},{wch:15},{wch:12},{wch:12},{wch:20},{wch:12},{wch:15},{wch:12},{wch:15},{wch:12},{wch:20},{wch:20},{wch:12},{wch:10},{wch:10},{wch:12},{wch:12},{wch:12},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10}];const r=Rx.book_new();Rx.book_append_sheet(r,t,"Rates Template"),function(e,t,r){var n=r||{};n.type="file",n.file=t,kx(n),jx(e,n)}(r,"".concat(x||"Liner","_Rates_Template.xlsx"))},className:"text-sm bg-blue-600 text-white px-3 py-1.5 rounded-lg hover:bg-blue-700 transition-all flex items-center gap-1.5",children:[(0,xn.jsx)(Xa,{className:"w-4 h-4"}),"Download Template"]})]}),(0,xn.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1 ml-6 list-disc",children:[(0,xn.jsx)("li",{children:"Download the Excel template to see the required format"}),(0,xn.jsx)("li",{children:"Ensure your Excel file has a header row with column names"}),(0,xn.jsx)("li",{children:"Include columns like: Origin, Destination, Rate fields, Currency, etc."}),(0,xn.jsxs)("li",{children:["All rows will be automatically tagged with category: ",x]}),(0,xn.jsx)("li",{children:"Rate fields (rate45Plus, rate20GP, etc.) will be stored in rateDataJson"})]})]}),(0,xn.jsxs)("div",{className:"flex gap-3",children:[(0,xn.jsx)("button",{onClick:()=>{k(!1),A(null)},className:"flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-all",children:"Cancel"}),(0,xn.jsx)("button",{onClick:async()=>{if(S&&x){_(!0);try{console.log("Starting Excel upload for:",x);const e=bx(await S.arrayBuffer(),{type:"array"}),t=e.SheetNames[0],r=e.Sheets[t],n=Rx.sheet_to_json(r);if(console.log("Parsed ".concat(n.length," rows from Excel")),console.log("Sample row:",n[0]),console.log("Column headers detected:",Object.keys(n[0]||{})),!n||0===n.length)return alert("Excel file is empty or could not be read. Please check the file format."),void _(!1);const a=n.map((e,t)=>{const r=e.POL||e.pol||e.Origin||e.origin||null,n=e.POD||e.pod||e.Destination||e.destination||null,a=e["20GP USD"]||e["20GP-USD"]||e["20GP_USD"]||e["20GP"]||e.gp20_usd||e.Gp20Usd||null,s=e["40HQ-USD"]||e["40HQ USD"]||e["40HQ_USD"]||e["40HQ"]||e.hq40_usd||e.Hq40Usd||null,i=e["TT/Routing"]||e["TT-Routing"]||e["TT/ROUITNG"]||e.TTRouting||e.tt_routing||e.TtRouting||null;let o=e["VALID "]||e.Valid||e.valid||e.validateDate||e.ValidateDate||null;if("number"===typeof o){const e=new Date(1899,11,30);o=new Date(e.getTime()+864e5*o).toISOString().split("T")[0]}else if(o instanceof Date)o=o.toISOString().split("T")[0];else if("string"===typeof o&&o.includes("/")){const e=o.split("/");3===e.length&&(o="".concat(e[2],"-").concat(e[0].padStart(2,"0"),"-").concat(e[1].padStart(2,"0")))}return r&&n||console.warn("Row ".concat(t+1," missing required fields:"),{pol:r,pod:n,gp20Usd:a,hq40Usd:s}),{Pol:r,Pod:n,Gp20Usd:a?parseFloat(a):null,Hq40Usd:s?parseFloat(s):null,TtRouting:i?String(i):null,Valid:o,Category:x}}),s=a.filter(e=>e.Pol&&e.Pod);if(0===s.length)return alert("No valid rows found. Please ensure Excel has POL and POD columns filled."),void _(!1);if(s.length<a.length){const e=a.length-s.length;console.warn("Skipping ".concat(e," rows with missing POL or POD"))}console.log("Uploading ".concat(s.length," valid rates for ").concat(x)),console.log("Sample transformed data:",s[0]);const i=await fetch("".concat(pn,"/rates/linear/bulk"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Rates:s})}),o=await i.json();if(console.log("Backend response:",o),!i.ok)throw new Error(o.message||"Upload failed");{const e=o.failCount>0?"Uploaded ".concat(o.successCount," rates. ").concat(o.failCount," failed."):"Successfully uploaded ".concat(o.successCount," rates for ").concat(x);alert(e),k(!1),A(null),L(x)}}catch(e){console.error("Error uploading Excel:",e),alert("Failed to upload Excel file: ".concat(e.message,"\n\nPlease check the browser console for details."))}finally{_(!1)}}else alert("Please select an Excel file and ensure a shipping line is selected.")},disabled:!S||C,className:"flex-1 px-6 py-3 ".concat((null===V||void 0===V?void 0:V.color)||"bg-blue-600"," text-white rounded-lg font-medium hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"),children:C?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(kb,{className:"w-5 h-5 animate-spin"}),"Uploading..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Za,{className:"w-5 h-5"}),"Upload & Save"]})})]})]})]})})]})}function Ab(e){let{onClose:t,editRate:r,onSuccess:n}=e;const[a,i]=(0,s.useState)(1),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)({}),[f,m]=(0,s.useState)({origin:"",destination:""}),[p,g]=(0,s.useState)([{id:1,airline:"",liner:"",route:"",currency:"USD",surcharges:"",transitTime:"",transshipmentTime:"",frequency:"",routingType:"DIRECT",validateDate:"",note:"",remark:"",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:""}]);(0,s.useEffect)(()=>{r&&(l(r.freightType||""),i(2),m({origin:r.origin||"",destination:r.destination||""}),g([{id:1,airline:r.airline||"",liner:r.liner||"",route:r.route||"",currency:r.currency||"USD",surcharges:r.surcharges||"",transitTime:r.transitTime||"",transshipmentTime:r.transshipmentTime||"",frequency:r.frequency||"",routingType:r.routingType||"DIRECT",validateDate:r.validateDate||"",note:r.note||"",remark:r.remark||"",rate45Minus:r.rate45Minus||"",rate45MinusM:r.rate45MinusM||"",rate45Plus:r.rate45Plus||"",rate100:r.rate100||"",rate300:r.rate300||"",rate500:r.rate500||"",rate1000:r.rate1000||"",rate20GP:r.rate20GP||"",rate40GP:r.rate40GP||"",rate40HQ:r.rate40HQ||"",lclRate:r.lclRate||""}]))},[r]);const x=e=>{l(e),i(2),r||g([We({id:1},b()),We({id:2},b()),We({id:3},b())])},b=()=>({airline:"",liner:"",route:"",currency:"USD",surcharges:"",transitTime:"",transshipmentTime:"",frequency:"",routingType:"DIRECT",validateDate:"",note:"",remark:"",rate45Minus:"",rate45MinusM:"",rate45Plus:"",rate100:"",rate300:"",rate500:"",rate1000:"",rate20GP:"",rate40GP:"",rate40HQ:"",lclRate:""}),v=()=>{const e=Math.max(...p.map(e=>e.id))+1;g([...p,We({id:e},b())])},y=e=>{const{name:t,value:r}=e.target;m(e=>We(We({},e),{},{[t]:r}))},w=(e,t,r)=>{g(p.map(n=>n.id===e?We(We({},n),{},{[t]:r}):n))},N=async e=>{if(e.preventDefault(),(()=>{const e={};return f.origin||(e.origin="Origin is required"),f.destination||(e.destination="Destination is required"),p.some(e=>e.route||e.airline||e.liner||o.includes("air")&&(e.rate45Plus||e.rate100)||o.includes("fcl")&&(e.rate20GP||e.rate40GP)||o.includes("lcl")&&e.lclRate)||(e.routes="At least one route must have data"),p.forEach((t,r)=>{(t.route||t.airline||t.liner||o.includes("air")&&(t.rate45Plus||t.rate100)||o.includes("fcl")&&(t.rate20GP||t.rate40GP)||o.includes("lcl")&&t.lclRate)&&(t.note&&""!==t.note.trim()||(e["route_".concat(t.id,"_note")]="Note is required"),!o.includes("air")||t.remark&&""!==t.remark.trim()||(e["route_".concat(t.id,"_remark")]="Remark is required for air freight"))}),h(e),0===Object.keys(e).length})()){d(!0);try{if(r){const e=p[0],t={freightType:o,origin:f.origin,destination:f.destination,currency:e.currency,airline:e.airline||null,liner:e.liner||null,route:e.route||null,surcharges:e.surcharges||null,transitTime:e.transitTime||null,transshipmentTime:e.transshipmentTime||null,frequency:e.frequency||null,routingType:e.routingType||"DIRECT",validateDate:e.validateDate||null,note:e.note||null,remark:e.remark||null,rateDataJson:JSON.stringify({rate45Minus:e.rate45Minus||null,rate45MinusM:e.rate45MinusM||null,rate45Plus:e.rate45Plus||null,rate100:e.rate100||null,rate300:e.rate300||null,rate500:e.rate500||null,rate1000:e.rate1000||null,rate20GP:e.rate20GP||null,rate40GP:e.rate40GP||null,rate40HQ:e.rate40HQ||null,lclRate:e.lclRate||null})};await Va(r.id,t),n()}else{const e=p.filter(e=>e.route||e.airline||e.liner||o.includes("air")&&(e.rate45Plus||e.rate100)||o.includes("fcl")&&(e.rate20GP||e.rate40GP)||o.includes("lcl")&&e.lclRate).map(e=>{const t={freightType:o,origin:f.origin,destination:f.destination,currency:e.currency,airline:e.airline||null,liner:e.liner||null,route:e.route||null,surcharges:e.surcharges||null,transitTime:e.transitTime||null,transshipmentTime:e.transshipmentTime||null,frequency:e.frequency||null,routingType:e.routingType||"DIRECT",validateDate:e.validateDate||null,note:e.note||null,remark:e.remark||null,rateDataJson:JSON.stringify({rate45Minus:e.rate45Minus||null,rate45MinusM:e.rate45MinusM||null,rate45Plus:e.rate45Plus||null,rate100:e.rate100||null,rate300:e.rate300||null,rate500:e.rate500||null,rate1000:e.rate1000||null,rate20GP:e.rate20GP||null,rate40GP:e.rate40GP||null,rate40HQ:e.rate40HQ||null,lclRate:e.lclRate||null})};return console.log("Creating rate with payload:",t),Wa(t)});await Promise.all(e),n()}}catch(t){console.error("Error saving rates:",t),h({submit:"Failed to save rates. Please try again."})}finally{d(!1)}}},j=(e,t)=>{const r=o.includes("air"),n=o.includes("fcl"),a=o.includes("lcl");return(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-xl p-6 border-2 border-slate-200",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,xn.jsxs)("h4",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,xn.jsx)(Ca,{className:"w-5 h-5 text-indigo-600"}),"Route ",t+1]}),p.length>1&&(0,xn.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void(p.length>1&&g(p.filter(e=>e.id!==t)));var t},className:"p-2 hover:bg-red-50 rounded-lg transition-colors group",title:"Remove route",children:(0,xn.jsx)(Pa,{className:"w-5 h-5 text-slate-600 group-hover:text-red-600"})})]}),(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Airline"}),(0,xn.jsx)("input",{type:"text",value:e.airline,onChange:t=>w(e.id,"airline",t.target.value),placeholder:"Enter airline",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),!r&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Liner"}),(0,xn.jsx)("input",{type:"text",value:e.liner,onChange:t=>w(e.id,"liner",t.target.value),placeholder:"Enter liner",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Route"}),(0,xn.jsx)("input",{type:"text",value:e.route,onChange:t=>w(e.id,"route",t.target.value),placeholder:"e.g., CMB-SIN-BKK",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Currency"}),(0,xn.jsxs)("select",{value:e.currency,onChange:t=>w(e.id,"currency",t.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,xn.jsx)("option",{value:"USD",children:"USD"}),(0,xn.jsx)("option",{value:"EUR",children:"EUR"}),(0,xn.jsx)("option",{value:"GBP",children:"GBP"}),(0,xn.jsx)("option",{value:"LKR",children:"LKR"}),(0,xn.jsx)("option",{value:"AED",children:"AED"}),(0,xn.jsx)("option",{value:"SGD",children:"SGD"}),(0,xn.jsx)("option",{value:"CNY",children:"CNY"}),(0,xn.jsx)("option",{value:"JPY",children:"JPY"}),(0,xn.jsx)("option",{value:"AUD",children:"AUD"}),(0,xn.jsx)("option",{value:"CAD",children:"CAD"})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Routing Type"}),(0,xn.jsxs)("select",{value:e.routingType,onChange:t=>w(e.id,"routingType",t.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,xn.jsx)("option",{value:"DIRECT",children:"Direct"}),(0,xn.jsx)("option",{value:"TRANSSHIP",children:"Transship"})]})]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transit Time"}),(0,xn.jsx)("input",{type:"text",value:e.transitTime,onChange:t=>w(e.id,"transitTime",t.target.value),placeholder:"e.g., 5-7 days",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),r&&(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transshipment Time"}),(0,xn.jsx)("input",{type:"text",value:e.transshipmentTime,onChange:t=>w(e.id,"transshipmentTime",t.target.value),placeholder:"e.g., 2-3 hours",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Frequency"}),(0,xn.jsx)("input",{type:"text",value:e.frequency,onChange:t=>w(e.id,"frequency",t.target.value),placeholder:"e.g., Daily, 3x weekly",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Surcharges"}),(0,xn.jsx)("input",{type:"text",value:e.surcharges,onChange:t=>w(e.id,"surcharges",t.target.value),placeholder:"Enter applicable surcharges",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-slate-500"}),"Valid Until"]}),(0,xn.jsx)("input",{type:"date",value:e.validateDate,onChange:t=>w(e.id,"validateDate",t.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),r&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h5",{className:"font-medium text-slate-700 text-sm uppercase tracking-wide",children:"Air Freight Rates (USD/KG)"}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"-45 KG"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate45Minus,onChange:t=>w(e.id,"rate45Minus",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"-45 KG (M)"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate45MinusM,onChange:t=>w(e.id,"rate45MinusM",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+45 KG"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate45Plus,onChange:t=>w(e.id,"rate45Plus",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+100 KG"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate100,onChange:t=>w(e.id,"rate100",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+300 KG"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate300,onChange:t=>w(e.id,"rate300",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+500 KG"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate500,onChange:t=>w(e.id,"rate500",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:"+1000 KG"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate1000,onChange:t=>w(e.id,"rate1000",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"})]})]})]}),r&&(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Remark ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",value:e.remark,onChange:t=>w(e.id,"remark",t.target.value),placeholder:"Additional remarks for this rate",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat(u["route_".concat(e.id,"_remark")]?"border-red-500":"border-slate-300")}),u["route_".concat(e.id,"_remark")]&&(0,xn.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u["route_".concat(e.id,"_remark")]})]}),n&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h5",{className:"font-medium text-slate-700 text-sm uppercase tracking-wide",children:"FCL Container Rates (USD)"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"20' GP"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate20GP,onChange:t=>w(e.id,"rate20GP",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' GP"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate40GP,onChange:t=>w(e.id,"rate40GP",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"40' HQ"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.rate40HQ,onChange:t=>w(e.id,"rate40HQ",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})]}),a&&(0,xn.jsxs)("div",{className:"space-y-4",children:[(0,xn.jsx)("h5",{className:"font-medium text-slate-700 text-sm uppercase tracking-wide",children:"LCL Rate"}),(0,xn.jsxs)("div",{className:"md:w-1/3",children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"LCL Rate (USD/CBM or W/M)"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.lclRate,onChange:t=>w(e.id,"lclRate",t.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Note ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("textarea",{value:e.note,onChange:t=>w(e.id,"note",t.target.value),placeholder:"Additional notes for this rate...",rows:3,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none ".concat(u["route_".concat(e.id,"_note")]?"border-red-500":"border-slate-300")}),u["route_".concat(e.id,"_note")]&&(0,xn.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u["route_".concat(e.id,"_note")]})]})]})]},e.id)};return(0,xn.jsxs)("div",{className:"w-full max-w-7xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-6 flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:o.includes("air")?(0,xn.jsx)(ya,{className:"w-6 h-6 text-white"}):(0,xn.jsx)(Na,{className:"w-6 h-6 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h2",{className:"text-2xl font-bold text-white",children:r?"Edit Rate":"Create New Rate"}),2===a&&(0,xn.jsx)("p",{className:"text-indigo-100 text-sm mt-1",children:o.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:(0,xn.jsx)(Ln,{className:"w-6 h-6 text-white"})})]}),(0,xn.jsxs)("div",{className:"p-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[1===a&&(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"text-center mb-8",children:[(0,xn.jsx)("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Select Freight Type"}),(0,xn.jsx)("p",{className:"text-slate-600",children:"Choose the type of freight service for this rate"})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsx)("button",{onClick:()=>x("air-import"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-sky-500 hover:bg-sky-50 transition-all group",children:(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center group-hover:bg-sky-500 transition-colors",children:(0,xn.jsx)(ya,{className:"w-6 h-6 text-sky-600 group-hover:text-white"})}),(0,xn.jsxs)("div",{className:"text-left",children:[(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Air Import"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Inbound air freight rates"})]})]})}),(0,xn.jsx)("button",{onClick:()=>x("air-export"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-sky-500 hover:bg-sky-50 transition-all group",children:(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center group-hover:bg-sky-500 transition-colors",children:(0,xn.jsx)(ya,{className:"w-6 h-6 text-sky-600 group-hover:text-white"})}),(0,xn.jsxs)("div",{className:"text-left",children:[(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Air Export"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Outbound air freight rates"})]})]})}),(0,xn.jsx)("button",{onClick:()=>x("sea-import-fcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,xn.jsx)(Na,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,xn.jsxs)("div",{className:"text-left",children:[(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Import FCL"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Full container load import"})]})]})}),(0,xn.jsx)("button",{onClick:()=>x("sea-import-lcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,xn.jsx)(wa,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,xn.jsxs)("div",{className:"text-left",children:[(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Import LCL"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Less than container load import"})]})]})}),(0,xn.jsx)("button",{onClick:()=>x("sea-export-fcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,xn.jsx)(Na,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,xn.jsxs)("div",{className:"text-left",children:[(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Export FCL"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Full container load export"})]})]})}),(0,xn.jsx)("button",{onClick:()=>x("sea-export-lcl"),className:"p-6 border-2 border-slate-200 rounded-xl hover:border-blue-600 hover:bg-blue-50 transition-all group",children:(0,xn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:(0,xn.jsx)(wa,{className:"w-6 h-6 text-blue-600 group-hover:text-white"})}),(0,xn.jsxs)("div",{className:"text-left",children:[(0,xn.jsx)("h4",{className:"font-semibold text-slate-800",children:"Sea Export LCL"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:"Less than container load export"})]})]})})]})]}),2===a&&(0,xn.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 border-2 border-indigo-200",children:[(0,xn.jsxs)("h4",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(_a,{className:"w-5 h-5 text-indigo-600"}),"Route Information"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Origin ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",name:"origin",value:f.origin,onChange:y,placeholder:"e.g., CMB, Colombo",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat(u.origin?"border-red-500":"border-slate-300")}),u.origin&&(0,xn.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u.origin})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Destination ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",name:"destination",value:f.destination,onChange:y,placeholder:"e.g., SIN, Singapore",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat(u.destination?"border-red-500":"border-slate-300")}),u.destination&&(0,xn.jsx)("p",{className:"text-red-500 text-xs mt-1",children:u.destination})]})]})]}),(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("h4",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:["Create New Rate",p.length>1?"s":"",(0,xn.jsxs)("span",{className:"text-sm font-normal text-slate-600",children:["(",p.length," route",p.length>1?"s":"",")"]})]}),(0,xn.jsxs)("button",{type:"button",onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors text-sm",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),"Add Route"]})]}),u.routes&&(0,xn.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:(0,xn.jsxs)("div",{className:"flex items-start gap-3",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,xn.jsx)("p",{className:"text-red-700 text-sm",children:u.routes})]})}),p.map((e,t)=>j(e,t))]}),u.submit&&(0,xn.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:(0,xn.jsxs)("div",{className:"flex items-start gap-3",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,xn.jsx)("p",{className:"text-red-700 text-sm",children:u.submit})]})}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-3 pt-6 border-t border-slate-200",children:[(0,xn.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all font-medium",disabled:c,children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",disabled:c,className:"px-6 py-3 text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 rounded-lg transition-all font-medium flex items-center gap-2 justify-center",children:c?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r?"Updating...":"Saving Rates..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(qa,{className:"w-4 h-4"}),r?"Update Rate":"Save ".concat(p.length," Rate").concat(p.length>1?"s":"")]})})]})]})]})]})}function Cb(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(0),c=()=>{t(!1),i(null)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(Sb,{modalOpen:()=>{i(null),t(!0)},onEditRate:e=>{i(e),t(!0)},refreshTrigger:o})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:c}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Ab,{onClose:c,editRate:a,onSuccess:()=>{l(e=>e+1),c()}})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const _b=En("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Tb=En("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Eb=async e=>(await mn.put("".concat(pn,"/Activity"),e)).data,Lb=async e=>(await mn.post("".concat(pn,"/Statuslog"),e)).data;function Pb(e){let{onOpen:t,onEdit:r,loading:n=!1,delay:a=0,activities:i,loadActivities:o,setActivities:l}=e;const[c,d]=(0,s.useState)(n),[u,h]=(0,s.useState)(""),[f,m]=(0,s.useState)(new Set),[p,g]=(0,s.useState)(new Set),[x,b]=(0,s.useState)({}),[v,y]=(0,s.useState)({}),w=async e=>{if(!x[e]){y(t=>We(We({},t),{},{[e]:!0}));try{const t=await(async e=>(await mn.get("".concat(pn,"/Statuslog/").concat(e))).data)(e);b(r=>We(We({},r),{},{[e]:t}))}catch(t){console.error("Error fetching activity history:",t),h("Failed to load activity history. Please try again.")}finally{y(t=>We(We({},t),{},{[e]:!1}))}}},N=async e=>{const t=new Set(p);t.has(e)?t.delete(e):(t.add(e),await w(e)),g(t)},j=e=>{r&&r(e.rawData)},k=async e=>{if(window.confirm("Are you sure you want to delete this activity?"))try{await(async e=>(await mn.delete("".concat(pn,"/Activity/").concat(e))).data)(e),l(i.filter(t=>t.id!==e)),m(t=>{const r=new Set(t);return r.delete(e),r})}catch(t){console.error("Error deleting activity:",t),h("Failed to delete activity. Please try again.")}},S=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),A=()=>(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded w-24"}),(0,xn.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("div",{className:"min-w-full",children:[(0,xn.jsx)("div",{className:"grid grid-cols-8 gap-4 p-4 bg-slate-50 border-b border-slate-200",children:Array.from({length:8}).map((e,t)=>(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))}),Array.from({length:3}).map((e,t)=>(0,xn.jsx)("div",{className:"grid grid-cols-8 gap-4 p-4 border-b border-slate-100",children:Array.from({length:8}).map((e,t)=>(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded"},t))},t))]})})]}),C=e=>{let{status:t,color:r}=e;return(0,xn.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(r),children:["completed"===t?(0,xn.jsx)(_b,{className:"w-3 h-3"}):"in-progress"===t?(0,xn.jsx)(sa,{className:"w-3 h-3"}):(0,xn.jsx)(Tb,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"capitalize",children:t})]})},_=e=>{let{priority:t}=e;const r="high"===t?"bg-red-400":"medium"===t?"bg-amber-400":"bg-green-400";return(0,xn.jsx)("div",{className:"w-2 h-8 rounded-full ".concat(r)})},T=e=>{let{name:t}=e;const r=["bg-blue-500","bg-purple-500","bg-pink-500","bg-green-500","bg-indigo-500","bg-red-500"],n=t.split("").reduce((e,t)=>e+t.charCodeAt(0),0),a=r[n%r.length];return(0,xn.jsx)("div",{className:"".concat(a," text-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm text-xs font-semibold"),children:t.charAt(0).toUpperCase()})},E=e=>{let{activityId:t}=e;const r=x[t]||[];return v[t]?(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"10",className:"px-4 py-3 bg-slate-50",children:(0,xn.jsxs)("div",{className:"flex items-center justify-center gap-2 text-slate-500",children:[(0,xn.jsx)(kb,{className:"w-4 h-4 animate-spin"}),(0,xn.jsx)("span",{className:"text-sm",children:"Loading history..."})]})})}):r&&0!==r.length?(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"10",className:"px-4 py-3 bg-slate-50",children:(0,xn.jsxs)("div",{className:"space-y-3",children:[(0,xn.jsx)("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Activity History"}),(0,xn.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,xn.jsx)("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:(0,xn.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,xn.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)(C,{status:e.new_status,color:"completed"===e.new_status?"bg-green-500":"in-progress"===e.new_status?"bg-blue-500":"bg-slate-500"}),(0,xn.jsx)("span",{className:"text-xs text-slate-500",children:S(e.created_at)})]}),e.note&&(0,xn.jsx)("p",{className:"text-sm text-slate-600 pl-1",children:e.note})]})})},e.sysID))})]})})}):(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"10",className:"px-4 py-3 bg-slate-50",children:(0,xn.jsx)("div",{className:"text-center text-sm text-slate-500",children:"No history available"})})})};return c?(0,xn.jsx)(A,{}):(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300 animate-slideInLeft",style:{animationDelay:"".concat(a,"ms"),animationFillMode:"both"},children:[u&&(0,xn.jsxs)("div",{className:"p-4 bg-red-50 border-b border-red-200 flex items-start gap-3",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,xn.jsx)("div",{children:(0,xn.jsx)("p",{className:"text-sm text-red-800",children:u})})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("div",{className:"min-w-full",children:[(0,xn.jsx)("div",{className:"hidden lg:block",children:(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-4 py-3 text-left w-12"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Activity"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Type"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Owner"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Start Time"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"End Time"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Status"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Related Item"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-100",children:i.map(e=>{const t=e.typeIcon,r=p.has(e.id);return(0,xn.jsxs)(s.Fragment,{children:[(0,xn.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)("button",{onClick:()=>N(e.id),className:"p-1 hover:bg-slate-200 rounded transition-all",title:r?"Collapse history":"Expand history",children:(0,xn.jsx)(bb,{className:"w-4 h-4 text-slate-500 transition-transform duration-200 ".concat(r?"rotate-90":"")})})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)("div",{className:"flex items-center gap-2",children:(0,xn.jsx)(_,{priority:e.priority})})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(t,{className:"w-4 h-4 text-slate-500"}),(0,xn.jsx)("span",{className:"font-medium text-slate-900",children:e.title})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(e.typeColor),children:[(0,xn.jsx)(t,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.type})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(T,{name:e.owner})}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600 whitespace-nowrap",children:e.startTime}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600 whitespace-nowrap",children:e.endTime}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(C,{status:e.status,color:e.statusColor})}),(0,xn.jsx)("td",{className:"px-4 py-4 text-sm text-slate-600",children:e.relatedItem}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)("div",{className:"flex items-center gap-2",children:(0,xn.jsx)("button",{onClick:()=>j(e),className:"p-1.5 hover:bg-blue-100 rounded transition-colors",title:"Edit activity",children:(0,xn.jsx)(La,{className:"w-4 h-4 text-blue-600"})})})})]}),r&&(0,xn.jsx)(E,{activityId:e.id})]},e.id)})})]})}),(0,xn.jsx)("div",{className:"lg:hidden p-4 space-y-4",children:i.map(e=>{const t=e.typeIcon,r=p.has(e.id),n=x[e.id]||[],a=v[e.id];return(0,xn.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-start justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,xn.jsx)("button",{onClick:()=>N(e.id),className:"p-1 hover:bg-slate-200 rounded transition-all",children:(0,xn.jsx)(bb,{className:"w-4 h-4 text-slate-500 transition-transform duration-200 ".concat(r?"rotate-90":"")})}),(0,xn.jsx)(_,{priority:e.priority}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(t,{className:"w-4 h-4 text-slate-500"}),(0,xn.jsx)("h3",{className:"font-medium text-slate-900",children:e.title})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[(0,xn.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white ".concat(e.typeColor),children:[(0,xn.jsx)(t,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.type})]}),(0,xn.jsx)(C,{status:e.status,color:e.statusColor})]})]})]}),(0,xn.jsx)(T,{name:e.owner})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm text-slate-600",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(sa,{className:"w-4 h-4"}),(0,xn.jsxs)("span",{children:[e.startTime," - ",e.endTime]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(va,{className:"w-4 h-4"}),(0,xn.jsxs)("span",{children:["Related: ",e.relatedItem]})]})]}),r&&(0,xn.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-300",children:a?(0,xn.jsxs)("div",{className:"flex items-center justify-center gap-2 text-slate-500 py-4",children:[(0,xn.jsx)(kb,{className:"w-4 h-4 animate-spin"}),(0,xn.jsx)("span",{className:"text-sm",children:"Loading history..."})]}):0===n.length?(0,xn.jsx)("div",{className:"text-center text-sm text-slate-500 py-4",children:"No history available"}):(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsx)("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Activity History"}),n.map(e=>(0,xn.jsx)("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)(C,{status:e.new_status,color:"completed"===e.new_status?"bg-green-500":"in-progress"===e.new_status?"bg-blue-500":"bg-slate-500"}),(0,xn.jsx)("span",{className:"text-xs text-slate-500",children:S(e.created_at)})]}),e.note&&(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:e.note})]})},e.sysID))]})}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,xn.jsxs)("button",{onClick:()=>j(e),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-100 text-blue-600 rounded transition-colors hover:bg-blue-200",children:[(0,xn.jsx)(La,{className:"w-4 h-4"}),"Edit"]}),(0,xn.jsxs)("button",{onClick:()=>k(e.id),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-red-100 text-red-600 rounded transition-colors hover:bg-red-200",children:[(0,xn.jsx)(Pa,{className:"w-4 h-4"}),"Delete"]})]})]},e.id)})})]})}),0===i.length&&!u&&(0,xn.jsxs)("div",{className:"text-center py-12",children:[(0,xn.jsx)(Ta,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),(0,xn.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No activities yet"}),(0,xn.jsx)("p",{className:"text-slate-500 mb-4",children:"Get started by creating your first activity"}),t&&(0,xn.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),"Add Activity"]})]})]})}function Ob(e){let{modalOpen:t,onEdit:r,activities:n,setActivities:a,loadActivities:i}=e;const[o,l]=(0,s.useState)(!0),[c,d]=(0,s.useState)("");(0,s.useEffect)(()=>{const e=setTimeout(()=>{l(!1)},1500);return()=>clearTimeout(e)},[]);return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,xn.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,xn.jsx)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(o?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Ta,{className:"w-6 h-6 text-blue-600"}),(0,xn.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Sales Plans"})]})})}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(o?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,xn.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),(0,xn.jsx)("span",{children:"New Activity"})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",children:[(0,xn.jsx)(Qn,{className:"w-4 h-4 text-slate-600"}),(0,xn.jsx)("span",{children:"Filter"}),(0,xn.jsx)(ua,{className:"w-4 h-4 text-slate-400"})]})]}),(0,xn.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search activities...",value:c,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}),(0,xn.jsx)("div",{className:"space-y-6",children:(0,xn.jsx)(Pb,{onOpen:t,onEdit:r,loading:!1,delay:300,activities:n,setActivities:a,loadActivities:i})}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:()=>{l(!0),setTimeout(()=>l(!1),1500)},className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Activities",children:(0,xn.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(o?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,xn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,xn.jsx)("div",{className:"h-8"})]})]})}function Fb(e){let{onClose:t,initialActivity:r=null,isEditMode:n=!1,noteModalOpen:a,isSuccesssNote:i,setCurrentStatus:o}=e;const{user:l}=(0,s.useContext)(bn),[c,d]=(0,s.useState)({id:(null===r||void 0===r?void 0:r.id)||null,activityName:(null===r||void 0===r?void 0:r.activity_name)||"",activityType:(null===r||void 0===r?void 0:r.activity_type)||"",owner:(null===r||void 0===r?void 0:r.owner)||"",startTime:(null===r||void 0===r?void 0:r.start_time)||"",endTime:(null===r||void 0===r?void 0:r.end_time)||"",status:(null===r||void 0===r?void 0:r.status)||"",relatedAccount:(null===r||void 0===r?void 0:r.related_account)||"",rescheduleDate:(null===r||void 0===r?void 0:r.reschedule_date)||""}),[u,h]=(0,s.useState)({}),[f,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(""),[x,b]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[j,k]=(0,s.useState)([]),[S,A]=(0,s.useState)([]),[C,_]=(0,s.useState)(!1),[T,E]=(0,s.useState)(""),L=(0,s.useRef)(null),P=(0,s.useRef)(null);(0,s.useEffect)(()=>{(async()=>{try{const e=await db();k(e)}catch(e){console.error("Error loading accounts:",e)}})()},[]),(0,s.useEffect)(()=>{if(n)"completed"===(null===r||void 0===r?void 0:r.status)&&N(!0),null!==r&&void 0!==r&&r.related_account&&E(r.related_account);else{const e=new Date,t=e=>String(e).padStart(2,"0"),r=[e.getFullYear(),t(e.getMonth()+1),t(e.getDate())].join("-")+"T"+[t(e.getHours()),t(e.getMinutes())].join(":");d(e=>We(We({},e),{},{startTime:r,status:"planned"}))}},[n,r]),(0,s.useEffect)(()=>{i&&(console.log("dan trigger function!!"),R())},[i]),(0,s.useEffect)(()=>{b((null===r||void 0===r?void 0:r.status)||""),console.log(r)},[r]),(0,s.useEffect)(()=>{const e=e=>{P.current&&!P.current.contains(e.target)&&L.current&&!L.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const O=e=>{const{name:t,value:r}=e.target;d(e=>We(We({},e),{},{[t]:r})),u[t]&&h(e=>We(We({},e),{},{[t]:""})),p&&g("")},F=()=>{const e={};return c.activityName.trim()||(e.activityName="Activity name is required"),c.activityType||(e.activityType="Activity type is required"),c.startTime||(e.startTime="Start time is required"),c.status||(e.status="Status is required"),"reschedule"!==c.status||c.rescheduleDate||(e.rescheduleDate="Reschedule date is required when status is Reschedule"),c.startTime&&c.endTime&&c.endTime<=c.startTime&&(e.endTime="End time must be after start time"),h(e),0===Object.keys(e).length},I=e=>e?new Date(e).toISOString():null,R=async()=>{if(F()){m(!0),g("");try{const e=We(We({},n&&{id:c.id}),{},{activityName:c.activityName.trim(),activityType:c.activityType,owner:l.id||null,startTime:I(c.startTime),endTime:c.endTime?I(c.endTime):null,status:c.status,relatedAccount:c.relatedAccount.trim()||null,rescheduleDate:c.rescheduleDate?I(c.rescheduleDate):null});console.log("yes it's bypass!");const r=await Eb(e);console.log("Activity updated successfully:",r),t(r),window.location.reload()}catch(a){var e,r;console.error("Error submitting form:",a),g((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||a.message||"An error occurred while saving the activity. Please try again.")}finally{m(!1)}}},D=async e=>{if(e.preventDefault(),w)g("Completed activities cannot be edited");else if(F()){if(n&&x!==c.status&&!v)return console.log("Status changed - opening notes modal"),o({status:c.status,activity_id:c.id,rescheduleDate:c.rescheduleDate}),void a();console.log("yes it's bypass!"),m(!0),g("");try{const e=We(We({},n&&{id:c.id}),{},{activityName:c.activityName.trim(),activityType:c.activityType,owner:l.id||null,startTime:I(c.startTime),endTime:c.endTime?I(c.endTime):null,status:c.status,relatedAccount:c.relatedAccount.trim()||null,rescheduleDate:c.rescheduleDate?I(c.rescheduleDate):null});let r;if(n)r=await Eb(e),console.log("Activity updated successfully:",r);else if(r=await(async e=>(await mn.post("".concat(pn,"/Activity"),e)).data)(e),console.log("Activity created successfully:",r),r.activityId){const e={new_status:"planned",note:"Activity created and planned",activity_id:r.activityId};console.log(e);const t=await Lb(e);console.log(t)}t(r),window.location.reload()}catch(i){var r,s;console.error("Error submitting form:",i),g((null===(r=i.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||i.message||"An error occurred while saving the activity. Please try again.")}finally{m(!1)}}},M=(()=>{if(!n)return[];const e=[{value:"in_progress",label:"In Progress",color:"bg-blue-500",canRepeat:!0},{value:"completed",label:"Completed",color:"bg-green-500",canRepeat:!1},{value:"cancelled",label:"Cancelled",color:"bg-red-500",canRepeat:!1},{value:"reschedule",label:"Reschedule",color:"bg-amber-500",canRepeat:!0}];return"completed"===x?[{value:"completed",label:"Completed",color:"bg-green-500",canRepeat:!1}]:"cancelled"===x?e.filter(e=>["cancelled","reschedule"].includes(e.value)):e})();return(0,xn.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(Ta,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:n?"Edit Activity":"Create New Activity"}),w&&(0,xn.jsx)("p",{className:"text-sm text-green-600 font-medium mt-1",children:"\u2713 This activity is completed and cannot be edited"})]})]}),(0,xn.jsx)("button",{onClick:()=>t(),className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,xn.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[p&&(0,xn.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,xn.jsx)("span",{className:"text-xl",children:"\u26a0\ufe0f"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"font-semibold text-red-800",children:"Error"}),(0,xn.jsx)("p",{className:"text-red-700 text-sm",children:p})]})]}),w&&(0,xn.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-green-600 mt-0.5"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"font-semibold text-green-800",children:"Activity Completed"}),(0,xn.jsx)("p",{className:"text-green-700 text-sm",children:"This activity has been marked as completed. All fields are now read-only."})]})]}),(0,xn.jsx)("form",{onSubmit:D,className:"space-y-6",children:(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{className:"lg:col-span-2",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-blue-600"}),"Activity Name *"]}),(0,xn.jsx)("input",{type:"text",name:"activityName",value:c.activityName,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.activityName?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter a descriptive activity name"}),u.activityName&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.activityName]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ux,{className:"w-4 h-4 text-purple-600"}),"Activity Type *"]}),(0,xn.jsxs)("select",{name:"activityType",value:c.activityType,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.activityType?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,xn.jsx)("option",{value:"",children:"Select activity type"}),[{value:"call",label:"Phone Call",color:"bg-blue-500"},{value:"email",label:"Email",color:"bg-purple-500"},{value:"meeting",label:"Meeting",color:"bg-green-500"},{value:"follow_up",label:"Follow Up",color:"bg-yellow-500"},{value:"presentation",label:"Presentation",color:"bg-pink-500"},{value:"site_visit",label:"Site Visit",color:"bg-indigo-500"},{value:"other",label:"Other",color:"bg-gray-500"}].map(e=>(0,xn.jsx)("option",{value:e.value,children:e.label},e.value))]}),u.activityType&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.activityType]})]}),n&&(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(sa,{className:"w-4 h-4 text-green-600"}),"Status *"]}),(0,xn.jsxs)("select",{name:"status",value:c.status,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.status?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,xn.jsx)("option",{value:"",children:"Select status"}),M.map(e=>(0,xn.jsx)("option",{value:e.value,children:e.label},e.value))]}),u.status&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.status]}),c.status&&(0,xn.jsxs)("div",{className:"mt-2 text-xs text-slate-600 bg-slate-50 p-2 rounded",children:["completed"===c.status&&"\u2713 Activity will be marked as completed and cannot be edited further","cancelled"===c.status&&"\u2717 Activity will be cancelled","in_progress"===c.status&&"\u25b6 Activity is currently in progress","reschedule"===c.status&&"\u23f0 Activity will be rescheduled to a new date"]})]}),n&&"reschedule"===c.status&&(0,xn.jsxs)("div",{className:"lg:col-span-2",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-amber-600"}),"Reschedule Date & Time *"]}),(0,xn.jsx)("input",{type:"datetime-local",name:"rescheduleDate",value:c.rescheduleDate,onChange:O,disabled:w,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":u.rescheduleDate?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400")}),u.rescheduleDate&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.rescheduleDate]})]}),!n&&(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Yn,{className:"w-4 h-4 text-cyan-600"}),"Related Account"]}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("input",{ref:L,type:"text",name:"relatedAccount",value:T,onChange:e=>{const t=e.target.value;if(E(t),d(e=>We(We({},e),{},{relatedAccount:t})),""===t.trim())A([]),_(!1);else{const e=j.filter(e=>{var r,n,a;return(null===(r=e.accountName)||void 0===r?void 0:r.toLowerCase().includes(t.toLowerCase()))||(null===(n=e.companyName)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase()))||(null===(a=e.accountNumber)||void 0===a?void 0:a.toLowerCase().includes(t.toLowerCase()))});A(e),_(!0)}},onFocus:()=>{if(""!==T.trim()){const e=j.filter(e=>{var t,r,n;return(null===(t=e.accountName)||void 0===t?void 0:t.toLowerCase().includes(T.toLowerCase()))||(null===(r=e.companyName)||void 0===r?void 0:r.toLowerCase().includes(T.toLowerCase()))||(null===(n=e.accountNumber)||void 0===n?void 0:n.toLowerCase().includes(T.toLowerCase()))});A(e),_(!0)}},disabled:w,className:"w-full px-4 py-3 pr-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(w?"bg-slate-100 cursor-not-allowed":"border-slate-300 hover:border-slate-400"),placeholder:"Search account by name, company, or number..."}),(0,xn.jsx)(ha,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none"})]}),C&&S.length>0&&(0,xn.jsx)("div",{ref:P,className:"absolute z-50 w-full mt-1 bg-white border border-slate-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:S.map((e,t)=>(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{const t=e.accountName||e.companyName||"Unknown Account";E(t),d(e=>We(We({},e),{},{relatedAccount:t})),_(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors border-b border-slate-100 last:border-b-0 focus:outline-none focus:bg-blue-50",children:(0,xn.jsxs)("div",{className:"flex items-start gap-3",children:[(0,xn.jsx)(Yn,{className:"w-5 h-5 text-cyan-600 mt-0.5 flex-shrink-0"}),(0,xn.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,xn.jsx)("p",{className:"font-semibold text-slate-800 truncate",children:e.accountName||e.companyName||"Unknown Account"}),e.companyName&&e.accountName!==e.companyName&&(0,xn.jsx)("p",{className:"text-sm text-slate-600 truncate",children:e.companyName}),e.accountNumber&&(0,xn.jsxs)("p",{className:"text-xs text-slate-500",children:["Account #: ",e.accountNumber]}),e.industry&&(0,xn.jsx)("p",{className:"text-xs text-slate-500",children:e.industry})]})]})},e.id||t))}),C&&0===S.length&&""!==T.trim()&&(0,xn.jsxs)("div",{ref:P,className:"absolute z-50 w-full mt-1 bg-white border border-slate-300 rounded-lg shadow-lg p-4 text-center text-slate-600",children:[(0,xn.jsx)(ha,{className:"w-8 h-8 mx-auto mb-2 text-slate-400"}),(0,xn.jsxs)("p",{className:"text-sm",children:['No accounts found matching "',T,'"']})]})]}),!n&&(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-emerald-600"}),"Start Time *"]}),(0,xn.jsx)("input",{type:"datetime-local",name:"startTime",value:c.startTime,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(u.startTime?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),readOnly:!0}),u.startTime&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.startTime]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-red-600"}),"End Time"]}),(0,xn.jsx)("input",{type:"datetime-local",name:"endTime",value:c.endTime,onChange:O,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(u.endTime?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400")}),u.endTime&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),u.endTime]})]})]})]})})]}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{type:"button",onClick:()=>t(),className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:f,children:w?"Close":"Cancel"}),!w&&(0,xn.jsx)("button",{type:"submit",onClick:D,disabled:f,className:"px-6 py-3 text-white bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:f?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Ta,{className:"w-4 h-4"}),n?"Update Activity":"Save Activity"]})})]})]})}function Ib(e){let{onClose:t,setIsSuccesssNote:r,currentStatus:n}=e;const[a,i]=(0,s.useState)({new_status:"",note:"",activity_id:0,reschedule_date:""}),[o,l]=(0,s.useState)({note:!1,rescheduleDate:!1}),[c,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i(e=>We(We({},e),{},{new_status:n.status,activity_id:n.activity_id,reschedule_date:n.rescheduleDate||""}))},[n]);const u=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),o[t]&&l(e=>We(We({},e),{},{[t]:!1}))},h=async e=>{if(e.preventDefault(),(()=>{const e={note:!1,rescheduleDate:!1};return a.note.length<5&&(e.note=!0),"reschedule"!==a.new_status||a.reschedule_date||(e.rescheduleDate=!0),l(e),!e.note&&!e.rescheduleDate})()&&n.activity_id){d(!0),console.log(a);try{const e=await Lb(a);console.log(e),r(!0),t()}catch(s){console.error("Error saving note:",s),d(!1)}}},f=(e=>{const t={planned:{color:"text-slate-600 bg-slate-100",icon:"\ud83d\udccb",label:"Planned",description:"Activity is planned and scheduled"},in_progress:{color:"text-blue-600 bg-blue-100",icon:"\u25b6\ufe0f",label:"In Progress",description:"Activity is currently being worked on"},completed:{color:"text-green-600 bg-green-100",icon:"\u2705",label:"Completed",description:"Activity has been completed successfully"},cancelled:{color:"text-red-600 bg-red-100",icon:"\u274c",label:"Cancelled",description:"Activity has been cancelled"},reschedule:{color:"text-amber-600 bg-amber-100",icon:"\u23f0",label:"Reschedule",description:"Activity is being rescheduled to a new date"}};return t[e]||t.planned})(a.new_status);return(0,xn.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(Ta,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:"Add Status Update Note"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Document the reason for this status change"})]})]}),(0,xn.jsx)("button",{onClick:()=>t(),className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,xn.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,xn.jsx)("div",{className:"mb-6 p-4 rounded-lg border ".concat(f.color," border-opacity-30"),children:(0,xn.jsxs)("div",{className:"flex items-start gap-3",children:[(0,xn.jsx)("span",{className:"text-2xl",children:f.icon}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("h3",{className:"font-semibold text-base mb-1",children:["Changing Status to: ",f.label]}),(0,xn.jsx)("p",{className:"text-sm opacity-90",children:f.description})]})]})}),(0,xn.jsx)("form",{onSubmit:h,className:"space-y-6",children:(0,xn.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(sa,{className:"w-4 h-4 text-blue-600"}),"New Status"]}),(0,xn.jsx)("input",{type:"text",name:"new_status",value:f.label,className:"w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-50 text-slate-700 font-medium cursor-not-allowed",readOnly:!0})]}),"reschedule"===a.new_status&&(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Ta,{className:"w-4 h-4 text-amber-600"}),"Reschedule Date & Time *"]}),(0,xn.jsx)("input",{type:"datetime-local",name:"reschedule_date",value:a.reschedule_date,onChange:u,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ".concat(o.rescheduleDate?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),min:(new Date).toISOString().slice(0,16)}),o.rescheduleDate&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)(va,{className:"w-4 h-4"}),"Reschedule date is required when changing status to Reschedule"]}),(0,xn.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:"Select the new date and time for this activity"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-indigo-600"}),"Status Change Note *"]}),(0,xn.jsx)("textarea",{name:"note",value:a.note,onChange:u,rows:8,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent hover:border-slate-400 transition-all resize-none ".concat(o.note?"border-red-500 bg-red-50":"border-slate-300"),placeholder:"Explain why the status is changing to ".concat(f.label.toLowerCase(),"...\n\nExamples:\n\u2022 Client requested to reschedule due to scheduling conflict\n\u2022 Completed all action items and received client confirmation\n\u2022 Unable to reach client after multiple attempts\n\u2022 Meeting was productive, moving forward with proposal")}),o.note&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)(va,{className:"w-4 h-4"}),"Note must be at least 5 characters"]}),(0,xn.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:"Minimum 5 characters. Be specific about the reason for this status change."})]}),"completed"===a.new_status&&(0,xn.jsx)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:(0,xn.jsxs)("div",{className:"flex items-start gap-2",children:[(0,xn.jsx)(va,{className:"w-5 h-5 text-amber-600 mt-0.5"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("p",{className:"font-semibold text-amber-800 text-sm",children:"Important Note"}),(0,xn.jsxs)("p",{className:"text-amber-700 text-sm mt-1",children:["Once an activity is marked as ",(0,xn.jsx)("strong",{children:"Completed"}),", it cannot be edited or changed to any other status. Make sure all information is accurate before proceeding."]})]})]})})]})})]}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{type:"button",onClick:()=>t(),className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:c,children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",onClick:h,disabled:c,className:"px-6 py-3 text-white rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center ".concat("completed"===a.new_status?"bg-green-600 hover:bg-green-700 disabled:bg-green-400":"cancelled"===a.new_status?"bg-red-600 hover:bg-red-700 disabled:bg-red-400":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400"),children:c?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Ta,{className:"w-4 h-4"}),"Save Status Change"]})})]})]})}function Rb(){const[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[u,h]=(0,s.useState)(""),[f,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(!1),[x,b]=(0,s.useState)({status:"",activity_id:0}),v=()=>{n(!1),l(null)};(0,s.useEffect)(()=>{y()},[]);const y=async()=>{d(!0),h("");try{const e=(await(async()=>(await mn.get("".concat(pn,"/Activity"))).data)()).map(e=>({id:e.id,title:e.activity_name,type:w(e.activity_type),typeColor:N(e.activity_type),typeIcon:j(e.activity_type),owner:e.owner||"Unassigned",ownerInitial:(e.owner||"U").charAt(0).toUpperCase(),startTime:A(e.start_time),endTime:A(e.end_time),status:e.status,statusColor:k(e.status),relatedItem:e.related_item||"N/A",priority:S(e.status),rawData:e}));t(e)}catch(n){var e,r;console.error("Error fetching activities:",n),h((null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Failed to load activities. Please try again.")}finally{d(!1)}},w=e=>({call:"Phone Call",email:"Email",meeting:"Meeting",demo:"Demo","follow-up":"Follow-up",presentation:"Presentation",proposal:"Proposal",negotiation:"Negotiation","site-visit":"Site Visit",training:"Training",webinar:"Webinar",conference:"Conference",task:"Task",other:"Other"}[e]||e),N=e=>({call:"bg-blue-500",email:"bg-purple-500",meeting:"bg-indigo-500",demo:"bg-green-500","follow-up":"bg-amber-500",presentation:"bg-pink-500",proposal:"bg-cyan-500",negotiation:"bg-red-500","site-visit":"bg-orange-500",training:"bg-teal-500",webinar:"bg-violet-500",conference:"bg-lime-500",task:"bg-slate-500",other:"bg-gray-500"}[e]||"bg-slate-500"),j=e=>({call:qx,email:Hn,meeting:$x,demo:Ta,"follow-up":Hn,presentation:$x,proposal:Ta,negotiation:$x,"site-visit":Ta,training:$x,webinar:Ta,conference:$x,task:sa,other:va}[e]||va),k=e=>({planned:"bg-blue-500","in-progress":"bg-amber-500",completed:"bg-emerald-500",cancelled:"bg-red-500",rescheduled:"bg-purple-500",overdue:"bg-orange-500"}[e]||"bg-slate-500"),S=e=>"overdue"===e?"high":"in-progress"===e||"planned"===e?"medium":"low",A=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{i(!a)},isMobileMenuOpen:a}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:a,onClose:()=>{i(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(Ob,{modalOpen:()=>{l(null),n(!0)},onEdit:e=>{l(e),n(!0)},activities:e,setActivities:t,loadActivities:y})})]}),r&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:v}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Fb,{onClose:e=>{v()},initialActivity:o,isEditMode:!!o,noteModalOpen:()=>{console.log("not trigger this!"),m(!0)},isSuccesssNote:p,setCurrentStatus:b})})})]}),f&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:v}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Ib,{onClose:()=>{m(!1)},initialActivity:o,setIsSuccesssNote:g,currentStatus:x})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const Db=En("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Mb=En("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Bb=En("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);function Ub(){ae();const[e,t]=(0,s.useState)({username:"",password:""}),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)({}),c=e=>{const{name:r,value:n}=e.target;t(e=>We(We({},e),{},{[r]:n})),o[r]&&l(e=>We(We({},e),{},{[r]:""}))};return(0,xn.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-slate-50 flex items-center justify-center p-4",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes slideIn {\n          0% {\n            opacity: 0;\n            transform: translateX(-20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n\n        .animate-fadeIn {\n          animation: fadeIn 0.6s ease-out;\n        }\n\n        .animate-slideIn {\n          animation: slideIn 0.6s ease-out;\n        }\n\n        .input-focus {\n          transition: all 0.2s ease;\n        }\n\n        .input-focus:focus {\n          transform: translateY(-1px);\n          box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);\n        }\n      "}),(0,xn.jsxs)("div",{className:"w-full max-w-md animate-fadeIn",children:[(0,xn.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-10 text-center",children:[(0,xn.jsx)("div",{className:"mb-6 flex justify-center",children:(0,xn.jsx)("div",{className:"bg-white rounded-xl p-4 shadow-lg",children:(0,xn.jsx)("img",{src:wn,alt:"Scanwell Logistics",className:"h-16 w-auto",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div class="text-blue-600 font-bold text-2xl">SCANWELL</div>'}})})}),(0,xn.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),(0,xn.jsx)("p",{className:"text-blue-100",children:"Sign in to your account"})]}),(0,xn.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),(()=>{const t={};return e.username.trim()||(t.username="Username is required"),e.password||(t.password="Password is required"),l(t),0===Object.keys(t).length})()){i(!0),l({});try{const t=await gn.post("".concat(pn,"/auth/login"),{username:e.username,password:e.password}),{id:r,username:n}=t.data;localStorage.setItem("userRoleId",r),localStorage.setItem("username",n),localStorage.setItem("user",JSON.stringify({id:r,username:n})),console.log("Login Success!",{userRoleId:r,username:n}),window.location.href="/dashboard"}catch(a){console.error("Login failed:",a);let e="Invalid username or password. Please try again.";var r,n;if(a.response)e=(null===(r=a.response.data)||void 0===r?void 0:r.message)||(null===(n=a.response.data)||void 0===n?void 0:n.title)||a.response.data||e;else e=a.request?"No response from server. Please check your connection.":"Something went wrong. Please try again.";l({submit:e})}finally{i(!1)}}},className:"px-8 py-8 space-y-6",children:[(0,xn.jsxs)("div",{className:"animate-slideIn",style:{animationDelay:"0.1s",animationFillMode:"both"},children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,xn.jsx)(Fn,{className:"h-5 w-5 text-slate-400"})}),(0,xn.jsx)("input",{type:"text",name:"username",value:e.username,onChange:c,placeholder:"Enter your username",className:"input-focus w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(o.username?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-300 focus:ring-blue-500 focus:border-blue-500"),disabled:a})]}),o.username&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:o.username})]}),(0,xn.jsxs)("div",{className:"animate-slideIn",style:{animationDelay:"0.2s",animationFillMode:"both"},children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,xn.jsx)(Db,{className:"h-5 w-5 text-slate-400"})}),(0,xn.jsx)("input",{type:r?"text":"password",name:"password",value:e.password,onChange:c,placeholder:"Enter your password",className:"input-focus w-full pl-10 pr-12 py-3 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(o.password?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-300 focus:ring-blue-500 focus:border-blue-500"),disabled:a}),(0,xn.jsx)("button",{type:"button",onClick:()=>n(!r),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors duration-200",tabIndex:"-1",children:r?(0,xn.jsx)(Mb,{className:"h-5 w-5"}):(0,xn.jsx)(fa,{className:"h-5 w-5"})})]}),o.password&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:o.password})]}),o.submit&&(0,xn.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2 animate-fadeIn",children:[(0,xn.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,xn.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,xn.jsx)("span",{className:"text-sm",children:o.submit})]}),(0,xn.jsx)("div",{className:"animate-slideIn",style:{animationDelay:"0.3s",animationFillMode:"both"},children:(0,xn.jsx)("button",{type:"submit",disabled:a,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 font-medium shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600",children:a?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)($a,{className:"w-5 h-5 animate-spin"}),(0,xn.jsx)("span",{children:"Signing In..."})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Bb,{className:"w-5 h-5"}),(0,xn.jsx)("span",{children:"Sign In"})]})})})]}),(0,xn.jsx)("div",{className:"px-8 py-6 bg-slate-50 border-t border-slate-200 text-center animate-fadeIn",style:{animationDelay:"0.4s",animationFillMode:"both"},children:(0,xn.jsxs)("p",{className:"text-sm text-slate-600",children:["\xa9 ",(new Date).getFullYear()," Scanwell Logistics. All rights reserved."]})})]}),(0,xn.jsx)("div",{className:"mt-6 text-center animate-fadeIn",style:{animationDelay:"0.5s",animationFillMode:"both"},children:(0,xn.jsxs)("p",{className:"text-sm text-slate-600",children:["Having trouble logging in?"," ",(0,xn.jsx)("a",{href:"mailto:support@scanwell.lk",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Contact Support"})]})})]})]})}const zb=async()=>(await mn.get("".concat(pn,"/Department"))).data,qb=async()=>(await mn.get("".concat(pn,"/Position"))).data,Hb=["sysID"];function Wb(e){let{onClose:t,editEmployee:r=null,onSuccess:n}=e;const[a,i]=(0,s.useState)({sysID:"",fname:"",lname:"",email:"",tp:"",position:"",department:"",w_location:"",a_manager:"",status:"Active",note:""}),[o,l]=(0,s.useState)({}),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)([]);(0,s.useEffect)(()=>{console.log("this is employee",r),r&&i({sysID:r.sysID||"",fname:r.fname||"",lname:r.lname||"",email:r.email||"",tp:r.tp||"",position:r.position||"",department:r.department||"",w_location:r.w_location||"",a_manager:r.a_manager||"",status:r.status||"Active",note:r.note||""})},[r]),(0,s.useEffect)(()=>{(async()=>{try{const[e,t]=await Promise.all([zb(),qb()]);h(e||[]),m(t||[])}catch(e){console.error("Error fetching departments and positions:",e)}})()},[]);const p=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),o[t]&&l(e=>We(We({},e),{},{[t]:""}))},g=r&&r.sysID;return(0,xn.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-emerald-50 to-green-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center",children:(0,xn.jsx)(Qx,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:g?"Edit Employee":"Add New Employee"}),(0,xn.jsx)("p",{className:"text-sm text-slate-600",children:g?"Update employee information":"Create a new employee profile"})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,xn.jsxs)("div",{className:"space-y-8",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Personal Information"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-blue-600"}),"First Name *"]}),(0,xn.jsx)("input",{type:"text",name:"fname",value:a.fname,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(o.fname?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter first name"}),o.fname&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),o.fname]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-purple-600"}),"Last Name *"]}),(0,xn.jsx)("input",{type:"text",name:"lname",value:a.lname,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(o.lname?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter last name"}),o.lname&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),o.lname]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Qx,{className:"w-4 h-4 text-emerald-600"}),"Employment Status"]}),(0,xn.jsx)("select",{name:"status",value:a.status,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all",children:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}].map(e=>(0,xn.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Hn,{className:"w-4 h-4 text-red-600"}),"Email Address *"]}),(0,xn.jsx)("input",{type:"email",name:"email",value:a.email,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(o.email?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter email address"}),o.email&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),o.email]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(qx,{className:"w-4 h-4 text-green-600"}),"Phone Number"]}),(0,xn.jsx)("input",{type:"tel",name:"tp",value:a.tp,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(o.tp?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"0771234567"}),o.tp&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),o.tp]})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Employment Information"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Xn,{className:"w-4 h-4 text-indigo-600"}),"Position/Title *"]}),(0,xn.jsxs)("select",{name:"position",value:a.position,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(o.position?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,xn.jsx)("option",{value:"",children:"Select position"}),f.map(e=>(0,xn.jsx)("option",{value:e.p_name,children:e.p_name},e.sysID))]}),o.position&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),o.position]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(zx,{className:"w-4 h-4 text-orange-600"}),"Department *"]}),(0,xn.jsxs)("select",{name:"department",value:a.department,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(o.department?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),children:[(0,xn.jsx)("option",{value:"",children:"Select department"}),u.map(e=>(0,xn.jsx)("option",{value:e.d_name,children:e.d_name},e.sysID))]}),o.department&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),o.department]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-teal-600"}),"Work Location"]}),(0,xn.jsx)("input",{type:"text",name:"w_location",value:a.w_location,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"e.g., Warehouse A, Distribution Center, Main Office"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Fn,{className:"w-4 h-4 text-cyan-600"}),"Assigned Manager"]}),(0,xn.jsx)("input",{type:"text",name:"a_manager",value:a.a_manager,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all",placeholder:"Enter assigned manager's name"})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Additional Information"}),(0,xn.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-gray-600"}),"Additional Notes"]}),(0,xn.jsx)("textarea",{name:"note",value:a.note,onChange:p,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent hover:border-slate-400 transition-all resize-none",placeholder:"Any additional notes about this employee, special skills, certifications, training requirements, etc..."})]})})]})]})}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:c,children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),(()=>{const e={};return a.fname.trim()||(e.fname="First name is required"),a.lname.trim()||(e.lname="Last name is required"),a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)||(e.email="Please enter a valid email address"):e.email="Email is required",a.position||(e.position="Position is required"),a.department||(e.department="Department is required"),a.tp&&!/^[\+]?[0-9\s\-\(\)]{10,15}$/.test(a.tp)&&(e.tp="Please enter a valid phone number"),l(e),0===Object.keys(e).length})()){d(!0),console.log("pppppppp",a);try{let e;if(r&&r.sysID)e=await(async e=>(console.log("oooo",e),(await mn.put("".concat(pn,"/Employee/emp"),e)).data))(a),console.log("Employee updated:",e);else{const{sysID:t}=a,r=jn(a,Hb);e=await(async e=>(await mn.post("".concat(pn,"/Employee/emp"),e)).data)(r),console.log("Employee created:",e)}n&&n(e),t()}catch(s){console.error("Error submitting form:",s),alert("Error saving employee. Please try again.")}finally{d(!1)}}},disabled:c,className:"px-6 py-3 text-white bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[140px] justify-center",children:c?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),g?"Updating...":"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Qx,{className:"w-4 h-4"}),g?"Update Employee":"Add Employee"]})})]})]})}const Vb=En("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Gb=En("toggle-right",[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]),Kb=En("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]);function Yb(e){let{onOpen:t,loading:r=!1,delay:n=0,employees:a=[],setSelectedEmployee:s}=e;const i=()=>(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm animate-pulse",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"}),(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded w-32"}),(0,xn.jsx)("div",{className:"h-8 bg-slate-200 rounded w-32"})]}),(0,xn.jsx)("div",{className:"w-4 h-4 bg-slate-200 rounded"})]}),(0,xn.jsx)("div",{className:"p-4 space-y-4",children:Array.from({length:4}).map((e,t)=>(0,xn.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-slate-200 rounded-full"}),(0,xn.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded w-48"}),(0,xn.jsx)("div",{className:"h-3 bg-slate-200 rounded w-32"})]}),(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded w-20"}),(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded w-16"})]},t))})]}),o=e=>{let{employee:t,onToggle:r}=e;const n="active"===(t.status||"").toLowerCase();return(0,xn.jsx)("button",{onClick:()=>r(t.sysID),className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 ".concat(n?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"),title:"Click to ".concat(n?"disable":"enable"," employee"),children:n?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Qx,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"Active"})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(Vb,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"Disabled"})]})})},l=e=>{let{employee:t,onToggle:r}=e;const n="active"===(t.status||"").toLowerCase();return(0,xn.jsx)("button",{onClick:()=>r(t.sysID),className:"flex items-center gap-2 transition-all duration-200 ".concat(n?"text-emerald-600":"text-slate-400"),title:"Toggle availability for task assignment",disabled:"active"!==(t.status||"").toLowerCase(),children:n?(0,xn.jsx)(Gb,{className:"w-6 h-6"}):(0,xn.jsx)(Kb,{className:"w-6 h-6"})})},c=e=>{let{current:t,capacity:r}=e;const n=t/r*100;return(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("div",{className:"w-16 bg-slate-200 rounded-full h-2",children:(0,xn.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(n>=100?"bg-red-500":n>=75?"bg-amber-500":"bg-green-500"),style:{width:"".concat(Math.min(n,100),"%")}})}),(0,xn.jsxs)("span",{className:"text-xs text-slate-600 font-medium",children:[t,"/",r]})]})},d=e=>{let{department:t}=e;if(!t)return(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[(0,xn.jsx)(zx,{className:"w-3 h-3"}),"N/A"]});return(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat((()=>{switch(t.toLowerCase()){case"logistics":case"ocean exports":case"ocean imports":return"bg-blue-100 text-blue-800";case"operations":case"sales":return"bg-purple-100 text-purple-800";case"transport":return"bg-green-100 text-green-800";case"warehouse":return"bg-amber-100 text-amber-800";case"customs":return"bg-red-100 text-red-800";case"hr":case"customer relations":return"bg-pink-100 text-pink-800";case"it":return"bg-indigo-100 text-indigo-800";case"dispatch":return"bg-teal-100 text-teal-800";case"fleet-management":return"bg-orange-100 text-orange-800";case"customer-service":case"air imports":return"bg-cyan-100 text-cyan-800";case"quality-control":return"bg-lime-100 text-lime-800";case"supply-chain":return"bg-violet-100 text-violet-800";case"inventory":return"bg-emerald-100 text-emerald-800";case"procurement":return"bg-rose-100 text-rose-800";case"safety":return"bg-yellow-100 text-yellow-800";case"air exports":return"bg-sky-100 text-sky-800";default:return"bg-slate-100 text-slate-800"}})()),children:[(0,xn.jsx)(zx,{className:"w-3 h-3"}),t]})},u=e=>{let{name:t,status:r,isAvailable:n}=e;const a=(()=>{if(!t||""===t.trim())return"?";const e=t.split(" ").filter(Boolean);return 0===e.length?"?":e.map(e=>e[0]).join("").toUpperCase().substring(0,2)})(),s="active"===(r||"").toLowerCase(),i=s?"bg-emerald-600":"bg-slate-400";return(0,xn.jsxs)("div",{className:"".concat(i," text-white rounded-full w-10 h-10 flex items-center justify-center shadow-sm relative"),children:[(0,xn.jsx)("span",{className:"text-sm font-semibold",children:a}),s&&(0,xn.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 border-2 border-white rounded-full ".concat(n?"bg-green-400":"bg-amber-400")})]})},h=(e,t)=>{const r=[e,t].filter(Boolean);return r.length>0?r.join(" "):"Unknown"},f=e=>{console.log("Toggling status for employee ".concat(e))},m=e=>{console.log("Toggling availability for employee ".concat(e))},p=e=>{s(e),t()};return r?(0,xn.jsx)(i,{}):(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all duration-300",style:{animationDelay:"".concat(n,"ms"),animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border-b border-slate-100 gap-4",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors group",children:(0,xn.jsx)(ua,{className:"w-4 h-4 text-slate-400 group-hover:text-slate-600"})}),(0,xn.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Employee Management"}),(0,xn.jsxs)("div",{className:"text-sm text-slate-500 bg-slate-100 px-2 py-1 rounded",children:[a.filter(e=>"active"===(e.status||"").toLowerCase()).length," Active"]}),t&&(0,xn.jsxs)("button",{onClick:()=>t(),className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-all duration-200 active:scale-95 shadow-sm",title:"Add new employee",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Add Employee"})]})]}),(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors self-start sm:self-center",children:(0,xn.jsx)(Zn,{className:"w-4 h-4 text-slate-400"})})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("div",{className:"min-w-full",children:[(0,xn.jsx)("div",{className:"hidden lg:block",children:(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-4 py-3 text-left bg-slate-50 sticky left-0 z-20 border-r border-slate-200 shadow-sm",children:(0,xn.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"})}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider bg-slate-50 sticky left-16 z-20 border-r border-slate-200 min-w-48 shadow-sm",children:"Employee"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-48",children:"Contact"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-36",children:"Position"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-32",children:"Department"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-24",children:"Status"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-24",children:"Available"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-32",children:"Task Load"}),(0,xn.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider min-w-24",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-100",children:a.map(e=>{const t=h(e.fname,e.lname),r="EMP".concat((e.sysID||0).toString().padStart(3,"0")),n="active"===(e.status||"").toLowerCase();return(0,xn.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,xn.jsx)("td",{className:"px-4 py-4 bg-white sticky left-0 z-10 border-r border-slate-200 shadow-sm group-hover:bg-slate-50",children:(0,xn.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"})}),(0,xn.jsx)("td",{className:"px-4 py-4 bg-white sticky left-16 z-10 border-r border-slate-200 min-w-48 shadow-sm group-hover:bg-slate-50",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)(u,{name:t,status:e.status||"",isAvailable:n}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"font-medium text-slate-900",children:t}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:r})]})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"space-y-1",children:[e.email?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate",children:e.email})]}):(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"N/A"})]}),e.tp?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(qx,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.tp})]}):(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,xn.jsx)(qx,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"N/A"})]})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:e.position?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(Xn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.position})]}):(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,xn.jsx)(Xn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"N/A"})]})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(d,{department:e.department})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(o,{employee:e,onToggle:f})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(l,{employee:e,onToggle:m})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsx)(c,{current:Math.floor(5*Math.random()),capacity:5})}),(0,xn.jsx)("td",{className:"px-4 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("button",{className:"p-1 hover:bg-slate-100 rounded transition-colors",title:"View employee details",children:(0,xn.jsx)(fa,{className:"w-4 h-4 text-slate-600"})}),(0,xn.jsx)("button",{onClick:()=>p(e),className:"p-1 hover:bg-slate-100 rounded transition-colors",title:"Edit employee",children:(0,xn.jsx)(za,{className:"w-4 h-4 text-slate-600"})})]})})]},e.sysID)})})]})}),(0,xn.jsx)("div",{className:"lg:hidden divide-y divide-slate-200",children:a.map(e=>{const t=h(e.fname,e.lname),r="EMP".concat((e.sysID||0).toString().padStart(3,"0")),n="active"===(e.status||"").toLowerCase();return(0,xn.jsxs)("div",{className:"p-4 space-y-4",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"}),(0,xn.jsx)(u,{name:t,status:e.status||"",isAvailable:n}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"font-medium text-slate-900",children:t}),(0,xn.jsx)("div",{className:"text-xs text-slate-500",children:r})]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("button",{className:"p-2 hover:bg-slate-100 rounded transition-colors",title:"View employee details",children:(0,xn.jsx)(fa,{className:"w-4 h-4 text-slate-600"})}),(0,xn.jsx)("button",{onClick:()=>p(e),className:"p-2 hover:bg-slate-100 rounded transition-colors",title:"Edit employee",children:(0,xn.jsx)(za,{className:"w-4 h-4 text-slate-600"})})]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Contact"}),(0,xn.jsxs)("div",{className:"space-y-1",children:[e.email?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{className:"truncate",children:e.email})]}):(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,xn.jsx)(Hn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"N/A"})]}),e.tp?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(qx,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.tp})]}):(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,xn.jsx)(qx,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"N/A"})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Position"}),e.position?(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[(0,xn.jsx)(Xn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:e.position})]}):(0,xn.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400",children:[(0,xn.jsx)(Xn,{className:"w-3 h-3"}),(0,xn.jsx)("span",{children:"N/A"})]}),(0,xn.jsx)("div",{className:"mt-1",children:(0,xn.jsx)(d,{department:e.department})})]})]}),(0,xn.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Status"}),(0,xn.jsx)(o,{employee:e,onToggle:f})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Available"}),(0,xn.jsx)(l,{employee:e,onToggle:m})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Task Load"}),(0,xn.jsx)(c,{current:Math.floor(5*Math.random()),capacity:5})]})]})]},e.sysID)})})]})}),0===a.length&&(0,xn.jsxs)("div",{className:"text-center py-12",children:[(0,xn.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-full flex items-center justify-center",children:(0,xn.jsx)(Fn,{className:"w-8 h-8 text-slate-400"})}),(0,xn.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No employees found"}),(0,xn.jsx)("p",{className:"text-slate-500 mb-4",children:"Get started by adding your first employee to the system."}),t&&(0,xn.jsxs)("button",{onClick:()=>t(),className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),"Add Employee"]})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.5s ease-out;\n        }\n      "})]})}function Xb(e){let{modalOpen:t,employees:r,setSelectedEmployee:n}=e;const[a,i]=(0,s.useState)(!0),[o,l]=(0,s.useState)("");(0,s.useEffect)(()=>{const e=setTimeout(()=>{i(!1)},1500);return()=>clearTimeout(e)},[]);const c=r.filter(e=>{if(!o)return!0;const t=o.toLowerCase();return(e.fname||"").toLowerCase().includes(t)||(e.lname||"").toLowerCase().includes(t)||(e.email||"").toLowerCase().includes(t)||(e.tp||"").toLowerCase().includes(t)||(e.position||"").toLowerCase().includes(t)||(e.department||"").toLowerCase().includes(t)||(e.w_location||"").toLowerCase().includes(t)||(e.a_manager||"").toLowerCase().includes(t)||(e.status||"").toLowerCase().includes(t)});return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-emerald-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n      "}),(0,xn.jsxs)("div",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto pb-8",children:[(0,xn.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(Qx,{className:"w-6 h-6 text-emerald-600"}),(0,xn.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Employee Directory"})]})}),(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Provide feedback",children:[(0,xn.jsx)(Yx,{className:"w-4 h-4 text-pink-500 group-hover:text-pink-600"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Messages",children:(0,xn.jsx)(Xx,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-800"})}),(0,xn.jsx)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white rounded-full w-9 h-9 flex items-center justify-center shadow-sm",children:(0,xn.jsx)("span",{className:"text-sm font-semibold",children:"K"})}),(0,xn.jsxs)("div",{className:"flex items-center gap-1",children:[(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-300 rounded-l-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Invite team members",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-emerald-500 group-hover:text-emerald-600"}),(0,xn.jsx)("span",{className:"hidden sm:inline",children:"Invite"}),(0,xn.jsx)("span",{className:"bg-emerald-100 text-emerald-700 px-1.5 py-0.5 rounded text-xs font-medium",children:"1"})]}),(0,xn.jsx)("button",{className:"p-2 bg-white border border-slate-300 border-l-0 rounded-r-lg hover:bg-slate-50 transition-all duration-200 shadow-sm group",title:"Share employee data",children:(0,xn.jsx)(Jx,{className:"w-4 h-4 text-slate-600 group-hover:text-slate-800"})})]})]})]}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 py-4 border-t border-slate-200 mb-6 ".concat(a?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:[(0,xn.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,xn.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",title:"Add new employee",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),(0,xn.jsx)("span",{children:"Add Employee"})]}),(0,xn.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-all duration-200 shadow-sm",title:"Filter employees",children:[(0,xn.jsx)(Qn,{className:"w-4 h-4 text-slate-600"}),(0,xn.jsx)("span",{children:"Filter"}),(0,xn.jsx)(ua,{className:"w-4 h-4 text-slate-400"})]})]}),(0,xn.jsx)("div",{className:"flex-1 max-w-md ml-auto",children:(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(ha,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search employees...",value:o,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200 text-sm"})]})})]}),(0,xn.jsx)("div",{className:"space-y-6",children:(0,xn.jsx)(Yb,{onOpen:t,loading:a,employees:c,delay:300,setSelectedEmployee:n})}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:()=>{i(!0),setTimeout(()=>i(!1),1500)},className:"bg-emerald-600 hover:bg-emerald-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh Employees",children:(0,xn.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(a?"animate-spin":"group-hover:rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,xn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,xn.jsx)("div",{className:"h-8"})]})]})}function $b(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)([]),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(null),c=()=>{t(!1)};return(0,s.useEffect)(()=>{(async()=>{try{const e=await rb();n(e)}catch(e){}})()},[]),(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{i(!a)},isMobileMenuOpen:a}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:a,onClose:()=>{i(!1)},scrollBottom:!0}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(Xb,{modalOpen:()=>{t(!0)},employees:r,setSelectedEmployee:l})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:c}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Wb,{onClose:c,editEmployee:o})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}function Jb(e){let{onClose:t,editItem:r=null,activeTab:n,onSuccess:a,loadDepartment:i,loadPosition:o}=e;const[l,c]=(0,s.useState)({name:""}),[d,u]=(0,s.useState)({}),[h,f]=(0,s.useState)(!1),m=async e=>{await(async e=>(await mn.post("".concat(pn,"/Department"),e)).data)({dName:e});i()},p=async(e,t)=>{const r={Id:e,dName:t};await(async e=>(await mn.put("".concat(pn,"/Department"),e)).data)(r);i()},g=async e=>{await(async e=>(await mn.post("".concat(pn,"/Position"),e)).data)({pName:e});o()},x=async(e,t)=>{const r={Id:e,pName:t};await(async e=>(await mn.put("".concat(pn,"/Position"),e)).data)(r);o()};(0,s.useEffect)(()=>{r&&c("departments"===n?{name:r.d_name||""}:{name:r.p_name||""})},[r]);const b=async e=>{if(e.preventDefault(),(()=>{const e={};return l.name.trim()||(e.name="Name is required"),u(e),0===Object.keys(e).length})()){f(!0);try{let e;r&&r.sysID?(e="departments"===n?await p(r.sysID,l.name):await x(r.sysID,l.name),console.log("".concat(n.slice(0,-1)," updated:"),e)):(e="departments"===n?await m(l.name):await g(l.name),console.log("".concat(n.slice(0,-1)," created:"),e)),a&&a(e),t()}catch(s){console.error("Error submitting form:",s),alert("Error saving ".concat(n.slice(0,-1),". Please try again."))}finally{f(!1)}}},v=r&&r.sysID;return(0,xn.jsxs)("div",{className:"w-full max-w-md mx-auto bg-white rounded-2xl shadow-xl",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 bg-gradient-to-r from-emerald-50 to-green-50 rounded-t-2xl",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center",children:"departments"===n?(0,xn.jsx)(Yn,{className:"w-5 h-5 text-white"}):(0,xn.jsx)(Xn,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h1",{className:"text-xl font-bold text-slate-800",children:[v?"Edit":"Add"," ",n.slice(0,-1)]}),(0,xn.jsxs)("p",{className:"text-sm text-slate-600",children:[v?"Update":"Create"," ",n.slice(0,-1)," information"]})]})]}),(0,xn.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/70 rounded-lg transition-colors group","aria-label":"Close modal",children:(0,xn.jsx)(Ln,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-700"})})]}),(0,xn.jsx)("div",{className:"p-6",children:(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3",children:["departments"===n?(0,xn.jsx)(Yn,{className:"w-4 h-4 text-emerald-600"}):(0,xn.jsx)(Xn,{className:"w-4 h-4 text-emerald-600"}),"departments"===n?"Department":"Position"," Name *"]}),(0,xn.jsx)("input",{type:"text",name:"name",value:l.name,onChange:e=>{const{name:t,value:r}=e.target;c(e=>We(We({},e),{},{[t]:r})),d[t]&&u(e=>We(We({},e),{},{[t]:""}))},className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ".concat(d.name?"border-red-500 bg-red-50":"border-slate-300 hover:border-slate-400"),placeholder:"Enter ".concat(n.slice(0,-1)," name"),onKeyPress:e=>"Enter"===e.key&&b(e)}),d.name&&(0,xn.jsxs)("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[(0,xn.jsx)("span",{className:"w-4 h-4",children:"\u26a0\ufe0f"}),d.name]})]})}),(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-6 border-t border-slate-200 bg-slate-50 rounded-b-2xl",children:[(0,xn.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-slate-700 bg-white border border-slate-300 hover:bg-slate-50 rounded-lg transition-all duration-200 font-medium",disabled:h,children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",onClick:b,disabled:h||!l.name.trim(),className:"px-6 py-3 text-white bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 rounded-lg transition-all duration-200 font-medium flex items-center gap-2 min-w-[120px] justify-center",children:h?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),v?"Updating...":"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(qa,{className:"w-4 h-4"}),v?"Update":"Save"]})})]})]})}function Qb(e){let{modalOpen:t,departments:r,positions:n,setSelectedItem:a,activeTab:i,setActiveTab:o,setDepartments:l,setPositions:c}=e;const[d,u]=(0,s.useState)(""),h=[{id:"departments",label:"Departments",icon:Yn},{id:"positions",label:"Positions",icon:Xn}],f=()=>{const e="departments"===i?r:n;return"departments"===i?e.filter(e=>e.d_name.toLowerCase().includes(d.toLowerCase())):"positions"===i?e.filter(e=>e.p_name.toLowerCase().includes(d.toLowerCase())):void 0};return(0,xn.jsxs)("div",{className:"p-6 max-w-6xl mx-auto",children:[(0,xn.jsxs)("div",{className:"mb-8",children:[(0,xn.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"HR System Management"}),(0,xn.jsx)("p",{className:"text-slate-600",children:"Manage departments and positions"})]}),(0,xn.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[(0,xn.jsx)("div",{className:"border-b border-slate-200",children:(0,xn.jsx)("nav",{className:"flex",children:h.map(e=>(0,xn.jsxs)("button",{onClick:()=>o(e.id),className:"flex items-center gap-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(i===e.id?"border-emerald-500 text-emerald-600 bg-emerald-50":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"),children:[(0,xn.jsx)(e.icon,{className:"w-5 h-5"}),e.label]},e.id))})}),(0,xn.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,xn.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,xn.jsx)("div",{className:"flex-1",children:(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(ha,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search ".concat(i,"..."),value:d,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),(0,xn.jsxs)("button",{onClick:()=>{a(null),t()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),"Add ",i.slice(0,-1)]})]})}),(0,xn.jsx)("div",{className:"p-6",children:(0,xn.jsxs)("div",{className:"space-y-3",children:[f().map(e=>(0,xn.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:["departments"===i?(0,xn.jsx)(Yn,{className:"w-5 h-5 text-slate-400"}):(0,xn.jsx)(Xn,{className:"w-5 h-5 text-slate-400"}),(0,xn.jsx)("span",{className:"text-slate-900 font-medium",children:"departments"===i?e.d_name:e.p_name})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("button",{onClick:()=>(e=>{a(e),t()})(e),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:(0,xn.jsx)(za,{className:"w-4 h-4"})}),(0,xn.jsx)("button",{onClick:()=>{return t=e.sysID,void(window.confirm("Are you sure you want to delete this ".concat(i.slice(0,-1),"?"))&&("departments"===i?l(r.filter(e=>e.id!==t)):c(n.filter(e=>e.id!==t))));var t},className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})]})]},e.id)),0===f().length&&(0,xn.jsxs)("div",{className:"text-center py-12",children:[(0,xn.jsx)("div",{className:"text-slate-400 mb-2",children:"departments"===i?(0,xn.jsx)(Yn,{className:"w-12 h-12 mx-auto"}):(0,xn.jsx)(Xn,{className:"w-12 h-12 mx-auto"})}),(0,xn.jsxs)("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:["No ",i," found"]}),(0,xn.jsx)("p",{className:"text-slate-500",children:d?"Try adjusting your search":"Add your first ".concat(i.slice(0,-1))})]})]})})]})]})}function Zb(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)([]),[a,i]=(0,s.useState)([]),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)("departments"),f=()=>{d(null),t(!1)};(0,s.useEffect)(()=>{m(),p()},[]);const m=async()=>{const e=await zb();n(e),console.log(e)},p=async()=>{const e=await qb();i(e),console.log(e)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{l(!o)},isMobileMenuOpen:o}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:o,onClose:()=>{l(!1)},scrollBottom:!0}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(Qb,{modalOpen:()=>{t(!0)},departments:r,positions:a,setSelectedItem:d,activeTab:u,setActiveTab:h,setDepartments:n,setPositions:i})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:f}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(Jb,{onClose:f,editItem:c,activeTab:u,onSuccess:()=>{},loadDepartment:m,loadPosition:p})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const ev=En("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),tv=En("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),rv={createNewResource:async e=>(await mn.post("".concat(pn,"/Resource/resource"),e,{headers:{"Content-Type":"multipart/form-data"}})).data,deleteResource:async e=>(await mn.delete("".concat(pn,"/Resource/resource/").concat(e))).data,fetchResourceById:async e=>(await mn.get("".concat(pn,"/Resource/resource/").concat(e))).data,fetchResources:async()=>(await mn.get("".concat(pn,"/Resource/resource"))).data,updateResource:async e=>(await mn.put("".concat(pn,"/Resource/resource"),e,{headers:{"Content-Type":"multipart/form-data"}})).data};function nv(e){let{modalOpen:t,onEdit:r}=e;const[n,a]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),[l,c]=(0,s.useState)([]);(0,s.useEffect)(()=>{d()},[]);const d=async()=>{a(!0);try{const e=(await rv.fetchResources()).map(e=>({id:e.sysID,title:e.title,link:e.link,description:e.description,logoUrl:e.logoUrl,addedDate:e.addedDate,addedBy:e.addedBy}));c(e)}catch(e){console.error("Error fetching resources:",e)}finally{a(!1)}},u=async e=>{if(console.log("this is the id pass to the delete: ",e),window.confirm("Are you sure you want to delete this item?"))try{await rv.deleteResource(e),window.location.reload()}catch(t){console.error("Error deleting resource:",t)}},h=l.filter(e=>e.title.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase()));return(0,xn.jsxs)("div",{className:"w-full bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-full",children:[(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes slideInLeft {\n          0% {\n            opacity: 0;\n            transform: translateX(-100px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes fadeInUp {\n          0% {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            background-position: -1000px 0;\n          }\n          100% {\n            background-position: 1000px 0;\n          }\n        }\n        \n        .animate-slideInLeft {\n          animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        \n        .animate-fadeInUp {\n          animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .skeleton {\n          animation: shimmer 2s infinite;\n          background: linear-gradient(\n            90deg,\n            #f0f0f0 25%,\n            #e0e0e0 50%,\n            #f0f0f0 75%\n          );\n          background-size: 1000px 100%;\n        }\n\n        .table-row-hover:hover {\n          background-color: rgba(59, 130, 246, 0.02);\n        }\n\n        .logo-img {\n          object-fit: contain;\n          max-height: 100%;\n          max-width: 100%;\n        }\n      "}),(0,xn.jsxs)("main",{className:"p-4 md:p-6 lg:p-8 max-w-[102rem] mx-auto",children:[(0,xn.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"100ms",animationFillMode:"both"},children:[(0,xn.jsx)("div",{className:"flex items-center gap-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(zn,{className:"w-8 h-8 text-blue-600"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Useful Links"}),(0,xn.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Quick access to important logistics resources"})]})]})}),(0,xn.jsx)("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:(0,xn.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg font-medium text-sm",children:[(0,xn.jsx)(da,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:"Add New Link"})]})})]}),(0,xn.jsx)("div",{className:"mb-6 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"200ms",animationFillMode:"both"},children:(0,xn.jsxs)("div",{className:"relative max-w-md",children:[(0,xn.jsx)(ha,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search resources...",value:i,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm"})]})}),(0,xn.jsx)("div",{className:"hidden md:flex flex-col bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full text-left text-slate-700 border-collapse",children:[(0,xn.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Logo"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Title"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Description"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Link"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Added Date"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Added By"}),(0,xn.jsx)("th",{className:"px-6 py-4 font-semibold text-sm text-slate-600",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-slate-200",children:n?Array(4).fill(0).map((e,t)=>(0,xn.jsxs)("tr",{className:"table-row-hover",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-12 w-12 bg-slate-200 rounded skeleton"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-40"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-64"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-24"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-32"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-6 bg-slate-200 rounded skeleton w-20"})})]},t)):h.length>0?h.map(e=>(0,xn.jsxs)("tr",{className:"table-row-hover hover:bg-slate-50 transition-colors duration-150",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("div",{className:"h-12 w-12 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border border-slate-200",children:e.logoUrl?(0,xn.jsx)("img",{src:e.logoUrl,alt:e.title,className:"logo-img",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div class="text-slate-400"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>'}}):(0,xn.jsx)(ev,{className:"w-6 h-6 text-slate-400"})})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-slate-800",children:e.title}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-md truncate",children:e.description}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 hover:underline",children:[(0,xn.jsx)(xb,{className:"w-4 h-4"}),"Visit"]})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.addedDate}),(0,xn.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.addedBy}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)("button",{onClick:()=>r(e),className:"p-1.5 hover:bg-blue-50 rounded-lg transition-colors duration-150 text-blue-600 hover:text-blue-700",title:"Edit",children:(0,xn.jsx)(za,{className:"w-4 h-4"})}),(0,xn.jsx)("button",{onClick:()=>u(e.id),className:"p-1.5 hover:bg-red-50 rounded-lg transition-colors duration-150 text-red-600 hover:text-red-700",title:"Delete",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})]})})]},e.id)):(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"7",className:"px-6 py-12",children:(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,xn.jsx)(tv,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-500 font-medium",children:"No resources found"}),(0,xn.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new link"})]})})})})]})})}),(0,xn.jsx)("div",{className:"md:hidden space-y-4 ".concat(n?"opacity-0":"animate-fadeInUp"),style:{animationDelay:"250ms",animationFillMode:"both"},children:n?Array(4).fill(0).map((e,t)=>(0,xn.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-4",children:[(0,xn.jsxs)("div",{className:"flex items-start gap-4 mb-3",children:[(0,xn.jsx)("div",{className:"h-16 w-16 bg-slate-200 rounded-lg skeleton flex-shrink-0"}),(0,xn.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,xn.jsx)("div",{className:"h-5 bg-slate-200 rounded skeleton w-3/4"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-full"})]})]}),(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-1/2"}),(0,xn.jsx)("div",{className:"h-4 bg-slate-200 rounded skeleton w-2/3"})]})]},t)):h.length>0?h.map(e=>(0,xn.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,xn.jsx)("div",{className:"p-4 border-b border-slate-100",children:(0,xn.jsxs)("div",{className:"flex items-start gap-4",children:[(0,xn.jsx)("div",{className:"h-16 w-16 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border border-slate-200 flex-shrink-0",children:e.logoUrl?(0,xn.jsx)("img",{src:e.logoUrl,alt:e.title,className:"logo-img",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div class="text-slate-400"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>'}}):(0,xn.jsx)(ev,{className:"w-8 h-8 text-slate-400"})}),(0,xn.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,xn.jsx)("h3",{className:"text-base font-semibold text-slate-800 mb-1",children:e.title}),(0,xn.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2",children:e.description})]})]})}),(0,xn.jsxs)("div",{className:"p-4 space-y-3",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsx)("span",{className:"text-xs text-slate-500 font-medium",children:"Link"}),(0,xn.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 hover:underline font-medium",children:[(0,xn.jsx)(xb,{className:"w-4 h-4"}),"Visit Website"]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t border-slate-100",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("span",{className:"text-xs text-slate-500 block mb-1",children:"Added Date"}),(0,xn.jsx)("span",{className:"text-sm text-slate-700 font-medium",children:e.addedDate})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("span",{className:"text-xs text-slate-500 block mb-1",children:"Added By"}),(0,xn.jsx)("span",{className:"text-sm text-slate-700 font-medium",children:e.addedBy})]})]})]}),(0,xn.jsxs)("div",{className:"px-4 py-3 bg-slate-50 border-t border-slate-100 flex items-center justify-end gap-2",children:[(0,xn.jsxs)("button",{onClick:()=>r(e),className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-150",children:[(0,xn.jsx)(za,{className:"w-4 h-4"}),"Edit"]}),(0,xn.jsxs)("button",{onClick:()=>u(e.id),className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-150",children:[(0,xn.jsx)(Pa,{className:"w-4 h-4"}),"Delete"]})]})]},e.id)):(0,xn.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-12",children:(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,xn.jsx)(tv,{className:"w-12 h-12 text-slate-300 mb-4"}),(0,xn.jsx)("p",{className:"text-slate-500 font-medium",children:"No resources found"}),(0,xn.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:i?"Try adjusting your search":"Start by adding a new link"})]})})}),(0,xn.jsx)("div",{className:"fixed bottom-6 right-6 z-30",children:(0,xn.jsx)("button",{onClick:()=>{d()},className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 group",title:"Refresh",children:(0,xn.jsx)(la,{className:"w-5 h-5 ".concat(n?"animate-spin":"group-hover:rotate-180 transition-transform duration-300")})})}),(0,xn.jsx)("div",{className:"h-8"})]})]})}function av(e){let{onClose:t,initialItem:r,isEditMode:n}=e;const[a,i]=(0,s.useState)({title:"",link:"",description:"",logoUrl:""}),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)({});(0,s.useEffect)(()=>{n&&r&&(i({title:r.title||"",link:r.link||"",description:r.description||"",logoUrl:r.logoUrl||""}),r.logoUrl&&d(r.logoUrl))},[n,r]);const p=e=>{const{name:t,value:r}=e.target;i(e=>We(We({},e),{},{[t]:r})),f[t]&&m(e=>We(We({},e),{},{[t]:""}))};return(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,xn.jsx)(tv,{className:"w-5 h-5 text-white"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h2",{className:"text-xl font-bold text-white",children:n?"Edit Resource":"Add New Resource"}),(0,xn.jsx)("p",{className:"text-blue-100 text-sm",children:n?"Update resource information":"Add a new logistics resource link"})]})]}),(0,xn.jsx)("button",{onClick:()=>t(),className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors duration-200",children:(0,xn.jsx)(Ln,{className:"w-5 h-5"})})]}),(0,xn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return a.title.trim()||(e.title="Title is required"),a.link.trim()||(e.link="Link is required"),a.description.trim()||(e.description="Description is required"),n||o||c||(e.logo="Logo is required"),m(e),0===Object.keys(e).length})()){h(!0),console.log("this ");try{const e=new FormData;e.append("title",a.title),e.append("link",a.link),e.append("description",a.description),o?e.append("logoFile",o):a.logoUrl&&e.append("logoUrl",a.logoUrl);const s=n?r.addedDate:(new Date).toISOString().split("T")[0];e.append("addedDate",s),e.append("addedBy","Kavindu Tharaka");for(let[t,r]of e.entries())console.log(t,r);let i;n?(e.append("sysID",r.id),await rv.updateResource(e),i=We(We(We({},r),a),{},{logoUrl:c||a.logoUrl})):(await rv.createNewResource(e),i=We(We({id:Date.now()},a),{},{logoUrl:c||a.logoUrl,addedDate:s,addedBy:"Kavindu Tharaka"})),t(i),window.location.reload()}catch(s){console.error("Error saving item:",s),m({submit:"Failed to save. Please try again."})}finally{h(!1)}}},className:"p-6 space-y-5",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Title ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",name:"title",value:a.title,onChange:p,placeholder:"e.g., Sri Lanka Ports Authority",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(f.title?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),f.title&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.title})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Link URL ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)(tv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,xn.jsx)("input",{type:"url",name:"link",value:a.link,onChange:p,placeholder:"https://example.com",className:"w-full pl-10 pr-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ".concat(f.link?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")})]}),f.link&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.link})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Description ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("textarea",{name:"description",value:a.description,onChange:p,placeholder:"Brief description of this resource...",rows:"3",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 resize-none ".concat(f.description?"border-red-300 focus:ring-red-500":"border-slate-300 focus:ring-blue-500")}),f.description&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.description})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Logo ",!n&&(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsxs)("div",{className:"flex gap-4",children:[c&&(0,xn.jsx)("div",{className:"shrink-0",children:(0,xn.jsx)("div",{className:"h-24 w-24 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border-2 border-slate-200",children:(0,xn.jsx)("img",{src:c,alt:"Logo preview",className:"max-h-full max-w-full object-contain"})})}),(0,xn.jsx)("div",{className:"flex-1",children:(0,xn.jsxs)("label",{htmlFor:"logo-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed rounded-lg cursor-pointer transition-all duration-200 ".concat(f.logo?"border-red-300 bg-red-50 hover:bg-red-100":"border-slate-300 bg-slate-50 hover:bg-slate-100"),children:[(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center pt-2 pb-2",children:[(0,xn.jsx)(Za,{className:"w-6 h-6 mb-1 ".concat(f.logo?"text-red-400":"text-slate-400")}),(0,xn.jsxs)("p",{className:"text-xs ".concat(f.logo?"text-red-600":"text-slate-500"),children:[(0,xn.jsx)("span",{className:"font-medium",children:"Click to upload"})," or drag and drop"]}),(0,xn.jsx)("p",{className:"text-xs text-slate-400 mt-0.5",children:"PNG, JPG, GIF up to 5MB"})]}),(0,xn.jsx)("input",{id:"logo-upload",type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return void m(e=>We(We({},e),{},{logo:"Please select a valid image file"}));if(t.size>5242880)return void m(e=>We(We({},e),{},{logo:"File size must be less than 5MB"}));l(t);const e=new FileReader;e.onloadend=()=>{d(e.result)},e.readAsDataURL(t),f.logo&&m(e=>We(We({},e),{},{logo:""}))}},className:"hidden"})]})})]}),f.logo&&(0,xn.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:f.logo})]}),f.submit&&(0,xn.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:f.submit}),(0,xn.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[(0,xn.jsx)("button",{type:"button",onClick:()=>t(),disabled:u,className:"px-5 py-2.5 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,xn.jsx)("button",{type:"submit",disabled:u,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)($a,{className:"w-4 h-4 animate-spin"}),(0,xn.jsx)("span",{children:"Saving..."})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(qa,{className:"w-4 h-4"}),(0,xn.jsx)("span",{children:n?"Update":"Save"})]})})]})]})]})}function sv(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),o=()=>{t(!1),i(null)};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(nv,{modalOpen:()=>{i(null),t(!0)},onEdit:e=>{i(e),t(!0)}})})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:o}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full max-w-2xl animate-fadeIn",children:(0,xn.jsx)(av,{onClose:e=>{o()},initialItem:a,isEditMode:!!a})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const iv=En("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),ov=En("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),lv=En("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),cv=En("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),dv=En("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),uv=En("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),hv=e=>{let{employees:t,selectedRole:r,isEditMode:n,onClose:a,onSuccess:i}=e;const[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)({employeeId:"",username:"",password:"",isAdmin:!1,isActive:!0,rateManageView:!1,rateManageAdd:!1,rateManageEdit:!1,usefulLinksView:!1,usefulLinksAdd:!1,usefulLinksEdit:!1,salesPlanView:!1,salesPlanAdd:!1,salesPlanEdit:!1,quotesView:!1,quotesAdd:!1,quotesEdit:!1,rfqView:!1,rfqAdd:!1,rfqEdit:!1,contactView:!1,contactAdd:!1,contactEdit:!1,accountView:!1,accountAdd:!1,accountEdit:!1,systemManagementView:!1,systemManagementAdd:!1,systemManagementEdit:!1}),f=[{name:"Rate Manage",key:"rateManage",icon:ov,color:"text-blue-600",bgColor:"bg-blue-100"},{name:"Useful Links",key:"usefulLinks",icon:tv,color:"text-green-600",bgColor:"bg-green-100"},{name:"Sales Plan",key:"salesPlan",icon:Bn,color:"text-purple-600",bgColor:"bg-purple-100"},{name:"Quotes",key:"quotes",icon:Wn,color:"text-orange-600",bgColor:"bg-orange-100"},{name:"RFQ",key:"rfq",icon:lv,color:"text-pink-600",bgColor:"bg-pink-100"},{name:"Contact",key:"contact",icon:$x,color:"text-indigo-600",bgColor:"bg-indigo-100"},{name:"Account",key:"account",icon:Xn,color:"text-teal-600",bgColor:"bg-teal-100"},{name:"System Management",key:"systemManagement",icon:cv,color:"text-red-600",bgColor:"bg-red-100"}];(0,s.useEffect)(()=>{n&&r&&h({employeeId:r.employeeId||"",username:r.username||"",password:"",isAdmin:r.isAdmin||!1,isActive:void 0===r.isActive||r.isActive,rateManageView:r.rateManageView||!1,rateManageAdd:r.rateManageAdd||!1,rateManageEdit:r.rateManageEdit||!1,usefulLinksView:r.usefulLinksView||!1,usefulLinksAdd:r.usefulLinksAdd||!1,usefulLinksEdit:r.usefulLinksEdit||!1,salesPlanView:r.salesPlanView||!1,salesPlanAdd:r.salesPlanAdd||!1,salesPlanEdit:r.salesPlanEdit||!1,quotesView:r.quotesView||!1,quotesAdd:r.quotesAdd||!1,quotesEdit:r.quotesEdit||!1,rfqView:r.rfqView||!1,rfqAdd:r.rfqAdd||!1,rfqEdit:r.rfqEdit||!1,contactView:r.contactView||!1,contactAdd:r.contactAdd||!1,contactEdit:r.contactEdit||!1,accountView:r.accountView||!1,accountAdd:r.accountAdd||!1,accountEdit:r.accountEdit||!1,systemManagementView:r.systemManagementView||!1,systemManagementAdd:r.systemManagementAdd||!1,systemManagementEdit:r.systemManagementEdit||!1})},[r,n]);const m=e=>{const{name:t,value:r,type:n,checked:a}=e.target;h(e=>We(We({},e),{},{[t]:"checkbox"===n?a:r}))},p=(e,t)=>{const r="".concat(e).concat(t);h(e=>We(We({},e),{},{[r]:!e[r]}))},g=t.find(e=>e.id===u.employeeId);return(0,xn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),u.employeeId?u.username.trim()?n||u.password.trim()?!(u.password&&u.password.length<6)||(alert("Password must be at least 6 characters long"),0):(alert("Please enter a password"),0):(alert("Please enter a username"),0):(alert("Please select an employee"),0))try{l(!0);const e=(e=>{const t={EmployeeId:e.employeeId,Username:e.username,IsAdmin:e.isAdmin,IsActive:e.isActive,RateManageView:e.rateManageView,RateManageAdd:e.rateManageAdd,RateManageEdit:e.rateManageEdit,UsefulLinksView:e.usefulLinksView,UsefulLinksAdd:e.usefulLinksAdd,UsefulLinksEdit:e.usefulLinksEdit,SalesPlanView:e.salesPlanView,SalesPlanAdd:e.salesPlanAdd,SalesPlanEdit:e.salesPlanEdit,QuotesView:e.quotesView,QuotesAdd:e.quotesAdd,QuotesEdit:e.quotesEdit,RfqView:e.rfqView,RfqAdd:e.rfqAdd,RfqEdit:e.rfqEdit,ContactView:e.contactView,ContactAdd:e.contactAdd,ContactEdit:e.contactEdit,AccountView:e.accountView,AccountAdd:e.accountAdd,AccountEdit:e.accountEdit,SystemManagementView:e.systemManagementView,SystemManagementAdd:e.systemManagementAdd,SystemManagementEdit:e.systemManagementEdit};return e.password&&e.password.trim()&&(t.Password=e.password),t})(u);console.log("this is y: ",e),n?(await Dn.updateUserRole(r.id,e),alert("User role updated successfully!")):(await Dn.createUserRole(e),alert("User role created successfully!")),i()}catch(c){var t,a,s,o;console.error("Error saving user role:",c);const e=(null===(t=c.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===(s=c.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.Message)||"Failed to save user role. Please try again.";alert(e)}finally{l(!1)}},className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(Fn,{className:"w-5 h-5 text-purple-600"}),"Employee Information"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Employee ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsxs)("select",{name:"employeeId",value:u.employeeId,onChange:m,disabled:n,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",required:!0,children:[(0,xn.jsx)("option",{value:"",children:"-- Select Employee --"}),t.map(e=>(0,xn.jsxs)("option",{value:e.id,children:[e.fullName," - ",e.sysID]},e.id))]})]}),g&&(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:(0,xn.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,xn.jsxs)("p",{children:[(0,xn.jsx)("span",{className:"font-medium",children:"Department:"})," ",g.department||"N/A"]}),(0,xn.jsxs)("p",{children:[(0,xn.jsx)("span",{className:"font-medium",children:"Position:"})," ",g.position||"N/A"]}),(0,xn.jsxs)("p",{children:[(0,xn.jsx)("span",{className:"font-medium",children:"Email:"})," ",g.email||"N/A"]}),(0,xn.jsxs)("p",{children:[(0,xn.jsx)("span",{className:"font-medium",children:"Location:"})," ",g.location||"N/A"]})]})})]})]}),(0,xn.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(iv,{className:"w-5 h-5 text-purple-600"}),"Login Credentials"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username ",(0,xn.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,xn.jsx)("input",{type:"text",name:"username",value:u.username,onChange:m,placeholder:"Enter username",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",!n&&(0,xn.jsx)("span",{className:"text-red-500",children:"*"}),n&&(0,xn.jsx)("span",{className:"text-sm text-gray-500",children:"(Leave empty to keep current)"})]}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("input",{type:c?"text":"password",name:"password",value:u.password,onChange:m,placeholder:n?"Enter new password":"Enter password",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!n}),(0,xn.jsx)("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:c?(0,xn.jsx)(Mb,{className:"w-5 h-5"}):(0,xn.jsx)(fa,{className:"w-5 h-5"})})]})]})]})]}),(0,xn.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:(0,xn.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,xn.jsx)("input",{type:"checkbox",name:"isActive",checked:u.isActive,onChange:m,className:"w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Active Status"}),(0,xn.jsx)("p",{className:"text-sm text-gray-500",children:"User can log in and access assigned modules"})]})]})}),(0,xn.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,xn.jsxs)("div",{className:"bg-purple-50 px-6 py-4 border-b border-purple-100 flex items-center justify-between",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,xn.jsx)($n,{className:"w-5 h-5 text-purple-600"}),"Module Permissions"]}),(0,xn.jsxs)("button",{type:"button",onClick:()=>{const e=f.every(e=>u["".concat(e.key,"View")]&&u["".concat(e.key,"Add")]&&u["".concat(e.key,"Edit")]),t={};f.forEach(r=>{t["".concat(r.key,"View")]=!e,t["".concat(r.key,"Add")]=!e,t["".concat(r.key,"Edit")]=!e}),h(e=>We(We({},e),t))},className:"text-sm text-purple-600 hover:text-purple-700 font-medium flex items-center gap-1",children:[(0,xn.jsx)(dv,{className:"w-4 h-4"}),"Select All"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/3",children:"Module"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-20",children:"View"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-20",children:"Add"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-20",children:"Edit"}),(0,xn.jsx)("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-24",children:"All"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-gray-200",children:f.map(e=>{const t=e.icon,r=u["".concat(e.key,"View")]&&u["".concat(e.key,"Add")]&&u["".concat(e.key,"Edit")];return(0,xn.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"p-2 rounded-lg ".concat(e.bgColor),children:(0,xn.jsx)(t,{className:"w-5 h-5 ".concat(e.color)})}),(0,xn.jsx)("span",{className:"font-medium text-gray-900",children:e.name})]})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-center",children:(0,xn.jsx)("button",{type:"button",onClick:()=>p(e.key,"View"),className:"inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-100 transition-colors",children:u["".concat(e.key,"View")]?(0,xn.jsx)(dv,{className:"w-5 h-5 text-purple-600"}):(0,xn.jsx)(uv,{className:"w-5 h-5 text-gray-400"})})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-center",children:(0,xn.jsx)("button",{type:"button",onClick:()=>p(e.key,"Add"),className:"inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-100 transition-colors",children:u["".concat(e.key,"Add")]?(0,xn.jsx)(dv,{className:"w-5 h-5 text-green-600"}):(0,xn.jsx)(uv,{className:"w-5 h-5 text-gray-400"})})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-center",children:(0,xn.jsx)("button",{type:"button",onClick:()=>p(e.key,"Edit"),className:"inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-100 transition-colors",children:u["".concat(e.key,"Edit")]?(0,xn.jsx)(dv,{className:"w-5 h-5 text-blue-600"}):(0,xn.jsx)(uv,{className:"w-5 h-5 text-gray-400"})})}),(0,xn.jsx)("td",{className:"px-6 py-4 text-center",children:(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{const t=u["".concat(e,"View")]&&u["".concat(e,"Add")]&&u["".concat(e,"Edit")];h(r=>We(We({},r),{},{["".concat(e,"View")]:!t,["".concat(e,"Add")]:!t,["".concat(e,"Edit")]:!t}))})(e.key),className:"px-3 py-1 rounded-full text-sm font-medium transition-colors ".concat(r?"bg-purple-100 text-purple-700 hover:bg-purple-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:r?"All":"None"})})]},e.key)})})]})})]}),(0,xn.jsx)("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 rounded-lg p-6 border border-red-200",children:(0,xn.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,xn.jsx)("input",{type:"checkbox",name:"isAdmin",checked:u.isAdmin,onChange:m,className:"w-5 h-5 text-red-600 border-gray-300 rounded focus:ring-red-500 mt-0.5"}),(0,xn.jsxs)("div",{className:"flex-1",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,xn.jsx)($n,{className:"w-5 h-5 text-red-600"}),(0,xn.jsx)("span",{className:"text-sm font-bold text-red-900",children:"Administrator Access"})]}),(0,xn.jsx)("p",{className:"text-sm text-red-700",children:"Grant full system access with administrative privileges. Administrators can manage all modules, users, and system settings regardless of individual permissions."})]})]})}),(0,xn.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,xn.jsxs)("button",{type:"button",onClick:a,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",disabled:o,children:[(0,xn.jsx)(Ln,{className:"w-5 h-5"}),"Cancel"]}),(0,xn.jsx)("button",{type:"submit",className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:o,children:o?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(qa,{className:"w-5 h-5"}),n?"Update Role":"Create Role"]})})]})]})},fv=e=>{let{employees:t,selectedRole:r,isEditMode:n,onClose:a,onSuccess:i}=e;const o=(0,s.useRef)(null);return(0,s.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&a()},t=e=>{"Escape"===e.key&&a()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),document.body.style.overflow="hidden",()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[a]),(0,xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,xn.jsxs)("div",{ref:o,className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,xn.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4 flex items-center justify-between",children:[(0,xn.jsx)("h2",{className:"text-xl font-bold text-white",children:n?"Edit User Role & Permissions":"Create New User Role"}),(0,xn.jsx)("button",{onClick:a,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1 transition-colors",children:(0,xn.jsx)(Ln,{className:"w-6 h-6"})})]}),(0,xn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,xn.jsx)(hv,{employees:t,selectedRole:r,isEditMode:n,onClose:a,onSuccess:i})})]})})};function mv(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(0),[u,h]=(0,s.useState)([]),[f,m]=(0,s.useState)([]),[p,g]=(0,s.useState)([]),[x,b]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N(),w()},[c]),(0,s.useEffect)(()=>{j()},[x,f]);const w=async()=>{try{const e=(await rb()).map(e=>({id:e.sysID.toString(),sysID:e.sysID,firstName:e.fname,lastName:e.lname,fullName:"".concat(e.fname," ").concat(e.lname),email:e.email,phone:e.tp,position:e.position,department:e.department,location:e.w_location,manager:e.a_manager,status:e.status}));h(e)}catch(e){console.error("Error fetching employees:",e)}},N=async()=>{try{y(!0);const e=await Dn.fetchUserRoles();console.log("bbbb: ",e);const t=e.map(e=>({id:e.id,employeeId:e.employeeId,employeeName:e.employeeName||"Unknown Employee",username:e.username,isAdmin:e.isAdmin,isActive:e.isActive,rateManageView:e.rateManageView,rateManageAdd:e.rateManageAdd,rateManageEdit:e.rateManageEdit,usefulLinksView:e.usefulLinksView,usefulLinksAdd:e.usefulLinksAdd,usefulLinksEdit:e.usefulLinksEdit,salesPlanView:e.salesPlanView,salesPlanAdd:e.salesPlanAdd,salesPlanEdit:e.salesPlanEdit,quotesView:e.quotesView,quotesAdd:e.quotesAdd,quotesEdit:e.quotesEdit,rfqView:e.rfqView,rfqAdd:e.rfqAdd,rfqEdit:e.rfqEdit,contactView:e.contactView,contactAdd:e.contactAdd,contactEdit:e.contactEdit,accountView:e.accountView,accountAdd:e.accountAdd,accountEdit:e.accountEdit,systemManagementView:e.systemManagementView,systemManagementAdd:e.systemManagementAdd,systemManagementEdit:e.systemManagementEdit,createdAt:e.createdAt,updatedAt:e.updatedAt}));m(t),g(t)}catch(e){console.error("Error fetching user roles:",e),alert("Failed to load user roles. Please try again.")}finally{y(!1)}},j=()=>{if(!x.trim())return void g(f);const e=f.filter(e=>{var t,r,n;return(null===(t=e.employeeName)||void 0===t?void 0:t.toLowerCase().includes(x.toLowerCase()))||(null===(r=e.username)||void 0===r?void 0:r.toLowerCase().includes(x.toLowerCase()))||(null===(n=e.employeeId)||void 0===n?void 0:n.toLowerCase().includes(x.toLowerCase()))});g(e)},k=()=>{t(!1),i(null),l(!1)},S=e=>{i(e),l(!0),t(!0)},A=async e=>{if(window.confirm("Are you sure you want to delete this user role? This will revoke all access permissions."))try{await Dn.deleteUserRole(e),d(e=>e+1),alert("User role deleted successfully!")}catch(n){var t,r;console.error("Error deleting user role:",n),alert((null===(t=n.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Failed to delete user role. Please try again.")}};return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsxs)("main",{className:"flex-1 overflow-y-auto p-6",children:[(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,xn.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,xn.jsx)($n,{className:"w-6 h-6 text-purple-600"})}),(0,xn.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Employee Role Management"})]}),(0,xn.jsx)("p",{className:"text-gray-600 ml-14",children:"Manage employee access permissions and system roles"})]}),(0,xn.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,xn.jsxs)("div",{className:"flex-1 relative",children:[(0,xn.jsx)(ha,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,xn.jsx)("input",{type:"text",placeholder:"Search by employee name, username, or ID...",value:x,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,xn.jsxs)("button",{onClick:()=>{i(null),l(!1),t(!0)},className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:[(0,xn.jsx)(da,{className:"w-5 h-5"}),"Add User Role"]})]})}),(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,xn.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full",children:[(0,xn.jsx)("thead",{className:"bg-purple-50 border-b border-purple-100",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Employee"}),(0,xn.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Username"}),(0,xn.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Role Type"}),(0,xn.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Permissions"}),(0,xn.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Status"}),(0,xn.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-purple-900 uppercase tracking-wider",children:"Actions"})]})}),(0,xn.jsx)("tbody",{className:"divide-y divide-gray-200",children:v?(0,xn.jsx)("tr",{children:(0,xn.jsx)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:(0,xn.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,xn.jsx)("div",{className:"w-5 h-5 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"}),"Loading user roles..."]})})}):0===p.length?(0,xn.jsx)("tr",{children:(0,xn.jsxs)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:[(0,xn.jsx)($x,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,xn.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-1",children:"No user roles found"}),(0,xn.jsx)("p",{className:"text-sm text-gray-500",children:x?"Try adjusting your search criteria":'Click "Add User Role" to create the first one'})]})}):p.map(e=>{const t=[e.rateManageView,e.rateManageAdd,e.rateManageEdit,e.usefulLinksView,e.usefulLinksAdd,e.usefulLinksEdit,e.salesPlanView,e.salesPlanAdd,e.salesPlanEdit,e.quotesView,e.quotesAdd,e.quotesEdit,e.rfqView,e.rfqAdd,e.rfqEdit,e.contactView,e.contactAdd,e.contactEdit,e.accountView,e.accountAdd,e.accountEdit,e.systemManagementView,e.systemManagementAdd,e.systemManagementEdit].filter(Boolean).length;return(0,xn.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:(0,xn.jsx)($x,{className:"w-5 h-5 text-purple-600"})}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("div",{className:"font-medium text-gray-900",children:e.employeeName}),(0,xn.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.employeeId]})]})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(iv,{className:"w-4 h-4 text-gray-400"}),(0,xn.jsx)("span",{className:"text-gray-900 font-medium",children:e.username})]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:e.isAdmin?(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:[(0,xn.jsx)($n,{className:"w-4 h-4"}),"Administrator"]}):(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[(0,xn.jsx)($x,{className:"w-4 h-4"}),"Standard User"]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("span",{className:"text-sm text-gray-600",children:[t," permissions assigned"]})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsx)("span",{className:"inline-flex px-3 py-1 rounded-full text-sm font-medium ".concat(e.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.isActive?"Active":"Inactive"})}),(0,xn.jsx)("td",{className:"px-6 py-4",children:(0,xn.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,xn.jsx)("button",{onClick:()=>S(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Role",children:(0,xn.jsx)(La,{className:"w-4 h-4"})}),(0,xn.jsx)("button",{onClick:()=>A(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Role",children:(0,xn.jsx)(Pa,{className:"w-4 h-4"})})]})})]},e.id)})})]})}),(0,xn.jsx)("div",{className:"md:hidden p-4 space-y-4",children:v?(0,xn.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-12",children:(0,xn.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,xn.jsx)("div",{className:"w-8 h-8 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"}),(0,xn.jsx)("p",{className:"text-gray-500",children:"Loading user roles..."})]})}):0===p.length?(0,xn.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-12",children:(0,xn.jsxs)("div",{className:"text-center",children:[(0,xn.jsx)($x,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,xn.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-1",children:"No user roles found"}),(0,xn.jsx)("p",{className:"text-sm text-gray-500",children:x?"Try adjusting your search criteria":'Click "Add User Role" to create the first one'})]})}):p.map(e=>{const t=[e.rateManageView,e.rateManageAdd,e.rateManageEdit,e.usefulLinksView,e.usefulLinksAdd,e.usefulLinksEdit,e.salesPlanView,e.salesPlanAdd,e.salesPlanEdit,e.quotesView,e.quotesAdd,e.quotesEdit,e.rfqView,e.rfqAdd,e.rfqEdit,e.contactView,e.contactAdd,e.contactEdit,e.accountView,e.accountAdd,e.accountEdit,e.systemManagementView,e.systemManagementAdd,e.systemManagementEdit].filter(Boolean).length;return(0,xn.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,xn.jsxs)("div",{className:"p-4 bg-purple-50 border-b border-purple-100",children:[(0,xn.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,xn.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,xn.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,xn.jsx)($x,{className:"w-6 h-6 text-purple-600"})}),(0,xn.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,xn.jsx)("h3",{className:"font-semibold text-gray-900 text-base mb-1",children:e.employeeName}),(0,xn.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:["ID: ",e.employeeId]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsx)(iv,{className:"w-3 h-3 text-gray-400"}),(0,xn.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:e.username})]})]})]})}),(0,xn.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[e.isAdmin?(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:[(0,xn.jsx)($n,{className:"w-3 h-3"}),"Administrator"]}):(0,xn.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[(0,xn.jsx)($x,{className:"w-3 h-3"}),"Standard User"]}),(0,xn.jsx)("span",{className:"inline-flex px-3 py-1 rounded-full text-xs font-medium ".concat(e.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.isActive?"Active":"Inactive"})]})]}),(0,xn.jsxs)("div",{className:"p-4",children:[(0,xn.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 mb-4",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,xn.jsx)($n,{className:"w-4 h-4 text-purple-600"}),(0,xn.jsx)("span",{className:"text-xs font-semibold text-purple-900",children:"Permissions"})]}),(0,xn.jsxs)("div",{className:"text-lg font-bold text-purple-700",children:[t," assigned"]})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsxs)("button",{onClick:()=>S(e),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,xn.jsx)(La,{className:"w-4 h-4"}),"Edit Role"]}),(0,xn.jsxs)("button",{onClick:()=>A(e.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[(0,xn.jsx)(Pa,{className:"w-4 h-4"}),"Delete"]})]})]})]},e.id)})})]})]})]}),e&&(0,xn.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,xn.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:k}),(0,xn.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,xn.jsx)("div",{className:"relative w-full animate-fadeIn",children:(0,xn.jsx)(fv,{employees:u,selectedRole:a,isEditMode:o,onClose:k,onSuccess:()=>{d(e=>e+1),k()}})})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const pv=function(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(!1),[c]=(0,s.useState)({sysID:9,fname:"Tharanga",lname:"Liyanage",email:"Tharanga@gmail.com",tp:"0781447845",position:"Forklift Operator",department:"Supply Chain",w_location:"Colombo",a_manager:"Jane Smith",note:"Demo",status:"Active",username:""}),[d,u]=(0,s.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),h=(e,t)=>{u(r=>We(We({},r),{},{[e]:t}))};return(0,xn.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 p-4 md:p-6 lg:p-8",children:(0,xn.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsx)("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"My Profile"}),(0,xn.jsx)("p",{className:"text-slate-600",children:"Manage your personal information and account settings"})]}),(0,xn.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,xn.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 h-32 relative",children:(0,xn.jsx)("div",{className:"absolute -bottom-16 left-8",children:(0,xn.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full w-32 h-32 flex items-center justify-center text-3xl font-bold shadow-lg border-4 border-white",children:"".concat(c.fname.charAt(0)).concat(c.lname.charAt(0))})})}),(0,xn.jsxs)("div",{className:"pt-20 px-8 pb-8",children:[(0,xn.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h2",{className:"text-2xl font-bold text-slate-800",children:[c.fname," ",c.lname]}),(0,xn.jsx)("p",{className:"text-slate-600 mt-1",children:c.position})]}),(0,xn.jsxs)("span",{className:"px-4 py-1.5 rounded-full text-sm font-medium ".concat("Active"===c.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[(0,xn.jsx)(Zx,{className:"w-4 h-4 inline mr-1"}),c.status]})]}),(0,xn.jsxs)("div",{className:"mb-8",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(Fn,{className:"w-5 h-5 text-blue-600"}),"Personal Information"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"First Name"}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.fname})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Last Name"}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.lname})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)(Hn,{className:"w-4 h-4 text-blue-600"}),"Email Address"]}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.email})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)(qx,{className:"w-4 h-4 text-blue-600"}),"Phone Number"]}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.tp})]})]})]}),(0,xn.jsxs)("div",{className:"mb-8",children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)(Xn,{className:"w-5 h-5 text-blue-600"}),"Work Information"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Position"}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.position})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)(Yn,{className:"w-4 h-4 text-blue-600"}),"Department"]}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.department})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)(_a,{className:"w-4 h-4 text-blue-600"}),"Work Location"]}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.w_location})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)($x,{className:"w-4 h-4 text-blue-600"}),"Assigned Manager"]}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.a_manager})]}),(0,xn.jsxs)("div",{className:"md:col-span-2",children:[(0,xn.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,xn.jsx)(Wn,{className:"w-4 h-4 text-blue-600"}),"Notes"]}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800",children:c.note||"No notes added"})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[(0,xn.jsx)($n,{className:"w-5 h-5 text-blue-600"}),"Account Security"]}),(0,xn.jsxs)("div",{className:"mb-4",children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),(0,xn.jsx)("div",{className:"px-4 py-2.5 bg-slate-50 rounded-lg text-slate-800 border border-slate-200",children:c.username})]}),a?(0,xn.jsx)("div",{className:"bg-slate-50 rounded-lg p-6 border border-slate-200",children:(0,xn.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Current Password"}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("input",{type:e?"text":"password",value:d.currentPassword,onChange:e=>h("currentPassword",e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all pr-10",placeholder:"Enter current password"}),(0,xn.jsx)("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:e?(0,xn.jsx)(Mb,{className:"w-5 h-5"}):(0,xn.jsx)(fa,{className:"w-5 h-5"})})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"New Password"}),(0,xn.jsx)("input",{type:"password",value:d.newPassword,onChange:e=>h("newPassword",e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter new password (min. 6 characters)"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Confirm New Password"}),(0,xn.jsxs)("div",{className:"relative",children:[(0,xn.jsx)("input",{type:r?"text":"password",value:d.confirmPassword,onChange:e=>h("confirmPassword",e.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all pr-10",placeholder:"Confirm new password"}),(0,xn.jsx)("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:r?(0,xn.jsx)(Mb,{className:"w-5 h-5"}):(0,xn.jsx)(fa,{className:"w-5 h-5"})})]})]}),d.newPassword&&(0,xn.jsxs)("div",{className:"text-xs text-slate-600",children:["Password strength:",(0,xn.jsx)("span",{className:"ml-2 font-medium ".concat(d.newPassword.length<6?"text-red-600":d.newPassword.length<10?"text-yellow-600":"text-green-600"),children:d.newPassword.length<6?"Weak":d.newPassword.length<10?"Medium":"Strong"})]}),(0,xn.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,xn.jsx)("button",{onClick:async()=>{d.newPassword===d.confirmPassword?d.newPassword.length<6?alert("Password must be at least 6 characters!"):(l(!0),setTimeout(()=>{console.log("Password updated"),u({currentPassword:"",newPassword:"",confirmPassword:""}),i(!1),l(!1),alert("Password updated successfully!")},1e3)):alert("Passwords don't match!")},disabled:o||!d.currentPassword||!d.newPassword||!d.confirmPassword,className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Updating...":"Update Password"}),(0,xn.jsx)("button",{onClick:()=>{i(!1),u({currentPassword:"",newPassword:"",confirmPassword:""})},className:"px-4 py-2.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg transition-all duration-200 font-medium",children:"Cancel"})]})]})}):(0,xn.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 font-medium",children:"Change Password"})]})]})]})]})})};function gv(){const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null);return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{n(!r)},isMobileMenuOpen:r}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:r,onClose:()=>{n(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(pv,{})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const xv=En("file-down",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),bv=En("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function vv(e){let{label:t,value:r,onChange:n,suggestions:a=[],placeholder:i="",showLabel:o=!0,disabled:l=!1}=e;const[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)(0),[p,g]=(0,s.useState)({}),x=(0,s.useRef)(null),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&h(!1)},t=()=>{u&&h(!1)};return document.addEventListener("mousedown",e),window.addEventListener("scroll",t,!0),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t,!0)}},[u]),(0,s.useEffect)(()=>{if(u&&b.current){const e=b.current.getBoundingClientRect();g({position:"fixed",top:"".concat(e.bottom+2,"px"),left:"".concat(e.left,"px"),width:"".concat(e.width,"px"),zIndex:9999})}},[u,r]);const v=e=>{n(e),d([]),h(!1),m(0)};return(0,xn.jsxs)("div",{ref:x,className:"relative",children:[o&&t&&(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,xn.jsx)("input",{ref:b,type:"text",value:r,onChange:e=>{const t=e.target.value;n(t);const r=a.filter(e=>e.toLowerCase().includes(t.toLowerCase())).slice(0,5);d(r),h(!0),m(0)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),u&&c[f]&&v(c[f])):"ArrowUp"===e.key?(e.preventDefault(),f>0&&m(f-1)):"ArrowDown"===e.key?(e.preventDefault(),f<c.length-1&&m(f+1)):"Escape"===e.key&&h(!1)},onFocus:()=>{if(a.length>0&&!l){const e=a.slice(0,5);d(e),h(!0)}},placeholder:i||(t?"Enter ".concat(t.toLowerCase(),"..."):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",autoComplete:"off",disabled:l}),u&&c.length>0&&!l&&(0,xn.jsx)("ul",{style:p,className:"bg-white border border-gray-300 rounded-lg mt-1 shadow-lg overflow-hidden",children:c.map((e,t)=>(0,xn.jsx)("li",{onClick:()=>v(e),onMouseEnter:()=>m(t),className:"px-3 py-2 cursor-pointer text-sm transition-colors ".concat(t===f?"bg-blue-100 text-blue-900":"hover:bg-gray-100"),children:e},t))})]})}const yv={pickup:["Colombo Port","BIA Cargo Terminal","Hambantota Port","Chennai Port","Mumbai Port","Singapore Port","Dubai Cargo Village","Warehouse - Katunayake","Warehouse - Colombo","Customer Premises"],delivery:["Colombo","Galle","Kandy","Jaffna","Trincomalee","Negombo","Kurunegala","Anuradhapura","Batticaloa","Matara"]},wv=["Aarhus(AAR)","Abadan(ABD)","Abech\xe9(AEH)","Aberdeen(ABZ)","Aberdeen (SD)(ABR)","Abidjan(ABJ)","Abilene (TX)(ABI)","Abu Dhabi - Abu Dhabi International(AUH)","Abu Rudeis(AUE)","Abu Simbel(ABS)","Abuja - Nnamdi Azikiwe International Airport(ABV)","Acapulco(ACA)","Accra - Kotoka International Airport(ACC)","Adana(ADA)","Addis Ababa - Bole International Airport(ADD)","Adelaide(ADL)","Aden - Aden International Airport(ADE)","Adiyaman(ADF)","Adler/Sochi(AER)","Agades(AJY)","Agadir(AGA)","Agana (Hag\xe5t\xf1a)(SUM)","Aggeneys(AGZ)","Aguadilla(BQN)","Aguascaliente(AGU)","Ahmedabad(AMD)","Aiyura(AYU)","Ajaccio(AJA)","Akita(AXT)","Akron (OH)(CAK)","Akrotiri - RAF(AKT)","Al Ain(AAN)","Al Arish(AAC)","Al Hoceima(AHU)","Albany(ALH)","Albany (GA)(ABY)","Albany (NY) - Albany International Airport(ALB)","Albi(LBI)","Alborg(AAL)","Albuquerque (NM)(ABQ)","Albury(ABX)","Alderney(ACI)","Aleppo(ALP)","Alesund(AES)","Alexander Bay - Kortdoorn(ALJ)","Alexandria - Esler Field(ESF)","Alexandria - Borg el Arab Airport(HBH)","Alexandria - El Nhouza Airport(ALY)","Alghero Sassari(AHO)","Algiers, Houari Boumediene Airport(ALG)","Alicante(ALC)","Alice Springs(ASP)","Alldays(ADY)","Allentown (PA)(ABE)","Almaty (Alma Ata) - Almaty International Airport(ALA)","Almeria(LEI)","Alta(ALF)","Altay(AAT)","Altenrhein(ACH)","Altoona (PA)(AOO)","Altus(AXS)","Amami(ASJ)","Amarillo (TX)(AMA)","Amazon Bay(AZB)","Amman - Amman-Mark\xe1 International Airport(ADJ)","Amman - Queen Alia International Airport(AMM)","Amritsar(ATQ)","Amsterdam - Amsterdam Airport Schiphol(AMS)","Anand(QNB)","Anchorage (AK) - Ted Stevens Anchorage International(ANC)","Ancona - Ancona Falconara Airport(AOI)","Andorra La Vella - Heliport(ALV)","Anguilla(AXA)","Anjouan - Anjouan Airport(AJN)","Ankara(ANK)","Ankara - Esenbo\u011fa International Airport(ESB)","Ann Arbor (MI)(ARB)","Annaba(AAE)","Annecy(NCY)","Anniston (AL)(ANB)","Antalya(AYT)","Antananarivo (Tananarive) - Ivato International Airport(TNR)","Antigua, V.C. Bird International(ANU)","Antwerp(ANR)","Aomori(AOJ)","Apia - Faleolo International Airport(APW)","Appleton/Neenah/Menasha (WI)(ATW)","Aqaba(AQJ)","Aracaju(AJU)","Araxos(GPA)","Arkhangelsk(ARH)","Arlit(RLT)","Arrecife/Lanzarote(ACE)","Aruba - Reina Beatrix International, Oranjestad(AUA)","Arusha(ARK)","Asheville (NC)(AVL)","Ashgabat - Saparmurat Turkmenbashy Int. Airport(ASB)","Asmara - Asmara International(ASM)","Aspen (CO) - Aspen-Pitkin County Airport(ASE)","Assiut(ATZ)","Astana - Astana International Airport(TSE)","Asuncion - Asunci\xf3n International Airport(ASU)","Aswan - Daraw Airport(ASW)","Athens (GA)(AHN)","Athens (OH)(ATO)","Athens - Elefth\xe9rios Veniz\xe9los International Airport(ATH)","Athens, Hellinikon Airport(HEW)","Atlanta (GA) - Hartsfield Atlanta International Airport(ATL)","Atlantic City (NJ) - Atlantic City International(ACY)","Attawapiskat(YAT)","Auckland - Auckland International Airport(AKL)","Augsburg - Augsburg Airport(AGB)","Augusta (GA)(AGS)","Augusta (ME) - Augusta State Airport(AUG)","Aurillac(AUR)","Austin (TX) - Austin-Bergstrom Airport(AUS)","Ayawasi(AYW)","Ayers Rock - Connellan(AYQ)","Ayr(AYR)","Badajoz(BUZ)","Bagdad - Baghdad International Airport(BGW)","Bagdogra(IXB)","Bahamas - Lynden Pindling International Airport(NAS)","Bahawalpur(BHV)","Bahrain - Bahrain International Airport(BAH)","Bakersfield (CA)(BFL)","Baku - Heydar Aliyev International Airport(BAK)","Ballina(BNK)","Baltimore (MD) - Washington International Airport(BWI)","Bamaga(ABM)","Bamako - Bamako-S\xe9nou International Airport(BKO)","Bambari(BBY)","Bandar Seri Begawan - Brunei International Airport(BWN)","Bandung - Husein Sastranegara International Airport(BDO)","Bangalore(BLR)","Bangassou(BGU)","Bangkok, Don Muang(DMK)","Bangkok, Suvarnabhumi International(BKK)","Bangor (ME)(BGR)","Bangui - M'Poko International Airport(BGF)","Banjul - Banjul International Airport(BJL)","Bannu(BNP)","Barcelona(BCN)","Barcelona(BLA)","Bardufoss(BDU)","Bari(BRI)","Barisal(BZL)","Baroda(BDQ)","Barra (the famous tidal beach landing)(BRR)","Barranquilla(BAQ)","Basel(BSL)","Basel/Mulhouse(EAP)","Basra, Basrah(BSR)","Basse-Terre - Pointe-\xe0-Pitre International Airport(PTP)","Basseterre - Robert L. Bradshaw International Airport(SKB)","Bastia(BIA)","Baton Rouge (LA) - Baton Rouge Metropolitan Airport(BTR)","Bayreuth - Bindlacher-Berg(BYU)","Beaumont/Pt. Arthur (TX)(BPT)","Beckley (WV)(BKW)","Beef Island - Terrance B. Lettsome(EIS)","Beijing(PEK)","Beijing - Nanyuan Airport(NAY)","Beira(BEW)","Beirut - Beirut Rafic Hariri International Airport(BEY)","Belem - Val de Cans International Airport(BEL)","Belfast - Belfast International Airport(BFS)","Belfast - George Best Belfast City Airport(BHD)","Belgaum(IXG)","Belgrad (Beograd) - Belgrade Nikola Tesla International(BEG)","Belize City - Philip S.W.Goldson International(BZE)","Bellingham (WA)(BLI)","Belo Horizonte - Tancredo Neves International Airport(CNF)","Bemidji (MN)(BJI)","Benbecula(BEB)","Benghazi (Bengasi)(BEN)","Benguela(BUG)","Benton Harbour (MI)(BEH)","Berberati(BBT)","Bergamo/Milan - Orio Al Serio(BGY)","Bergen(BGO)","Bergerac - Roumanieres(EGC)","Berlin(BER)","Berlin, Schoenefeld(SXF)","Berlin, Tegel(TXL)","Berlin, Tempelhof(THF)","Bermuda - L.F. Wade International Airport(BDA)","Berne, Bern-Belp(BRN)","Berne, Railway Service(ZDJ)","Bethel (AK)(BET)","Bhopal(BHO)","Bhubaneswar(BBI)","Biarritz(BIQ)","Bilbao(BIO)","Billings (MT)(BIL)","Billund(BLL)","Bintulu(BTU)","Biraro(IRO)","Birmingham (AL)(BHM)","Birmingham - Birmingham International Airport(BHX)","Bishkek - Manas International Airport(FRU)","Bismarck (ND) - Bismarck Municipal Airport(BIS)","Bissau - Osvaldo Vieiro International Airport(BXO)","Blackpool(BLK)","Blackwater(BLT)","Blantyre (Mandala) - Chileka International Airport(BLZ)","Blenheim(BHE)","Bloemfontein - Bloemfontein Airport(BFN)","Bloomington (IL)(BMI)","Bloomington (IN)(BMG)","Bluefield (WV)(BLF)","Boa Vista(BVB)","Bobo/Dioulasso(BOY)","Bodo(BOO)","Bodrum - Milas Airport(BJV)","Bogota - El Nuevo Dorado International Airport(BOG)","Boise (ID) - Boise Air Terminal(BLI)","Bologna(BLQ)","Bombay (Mumbai) - Chhatrapati Shivaji International(BOM)","Bonaire(BON)","Bonaventure, PQ(YVB)","Bora Bora(BOB)","Bordeaux - Bordeaux Airport(BOD)","Borrego Springs (CA)(BXS)","Boston (MA) - General Edward Lawrence Logan(BOS)","Bouake(BYK)","Bourgas/Burgas(BOJ)","Bournemouth(BOH)","Bowen(ZBO)","Bozeman (MT)(BZN)","Bradford/Warren (PA) /Olean (NY)(BFD)","Brainerd (MN)(BRD)","Brampton Island(BMP)","Brasilia - President Juscelino Kubitschek International(BSB)","Bratislava - M. R. \u0160tef\xe1nik Airport(BTS)","Brazzaville - Maya-Maya Airport(BZV)","Bremen - Bremen Airport(BRE)","Brescia, Montichiari(VBS)","Brest(BES)","Bria(BIV)","Bridgeport (CT)(BDR)","Bridgetown - Grantley Adams International(BGI)","Brindisi(BDS)","Brisbane(BNE)","Bristol(BRS)","Broennoeysund(BNN)","Broken Hill(BHQ)","Brookings (SD)(BKX)","Broome(BME)","Brunswick (GA)(BQK)","Brussels - Brussels Airport(BRU)","Bucaramanga(BGA)","Bucharest(BUH)","Bucharest - Henri Coand\u0103 International Airport(OTP)","Budapest - Budapest Ferihegy International Airport(BUD)","Buenos Aires(BUE)","Buenos Aires, Ezeiza International Airport(EZE)","Buenos Aires, Jorge Newbery(AEP)","Buffalo Range(BFO)","Buffalo/Niagara Falls (NY)(BUF)","Bujumbura - Bujumbura International Airport(BJM)","Bulawayo(BUQ)","Bullhead City (NV)(BHC)","Bundaberg(BDB)","Burbank (CA)(BUR)","Burlington (VT)(BTV)","Burlington IA(BRL)","Burnie (Wynyard)(BWT)","Butte (MT)(BTM)","Cabinda(CAB)","Cagliari(CAG)","Cairns(CNS)","Cairo - Cairo International Airport(CAI)","Calama - El Loa(CJC)","Calcutta (Kolkata) - Netaji Subhas Chandra(CCU)","Calgary - Calgary International Airport(YYC)","Cali(CLO)","Calicut(CCJ)","Calvi(CLY)","Cambridge Bay(YCB)","Cambridge(CBG)","Campbeltown(CAL)","Campo Grande(CGR)","Canberra - Canberra Airport(CBR)","Cancun(CUN)","Cannes - Mandelieu Airport(CEQ)","Canouan (island) - Canouan Airport(CIW)","Cape Town - Cape Town International Airport(CPT)","Caracas - Sim\xf3n Bol\xedvar International Airport(CCS)","Cardiff - Cardiff Airport(CWL)","Carlsbad (CA)(CLD)","Carnarvon(CVQ)","Carnot(CRF)","Carson City (NV)(CSN)","Cartagena - Rafael N\xfa\xf1ez International Airport(CTG)","Casa de Campo - La Romana International Airport(LRM)","Casablanca(CMN)","Casino(CSI)","Casper (WY)(CPR)","Castaway(CST)","Castries - George F. L. Charles Airport(SLU)","Catania(CTA)","Cayenne - Cayenne-Rochambeau Airport(CAY)","Cebu City - Mactan-Cebu International(CEB)","Cedar City (UT)(CDC)","Cedar Rapids IA(CID)","Ceduna(CED)","Cessnock(CES)","Chabarovsk (Khabarovsk)(KHV)","Chambery(CMF)","Champaign (IL)(CMI)","Chandigarh - Chandigarh International Airport(IXC)","Changchun(CGQ)","Chania(CHQ)","Chaoyang, Beijing - Chaoyang Airport(CHG)","Charleston (SC)(CHS)","Charleston (WV) - Yeager Airport(CRW)","Charlotte (NC)(CLT)","Charlottesville (VA)(CHO)","Charters Towers(CXT)","Chattanooga (TN)(CHA)","Chengdu - Shuangliu(CTU)","Chennai (Madras)(MAA)","Cheyenne (WY) - Cheyenne Regional Airport(CYS)","Chiang Mai - Chiang Mai International Airport(CNX)","Chiba City(QCB)","Chicago (IL)(CHI)","Chicago (IL), Midway(MDW)","Chicago (IL), O'Hare International Airport(ORD)","Chichen Itza(CZA)","Chico (CA)(CIC)","Chihuahua - Gen Fierro Villalobos(CUU)","Chios(JKH)","Chipata(CIP)","Chisinau - Chi\u0219in\u0103u International Airport(KIV)","Chita (Tschita)(HTA)","Chitral(CJL)","Chittagong(CGP)","Chongqing - Jiangbei International Airport(CKG)","Christchurch(CHC)","Chub Cay(CCZ)","Churchill(YYQ)","Cienfuegos - Jaime Gonz\xe1lez Airport(CFG)","Cincinnati (OH) - Cincinnati/Northern Kentucky Int'l(CVG)","Ciudad Del Carmen(CME)","Ciudad Guayana(CGU)","Ciudad Juarez(CUS)","Ciudad Obregon(CEN)","Ciudad Victoria(CVM)","Clarksburg (WV)(CKB)","Clermont(CMQ)","Clermont Ferrand(CFE)","Cleveland (OH) - Cleveland Hopkins International(CLE)","Cleveland (OH), Burke Lakefront(BKL)","Cochabamba(CBB)","Cochin(COK)","Cody/Powell/Yellowstone (WY)(COD)","Coffmann Cove (AK)(KCC)","Coffs Harbour(CFS)","Coimbatore(CJB)","Colima(CLQ)","College Station/Bryan (TX)(CLL)","Collinsville(KCE)","Cologne - Cologne Airport (Flughafen K\xf6ln/Bonn)(CGN)","Colombo - Bandaranaike International Airport(CMB)","Colorado Springs (CO)(COS)","Columbia (SC) - Columbia Metropolitan Airport(CAE)","Columbus (GA)(CSG)","Columbus (OH) - Port Columbus International(CMH)","Conakry - Conakry International Airport(CKY)","Concord (CA) - Buchanan Field(CCR)","Concord (NH) - Concord Municipal Airport(CON)","Constan\u021ba (Constan\u021ba) - Constan\u021ba Int'l Airport(CND)","Constantine(CZL)","Coober Pedy(CPD)","Cooktown(CTN)","Cooma(OOM)","Copenhagen - Copenhagen Airport(CPH)","Cordoba(COR)","Cordova (AK)(CDV)","Corfu(CFU)","Cork(ORK)","Corpus Christi (TX)(CRP)","Cotonou - Cotonou Cadjehoun Airport(COO)","Cottbus - Cottbus-Drewitz Airport(CBU)","Coventry - Baginton(CVT)","Cozumel(CZM)","Craig (AK)(CGA)","Crescent City (CA)(CEC)","Cuiab\xe1 - Marechal Rondon International Airport(CGB)","Culiacan(CUL)","Curacao - Cura\xe7ao International Airport(CUR)","Curitiba - Afonso Pena International Airport(CWB)","Cuyo(CYU)","Dakar - L\xe9opold S\xe9dar Senghor International Airport(DKR)","Dalaman(DLM)","Dalby(DBY)","Dalian - Zhoushuizi International Airport(DLC)","Dallas (TX), Love Field(DAL)","Dallas/Ft. Worth (TX) - Dallas/Fort Worth International(DFW)","Daloa(DJO)"],Nv=["Shanghai Port","Singapore Port","Colombo Port","Chennai Port","Mumbai (JNPT) Port","Hambantota Port","Port Klang","Dubai (Jebel Ali)","Hong Kong Port","Chittagong Port","Karachi Port","Bangkok (Laem Chabang)","Jakarta (Tanjung Priok)","Ho Chi Minh (Cat Lai)"],jv={sea:["Maersk Line","MSC (Mediterranean Shipping Company)","CMA CGM","COSCO Shipping","Hapag-Lloyd","ONE (Ocean Network Express)","Evergreen Line","Yang Ming Line","HMM (Hyundai Merchant Marine)","PIL (Pacific International Lines)","OOCL","ZIM","Wan Hai Lines"],air:["Emirates SkyCargo","Qatar Airways Cargo","Singapore Airlines Cargo","Cathay Pacific Cargo","Lufthansa Cargo","Korean Air Cargo","ANA Cargo","Turkish Cargo","Etihad Cargo","Air France-KLM Cargo","China Airlines Cargo","FedEx","DHL Aviation","UPS Airlines"],all:["Maersk Line","MSC","CMA CGM","Emirates SkyCargo","Qatar Airways Cargo","Singapore Airlines Cargo"]},kv=["EXW (Ex Works)","FCA (Free Carrier)","CPT (Carriage Paid To)","CIP (Carriage and Insurance Paid To)","DAP (Delivered at Place)","DPU (Delivered at Place Unloaded)","DDP (Delivered Duty Paid)","FAS (Free Alongside Ship)","FOB (Free on Board)","CFR (Cost and Freight)","CIF (Cost, Insurance and Freight)"],Sv=["USD","EUR","LKR","GBP","AED","SGD","CNY","JPY","INR","AUD","CAD","HKD","MYR","THB"],Av=["General Cargo","Dangerous Goods (DG)","Perishable Goods","Fragile Items","Hazardous Materials","Temperature Controlled","Live Animals","Oversized Cargo","Valuable Cargo","Pharmaceutical Products","Electronics","Garments & Textiles","Machinery & Equipment","Food & Beverages"],Cv={air:['Pallet (96" x 125")',"ULD Container - LD3","ULD Container - LD7","ULD Container - LD9","Wooden Crate","Cardboard Box","Skid","Bulk Cargo"],sea:["20 FT Standard Container","40 FT Standard Container","40 FT High Cube Container","45 FT High Cube Container","20 FT Refrigerated Container","40 FT Refrigerated Container","20 FT Open Top Container","40 FT Open Top Container","20 FT Flat Rack","40 FT Flat Rack","Bulk Cargo","Break Bulk"],trucking:["Dry Van","Flatbed","Refrigerated (Reefer)","Step Deck","Lowboy","Conestoga","Box Truck","Straight Truck","Dump Truck","Tanker","Container Chassis","Double Drop","Extendable Trailer"]},_v=["WM","CBM","CONTAINER","KGS","SHIPMENT","TUE","PALLET","CASE","CTN","PKGS","SET","TON","ROLL","BL","DOC","TRUCK","20GP","40HC","20RF","40RF"],Tv=["-45 Kg","+45 Kg","+100 kg","+300 kg","+500 kg","+1000 kg","+1500 kg","+2000 kg","+3000 kg","+5000 kg"],Ev=["20 GP","40 GP","40 HC","20 RF","40 RF","20 FR","40 FR","20 OT","40 OT","40OTHC","20 ISO","Per/CBM"],Lv={air:["-45 Kg","+45 Kg","+100 Kg","+300 Kg","+500 Kg","+1000 Kg","+1500 Kg","+2000 Kg","+3000 Kg","+5000 Kg"],sea:["20 GP","40 GP","40 HC","20 RF","40 RF","20 FR","40 FR","20 OT","40 OT","40OTHC","20 ISO","Per/CBM"],trucking:["Per Truck","Per Kg","Per Ton","Per Mile","Per Km","Flat Rate","Per Pallet","Per CBM"]},Pv={freight:["Ocean Freight","Air Freight","Fuel Surcharge (BAF)","Currency Adjustment Factor (CAF)","Peak Season Surcharge","War Risk Surcharge","Emergency Surcharge"],destination:["Terminal Handling Charge (THC)","Documentation Fee","Customs Clearance","Port Charges","Delivery Order (DO) Fee","Container Detention","Demurrage","Inspection Fee","Fumigation","Storage Charges"],origin:["Warehouse Handling","Loading Charges","Stuffing Charges","VGM (Verified Gross Mass)","Seal Charges","Lashing & Securing","Export Customs","Bill of Lading Fee"],handling:["EXW Charges","BL Fee","CFS charges","Loading/ Unloading","Custom clearance charges","Handling Charges","PSS charges","ACI Fee","AMS Fee","ECI fee","Pickup Charges","CMB/KWI/CAI","NB FROM KWI/CAI","Local Forwarding charges","SLPA charges","Doc Fee","Export license fee","Trico Gatepass","VGM fee","Manifest amendment fee","EDI charges","Peek charges","Origin Charges","Others","Waiting Charges","Palletizing Charges","Labour Charges","Equipment charges"]},Ov=["Payment terms: 30 days from invoice date","Payment terms: 15 days from invoice date","Payment terms: Cash on delivery (COD)","Payment terms: 50% advance, 50% on delivery","Prices are subject to change without prior notice","All rates are valid for 30 days from quote date","All rates are valid for 15 days from quote date","All customs duties and taxes are excluded","All customs duties and taxes are included","Insurance is not included unless specified","Insurance coverage available at 0.5% of cargo value","Free storage for first 3 days, charges apply thereafter","Free demurrage for 5 days at destination","Cargo must be ready for pickup within 24 hours of booking","Subject to space and equipment availability","Rates based on commodity declaration provided","Additional charges may apply for oversized/overweight cargo","Customer responsible for proper packaging and marking","Delivery time estimates are approximate and not guaranteed","Claims must be reported within 24 hours of delivery","Force majeure clause applicable","Rates exclude weekend/holiday delivery charges"],Fv=["DHL Freight","DB Schenker","Kuehne + Nagel","XPO Logistics","FedEx Freight","UPS Freight","YRC Freight","Estes Express","Old Dominion","Saia Motor Freight","ABF Freight","TForce Freight","Ryder","J.B. Hunt","Schneider National"],Iv=e=>"air"===e?jv.air||[]:"sea"===e?jv.sea||[]:"trucking"===e?Fv||[]:[...jv.sea||[],...jv.air||[],...jv.all||[],...Fv],Rv=e=>"air"===e?Cv.air:"sea"===e?Cv.sea:"trucking"===e?Cv.trucking:[...Cv.air,...Cv.sea,...Cv.trucking],Dv=e=>"air"===e?Tv:"sea"===e?Ev:[...Tv,...Ev];function Mv(e){let{formData:t,setFormData:r,disabled:n=!1}=e;const[a,i]=(0,s.useState)([]),o=(e,t)=>{r(r=>We(We({},r),{},{[e]:t}))};return(0,s.useEffect)(()=>{(async()=>{const e=await mb();console.log("Fetched Account Names:",e),i(e)})()},[]),(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Basic Information"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quote Number"}),(0,xn.jsx)("input",{type:"text",value:t.quoteNumber||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",placeholder:"Auto-generated"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Created Date"}),(0,xn.jsx)("input",{type:"date",value:t.createdDate||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rate Validity"}),(0,xn.jsx)("input",{type:"date",value:t.rateValidity||"",onChange:e=>o("rateValidity",e.target.value),disabled:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsx)(vv,{label:"Customer",value:t.customer||"",onChange:e=>o("customer",e),suggestions:a,disabled:n}),(0,xn.jsx)(vv,{label:"Pickup Location",value:t.pickupLocation||"",onChange:e=>o("pickupLocation",e),suggestions:yv.pickup,disabled:n}),(0,xn.jsx)(vv,{label:"Delivery Location",value:t.deliveryLocation||"",onChange:e=>o("deliveryLocation",e),suggestions:yv.delivery,disabled:n})]})]})}function Bv(e){let{formData:t,setFormData:r,disabled:n=!1}=e;return(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Port of Loading (POL) and Port of Discharge (POD)"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,xn.jsx)(vv,{label:"Port of Loading (POL)",value:t.portOfLoading,onChange:e=>r(t=>We(We({},t),{},{portOfLoading:e})),suggestions:[],disabled:n}),(0,xn.jsx)(vv,{label:"Port of Discharge (POD)",value:t.portOfDischarge,onChange:e=>r(t=>We(We({},t),{},{portOfDischarge:e})),suggestions:[],disabled:n})]})]})}function Uv(e){let{formData:t,setFormData:r,category:n,disabled:a=!1}=e;const s=(e,t)=>{a||r(r=>We(We({},r),{},{equipment:We(We({},r.equipment),{},{[e]:t})}))},i=Rv(n);return(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Equipment Details"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsx)(vv,{label:"Equipment",value:t.equipment.equipment,onChange:e=>s("equipment",e),suggestions:i,disabled:a}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Units"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.units,onChange:e=>s("units",e.target.value),disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gross Weight"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.grossWeight,onChange:e=>s("grossWeight",e.target.value),disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Volume (m\xb3)"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:t.equipment.volume,onChange:e=>s("volume",e.target.value),disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chargeable Weight"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.chargeableWeight,onChange:e=>s("chargeableWeight",e.target.value),disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]})]})]})}function zv(e){let{formData:t,setFormData:r,category:n,disabled:a=!1,carrierName:s=null}=e;const i=(e,n,s)=>{if(a)return;const i=[...t.freightCharges];if(i[e][n]=s,"numberOfUnits"===n||"amount"===n){const t=parseFloat(i[e].numberOfUnits)||0,r=parseFloat(i[e].amount)||0;i[e].total=t*r}r(e=>We(We({},e),{},{freightCharges:i}))},o=Iv(n),l="air"===n,c=Dv(n);return(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Freight Charges"}),!a&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{if(a)return;const e={carrier:s||"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",total:0};"air"===n&&(e.surcharge="",e.frequency=""),r(t=>We(We({},t),{},{freightCharges:[...t.freightCharges,e]}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Charge"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-50",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"air"==n?"AirLine":"Carrier"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Transit Time"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Routing"}),l&&(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Surcharge"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Frequency"})]}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:t.freightCharges.map((e,n)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.carrier,onChange:e=>i(n,"carrier",e),suggestions:o,showLabel:!1,disabled:a||null!==s})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.unitType,onChange:e=>i(n,"unitType",e),suggestions:c,showLabel:!1,disabled:a})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>i(n,"numberOfUnits",e.target.value),disabled:a,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>i(n,"amount",e.target.value),disabled:a,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>i(n,"currency",e),suggestions:Sv,showLabel:!1,disabled:a})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.transitTime||"",onChange:e=>i(n,"transitTime",e.target.value),disabled:a,placeholder:"e.g., 7-10 days",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.numberOfRouting||"",onChange:e=>i(n,"numberOfRouting",e.target.value),disabled:a,placeholder:"e.g., Direct",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),l&&(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.surcharge||"",onChange:e=>i(n,"surcharge",e.target.value),disabled:a,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.frequency||"",onChange:e=>i(n,"frequency",e.target.value),disabled:a,placeholder:"e.g., Daily",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})})]}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.freightCharges.length>1&&!a&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{a||r(t=>We(We({},t),{},{freightCharges:t.freightCharges.filter((t,r)=>r!==e)}))})(n),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},n))}),(0,xn.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{colSpan:l?"9":"7",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:t.freightCharges.reduce((e,t)=>e+(parseFloat(t.total)||0),0).toFixed(2)}),(0,xn.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function qv(e){let{formData:t,setFormData:r,disabled:n=!1}=e;const a=(e,a,s)=>{if(n)return;const i=[...t.destinationCharges];if(i[e][a]=s,"numberOfUnits"===a||"amount"===a){const t=parseFloat(i[e].numberOfUnits)||0,r=parseFloat(i[e].amount)||0;i[e].total=t*r}r(e=>We(We({},e),{},{destinationCharges:i}))};return(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Destination Charges (POD)"}),!n&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{n||r(e=>We(We({},e),{},{destinationCharges:[...e.destinationCharges,{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Charge"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-50",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:t.destinationCharges.map((e,s)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.chargeName,onChange:e=>a(s,"chargeName",e),suggestions:Pv.destination,showLabel:!1,disabled:n})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.unitType,onChange:e=>a(s,"unitType",e),suggestions:_v,showLabel:!1,disabled:n})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>a(s,"numberOfUnits",e.target.value),disabled:n,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>a(s,"amount",e.target.value),disabled:n,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>a(s,"currency",e),suggestions:Sv,showLabel:!1,disabled:n})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.destinationCharges.length>1&&!n&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{n||r(t=>We(We({},t),{},{destinationCharges:t.destinationCharges.filter((t,r)=>r!==e)}))})(s),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},s))}),(0,xn.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{colSpan:"5",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:t.destinationCharges.reduce((e,t)=>e+(parseFloat(t.total)||0),0).toFixed(2)}),(0,xn.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function Hv(e){let{formData:t,setFormData:r,type:n,title:a,disabled:s=!1}=e;const i="origin"===n?"originHandling":"destinationHandling",o=t[i]||[],l=(e,t,n)=>{if(s)return;const a=[...o];if(a[e][t]=n,"numberOfUnits"===t||"amount"===t){const t=parseFloat(a[e].numberOfUnits)||0,r=parseFloat(a[e].amount)||0;a[e].total=t*r}r(e=>We(We({},e),{},{[i]:a}))},c="origin"===n?Pv.origin:Pv.destination;return(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:a}),!s&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{s||r(e=>We(We({},e),{},{[i]:[...e[i],{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Charge"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-50",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:o.map((e,t)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.chargeName,onChange:e=>l(t,"chargeName",e),suggestions:c,showLabel:!1,disabled:s})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.unitType,onChange:e=>l(t,"unitType",e),suggestions:_v,showLabel:!1,disabled:s})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>l(t,"numberOfUnits",e.target.value),disabled:s,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>l(t,"amount",e.target.value),disabled:s,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>l(t,"currency",e),suggestions:Sv,showLabel:!1,disabled:s})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:o.length>1&&!s&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{s||r(t=>We(We({},t),{},{[i]:t[i].filter((t,r)=>r!==e)}))})(t),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},t))}),(0,xn.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{colSpan:"5",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:o.reduce((e,t)=>e+(parseFloat(t.total)||0),0).toFixed(2)}),(0,xn.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function Wv(e){let{option:t,index:r,category:n,formData:a,setFormData:i,onRemove:o,disabled:l=!1,totalOptions:c}=e;const[d,u]=(0,s.useState)(!0),h=Iv(n),f="air"===n?"Airline Option":"Sea Option",m=(e,t)=>{if(l)return;const n=[...a.carrierOptions];n[r]=We(We({},n[r]),{},{[e]:t}),i(e=>We(We({},e),{},{carrierOptions:n}))},p=e=>({[e]:t[e]||[]}),g=e=>r=>{if("function"===typeof r){const n=r({[e]:t[e]||[]});m(e,n[e])}else m(e,r[e])};return(0,xn.jsxs)("div",{className:"border-2 border-blue-300 rounded-lg mb-6 overflow-hidden",children:[(0,xn.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 text-white p-4",children:(0,xn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("button",{type:"button",onClick:()=>u(!d),className:"hover:bg-blue-700 p-1 rounded transition-colors",children:d?(0,xn.jsx)(eb,{size:20}):(0,xn.jsx)(ua,{size:20})}),(0,xn.jsxs)("h3",{className:"text-lg font-semibold",children:[f," [",r+1,"]"]})]}),c>1&&!l&&(0,xn.jsxs)("button",{type:"button",onClick:o,className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 hover:bg-red-700 rounded transition-colors",children:[(0,xn.jsx)(Pa,{size:16}),"Remove Option"]})]})}),d&&(0,xn.jsxs)("div",{className:"p-6 bg-blue-50/30",children:[(0,xn.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-6 shadow-sm",children:[(0,xn.jsxs)("h4",{className:"text-md font-semibold text-gray-700 mb-4",children:["air"===n?"Airline":"Carrier"," Details"]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,xn.jsx)(vv,{label:"air"===n?"Airline":"Carrier",value:t.carrier||"",onChange:e=>m("carrier",e),suggestions:h,disabled:l}),(0,xn.jsx)(vv,{label:"Incoterm",value:t.incoterm||"",onChange:e=>m("incoterm",e),suggestions:kv,disabled:l}),(0,xn.jsx)(vv,{label:"Currency",value:t.currency||"",onChange:e=>m("currency",e),suggestions:Sv,disabled:l}),(0,xn.jsx)(vv,{label:"Cargo Type",value:t.cargoType||"",onChange:e=>m("cargoType",e),suggestions:Av,disabled:l})]})]}),(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 mb-4 shadow-sm",children:(0,xn.jsx)(zv,{formData:p("freightCharges"),setFormData:g("freightCharges"),category:n,disabled:l,carrierName:t.carrier})}),(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 mb-4 shadow-sm",children:(0,xn.jsx)(qv,{formData:p("destinationCharges"),setFormData:g("destinationCharges"),disabled:l})}),(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 mb-4 shadow-sm",children:(0,xn.jsx)(Hv,{formData:p("originHandling"),setFormData:g("originHandling"),type:"origin",title:"Origin Handling Charges",disabled:l})}),(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:(0,xn.jsx)(Hv,{formData:p("destinationHandling"),setFormData:g("destinationHandling"),type:"destination",title:"Destination Handling Charges",disabled:l})})]})]})}function Vv(e){let{formData:t,setFormData:r,disabled:n=!1}=e;const[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(""),u=e=>{!n&&e.trim()&&(r(t=>We(We({},t),{},{termsConditions:[...t.termsConditions,e.trim()]})),i(""))},h=()=>{if(c.trim()){const e=[...t.termsConditions];e[o]=c.trim(),r(t=>We(We({},t),{},{termsConditions:e}))}l(null),d("")},f=()=>{l(null),d("")};return(0,xn.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700 border-b pb-2",children:"Terms & Conditions"}),!n&&(0,xn.jsxs)("div",{className:"space-y-2",children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Select from defaults or add custom:"}),(0,xn.jsx)("div",{className:"flex gap-2",children:(0,xn.jsxs)("select",{onChange:e=>{e.target.value&&(u(e.target.value),e.target.value="")},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg",children:[(0,xn.jsx)("option",{value:"",children:"-- Select a term --"}),Ov.map((e,t)=>(0,xn.jsx)("option",{value:e,children:e},t))]})}),(0,xn.jsxs)("div",{className:"flex gap-2",children:[(0,xn.jsx)("input",{type:"text",value:a,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&u(a),placeholder:"Or type a custom term...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg"}),(0,xn.jsxs)("button",{type:"button",onClick:()=>u(a),className:"flex items-center gap-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,xn.jsx)(da,{size:18}),"Add"]})]})]}),t.termsConditions.length>0&&(0,xn.jsx)("div",{className:"border border-gray-300 rounded-lg p-4 space-y-2",children:t.termsConditions.map((e,a)=>(0,xn.jsx)("div",{className:"flex items-start gap-2 p-2 bg-gray-50 rounded",children:o===a?(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded",autoFocus:!0}),(0,xn.jsx)("button",{type:"button",onClick:h,className:"text-green-600 hover:text-green-700",children:(0,xn.jsx)(Zx,{size:18})}),(0,xn.jsx)("button",{type:"button",onClick:f,className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Ln,{size:18})})]}):(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsxs)("span",{className:"flex-1 text-sm text-gray-700",children:[a+1,". ",e]}),!n&&(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{n||(l(e),d(t.termsConditions[e]))})(a),className:"text-blue-600 hover:text-blue-700",children:(0,xn.jsx)(La,{size:16})}),(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{n||r(t=>We(We({},t),{},{termsConditions:t.termsConditions.filter((t,r)=>r!==e)}))})(a),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})]})]})},a))})]})}const Gv=()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"Q-".concat(t,"-").concat(r,"-").concat(n,"-").concat(a).concat(s).concat(i)};var Kv=r(2284),Yv=Uint8Array,Xv=Uint16Array,$v=Int32Array,Jv=new Yv([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qv=new Yv([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Zv=new Yv([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ey=function(e,t){for(var r=new Xv(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var a=new $v(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},ty=ey(Jv,2),ry=ty.b,ny=ty.r;ry[28]=258,ny[258]=28;for(var ay=ey(Qv,0),sy=(ay.b,ay.r),iy=new Xv(32768),oy=0;oy<32768;++oy){var ly=(43690&oy)>>1|(21845&oy)<<1;ly=(61680&(ly=(52428&ly)>>2|(13107&ly)<<2))>>4|(3855&ly)<<4,iy[oy]=((65280&ly)>>8|(255&ly)<<8)>>1}var cy=function(e,t,r){for(var n=e.length,a=0,s=new Xv(t);a<n;++a)e[a]&&++s[e[a]-1];var i,o=new Xv(t);for(a=1;a<t;++a)o[a]=o[a-1]+s[a-1]<<1;if(r){i=new Xv(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],d=t-e[a],u=o[e[a]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)i[iy[u]>>l]=c}else for(i=new Xv(n),a=0;a<n;++a)e[a]&&(i[a]=iy[o[e[a]-1]++]>>15-e[a]);return i},dy=new Yv(288);for(oy=0;oy<144;++oy)dy[oy]=8;for(oy=144;oy<256;++oy)dy[oy]=9;for(oy=256;oy<280;++oy)dy[oy]=7;for(oy=280;oy<288;++oy)dy[oy]=8;var uy=new Yv(32);for(oy=0;oy<32;++oy)uy[oy]=5;var hy=cy(dy,9,0),fy=cy(uy,5,0),my=function(e){return(e+7)/8|0},py=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new Yv(e.subarray(t,r))},gy=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},xy=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},by=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,s=r.slice();if(!a)return{t:Sy,l:0};if(1==a){var i=new Yv(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,d=1,u=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};d!=a-1;)o=r[r[c].f<r[u].f?c++:u++],l=r[c!=d&&r[c].f<r[u].f?c++:u++],r[d++]={s:-1,f:o.f+l.f,l:o,r:l};var h=s[0].s;for(n=1;n<a;++n)s[n].s>h&&(h=s[n].s);var f=new Xv(h+1),m=vy(r[d-1],f,0);if(m>t){n=0;var p=0,g=m-t,x=1<<g;for(s.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});n<a;++n){var b=s[n].s;if(!(f[b]>t))break;p+=x-(1<<m-f[b]),f[b]=t}for(p>>=g;p>0;){var v=s[n].s;f[v]<t?p-=1<<t-f[v]++-1:++n}for(;n>=0&&p;--n){var y=s[n].s;f[y]==t&&(--f[y],++p)}m=t}return{t:new Yv(f),l:m}},vy=function(e,t,r){return-1==e.s?Math.max(vy(e.l,t,r+1),vy(e.r,t,r+1)):t[e.s]=r},yy=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Xv(++t),n=0,a=e[0],s=1,i=function(e){r[n++]=e},o=1;o<=t;++o)if(e[o]==a&&o!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(a),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(a);s=1,a=e[o]}return{c:r.subarray(0,n),n:t}},wy=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},Ny=function(e,t,r){var n=r.length,a=my(t+2);e[a]=255&n,e[a+1]=n>>8,e[a+2]=255^e[a],e[a+3]=255^e[a+1];for(var s=0;s<n;++s)e[a+s+4]=r[s];return 8*(a+4+n)},jy=function(e,t,r,n,a,s,i,o,l,c,d){gy(t,d++,r),++a[256];for(var u=by(a,15),h=u.t,f=u.l,m=by(s,15),p=m.t,g=m.l,x=yy(h),b=x.c,v=x.n,y=yy(p),w=y.c,N=y.n,j=new Xv(19),k=0;k<b.length;++k)++j[31&b[k]];for(k=0;k<w.length;++k)++j[31&w[k]];for(var S=by(j,7),A=S.t,C=S.l,_=19;_>4&&!A[Zv[_-1]];--_);var T,E,L,P,O=c+5<<3,F=wy(a,dy)+wy(s,uy)+i,I=wy(a,h)+wy(s,p)+i+14+3*_+wy(j,A)+2*j[16]+3*j[17]+7*j[18];if(l>=0&&O<=F&&O<=I)return Ny(t,d,e.subarray(l,l+c));if(gy(t,d,1+(I<F)),d+=2,I<F){T=cy(h,f,0),E=h,L=cy(p,g,0),P=p;var R=cy(A,C,0);gy(t,d,v-257),gy(t,d+5,N-1),gy(t,d+10,_-4),d+=14;for(k=0;k<_;++k)gy(t,d+3*k,A[Zv[k]]);d+=3*_;for(var D=[b,w],M=0;M<2;++M){var B=D[M];for(k=0;k<B.length;++k){var U=31&B[k];gy(t,d,R[U]),d+=A[U],U>15&&(gy(t,d,B[k]>>5&127),d+=B[k]>>12)}}}else T=hy,E=dy,L=fy,P=uy;for(k=0;k<o;++k){var z=n[k];if(z>255){xy(t,d,T[(U=z>>18&31)+257]),d+=E[U+257],U>7&&(gy(t,d,z>>23&31),d+=Jv[U]);var q=31&z;xy(t,d,L[q]),d+=P[q],q>3&&(xy(t,d,z>>5&8191),d+=Qv[q])}else xy(t,d,T[z]),d+=E[z]}return xy(t,d,T[256]),d+E[256]},ky=new $v([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Sy=new Yv(0),Ay=function(e,t,r,n,a,s){var i=s.z||e.length,o=new Yv(n+i+5*(1+Math.ceil(i/7e3))+a),l=o.subarray(n,o.length-a),c=s.l,d=7&(s.r||0);if(t){d&&(l[0]=s.r>>3);for(var u=ky[t-1],h=u>>13,f=8191&u,m=(1<<r)-1,p=s.p||new Xv(32768),g=s.h||new Xv(m+1),x=Math.ceil(r/3),b=2*x,v=function(t){return(e[t]^e[t+1]<<x^e[t+2]<<b)&m},y=new $v(25e3),w=new Xv(288),N=new Xv(32),j=0,k=0,S=s.i||0,A=0,C=s.w||0,_=0;S+2<i;++S){var T=v(S),E=32767&S,L=g[T];if(p[E]=L,g[T]=E,C<=S){var P=i-S;if((j>7e3||A>24576)&&(P>423||!c)){d=jy(e,l,0,y,w,N,k,A,_,S-_,d),A=j=k=0,_=S;for(var O=0;O<286;++O)w[O]=0;for(O=0;O<30;++O)N[O]=0}var F=2,I=0,R=f,D=E-L&32767;if(P>2&&T==v(S-D))for(var M=Math.min(h,P)-1,B=Math.min(32767,S),U=Math.min(258,P);D<=B&&--R&&E!=L;){if(e[S+F]==e[S+F-D]){for(var z=0;z<U&&e[S+z]==e[S+z-D];++z);if(z>F){if(F=z,I=D,z>M)break;var q=Math.min(D,z-2),H=0;for(O=0;O<q;++O){var W=S-D+O&32767,V=W-p[W]&32767;V>H&&(H=V,L=W)}}}D+=(E=L)-(L=p[E])&32767}if(I){y[A++]=268435456|ny[F]<<18|sy[I];var G=31&ny[F],K=31&sy[I];k+=Jv[G]+Qv[K],++w[257+G],++N[K],C=S+F,++j}else y[A++]=e[S],++w[e[S]]}}for(S=Math.max(S,C);S<i;++S)y[A++]=e[S],++w[e[S]];d=jy(e,l,c,y,w,N,k,A,_,S-_,d),c||(s.r=7&d|l[d/8|0]<<3,d-=7,s.h=g,s.p=p,s.i=S,s.w=C)}else{for(S=s.w||0;S<i+c;S+=65535){var Y=S+65535;Y>=i&&(l[d/8|0]=c,Y=i),d=Ny(l,d+1,e.subarray(S,Y))}s.i=i}return py(o,0,n+my(d)+a)},Cy=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,s=0|r.length,i=0;i!=s;){for(var o=Math.min(i+2655,s);i<o;++i)a+=n+=r[i];n=(65535&n)+15*(n>>16),a=(65535&a)+15*(a>>16)}e=n,t=a},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},_y=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),i=new Yv(s.length+e.length);i.set(s),i.set(e,s.length),e=i,a.w=s.length}return Ay(e,null==t.level?6:t.level,null==t.mem?a.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,n,a)},Ty=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Ey=function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=Cy();a.p(t.dictionary),Ty(e,2,a.d())}};function Ly(e,t){t||(t={});var r=Cy();r.p(e);var n=_y(e,t,t.dictionary?6:2,4);return Ey(n,t),Ty(n,n.length-4,r.d()),n}var Py="undefined"!=typeof TextDecoder&&new TextDecoder;try{Py.decode(Sy,{stream:!0})}catch(K_){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;function Oy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Fy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Oy(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oy(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Iy(e){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(e)}const Ry=new TextEncoder;const Dy=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),My={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class By{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,qe.A)(this,"buffer",void 0),(0,qe.A)(this,"byteLength",void 0),(0,qe.A)(this,"byteOffset",void 0),(0,qe.A)(this,"length",void 0),(0,qe.A)(this,"offset",void 0),(0,qe.A)(this,"lastWrittenByte",void 0),(0,qe.A)(this,"littleEndian",void 0),(0,qe.A)(this,"_data",void 0),(0,qe.A)(this,"_mark",void 0),(0,qe.A)(this,"_marks",void 0);let r=!1;"number"===typeof e?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const n=t.offset?t.offset>>>0:0,a=e.byteLength-n;let s=n;(ArrayBuffer.isView(e)||e instanceof By)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+n),e=e.buffer),this.lastWrittenByte=r?a:0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=e,this}back(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(e)){const t=2*(this.offset+e),r=new Uint8Array(t);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(e,"uint8")}readArray(e,t){const r=My[t].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,a=this.buffer.slice(n,n+r);if(this.littleEndian===Dy&&"uint8"!==t&&"int8"!==t){const e=new Uint8Array(this.buffer.slice(n,n+r));e.reverse();const a=new My[t](e.buffer);return this.offset+=r,a.reverse(),a}const s=new My[t](a);return this.offset+=r,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Iy(this.readBytes(e))}decodeText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return Iy(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(function(e){return Ry.encode(e)}(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Uy(e){let t=e.length;for(;--t>=0;)e[t]=0}const zy=256,qy=286,Hy=30,Wy=15,Vy=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Gy=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ky=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Yy=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Xy=new Array(576);Uy(Xy);const $y=new Array(60);Uy($y);const Jy=new Array(512);Uy(Jy);const Qy=new Array(256);Uy(Qy);const Zy=new Array(29);Uy(Zy);const ew=new Array(Hy);function tw(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let rw,nw,aw;function sw(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Uy(ew);const iw=e=>e<256?Jy[e]:Jy[256+(e>>>7)],ow=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},lw=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,ow(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},cw=(e,t,r)=>{lw(e,r[2*t],r[2*t+1])},dw=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},uw=(e,t,r)=>{const n=new Array(16);let a,s,i=0;for(a=1;a<=Wy;a++)i=i+r[a-1]<<1,n[a]=i;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=dw(n[t]++,t))}},hw=e=>{let t;for(t=0;t<qy;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Hy;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},fw=e=>{e.bi_valid>8?ow(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},mw=(e,t,r,n)=>{const a=2*t,s=2*r;return e[a]<e[s]||e[a]===e[s]&&n[t]<=n[r]},pw=(e,t,r)=>{const n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&mw(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!mw(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},gw=(e,t,r)=>{let n,a,s,i,o=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+o++],n+=(255&e.pending_buf[e.sym_buf+o++])<<8,a=e.pending_buf[e.sym_buf+o++],0===n?cw(e,a,t):(s=Qy[a],cw(e,s+zy+1,t),i=Vy[s],0!==i&&(a-=Zy[s],lw(e,a,i)),n--,s=iw(n),cw(e,s,r),i=Gy[s],0!==i&&(n-=ew[s],lw(e,n,i)))}while(o<e.sym_next);cw(e,256,t)},xw=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.elems;let i,o,l,c=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<s;i++)0!==r[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,r[2*l]=1,e.depth[l]=0,e.opt_len--,a&&(e.static_len-=n[2*l+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)pw(e,r,i);l=s;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pw(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=o,r[2*l]=r[2*i]+r[2*o],e.depth[l]=(e.depth[i]>=e.depth[o]?e.depth[i]:e.depth[o])+1,r[2*i+1]=r[2*o+1]=l,e.heap[1]=l++,pw(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,d,u,h,f,m,p=0;for(h=0;h<=Wy;h++)e.bl_count[h]=0;for(r[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)d=e.heap[c],h=r[2*r[2*d+1]+1]+1,h>l&&(h=l,p++),r[2*d+1]=h,d>n||(e.bl_count[h]++,f=0,d>=o&&(f=i[d-o]),m=r[2*d],e.opt_len+=m*(h+f),s&&(e.static_len+=m*(a[2*d+1]+f)));if(0!==p){do{for(h=l-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[l]--,p-=2}while(p>0);for(h=l;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--c],u>n||(r[2*u+1]!==h&&(e.opt_len+=(h-r[2*u+1])*r[2*u],r[2*u+1]=h),d--)}})(e,t),uw(r,c,e.bl_count)},bw=(e,t,r)=>{let n,a,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)a=i,i=t[2*(n+1)+1],++o<l&&a===i||(o<c?e.bl_tree[2*a]+=o:0!==a?(a!==s&&e.bl_tree[2*a]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=a,0===i?(l=138,c=3):a===i?(l=6,c=3):(l=7,c=4))},vw=(e,t,r)=>{let n,a,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),n=0;n<=r;n++)if(a=i,i=t[2*(n+1)+1],!(++o<l&&a===i)){if(o<c)do{cw(e,a,e.bl_tree)}while(0!==--o);else 0!==a?(a!==s&&(cw(e,a,e.bl_tree),o--),cw(e,16,e.bl_tree),lw(e,o-3,2)):o<=10?(cw(e,17,e.bl_tree),lw(e,o-3,3)):(cw(e,18,e.bl_tree),lw(e,o-11,7));o=0,s=a,0===i?(l=138,c=3):a===i?(l=6,c=3):(l=7,c=4)}};let yw=!1;const ww=(e,t,r,n)=>{lw(e,0+(n?1:0),3),fw(e),ow(e,r),ow(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var Nw=e=>{yw||((()=>{let e,t,r,n,a;const s=new Array(16);for(r=0,n=0;n<28;n++)for(Zy[n]=r,e=0;e<1<<Vy[n];e++)Qy[r++]=n;for(Qy[r-1]=n,a=0,n=0;n<16;n++)for(ew[n]=a,e=0;e<1<<Gy[n];e++)Jy[a++]=n;for(a>>=7;n<Hy;n++)for(ew[n]=a<<7,e=0;e<1<<Gy[n]-7;e++)Jy[256+a++]=n;for(t=0;t<=Wy;t++)s[t]=0;for(e=0;e<=143;)Xy[2*e+1]=8,e++,s[8]++;for(;e<=255;)Xy[2*e+1]=9,e++,s[9]++;for(;e<=279;)Xy[2*e+1]=7,e++,s[7]++;for(;e<=287;)Xy[2*e+1]=8,e++,s[8]++;for(uw(Xy,287,s),e=0;e<Hy;e++)$y[2*e+1]=5,$y[2*e]=dw(e,5);rw=new tw(Xy,Vy,257,qy,Wy),nw=new tw($y,Gy,0,Hy,Wy),aw=new tw(new Array(0),Ky,0,19,7)})(),yw=!0),e.l_desc=new sw(e.dyn_ltree,rw),e.d_desc=new sw(e.dyn_dtree,nw),e.bl_desc=new sw(e.bl_tree,aw),e.bi_buf=0,e.bi_valid=0,hw(e)},jw=(e,t,r,n)=>{let a,s,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<zy;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),xw(e,e.l_desc),xw(e,e.d_desc),i=(e=>{let t;for(bw(e,e.dyn_ltree,e.l_desc.max_code),bw(e,e.dyn_dtree,e.d_desc.max_code),xw(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Yy[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),a=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=a&&(a=s)):a=s=r+5,r+4<=a&&-1!==t?ww(e,t,r,n):4===e.strategy||s===a?(lw(e,2+(n?1:0),3),gw(e,Xy,$y)):(lw(e,4+(n?1:0),3),((e,t,r,n)=>{let a;for(lw(e,t-257,5),lw(e,r-1,5),lw(e,n-4,4),a=0;a<n;a++)lw(e,e.bl_tree[2*Yy[a]+1],3);vw(e,e.dyn_ltree,t-1),vw(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),gw(e,e.dyn_ltree,e.dyn_dtree)),hw(e),n&&fw(e)},kw=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(Qy[r]+zy+1)]++,e.dyn_dtree[2*iw(t)]++),e.sym_next===e.sym_end),Sw=e=>{lw(e,2,3),cw(e,256,Xy),(e=>{16===e.bi_valid?(ow(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},Aw={_tr_init:Nw,_tr_stored_block:ww,_tr_flush_block:jw,_tr_tally:kw,_tr_align:Sw};var Cw=(e,t,r,n)=>{let a=65535&e,s=e>>>16&65535,i=0;for(;0!==r;){i=r>2e3?2e3:r,r-=i;do{a=a+t[n++]|0,s=s+a|0}while(--i);a%=65521,s%=65521}return a|s<<16};const _w=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var Tw=(e,t,r,n)=>{const a=_w,s=n+r;e^=-1;for(let i=n;i<s;i++)e=e>>>8^a[255&(e^t[i])];return-1^e},Ew={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Lw={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Pw,_tr_stored_block:Ow,_tr_flush_block:Fw,_tr_tally:Iw,_tr_align:Rw}=Aw,{Z_NO_FLUSH:Dw,Z_PARTIAL_FLUSH:Mw,Z_FULL_FLUSH:Bw,Z_FINISH:Uw,Z_BLOCK:zw,Z_OK:qw,Z_STREAM_END:Hw,Z_STREAM_ERROR:Ww,Z_DATA_ERROR:Vw,Z_BUF_ERROR:Gw,Z_DEFAULT_COMPRESSION:Kw,Z_FILTERED:Yw,Z_HUFFMAN_ONLY:Xw,Z_RLE:$w,Z_FIXED:Jw,Z_DEFAULT_STRATEGY:Qw,Z_UNKNOWN:Zw,Z_DEFLATED:eN}=Lw,tN=258,rN=262,nN=42,aN=113,sN=666,iN=(e,t)=>(e.msg=Ew[t],t),oN=e=>2*e-(e>4?9:0),lN=e=>{let t=e.length;for(;--t>=0;)e[t]=0},cN=e=>{let t,r,n,a=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=a?r-a:0}while(--t);t=a,n=t;do{r=e.prev[--n],e.prev[n]=r>=a?r-a:0}while(--t)};let dN=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const uN=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},hN=(e,t)=>{Fw(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,uN(e.strm)},fN=(e,t)=>{e.pending_buf[e.pending++]=t},mN=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},pN=(e,t,r,n)=>{let a=e.avail_in;return a>n&&(a=n),0===a?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),1===e.state.wrap?e.adler=Cw(e.adler,t,a,r):2===e.state.wrap&&(e.adler=Tw(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},gN=(e,t)=>{let r,n,a=e.max_chain_length,s=e.strstart,i=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-rN?e.strstart-(e.w_size-rN):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+tN;let f=c[s+i-1],m=c[s+i];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(r=t,c[r+i]===m&&c[r+i-1]===f&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<h);if(n=tN-(h-s),s=h-tN,n>i){if(e.match_start=t,i=n,n>=o)break;f=c[s+i-1],m=c[s+i]}}}while((t=u[t&d])>l&&0!==--a);return i<=e.lookahead?i:e.lookahead},xN=e=>{const t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-rN)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),cN(e),n+=t),0===e.strm.avail_in)break;if(r=pN(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=dN(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=dN(e,e.ins_h,e.window[a+3-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<rN&&0!==e.strm.avail_in)},bN=(e,t)=>{let r,n,a,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,o=e.strm.avail_in;do{if(r=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a)break;if(a=e.strm.avail_out-a,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>a&&(r=a),r<s&&(0===r&&t!==Uw||t===Dw||r!==n+e.strm.avail_in))break;i=t===Uw&&r===n+e.strm.avail_in?1:0,Ow(e,0,0,i),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,uN(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(pN(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===i);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==Dw&&t!==Uw&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(pN(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,s=a>e.w_size?e.w_size:a,n=e.strstart-e.block_start,(n>=s||(n||t===Uw)&&t!==Dw&&0===e.strm.avail_in&&n<=a)&&(r=n>a?a:n,i=t===Uw&&0===e.strm.avail_in&&r===n?1:0,Ow(e,e.block_start,r,i),e.block_start+=r,uN(e.strm)),i?3:1)},vN=(e,t)=>{let r,n;for(;;){if(e.lookahead<rN){if(xN(e),e.lookahead<rN&&t===Dw)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=dN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-rN&&(e.match_length=gN(e,r)),e.match_length>=3)if(n=Iw(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=dN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=dN(e,e.ins_h,e.window[e.strstart+1]);else n=Iw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(hN(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Uw?(hN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(hN(e,!1),0===e.strm.avail_out)?1:2},yN=(e,t)=>{let r,n,a;for(;;){if(e.lookahead<rN){if(xN(e),e.lookahead<rN&&t===Dw)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=dN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-rN&&(e.match_length=gN(e,r),e.match_length<=5&&(e.strategy===Yw||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,n=Iw(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=dN(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(hN(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=Iw(e,0,e.window[e.strstart-1]),n&&hN(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Iw(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Uw?(hN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(hN(e,!1),0===e.strm.avail_out)?1:2};function wN(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}const NN=[new wN(0,0,0,0,bN),new wN(4,4,8,4,vN),new wN(4,5,16,8,vN),new wN(4,6,32,32,vN),new wN(4,4,16,16,yN),new wN(8,16,32,32,yN),new wN(8,16,128,128,yN),new wN(8,32,128,256,yN),new wN(32,128,258,1024,yN),new wN(32,258,258,4096,yN)];function jN(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=eN,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),lN(this.dyn_ltree),lN(this.dyn_dtree),lN(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),lN(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),lN(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const kN=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==nN&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==aN&&t.status!==sN?1:0},SN=e=>{if(kN(e))return iN(e,Ww);e.total_in=e.total_out=0,e.data_type=Zw;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?nN:aN,e.adler=2===t.wrap?0:1,t.last_flush=-2,Pw(t),qw},AN=e=>{const t=SN(e);return t===qw&&(e=>{e.window_size=2*e.w_size,lN(e.head),e.max_lazy_match=NN[e.level].max_lazy,e.good_match=NN[e.level].good_length,e.nice_match=NN[e.level].nice_length,e.max_chain_length=NN[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},CN=(e,t,r,n,a,s)=>{if(!e)return Ww;let i=1;if(t===Kw&&(t=6),n<0?(i=0,n=-n):n>15&&(i=2,n-=16),a<1||a>9||r!==eN||n<8||n>15||t<0||t>9||s<0||s>Jw||8===n&&1!==i)return iN(e,Ww);8===n&&(n=9);const o=new jN;return e.state=o,o.strm=e,o.status=nN,o.wrap=i,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=r,AN(e)};var _N=(e,t)=>{if(kN(e)||t>zw||t<0)return e?iN(e,Ww):Ww;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===sN&&t!==Uw)return iN(e,0===e.avail_out?Gw:Ww);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(uN(e),0===e.avail_out)return r.last_flush=-1,qw}else if(0===e.avail_in&&oN(t)<=oN(n)&&t!==Uw)return iN(e,Gw);if(r.status===sN&&0!==e.avail_in)return iN(e,Gw);if(r.status===nN&&0===r.wrap&&(r.status=aN),r.status===nN){let t=eN+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=Xw||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,mN(r,t),0!==r.strstart&&(mN(r,e.adler>>>16),mN(r,65535&e.adler)),e.adler=1,r.status=aN,uN(e),0!==r.pending)return r.last_flush=-1,qw}if(57===r.status)if(e.adler=0,fN(r,31),fN(r,139),fN(r,8),r.gzhead)fN(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),fN(r,255&r.gzhead.time),fN(r,r.gzhead.time>>8&255),fN(r,r.gzhead.time>>16&255),fN(r,r.gzhead.time>>24&255),fN(r,9===r.level?2:r.strategy>=Xw||r.level<2?4:0),fN(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(fN(r,255&r.gzhead.extra.length),fN(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Tw(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(fN(r,0),fN(r,0),fN(r,0),fN(r,0),fN(r,0),fN(r,9===r.level?2:r.strategy>=Xw||r.level<2?4:0),fN(r,3),r.status=aN,uN(e),0!==r.pending)return r.last_flush=-1,qw;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let a=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=Tw(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=a,uN(e),0!==r.pending)return r.last_flush=-1,qw;t=0,n-=a}let a=new Uint8Array(r.gzhead.extra);r.pending_buf.set(a.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=Tw(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Tw(e.adler,r.pending_buf,r.pending-n,n)),uN(e),0!==r.pending)return r.last_flush=-1,qw;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,fN(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Tw(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Tw(e.adler,r.pending_buf,r.pending-n,n)),uN(e),0!==r.pending)return r.last_flush=-1,qw;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,fN(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Tw(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(uN(e),0!==r.pending))return r.last_flush=-1,qw;fN(r,255&e.adler),fN(r,e.adler>>8&255),e.adler=0}if(r.status=aN,uN(e),0!==r.pending)return r.last_flush=-1,qw}if(0!==e.avail_in||0!==r.lookahead||t!==Dw&&r.status!==sN){let n=0===r.level?bN(r,t):r.strategy===Xw?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(xN(e),0===e.lookahead)){if(t===Dw)return 1;break}if(e.match_length=0,r=Iw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(hN(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Uw?(hN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(hN(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===$w?((e,t)=>{let r,n,a,s;const i=e.window;for(;;){if(e.lookahead<=tN){if(xN(e),e.lookahead<=tN&&t===Dw)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(a=e.strstart-1,n=i[a],n===i[++a]&&n===i[++a]&&n===i[++a])){s=e.strstart+tN;do{}while(n===i[++a]&&n===i[++a]&&n===i[++a]&&n===i[++a]&&n===i[++a]&&n===i[++a]&&n===i[++a]&&n===i[++a]&&a<s);e.match_length=tN-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=Iw(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Iw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(hN(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Uw?(hN(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(hN(e,!1),0===e.strm.avail_out)?1:2})(r,t):NN[r.level].func(r,t);if(3!==n&&4!==n||(r.status=sN),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),qw;if(2===n&&(t===Mw?Rw(r):t!==zw&&(Ow(r,0,0,!1),t===Bw&&(lN(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),uN(e),0===e.avail_out))return r.last_flush=-1,qw}return t!==Uw?qw:r.wrap<=0?Hw:(2===r.wrap?(fN(r,255&e.adler),fN(r,e.adler>>8&255),fN(r,e.adler>>16&255),fN(r,e.adler>>24&255),fN(r,255&e.total_in),fN(r,e.total_in>>8&255),fN(r,e.total_in>>16&255),fN(r,e.total_in>>24&255)):(mN(r,e.adler>>>16),mN(r,65535&e.adler)),uN(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?qw:Hw)},TN=(e,t)=>{let r=t.length;if(kN(e))return Ww;const n=e.state,a=n.wrap;if(2===a||1===a&&n.status!==nN||n.lookahead)return Ww;if(1===a&&(e.adler=Cw(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===a&&(lN(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const s=e.avail_in,i=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,xN(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=dN(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,xN(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=i,e.input=o,e.avail_in=s,n.wrap=a,qw},EN={deflateInit:(e,t)=>CN(e,t,eN,15,8,Qw),deflateInit2:CN,deflateReset:AN,deflateResetKeep:SN,deflateSetHeader:(e,t)=>kN(e)||2!==e.state.wrap?Ww:(e.state.gzhead=t,qw),deflate:_N,deflateEnd:e=>{if(kN(e))return Ww;const t=e.state.status;return e.state=null,t===aN?iN(e,Vw):qw},deflateSetDictionary:TN,deflateInfo:"pako deflate (from Nodeca project)"};const LN=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var PN=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const t in r)LN(r,t)&&(e[t]=r[t])}}return e},ON=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,s=e.length;n<s;n++){let t=e[n];r.set(t,a),a+=t.length}return r};let FN=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Y_){FN=!1}const IN=new Uint8Array(256);for(let $=0;$<256;$++)IN[$]=$>=252?6:$>=248?5:$>=240?4:$>=224?3:$>=192?2:1;IN[254]=IN[254]=1;var RN=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,a,s,i=e.length,o=0;for(a=0;a<i;a++)r=e.charCodeAt(a),55296===(64512&r)&&a+1<i&&(n=e.charCodeAt(a+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),a++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),s=0,a=0;s<o;a++)r=e.charCodeAt(a),55296===(64512&r)&&a+1<i&&(n=e.charCodeAt(a+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},DN=(e,t)=>{const r=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,a;const s=new Array(2*r);for(a=0,n=0;n<r;){let t=e[n++];if(t<128){s[a++]=t;continue}let i=IN[t];if(i>4)s[a++]=65533,n+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&n<r;)t=t<<6|63&e[n++],i--;i>1?s[a++]=65533:t<65536?s[a++]=t:(t-=65536,s[a++]=55296|t>>10&1023,s[a++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&FN)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r})(s,a)},MN=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128===(192&e[r]);)r--;return r<0||0===r?t:r+IN[e[r]]>t?r:t};var BN=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const UN=Object.prototype.toString,{Z_NO_FLUSH:zN,Z_SYNC_FLUSH:qN,Z_FULL_FLUSH:HN,Z_FINISH:WN,Z_OK:VN,Z_STREAM_END:GN,Z_DEFAULT_COMPRESSION:KN,Z_DEFAULT_STRATEGY:YN,Z_DEFLATED:XN}=Lw;function $N(e){this.options=PN({level:KN,method:XN,chunkSize:16384,windowBits:15,memLevel:8,strategy:YN},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new BN,this.strm.avail_out=0;let r=EN.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==VN)throw new Error(Ew[r]);if(t.header&&EN.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?RN(t.dictionary):"[object ArrayBuffer]"===UN.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=EN.deflateSetDictionary(this.strm,e),r!==VN)throw new Error(Ew[r]);this._dict_set=!0}}function JN(e,t){const r=new $N(t);if(r.push(e,!0),r.err)throw r.msg||Ew[r.err];return r.result}$N.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let a,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?WN:zN,"string"===typeof e?r.input=RN(e):"[object ArrayBuffer]"===UN.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(s===qN||s===HN)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(a=EN.deflate(r,s),a===GN)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=EN.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===VN;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},$N.prototype.onData=function(e){this.chunks.push(e)},$N.prototype.onEnd=function(e){e===VN&&(this.result=ON(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var QN={Deflate:$N,deflate:JN,deflateRaw:function(e,t){return(t=t||{}).raw=!0,JN(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,JN(e,t)},constants:Lw};const ZN=16209;var ej=function(e,t){let r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,b,v,y,w,N,j,k,S;const A=e.state;r=e.next_in,k=e.input,n=r+(e.avail_in-5),a=e.next_out,S=e.output,s=a-(t-e.avail_out),i=a+(e.avail_out-257),o=A.dmax,l=A.wsize,c=A.whave,d=A.wnext,u=A.window,h=A.hold,f=A.bits,m=A.lencode,p=A.distcode,g=(1<<A.lenbits)-1,x=(1<<A.distbits)-1;e:do{f<15&&(h+=k[r++]<<f,f+=8,h+=k[r++]<<f,f+=8),b=m[h&g];t:for(;;){if(v=b>>>24,h>>>=v,f-=v,v=b>>>16&255,0===v)S[a++]=65535&b;else{if(!(16&v)){if(0===(64&v)){b=m[(65535&b)+(h&(1<<v)-1)];continue t}if(32&v){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=ZN;break e}y=65535&b,v&=15,v&&(f<v&&(h+=k[r++]<<f,f+=8),y+=h&(1<<v)-1,h>>>=v,f-=v),f<15&&(h+=k[r++]<<f,f+=8,h+=k[r++]<<f,f+=8),b=p[h&x];r:for(;;){if(v=b>>>24,h>>>=v,f-=v,v=b>>>16&255,!(16&v)){if(0===(64&v)){b=p[(65535&b)+(h&(1<<v)-1)];continue r}e.msg="invalid distance code",A.mode=ZN;break e}if(w=65535&b,v&=15,f<v&&(h+=k[r++]<<f,f+=8,f<v&&(h+=k[r++]<<f,f+=8)),w+=h&(1<<v)-1,w>o){e.msg="invalid distance too far back",A.mode=ZN;break e}if(h>>>=v,f-=v,v=a-s,w>v){if(v=w-v,v>c&&A.sane){e.msg="invalid distance too far back",A.mode=ZN;break e}if(N=0,j=u,0===d){if(N+=l-v,v<y){y-=v;do{S[a++]=u[N++]}while(--v);N=a-w,j=S}}else if(d<v){if(N+=l+d-v,v-=d,v<y){y-=v;do{S[a++]=u[N++]}while(--v);if(N=0,d<y){v=d,y-=v;do{S[a++]=u[N++]}while(--v);N=a-w,j=S}}}else if(N+=d-v,v<y){y-=v;do{S[a++]=u[N++]}while(--v);N=a-w,j=S}for(;y>2;)S[a++]=j[N++],S[a++]=j[N++],S[a++]=j[N++],y-=3;y&&(S[a++]=j[N++],y>1&&(S[a++]=j[N++]))}else{N=a-w;do{S[a++]=S[N++],S[a++]=S[N++],S[a++]=S[N++],y-=3}while(y>2);y&&(S[a++]=S[N++],y>1&&(S[a++]=S[N++]))}break}}break}}while(r<n&&a<i);y=f>>3,r-=y,f-=y<<3,h&=(1<<f)-1,e.next_in=r,e.next_out=a,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=a<i?i-a+257:257-(a-i),A.hold=h,A.bits=f};const tj=15,rj=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),nj=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),aj=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),sj=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ij=(e,t,r,n,a,s,i,o)=>{const l=o.bits;let c,d,u,h,f,m,p=0,g=0,x=0,b=0,v=0,y=0,w=0,N=0,j=0,k=0,S=null;const A=new Uint16Array(16),C=new Uint16Array(16);let _,T,E,L=null;for(p=0;p<=tj;p++)A[p]=0;for(g=0;g<n;g++)A[t[r+g]]++;for(v=l,b=tj;b>=1&&0===A[b];b--);if(v>b&&(v=b),0===b)return a[s++]=20971520,a[s++]=20971520,o.bits=1,0;for(x=1;x<b&&0===A[x];x++);for(v<x&&(v=x),N=1,p=1;p<=tj;p++)if(N<<=1,N-=A[p],N<0)return-1;if(N>0&&(0===e||1!==b))return-1;for(C[1]=0,p=1;p<tj;p++)C[p+1]=C[p]+A[p];for(g=0;g<n;g++)0!==t[r+g]&&(i[C[t[r+g]]++]=g);if(0===e?(S=L=i,m=20):1===e?(S=rj,L=nj,m=257):(S=aj,L=sj,m=0),k=0,g=0,p=x,f=s,y=v,w=0,u=-1,j=1<<v,h=j-1,1===e&&j>852||2===e&&j>592)return 1;for(;;){_=p-w,i[g]+1<m?(T=0,E=i[g]):i[g]>=m?(T=L[i[g]-m],E=S[i[g]-m]):(T=96,E=0),c=1<<p-w,d=1<<y,x=d;do{d-=c,a[f+(k>>w)+d]=_<<24|T<<16|E}while(0!==d);for(c=1<<p-1;k&c;)c>>=1;if(0!==c?(k&=c-1,k+=c):k=0,g++,0===--A[p]){if(p===b)break;p=t[r+i[g]]}if(p>v&&(k&h)!==u){for(0===w&&(w=v),f+=x,y=p-w,N=1<<y;y+w<b&&(N-=A[y+w],!(N<=0));)y++,N<<=1;if(j+=1<<y,1===e&&j>852||2===e&&j>592)return 1;u=k&h,a[u]=v<<24|y<<16|f-s}}return 0!==k&&(a[f+k]=p-w<<24|64<<16),o.bits=v,0};const{Z_FINISH:oj,Z_BLOCK:lj,Z_TREES:cj,Z_OK:dj,Z_STREAM_END:uj,Z_NEED_DICT:hj,Z_STREAM_ERROR:fj,Z_DATA_ERROR:mj,Z_MEM_ERROR:pj,Z_BUF_ERROR:gj,Z_DEFLATED:xj}=Lw,bj=16180,vj=16190,yj=16191,wj=16192,Nj=16194,jj=16199,kj=16200,Sj=16206,Aj=16209,Cj=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function _j(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Tj=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<bj||t.mode>16211?1:0},Ej=e=>{if(Tj(e))return fj;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=bj,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,dj},Lj=e=>{if(Tj(e))return fj;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ej(e)},Pj=(e,t)=>{let r;if(Tj(e))return fj;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?fj:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Lj(e))},Oj=(e,t)=>{if(!e)return fj;const r=new _j;e.state=r,r.strm=e,r.window=null,r.mode=bj;const n=Pj(e,t);return n!==dj&&(e.state=null),n};let Fj,Ij,Rj=!0;const Dj=e=>{if(Rj){Fj=new Int32Array(512),Ij=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ij(1,e.lens,0,288,Fj,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ij(2,e.lens,0,32,Ij,0,e.work,{bits:5}),Rj=!1}e.lencode=Fj,e.lenbits=9,e.distcode=Ij,e.distbits=5},Mj=(e,t,r,n)=>{let a;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(t.subarray(r-n,r-n+a),s.wnext),(n-=a)?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0};var Bj=(e,t)=>{let r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,b,v,y,w,N,j,k=0;const S=new Uint8Array(4);let A,C;const _=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Tj(e)||!e.output||!e.input&&0!==e.avail_in)return fj;r=e.state,r.mode===yj&&(r.mode=wj),i=e.next_out,a=e.output,l=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,c=r.hold,d=r.bits,u=o,h=l,j=dj;e:for(;;)switch(r.mode){case bj:if(0===r.wrap){r.mode=wj;break}for(;d<16;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,S[0]=255&c,S[1]=c>>>8&255,r.check=Tw(r.check,S,2,0),c=0,d=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Aj;break}if((15&c)!==xj){e.msg="unknown compression method",r.mode=Aj;break}if(c>>>=4,d-=4,N=8+(15&c),0===r.wbits&&(r.wbits=N),N>15||N>r.wbits){e.msg="invalid window size",r.mode=Aj;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:yj,c=0,d=0;break;case 16181:for(;d<16;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(r.flags=c,(255&r.flags)!==xj){e.msg="unknown compression method",r.mode=Aj;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Aj;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=Tw(r.check,S,2,0)),c=0,d=0,r.mode=16182;case 16182:for(;d<32;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,r.check=Tw(r.check,S,4,0)),c=0,d=0,r.mode=16183;case 16183:for(;d<16;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=Tw(r.check,S,2,0)),c=0,d=0,r.mode=16184;case 16184:if(1024&r.flags){for(;d<16;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=Tw(r.check,S,2,0)),c=0,d=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>o&&(f=o),f&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+f),N)),512&r.flags&&4&r.wrap&&(r.check=Tw(r.check,n,f,s)),o-=f,s+=f,r.length-=f),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===o)break e;f=0;do{N=n[s+f++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N))}while(N&&f<o);if(512&r.flags&&4&r.wrap&&(r.check=Tw(r.check,n,f,s)),o-=f,s+=f,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===o)break e;f=0;do{N=n[s+f++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N))}while(N&&f<o);if(512&r.flags&&4&r.wrap&&(r.check=Tw(r.check,n,f,s)),o-=f,s+=f,N)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;d<16;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Aj;break}c=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=yj;break;case 16189:for(;d<32;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}e.adler=r.check=Cj(c),c=0,d=0,r.mode=vj;case vj:if(0===r.havedict)return e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=d,hj;e.adler=r.check=1,r.mode=yj;case yj:if(t===lj||t===cj)break e;case wj:if(r.last){c>>>=7&d,d-=7&d,r.mode=Sj;break}for(;d<3;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}switch(r.last=1&c,c>>>=1,d-=1,3&c){case 0:r.mode=16193;break;case 1:if(Dj(r),r.mode=jj,t===cj){c>>>=2,d-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Aj}c>>>=2,d-=2;break;case 16193:for(c>>>=7&d,d-=7&d;d<32;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if((65535&c)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Aj;break}if(r.length=65535&c,c=0,d=0,r.mode=Nj,t===cj)break e;case Nj:r.mode=16195;case 16195:if(f=r.length,f){if(f>o&&(f=o),f>l&&(f=l),0===f)break e;a.set(n.subarray(s,s+f),i),o-=f,s+=f,l-=f,i+=f,r.length-=f;break}r.mode=yj;break;case 16196:for(;d<14;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(r.nlen=257+(31&c),c>>>=5,d-=5,r.ndist=1+(31&c),c>>>=5,d-=5,r.ncode=4+(15&c),c>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Aj;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;d<3;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}r.lens[_[r.have++]]=7&c,c>>>=3,d-=3}for(;r.have<19;)r.lens[_[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},j=ij(0,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,j){e.msg="invalid code lengths set",r.mode=Aj;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;k=r.lencode[c&(1<<r.lenbits)-1],g=k>>>24,x=k>>>16&255,b=65535&k,!(g<=d);){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(b<16)c>>>=g,d-=g,r.lens[r.have++]=b;else{if(16===b){for(C=g+2;d<C;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(c>>>=g,d-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=Aj;break}N=r.lens[r.have-1],f=3+(3&c),c>>>=2,d-=2}else if(17===b){for(C=g+3;d<C;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}c>>>=g,d-=g,N=0,f=3+(7&c),c>>>=3,d-=3}else{for(C=g+7;d<C;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}c>>>=g,d-=g,N=0,f=11+(127&c),c>>>=7,d-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Aj;break}for(;f--;)r.lens[r.have++]=N}}if(r.mode===Aj)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Aj;break}if(r.lenbits=9,A={bits:r.lenbits},j=ij(1,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,j){e.msg="invalid literal/lengths set",r.mode=Aj;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},j=ij(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,j){e.msg="invalid distances set",r.mode=Aj;break}if(r.mode=jj,t===cj)break e;case jj:r.mode=kj;case kj:if(o>=6&&l>=258){e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=d,ej(e,h),i=e.next_out,a=e.output,l=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,c=r.hold,d=r.bits,r.mode===yj&&(r.back=-1);break}for(r.back=0;k=r.lencode[c&(1<<r.lenbits)-1],g=k>>>24,x=k>>>16&255,b=65535&k,!(g<=d);){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(x&&0===(240&x)){for(v=g,y=x,w=b;k=r.lencode[w+((c&(1<<v+y)-1)>>v)],g=k>>>24,x=k>>>16&255,b=65535&k,!(v+g<=d);){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}c>>>=v,d-=v,r.back+=v}if(c>>>=g,d-=g,r.back+=g,r.length=b,0===x){r.mode=16205;break}if(32&x){r.back=-1,r.mode=yj;break}if(64&x){e.msg="invalid literal/length code",r.mode=Aj;break}r.extra=15&x,r.mode=16201;case 16201:if(r.extra){for(C=r.extra;d<C;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;k=r.distcode[c&(1<<r.distbits)-1],g=k>>>24,x=k>>>16&255,b=65535&k,!(g<=d);){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(0===(240&x)){for(v=g,y=x,w=b;k=r.distcode[w+((c&(1<<v+y)-1)>>v)],g=k>>>24,x=k>>>16&255,b=65535&k,!(v+g<=d);){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}c>>>=v,d-=v,r.back+=v}if(c>>>=g,d-=g,r.back+=g,64&x){e.msg="invalid distance code",r.mode=Aj;break}r.offset=b,r.extra=15&x,r.mode=16203;case 16203:if(r.extra){for(C=r.extra;d<C;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Aj;break}r.mode=16204;case 16204:if(0===l)break e;if(f=h-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Aj;break}f>r.wnext?(f-=r.wnext,m=r.wsize-f):m=r.wnext-f,f>r.length&&(f=r.length),p=r.window}else p=a,m=i-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{a[i++]=p[m++]}while(--f);0===r.length&&(r.mode=kj);break;case 16205:if(0===l)break e;a[i++]=r.length,l--,r.mode=kj;break;case Sj:if(r.wrap){for(;d<32;){if(0===o)break e;o--,c|=n[s++]<<d,d+=8}if(h-=l,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?Tw(r.check,a,h,i-h):Cw(r.check,a,h,i-h)),h=l,4&r.wrap&&(r.flags?c:Cj(c))!==r.check){e.msg="incorrect data check",r.mode=Aj;break}c=0,d=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;d<32;){if(0===o)break e;o--,c+=n[s++]<<d,d+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Aj;break}c=0,d=0}r.mode=16208;case 16208:j=uj;break e;case Aj:j=mj;break e;case 16210:return pj;default:return fj}return e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<Aj&&(r.mode<Sj||t!==oj))&&Mj(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?Tw(r.check,a,h,e.next_out-h):Cw(r.check,a,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===yj?128:0)+(r.mode===jj||r.mode===Nj?256:0),(0===u&&0===h||t===oj)&&j===dj&&(j=gj),j},Uj={inflateReset:Lj,inflateReset2:Pj,inflateResetKeep:Ej,inflateInit:e=>Oj(e,15),inflateInit2:Oj,inflate:Bj,inflateEnd:e=>{if(Tj(e))return fj;let t=e.state;return t.window&&(t.window=null),e.state=null,dj},inflateGetHeader:(e,t)=>{if(Tj(e))return fj;const r=e.state;return 0===(2&r.wrap)?fj:(r.head=t,t.done=!1,dj)},inflateSetDictionary:(e,t)=>{const r=t.length;let n,a,s;return Tj(e)?fj:(n=e.state,0!==n.wrap&&n.mode!==vj?fj:n.mode===vj&&(a=1,a=Cw(a,t,r,0),a!==n.check)?mj:(s=Mj(e,t,r,r),s?(n.mode=16210,pj):(n.havedict=1,dj)))},inflateInfo:"pako inflate (from Nodeca project)"};var zj=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const qj=Object.prototype.toString,{Z_NO_FLUSH:Hj,Z_FINISH:Wj,Z_OK:Vj,Z_STREAM_END:Gj,Z_NEED_DICT:Kj,Z_STREAM_ERROR:Yj,Z_DATA_ERROR:Xj,Z_MEM_ERROR:$j}=Lw;function Jj(e){this.options=PN({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new BN,this.strm.avail_out=0;let r=Uj.inflateInit2(this.strm,t.windowBits);if(r!==Vj)throw new Error(Ew[r]);if(this.header=new zj,Uj.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=RN(t.dictionary):"[object ArrayBuffer]"===qj.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Uj.inflateSetDictionary(this.strm,t.dictionary),r!==Vj)))throw new Error(Ew[r])}function Qj(e,t){const r=new Jj(t);if(r.push(e),r.err)throw r.msg||Ew[r.err];return r.result}Jj.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,i,o;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Wj:Hj,"[object ArrayBuffer]"===qj.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Uj.inflate(r,i),s===Kj&&a&&(s=Uj.inflateSetDictionary(r,a),s===Vj?s=Uj.inflate(r,i):s===Xj&&(s=Kj));r.avail_in>0&&s===Gj&&r.state.wrap>0&&0!==e[r.next_in];)Uj.inflateReset(r),s=Uj.inflate(r,i);switch(s){case Yj:case Xj:case Kj:case $j:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(0===r.avail_out||s===Gj))if("string"===this.options.to){let e=MN(r.output,r.next_out),t=r.next_out-e,a=DN(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(a)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==Vj||0!==o){if(s===Gj)return s=Uj.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Jj.prototype.onData=function(e){this.chunks.push(e)},Jj.prototype.onEnd=function(e){e===Vj&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ON(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Zj={Inflate:Jj,inflate:Qj,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Qj(e,t)},ungzip:Qj,constants:Lw};const{Deflate:ek,deflate:tk,deflateRaw:rk,gzip:nk}=QN,{Inflate:ak,inflate:sk,inflateRaw:ik,ungzip:ok}=Zj;var lk=ak,ck=sk;const dk=[];for(let $=0;$<256;$++){let e=$;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;dk[$]=e}const uk=4294967295;function hk(e,t){return(function(e,t,r){let n=e;for(let a=0;a<r;a++)n=dk[255&(n^t[a])]^n>>>8;return n}(uk,e,t)^uk)>>>0}function fk(e,t,r){const n=e.readUint32(),a=hk(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error("CRC mismatch for chunk ".concat(r,". Expected ").concat(n,", found ").concat(a))}function mk(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function pk(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function gk(e,t,r,n){let a=0;if(0===r.length)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function xk(e,t,r,n,a){let s=0;if(0===r.length){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-a]>>1)&255}else{for(;s<a;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-a]+r[s]>>1)&255}}function bk(e,t,r,n,a){let s=0;if(0===r.length){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-a]&255}else{for(;s<a;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+vk(t[s-a],r[s],r[s-a])&255}}function vk(e,t,r){const n=e+t-r,a=Math.abs(n-e),s=Math.abs(n-t),i=Math.abs(n-r);return a<=s&&a<=i?e:s<=i?t:r}function yk(e,t,r,n,a,s){switch(e){case 0:mk(t,r,a);break;case 1:pk(t,r,a,s);break;case 2:gk(t,r,n,a);break;case 3:xk(t,r,n,a,s);break;case 4:bk(t,r,n,a,s);break;default:throw new Error("Unsupported filter: ".concat(e))}}const wk=new Uint16Array([255]),Nk=255===new Uint8Array(wk.buffer)[0];function jk(e){return(255&e)<<8|e>>8&255}const kk=new Uint16Array([255]),Sk=255===new Uint8Array(kk.buffer)[0],Ak=new Uint8Array(0);function Ck(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,i=Math.ceil(s/8)*a,o=Math.ceil(s/8*a*r),l=new Uint8Array(n*o);let c,d,u=Ak,h=0;for(let f=0;f<n;f++){switch(c=t.subarray(h+1,h+1+o),d=l.subarray(f*o,(f+1)*o),t[h]){case 0:mk(c,d,o);break;case 1:pk(c,d,o,i);break;case 2:gk(c,d,u,o);break;case 3:xk(c,d,u,o,i);break;case 4:bk(c,d,u,o,i);break;default:throw new Error("Unsupported filter: ".concat(t[h]))}u=d,h+=o+1}if(16===s){const e=new Uint16Array(l.buffer);if(Sk)for(let t=0;t<e.length;t++)e[t]=_k(e[t]);return e}return l}function _k(e){return(255&e)<<8|e>>8&255}const Tk=Uint8Array.of(137,80,78,71,13,10,26,10);function Ek(e){if(!function(e){if(e.length<Tk.length)return!1;for(let t=0;t<Tk.length;t++)if(e[t]!==Tk[t])return!1;return!0}(e.readBytes(Tk.length)))throw new Error("wrong PNG signature")}const Lk="tEXt",Pk=new TextDecoder("latin1");function Ok(e){if(Ik(e),0===e.length||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Fk=/^[\u0000-\u00FF]*$/;function Ik(e){if(!Fk.test(e))throw new Error("invalid latin1 text")}function Rk(e,t,r){const n=Dk(t);e[n]=function(e,t){return Pk.decode(e.readBytes(t))}(t,r-n.length-1)}function Dk(e){for(e.mark();0!==e.readByte(););const t=e.offset;e.reset();const r=Pk.decode(e.readBytes(t-e.offset-1));return e.skip(1),Ok(r),r}const Mk=-1,Bk=0,Uk=2,zk=3,qk=4,Hk=6,Wk=-1,Vk=0,Gk=-1,Kk=0,Yk=-1,Xk=0,$k=1,Jk=0,Qk=1,Zk=2,eS=0,tS=1;class rS extends By{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),(0,qe.A)(this,"_checkCrc",void 0),(0,qe.A)(this,"_inflator",void 0),(0,qe.A)(this,"_png",void 0),(0,qe.A)(this,"_apng",void 0),(0,qe.A)(this,"_end",void 0),(0,qe.A)(this,"_hasPalette",void 0),(0,qe.A)(this,"_palette",void 0),(0,qe.A)(this,"_hasTransparency",void 0),(0,qe.A)(this,"_transparency",void 0),(0,qe.A)(this,"_compressionMethod",void 0),(0,qe.A)(this,"_filterMethod",void 0),(0,qe.A)(this,"_interlaceMethod",void 0),(0,qe.A)(this,"_colorType",void 0),(0,qe.A)(this,"_isAnimated",void 0),(0,qe.A)(this,"_numberOfFrames",void 0),(0,qe.A)(this,"_numberOfPlays",void 0),(0,qe.A)(this,"_frames",void 0),(0,qe.A)(this,"_writingDataChunks",void 0);const{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new lk,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Wk,this._filterMethod=Gk,this._interlaceMethod=Yk,this._colorType=Mk,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Ek(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(Ek(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Lk:Rk(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-r!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?fk(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const r=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=r+e}if(this.offset-r!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?fk(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw new Error("invalid bit depth: ".concat(e));return e}(this.readUint8());const t=this.readUint8();let r;switch(this._colorType=t,t){case Bk:r=1;break;case Uk:r=3;break;case zk:r=1;break;case qk:r=2;break;case Hk:r=4;break;default:throw new Error("Unknown color type: ".concat(t))}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==Vk)throw new Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError("PLTE field length must be a multiple of 3. Got ".concat(e));const t=e/3;this._hasPalette=!0;const r=[];this._palette=r;for(let n=0;n<t;n++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodetRNS(e){switch(this._colorType){case Bk:case Uk:if(e%2!==0)throw new RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(e));if(e/2>this._png.width*this._png.height)throw new Error("tRNS chunk contains more alpha values than there are pixels (".concat(e/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case zk:{if(e>this._palette.length)throw new Error("tRNS chunk contains more alpha values than there are palette colors (".concat(e," vs ").concat(this._palette.length,")"));let t=0;for(;t<e;t++){const e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(e){const t=Dk(this),r=this.readUint8();if(r!==Vk)throw new Error("Unsupported iCCP compression method: ".concat(r));const n=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:ck(n)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:e,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(e);if(r){if(r.data=Ck({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===r.xOffset&&0===r.yOffset&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(r,n,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,r){switch(e.disposeOp){case Jk:break;case Qk:for(let t=0;t<this._png.height;t++)for(let n=0;n<this._png.width;n++){const a=(t*e.width+n)*this._png.channels;for(let e=0;e<this._png.channels;e++)r.data[a+e]=0}break;case Zk:r.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const r=1<<this._png.depth,n=(e,r)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+r)*this._png.channels,frameIndex:(e*t.width+r)*this._png.channels});switch(t.blendOp){case eS:for(let r=0;r<t.height;r++)for(let a=0;a<t.width;a++){const{index:s,frameIndex:i}=n(r,a);for(let r=0;r<this._png.channels;r++)e.data[s+r]=t.data[i+r]}break;case tS:for(let a=0;a<t.height;a++)for(let s=0;s<t.width;s++){const{index:i,frameIndex:o}=n(a,s);for(let n=0;n<this._png.channels;n++){const a=t.data[o+this._png.channels-1]/r,s=n%(this._png.channels-1)===0?1:t.data[o+n],l=Math.floor(a*s+(1-a)*e.data[i+n]);e.data[i+n]+=l}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var e;if(this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));const t=this._isAnimated?(null===(e=this._frames)||void 0===e?void 0:e.at(0)).data:this._inflator.result;if(this._filterMethod!==Kk)throw new Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===Xk)this._png.data=Ck({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==$k)throw new Error("Interlace method ".concat(this._interlaceMethod," not supported"));this._png.data=function(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*a,l=new Uint8Array(n*r*o);let c=0;for(let d=0;d<7;d++){const e=i[d],a=Math.ceil((r-e.x)/e.xStep),s=Math.ceil((n-e.y)/e.yStep);if(a<=0||s<=0)continue;const u=a*o,h=new Uint8Array(u);for(let i=0;i<s;i++){const s=t[c++],d=t.subarray(c,c+u);c+=u;const f=new Uint8Array(u);yk(s,d,f,h,u,o),h.set(f);for(let t=0;t<a;t++){const a=e.x+t*e.xStep,s=e.y+i*e.yStep;if(!(a>=r||s>=n))for(let e=0;e<o;e++)l[(s*r+a)*o+e]=f[t*o+e]}}}if(16===s){const e=new Uint16Array(l.buffer);if(Nk)for(let t=0;t<e.length;t++)e[t]=jk(e[t]);return e}return l}({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Jk,blendOp:eS,data:e}),this._inflator=new lk,this._writingDataChunks=!1}}var nS;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"}(nS||(nS={}));var aS=function(){return"undefined"!=typeof window?window:"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:this}();function sS(){aS.console&&"function"==typeof aS.console.log&&aS.console.log.apply(aS.console,arguments)}var iS={log:sS,warn:function(e){aS.console&&("function"==typeof aS.console.warn?aS.console.warn.apply(aS.console,arguments):sS.call(null,arguments))},error:function(e){aS.console&&("function"==typeof aS.console.error?aS.console.error.apply(aS.console,arguments):sS(e))}};function oS(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){dS(n.response,t,r)},n.onerror=function(){iS.error("could not download file")},n.send()}function lS(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return t.status>=200&&t.status<=299}function cS(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var dS=aS.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,Kv.A)(window))||window!==aS?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=aS.URL||aS.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?lS(a.href)?oS(e,t,r):cS(a,a.target="_blank"):cS(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){cS(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download","string"==typeof e)if(lS(e))oS(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){cS(n)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,Kv.A)(t)&&(iS.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return oS(e,t,r);var a="application/octet-stream"===e.type,s=/constructor/i.test(aS.HTMLElement)||aS.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&s)&&"object"===("undefined"==typeof FileReader?"undefined":(0,Kv.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var e=o.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},o.readAsDataURL(e)}else{var l=aS.URL||aS.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function uS(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,i=a.exec(e);i&&(t=s(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==r.length&&(r="0"+r),"#"+e+t+r}}var hS=aS.atob.bind(aS),fS=aS.btoa.bind(aS);function mS(e,t){var r=e[0],n=e[1],a=e[2],s=e[3];r=gS(r,n,a,s,t[0],7,-680876936),s=gS(s,r,n,a,t[1],12,-389564586),a=gS(a,s,r,n,t[2],17,606105819),n=gS(n,a,s,r,t[3],22,-1044525330),r=gS(r,n,a,s,t[4],7,-176418897),s=gS(s,r,n,a,t[5],12,1200080426),a=gS(a,s,r,n,t[6],17,-1473231341),n=gS(n,a,s,r,t[7],22,-45705983),r=gS(r,n,a,s,t[8],7,1770035416),s=gS(s,r,n,a,t[9],12,-1958414417),a=gS(a,s,r,n,t[10],17,-42063),n=gS(n,a,s,r,t[11],22,-1990404162),r=gS(r,n,a,s,t[12],7,1804603682),s=gS(s,r,n,a,t[13],12,-40341101),a=gS(a,s,r,n,t[14],17,-1502002290),r=xS(r,n=gS(n,a,s,r,t[15],22,1236535329),a,s,t[1],5,-165796510),s=xS(s,r,n,a,t[6],9,-1069501632),a=xS(a,s,r,n,t[11],14,643717713),n=xS(n,a,s,r,t[0],20,-373897302),r=xS(r,n,a,s,t[5],5,-701558691),s=xS(s,r,n,a,t[10],9,38016083),a=xS(a,s,r,n,t[15],14,-660478335),n=xS(n,a,s,r,t[4],20,-405537848),r=xS(r,n,a,s,t[9],5,568446438),s=xS(s,r,n,a,t[14],9,-1019803690),a=xS(a,s,r,n,t[3],14,-187363961),n=xS(n,a,s,r,t[8],20,1163531501),r=xS(r,n,a,s,t[13],5,-1444681467),s=xS(s,r,n,a,t[2],9,-51403784),a=xS(a,s,r,n,t[7],14,1735328473),r=bS(r,n=xS(n,a,s,r,t[12],20,-1926607734),a,s,t[5],4,-378558),s=bS(s,r,n,a,t[8],11,-2022574463),a=bS(a,s,r,n,t[11],16,1839030562),n=bS(n,a,s,r,t[14],23,-35309556),r=bS(r,n,a,s,t[1],4,-1530992060),s=bS(s,r,n,a,t[4],11,1272893353),a=bS(a,s,r,n,t[7],16,-155497632),n=bS(n,a,s,r,t[10],23,-1094730640),r=bS(r,n,a,s,t[13],4,681279174),s=bS(s,r,n,a,t[0],11,-358537222),a=bS(a,s,r,n,t[3],16,-722521979),n=bS(n,a,s,r,t[6],23,76029189),r=bS(r,n,a,s,t[9],4,-640364487),s=bS(s,r,n,a,t[12],11,-421815835),a=bS(a,s,r,n,t[15],16,530742520),r=vS(r,n=bS(n,a,s,r,t[2],23,-995338651),a,s,t[0],6,-198630844),s=vS(s,r,n,a,t[7],10,1126891415),a=vS(a,s,r,n,t[14],15,-1416354905),n=vS(n,a,s,r,t[5],21,-57434055),r=vS(r,n,a,s,t[12],6,1700485571),s=vS(s,r,n,a,t[3],10,-1894986606),a=vS(a,s,r,n,t[10],15,-1051523),n=vS(n,a,s,r,t[1],21,-2054922799),r=vS(r,n,a,s,t[8],6,1873313359),s=vS(s,r,n,a,t[15],10,-30611744),a=vS(a,s,r,n,t[6],15,-1560198380),n=vS(n,a,s,r,t[13],21,1309151649),r=vS(r,n,a,s,t[4],6,-145523070),s=vS(s,r,n,a,t[11],10,-1120210379),a=vS(a,s,r,n,t[2],15,718787259),n=vS(n,a,s,r,t[9],21,-343485551),e[0]=CS(r,e[0]),e[1]=CS(n,e[1]),e[2]=CS(a,e[2]),e[3]=CS(s,e[3])}function pS(e,t,r,n,a,s){return t=CS(CS(t,e),CS(n,s)),CS(t<<a|t>>>32-a,r)}function gS(e,t,r,n,a,s,i){return pS(t&r|~t&n,e,t,a,s,i)}function xS(e,t,r,n,a,s,i){return pS(t&n|r&~n,e,t,a,s,i)}function bS(e,t,r,n,a,s,i){return pS(t^r^n,e,t,a,s,i)}function vS(e,t,r,n,a,s,i){return pS(r^(t|~n),e,t,a,s,i)}function yS(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)mS(n,wS(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(mS(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,mS(n,a),n}function wS(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var NS="0123456789abcdef".split("");function jS(e){for(var t="",r=0;r<4;r++)t+=NS[e>>8*r+4&15]+NS[e>>8*r&15];return t}function kS(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function SS(e){return yS(e).map(kS).join("")}var AS="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=jS(e[t]);return e.join("")}(yS("hello"));function CS(e,t){if(AS){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}function _S(e,t){var r,n,a,s;if(e!==r){for(var i=(a=e,s=1+(256/e.length|0),new Array(s+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var d=o[l];c=(c+d+i.charCodeAt(l))%256,o[l]=o[c],o[c]=d}r=e,n=o}else o=n;var u=t.length,h=0,f=0,m="";for(l=0;l<u;l++)f=(f+(d=o[h=(h+1)%256]))%256,o[h]=o[f],o[f]=d,i=o[(o[h]+o[f])%256],m+=String.fromCharCode(t.charCodeAt(l)^i);return m}var TS={print:4,modify:8,copy:16,"annot-forms":32};function ES(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(e){if(void 0!==TS.perm)throw new Error("Invalid permission: "+e);a+=TS[e]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var s=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^a)),this.encryptionKey=SS(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=_S(this.encryptionKey,this.padding)}function LS(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||35===a||37===a||40===a||41===a||47===a||60===a||62===a||91===a||93===a||123===a||125===a||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function PS(e){if("object"!==(0,Kv.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,r,n){if(n=n||!1,"string"!=typeof e||"function"!=typeof r||"boolean"!=typeof n)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var a=Math.random().toString(35);return t[e][a]=[r,!!n],a},this.unsubscribe=function(e){for(var r in t)if(t[r][e])return delete t[r][e],0===Object.keys(t[r]).length&&delete t[r],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in t[r]){var i=t[r][s];try{i[0].apply(e,n)}catch(cS){aS.console&&iS.error("jsPDF PubSub Error",cS.message,cS)}i[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function OS(e){if(!(this instanceof OS))return new OS(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function FS(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function IS(e,t,r,n,a){if(!(this instanceof IS))return new IS(e,t,r,n,a);this.type="axial"===e?2:3,this.coords=t,this.colors=r,FS.call(this,n,a)}function RS(e,t,r,n,a){if(!(this instanceof RS))return new RS(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,FS.call(this,n,a)}function DS(e){var t,r="string"==typeof arguments[0]?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],i=[],o=1,l=16,c="S",d=null;"object"===(0,Kv.A)(e=e||{})&&(r=e.orientation,n=e.unit||n,a=e.format||a,s=e.compress||e.compressPdf||s,null!==(d=e.encryption||null)&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),i=e.filters||(!0===s?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var u=e.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=PS;var m="1.3",p=f.__private__.getPdfVersion=function(){return m};f.__private__.setPdfVersion=function(e){m=e};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return g};var x=f.__private__.getPageFormat=function(e){return g[e]};a=a||"a4";var b="compat",v="advanced",y=b;function w(){this.saveGraphicsState(),J(new Le(he,0,0,-he,0,hr()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),c="n",y=v}function N(){this.restoreGraphicsState(),c="S",y=b}var j=f.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};f.advancedAPI=function(e){var t=y===b;return t&&w.call(this),"function"!=typeof e||(e(this),t&&N.call(this)),this},f.compatAPI=function(e){var t=y===v;return t&&N.call(this),"function"!=typeof e||(e(this),t&&w.call(this)),this},f.isAdvancedAPI=function(){return y===v};var k,S=function(e){if(y!==v)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},A=f.roundToPrecision=f.__private__.roundToPrecision=function(e,r){var n=t||r;if(isNaN(e)||isNaN(n))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(n).replace(/0+$/,"")};k=f.hpf=f.__private__.hpf="number"==typeof l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,l)}:"smart"===l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,16)};var C=f.f2=f.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return A(e,2)},_=f.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return A(e,3)},T=f.scale=f.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return y===b?e*he:y===v?e:void 0},E=function(e){return T(function(e){return y===b?hr()-e:y===v?e:void 0}(e))};f.__private__.setPrecision=f.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var L,P="00000000000000000000000000000000",O=f.__private__.getFileId=function(){return P},F=f.__private__.setFileId=function(e){return P=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():P.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==d&&(bt=new ES(d.userPermissions,d.userPassword,d.ownerPassword,P)),P};f.setFileId=function(e){return F(e),this},f.getFileId=function(){return O()};var I=f.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),r=t<0?"+":"-",n=Math.floor(Math.abs(t/60)),a=Math.abs(t%60),s=[r,U(n),"'",U(a),"'"].join("");return["D:",e.getFullYear(),U(e.getMonth()+1),U(e.getDate()),U(e.getHours()),U(e.getMinutes()),U(e.getSeconds()),s].join("")},R=f.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),r=parseInt(e.substr(6,2),10)-1,n=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),i=parseInt(e.substr(14,2),10);return new Date(t,r,n,a,s,i,0)},D=f.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=I(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return L=t},M=f.__private__.getCreationDate=function(e){var t=L;return"jsDate"===e&&(t=R(L)),t};f.setCreationDate=function(e){return D(e),this},f.getCreationDate=function(e){return M(e)};var B,U=f.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},z=f.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},q=0,H=[],W=[],V=0,G=[],K=[],Y=!1,X=W;f.__private__.setCustomOutputDestination=function(e){Y=!0,X=e};var $=function(e){Y||(X=e)};f.__private__.resetCustomOutputDestination=function(){Y=!1,X=W};var J=f.__private__.out=function(e){return e=e.toString(),V+=e.length+1,X.push(e),X},Q=f.__private__.write=function(e){return J(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},Z=f.__private__.getArrayBuffer=function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);t--;)n[t]=e.charCodeAt(t);return r},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(e){return te=y===v?e/he:e,this};var re,ne=f.__private__.getFontSize=f.getFontSize=function(){return y===b?te:te*he},ae=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(e){return ae=e,this},f.__private__.getR2L=f.getR2L=function(){return ae};var se,ie=f.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))re=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');re=e}else re=parseInt(e,10)};f.__private__.getZoomMode=function(){return re};var oe,le=f.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');se=e};f.__private__.getPageMode=function(){return se};var ce=f.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');oe=e};f.__private__.getLayoutMode=function(){return oe},f.__private__.setDisplayMode=f.setDisplayMode=function(e,t,r){return ie(e),ce(t),le(r),this};var de={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(e){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return de[e]},f.__private__.getDocumentProperties=function(){return de},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(e){for(var t in de)de.hasOwnProperty(t)&&e[t]&&(de[t]=e[t]);return this},f.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return de[e]=t};var ue,he,fe,me,pe,ge={},xe={},be=[],ve={},ye={},we={},Ne={},je=null,ke=0,Se=[],Ae=new PS(f),Ce=e.hotfixes||[],_e={},Te={},Ee=[],Le=function e(t,r,n,a,s,i){if(!(this instanceof e))return new e(t,r,n,a,s,i);isNaN(t)&&(t=1),isNaN(r)&&(r=0),isNaN(n)&&(n=0),isNaN(a)&&(a=1),isNaN(s)&&(s=0),isNaN(i)&&(i=0),this._matrix=[t,r,n,a,s,i]};Object.defineProperty(Le.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Le.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Le.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Le.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Le.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Le.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Le.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Le.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Le.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Le.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Le.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Le.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Le.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Le.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Le.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Le.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Le.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(e)},Le.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,r=e.sx*this.shy+e.shy*this.sy,n=e.shx*this.sx+e.sy*this.shx,a=e.shx*this.shy+e.sy*this.sy,s=e.tx*this.sx+e.ty*this.shx+this.tx,i=e.tx*this.shy+e.ty*this.sy+this.ty;return new Le(t,r,n,a,s,i)},Le.prototype.decompose=function(){var e=this.sx,t=this.shy,r=this.shx,n=this.sy,a=this.tx,s=this.ty,i=Math.sqrt(e*e+t*t),o=(e/=i)*r+(t/=i)*n;r-=e*o,n-=t*o;var l=Math.sqrt(r*r+n*n);return o/=l,e*(n/=l)<t*(r/=l)&&(e=-e,t=-t,o=-o,i=-i),{scale:new Le(i,0,0,l,0,0),translate:new Le(1,0,0,1,a,s),rotate:new Le(e,t,-t,e,0,0),skew:new Le(1,0,o,1,0,0)}},Le.prototype.toString=function(e){return this.join(" ")},Le.prototype.inversed=function(){var e=this.sx,t=this.shy,r=this.shx,n=this.sy,a=this.tx,s=this.ty,i=1/(e*n-t*r),o=n*i,l=-t*i,c=-r*i,d=e*i;return new Le(o,l,c,d,-o*a-c*s,-l*a-d*s)},Le.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,r=e.x*this.shy+e.y*this.sy+this.ty;return new tr(t,r)},Le.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),r=this.applyToPoint(new tr(e.x+e.w,e.y+e.h));return new rr(t.x,t.y,r.x-t.x,r.y-t.y)},Le.prototype.clone=function(){var e=this.sx,t=this.shy,r=this.shx,n=this.sy,a=this.tx,s=this.ty;return new Le(e,t,r,n,a,s)},f.Matrix=Le;var Pe=f.matrixMult=function(e,t){return t.multiply(e)},Oe=new Le(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Oe;var Fe=function(e,t){if(!ye[e]){var r=(t instanceof IS?"Sh":"P")+(Object.keys(ve).length+1).toString(10);t.id=r,ye[e]=r,ve[r]=t,Ae.publish("addPattern",t)}};f.ShadingPattern=IS,f.TilingPattern=RS,f.addShadingPattern=function(e,t){return S("addShadingPattern()"),Fe(e,t),this},f.beginTilingPattern=function(e){S("beginTilingPattern()"),ar(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},f.endTilingPattern=function(e,t){S("endTilingPattern()"),t.stream=K[B].join("\n"),Fe(e,t),Ae.publish("endTilingPattern",t),Ee.pop().restore()};var Ie,Re=f.__private__.newObject=function(){var e=De();return Me(e,!0),e},De=f.__private__.newObjectDeferred=function(){return q++,H[q]=function(){return V},q},Me=function(e,t){return t="boolean"==typeof t&&t,H[e]=V,t&&J(e+" 0 obj"),e},Be=f.__private__.newAdditionalObject=function(){var e={objId:De(),content:""};return G.push(e),e},Ue=De(),ze=De(),qe=f.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var r=parseFloat(t[0]);t=[r,r,r,"r"]}for(var n="#",a=0;a<3;a++)n+=("0"+Math.floor(255*parseFloat(t[a])).toString(16)).slice(-2);return n},He=f.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var r=e.ch1,n=e.ch2,a=e.ch3,s=e.ch4,i="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof r&&"#"!==r.charAt(0)){var o=new uS(r);if(o.ok)r=o.toHex();else if(!/^\d*\.?\d*$/.test(r))throw new Error('Invalid color "'+r+'" passed to jsPDF.encodeColorString.')}if("string"==typeof r&&/^#[0-9A-Fa-f]{3}$/.test(r)&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),"string"==typeof r&&/^#[0-9A-Fa-f]{6}$/.test(r)){var l=parseInt(r.substr(1),16);r=l>>16&255,n=l>>8&255,a=255&l}if(void 0===n||void 0===s&&r===n&&n===a)t="string"==typeof r?r+" "+i[0]:2===e.precision?C(r/255)+" "+i[0]:_(r/255)+" "+i[0];else if(void 0===s||"object"===(0,Kv.A)(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",i[1]].join(" ");t="string"==typeof r?[r,n,a,i[1]].join(" "):2===e.precision?[C(r/255),C(n/255),C(a/255),i[1]].join(" "):[_(r/255),_(n/255),_(a/255),i[1]].join(" ")}else t="string"==typeof r?[r,n,a,s,i[2]].join(" "):2===e.precision?[C(r),C(n),C(a),C(s),i[2]].join(" "):[_(r),_(n),_(a),_(s),i[2]].join(" ");return t},We=f.__private__.getFilters=function(){return i},Ve=f.__private__.putStream=function(e){var t=(e=e||{}).data||"",r=e.filters||We(),n=e.alreadyAppliedFilters||[],a=e.addLength1||!1,s=t.length,i=e.objectId,o=function(e){return e};if(null!==d&&void 0===i)throw new Error("ObjectId must be passed to putStream for file encryption");null!==d&&(o=bt.encryptor(i,0));var l={};!0===r&&(r=["FlateEncode"]);var c=e.additionalKeyValues||[],u=(l=void 0!==DS.API.processDataByFilters?DS.API.processDataByFilters(t,r):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(n)?n.join(" "):n.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===a&&c.push({key:"Length1",value:s})),0!=u.length)if(u.split("/").length-1==1)c.push({key:"Filter",value:u});else{c.push({key:"Filter",value:"["+u+"]"});for(var h=0;h<c.length;h+=1)if("DecodeParms"===c[h].key){for(var f=[],m=0;m<l.reverseChain.split("/").length-1;m+=1)f.push("null");f.push(c[h].value),c[h].value="["+f.join(" ")+"]"}}J("<<");for(var p=0;p<c.length;p++)J("/"+c[p].key+" "+c[p].value);J(">>"),0!==l.data.length&&(J("stream"),J(o(l.data)),J("endstream"))},Ge=f.__private__.putPage=function(e){var t=e.number,r=e.data,n=e.objId,a=e.contentsObjId;Me(n,!0),J("<</Type /Page"),J("/Parent "+e.rootDictionaryObjId+" 0 R"),J("/Resources "+e.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(k(e.mediaBox.bottomLeftX))+" "+parseFloat(k(e.mediaBox.bottomLeftY))+" "+k(e.mediaBox.topRightX)+" "+k(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&J("/CropBox ["+k(e.cropBox.bottomLeftX)+" "+k(e.cropBox.bottomLeftY)+" "+k(e.cropBox.topRightX)+" "+k(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&J("/BleedBox ["+k(e.bleedBox.bottomLeftX)+" "+k(e.bleedBox.bottomLeftY)+" "+k(e.bleedBox.topRightX)+" "+k(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&J("/TrimBox ["+k(e.trimBox.bottomLeftX)+" "+k(e.trimBox.bottomLeftY)+" "+k(e.trimBox.topRightX)+" "+k(e.trimBox.topRightY)+"]"),null!==e.artBox&&J("/ArtBox ["+k(e.artBox.bottomLeftX)+" "+k(e.artBox.bottomLeftY)+" "+k(e.artBox.topRightX)+" "+k(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&J("/UserUnit "+e.userUnit),Ae.publish("putPage",{objId:n,pageContext:Se[t],pageNumber:t,page:r}),J("/Contents "+a+" 0 R"),J(">>"),J("endobj");var s=r.join("\n");return y===v&&(s+="\nQ"),Me(a,!0),Ve({data:s,filters:We(),objectId:a}),J("endobj"),n},Ke=f.__private__.putPages=function(){var e,t,r=[];for(e=1;e<=ke;e++)Se[e].objId=De(),Se[e].contentsObjId=De();for(e=1;e<=ke;e++)r.push(Ge({number:e,data:K[e],objId:Se[e].objId,contentsObjId:Se[e].contentsObjId,mediaBox:Se[e].mediaBox,cropBox:Se[e].cropBox,bleedBox:Se[e].bleedBox,trimBox:Se[e].trimBox,artBox:Se[e].artBox,userUnit:Se[e].userUnit,rootDictionaryObjId:Ue,resourceDictionaryObjId:ze}));Me(Ue,!0),J("<</Type /Pages");var n="/Kids [";for(t=0;t<ke;t++)n+=r[t]+" 0 R ";J(n+"]"),J("/Count "+ke),J(">>"),J("endobj"),Ae.publish("postPutPages")},Ye=function(e){Ae.publish("putFont",{font:e,out:J,newObject:Re,putStream:Ve}),!0!==e.isAlreadyPutted&&(e.objectNumber=Re(),J("<<"),J("/Type /Font"),J("/BaseFont /"+LS(e.postScriptName)),J("/Subtype /Type1"),"string"==typeof e.encoding&&J("/Encoding /"+e.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},Xe=function(e){e.objectNumber=Re();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[k(e.x),k(e.y),k(e.x+e.width),k(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var r=e.pages[1].join("\n");Ve({data:r,additionalKeyValues:t,objectId:e.objectNumber}),J("endobj")},$e=function(e,t){t||(t=21);var r=Re(),n=function(e,t){var r,n=[],a=1/(t-1);for(r=0;r<1;r+=a)n.push(r);if(n.push(1),0!=e[0].offset){var s={offset:0,color:e[0].color};e.unshift(s)}if(1!=e[e.length-1].offset){var i={offset:1,color:e[e.length-1].color};e.push(i)}for(var o="",l=0,c=0;c<n.length;c++){for(r=n[c];r>e[l+1].offset;)l++;var d=e[l].offset,u=(r-d)/(e[l+1].offset-d),h=e[l].color,f=e[l+1].color;o+=z(Math.round((1-u)*h[0]+u*f[0]).toString(16))+z(Math.round((1-u)*h[1]+u*f[1]).toString(16))+z(Math.round((1-u)*h[2]+u*f[2]).toString(16))}return o.trim()}(e.colors,t),a=[];a.push({key:"FunctionType",value:"0"}),a.push({key:"Domain",value:"[0.0 1.0]"}),a.push({key:"Size",value:"["+t+"]"}),a.push({key:"BitsPerSample",value:"8"}),a.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),a.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve({data:n,additionalKeyValues:a,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:r}),J("endobj"),e.objectNumber=Re(),J("<< /ShadingType "+e.type),J("/ColorSpace /DeviceRGB");var s="/Coords ["+k(parseFloat(e.coords[0]))+" "+k(parseFloat(e.coords[1]))+" ";2===e.type?s+=k(parseFloat(e.coords[2]))+" "+k(parseFloat(e.coords[3])):s+=k(parseFloat(e.coords[2]))+" "+k(parseFloat(e.coords[3]))+" "+k(parseFloat(e.coords[4]))+" "+k(parseFloat(e.coords[5])),J(s+="]"),e.matrix&&J("/Matrix ["+e.matrix.toString()+"]"),J("/Function "+r+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Je=function(e,t){var r=De(),n=Re();t.push({resourcesOid:r,objectOid:n}),e.objectNumber=n;var a=[];a.push({key:"Type",value:"/Pattern"}),a.push({key:"PatternType",value:"1"}),a.push({key:"PaintType",value:"1"}),a.push({key:"TilingType",value:"1"}),a.push({key:"BBox",value:"["+e.boundingBox.map(k).join(" ")+"]"}),a.push({key:"XStep",value:k(e.xStep)}),a.push({key:"YStep",value:k(e.yStep)}),a.push({key:"Resources",value:r+" 0 R"}),e.matrix&&a.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Ve({data:e.stream,additionalKeyValues:a,objectId:e.objectNumber}),J("endobj")},Qe=function(e){for(var t in e.objectNumber=Re(),J("<<"),e)switch(t){case"opacity":J("/ca "+C(e[t]));break;case"stroke-opacity":J("/CA "+C(e[t]))}J(">>"),J("endobj")},Ze=function(e){Me(e.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in J("/Font <<"),ge)ge.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&J("/"+e+" "+ge[e].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(ve).length>0){for(var e in J("/Shading <<"),ve)ve.hasOwnProperty(e)&&ve[e]instanceof IS&&ve[e].objectNumber>=0&&J("/"+e+" "+ve[e].objectNumber+" 0 R");Ae.publish("putShadingPatternDict"),J(">>")}}(),function(e){if(Object.keys(ve).length>0){for(var t in J("/Pattern <<"),ve)ve.hasOwnProperty(t)&&ve[t]instanceof f.TilingPattern&&ve[t].objectNumber>=0&&ve[t].objectNumber<e&&J("/"+t+" "+ve[t].objectNumber+" 0 R");Ae.publish("putTilingPatternDict"),J(">>")}}(e.objectOid),function(){if(Object.keys(we).length>0){var e;for(e in J("/ExtGState <<"),we)we.hasOwnProperty(e)&&we[e].objectNumber>=0&&J("/"+e+" "+we[e].objectNumber+" 0 R");Ae.publish("putGStateDict"),J(">>")}}(),function(){for(var e in J("/XObject <<"),_e)_e.hasOwnProperty(e)&&_e[e].objectNumber>=0&&J("/"+e+" "+_e[e].objectNumber+" 0 R");Ae.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},et=function(e){xe[e.fontName]=xe[e.fontName]||{},xe[e.fontName][e.fontStyle]=e.id},tt=function(e,t,r,n,a){var s={id:"F"+(Object.keys(ge).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:r,encoding:n,isStandardFont:a||!1,metadata:{}};return Ae.publish("addFont",{font:s,instance:this}),ge[s.id]=s,et(s),s.id},rt=f.__private__.pdfEscape=f.pdfEscape=function(e,t){return function(e,t){var r,n,a,s,i,o,l,c,d;if(a=(t=t||{}).sourceEncoding||"Unicode",i=t.outputEncoding,(t.autoencode||i)&&ge[ue].metadata&&ge[ue].metadata[a]&&ge[ue].metadata[a].encoding&&(s=ge[ue].metadata[a].encoding,!i&&ge[ue].encoding&&(i=ge[ue].encoding),!i&&s.codePages&&(i=s.codePages[0]),"string"==typeof i&&(i=s[i]),i)){for(l=!1,o=[],r=0,n=e.length;r<n;r++)(c=i[e.charCodeAt(r)])?o.push(String.fromCharCode(c)):o.push(e[r]),o[r].charCodeAt(0)>>8&&(l=!0);e=o.join("")}for(r=e.length;void 0===l&&0!==r;)e.charCodeAt(r-1)>>8&&(l=!0),r--;if(!l)return e;for(o=t.noBOM?[]:[254,255],r=0,n=e.length;r<n;r++){if((d=(c=e.charCodeAt(r))>>8)>>8)throw new Error("Character at position "+r+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(d),o.push(c-(d<<8))}return String.fromCharCode.apply(void 0,o)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nt=f.__private__.beginPage=function(e){K[++ke]=[],Se[ke]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},it(ke),$(K[B])},at=function(e,t){var n,s,i;switch(r=t||r,"string"==typeof e&&(n=x(e.toLowerCase()),Array.isArray(n)&&(s=n[0],i=n[1])),Array.isArray(e)&&(s=e[0]*he,i=e[1]*he),isNaN(s)&&(s=a[0],i=a[1]),(s>14400||i>14400)&&(iS.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),i=Math.min(14400,i)),a=[s,i],r.substr(0,1)){case"l":i>s&&(a=[i,s]);break;case"p":s>i&&(a=[i,s])}nt(a),Mt(Rt),J(Gt),0!==Qt&&J(Qt+" J"),0!==Zt&&J(Zt+" j"),Ae.publish("addPage",{pageNumber:ke})},st=function(e){e>0&&e<=ke&&(K.splice(e,1),Se.splice(e,1),ke--,B>ke&&(B=ke),this.setPage(B))},it=function(e){e>0&&e<=ke&&(B=e)},ot=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return K.length-1},lt=function(e,t,r){var n,a=void 0;return r=r||{},e=void 0!==e?e:ge[ue].fontName,t=void 0!==t?t:ge[ue].fontStyle,n=e.toLowerCase(),void 0!==xe[n]&&void 0!==xe[n][t]?a=xe[n][t]:void 0!==xe[e]&&void 0!==xe[e][t]?a=xe[e][t]:!1===r.disableWarning&&iS.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),a||r.noFallback||null==(a=xe.times[t])&&(a=xe.times.normal),a},ct=f.__private__.putInfo=function(){var e=Re(),t=function(e){return e};for(var r in null!==d&&(t=bt.encryptor(e,0)),J("<<"),J("/Producer ("+rt(t("jsPDF "+DS.version))+")"),de)de.hasOwnProperty(r)&&de[r]&&J("/"+r.substr(0,1).toUpperCase()+r.substr(1)+" ("+rt(t(de[r]))+")");J("/CreationDate ("+rt(t(L))+")"),J(">>"),J("endobj")},dt=f.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||Ue;switch(Re(),J("<<"),J("/Type /Catalog"),J("/Pages "+t+" 0 R"),re||(re="fullwidth"),re){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+re;"%"===r.substr(r.length-1)&&(re=parseInt(re)/100),"number"==typeof re&&J("/OpenAction [3 0 R /XYZ null null "+C(re)+"]")}switch(oe||(oe="continuous"),oe){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}se&&J("/PageMode /"+se),Ae.publish("putCatalog"),J(">>"),J("endobj")},ut=f.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(q+1)),J("/Root "+q+" 0 R"),J("/Info "+(q-1)+" 0 R"),null!==d&&J("/Encrypt "+bt.oid+" 0 R"),J("/ID [ <"+P+"> <"+P+"> ]"),J(">>")},ht=f.__private__.putHeader=function(){J("%PDF-"+m),J("%\xba\xdf\xac\xe0")},ft=f.__private__.putXRef=function(){var e="0000000000";J("xref"),J("0 "+(q+1)),J("0000000000 65535 f ");for(var t=1;t<=q;t++)"function"==typeof H[t]?J((e+H[t]()).slice(-10)+" 00000 n "):void 0!==H[t]?J((e+H[t]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},mt=f.__private__.buildDocument=function(){var e;q=0,V=0,W=[],H=[],G=[],Ue=De(),ze=De(),$(W),Ae.publish("buildDocument"),ht(),Ke(),function(){Ae.publish("putAdditionalObjects");for(var e=0;e<G.length;e++){var t=G[e];Me(t.objId,!0),J(t.content),J("endobj")}Ae.publish("postPutAdditionalObjects")}(),e=[],function(){for(var e in ge)ge.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&Ye(ge[e])}(),function(){var e;for(e in we)we.hasOwnProperty(e)&&Qe(we[e])}(),function(){for(var e in _e)_e.hasOwnProperty(e)&&Xe(_e[e])}(),function(e){var t;for(t in ve)ve.hasOwnProperty(t)&&(ve[t]instanceof IS?$e(ve[t]):ve[t]instanceof RS&&Je(ve[t],e))}(e),Ae.publish("putResources"),e.forEach(Ze),Ze({resourcesOid:ze,objectOid:Number.MAX_SAFE_INTEGER}),Ae.publish("postPutResources"),null!==d&&(bt.oid=Re(),J("<<"),J("/Filter /Standard"),J("/V "+bt.v),J("/R "+bt.r),J("/U <"+bt.toHexString(bt.U)+">"),J("/O <"+bt.toHexString(bt.O)+">"),J("/P "+bt.P),J(">>"),J("endobj")),ct(),dt();var t=V;return ft(),ut(),J("startxref"),J(""+t),J("%%EOF"),$(K[B]),W.join("\n")},pt=f.__private__.getBlob=function(e){return new Blob([Z(e)],{type:"application/pdf"})},gt=f.output=f.__private__.output=(Ie=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return mt();case"save":f.save(t.filename);break;case"arraybuffer":return Z(mt());case"blob":return pt(mt());case"bloburi":case"bloburl":if(void 0!==aS.URL&&"function"==typeof aS.URL.createObjectURL)return aS.URL&&aS.URL.createObjectURL(pt(mt()))||void 0;iS.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var r="",n=mt();try{r=fS(n)}catch(d){r=fS(unescape(encodeURIComponent(n)))}return"data:application/pdf;filename="+t.filename+";base64,"+r;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(aS)){var a="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(a=t.pdfObjectUrl,s="");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+a+'"'+s+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",o=aS.open();return null!==o&&o.document.write(i),o}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(aS)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=aS.open();if(null!==c){c.document.write(l);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(aS))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',m=aS.open();if(null!==m&&(m.document.write(h),m.document.title=t.filename),m||"undefined"==typeof safari)return m;break;case"datauri":case"dataurl":return aS.document.location.href=this.output("datauristring",t);default:return null}},Ie.foo=function(){try{return Ie.apply(this,arguments)}catch(t){var e=t.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var r="Error in function "+e.split("\n")[0].split("<")[0]+": "+t.message;if(!aS.console)throw new Error(r);aS.console.error(r,t),aS.alert&&alert(r)}},Ie.foo.bar=Ie,Ie.foo),xt=function(e){return!0===Array.isArray(Ce)&&Ce.indexOf(e)>-1};switch(n){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=1==xt("px_scaling")?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if("number"!=typeof n)throw new Error("Invalid unit: "+n);he=n}var bt=null;D(),F();var vt=f.__private__.getPageInfo=f.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Se[e].objId,pageNumber:e,pageContext:Se[e]}},yt=f.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Se)if(Se[t].objId===e)break;return vt(t)},wt=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Se[B].objId,pageNumber:B,pageContext:Se[B]}};f.addPage=function(){return at.apply(this,arguments),this},f.setPage=function(){return it.apply(this,arguments),$.call(this,K[B]),this},f.insertPage=function(e){return this.addPage(),this.movePage(B,e),this},f.movePage=function(e,t){var r,n;if(e>t){r=K[e],n=Se[e];for(var a=e;a>t;a--)K[a]=K[a-1],Se[a]=Se[a-1];K[t]=r,Se[t]=n,this.setPage(t)}else if(e<t){r=K[e],n=Se[e];for(var s=e;s<t;s++)K[s]=K[s+1],Se[s]=Se[s+1];K[t]=r,Se[t]=n,this.setPage(t)}return this},f.deletePage=function(){return st.apply(this,arguments),this},f.__private__.text=f.text=function(e,t,r,n,a){var s,i,o,l,c,d,u,f,m,p=(n=n||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof r||Array.isArray(r))){var g=r;r=t,t=e,e=g}if(arguments[3]instanceof Le==0?(o=arguments[4],l=arguments[5],"object"===(0,Kv.A)(u=arguments[3])&&null!==u||("string"==typeof o&&(l=o,o=null),"string"==typeof u&&(l=u,u=null),"number"==typeof u&&(o=u,u=null),n={flags:u,angle:o,align:l})):(S("The transform parameter of text() with a Matrix value"),m=a),isNaN(t)||isNaN(r)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return p;var x,b="",w="number"==typeof n.lineHeightFactor?n.lineHeightFactor:It,N=p.internal.scaleFactor;function j(e){return e=e.split("\t").join(Array(n.TabLen||9).join(" ")),rt(e,u)}function A(e){for(var t,r=e.concat(),n=[],a=r.length;a--;)"string"==typeof(t=r.shift())?n.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?n.push(t[0]):n.push([t[0],t[1],t[2]]);return n}function C(e,t){var r;if("string"==typeof e)r=t(e)[0];else if(Array.isArray(e)){for(var n,a,s=e.concat(),i=[],o=s.length;o--;)"string"==typeof(n=s.shift())?i.push(t(n)[0]):Array.isArray(n)&&"string"==typeof n[0]&&(a=t(n[0],n[1],n[2]),i.push([a[0],a[1],a[2]]));r=i}return r}var _=!1,E=!0;if("string"==typeof e)_=!0;else if(Array.isArray(e)){var L=e.concat();i=[];for(var P,O=L.length;O--;)("string"!=typeof(P=L.shift())||Array.isArray(P)&&"string"!=typeof P[0])&&(E=!1);_=E}if(!1===_)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var F=te/p.internal.scaleFactor,I=F*(w-1);switch(n.baseline){case"bottom":r-=I;break;case"top":r+=F-I;break;case"hanging":r+=F-2*I;break;case"middle":r+=F/2-I}if((d=n.maxWidth||0)>0&&("string"==typeof e?e=p.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(p.splitTextToSize(t,d))},[]))),s={text:e,x:t,y:r,options:n,mutex:{pdfEscape:rt,activeFontKey:ue,fonts:ge,activeFontSize:te}},Ae.publish("preProcessText",s),e=s.text,o=(n=s.options).angle,m instanceof Le==0&&o&&"number"==typeof o){o*=Math.PI/180,0===n.rotationDirection&&(o=-o),y===v&&(o=-o);var R=Math.cos(o),D=Math.sin(o);m=new Le(R,D,-D,R,0,0)}else o&&o instanceof Le&&(m=o);y!==v||m||(m=Oe),void 0!==(c=n.charSpace||$t)&&(b+=k(T(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=n.horizontalScale)&&(b+=k(100*f)+" Tz\n"),n.lang;var M=-1,B=void 0!==n.renderingMode?n.renderingMode:n.stroke,U=p.internal.getCurrentPageInfo().pageContext;switch(B){case 0:case!1:case"fill":M=0;break;case 1:case!0:case"stroke":M=1;break;case 2:case"fillThenStroke":M=2;break;case 3:case"invisible":M=3;break;case 4:case"fillAndAddForClipping":M=4;break;case 5:case"strokeAndAddPathForClipping":M=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":M=6;break;case 7:case"addToPathForClipping":M=7}var z=void 0!==U.usedRenderingMode?U.usedRenderingMode:-1;-1!==M?b+=M+" Tr\n":-1!==z&&(b+="0 Tr\n"),-1!==M&&(U.usedRenderingMode=M),l=n.align||"left";var q,H=te*w,W=p.internal.pageSize.getWidth(),V=ge[ue];c=n.charSpace||$t,d=n.maxWidth||0,u=Object.assign({autoencode:!0,noBOM:!0},n.flags);var G=[],K=function(e){return p.getStringUnitWidth(e,{font:V,charSpace:c,fontSize:te,doKerning:!1})*te/N};if("[object Array]"===Object.prototype.toString.call(e)){var Y;i=A(e),"left"!==l&&(q=i.map(K));var X,$=0;if("right"===l){t-=q[0],e=[],O=i.length;for(var Q=0;Q<O;Q++)0===Q?(X=qt(t),Y=Ht(r)):(X=T($-q[Q]),Y=-H),e.push([i[Q],X,Y]),$=q[Q]}else if("center"===l){t-=q[0]/2,e=[],O=i.length;for(var Z=0;Z<O;Z++)0===Z?(X=qt(t),Y=Ht(r)):(X=T(($-q[Z])/2),Y=-H),e.push([i[Z],X,Y]),$=q[Z]}else if("left"===l){e=[],O=i.length;for(var ee=0;ee<O;ee++)e.push(i[ee])}else if("justify"===l&&"Identity-H"===V.encoding){e=[],O=i.length,d=0!==d?d:W;for(var re=0,ne=0;ne<O;ne++)if(Y=0===ne?Ht(r):-H,X=0===ne?qt(t):re,ne<O-1){var se=T((d-q[ne])/(i[ne].split(" ").length-1)),ie=i[ne].split(" ");e.push([ie[0]+" ",X,Y]),re=0;for(var oe=1;oe<ie.length;oe++){var le=(K(ie[oe-1]+" "+ie[oe])-K(ie[oe]))*N+se;oe==ie.length-1?e.push([ie[oe],le,0]):e.push([ie[oe]+" ",le,0]),re-=le}}else e.push([i[ne],X,Y]);e.push(["",re,0])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],O=i.length,d=0!==d?d:W,ne=0;ne<O;ne++){Y=0===ne?Ht(r):-H,X=0===ne?qt(t):0;var ce=i[ne].split(" ").length-1,de=ce>0?(d-q[ne])/ce:0;ne<O-1?G.push(k(T(de))):G.push(0),e.push([i[ne],X,Y])}}}!0===("boolean"==typeof n.R2L?n.R2L:ae)&&(e=C(e,function(e,t,r){return[e.split("").reverse().join(""),t,r]})),s={text:e,x:t,y:r,options:n,mutex:{pdfEscape:rt,activeFontKey:ue,fonts:ge,activeFontSize:te}},Ae.publish("postProcessText",s),e=s.text,x=s.mutex.isHex||!1;var he=ge[ue].encoding;"WinAnsiEncoding"!==he&&"StandardEncoding"!==he||(e=C(e,function(e,t,r){return[j(e),t,r]})),i=A(e),e=[];for(var fe,me,pe,xe=Array.isArray(i[0])?1:0,be="",ve=function(e,t,r){var a="";return r instanceof Le?(r="number"==typeof n.angle?Pe(r,new Le(1,0,0,1,e,t)):Pe(new Le(1,0,0,1,e,t),r),y===v&&(r=Pe(new Le(1,0,0,-1,0,0),r)),a=r.join(" ")+" Tm\n"):a=k(e)+" "+k(t)+" Td\n",a},ye=0;ye<i.length;ye++){switch(be="",xe){case 1:pe=(x?"<":"(")+i[ye][0]+(x?">":")"),fe=parseFloat(i[ye][1]),me=parseFloat(i[ye][2]);break;case 0:pe=(x?"<":"(")+i[ye]+(x?">":")"),fe=qt(t),me=Ht(r)}void 0!==G&&void 0!==G[ye]&&(be=G[ye]+" Tw\n"),0===ye?e.push(be+ve(fe,me,m)+pe):0===xe?e.push(be+pe):1===xe&&e.push(be+ve(fe,me,m)+pe)}e=0===xe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var we="BT\n/";return we+=ue+" "+te+" Tf\n",we+=k(te*w)+" TL\n",we+=Yt+"\n",we+=b,we+=e,J(we+="ET"),h[ue]=!0,p};var Nt=f.__private__.clip=f.clip=function(e){return J("evenodd"===e?"W*":"W"),this};f.clipEvenOdd=function(){return Nt("evenodd")},f.__private__.discardPath=f.discardPath=function(){return J("n"),this};var jt=f.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(e){return jt(e)&&(c=e),this};var kt=f.__private__.getStyle=f.getStyle=function(e){var t=c;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},St=f.close=function(){return J("h"),this};f.stroke=function(){return J("S"),this},f.fill=function(e){return At("f",e),this},f.fillEvenOdd=function(e){return At("f*",e),this},f.fillStroke=function(e){return At("B",e),this},f.fillStrokeEvenOdd=function(e){return At("B*",e),this};var At=function(e,t){"object"===(0,Kv.A)(t)?Tt(t,e):J(e)},Ct=function(e){null===e||y===v&&void 0===e||(e=kt(e),J(e))};function _t(e,t,r,n,a){var s=new RS(t||this.boundingBox,r||this.xStep,n||this.yStep,this.gState,a||this.matrix);s.stream=this.stream;var i=e+"$$"+this.cloneIndex+++"$$";return Fe(i,s),s}var Tt=function(e,t){var r=ye[e.key],n=ve[r];if(n instanceof IS)J("q"),J(Et(t)),n.gState&&f.setGState(n.gState),J(e.matrix.toString()+" cm"),J("/"+r+" sh"),J("Q");else if(n instanceof RS){var a=new Le(1,0,0,-1,0,hr());e.matrix&&(a=a.multiply(e.matrix||Oe),r=_t.call(n,e.key,e.boundingBox,e.xStep,e.yStep,a).id),J("q"),J("/Pattern cs"),J("/"+r+" scn"),n.gState&&f.setGState(n.gState),J(t),J("Q")}},Et=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Lt=f.moveTo=function(e,t){return J(k(T(e))+" "+k(E(t))+" m"),this},Pt=f.lineTo=function(e,t){return J(k(T(e))+" "+k(E(t))+" l"),this},Ot=f.curveTo=function(e,t,r,n,a,s){return J([k(T(e)),k(E(t)),k(T(r)),k(E(n)),k(T(a)),k(E(s)),"c"].join(" ")),this};f.__private__.line=f.line=function(e,t,r,n,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||!jt(a))throw new Error("Invalid arguments passed to jsPDF.line");return y===b?this.lines([[r-e,n-t]],e,t,[1,1],a||"S"):this.lines([[r-e,n-t]],e,t,[1,1]).stroke()},f.__private__.lines=f.lines=function(e,t,r,n,a,s){var i,o,l,c,d,u,h,f,m,p,g,x;if("number"==typeof e&&(x=r,r=t,t=e,e=x),n=n||[1,1],s=s||!1,isNaN(t)||isNaN(r)||!Array.isArray(e)||!Array.isArray(n)||!jt(a)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(Lt(t,r),i=n[0],o=n[1],c=e.length,p=t,g=r,l=0;l<c;l++)2===(d=e[l]).length?(p=d[0]*i+p,g=d[1]*o+g,Pt(p,g)):(u=d[0]*i+p,h=d[1]*o+g,f=d[2]*i+p,m=d[3]*o+g,p=d[4]*i+p,g=d[5]*o+g,Ot(u,h,f,m,p,g));return s&&St(),Ct(a),this},f.path=function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.c;switch(r.op){case"m":Lt(n[0],n[1]);break;case"l":Pt(n[0],n[1]);break;case"c":Ot.apply(this,n);break;case"h":St()}}return this},f.__private__.rect=f.rect=function(e,t,r,n,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||!jt(a))throw new Error("Invalid arguments passed to jsPDF.rect");return y===b&&(n=-n),J([k(T(e)),k(E(t)),k(T(r)),k(T(n)),"re"].join(" ")),Ct(a),this},f.__private__.triangle=f.triangle=function(e,t,r,n,a,s,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(s)||!jt(i))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-e,n-t],[a-r,s-n],[e-a,t-s]],e,t,[1,1],i,!0),this},f.__private__.roundedRect=f.roundedRect=function(e,t,r,n,a,s,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(s)||!jt(i))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return a=Math.min(a,.5*r),s=Math.min(s,.5*n),this.lines([[r-2*a,0],[a*o,0,a,s-s*o,a,s],[0,n-2*s],[0,s*o,-a*o,s,-a,s],[2*a-r,0],[-a*o,0,-a,-s*o,-a,-s],[0,2*s-n],[0,-s*o,a*o,-s,a,-s]],e+a,t,[1,1],i,!0),this},f.__private__.ellipse=f.ellipse=function(e,t,r,n,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||!jt(a))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*r,i=4/3*(Math.SQRT2-1)*n;return Lt(e+r,t),Ot(e+r,t-i,e+s,t-n,e,t-n),Ot(e-s,t-n,e-r,t-i,e-r,t),Ot(e-r,t+i,e-s,t+n,e,t+n),Ot(e+s,t+n,e+r,t+i,e+r,t),Ct(a),this},f.__private__.circle=f.circle=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||!jt(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,r,r,n)},f.setFont=function(e,t,r){return r&&(t=j(t,r)),ue=lt(e,t,{disableWarning:!1}),this};var Ft=f.__private__.getFont=f.getFont=function(){return ge[lt.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var e,t,r={};for(e in xe)if(xe.hasOwnProperty(e))for(t in r[e]=[],xe[e])xe[e].hasOwnProperty(t)&&r[e].push(t);return r},f.addFont=function(e,t,r,n,a){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?a=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(r=j(r,n)),tt.call(this,e,t,r,a=a||"Identity-H")};var It,Rt=e.lineWidth||.200025,Dt=f.__private__.getLineWidth=f.getLineWidth=function(){return Rt},Mt=f.__private__.setLineWidth=f.setLineWidth=function(e){return Rt=e,J(k(T(e))+" w"),this};f.__private__.setLineDash=DS.API.setLineDash=DS.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return k(T(e))}).join(" "),t=k(T(t)),J("["+e+"] "+t+" d"),this};var Bt=f.__private__.getLineHeight=f.getLineHeight=function(){return te*It};f.__private__.getLineHeight=f.getLineHeight=function(){return te*It};var Ut=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(It=e),this},zt=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return It};Ut(e.lineHeight);var qt=f.__private__.getHorizontalCoordinate=function(e){return T(e)},Ht=f.__private__.getVerticalCoordinate=function(e){return y===v?e:Se[B].mediaBox.topRightY-Se[B].mediaBox.bottomLeftY-T(e)},Wt=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(e){return k(qt(e))},Vt=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(e){return k(Ht(e))},Gt=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return qe(Gt)},f.__private__.setStrokeColor=f.setDrawColor=function(e,t,r,n){return Gt=He({ch1:e,ch2:t,ch3:r,ch4:n,pdfColorType:"draw",precision:2}),J(Gt),this};var Kt=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return qe(Kt)},f.__private__.setFillColor=f.setFillColor=function(e,t,r,n){return Kt=He({ch1:e,ch2:t,ch3:r,ch4:n,pdfColorType:"fill",precision:2}),J(Kt),this};var Yt=e.textColor||"0 g",Xt=f.__private__.getTextColor=f.getTextColor=function(){return qe(Yt)};f.__private__.setTextColor=f.setTextColor=function(e,t,r,n){return Yt=He({ch1:e,ch2:t,ch3:r,ch4:n,pdfColorType:"text",precision:3}),this};var $t=e.charSpace,Jt=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat($t||0)};f.__private__.setCharSpace=f.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return $t=e,this};var Qt=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qt=t,J(t+" J"),this};var Zt=0;f.__private__.setLineJoin=f.setLineJoin=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zt=t,J(t+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(k(T(e))+" M"),this},f.GState=OS,f.setGState=function(e){(e="string"==typeof e?we[Ne[e]]:er(null,e)).equals(je)||(J("/"+e.id+" gs"),je=e)};var er=function(e,t){if(!e||!Ne[e]){var r=!1;for(var n in we)if(we.hasOwnProperty(n)&&we[n].equals(t)){r=!0;break}if(r)t=we[n];else{var a="GS"+(Object.keys(we).length+1).toString(10);we[a]=t,t.id=a}return e&&(Ne[e]=t.id),Ae.publish("addGState",t),t}};f.addGState=function(e,t){return er(e,t),this},f.saveGraphicsState=function(){return J("q"),be.push({key:ue,size:te,color:Yt}),this},f.restoreGraphicsState=function(){J("Q");var e=be.pop();return ue=e.key,te=e.size,Yt=e.color,je=null,this},f.setCurrentTransformationMatrix=function(e){return J(e.toString()+" cm"),this},f.comment=function(e){return J("#"+e),this};var tr=function(e,t){var r=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var n=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(e){a=e.toString()}}),this},rr=function(e,t,r,n){tr.call(this,e,t),this.type="rect";var a=r||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var s=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}}),this},nr=function(){this.page=ke,this.currentPage=B,this.pages=K.slice(0),this.pagesContext=Se.slice(0),this.x=fe,this.y=me,this.matrix=pe,this.width=ir(B),this.height=lr(B),this.outputDestination=X,this.id="",this.objectNumber=-1};nr.prototype.restore=function(){ke=this.page,B=this.currentPage,Se=this.pagesContext,K=this.pages,fe=this.x,me=this.y,pe=this.matrix,or(B,this.width),cr(B,this.height),X=this.outputDestination};var ar=function(e,t,r,n,a){Ee.push(new nr),ke=B=0,K=[],fe=e,me=t,pe=a,nt([r,n])};for(var sr in f.beginFormObject=function(e,t,r,n,a){return ar(e,t,r,n,a),this},f.endFormObject=function(e){return function(e){if(Te[e])Ee.pop().restore();else{var t=new nr,r="Xo"+(Object.keys(_e).length+1).toString(10);t.id=r,Te[e]=r,_e[r]=t,Ae.publish("addFormObject",t),Ee.pop().restore()}}(e),this},f.doFormObject=function(e,t){var r=_e[Te[e]];return J("q"),J(t.toString()+" cm"),J("/"+r.id+" Do"),J("Q"),this},f.getFormObject=function(e){var t=_e[Te[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},f.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(dS(pt(mt()),e),"function"==typeof dS.unload&&aS.setTimeout&&setTimeout(dS.unload,911),this):new Promise(function(t,r){try{var a=dS(pt(mt()),e);"function"==typeof dS.unload&&aS.setTimeout&&setTimeout(dS.unload,911),t(a)}catch(n){r(n.message)}})},DS.API)DS.API.hasOwnProperty(sr)&&("events"===sr&&DS.API.events.length?function(e,t){var r,n,a;for(a=t.length-1;-1!==a;a--)r=t[a][0],n=t[a][1],e.subscribe.apply(e,[r].concat("function"==typeof n?[n]:n))}(Ae,DS.API.events):f[sr]=DS.API[sr]);function ir(e){return Se[e].mediaBox.topRightX-Se[e].mediaBox.bottomLeftX}function or(e,t){Se[e].mediaBox.topRightX=t+Se[e].mediaBox.bottomLeftX}function lr(e){return Se[e].mediaBox.topRightY-Se[e].mediaBox.bottomLeftY}function cr(e,t){Se[e].mediaBox.topRightY=t+Se[e].mediaBox.bottomLeftY}var dr=f.getPageWidth=function(e){return ir(e=e||B)/he},ur=f.setPageWidth=function(e,t){or(e,t*he)},hr=f.getPageHeight=function(e){return lr(e=e||B)/he},fr=f.setPageHeight=function(e,t){cr(e,t*he)};return f.internal={pdfEscape:rt,getStyle:kt,getFont:Ft,getFontSize:ne,getCharSpace:Jt,getTextColor:Xt,getLineHeight:Bt,getLineHeightFactor:zt,getLineWidth:Dt,write:Q,getHorizontalCoordinate:qt,getVerticalCoordinate:Ht,getCoordinateString:Wt,getVerticalCoordinateString:Vt,collections:{},newObject:Re,newAdditionalObject:Be,newObjectDeferred:De,newObjectDeferredBegin:Me,getFilters:We,putStream:Ve,events:Ae,scaleFactor:he,pageSize:{getWidth:function(){return dr(B)},setWidth:function(e){ur(B,e)},getHeight:function(){return hr(B)},setHeight:function(e){fr(B,e)}},encryptionOptions:d,encryption:bt,getEncryptor:function(e){return null!==d?bt.encryptor(e,0):function(e){return e}},output:gt,getNumberOfPages:ot,get pages(){return K},out:J,f2:C,f3:_,getPageInfo:vt,getPageInfoByObjId:yt,getCurrentPageInfo:wt,getPDFVersion:p,Point:tr,Rectangle:rr,Matrix:Le,hasHotfix:xt},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return dr(B)},set:function(e){ur(B,e)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return hr(B)},set:function(e){fr(B,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,r=ee.length;t<r;t++){var n=tt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===u&&(h[n]=!0);var a=e[t][0].split("-");et({id:n,fontName:a[0],fontStyle:a[1]||""})}Ae.publish("addFonts",{fonts:ge,dictionary:xe})}.call(f,ee),ue="F1",at(a,r),Ae.publish("initialized"),f}ES.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},ES.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ES.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},ES.prototype.processOwnerPassword=function(e,t){return _S(SS(t).substr(0,5),e)},ES.prototype.encryptor=function(e,t){var r=SS(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return _S(r,e)}},OS.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||(0,Kv.A)(e)!==(0,Kv.A)(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return 0===n},DS.API={events:[]},DS.version="3.0.4";var MS=DS.API,BS=1,US=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zS=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},qS=function(e){return e.toFixed(2)},HS=function(e){return e.toFixed(5)};MS.__acroform__={};var WS=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},VS=function(e){return e*BS},GS=function(e){var t=new lA,r=NA.internal.getHeight(e)||0,n=NA.internal.getWidth(e)||0;return t.BBox=[0,0,Number(qS(n)),Number(qS(r))],t},KS=MS.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},YS=MS.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},XS=MS.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},$S=MS.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return XS(e,t-1)},JS=MS.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return KS(e,t-1)},QS=MS.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return YS(e,t-1)},ZS=MS.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],s=e[1],i=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(s+o)||0,l.upperRight_X=r(a+i)||0,l.upperRight_Y=n(s)||0,[Number(qS(l.lowerLeft_X)),Number(qS(l.lowerLeft_Y)),Number(qS(l.upperRight_X)),Number(qS(l.upperRight_Y))]},eA=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=tA(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+qS(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=GS(e);return s.scope=e.scope,s.stream=t.join("\n"),s}},tA=function(e,t){var r=0===e.fontSize?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(e){return e.split("\n")}):a.map(function(e){return[e]});var s=r,i=NA.internal.getHeight(e)||0;i=i<0?-i:i;var o=NA.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(t,r,n){if(t+1<a.length){var s=r+" "+a[t+1][0];return rA(s,e,n).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var c,d,u=rA("3",e,s).height,h=e.multiline?i-s:(i-u)/2,f=h+=2,m=0,p=0,g=0;if(s<=0){t="(...) Tj\n",t+="% Width of Text: "+rA(t,e,s=12).width+", FieldWidth:"+o+"\n";break}for(var x="",b=0,v=0;v<a.length;v++)if(a.hasOwnProperty(v)){var y=!1;if(1!==a[v].length&&g!==a[v].length-1){if((u+2)*(b+2)+2>i)continue e;x+=a[v][g],y=!0,p=v,v--}else{x=" "==(x+=a[v][g]+" ").substr(x.length-1)?x.substr(0,x.length-1):x;var w=parseInt(v),N=l(w,x,s),j=v>=a.length-1;if(N&&!j){x+=" ",g=0;continue}if(N||j){if(j)p=w;else if(e.multiline&&(u+2)*(b+2)+2>i)continue e}else{if(!e.multiline)continue e;if((u+2)*(b+2)+2>i)continue e;p=w}}for(var k="",S=m;S<=p;S++){var A=a[S];if(e.multiline){if(S===p){k+=A[g]+" ",g=(g+1)%A.length;continue}if(S===m){k+=A[A.length-1]+" ";continue}}k+=A[0]+" "}switch(k=" "==k.substr(k.length-1)?k.substr(0,k.length-1):k,d=rA(k,e,s).width,e.textAlign){case"right":c=o-d-2;break;case"center":c=(o-d)/2;break;default:c=2}t+=qS(c)+" "+qS(f)+" Td\n",t+="("+US(k)+") Tj\n",t+=-qS(c)+" 0 Td\n",f=-(s+2),d=0,m=y?p:p+1,b++,x=""}break}return n.text=t,n.fontSize=s,n},rA=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},nA={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},aA=function(e,t){var r={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===r.type&&e.object===r.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},sA=MS.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(e){return e};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(0!==s&&(a+=" "),(0,Kv.A)(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":"/"!==e[s].substr(0,1)?(void 0!==t&&r&&(n=r.internal.getEncryptor(t)),a+="("+US(n(e[s].toString()))+")"):a+=e[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},iA=function(e,t,r){var n=function(e){return e};return void 0!==t&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+US(n(e))+")"},oA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};oA.prototype.toString=function(){return this.objId+" 0 R"},oA.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},oA.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var r in t)if(!1===Object.getOwnPropertyDescriptor(this,t[r]).configurable){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:sA(a,this.objId,this.scope)}):a instanceof oA?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):"function"!=typeof a&&e.push({key:n,value:a}))}return e};var lA=function(){oA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};WS(lA,oA);var cA=function(){oA.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+US(t(e))+")"}},set:function(t){e=t}})};WS(cA,oA);var dA=function e(){oA.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(t,3))},set:function(e){!0===Boolean(e)?this.F=JS(t,3):this.F=QS(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');r=e}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(e){n=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(e){n[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(e){n[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(e){n[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(e){n[3]=e}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof bA)return;s="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+US(t(s))+")"},set:function(e){s=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(e){s=e}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/BS:c},set:function(e){c=e}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){d=e}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof bA||this instanceof yA))return iA(u,this.objId,this.scope)},set:function(e){e=e.toString(),u=e}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof pA==0?iA(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof pA==0?"("===e.substr(0,1)?zS(e.substr(1,e.length-2)):zS(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof pA==1?zS(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof pA==1?"/"+e:e}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof pA==0?iA(f,this.objId,this.scope):f},set:function(e){e=e.toString(),f=this instanceof pA==0?"("===e.substr(0,1)?zS(e.substr(1,e.length-2)):zS(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof pA==1?zS(f.substr(1,f.length-1)):f},set:function(e){e=e.toString(),f=this instanceof pA==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(e){e=Boolean(e),p=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(e){m=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,1):this.Ff=QS(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,2):this.Ff=QS(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,3):this.Ff=QS(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');g=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(g){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};WS(dA,oA);var uA=function(){dA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return sA(t,this.objId,this.scope)},set:function(e){var r,n;n=[],"string"==typeof(r=e)&&(n=function(e,t,r){r||(r=1);for(var n,a=[];n=t.exec(e);)a.push(n[r]);return a}(r,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,r){for(r=r||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,18):this.Ff=QS(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=JS(this.Ff,19):this.Ff=QS(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=JS(this.Ff,20),t.sort()):this.Ff=QS(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,22):this.Ff=QS(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,23):this.Ff=QS(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,27):this.Ff=QS(this.Ff,27)}}),this.hasAppearanceStream=!1};WS(uA,dA);var hA=function(){uA.call(this),this.fontName="helvetica",this.combo=!1};WS(hA,uA);var fA=function(){hA.call(this),this.combo=!0};WS(fA,hA);var mA=function(){fA.call(this),this.edit=!0};WS(mA,fA);var pA=function(){dA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,15):this.Ff=QS(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,16):this.Ff=QS(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,17):this.Ff=QS(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,26):this.Ff=QS(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var r,n=[];for(r in n.push("<<"),t)n.push("/"+r+" ("+US(e(t[r]))+")");return n.push(">>"),n.join("\n")}},set:function(e){"object"===(0,Kv.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};WS(pA,dA);var gA=function(){pA.call(this),this.pushButton=!0};WS(gA,pA);var xA=function(){pA.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};WS(xA,pA);var bA=function(){var e,t;dA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,r=[];for(t in r.push("<<"),n)r.push("/"+t+" ("+US(e(n[t]))+")");return r.push(">>"),r.join("\n")},set:function(e){"object"===(0,Kv.A)(e)&&(n=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(e){"string"==typeof e&&(n.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=NA.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};WS(bA,dA),xA.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},xA.prototype.createOption=function(e){var t=new bA;return t.Parent=this,t.optionName=e,this.Kids.push(t),jA.call(this.scope,t),t};var vA=function(){pA.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=NA.CheckBox.createAppearanceStream()};WS(vA,pA);var yA=function(){dA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,13):this.Ff=QS(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,21):this.Ff=QS(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,23):this.Ff=QS(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,24):this.Ff=QS(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,25):this.Ff=QS(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,26):this.Ff=QS(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};WS(yA,dA);var wA=function(){yA.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean($S(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=JS(this.Ff,14):this.Ff=QS(this.Ff,14)}}),this.password=!0};WS(wA,yA);var NA={CheckBox:{createAppearanceStream:function(){return{N:{On:NA.CheckBox.YesNormal},D:{On:NA.CheckBox.YesPushDown,Off:NA.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=GS(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=tA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+qS(NA.internal.getWidth(e))+" "+qS(NA.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+qS(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join("\n"),t},YesNormal:function(e){var t=GS(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],s=NA.internal.getHeight(e),i=NA.internal.getWidth(e),o=tA(e,e.caption);return a.push("1 g"),a.push("0 0 "+qS(i)+" "+qS(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+qS(i-1)+" "+qS(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+qS(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=GS(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+qS(NA.internal.getWidth(e))+" "+qS(NA.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:NA.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=NA.RadioButton.Circle.YesNormal,t.D[e]=NA.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=GS(e);t.scope=e.scope;var r=[],n=NA.internal.getWidth(e)<=NA.internal.getHeight(e)?NA.internal.getWidth(e)/4:NA.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=NA.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+HS(NA.internal.getWidth(e)/2)+" "+HS(NA.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=GS(e);t.scope=e.scope;var r=[],n=NA.internal.getWidth(e)<=NA.internal.getHeight(e)?NA.internal.getWidth(e)/4:NA.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*NA.internal.Bezier_C).toFixed(5)),i=Number((n*NA.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+HS(NA.internal.getWidth(e)/2)+" "+HS(NA.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+HS(NA.internal.getWidth(e)/2)+" "+HS(NA.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=GS(e);t.scope=e.scope;var r=[],n=NA.internal.getWidth(e)<=NA.internal.getHeight(e)?NA.internal.getWidth(e)/4:NA.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*NA.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+HS(NA.internal.getWidth(e)/2)+" "+HS(NA.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:NA.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=NA.RadioButton.Cross.YesNormal,t.D[e]=NA.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=GS(e);t.scope=e.scope;var r=[],n=NA.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+qS(NA.internal.getWidth(e)-2)+" "+qS(NA.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(qS(n.x1.x)+" "+qS(n.x1.y)+" m"),r.push(qS(n.x2.x)+" "+qS(n.x2.y)+" l"),r.push(qS(n.x4.x)+" "+qS(n.x4.y)+" m"),r.push(qS(n.x3.x)+" "+qS(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=GS(e);t.scope=e.scope;var r=NA.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+qS(NA.internal.getWidth(e))+" "+qS(NA.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+qS(NA.internal.getWidth(e)-2)+" "+qS(NA.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(qS(r.x1.x)+" "+qS(r.x1.y)+" m"),n.push(qS(r.x2.x)+" "+qS(r.x2.y)+" l"),n.push(qS(r.x4.x)+" "+qS(r.x4.y)+" m"),n.push(qS(r.x3.x)+" "+qS(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=GS(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+qS(NA.internal.getWidth(e))+" "+qS(NA.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};NA.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=NA.internal.getWidth(e),r=NA.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},NA.internal.getWidth=function(e){var t=0;return"object"===(0,Kv.A)(e)&&(t=VS(e.Rect[2])),t},NA.internal.getHeight=function(e){var t=0;return"object"===(0,Kv.A)(e)&&(t=VS(e.Rect[3])),t};var jA=MS.addField=function(e){if(function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(dA.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(nA)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");BS=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new cA,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];n.objId=void 0,n.hasAnnotation&&aA(n,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var r=!e;for(var n in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(n)){var a=e[n],s=[],i=a.Rect;if(a.Rect&&(a.Rect=ZS(a.Rect,t)),t.internal.newObjectDeferredBegin(a.objId,!0),a.DA=NA.createDefaultAppearanceStream(a),"object"===(0,Kv.A)(a)&&"function"==typeof a.getKeyValueListForStream&&(s=a.getKeyValueListForStream()),a.Rect=i,a.hasAppearanceStream&&!a.appearanceStreamContent){var o=eA(a);s.push({key:"AP",value:"<</N "+o+">>"}),t.internal.acroformPlugin.xForms.push(o)}if(a.appearanceStreamContent){var l="";for(var c in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(c)){var d=a.appearanceStreamContent[c];if(l+="/"+c+" ",l+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var n in d)if(d.hasOwnProperty(n)){var u=d[n];"function"==typeof u&&(u=u.call(t,a)),l+="/"+n+" "+u+" ",t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u)}}else"function"==typeof(u=d)&&(u=u.call(t,a)),l+="/"+n+" "+u,t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u);l+=">>"}s.push({key:"AP",value:"<<\n"+l+">>"})}t.internal.putStream({additionalKeyValues:s,objectId:a.objId}),t.internal.out("endobj")}r&&function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),"object"===(0,Kv.A)(a)&&"function"==typeof a.putStream&&a.putStream(),delete e[n]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this,e),!(e instanceof dA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};MS.AcroFormChoiceField=uA,MS.AcroFormListBox=hA,MS.AcroFormComboBox=fA,MS.AcroFormEditBox=mA,MS.AcroFormButton=pA,MS.AcroFormPushButton=gA,MS.AcroFormRadioButton=xA,MS.AcroFormCheckBox=vA,MS.AcroFormTextField=yA,MS.AcroFormPasswordField=wA,MS.AcroFormAppearance=NA,MS.AcroForm={ChoiceField:uA,ListBox:hA,ComboBox:fA,EditBox:mA,Button:pA,PushButton:gA,RadioButton:xA,CheckBox:vA,TextField:yA,PasswordField:wA,Appearance:NA},DS.AcroForm={ChoiceField:uA,ListBox:hA,ComboBox:fA,EditBox:mA,Button:pA,PushButton:gA,RadioButton:xA,CheckBox:vA,TextField:yA,PasswordField:wA,Appearance:NA};DS.AcroForm;function kA(e){return e.reduce(function(e,t,r){return e[t]=r,e},{})}!function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(e,t){var a,s,i,o,l,c=r;if("RGBA"===(t=t||r)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(N(e))for(l in n)for(i=n[l],a=0;a<i.length;a+=1){for(o=!0,s=0;s<i[a].length;s+=1)if(void 0!==i[a][s]&&i[a][s]!==e[s]){o=!1;break}if(!0===o){c=l;break}}else for(l in n)for(i=n[l],a=0;a<i.length;a+=1){for(o=!0,s=0;s<i[a].length;s+=1)if(void 0!==i[a][s]&&i[a][s]!==e.charCodeAt(s)){o=!1;break}if(!0===o){c=l;break}}return c===r&&t!==r&&(c=t),c},s=function e(t){for(var r=this.internal.write,n=this.internal.putStream,a=(0,this.internal.getFilters)();-1!==a.indexOf("FlateEncode");)a.splice(a.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:t.width}),s.push({key:"Height",value:t.height}),t.colorSpace===x.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===x.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)&&t.transparency.length>0){for(var i="",o=0,l=t.transparency.length;o<l;o++)i+=t.transparency[o]+" "+t.transparency[o]+" ";s.push({key:"Mask",value:"["+i+"]"})}void 0!==t.sMask&&s.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(n({data:t.data,additionalKeyValues:s,alreadyAppliedFilters:c,objectId:t.objectId}),r("endobj"),"sMask"in t&&void 0!==t.sMask){var d,u=null!==(d=t.sMaskBitsPerComponent)&&void 0!==d?d:t.bitsPerComponent,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:u,data:t.sMask};"filter"in t&&(h.decodeParameters="/Predictor ".concat(t.predictor," /Colors 1 /BitsPerComponent ").concat(u," /Columns ").concat(t.width),h.filter=t.filter),e.call(this,h)}if(t.colorSpace===x.INDEXED){var f=this.internal.newObject();n({data:k(new Uint8Array(t.palette)),objectId:f}),r("endobj")}},i=function(){var e=this.internal.collections[t+"images"];for(var r in e)s.call(this,e[r])},o=function(){var e,r=this.internal.collections[t+"images"],n=this.internal.write;for(var a in r)n("/I"+(e=r[a]).index,e.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var e=this.internal.collections[t+"images"];return l.call(this),e},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},u=function(t){return"function"==typeof e["process"+t.toUpperCase()]},h=function(e){return"object"===(0,Kv.A)(e)&&1===e.nodeType},f=function(t,r){if("IMG"===t.nodeName&&t.hasAttribute("src")){var n=""+t.getAttribute("src");if(0===n.indexOf("data:image/"))return hS(unescape(n).split("base64,").pop());var a=e.loadFile(n,!0);if(void 0!==a)return a}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var s;switch(r){case"PNG":s="image/png";break;case"WEBP":s="image/webp";break;default:s="image/jpeg"}return hS(t.toDataURL(s,1).split("base64,").pop())}},m=function(e){var r=this.internal.collections[t+"images"];if(r)for(var n in r)if(e===r[n].alias)return r[n]},p=function(e,t,r){return e||t||(e=-96,t=-96),e<0&&(e=-1*r.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*r.height*72/t/this.internal.scaleFactor),0===e&&(e=t*r.width/r.height),0===t&&(t=e*r.height/r.width),[e,t]},g=function(e,t,r,n,a,s){var i=p.call(this,r,n,a),o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,d=c.call(this);if(r=i[0],n=i[1],d[a.index]=a,s){s*=Math.PI/180;var u=Math.cos(s),h=Math.sin(s),f=function(e){return e.toFixed(4)},m=[f(u),f(h),f(-1*h),f(u),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,o(e),l(t+n),"cm"].join(" ")),this.internal.write(m.join(" ")),this.internal.write([o(r),"0","0",o(n),"0","0","cm"].join(" "))):this.internal.write([o(r),"0","0",o(n),o(e),l(t+n),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+a.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(e){var t,r,n=0;if("string"==typeof e)for(r=e.length,t=0;t<r;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;else if(N(e))for(r=e.byteLength/2,t=0;t<r;t++)n=(n<<5)-n+e[t],n|=0;return n},y=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},w=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null};e.__addimage__.isArrayBuffer=function(e){return e instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},j=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(t),n=0;n<t;n++)r[n]=e.charCodeAt(n);return r},k=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",r=N(e)?e:new Uint8Array(e),n=0;n<r.length;n+=8192)t+=String.fromCharCode.apply(null,r.subarray(n,n+8192));return t};e.addImage=function(){var e,t,n,a,s,i,o,c,d;if("number"==typeof arguments[1]?(t=r,n=arguments[1],a=arguments[2],s=arguments[3],i=arguments[4],o=arguments[5],c=arguments[6],d=arguments[7]):(t=arguments[1],n=arguments[2],a=arguments[3],s=arguments[4],i=arguments[5],o=arguments[6],c=arguments[7],d=arguments[8]),"object"===(0,Kv.A)(e=arguments[0])&&!h(e)&&"imageData"in e){var u=e;e=u.imageData,t=u.format||t||r,n=u.x||n||0,a=u.y||a||0,s=u.w||u.width||s,i=u.h||u.height||i,o=u.alias||o,c=u.compression||c,d=u.rotation||u.angle||d}var f=this.internal.getFilters();if(void 0===c&&-1!==f.indexOf("FlateEncode")&&(c="SLOW"),isNaN(n)||isNaN(a))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var m=S.call(this,e,t,o,c);return g.call(this,n,a,s,i,m,d),this};var S=function(t,n,s,i){var o,l,c;if("string"==typeof t&&a(t)===r){t=unescape(t);var p=A(t,!1);(""!==p||void 0!==(p=e.loadFile(t,!0)))&&(t=p)}if(h(t)&&(t=f(t,n)),n=a(t,n),!u(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if((null==(c=s)||0===c.length)&&(s=function(e){return"string"==typeof e||N(e)?v(e):N(e.data)?v(e.data):null}(t)),(o=m.call(this,s))||(t instanceof Uint8Array||"RGBA"===n||(l=t,t=j(t)),o=this["process"+n.toUpperCase()](t,d.call(this),s,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:b.NONE}(i),l)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},A=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var r,n="";if("string"==typeof e){var s;r=null!==(s=w(e))&&void 0!==s?s:e;try{n=hS(r)}catch(a){if(t)throw y(r)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+a.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return n};e.getImageProperties=function(t){var n,s,i="";if(h(t)&&(t=f(t)),"string"==typeof t&&a(t)===r&&(""===(i=A(t,!1))&&(i=e.loadFile(t)||""),t=i),s=a(t),!u(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(t instanceof Uint8Array||(t=j(t)),!(n=this["process"+s.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return n.fileType=s,n}}(DS.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};DS.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var r,n,a,s=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,o=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,c=!1,d=0;d<l.length&&!c;d++)switch((r=l[d]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var u=0;u<l.length;u++){r=l[u];var h=this.internal.pdfEscape,f=this.internal.getEncryptor(e.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),p=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(m.objId),x=r.title||"Note";a="<</Type /Annot /Subtype /Text "+(n="/Rect ["+s(r.bounds.x)+" "+i(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y)+"] ")+"/Contents ("+h(g(r.contents))+")",a+=" /Popup "+p.objId+" 0 R",a+=" /P "+o.objId+" 0 R",a+=" /T ("+h(g(x))+") >>",m.content=a;var b=m.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+s(r.bounds.x+30)+" "+i(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+i(r.bounds.y)+"] ")+" /Parent "+b,r.open&&(a+=" /Open true"),a+=" >>",p.content=a,this.internal.write(m.objId,"0 R",p.objId,"0 R");break;case"freetext":n="/Rect ["+s(r.bounds.x)+" "+i(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y+r.bounds.h)+"] ";var v=r.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+h(f(r.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(r.options.name){var y=this.annotations._nameMap[r.options.name];r.options.pageNumber=y.page,r.options.top=y.y}else r.options.top||(r.options.top=0);if(n="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",a="",r.options.url)a="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+h(f(r.options.url))+") >>";else if(r.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,a+=" /FitV "+r.options.left+"]";break;default:var w=i(r.options.top);r.options.left=r.options.left||0,void 0===r.options.zoom&&(r.options.zoom=0),a+=" /XYZ "+r.options.left+" "+w+" "+r.options.zoom+"]"}""!=a&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,r,n,a){var s=this.internal.getCurrentPageInfo(),i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:i(e),y:o(t),w:i(e+r),h:o(t+n)},options:a,type:"link"})},e.textWithLink=function(e,t,r,n){var a,s,i=this.getTextWidth(e),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==n.maxWidth){s=n.maxWidth;var l=this.splitTextToSize(e,s).length;a=Math.ceil(o*l)}else s=i,a=o;return this.text(e,t,r,n),r+=.2*o,"center"===n.align&&(t-=i/2),"right"===n.align&&(t-=i),this.link(t,r-o,s,a,n),i},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(DS.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},i=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(e){return i(e)&&a.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return i(e)&&s(e)&&4==t[e.charCodeAt(0)].length},u=e.__arabicParser__.resolveLigatures=function(e){var t=0,n=r,a="",s=0;for(t=0;t<e.length;t+=1)void 0!==n[e.charCodeAt(t)]?(s++,"number"==typeof(n=n[e.charCodeAt(t)])&&(a+=String.fromCharCode(n),n=r,s=0),t===e.length-1&&(n=r,a+=e.charAt(t-(s-1)),t-=s-1,s=0)):(n=r,a+=e.charAt(t-s),t-=s,s=0);return a};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==n[e.charCodeAt(0)]};var h=e.__arabicParser__.getCorrectForm=function(e,t,r){return i(e)?!1===s(e)?-1:!c(e)||!i(t)&&!i(r)||!i(r)&&o(t)||o(e)&&!i(t)||o(e)&&l(t)||o(e)&&o(t)?0:d(e)&&i(t)&&!o(t)&&i(r)&&c(r)?3:o(e)||!i(r)?1:2:-1},f=function(e){var r=0,n=0,a=0,s="",o="",l="",c=(e=e||"").split("\\s+"),d=[];for(r=0;r<c.length;r+=1){for(d.push(""),n=0;n<c[r].length;n+=1)s=c[r][n],o=c[r][n-1],l=c[r][n+1],i(s)?(a=h(s,o,l),d[r]+=-1!==a?String.fromCharCode(t[s.charCodeAt(0)][a]):s):d[r]+=s;d[r]=u(d[r])}return d.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,r=[];if(Array.isArray(t)){var n=0;for(r=[],n=0;n<t.length;n+=1)Array.isArray(t[n])?r.push([f(t[n][0]),t[n][1],t[n][2]]):r.push([f(t[n])]);e=r}else e=f(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",m])}(DS.API),DS.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(e){r=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(e){n=e}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var r;if("2d"!==(e=e||"2d"))return null;for(r in t)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=t[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(DS.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var r=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var n=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var a=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var i=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return i},set:function(e){i=e}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return n.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){n.call(this);var r=(t=t||{}).fontSize||this.getFontSize(),a=t.font||this.getFont(),s=t.scaleFactor||this.internal.scaleFactor,i=0,o=0,l=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var d=t.maxWidth;d>0?"string"==typeof e?e=this.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(c.splitTextToSize(t,d))},[])):e=Array.isArray(e)?e:[e];for(var u=0;u<e.length;u++)i<(l=this.getStringUnitWidth(e[u],{font:a})*r)&&(i=l);return 0!==i&&(o=e.length),{w:i/=s,h:Math.max((o*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/s,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var e;e=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var a=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,o=this.internal.__cell__.margins||t,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==a.lineNumber&&(a.lineNumber===e.lineNumber?(e.x=(a.x||0)+(a.width||0),e.y=a.y||0):a.y+a.height+e.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=o.top,c&&l&&(this.printHeaderRow(e.lineNumber,!0),e.y+=l[0].height)):e.y=a.y+a.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===r?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-i,e.y+i,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+i,{align:"center",baseline:"top",maxWidth:e.width-i-i}):this.text(e.text,e.x+i,e.y+i,{align:"left",baseline:"top",maxWidth:e.width-i-i})),this.internal.__cell__.lastCell=e,this};e.table=function(e,r,l,c,d){if(n.call(this),!l)throw new Error("No data for PDF table.");var u,h,f,m,p=[],g=[],x=[],b={},v={},y=[],w=[],N=(d=d||{}).autoSize||!1,j=!1!==d.printHeaders,k=d.css&&void 0!==d.css["font-size"]?16*d.css["font-size"]:d.fontSize||12,S=d.margins||Object.assign({width:this.getPageWidth()},t),A="number"==typeof d.padding?d.padding:3,C=d.headerBackgroundColor||"#c8c8c8",_=d.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=k,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=C,this.internal.__cell__.headerTextColor=_,this.setFontSize(k),null==c)g=p=Object.keys(l[0]),x=p.map(function(){return"left"});else if(Array.isArray(c)&&"object"===(0,Kv.A)(c[0]))for(p=c.map(function(e){return e.name}),g=c.map(function(e){return e.prompt||e.name||""}),x=c.map(function(e){return e.align||"left"}),u=0;u<c.length;u+=1)v[c[u].name]=.7499990551181103*c[u].width;else Array.isArray(c)&&"string"==typeof c[0]&&(g=p=c,x=p.map(function(){return"left"}));if(N||Array.isArray(c)&&"string"==typeof c[0])for(u=0;u<p.length;u+=1){for(b[m=p[u]]=l.map(function(e){return e[m]}),this.setFont(void 0,"bold"),y.push(this.getTextDimensions(g[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),h=b[m],this.setFont(void 0,"normal"),f=0;f<h.length;f+=1)y.push(this.getTextDimensions(h[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);v[m]=Math.max.apply(null,y)+A+A,y=[]}if(j){var T={};for(u=0;u<p.length;u+=1)T[p[u]]={},T[p[u]].text=g[u],T[p[u]].align=x[u];var E=o.call(this,T,v);w=p.map(function(t){return new s(e,r,v[t],E,T[t].text,void 0,T[t].align)}),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var L=c.reduce(function(e,t){return e[t.name]=t.align,e},{});for(u=0;u<l.length;u+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:u,data:l[u]},this);var P=o.call(this,l[u],v);for(f=0;f<p.length;f+=1){var O=l[u][p[f]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:u,col:f,data:O},this),i.call(this,new s(e,r,v[p[f]],P,O,u+2,L[p[f]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=r,this};var o=function(e,t){var r=this.internal.__cell__.padding,n=this.internal.__cell__.table_font_size,a=this.internal.scaleFactor;return Object.keys(e).map(function(n){var a=e[n];return this.splitTextToSize(a.hasOwnProperty("text")?a.text:a,t[n]-r-r)},this).map(function(e){return this.getLineHeightFactor()*e.length*n/a+r+r},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){n.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var a;if(r=!0,"function"==typeof this.internal.__cell__.headerFunction){var o=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(o[0],o[1],o[2],o[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){a=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(a.y=this.internal.__cell__.margins.top||0,l.push(a)),a.lineNumber=e;var d=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,a),this.setTextColor(d)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),r=!1}}(DS.API);var SA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},AA=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],CA=kA(AA),_A=[100,200,300,400,500,600,700,800,900],TA=kA(_A);function EA(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(e){return SA[e=e||"normal"]?e:"normal"}(e.style),n=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),a=function(e){return"number"==typeof CA[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function LA(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var PA={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},OA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function FA(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function IA(e){return e.trimLeft()}function RA(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function DA(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var MA,BA,UA,zA,qA,HA,WA,VA,GA,KA=["times"];function YA(e,t,r,n,a){var s=4,i=JA;switch(a){case DS.API.image_compression.FAST:s=1,i=$A;break;case DS.API.image_compression.MEDIUM:s=6,i=QA;break;case DS.API.image_compression.SLOW:s=9,i=ZA}e=function(e,t,r,n){for(var a,s=e.length/t,i=new Uint8Array(e.length+s),o=[XA,$A,JA,QA,ZA],l=0;l<s;l+=1){var c=l*t,d=e.subarray(c,c+t);if(n)i.set(n(d,r,a),c+l);else{for(var u=o.length,h=[],f=0;f<u;f+=1)h[f]=o[f](d,r,a);var m=tC(h.concat());i.set(h[m],c+l)}a=d}return i}(e,t,Math.ceil(r*n/8),i);var o=Ly(e,{level:s});return DS.API.__addimage__.arrayBufferToBinaryString(o)}function XA(e){var t=Array.apply([],e);return t.unshift(0),t}function $A(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=e[a-t]||0;n[a+1]=e[a]-s+256&255}return n}function JA(e,t,r){var n=e.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var i=r&&r[s]||0;a[s+1]=e[s]-i+256&255}return a}function QA(e,t,r){var n=e.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var i=e[s-t]||0,o=r&&r[s]||0;a[s+1]=e[s]+256-(i+o>>>1)&255}return a}function ZA(e,t,r){var n=e.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var i=eC(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);a[s+1]=e[s]-i+256&255}return a}function eC(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=a&&n<=s?e:a<=s?t:r}function tC(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))}function rC(e,t,r){var n=t*r,a=Math.floor(n/8),s=16-(n-8*a+r),i=(1<<r)-1;return aC(e,a)>>s&i}function nC(e,t,r,n){var a=r*n,s=Math.floor(a/8),i=16-(a-8*s+n),o=(1<<n)-1,l=(t&o)<<i;!function(e,t,r){if(t+1<e.byteLength)e.setUint16(t,r,!1);else{var n=r>>8&255;e.setUint8(t,n)}}(e,s,aC(e,s)&~(o<<i)&65535|l)}function aC(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function sC(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],s=a>>7,i=1<<1+(7&a);e[t++],e[t++];var o=null,l=null;s&&(o=t,l=i,t+=3*i);var c=!0,d=[],u=0,h=null,f=0,m=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var p=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],1&p||(h=null),f=p>>2&7,t++;break;case 254:for(;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,y=e[t++],w=y>>6&1,N=1<<1+(7&y),j=o,k=l,S=!1;y>>7&&(S=!0,j=t,k=N,t+=3*N);var A=t;for(t++;;){var C;if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}d.push({x:g,y:x,width:b,height:v,has_local_palette:S,palette_offset:j,palette_size:k,data_offset:A,data_length:t-A,transparent_index:h,interlaced:!!w,delay:u,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(e){if(e<0||e>=d.length)throw new Error("Frame index out of range.");return d[e]},this.decodeAndBlitFrameBGRA=function(t,n){var a=this.frameInfo(t),s=a.width*a.height,i=new Uint8Array(s);iC(e,a.data_offset,i,s);var o=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var c=a.width,d=r-c,u=c,h=4*(a.y*r+a.x),f=4*((a.y+a.height)*r+a.x),m=h,p=4*d;!0===a.interlaced&&(p+=4*r*7);for(var g=8,x=0,b=i.length;x<b;++x){var v=i[x];if(0===u&&(u=c,(m+=p)>=f&&(p=4*d+4*r*(g-1),m=h+(c+d)*(g<<1),g>>=1)),v===l)m+=4;else{var y=e[o+3*v],w=e[o+3*v+1],N=e[o+3*v+2];n[m++]=N,n[m++]=w,n[m++]=y,n[m++]=255}--u}},this.decodeAndBlitFrameRGBA=function(t,n){var a=this.frameInfo(t),s=a.width*a.height,i=new Uint8Array(s);iC(e,a.data_offset,i,s);var o=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var c=a.width,d=r-c,u=c,h=4*(a.y*r+a.x),f=4*((a.y+a.height)*r+a.x),m=h,p=4*d;!0===a.interlaced&&(p+=4*r*7);for(var g=8,x=0,b=i.length;x<b;++x){var v=i[x];if(0===u&&(u=c,(m+=p)>=f&&(p=4*d+4*r*(g-1),m=h+(c+d)*(g<<1),g>>=1)),v===l)m+=4;else{var y=e[o+3*v],w=e[o+3*v+1],N=e[o+3*v+2];n[m++]=y,n[m++]=w,n[m++]=N,n[m++]=255}--u}}}function iC(e,t,r,n){for(var a=e[t++],s=1<<a,i=s+1,o=i+1,l=a+1,c=(1<<l)-1,d=0,u=0,h=0,f=e[t++],m=new Int32Array(4096),p=null;;){for(;d<16&&0!==f;)u|=e[t++]<<d,d+=8,1===f?f=e[t++]:--f;if(d<l)break;var g=u&c;if(u>>=l,d-=l,g!==s){if(g===i)break;for(var x=g<o?g:p,b=0,v=x;v>s;)v=m[v]>>8,++b;var y=v;if(h+b+(x!==g?1:0)>n)return void iS.log("Warning, gif stream longer than expected.");r[h++]=y;var w=h+=b;for(x!==g&&(r[h++]=y),v=x;b--;)v=m[v],r[--w]=255&v,v>>=8;null!==p&&o<4096&&(m[o++]=p<<8|y,o>=c+1&&l<12&&(++l,c=c<<1|1)),p=g}else o=i+1,c=(1<<(l=a+1))-1,p=null}return h!==n&&iS.log("Warning, gif stream shorter than expected."),r}function oC(e){var t,r,n,a,s,i=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(65535),h=new Array(65535),f=new Array(64),m=new Array(64),p=[],g=0,x=7,b=new Array(64),v=new Array(64),y=new Array(64),w=new Array(256),N=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],L=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function P(e,t){for(var r=0,n=0,a=new Array,s=1;s<=16;s++){for(var i=1;i<=e[s];i++)a[t[n]]=[],a[t[n]][0]=r,a[t[n]][1]=s,n++,r++;r*=2}return a}function O(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(g|=1<<x),r--,--x<0&&(255==g?(F(255),F(0)):F(g),x=7,g=0)}function F(e){p.push(e)}function I(e){F(e>>8&255),F(255&e)}function R(e,t,r,n,a){for(var s,i=a[0],o=a[240],l=function(e,t){var r,n,a,s,i,o,l,c,d,u,h=0;for(d=0;d<8;++d){r=e[h],n=e[h+1],a=e[h+2],s=e[h+3],i=e[h+4],o=e[h+5],l=e[h+6];var m=r+(c=e[h+7]),p=r-c,g=n+l,x=n-l,b=a+o,v=a-o,y=s+i,w=s-i,N=m+y,j=m-y,k=g+b,S=g-b;e[h]=N+k,e[h+4]=N-k;var A=.707106781*(S+j);e[h+2]=j+A,e[h+6]=j-A;var C=.382683433*((N=w+v)-(S=x+p)),_=.5411961*N+C,T=1.306562965*S+C,E=.707106781*(k=v+x),L=p+E,P=p-E;e[h+5]=P+_,e[h+3]=P-_,e[h+1]=L+T,e[h+7]=L-T,h+=8}for(h=0,d=0;d<8;++d){r=e[h],n=e[h+8],a=e[h+16],s=e[h+24],i=e[h+32],o=e[h+40],l=e[h+48];var O=r+(c=e[h+56]),F=r-c,I=n+l,R=n-l,D=a+o,M=a-o,B=s+i,U=s-i,z=O+B,q=O-B,H=I+D,W=I-D;e[h]=z+H,e[h+32]=z-H;var V=.707106781*(W+q);e[h+16]=q+V,e[h+48]=q-V;var G=.382683433*((z=U+M)-(W=R+F)),K=.5411961*z+G,Y=1.306562965*W+G,X=.707106781*(H=M+R),$=F+X,J=F-X;e[h+40]=J+K,e[h+24]=J-K,e[h+8]=$+Y,e[h+56]=$-Y,h++}for(d=0;d<64;++d)u=e[d]*t[d],f[d]=u>0?u+.5|0:u-.5|0;return f}(e,t),c=0;c<64;++c)m[j[c]]=l[c];var d=m[0]-r;r=m[0],0==d?O(n[0]):(O(n[h[s=32767+d]]),O(u[s]));for(var p=63;p>0&&0==m[p];)p--;if(0==p)return O(i),r;for(var g,x=1;x<=p;){for(var b=x;0==m[x]&&x<=p;)++x;var v=x-b;if(v>=16){g=v>>4;for(var y=1;y<=g;++y)O(o);v&=15}s=32767+m[x],O(a[(v<<4)+h[s]]),O(u[s]),x++}return 63!=p&&O(i),r}function D(e){e=Math.min(Math.max(e,1),100),s!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var n=i((t[r]*e+50)/100);n=Math.min(Math.max(n,1),255),o[j[r]]=n}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=i((a[s]*e+50)/100);u=Math.min(Math.max(u,1),255),l[j[s]]=u}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,m=0;m<8;m++)for(var p=0;p<8;p++)c[f]=1/(o[j[f]]*h[m]*h[p]*8),d[f]=1/(l[j[f]]*h[m]*h[p]*8),f++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),s=e)}this.encode=function(e,s){s&&D(s),p=new Array,g=0,x=7,I(65496),I(65504),I(16),F(74),F(70),F(73),F(70),F(0),F(1),F(1),F(0),I(1),I(1),F(0),F(0),function(){I(65499),I(132),F(0);for(var e=0;e<64;e++)F(o[e]);F(1);for(var t=0;t<64;t++)F(l[t])}(),function(e,t){I(65472),I(17),F(8),I(t),I(e),F(3),F(1),F(17),F(0),F(2),F(17),F(1),F(3),F(17),F(1)}(e.width,e.height),function(){I(65476),I(418),F(0);for(var e=0;e<16;e++)F(k[e+1]);for(var t=0;t<=11;t++)F(S[t]);F(16);for(var r=0;r<16;r++)F(A[r+1]);for(var n=0;n<=161;n++)F(C[n]);F(1);for(var a=0;a<16;a++)F(_[a+1]);for(var s=0;s<=11;s++)F(T[s]);F(17);for(var i=0;i<16;i++)F(E[i+1]);for(var o=0;o<=161;o++)F(L[o])}(),I(65498),I(12),F(3),F(1),F(0),F(2),F(17),F(3),F(17),F(0),F(63),F(0);var i=0,u=0,h=0;g=0,x=7,this.encode.displayName="_encode_";for(var f,m,w,j,P,M,B,U,z,q=e.data,H=e.width,W=e.height,V=4*H,G=0;G<W;){for(f=0;f<V;){for(P=V*G+f,B=-1,U=0,z=0;z<64;z++)M=P+(U=z>>3)*V+(B=4*(7&z)),G+U>=W&&(M-=V*(G+1+U-W)),f+B>=V&&(M-=f+B-V+4),m=q[M++],w=q[M++],j=q[M++],b[z]=(N[m]+N[w+256|0]+N[j+512|0]>>16)-128,v[z]=(N[m+768|0]+N[w+1024|0]+N[j+1280|0]>>16)-128,y[z]=(N[m+1280|0]+N[w+1536|0]+N[j+1792|0]>>16)-128;i=R(b,c,i,t,n),u=R(v,d,u,r,a),h=R(y,d,h,r,a),f+=32}G+=8}if(x>=0){var K=[];K[1]=x+1,K[0]=(1<<x+1)-1,O(K)}return I(65497),new Uint8Array(p)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=P(k,S),r=P(_,T),n=P(A,C),a=P(E,L),function(){for(var e=1,t=2,r=1;r<=15;r++){for(var n=e;n<t;n++)h[32767+n]=r,u[32767+n]=[],u[32767+n][1]=r,u[32767+n][0]=n;for(var a=-(t-1);a<=-e;a++)h[32767+a]=r,u[32767+a]=[],u[32767+a][1]=r,u[32767+a][0]=t-1+a;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)N[e]=19595*e,N[e+256|0]=38470*e,N[e+512|0]=7471*e+32768,N[e+768|0]=-11059*e,N[e+1024|0]=-21709*e,N[e+1280|0]=32768*e+8421375,N[e+1536|0]=-27439*e,N[e+1792|0]=-5329*e}(),D(e)}function lC(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function cC(e){function t(e){if(!e)throw Error("assert :P")}function r(e,t,r){for(var n=0;4>n;n++)if(e[t+n]!=r.charCodeAt(n))return!0;return!1}function n(e,t,r,n,a){for(var s=0;s<a;s++)e[t+s]=r[n+s]}function a(e,t,r,n){for(var a=0;a<n;a++)e[t+a]=r}function s(e){return new Int32Array(e)}function i(e,t){for(var r=[],n=0;n<e;n++)r.push(new t);return r}function o(e,t){var r=[];return function e(r,n,a){for(var s=a[n],i=0;i<s&&(r.push(a.length>n+1?[]:new t),!(a.length<n+1));i++)e(r[i],n+1,a)}(r,0,e),r}var l=function(){var e=this;function l(e,t){for(var r=1<<t-1>>>0;e&r;)r>>>=1;return r?(e&r-1)+r:e}function c(e,r,n,a,s){t(!(a%n));do{e[r+(a-=n)]=s}while(0<a)}function d(e,r,n,a,i){if(t(2328>=i),512>=i)var o=s(512);else if(null==(o=s(i)))return 0;return function(e,r,n,a,i,o){var d,h,f=r,m=1<<n,p=s(16),g=s(16);for(t(0!=i),t(null!=a),t(null!=e),t(0<n),h=0;h<i;++h){if(15<a[h])return 0;++p[a[h]]}if(p[0]==i)return 0;for(g[1]=0,d=1;15>d;++d){if(p[d]>1<<d)return 0;g[d+1]=g[d]+p[d]}for(h=0;h<i;++h)d=a[h],0<a[h]&&(o[g[d]++]=h);if(1==g[15])return(a=new u).g=0,a.value=o[0],c(e,f,1,m,a),m;var x,b=-1,v=m-1,y=0,w=1,N=1,j=1<<n;for(h=0,d=1,i=2;d<=n;++d,i<<=1){if(w+=N<<=1,0>(N-=p[d]))return 0;for(;0<p[d];--p[d])(a=new u).g=d,a.value=o[h++],c(e,f+y,i,j,a),y=l(y,d)}for(d=n+1,i=2;15>=d;++d,i<<=1){if(w+=N<<=1,0>(N-=p[d]))return 0;for(;0<p[d];--p[d]){if(a=new u,(y&v)!=b){for(f+=j,x=1<<(b=d)-n;15>b&&!(0>=(x-=p[b]));)++b,x<<=1;m+=j=1<<(x=b-n),e[r+(b=y&v)].g=x+n,e[r+b].value=f-r-b}a.g=d-n,a.value=o[h++],c(e,f+(y>>n),i,j,a),y=l(y,d)}}return w!=2*g[15]-1?0:m}(e,r,n,a,i,o)}function u(){this.value=this.g=0}function h(){this.value=this.g=0}function f(){this.G=i(5,u),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Dr,h)}function m(e,r,n,a){t(null!=e),t(null!=r),t(2147483648>a),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=r,e.pa=n,e.Jd=r,e.Yc=n+a,e.Zc=4<=a?n+a-4+1:n,A(e)}function p(e,t){for(var r=0;0<t--;)r|=_(e,128)<<t;return r}function g(e,t){var r=p(e,t);return C(e)?-r:r}function x(e,r,n,a){var s,i=0;for(t(null!=e),t(null!=r),t(4294967288>a),e.Sb=a,e.Ra=0,e.u=0,e.h=0,4<a&&(a=4),s=0;s<a;++s)i+=r[n+s]<<8*s;e.Ra=i,e.bb=a,e.oa=r,e.pa=n}function b(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Ur-8>>>0,++e.bb,e.u-=8;j(e)&&(e.h=1,e.u=0)}function v(e,r){if(t(0<=r),!e.h&&r<=Br){var n=N(e)&Mr[r];return e.u+=r,b(e),n}return e.h=1,e.u=0}function y(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function N(e){return e.Ra>>>(e.u&Ur-1)>>>0}function j(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Ur}function k(e,t){e.u=t,e.h=j(e)}function S(e){e.u>=zr&&(t(e.u>=zr),b(e))}function A(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function C(e){return p(e,1)}function _(e,t){var r=e.Ca;0>e.b&&A(e);var n=e.b,a=r*t>>>8,s=(e.I>>>n>a)+0;for(s?(r-=a,e.I-=a+1<<n>>>0):r=a+1,n=r,a=0;256<=n;)a+=8,n>>=8;return n=7^a+qr[n],e.b-=n,e.Ca=(r<<n)-1,s}function T(e,t,r){e[t+0]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function E(e,t){return e[t+0]|e[t+1]<<8}function L(e,t){return E(e,t)|e[t+2]<<16}function P(e,t){return E(e,t)|E(e,t+2)<<16}function O(e,r){var n=1<<r;return t(null!=e),t(0<r),e.X=s(n),null==e.X?0:(e.Mb=32-r,e.Xa=r,1)}function F(e,r){t(null!=e),t(null!=r),t(e.Xa==r.Xa),n(r.X,0,e.X,0,1<<r.Xa)}function I(){this.X=[],this.Xa=this.Mb=0}function R(e,r,n,a){t(null!=n),t(null!=a);var s=n[0],i=a[0];return 0==s&&(s=(e*i+r/2)/r),0==i&&(i=(r*s+e/2)/e),0>=s||0>=i?0:(n[0]=s,a[0]=i,1)}function D(e,t){return e+(1<<t)-1>>>t}function M(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function B(t,r){e[r]=function(r,n,a,s,i,o,l){var c;for(c=0;c<i;++c){var d=e[t](o[l+c-1],a,s+c);o[l+c]=M(r[n+c],d)}}}function U(){this.ud=this.hd=this.jd=0}function z(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function q(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function H(e,t){return q(e+(e-t+.5>>1))}function W(e,t,r){return Math.abs(t-r)-Math.abs(e-r)}function V(e,t,r,n,a,s,i){for(n=s[i-1],r=0;r<a;++r)s[i+r]=n=M(e[t+r],n)}function G(e,t,r,n,a){var s;for(s=0;s<r;++s){var i=e[t+s],o=i>>8&255,l=16711935&(l=(l=16711935&i)+((o<<16)+o));n[a+s]=(4278255360&i)+l>>>0}}function K(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function Y(e,t,r,n,a,s){var i;for(i=0;i<n;++i){var o=t[r+i],l=o>>>8,c=o,d=255&(d=(d=o>>>16)+((e.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(l<<24>>24)>>>5)+((e.ud<<24>>24)*(d<<24>>24)>>>5)),a[s+i]=(4278255360&o)+(d<<16)+c}}function X(t,r,n,a,s){e[r]=function(e,t,r,n,i,o,l,c,d){for(n=l;n<c;++n)for(l=0;l<d;++l)i[o++]=s(r[a(e[t++])])},e[t]=function(t,r,i,o,l,c,d){var u=8>>t.b,h=t.Ea,f=t.K[0],m=t.w;if(8>u)for(t=(1<<t.b)-1,m=(1<<u)-1;r<i;++r){var p,g=0;for(p=0;p<h;++p)p&t||(g=a(o[l++])),c[d++]=s(f[g&m]),g>>=u}else e["VP8LMapColor"+n](o,l,f,m,c,d,r,i,h)}}function $(e,t,r,n,a){for(r=t+r;t<r;){var s=e[t++];n[a++]=s>>16&255,n[a++]=s>>8&255,n[a++]=255&s}}function J(e,t,r,n,a){for(r=t+r;t<r;){var s=e[t++];n[a++]=s>>16&255,n[a++]=s>>8&255,n[a++]=255&s,n[a++]=s>>24&255}}function Q(e,t,r,n,a){for(r=t+r;t<r;){var s=(i=e[t++])>>16&240|i>>12&15,i=240&i|i>>28&15;n[a++]=s,n[a++]=i}}function Z(e,t,r,n,a){for(r=t+r;t<r;){var s=(i=e[t++])>>16&248|i>>13&7,i=i>>5&224|i>>3&31;n[a++]=s,n[a++]=i}}function ee(e,t,r,n,a){for(r=t+r;t<r;){var s=e[t++];n[a++]=255&s,n[a++]=s>>8&255,n[a++]=s>>16&255}}function te(e,t,r,a,s,i){if(0==i)for(r=t+r;t<r;)T(a,((i=e[t++])[0]>>24|i[1]>>8&65280|i[2]<<8&16711680|i[3]<<24)>>>0),s+=32;else n(a,s,e,t,r)}function re(t,r){e[r][0]=e[t+"0"],e[r][1]=e[t+"1"],e[r][2]=e[t+"2"],e[r][3]=e[t+"3"],e[r][4]=e[t+"4"],e[r][5]=e[t+"5"],e[r][6]=e[t+"6"],e[r][7]=e[t+"7"],e[r][8]=e[t+"8"],e[r][9]=e[t+"9"],e[r][10]=e[t+"10"],e[r][11]=e[t+"11"],e[r][12]=e[t+"12"],e[r][13]=e[t+"13"],e[r][14]=e[t+"0"],e[r][15]=e[t+"0"]}function ne(e){return e==qn||e==Hn||e==Wn||e==Vn}function ae(){this.eb=[],this.size=this.A=this.fb=0}function se(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ie(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ae,this.f.kb=new se,this.sd=null}function oe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function de(e,t){var r=e.T,a=t.ba.f.RGBA,s=a.eb,i=a.fb+e.ka*a.A,o=ga[t.ba.S],l=e.y,c=e.O,d=e.f,u=e.N,h=e.ea,f=e.W,m=t.cc,p=t.dc,g=t.Mc,x=t.Nc,b=e.ka,v=e.ka+e.T,y=e.U,w=y+1>>1;for(0==b?o(l,c,null,null,d,u,h,f,d,u,h,f,s,i,null,null,y):(o(t.ec,t.fc,l,c,m,p,g,x,d,u,h,f,s,i-a.A,s,i,y),++r);b+2<v;b+=2)m=d,p=u,g=h,x=f,u+=e.Rc,f+=e.Rc,i+=2*a.A,o(l,(c+=2*e.fa)-e.fa,l,c,m,p,g,x,d,u,h,f,s,i-a.A,s,i,y);return c+=e.fa,e.j+v<e.o?(n(t.ec,t.fc,l,c,y),n(t.cc,t.dc,d,u,w),n(t.Mc,t.Nc,h,f,w),r--):1&v||o(l,c,null,null,d,u,h,f,d,u,h,f,s,i+a.A,null,null,y),r}function ue(e,r,n){var a=e.F,s=[e.J];if(null!=a){var i=e.U,o=r.ba.S,l=o==Bn||o==Wn;r=r.ba.f.RGBA;var c=[0],d=e.ka;c[0]=e.T,e.Kb&&(0==d?--c[0]:(--d,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-d));var u=r.eb;d=r.fb+d*r.A,e=kn(a,s[0],e.width,i,c,u,d+(l?0:3),r.A),t(n==c),e&&ne(o)&&Nn(u,d,l,i,c,r.A)}return 0}function he(e){var t=e.ma,r=t.ba.S,n=11>r,a=r==Rn||r==Mn||r==Bn||r==Un||12==r||ne(r);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Fr(t.Oa,e,a?11:12))return 0;if(a&&ne(r)&&xr(),e.da)alert("todo:use_scaling");else{if(n){if(t.Ib=ce,e.Kb){if(r=e.U+1>>1,t.memory=s(e.U+2*r),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+r,t.Ib=de,xr()}}else alert("todo:EmitYUV");a&&(t.Jb=ue,n&&pr())}if(n&&!Ea){for(e=0;256>e;++e)La[e]=89858*(e-128)+Sa>>ka,Fa[e]=-22014*(e-128)+Sa,Oa[e]=-45773*(e-128),Pa[e]=113618*(e-128)+Sa>>ka;for(e=Aa;e<Ca;++e)t=76283*(e-16)+Sa>>ka,Ia[e-Aa]=Ve(t,255),Ra[e-Aa]=Ve(t+8>>4,15);Ea=1}return 1}function fe(e){var r=e.ma,n=e.U,a=e.T;return t(!(1&e.ka)),0>=n||0>=a?0:(n=r.Ib(e,r),null!=r.Jb&&r.Jb(e,r,n),r.Dc+=n,1)}function me(e){e.ma.memory=null}function pe(e,t,r,n){return 47!=v(e,8)?0:(t[0]=v(e,14)+1,r[0]=v(e,14)+1,n[0]=v(e,1),0!=v(e,3)?0:!e.h)}function ge(e,t){if(4>e)return e+1;var r=e-2>>1;return(2+(1&e)<<r)+v(t,r)+1}function xe(e,t){return 120<t?t-120:1<=(r=((r=Jn[t-1])>>4)*e+(8-(15&r)))?r:1;var r}function be(e,t,r){var n=N(r),a=e[t+=255&n].g-8;return 0<a&&(k(r,r.u+8),n=N(r),t+=e[t].value,t+=n&(1<<a)-1),k(r,r.u+e[t].g),e[t].value}function ve(e,r,n){return n.g+=e.g,n.value+=e.value<<r>>>0,t(8>=n.g),e.g}function ye(e,r,n){var a=e.xc;return t((r=0==a?0:e.vc[e.md*(n>>a)+(r>>a)])<e.Wb),e.Ya[r]}function we(e,r,a,s){var i=e.ab,o=e.c*r,l=e.C;r=l+r;var c=a,d=s;for(s=e.Ta,a=e.Ua;0<i--;){var u=e.gc[i],h=l,f=r,m=c,p=d,g=(d=s,c=a,u.Ea);switch(t(h<f),t(f<=u.nc),u.hc){case 2:Vr(m,p,(f-h)*g,d,c);break;case 0:var x=h,b=f,v=d,y=c,w=(A=u).Ea;0==x&&(Hr(m,p,null,null,1,v,y),V(m,p+1,0,0,w-1,v,y+1),p+=w,y+=w,++x);for(var N=1<<A.b,j=N-1,k=D(w,A.b),S=A.K,A=A.w+(x>>A.b)*k;x<b;){var C=S,_=A,T=1;for(Wr(m,p,v,y-w,1,v,y);T<w;){var E=(T&~j)+N;E>w&&(E=w),(0,$r[C[_++]>>8&15])(m,p+ +T,v,y+T-w,E-T,v,y+T),T=E}p+=w,y+=w,++x&j||(A+=k)}f!=u.nc&&n(d,c-g,d,c+(f-h-1)*g,g);break;case 1:for(g=m,b=p,w=(m=u.Ea)-(y=m&~(v=(p=1<<u.b)-1)),x=D(m,u.b),N=u.K,u=u.w+(h>>u.b)*x;h<f;){for(j=N,k=u,S=new U,A=b+y,C=b+m;b<A;)K(j[k++],S),Jr(S,g,b,p,d,c),b+=p,c+=p;b<C&&(K(j[k++],S),Jr(S,g,b,w,d,c),b+=w,c+=w),++h&v||(u+=x)}break;case 3:if(m==d&&p==c&&0<u.b){for(b=d,m=g=c+(f-h)*g-(y=(f-h)*D(u.Ea,u.b)),p=d,v=c,x=[],y=(w=y)-1;0<=y;--y)x[y]=p[v+y];for(y=w-1;0<=y;--y)b[m+y]=x[y];Gr(u,h,f,d,g,d,c)}else Gr(u,h,f,m,p,d,c)}c=s,d=a}d!=a&&n(s,a,c,d,o)}function Ne(e,r){var n=e.V,a=e.Ba+e.c*e.C,s=r-e.C;if(t(r<=e.l.o),t(16>=s),0<s){var i=e.l,o=e.Ta,l=e.Ua,c=i.width;if(we(e,s,n,a),s=l=[l],t((n=e.C)<(a=r)),t(i.v<i.va),a>i.o&&(a=i.o),n<i.j){var d=i.j-n;n=i.j,s[0]+=d*c}if(n>=a?n=0:(s[0]+=4*i.v,i.ka=n-i.j,i.U=i.va-i.v,i.T=a-n,n=1),n){if(l=l[0],11>(n=e.ca).S){var u=n.f.RGBA,h=(a=n.S,s=i.U,i=i.T,d=u.eb,u.A),f=i;for(u=u.fb+e.Ma*u.A;0<f--;){var m=o,p=l,g=s,x=d,b=u;switch(a){case In:Qr(m,p,g,x,b);break;case Rn:Zr(m,p,g,x,b);break;case qn:Zr(m,p,g,x,b),Nn(x,b,0,g,1,0);break;case Dn:rn(m,p,g,x,b);break;case Mn:te(m,p,g,x,b,1);break;case Hn:te(m,p,g,x,b,1),Nn(x,b,0,g,1,0);break;case Bn:te(m,p,g,x,b,0);break;case Wn:te(m,p,g,x,b,0),Nn(x,b,1,g,1,0);break;case Un:en(m,p,g,x,b);break;case Vn:en(m,p,g,x,b),jn(x,b,g,1,0);break;case zn:tn(m,p,g,x,b);break;default:t(0)}l+=c,u+=h}e.Ma+=i}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=n.height)}}e.C=r,t(e.C<=e.i)}function je(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var r=e.Ya[t].G,n=e.Ya[t].H;if(0<r[1][n[1]+0].g||0<r[2][n[2]+0].g||0<r[3][n[3]+0].g)return 0}return 1}function ke(e,r,n,a,s,i){if(0!=e.Z){var o=e.qd,l=e.rd;for(t(null!=pa[e.Z]);r<n;++r)pa[e.Z](o,l,a,s,a,s,i),o=a,l=s,s+=i;e.qd=o,e.rd=l}}function Se(e,r){var n=e.l.ma,a=0==n.Z||1==n.Z?e.l.j:e.C;if(a=e.C<a?a:e.C,t(r<=e.l.o),r>a){var s=e.l.width,i=n.ca,o=n.tb+s*a,l=e.V,c=e.Ba+e.c*a,d=e.gc;t(1==e.ab),t(3==d[0].hc),Yr(d[0],a,r,l,c,i,o),ke(n,a,r,i,o,s)}e.C=e.Ma=r}function Ae(e,r,n,a,s,i,o){var l=e.$/a,c=e.$%a,d=e.m,u=e.s,h=n+e.$,f=h;s=n+a*s;var m=n+a*i,p=280+u.ua,g=e.Pb?l:16777216,x=0<u.ua?u.Wa:null,b=u.wc,v=h<m?ye(u,c,l):null;t(e.C<i),t(m<=s);var y=!1;e:for(;;){for(;y||h<m;){var w=0;if(l>=g){var A=h-n;t((g=e).Pb),g.wd=g.m,g.xd=A,0<g.s.ua&&F(g.s.Wa,g.s.vb),g=l+Zn}if(c&b||(v=ye(u,c,l)),t(null!=v),v.Qb&&(r[h]=v.qb,y=!0),!y)if(S(d),v.jc){w=d,A=r;var C=h,_=v.pd[N(w)&Dr-1];t(v.jc),256>_.g?(k(w,w.u+_.g),A[C]=_.value,w=0):(k(w,w.u+_.g-256),t(256<=_.value),w=_.value),0==w&&(y=!0)}else w=be(v.G[0],v.H[0],d);if(d.h)break;if(y||256>w){if(!y)if(v.nd)r[h]=(v.qb|w<<8)>>>0;else{if(S(d),y=be(v.G[1],v.H[1],d),S(d),A=be(v.G[2],v.H[2],d),C=be(v.G[3],v.H[3],d),d.h)break;r[h]=(C<<24|y<<16|w<<8|A)>>>0}if(y=!1,++h,++c>=a&&(c=0,++l,null!=o&&l<=i&&!(l%16)&&o(e,l),null!=x))for(;f<h;)w=r[f++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else if(280>w){if(w=ge(w-256,d),A=be(v.G[4],v.H[4],d),S(d),A=xe(a,A=ge(A,d)),d.h)break;if(h-n<A||s-h<w)break e;for(C=0;C<w;++C)r[h+C]=r[h+C-A];for(h+=w,c+=w;c>=a;)c-=a,++l,null!=o&&l<=i&&!(l%16)&&o(e,l);if(t(h<=s),c&b&&(v=ye(u,c,l)),null!=x)for(;f<h;)w=r[f++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else{if(!(w<p))break e;for(y=w-280,t(null!=x);f<h;)w=r[f++],x.X[(506832829*w&4294967295)>>>x.Mb]=w;w=h,t(!(y>>>(A=x).Xa)),r[w]=A.X[y],y=!0}y||t(d.h==j(d))}if(e.Pb&&d.h&&h<s)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&F(e.s.vb,e.s.Wa);else{if(d.h)break e;null!=o&&o(e,l>i?i:l),e.a=0,e.$=h-n}return 1}return e.a=3,0}function Ce(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var r=e.Wa;null!=r&&(r.X=null),e.vb=null,t(null!=e)}function _e(){var t=new sr;return null==t?null:(t.a=0,t.xb=ma,re("Predictor","VP8LPredictors"),re("Predictor","VP8LPredictors_C"),re("PredictorAdd","VP8LPredictorsAdd"),re("PredictorAdd","VP8LPredictorsAdd_C"),Vr=G,Jr=Y,Qr=$,Zr=J,en=Q,tn=Z,rn=ee,e.VP8LMapColor32b=Kr,e.VP8LMapColor8b=Xr,t)}function Te(e,r,n,o,l){var c=1,h=[e],m=[r],p=o.m,g=o.s,x=null,b=0;e:for(;;){if(n)for(;c&&v(p,1);){var y=h,w=m,j=o,A=1,C=j.m,_=j.gc[j.ab],T=v(C,2);if(j.Oc&1<<T)c=0;else{switch(j.Oc|=1<<T,_.hc=T,_.Ea=y[0],_.nc=w[0],_.K=[null],++j.ab,t(4>=j.ab),T){case 0:case 1:_.b=v(C,3)+2,A=Te(D(_.Ea,_.b),D(_.nc,_.b),0,j,_.K),_.K=_.K[0];break;case 3:var E,L=v(C,8)+1,P=16<L?0:4<L?1:2<L?2:3;if(y[0]=D(_.Ea,P),_.b=P,E=A=Te(L,1,0,j,_.K)){var F,I=L,R=_,B=1<<(8>>R.b),U=s(B);if(null==U)E=0;else{var z=R.K[0],q=R.w;for(U[0]=R.K[0][0],F=1;F<1*I;++F)U[F]=M(z[q+F],U[F-1]);for(;F<4*B;++F)U[F]=0;R.K[0]=null,R.K[0]=U,E=1}}A=E;break;case 2:break;default:t(0)}c=A}}if(h=h[0],m=m[0],c&&v(p,1)&&!(c=1<=(b=v(p,4))&&11>=b)){o.a=3;break e}var H;if(H=c)t:{var W,V,G,K=o,Y=h,X=m,$=b,J=n,Q=K.m,Z=K.s,ee=[null],te=1,re=0,ne=Qn[$];r:for(;;){if(J&&v(Q,1)){var ae=v(Q,3)+2,se=D(Y,ae),ie=D(X,ae),oe=se*ie;if(!Te(se,ie,0,K,ee))break r;for(ee=ee[0],Z.xc=ae,W=0;W<oe;++W){var le=ee[W]>>8&65535;ee[W]=le,le>=te&&(te=le+1)}}if(Q.h)break r;for(V=0;5>V;++V){var ce=Yn[V];!V&&0<$&&(ce+=1<<$),re<ce&&(re=ce)}var de=i(te*ne,u),ue=te,he=i(ue,f);if(null==he)var fe=null;else t(65536>=ue),fe=he;var me=s(re);if(null==fe||null==me||null==de){K.a=1;break r}var pe=de;for(W=G=0;W<te;++W){var ge=fe[W],xe=ge.G,be=ge.H,ye=0,we=1,Ne=0;for(V=0;5>V;++V){ce=Yn[V],xe[V]=pe,be[V]=G,!V&&0<$&&(ce+=1<<$);n:{var je,ke=ce,Se=K,_e=me,Ee=pe,Le=G,Pe=0,Oe=Se.m,Fe=v(Oe,1);if(a(_e,0,0,ke),Fe){var Ie=v(Oe,1)+1,Re=v(Oe,1),De=v(Oe,0==Re?1:8);_e[De]=1,2==Ie&&(_e[De=v(Oe,8)]=1);var Me=1}else{var Be=s(19),Ue=v(Oe,4)+4;if(19<Ue){Se.a=3;var ze=0;break n}for(je=0;je<Ue;++je)Be[$n[je]]=v(Oe,3);var qe=void 0,He=void 0,We=Se,Ve=Be,Ge=ke,Ke=_e,Ye=0,Xe=We.m,$e=8,Je=i(128,u);a:for(;d(Je,0,7,Ve,19);){if(v(Xe,1)){var Qe=2+2*v(Xe,3);if((qe=2+v(Xe,Qe))>Ge)break a}else qe=Ge;for(He=0;He<Ge&&qe--;){S(Xe);var Ze=Je[0+(127&N(Xe))];k(Xe,Xe.u+Ze.g);var et=Ze.value;if(16>et)Ke[He++]=et,0!=et&&($e=et);else{var tt=16==et,rt=et-16,nt=Kn[rt],at=v(Xe,Gn[rt])+nt;if(He+at>Ge)break a;for(var st=tt?$e:0;0<at--;)Ke[He++]=st}}Ye=1;break a}Ye||(We.a=3),Me=Ye}(Me=Me&&!Oe.h)&&(Pe=d(Ee,Le,8,_e,ke)),Me&&0!=Pe?ze=Pe:(Se.a=3,ze=0)}if(0==ze)break r;if(we&&1==Xn[V]&&(we=0==pe[G].g),ye+=pe[G].g,G+=ze,3>=V){var it,ot=me[0];for(it=1;it<ce;++it)me[it]>ot&&(ot=me[it]);Ne+=ot}}if(ge.nd=we,ge.Qb=0,we&&(ge.qb=(xe[3][be[3]+0].value<<24|xe[1][be[1]+0].value<<16|xe[2][be[2]+0].value)>>>0,0==ye&&256>xe[0][be[0]+0].value&&(ge.Qb=1,ge.qb+=xe[0][be[0]+0].value<<8)),ge.jc=!ge.Qb&&6>Ne,ge.jc){var lt,ct=ge;for(lt=0;lt<Dr;++lt){var dt=lt,ut=ct.pd[dt],ht=ct.G[0][ct.H[0]+dt];256<=ht.value?(ut.g=ht.g+256,ut.value=ht.value):(ut.g=0,ut.value=0,dt>>=ve(ht,8,ut),dt>>=ve(ct.G[1][ct.H[1]+dt],16,ut),dt>>=ve(ct.G[2][ct.H[2]+dt],0,ut),ve(ct.G[3][ct.H[3]+dt],24,ut))}}}Z.vc=ee,Z.Wb=te,Z.Ya=fe,Z.yc=de,H=1;break t}H=0}if(!(c=H)){o.a=3;break e}if(0<b){if(g.ua=1<<b,!O(g.Wa,b)){o.a=1,c=0;break e}}else g.ua=0;var ft=o,mt=h,pt=m,gt=ft.s,xt=gt.xc;if(ft.c=mt,ft.i=pt,gt.md=D(mt,xt),gt.wc=0==xt?-1:(1<<xt)-1,n){o.xb=fa;break e}if(null==(x=s(h*m))){o.a=1,c=0;break e}c=(c=Ae(o,x,0,h,m,m,null))&&!p.h;break e}return c?(null!=l?l[0]=x:(t(null==x),t(n)),o.$=0,n||Ce(g)):Ce(g),c}function Ee(e,r){var n=e.c*e.i,a=n+r+16*r;return t(e.c<=r),e.V=s(a),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+n+r,1)}function Le(e,r){var n=e.C,a=r-n,s=e.V,i=e.Ba+e.c*n;for(t(r<=e.l.o);0<a;){var o=16<a?16:a,l=e.l.ma,c=e.l.width,d=c*o,u=l.ca,h=l.tb+c*n,f=e.Ta,m=e.Ua;we(e,o,s,i),Sn(f,m,u,h,d),ke(l,n,n+o,u,h,c),a-=o,s+=o*e.c,n+=o}t(n==r),e.C=e.Ma=r}function Pe(){this.ub=this.yd=this.td=this.Rb=0}function Oe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Fe(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ie(){this.Yb=function(){var e=[];return function e(t,r,n){for(var a=n[r],s=0;s<a&&(t.push(n.length>r+1?[]:0),!(n.length<r+1));s++)e(t[s],r+1,n)}(e,0,[3,11]),e}()}function Re(){this.jb=s(3),this.Wc=o([4,8],Ie),this.Xc=o([4,17],Ie)}function De(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Me(){this.ld=this.La=this.dd=this.tc=0}function Be(){this.Na=this.la=0}function Ue(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ze(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qe(){this.uc=this.M=this.Nb=0,this.wa=Array(new Me),this.Y=0,this.ya=Array(new ze),this.aa=0,this.l=new Ge}function He(){this.y=s(16),this.f=s(8),this.ea=s(8)}function We(){this.cb=this.a=0,this.sc="",this.m=new y,this.Od=new Pe,this.Kc=new Oe,this.ed=new De,this.Qa=new Fe,this.Ic=this.$c=this.Aa=0,this.D=new qe,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,y),this.ia=0,this.pb=i(4,Ue),this.Pa=new Re,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new He),this.Hd=0,this.rb=Array(new Be),this.sb=0,this.wa=Array(new Me),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ze),this.L=this.aa=0,this.gd=o([4,2],Me),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ve(e,t){return 0>e?0:e>t?t:e}function Ge(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ke(){var e=new We;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ra||(ra=Je)),e}function Ye(e,t,r){return 0==e.a&&(e.a=t,e.sc=r,e.cb=0),0}function Xe(e,t,r){return 3<=r&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function $e(e,r){if(null==e)return 0;if(e.a=0,e.sc="OK",null==r)return Ye(e,2,"null VP8Io passed to VP8GetHeaders()");var n=r.data,s=r.w,i=r.ha;if(4>i)return Ye(e,7,"Truncated header.");var o=n[s+0]|n[s+1]<<8|n[s+2]<<16,l=e.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return Ye(e,3,"Incorrect keyframe parameters.");if(!l.yd)return Ye(e,4,"Frame not displayable.");s+=3,i-=3;var c=e.Kc;if(l.Rb){if(7>i)return Ye(e,7,"cannot parse picture header");if(!Xe(n,s,i))return Ye(e,3,"Bad code word");c.c=16383&(n[s+4]<<8|n[s+3]),c.Td=n[s+4]>>6,c.i=16383&(n[s+6]<<8|n[s+5]),c.Ud=n[s+6]>>6,s+=7,i-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,r.width=c.c,r.height=c.i,r.Da=0,r.j=0,r.v=0,r.va=r.width,r.o=r.height,r.da=0,r.ib=r.width,r.hb=r.height,r.U=r.width,r.T=r.height,a((o=e.Pa).jb,0,255,o.jb.length),t(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,a(o.Zb,0,0,o.Zb.length),a(o.Lb,0,0,o.Lb)}if(l.ub>i)return Ye(e,7,"bad partition length");m(o=e.m,n,s,l.ub),s+=l.ub,i-=l.ub,l.Rb&&(c.Ld=C(o),c.Kd=C(o)),c=e.Qa;var d,u=e.Pa;if(t(null!=o),t(null!=c),c.Cb=C(o),c.Cb){if(c.Bb=C(o),C(o)){for(c.Fb=C(o),d=0;4>d;++d)c.Zb[d]=C(o)?g(o,7):0;for(d=0;4>d;++d)c.Lb[d]=C(o)?g(o,6):0}if(c.Bb)for(d=0;3>d;++d)u.jb[d]=C(o)?p(o,8):255}else c.Bb=0;if(o.Ka)return Ye(e,3,"cannot parse segment header");if((c=e.ed).zd=C(o),c.Tb=p(o,6),c.wb=p(o,3),c.Pc=C(o),c.Pc&&C(o)){for(u=0;4>u;++u)C(o)&&(c.vd[u]=g(o,6));for(u=0;4>u;++u)C(o)&&(c.od[u]=g(o,6))}if(e.L=0==c.Tb?0:c.zd?1:2,o.Ka)return Ye(e,3,"cannot parse filter header");var h=i;if(i=d=s,s=d+h,c=h,e.Xb=(1<<p(e.m,2))-1,h<3*(u=e.Xb))n=7;else{for(d+=3*u,c-=3*u,h=0;h<u;++h){var f=n[i+0]|n[i+1]<<8|n[i+2]<<16;f>c&&(f=c),m(e.Jc[+h],n,d,f),d+=f,c-=f,i+=3}m(e.Jc[+u],n,d,c),n=d<s?0:5}if(0!=n)return Ye(e,n,"cannot parse partitions");for(n=p(d=e.m,7),i=C(d)?g(d,4):0,s=C(d)?g(d,4):0,c=C(d)?g(d,4):0,u=C(d)?g(d,4):0,d=C(d)?g(d,4):0,h=e.Qa,f=0;4>f;++f){if(h.Cb){var x=h.Zb[f];h.Fb||(x+=n)}else{if(0<f){e.pb[f]=e.pb[0];continue}x=n}var b=e.pb[f];b.Sc[0]=ea[Ve(x+i,127)],b.Sc[1]=ta[Ve(x+0,127)],b.Eb[0]=2*ea[Ve(x+s,127)],b.Eb[1]=101581*ta[Ve(x+c,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=ea[Ve(x+u,117)],b.Qc[1]=ta[Ve(x+d,127)],b.lc=x+d}if(!l.Rb)return Ye(e,4,"Not a key frame.");for(C(o),l=e.Pa,n=0;4>n;++n){for(i=0;8>i;++i)for(s=0;3>s;++s)for(c=0;11>c;++c)u=_(o,la[n][i][s][c])?p(o,8):ia[n][i][s][c],l.Wc[n][i].Yb[s][c]=u;for(i=0;17>i;++i)l.Xc[n][i]=l.Wc[n][ca[i]]}return e.kc=C(o),e.kc&&(e.Bd=p(o,8)),e.cb=1}function Je(e,t,r,n,a,s,i){var o=t[a].Yb[r];for(r=0;16>a;++a){if(!_(e,o[r+0]))return a;for(;!_(e,o[r+1]);)if(o=t[++a].Yb[0],r=0,16==a)return 16;var l=t[a+1].Yb;if(_(e,o[r+2])){var c=e,d=0;if(_(c,(h=o)[(u=r)+3]))if(_(c,h[u+6])){for(o=0,u=2*(d=_(c,h[u+8]))+(h=_(c,h[u+9+d])),d=0,h=na[u];h[o];++o)d+=d+_(c,h[o]);d+=3+(8<<u)}else _(c,h[u+7])?(d=7+2*_(c,165),d+=_(c,145)):d=5+_(c,159);else d=_(c,h[u+4])?3+_(c,h[u+5]):2;o=l[2]}else d=1,o=l[1];l=i+aa[a],0>(c=e).b&&A(c);var u,h=c.b,f=(u=c.Ca>>1)-(c.I>>h)>>31;--c.b,c.Ca+=f,c.Ca|=1,c.I-=(u+1&f)<<h,s[l]=((d^f)-f)*n[(0<a)+0]}return 16}function Qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,a(e.zc,0,0,e.zc.length),e.ja=0}function Ze(e,t,r,n,a){a=e[t+r+32*n]+(a>>3),e[t+r+32*n]=-256&a?0>a?0:255:a}function et(e,t,r,n,a,s){Ze(e,t,0,r,n+a),Ze(e,t,1,r,n+s),Ze(e,t,2,r,n-s),Ze(e,t,3,r,n-a)}function tt(e){return(20091*e>>16)+e}function rt(e,t,r,n){var a,i=0,o=s(16);for(a=0;4>a;++a){var l=e[t+0]+e[t+8],c=e[t+0]-e[t+8],d=(35468*e[t+4]>>16)-tt(e[t+12]),u=tt(e[t+4])+(35468*e[t+12]>>16);o[i+0]=l+u,o[i+1]=c+d,o[i+2]=c-d,o[i+3]=l-u,i+=4,t++}for(a=i=0;4>a;++a)l=(e=o[i+0]+4)+o[i+8],c=e-o[i+8],d=(35468*o[i+4]>>16)-tt(o[i+12]),Ze(r,n,0,0,l+(u=tt(o[i+4])+(35468*o[i+12]>>16))),Ze(r,n,1,0,c+d),Ze(r,n,2,0,c-d),Ze(r,n,3,0,l-u),i++,n+=32}function nt(e,t,r,n){var a=e[t+0]+4,s=35468*e[t+4]>>16,i=tt(e[t+4]),o=35468*e[t+1]>>16;et(r,n,0,a+i,e=tt(e[t+1]),o),et(r,n,1,a+s,e,o),et(r,n,2,a-s,e,o),et(r,n,3,a-i,e,o)}function at(e,t,r,n,a){rt(e,t,r,n),a&&rt(e,t+16,r,n+4)}function st(e,t,r,n){an(e,t+0,r,n,1),an(e,t+32,r,n+128,1)}function it(e,t,r,n){var a;for(e=e[t+0]+4,a=0;4>a;++a)for(t=0;4>t;++t)Ze(r,n,t,a,e)}function ot(e,t,r,n){e[t+0]&&ln(e,t+0,r,n),e[t+16]&&ln(e,t+16,r,n+4),e[t+32]&&ln(e,t+32,r,n+128),e[t+48]&&ln(e,t+48,r,n+128+4)}function lt(e,t,r,n){var a,i=s(16);for(a=0;4>a;++a){var o=e[t+0+a]+e[t+12+a],l=e[t+4+a]+e[t+8+a],c=e[t+4+a]-e[t+8+a],d=e[t+0+a]-e[t+12+a];i[0+a]=o+l,i[8+a]=o-l,i[4+a]=d+c,i[12+a]=d-c}for(a=0;4>a;++a)o=(e=i[0+4*a]+3)+i[3+4*a],l=i[1+4*a]+i[2+4*a],c=i[1+4*a]-i[2+4*a],d=e-i[3+4*a],r[n+0]=o+l>>3,r[n+16]=d+c>>3,r[n+32]=o-l>>3,r[n+48]=d-c>>3,n+=64}function ct(e,t,r){var n,a=t-32,s=On,i=255-e[a-1];for(n=0;n<r;++n){var o,l=s,c=i+e[t-1];for(o=0;o<r;++o)e[t+o]=l[c+e[a+o]];t+=32}}function dt(e,t){ct(e,t,4)}function ut(e,t){ct(e,t,8)}function ht(e,t){ct(e,t,16)}function ft(e,t){var r;for(r=0;16>r;++r)n(e,t+32*r,e,t-32,16)}function mt(e,t){var r;for(r=16;0<r;--r)a(e,t,e[t-1],16),t+=32}function pt(e,t,r){var n;for(n=0;16>n;++n)a(t,r+32*n,e,16)}function gt(e,t){var r,n=16;for(r=0;16>r;++r)n+=e[t-1+32*r]+e[t+r-32];pt(n>>5,e,t)}function xt(e,t){var r,n=8;for(r=0;16>r;++r)n+=e[t-1+32*r];pt(n>>4,e,t)}function bt(e,t){var r,n=8;for(r=0;16>r;++r)n+=e[t+r-32];pt(n>>4,e,t)}function vt(e,t){pt(128,e,t)}function yt(e,t,r){return e+2*t+r+2>>2}function wt(e,t){var r,a=t-32;for(a=new Uint8Array([yt(e[a-1],e[a+0],e[a+1]),yt(e[a+0],e[a+1],e[a+2]),yt(e[a+1],e[a+2],e[a+3]),yt(e[a+2],e[a+3],e[a+4])]),r=0;4>r;++r)n(e,t+32*r,a,0,a.length)}function Nt(e,t){var r=e[t-1],n=e[t-1+32],a=e[t-1+64],s=e[t-1+96];T(e,t+0,16843009*yt(e[t-1-32],r,n)),T(e,t+32,16843009*yt(r,n,a)),T(e,t+64,16843009*yt(n,a,s)),T(e,t+96,16843009*yt(a,s,s))}function jt(e,t){var r,n=4;for(r=0;4>r;++r)n+=e[t+r-32]+e[t-1+32*r];for(n>>=3,r=0;4>r;++r)a(e,t+32*r,n,4)}function kt(e,t){var r=e[t-1+0],n=e[t-1+32],a=e[t-1+64],s=e[t-1-32],i=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+96]=yt(n,a,e[t-1+96]),e[t+1+96]=e[t+0+64]=yt(r,n,a),e[t+2+96]=e[t+1+64]=e[t+0+32]=yt(s,r,n),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=yt(i,s,r),e[t+3+64]=e[t+2+32]=e[t+1+0]=yt(o,i,s),e[t+3+32]=e[t+2+0]=yt(l,o,i),e[t+3+0]=yt(c,l,o)}function St(e,t){var r=e[t+1-32],n=e[t+2-32],a=e[t+3-32],s=e[t+4-32],i=e[t+5-32],o=e[t+6-32],l=e[t+7-32];e[t+0+0]=yt(e[t+0-32],r,n),e[t+1+0]=e[t+0+32]=yt(r,n,a),e[t+2+0]=e[t+1+32]=e[t+0+64]=yt(n,a,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=yt(a,s,i),e[t+3+32]=e[t+2+64]=e[t+1+96]=yt(s,i,o),e[t+3+64]=e[t+2+96]=yt(i,o,l),e[t+3+96]=yt(o,l,l)}function At(e,t){var r=e[t-1+0],n=e[t-1+32],a=e[t-1+64],s=e[t-1-32],i=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=s+i+1>>1,e[t+1+0]=e[t+2+64]=i+o+1>>1,e[t+2+0]=e[t+3+64]=o+l+1>>1,e[t+3+0]=l+c+1>>1,e[t+0+96]=yt(a,n,r),e[t+0+64]=yt(n,r,s),e[t+0+32]=e[t+1+96]=yt(r,s,i),e[t+1+32]=e[t+2+96]=yt(s,i,o),e[t+2+32]=e[t+3+96]=yt(i,o,l),e[t+3+32]=yt(o,l,c)}function Ct(e,t){var r=e[t+0-32],n=e[t+1-32],a=e[t+2-32],s=e[t+3-32],i=e[t+4-32],o=e[t+5-32],l=e[t+6-32],c=e[t+7-32];e[t+0+0]=r+n+1>>1,e[t+1+0]=e[t+0+64]=n+a+1>>1,e[t+2+0]=e[t+1+64]=a+s+1>>1,e[t+3+0]=e[t+2+64]=s+i+1>>1,e[t+0+32]=yt(r,n,a),e[t+1+32]=e[t+0+96]=yt(n,a,s),e[t+2+32]=e[t+1+96]=yt(a,s,i),e[t+3+32]=e[t+2+96]=yt(s,i,o),e[t+3+64]=yt(i,o,l),e[t+3+96]=yt(o,l,c)}function _t(e,t){var r=e[t-1+0],n=e[t-1+32],a=e[t-1+64],s=e[t-1+96];e[t+0+0]=r+n+1>>1,e[t+2+0]=e[t+0+32]=n+a+1>>1,e[t+2+32]=e[t+0+64]=a+s+1>>1,e[t+1+0]=yt(r,n,a),e[t+3+0]=e[t+1+32]=yt(n,a,s),e[t+3+32]=e[t+1+64]=yt(a,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function Tt(e,t){var r=e[t-1+0],n=e[t-1+32],a=e[t-1+64],s=e[t-1+96],i=e[t-1-32],o=e[t+0-32],l=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=r+i+1>>1,e[t+0+32]=e[t+2+64]=n+r+1>>1,e[t+0+64]=e[t+2+96]=a+n+1>>1,e[t+0+96]=s+a+1>>1,e[t+3+0]=yt(o,l,c),e[t+2+0]=yt(i,o,l),e[t+1+0]=e[t+3+32]=yt(r,i,o),e[t+1+32]=e[t+3+64]=yt(n,r,i),e[t+1+64]=e[t+3+96]=yt(a,n,r),e[t+1+96]=yt(s,a,n)}function Et(e,t){var r;for(r=0;8>r;++r)n(e,t+32*r,e,t-32,8)}function Lt(e,t){var r;for(r=0;8>r;++r)a(e,t,e[t-1],8),t+=32}function Pt(e,t,r){var n;for(n=0;8>n;++n)a(t,r+32*n,e,8)}function Ot(e,t){var r,n=8;for(r=0;8>r;++r)n+=e[t+r-32]+e[t-1+32*r];Pt(n>>4,e,t)}function Ft(e,t){var r,n=4;for(r=0;8>r;++r)n+=e[t+r-32];Pt(n>>3,e,t)}function It(e,t){var r,n=4;for(r=0;8>r;++r)n+=e[t-1+32*r];Pt(n>>3,e,t)}function Rt(e,t){Pt(128,e,t)}function Dt(e,t,r){var n=e[t-r],a=e[t+0],s=3*(a-n)+Ln[1020+e[t-2*r]-e[t+r]],i=Pn[112+(s+4>>3)];e[t-r]=On[255+n+Pn[112+(s+3>>3)]],e[t+0]=On[255+a-i]}function Mt(e,t,r,n){var a=e[t+0],s=e[t+r];return Fn[255+e[t-2*r]-e[t-r]]>n||Fn[255+s-a]>n}function Bt(e,t,r,n){return 4*Fn[255+e[t-r]-e[t+0]]+Fn[255+e[t-2*r]-e[t+r]]<=n}function Ut(e,t,r,n,a){var s=e[t-3*r],i=e[t-2*r],o=e[t-r],l=e[t+0],c=e[t+r],d=e[t+2*r],u=e[t+3*r];return 4*Fn[255+o-l]+Fn[255+i-c]>n?0:Fn[255+e[t-4*r]-s]<=a&&Fn[255+s-i]<=a&&Fn[255+i-o]<=a&&Fn[255+u-d]<=a&&Fn[255+d-c]<=a&&Fn[255+c-l]<=a}function zt(e,t,r,n){var a=2*n+1;for(n=0;16>n;++n)Bt(e,t+n,r,a)&&Dt(e,t+n,r)}function qt(e,t,r,n){var a=2*n+1;for(n=0;16>n;++n)Bt(e,t+n*r,1,a)&&Dt(e,t+n*r,1)}function Ht(e,t,r,n){var a;for(a=3;0<a;--a)zt(e,t+=4*r,r,n)}function Wt(e,t,r,n){var a;for(a=3;0<a;--a)qt(e,t+=4,r,n)}function Vt(e,t,r,n,a,s,i,o){for(s=2*s+1;0<a--;){if(Ut(e,t,r,s,i))if(Mt(e,t,r,o))Dt(e,t,r);else{var l=e,c=t,d=r,u=l[c-2*d],h=l[c-d],f=l[c+0],m=l[c+d],p=l[c+2*d],g=27*(b=Ln[1020+3*(f-h)+Ln[1020+u-m]])+63>>7,x=18*b+63>>7,b=9*b+63>>7;l[c-3*d]=On[255+l[c-3*d]+b],l[c-2*d]=On[255+u+x],l[c-d]=On[255+h+g],l[c+0]=On[255+f-g],l[c+d]=On[255+m-x],l[c+2*d]=On[255+p-b]}t+=n}}function Gt(e,t,r,n,a,s,i,o){for(s=2*s+1;0<a--;){if(Ut(e,t,r,s,i))if(Mt(e,t,r,o))Dt(e,t,r);else{var l=e,c=t,d=r,u=l[c-d],h=l[c+0],f=l[c+d],m=Pn[112+(4+(p=3*(h-u))>>3)],p=Pn[112+(p+3>>3)],g=m+1>>1;l[c-2*d]=On[255+l[c-2*d]+g],l[c-d]=On[255+u+p],l[c+0]=On[255+h-m],l[c+d]=On[255+f-g]}t+=n}}function Kt(e,t,r,n,a,s){Vt(e,t,r,1,16,n,a,s)}function Yt(e,t,r,n,a,s){Vt(e,t,1,r,16,n,a,s)}function Xt(e,t,r,n,a,s){var i;for(i=3;0<i;--i)Gt(e,t+=4*r,r,1,16,n,a,s)}function $t(e,t,r,n,a,s){var i;for(i=3;0<i;--i)Gt(e,t+=4,1,r,16,n,a,s)}function Jt(e,t,r,n,a,s,i,o){Vt(e,t,a,1,8,s,i,o),Vt(r,n,a,1,8,s,i,o)}function Qt(e,t,r,n,a,s,i,o){Vt(e,t,1,a,8,s,i,o),Vt(r,n,1,a,8,s,i,o)}function Zt(e,t,r,n,a,s,i,o){Gt(e,t+4*a,a,1,8,s,i,o),Gt(r,n+4*a,a,1,8,s,i,o)}function er(e,t,r,n,a,s,i,o){Gt(e,t+4,1,a,8,s,i,o),Gt(r,n+4,1,a,8,s,i,o)}function tr(){this.ba=new ie,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function nr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ar(){this.ua=0,this.Wa=new I,this.vb=new I,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new f,this.yc=new u}function sr(){this.xb=this.a=0,this.l=new Ge,this.ca=new ie,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ar,this.ab=0,this.gc=i(4,nr),this.Oc=0}function ir(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ge,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function or(e,t,r,n,a,s,i){for(e=null==e?0:e[t+0],t=0;t<i;++t)a[s+t]=e+r[n+t]&255,e=a[s+t]}function lr(e,t,r,n,a,s,i){var o;if(null==e)or(null,null,r,n,a,s,i);else for(o=0;o<i;++o)a[s+o]=e[t+o]+r[n+o]&255}function cr(e,t,r,n,a,s,i){if(null==e)or(null,null,r,n,a,s,i);else{var o,l=e[t+0],c=l,d=l;for(o=0;o<i;++o)c=d+(l=e[t+o])-c,d=r[n+o]+(-256&c?0>c?0:255:c)&255,c=l,a[s+o]=d}}function dr(e,r,a,i){var o=r.width,l=r.o;if(t(null!=e&&null!=r),0>a||0>=i||a+i>l)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new ir,(c=null==e.ga)||(c=r.width*r.o,t(0==e.Gb.length),e.Gb=s(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var d=e.Fa,u=e.P,h=e.qc,f=e.mb,m=e.nb,p=u+1,g=h-1,b=c.l;if(t(null!=d&&null!=f&&null!=r),pa[0]=null,pa[1]=or,pa[2]=lr,pa[3]=cr,c.ca=f,c.tb=m,c.c=r.width,c.i=r.height,t(0<c.c&&0<c.i),1>=h)r=0;else if(c.$a=3&d[u+0],c.Z=d[u+0]>>2&3,c.Lc=d[u+0]>>4&3,u=d[u+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||u)r=0;else if(b.put=fe,b.ac=he,b.bc=me,b.ma=c,b.width=r.width,b.height=r.height,b.Da=r.Da,b.v=r.v,b.va=r.va,b.j=r.j,b.o=r.o,c.$a)e:{t(1==c.$a),r=_e();t:for(;;){if(null==r){r=0;break e}if(t(null!=c),c.mc=r,r.c=c.c,r.i=c.i,r.l=c.l,r.l.ma=c,r.l.width=c.c,r.l.height=c.i,r.a=0,x(r.m,d,p,g),!Te(c.c,c.i,1,r,null))break t;if(1==r.ab&&3==r.gc[0].hc&&je(r.s)?(c.ic=1,d=r.c*r.i,r.Ta=null,r.Ua=0,r.V=s(d),r.Ba=0,null==r.V?(r.a=1,r=0):r=1):(c.ic=0,r=Ee(r,c.c)),!r)break t;r=1;break e}c.mc=null,r=0}else r=g>=c.c*c.i;c=!r}if(c)return null;1!=e.ga.Lc?e.Ga=0:i=l-a}t(null!=e.ga),t(a+i<=l);e:{if(r=(d=e.ga).c,l=d.l.o,0==d.$a){if(p=e.rc,g=e.Vc,b=e.Fa,u=e.P+1+a*r,h=e.mb,f=e.nb+a*r,t(u<=e.P+e.qc),0!=d.Z)for(t(null!=pa[d.Z]),c=0;c<i;++c)pa[d.Z](p,g,b,u,h,f,r),p=h,g=f,f+=r,u+=r;else for(c=0;c<i;++c)n(h,f,b,u,r),p=h,g=f,f+=r,u+=r;e.rc=p,e.Vc=g}else{if(t(null!=d.mc),r=a+i,t(null!=(c=d.mc)),t(r<=c.i),c.C>=r)r=1;else if(d.ic||pr(),d.ic){d=c.V,p=c.Ba,g=c.c;var v=c.i,y=(b=1,u=c.$/g,h=c.$%g,f=c.m,m=c.s,c.$),w=g*v,N=g*r,k=m.wc,A=y<N?ye(m,h,u):null;t(y<=w),t(r<=v),t(je(m));t:for(;;){for(;!f.h&&y<N;){if(h&k||(A=ye(m,h,u)),t(null!=A),S(f),256>(v=be(A.G[0],A.H[0],f)))d[p+y]=v,++y,++h>=g&&(h=0,++u<=r&&!(u%16)&&Se(c,u));else{if(!(280>v)){b=0;break t}v=ge(v-256,f);var C,_=be(A.G[4],A.H[4],f);if(S(f),!(y>=(_=xe(g,_=ge(_,f)))&&w-y>=v)){b=0;break t}for(C=0;C<v;++C)d[p+y+C]=d[p+y+C-_];for(y+=v,h+=v;h>=g;)h-=g,++u<=r&&!(u%16)&&Se(c,u);y<N&&h&k&&(A=ye(m,h,u))}t(f.h==j(f))}Se(c,u>r?r:u);break t}!b||f.h&&y<w?(b=0,c.a=f.h?5:3):c.$=y,r=b}else r=Ae(c,c.V,c.Ba,c.c,c.i,r,Le);if(!r){i=0;break e}}a+i>=l&&(e.Cc=1),i=1}if(!i)return null;if(e.Cc&&(null!=(i=e.ga)&&(i.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+a*o}function ur(e,t,r,n,a,s){for(;0<a--;){var i,o=e,l=t+(r?1:0),c=e,d=t+(r?0:3);for(i=0;i<n;++i){var u=c[d+4*i];255!=u&&(u*=32897,o[l+4*i+0]=o[l+4*i+0]*u>>23,o[l+4*i+1]=o[l+4*i+1]*u>>23,o[l+4*i+2]=o[l+4*i+2]*u>>23)}t+=s}}function hr(e,t,r,n,a){for(;0<n--;){var s;for(s=0;s<r;++s){var i=e[t+2*s+0],o=15&(c=e[t+2*s+1]),l=4369*o,c=(240&c|c>>4)*l>>16;e[t+2*s+0]=(240&i|i>>4)*l>>16&240|(15&i|i<<4)*l>>16>>4&15,e[t+2*s+1]=240&c|o}t+=a}}function fr(e,t,r,n,a,s,i,o){var l,c,d=255;for(c=0;c<a;++c){for(l=0;l<n;++l){var u=e[t+l];s[i+4*l]=u,d&=u}t+=r,i+=o}return 255!=d}function mr(e,t,r,n,a){var s;for(s=0;s<a;++s)r[n+s]=e[t+s]>>8}function pr(){Nn=ur,jn=hr,kn=fr,Sn=mr}function gr(r,n,a){e[r]=function(e,r,s,i,o,l,c,d,u,h,f,m,p,g,x,b,v){var y,w=v-1>>1,N=o[l+0]|c[d+0]<<16,j=u[h+0]|f[m+0]<<16;t(null!=e);var k=3*N+j+131074>>2;for(n(e[r+0],255&k,k>>16,p,g),null!=s&&(k=3*j+N+131074>>2,n(s[i+0],255&k,k>>16,x,b)),y=1;y<=w;++y){var S=o[l+y]|c[d+y]<<16,A=u[h+y]|f[m+y]<<16,C=N+S+j+A+524296,_=C+2*(S+j)>>3;k=_+N>>1,N=(C=C+2*(N+A)>>3)+S>>1,n(e[r+2*y-1],255&k,k>>16,p,g+(2*y-1)*a),n(e[r+2*y-0],255&N,N>>16,p,g+(2*y-0)*a),null!=s&&(k=C+j>>1,N=_+A>>1,n(s[i+2*y-1],255&k,k>>16,x,b+(2*y-1)*a),n(s[i+2*y+0],255&N,N>>16,x,b+(2*y+0)*a)),N=S,j=A}1&v||(k=3*N+j+131074>>2,n(e[r+v-1],255&k,k>>16,p,g+(v-1)*a),null!=s&&(k=3*j+N+131074>>2,n(s[i+v-1],255&k,k>>16,x,b+(v-1)*a)))}}function xr(){ga[In]=xa,ga[Rn]=va,ga[Dn]=ba,ga[Mn]=ya,ga[Bn]=wa,ga[Un]=Na,ga[zn]=ja,ga[qn]=va,ga[Hn]=ya,ga[Wn]=wa,ga[Vn]=Na}function br(e){return e&~Ta?0>e?0:255:e>>_a}function vr(e,t){return br((19077*e>>8)+(26149*t>>8)-14234)}function yr(e,t,r){return br((19077*e>>8)-(6419*t>>8)-(13320*r>>8)+8708)}function wr(e,t){return br((19077*e>>8)+(33050*t>>8)-17685)}function Nr(e,t,r,n,a){n[a+0]=vr(e,r),n[a+1]=yr(e,t,r),n[a+2]=wr(e,t)}function jr(e,t,r,n,a){n[a+0]=wr(e,t),n[a+1]=yr(e,t,r),n[a+2]=vr(e,r)}function kr(e,t,r,n,a){var s=yr(e,t,r);t=s<<3&224|wr(e,t)>>3,n[a+0]=248&vr(e,r)|s>>5,n[a+1]=t}function Sr(e,t,r,n,a){var s=240&wr(e,t)|15;n[a+0]=240&vr(e,r)|yr(e,t,r)>>4,n[a+1]=s}function Ar(e,t,r,n,a){n[a+0]=255,Nr(e,t,r,n,a+1)}function Cr(e,t,r,n,a){jr(e,t,r,n,a),n[a+3]=255}function _r(e,t,r,n,a){Nr(e,t,r,n,a),n[a+3]=255}function Tr(t,r,n){e[t]=function(e,t,a,s,i,o,l,c,d){for(var u=c+(-2&d)*n;c!=u;)r(e[t+0],a[s+0],i[o+0],l,c),r(e[t+1],a[s+0],i[o+0],l,c+n),t+=2,++s,++o,c+=2*n;1&d&&r(e[t+0],a[s+0],i[o+0],l,c)}}function Er(e,t,r){return 0==r?0==e?0==t?6:5:0==t?4:0:r}function Lr(e,t,r,n,a){switch(e>>>30){case 3:an(t,r,n,a,0);break;case 2:sn(t,r,n,a);break;case 1:ln(t,r,n,a)}}function Pr(e,t){var r,s,i=t.M,o=t.Nb,l=e.oc,c=e.pc+40,d=e.oc,u=e.pc+584,h=e.oc,f=e.pc+600;for(r=0;16>r;++r)l[c+32*r-1]=129;for(r=0;8>r;++r)d[u+32*r-1]=129,h[f+32*r-1]=129;for(0<i?l[c-1-32]=d[u-1-32]=h[f-1-32]=129:(a(l,c-32-1,127,21),a(d,u-32-1,127,9),a(h,f-32-1,127,9)),s=0;s<e.za;++s){var m=t.ya[t.aa+s];if(0<s){for(r=-1;16>r;++r)n(l,c+32*r-4,l,c+32*r+12,4);for(r=-1;8>r;++r)n(d,u+32*r-4,d,u+32*r+4,4),n(h,f+32*r-4,h,f+32*r+4,4)}var p=e.Gd,g=e.Hd+s,x=m.ad,b=m.Hc;if(0<i&&(n(l,c-32,p[g].y,0,16),n(d,u-32,p[g].f,0,8),n(h,f-32,p[g].ea,0,8)),m.Za){var v=l,y=c-32+16;for(0<i&&(s>=e.za-1?a(v,y,p[g].y[15],4):n(v,y,p[g+1].y,0,4)),r=0;4>r;r++)v[y+128+r]=v[y+256+r]=v[y+384+r]=v[y+0+r];for(r=0;16>r;++r,b<<=2)v=l,y=c+Da[r],ua[m.Ob[r]](v,y),Lr(b,x,16*+r,v,y)}else if(v=Er(s,i,m.Ob[0]),da[v](l,c),0!=b)for(r=0;16>r;++r,b<<=2)Lr(b,x,16*+r,l,c+Da[r]);for(r=m.Gc,v=Er(s,i,m.Dd),ha[v](d,u),ha[v](h,f),b=x,v=d,y=u,255&(m=0|r)&&(170&m?on(b,256,v,y):cn(b,256,v,y)),m=h,b=f,255&(r>>=8)&&(170&r?on(x,320,m,b):cn(x,320,m,b)),i<e.Ub-1&&(n(p[g].y,0,l,c+480,16),n(p[g].f,0,d,u+224,8),n(p[g].ea,0,h,f+224,8)),r=8*o*e.B,p=e.sa,g=e.ta+16*s+16*o*e.R,x=e.qa,m=e.ra+8*s+r,b=e.Ha,v=e.Ia+8*s+r,r=0;16>r;++r)n(p,g+r*e.R,l,c+32*r,16);for(r=0;8>r;++r)n(x,m+r*e.B,d,u+32*r,8),n(b,v+r*e.B,h,f+32*r,8)}}function Or(e,n,a,s,i,o,l,c,d){var u=[0],h=[0],f=0,m=null!=d?d.kd:0,p=null!=d?d:new rr;if(null==e||12>a)return 7;p.data=e,p.w=n,p.ha=a,n=[n],a=[a],p.gb=[p.gb];e:{var g=n,b=a,v=p.gb;if(t(null!=e),t(null!=b),t(null!=v),v[0]=0,12<=b[0]&&!r(e,g[0],"RIFF")){if(r(e,g[0]+8,"WEBP")){v=3;break e}var y=P(e,g[0]+4);if(12>y||4294967286<y){v=3;break e}if(m&&y>b[0]-8){v=7;break e}v[0]=y,g[0]+=12,b[0]-=12}v=0}if(0!=v)return v;for(y=0<p.gb[0],a=a[0];;){e:{var N=e;b=n,v=a;var j=u,k=h,S=g=[0];if((_=f=[f])[0]=0,8>v[0])v=7;else{if(!r(N,b[0],"VP8X")){if(10!=P(N,b[0]+4)){v=3;break e}if(18>v[0]){v=7;break e}var A=P(N,b[0]+8),C=1+L(N,b[0]+12);if(2147483648<=C*(N=1+L(N,b[0]+15))){v=3;break e}null!=S&&(S[0]=A),null!=j&&(j[0]=C),null!=k&&(k[0]=N),b[0]+=18,v[0]-=18,_[0]=1}v=0}}if(f=f[0],g=g[0],0!=v)return v;if(b=!!(2&g),!y&&f)return 3;if(null!=o&&(o[0]=!!(16&g)),null!=l&&(l[0]=b),null!=c&&(c[0]=0),l=u[0],g=h[0],f&&b&&null==d){v=0;break}if(4>a){v=7;break}if(y&&f||!y&&!f&&!r(e,n[0],"ALPH")){a=[a],p.na=[p.na],p.P=[p.P],p.Sa=[p.Sa];e:{A=e,v=n,y=a;var _=p.gb;j=p.na,k=p.P,S=p.Sa,C=22,t(null!=A),t(null!=y),N=v[0];var T=y[0];for(t(null!=j),t(null!=S),j[0]=null,k[0]=null,S[0]=0;;){if(v[0]=N,y[0]=T,8>T){v=7;break e}var E=P(A,N+4);if(4294967286<E){v=3;break e}var O=8+E+1&-2;if(C+=O,0<_&&C>_){v=3;break e}if(!r(A,N,"VP8 ")||!r(A,N,"VP8L")){v=0;break e}if(T[0]<O){v=7;break e}r(A,N,"ALPH")||(j[0]=A,k[0]=N+8,S[0]=E),N+=O,T-=O}}if(a=a[0],p.na=p.na[0],p.P=p.P[0],p.Sa=p.Sa[0],0!=v)break}a=[a],p.Ja=[p.Ja],p.xa=[p.xa];e:if(_=e,v=n,y=a,j=p.gb[0],k=p.Ja,S=p.xa,A=v[0],N=!r(_,A,"VP8 "),C=!r(_,A,"VP8L"),t(null!=_),t(null!=y),t(null!=k),t(null!=S),8>y[0])v=7;else{if(N||C){if(_=P(_,A+4),12<=j&&_>j-12){v=3;break e}if(m&&_>y[0]-8){v=7;break e}k[0]=_,v[0]+=8,y[0]-=8,S[0]=C}else S[0]=5<=y[0]&&47==_[A+0]&&!(_[A+4]>>5),k[0]=y[0];v=0}if(a=a[0],p.Ja=p.Ja[0],p.xa=p.xa[0],n=n[0],0!=v)break;if(4294967286<p.Ja)return 3;if(null==c||b||(c[0]=p.xa?2:1),l=[l],g=[g],p.xa){if(5>a){v=7;break}c=l,m=g,b=o,null==e||5>a?e=0:5<=a&&47==e[n+0]&&!(e[n+4]>>5)?(y=[0],_=[0],j=[0],x(k=new w,e,n,a),pe(k,y,_,j)?(null!=c&&(c[0]=y[0]),null!=m&&(m[0]=_[0]),null!=b&&(b[0]=j[0]),e=1):e=0):e=0}else{if(10>a){v=7;break}c=g,null==e||10>a||!Xe(e,n+3,a-3)?e=0:(m=e[n+0]|e[n+1]<<8|e[n+2]<<16,b=16383&(e[n+7]<<8|e[n+6]),e=16383&(e[n+9]<<8|e[n+8]),1&m||3<(m>>1&7)||!(m>>4&1)||m>>5>=p.Ja||!b||!e?e=0:(l&&(l[0]=b),c&&(c[0]=e),e=1))}if(!e)return 3;if(l=l[0],g=g[0],f&&(u[0]!=l||h[0]!=g))return 3;null!=d&&(d[0]=p,d.offset=n-d.w,t(4294967286>n-d.w),t(d.offset==d.ha-a));break}return 0==v||7==v&&f&&null==d?(null!=o&&(o[0]|=null!=p.na&&0<p.na.length),null!=s&&(s[0]=l),null!=i&&(i[0]=g),0):v}function Fr(e,t,r){var n=t.width,a=t.height,s=0,i=0,o=n,l=a;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,l=e.bd,s=e.v,i=e.j,11>r||(s&=-2,i&=-2),0>s||0>i||0>=o||0>=l||s+o>n||i+l>a))return 0;if(t.v=s,t.j=i,t.va=s+o,t.o=i+l,t.U=o,t.T=l,t.da=null!=e&&0<e.da,t.da){if(!R(o,l,r=[e.ib],s=[e.hb]))return 0;t.ib=r[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*n/4&&t.hb<3*a/4,t.Kb=0),1}function Ir(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Rr(e,t,r,n){if(null==n||0>=e||0>=t)return 2;if(null!=r){if(r.Da){var a=r.cd,i=r.bd,o=-2&r.v,l=-2&r.j;if(0>o||0>l||0>=a||0>=i||o+a>e||l+i>t)return 2;e=a,t=i}if(r.da){if(!R(e,t,a=[r.ib],i=[r.hb]))return 2;e=a[0],t=i[0]}}n.width=e,n.height=t;e:{var c=n.width,d=n.height;if(e=n.S,0>=c||0>=d||!(e>=In&&13>e))e=2;else{if(0>=n.Rd&&null==n.sd){o=i=a=t=0;var u=(l=c*Ua[e])*d;if(11>e||(i=(d+1)/2*(t=(c+1)/2),12==e&&(o=(a=c)*d)),null==(d=s(u+2*i+o))){e=1;break e}n.sd=d,11>e?((c=n.f.RGBA).eb=d,c.fb=0,c.A=l,c.size=u):((c=n.f.kb).y=d,c.O=0,c.fa=l,c.Fd=u,c.f=d,c.N=0+u,c.Ab=t,c.Cd=i,c.ea=d,c.W=0+u+i,c.Db=t,c.Ed=i,12==e&&(c.F=d,c.J=0+u+2*i),c.Tc=o,c.lb=a)}if(t=1,a=n.S,i=n.width,o=n.height,a>=In&&13>a)if(11>a)e=n.f.RGBA,t&=(l=Math.abs(e.A))*(o-1)+i<=e.size,t&=l>=i*Ua[a],t&=null!=e.eb;else{e=n.f.kb,l=(i+1)/2,u=(o+1)/2,c=Math.abs(e.fa),d=Math.abs(e.Ab);var h=Math.abs(e.Db),f=Math.abs(e.lb),m=f*(o-1)+i;t&=c*(o-1)+i<=e.Fd,t&=d*(u-1)+l<=e.Cd,t=(t&=h*(u-1)+l<=e.Ed)&c>=i&d>=l&h>=l,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==a&&(t&=f>=i,t&=m<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=r&&r.fd&&(e=Ir(n)),e}var Dr=64,Mr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Br=24,Ur=32,zr=8,qr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,r){return t[r+0]},e.Predictor3=function(e,t,r){return t[r+1]},e.Predictor4=function(e,t,r){return t[r-1]},e.Predictor5=function(e,t,r){return z(z(e,t[r+1]),t[r+0])},e.Predictor6=function(e,t,r){return z(e,t[r-1])},e.Predictor7=function(e,t,r){return z(e,t[r+0])},e.Predictor8=function(e,t,r){return z(t[r-1],t[r+0])},e.Predictor9=function(e,t,r){return z(t[r+0],t[r+1])},e.Predictor10=function(e,t,r){return z(z(e,t[r-1]),z(t[r+0],t[r+1]))},e.Predictor11=function(e,t,r){var n=t[r+0];return 0>=W(n>>24&255,e>>24&255,(t=t[r-1])>>24&255)+W(n>>16&255,e>>16&255,t>>16&255)+W(n>>8&255,e>>8&255,t>>8&255)+W(255&n,255&e,255&t)?n:e},e.Predictor12=function(e,t,r){var n=t[r+0];return(q((e>>24&255)+(n>>24&255)-((t=t[r-1])>>24&255))<<24|q((e>>16&255)+(n>>16&255)-(t>>16&255))<<16|q((e>>8&255)+(n>>8&255)-(t>>8&255))<<8|q((255&e)+(255&n)-(255&t)))>>>0},e.Predictor13=function(e,t,r){var n=t[r-1];return(H((e=z(e,t[r+0]))>>24&255,n>>24&255)<<24|H(e>>16&255,n>>16&255)<<16|H(e>>8&255,n>>8&255)<<8|H(255&e,255&n))>>>0};var Hr=e.PredictorAdd0;e.PredictorAdd1=V,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var Wr=e.PredictorAdd2;X("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),X("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Vr,Gr=e.ColorIndexInverseTransform,Kr=e.MapARGB,Yr=e.VP8LColorIndexInverseTransformAlpha,Xr=e.MapAlpha,$r=e.VP8LPredictorsAdd=[];$r.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Jr,Qr,Zr,en,tn,rn,nn,an,sn,on,ln,cn,dn,un,hn,fn,mn,pn,gn,xn,bn,vn,yn,wn,Nn,jn,kn,Sn,An=s(511),Cn=s(2041),_n=s(225),Tn=s(767),En=0,Ln=Cn,Pn=_n,On=Tn,Fn=An,In=0,Rn=1,Dn=2,Mn=3,Bn=4,Un=5,zn=6,qn=7,Hn=8,Wn=9,Vn=10,Gn=[2,3,7],Kn=[3,3,11],Yn=[280,256,256,256,40],Xn=[0,1,1,1,0],$n=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Jn=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Qn=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Zn=8,ea=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ta=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ra=null,na=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],aa=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],sa=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ia=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],oa=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],la=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ca=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],da=[],ua=[],ha=[],fa=1,ma=2,pa=[],ga=[];gr("UpsampleRgbLinePair",Nr,3),gr("UpsampleBgrLinePair",jr,3),gr("UpsampleRgbaLinePair",_r,4),gr("UpsampleBgraLinePair",Cr,4),gr("UpsampleArgbLinePair",Ar,4),gr("UpsampleRgba4444LinePair",Sr,2),gr("UpsampleRgb565LinePair",kr,2);var xa=e.UpsampleRgbLinePair,ba=e.UpsampleBgrLinePair,va=e.UpsampleRgbaLinePair,ya=e.UpsampleBgraLinePair,wa=e.UpsampleArgbLinePair,Na=e.UpsampleRgba4444LinePair,ja=e.UpsampleRgb565LinePair,ka=16,Sa=1<<ka-1,Aa=-227,Ca=482,_a=6,Ta=(256<<_a)-1,Ea=0,La=s(256),Pa=s(256),Oa=s(256),Fa=s(256),Ia=s(Ca-Aa),Ra=s(Ca-Aa);Tr("YuvToRgbRow",Nr,3),Tr("YuvToBgrRow",jr,3),Tr("YuvToRgbaRow",_r,4),Tr("YuvToBgraRow",Cr,4),Tr("YuvToArgbRow",Ar,4),Tr("YuvToRgba4444Row",Sr,2),Tr("YuvToRgb565Row",kr,2);var Da=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ma=[0,2,8],Ba=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,r,o,l,c){var d=Rn,u=new tr,h=new ie;u.ba=h,h.S=d,h.width=[h.width],h.height=[h.height];var f=h.width,m=h.height,p=new oe;if(null==p||null==e)var g=2;else t(null!=p),g=Or(e,r,o,p.width,p.height,p.Pd,p.Qd,p.format,null);if(0!=g?f=0:(null!=f&&(f[0]=p.width[0]),null!=m&&(m[0]=p.height[0]),f=1),f){h.width=h.width[0],h.height=h.height[0],null!=l&&(l[0]=h.width),null!=c&&(c[0]=h.height);e:{if(l=new Ge,(c=new rr).data=e,c.w=r,c.ha=o,c.kd=1,r=[0],t(null!=c),(0==(e=Or(c.data,c.w,c.ha,null,null,null,r,null,c))||7==e)&&r[0]&&(e=4),0==(r=e)){if(t(null!=u),l.data=c.data,l.w=c.w+c.offset,l.ha=c.ha-c.offset,l.put=fe,l.ac=he,l.bc=me,l.ma=u,c.xa){if(null==(e=_e())){u=1;break e}if(function(e,r){var n=[0],a=[0],s=[0];t:for(;;){if(null==e)return 0;if(null==r)return e.a=2,0;if(e.l=r,e.a=0,x(e.m,r.data,r.w,r.ha),!pe(e.m,n,a,s)){e.a=3;break t}if(e.xb=ma,r.width=n[0],r.height=a[0],!Te(n[0],a[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,l)){if(l=0==(r=Rr(l.width,l.height,u.Oa,u.ba))){t:{l=e;r:for(;;){if(null==l){l=0;break t}if(t(null!=l.s.yc),t(null!=l.s.Ya),t(0<l.s.Wb),t(null!=(o=l.l)),t(null!=(c=o.ma)),0!=l.xb){if(l.ca=c.ba,l.tb=c.tb,t(null!=l.ca),!Fr(c.Oa,o,Mn)){l.a=2;break r}if(!Ee(l,o.width))break r;if(o.da)break r;if((o.da||ne(l.ca.S))&&pr(),11>l.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=l.ca.f.kb.F&&pr()),l.Pb&&0<l.s.ua&&null==l.s.vb.X&&!O(l.s.vb,l.s.Wa.Xa)){l.a=1;break r}l.xb=0}if(!Ae(l,l.V,l.Ba,l.c,l.i,o.o,Ne))break r;c.Dc=l.Ma,l=1;break t}t(0!=l.a),l=0}l=!l}l&&(r=e.a)}else r=e.a}else{if(null==(e=new Ke)){u=1;break e}if(e.Fa=c.na,e.P=c.P,e.qc=c.Sa,$e(e,l)){if(0==(r=Rr(l.width,l.height,u.Oa,u.ba))){if(e.Aa=0,o=u.Oa,t(null!=(c=e)),null!=o){if(0<(f=0>(f=o.Md)?0:100<f?255:255*f/100)){for(m=p=0;4>m;++m)12>(g=c.pb[m]).lc&&(g.ia=f*Ba[0>g.lc?0:g.lc]>>3),p|=g.ia;p&&(alert("todo:VP8InitRandom"),c.ia=1)}c.Ga=o.Id,100<c.Ga?c.Ga=100:0>c.Ga&&(c.Ga=0)}(function(e,r){if(null==e)return 0;if(null==r)return Ye(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!$e(e,r))return 0;if(t(e.cb),null==r.ac||r.ac(r)){r.ob&&(e.L=0);var o=Ma[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=r.v-o>>4,e.zb=r.j-o>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=r.o+15+o>>4,e.Hb=r.va+15+o>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var l=e.ed;for(o=0;4>o;++o){var c;if(e.Qa.Cb){var d=e.Qa.Lb[o];e.Qa.Fb||(d+=l.Tb)}else d=l.Tb;for(c=0;1>=c;++c){var u=e.gd[o][c],h=d;if(l.Pc&&(h+=l.vd[0],c&&(h+=l.od[0])),0<(h=0>h?0:63<h?63:h)){var f=h;0<l.wb&&(f=4<l.wb?f>>2:f>>1)>9-l.wb&&(f=9-l.wb),1>f&&(f=1),u.dd=f,u.tc=2*h+f,u.ld=40<=h?2:15<=h?1:0}else u.tc=0;u.La=c}}}o=0}else Ye(e,6,"Frame setup failed"),o=e.a;if(o=0==o){if(o){e.$c=0,0<e.Aa||(e.Ic=1);t:{o=e.Ic,l=4*(f=e.za);var m=32*f,p=f+1,g=0<e.L?f*(0<e.Aa?2:1):0,x=(2==e.Aa?2:1)*f;if((u=l+832+(c=3*(16*o+Ma[e.L])/2*m)+(d=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=u)o=0;else{if(u>e.Vb){if(e.Vb=0,e.Ec=s(u),e.Fc=0,null==e.Ec){o=Ye(e,1,"no memory during frame initialization.");break t}e.Vb=u}u=e.Ec,h=e.Fc,e.Ac=u,e.Bc=h,h+=l,e.Gd=i(m,He),e.Hd=0,e.rb=i(p+1,Be),e.sb=1,e.wa=g?i(g,Me):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=f),t(!0),e.oc=u,e.pc=h,h+=832,e.ya=i(x,ze),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=f),e.R=16*f,e.B=8*f,f=(m=Ma[e.L])*e.R,m=m/2*e.B,e.sa=u,e.ta=h+f,e.qa=e.sa,e.ra=e.ta+16*o*e.R+m,e.Ha=e.qa,e.Ia=e.ra+8*o*e.B+m,e.$c=0,h+=c,e.mb=d?u:null,e.nb=d?h:null,t(h+d<=e.Fc+e.Vb),Qe(e),a(e.Ac,e.Bc,0,l),o=1}}if(o){if(r.ka=0,r.y=e.sa,r.O=e.ta,r.f=e.qa,r.N=e.ra,r.ea=e.Ha,r.Vd=e.Ia,r.fa=e.R,r.Rc=e.B,r.F=null,r.J=0,!En){for(o=-255;255>=o;++o)An[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)Cn[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)_n[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Tn[255+o]=0>o?0:255<o?255:o;En=1}nn=lt,an=at,on=st,ln=it,cn=ot,sn=nt,dn=Kt,un=Yt,hn=Jt,fn=Qt,mn=Xt,pn=$t,gn=Zt,xn=er,bn=zt,vn=qt,yn=Ht,wn=Wt,ua[0]=jt,ua[1]=dt,ua[2]=wt,ua[3]=Nt,ua[4]=kt,ua[5]=At,ua[6]=St,ua[7]=Ct,ua[8]=Tt,ua[9]=_t,da[0]=gt,da[1]=ht,da[2]=ft,da[3]=mt,da[4]=xt,da[5]=bt,da[6]=vt,ha[0]=Ot,ha[1]=ut,ha[2]=Et,ha[3]=Lt,ha[4]=It,ha[5]=Ft,ha[6]=Rt,o=1}else o=0}o&&(o=function(e,r){for(e.M=0;e.M<e.Va;++e.M){var i,o=e.Jc[e.M&e.Xb],l=e.m,c=e;for(i=0;i<c.za;++i){var d=l,u=c,h=u.Ac,f=u.Bc+4*i,m=u.zc,p=u.ya[u.aa+i];if(u.Qa.Bb?p.$b=_(d,u.Pa.jb[0])?2+_(d,u.Pa.jb[2]):_(d,u.Pa.jb[1]):p.$b=0,u.kc&&(p.Ad=_(d,u.Bd)),p.Za=!_(d,145)+0,p.Za){var g=p.Ob,x=0;for(u=0;4>u;++u){var b,v=m[0+u];for(b=0;4>b;++b){v=oa[h[f+b]][v];for(var y=sa[_(d,v[0])];0<y;)y=sa[2*y+_(d,v[y])];v=-y,h[f+b]=v}n(g,x,h,f,4),x+=4,m[0+u]=v}}else v=_(d,156)?_(d,128)?1:3:_(d,163)?2:0,p.Ob[0]=v,a(h,f,v,4),a(m,0,v,4);p.Dd=_(d,142)?_(d,114)?_(d,183)?1:3:2:0}if(c.m.Ka)return Ye(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=o,d=(l=e).rb[l.sb-1],h=l.rb[l.sb+l.ja],i=l.ya[l.aa+l.ja],f=l.kc?i.Ad:0)d.la=h.la=0,i.Za||(d.Na=h.Na=0),i.Hc=0,i.Gc=0,i.ia=0;else{var w,N;if(d=h,h=c,f=l.Pa.Xc,m=l.ya[l.aa+l.ja],p=l.pb[m.$b],u=m.ad,g=0,x=l.rb[l.sb-1],v=b=0,a(u,g,0,384),m.Za)var j=0,k=f[3];else{y=s(16);var S=d.Na+x.Na;if(S=ra(h,f[1],S,p.Eb,0,y,0),d.Na=x.Na=(0<S)+0,1<S)nn(y,0,u,g);else{var A=y[0]+3>>3;for(y=0;256>y;y+=16)u[g+y]=A}j=1,k=f[0]}var C=15&d.la,T=15&x.la;for(y=0;4>y;++y){var E=1&T;for(A=N=0;4>A;++A)C=C>>1|(E=(S=ra(h,k,S=E+(1&C),p.Sc,j,u,g))>j)<<7,N=N<<2|(3<S?3:1<S?2:0!=u[g+0]),g+=16;C>>=4,T=T>>1|E<<7,b=(b<<8|N)>>>0}for(k=C,j=T>>4,w=0;4>w;w+=2){for(N=0,C=d.la>>4+w,T=x.la>>4+w,y=0;2>y;++y){for(E=1&T,A=0;2>A;++A)S=E+(1&C),C=C>>1|(E=0<(S=ra(h,f[2],S,p.Qc,0,u,g)))<<3,N=N<<2|(3<S?3:1<S?2:0!=u[g+0]),g+=16;C>>=2,T=T>>1|E<<5}v|=N<<4*w,k|=C<<4<<w,j|=(240&T)<<w}d.la=k,x.la=j,m.Hc=b,m.Gc=v,m.ia=43690&v?0:p.ia,f=!(b|v)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[i.$b][i.Za],l.wa[l.Y+l.ja].La|=!f),c.Ka)return Ye(e,7,"Premature end-of-file encountered.")}if(Qe(e),l=r,c=1,i=(o=e).D,d=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)t:{if(i.M=o.M,i.uc=d,Pr(o,i),c=1,i=(N=o.D).Nb,d=(v=Ma[o.L])*o.R,h=v/2*o.B,y=16*i*o.R,A=8*i*o.B,f=o.sa,m=o.ta-d+y,p=o.qa,u=o.ra-h+A,g=o.Ha,x=o.Ia-h+A,T=0==(C=N.M),b=C>=o.Va-1,2==o.Aa&&Pr(o,N),N.uc)for(E=(S=o).D.M,t(S.D.uc),N=S.yb;N<S.Hb;++N){j=N,k=E;var L=(P=(z=S).D).Nb;w=z.R;var P=P.wa[P.Y+j],O=z.sa,F=z.ta+16*L*w+16*j,I=P.dd,R=P.tc;if(0!=R)if(t(3<=R),1==z.L)0<j&&vn(O,F,w,R+4),P.La&&wn(O,F,w,R),0<k&&bn(O,F,w,R+4),P.La&&yn(O,F,w,R);else{var D=z.B,M=z.qa,B=z.ra+8*L*D+8*j,U=z.Ha,z=z.Ia+8*L*D+8*j;L=P.ld,0<j&&(un(O,F,w,R+4,I,L),fn(M,B,U,z,D,R+4,I,L)),P.La&&(pn(O,F,w,R,I,L),xn(M,B,U,z,D,R,I,L)),0<k&&(dn(O,F,w,R+4,I,L),hn(M,B,U,z,D,R+4,I,L)),P.La&&(mn(O,F,w,R,I,L),gn(M,B,U,z,D,R,I,L))}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(N=16*C,C=16*(C+1),T?(l.y=o.sa,l.O=o.ta+y,l.f=o.qa,l.N=o.ra+A,l.ea=o.Ha,l.W=o.Ia+A):(N-=v,l.y=f,l.O=m,l.f=p,l.N=u,l.ea=g,l.W=x),b||(C-=v),C>l.o&&(C=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&N<C&&(l.J=dr(o,l,N,C-N),l.F=o.mb,null==l.F&&0==l.F.length)){c=Ye(o,3,"Could not decode alpha data.");break t}N<l.j&&(v=l.j-N,N=l.j,t(!(1&v)),l.O+=o.R*v,l.N+=o.B*(v>>1),l.W+=o.B*(v>>1),null!=l.F&&(l.J+=l.width*v)),N<C&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=N-l.j,l.U=l.va-l.v,l.T=C-N,c=l.put(l))}i+1!=o.Ic||b||(n(o.sa,o.ta-d,f,m+16*o.R,d),n(o.qa,o.ra-h,p,u+8*o.B,h),n(o.Ha,o.Ia-h,g,x+8*o.B,h))}if(!c)return Ye(e,6,"Output aborted.")}return 1}(e,r)),null!=r.bc&&r.bc(r),o&=1}return o?(e.cb=0,o):0})(e,l)||(r=e.a)}}else r=e.a}0==r&&null!=u.Oa&&u.Oa.fd&&(r=Ir(u.ba))}u=r}d=0!=u?null:11>d?h.f.RGBA.eb:h.f.kb.y}else d=null;return d};var Ua=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var r="",n=0;n<4;n++)r+=String.fromCharCode(e[t++]);return r}function d(e,t){return e[t+0]|e[t+1]<<8}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new l;var f=[0],m=[0],p=[],g=new l,x=e,b=function(e,t){var r={},n=0,a=!1,s=0,i=0;if(r.frames=[],!function(e,t){for(var r=0;r<4;r++)if(e[t+r]!="RIFF".charCodeAt(r))return!0;return!1}(e,t)){for(h(e,t+=4),t+=8;t<e.length;){var o=c(e,t),l=h(e,t+=4);t+=4;var f=l+(1&l);switch(o){case"VP8 ":case"VP8L":void 0===r.frames[n]&&(r.frames[n]={}),(g=r.frames[n]).src_off=a?i:t-8,g.src_size=s+l+8,n++,a&&(a=!1,s=0,i=0);break;case"VP8X":(g=r.header={}).feature_flags=e[t];var m=t+4;g.canvas_width=1+u(e,m),m+=3,g.canvas_height=1+u(e,m),m+=3;break;case"ALPH":a=!0,s=f+8,i=t-8;break;case"ANIM":(g=r.header).bgcolor=h(e,t),m=t+4,g.loop_count=d(e,m),m+=2;break;case"ANMF":var p,g;(g=r.frames[n]={}).offset_x=2*u(e,t),t+=3,g.offset_y=2*u(e,t),t+=3,g.width=1+u(e,t),t+=3,g.height=1+u(e,t),t+=3,g.duration=u(e,t),t+=3,p=e[t++],g.dispose=1&p,g.blend=p>>1&1}"ANMF"!=o&&(t+=f)}return r}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var v=b.header?b.header:null,y=b.frames?b.frames:null;if(v){v.loop_counter=v.loop_count,f=[v.canvas_height],m=[v.canvas_width];for(var w=0;w<y.length&&0!=y[w].blend;w++);}var N=y[0],j=g.WebPDecodeRGBA(x,N.src_off,N.src_size,m,f);N.rgba=j,N.imgwidth=m[0],N.imgheight=f[0];for(var k=0;k<m[0]*f[0]*4;k++)p[k]=j[k];return this.width=m,this.height=f,this.data=p,this}!function(e){var t,r,n,a,s,i,o,l,c,d=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new l,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new i,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new i,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new d}]);var u=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var r=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var n=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var a=0;Object.defineProperty(this,"posX",{get:function(){return a},set:function(e){isNaN(e)||(a=e)}});var s=0;Object.defineProperty(this,"posY",{get:function(){return s},set:function(e){isNaN(e)||(s=e)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),c.margin=t}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=e}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(e){o=e}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(e){e instanceof d&&(c=e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(e){c.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=h(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=h(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var f=null,m=null,p=null;Object.defineProperty(this,"fontFaces",{get:function(){return p},set:function(e){f=null,m=null,p=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(e))){var r=t[1];t[2];var n=t[3],a=t[4];t[5];var s=t[6],i=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(a)[2];a="px"===i?Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor):"em"===i?Math.floor(parseFloat(a)*this.pdf.getFontSize()):Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(a);var o=function(e){var t,r,n=[],a=e.trim();if(""===a)return KA;if(a in OA)return[OA[a]];for(;""!==a;){switch(r=null,t=(a=IA(a)).charAt(0)){case'"':case"'":r=RA(a.substring(1),t);break;default:r=DA(a)}if(null===r)return KA;if(n.push(r[0]),""!==(a=IA(r[1]))&&","!==a.charAt(0))return KA;a=a.replace(/^,/,"")}return n}(s);if(this.fontFaces){var l=function(e,t){var r=e.getFontList(),n=JSON.stringify(r);if(null===f||m!==n){var a=function(e){var t=[];return Object.keys(e).forEach(function(r){e[r].forEach(function(e){var n=null;switch(e){case"bold":n={family:r,weight:"bold"};break;case"italic":n={family:r,style:"italic"};break;case"bolditalic":n={family:r,weight:"bold",style:"italic"};break;case"":case"normal":n={family:r}}null!==n&&(n.ref={name:r,style:e},t.push(n))})}),t}(r);f=function(e){for(var t={},r=0;r<e.length;++r){var n=EA(e[r]),a=n.family,s=n.stretch,i=n.style,o=n.weight;t[a]=t[a]||{},t[a][s]=t[a][s]||{},t[a][s][i]=t[a][s][i]||{},t[a][s][i][o]=n}return t}(a.concat(t)),m=n}return f}(this.pdf,this.fontFaces),c=o.map(function(e){return{family:e,stretch:"normal",weight:n,style:r}}),d=function(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},PA,r.genericFontFamilies||{}),s=null,i=null,o=0;o<t.length;++o)if(a[(s=EA(t[o])).family]&&(s.family=a[s.family]),e.hasOwnProperty(s.family)){i=e[s.family];break}if(!(i=i||e[n]))throw new Error("Could not find a font-family for the rule '"+FA(s)+"' and default family '"+n+"'.");if(i=function(e,t){if(t[e])return t[e];var r=CA[e],n=r<=CA.normal?-1:1,a=LA(t,AA,r,n);if(!a)throw new Error("Could not find a matching font-stretch value for "+e);return a}(s.stretch,i),i=function(e,t){if(t[e])return t[e];for(var r=SA[e],n=0;n<r.length;++n)if(t[r[n]])return t[r[n]];throw new Error("Could not find a matching font-style for "+e)}(s.style,i),!(i=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var r=TA[e],n=LA(t,_A,r,e<400?-1:1);if(!n)throw new Error("Could not find a matching font-weight for value "+e);return n}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+FA(s)+"'.");return i}(l,c);this.pdf.setFont(d.ref.name,d.ref.style)}else{var u="";("bold"===n||parseInt(n,10)>=700||"bold"===r)&&(u="bold"),"italic"===r&&(u+="italic"),0===u.length&&(u="normal");for(var h="",p={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},g=0;g<o.length;g++){if(void 0!==this.pdf.internal.getFont(o[g],u,{noFallback:!0,disableWarning:!0})){h=o[g];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(o[g],"bold",{noFallback:!0,disableWarning:!0}))h=o[g],u="bold";else if(void 0!==this.pdf.internal.getFont(o[g],"normal",{noFallback:!0,disableWarning:!0})){h=o[g],u="normal";break}}if(""===h)for(var x=0;x<o.length;x++)if(p[o[x]]){h=p[o[x]];break}h=""===h?"Times":h,this.pdf.setFont(h,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,D.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,D.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};u.prototype.setLineDash=function(e){this.lineDash=e},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){y.call(this,"fill",!1)},u.prototype.stroke=function(){y.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw iS.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new i(e,t)},u.prototype.closePath=function(){var e=new i(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,Kv.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new i(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(e.x,e.y)},u.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw iS.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new i(r.x,r.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),y.call(this,null,!0)},u.prototype.quadraticCurveTo=function(e,t,r,n){if(isNaN(r)||isNaN(n)||isNaN(e)||isNaN(t))throw iS.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new i(r,n)),s=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"qct",x1:s.x,y1:s.y,x:a.x,y:a.y}),this.ctx.lastPoint=new i(a.x,a.y)},u.prototype.bezierCurveTo=function(e,t,r,n,a,s){if(isNaN(a)||isNaN(s)||isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw iS.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new i(a,s)),l=this.ctx.transform.applyToPoint(new i(e,t)),c=this.ctx.transform.applyToPoint(new i(r,n));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new i(o.x,o.y)},u.prototype.arc=function(e,t,r,n,a,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))throw iS.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new i(e,t));e=o.x,t=o.y;var l=this.ctx.transform.applyToPoint(new i(0,r)),c=this.ctx.transform.applyToPoint(new i(0,0));r=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(a-n)>=2*Math.PI&&(n=0,a=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:r,startAngle:n,endAngle:a,counterclockwise:s})},u.prototype.arcTo=function(e,t,r,n,a){throw new Error("arcTo not implemented.")},u.prototype.rect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw iS.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+r,t),this.lineTo(e+r,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.lineTo(e+r,t),this.lineTo(e,t)},u.prototype.fillRect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw iS.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,r,n),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},u.prototype.strokeRect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw iS.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(e,t,r,n),this.stroke())},u.prototype.clearRect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw iS.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,r,n))},u.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var n=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=n}},u.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(e){var t,r,n,a;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,r=0,n=0,a=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==s)t=parseInt(s[1]),r=parseInt(s[2]),n=parseInt(s[3]),a=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(s[1]),r=parseInt(s[2]),n=parseInt(s[3]),a=parseFloat(s[4]);else{if(a=1,"string"==typeof e&&"#"!==e.charAt(0)){var i=new uS(e);e=i.ok?i.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,r=e.substring(2,3),r+=r,n=e.substring(3,4),n+=n):(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7)),t=parseInt(t,16),r=parseInt(r,16),n=parseInt(n,16)}}return{r:t,g:r,b:n,a:a,style:e}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},m=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(e,t,r,n){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw iS.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(n=isNaN(n)?void 0:n,!f.call(this)){var a=F(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;_.call(this,{text:e,x:t,y:r,scale:s,angle:a,align:this.textAlign,maxWidth:n})}},u.prototype.strokeText=function(e,t,r,n){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw iS.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){n=isNaN(n)?void 0:n;var a=F(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;_.call(this,{text:e,x:t,y:r,scale:s,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:n})}},u.prototype.measureText=function(e){if("string"!=typeof e)throw iS.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,r=this.pdf.internal.scaleFactor,n=t.internal.getFontSize(),a=t.getStringUnitWidth(e)*n/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:a*=Math.round(96*r/72*1e4)/1e4})},u.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw iS.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new l(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.rotate=function(e){if(isNaN(e))throw iS.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new l(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},u.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw iS.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new l(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.transform=function(e,t,r,n,a,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(s))throw iS.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var i=new l(e,t,r,n,a,s);this.ctx.transform=this.ctx.transform.multiply(i)},u.prototype.setTransform=function(e,t,r,n,a,s){e=isNaN(e)?1:e,t=isNaN(t)?0:t,r=isNaN(r)?0:r,n=isNaN(n)?1:n,a=isNaN(a)?0:a,s=isNaN(s)?0:s,this.ctx.transform=new l(e,t,r,n,a,s)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(e,t,r,n,a,s,i,c,d){var u=this.pdf.getImageProperties(e),h=1,f=1,m=1,x=1;void 0!==n&&void 0!==c&&(m=c/n,x=d/a,h=u.width/n*c/n,f=u.height/a*d/a),void 0===s&&(s=t,i=r,t=0,r=0),void 0!==n&&void 0===c&&(c=n,d=a),void 0===n&&void 0===c&&(c=u.width,d=u.height);var y=this.ctx.transform.decompose(),N=F(y.rotate.shx),j=new l,k=(j=(j=(j=j.multiply(y.translate)).multiply(y.skew)).multiply(y.scale)).applyToRectangle(new o(s-t*m,i-r*x,n*h,a*f));if(this.autoPaging){for(var S,A=g.call(this,k),C=[],_=0;_<A.length;_+=1)-1===C.indexOf(A[_])&&C.push(A[_]);v(C);for(var T=C[0],E=C[C.length-1],L=T;L<E+1;L++){this.pdf.setPage(L);var P=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],O=1===L?this.posY+this.margin[0]:this.margin[0],I=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],R=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],D=1===L?0:I+(L-2)*R;if(0!==this.ctx.clip_path.length){var M=this.path;S=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(S,this.posX+this.margin[3],-D+O+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=M}var B=JSON.parse(JSON.stringify(k));B=b([B],this.posX+this.margin[3],-D+O+this.ctx.prevPageLastElemOffset)[0];var U=(L>T||L<E)&&p.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],P,R,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",B.x,B.y,B.w,B.h,null,null,N),U&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(e,"JPEG",k.x,k.y,k.w,k.h,null,null,N)};var g=function(e,t,r){var n=[];t=t||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var a=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":n.push(Math.floor((e.y+a)/r)+1);break;case"arc":n.push(Math.floor((e.y+a-e.radius)/r)+1),n.push(Math.floor((e.y+a+e.radius)/r)+1);break;case"qct":var s=I(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);n.push(Math.floor((s.y+a)/r)+1),n.push(Math.floor((s.y+s.h+a)/r)+1);break;case"bct":var i=R(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);n.push(Math.floor((i.y+a)/r)+1),n.push(Math.floor((i.y+i.h+a)/r)+1);break;case"rect":n.push(Math.floor((e.y+a)/r)+1),n.push(Math.floor((e.y+e.h+a)/r)+1)}for(var o=0;o<n.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<n[o];)x.call(this);return n},x=function(){var e=this.fillStyle,t=this.strokeStyle,r=this.font,n=this.lineCap,a=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=r,this.lineCap=n,this.lineWidth=a,this.lineJoin=s},b=function(e,t,r){for(var n=0;n<e.length;n++)switch(e[n].type){case"bct":e[n].x2+=t,e[n].y2+=r;case"qct":e[n].x1+=t,e[n].y1+=r;default:e[n].x+=t,e[n].y+=r}return e},v=function(e){return e.sort(function(e,t){return e-t})},y=function(e,t){var r=this.fillStyle,n=this.strokeStyle,a=this.lineCap,s=this.lineWidth,i=Math.abs(s*this.ctx.transform.scaleX),o=this.lineJoin;if(this.autoPaging){for(var l,c,d=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),h=[],f=0;f<u.length;f++)if(void 0!==u[f].x)for(var m=g.call(this,u[f]),y=0;y<m.length;y+=1)-1===h.indexOf(m[y])&&h.push(m[y]);for(var N=0;N<h.length;N++)for(;this.pdf.internal.getNumberOfPages()<h[N];)x.call(this);v(h);for(var j=h[0],k=h[h.length-1],S=j;S<k+1;S++){this.pdf.setPage(S),this.fillStyle=r,this.strokeStyle=n,this.lineCap=a,this.lineWidth=i,this.lineJoin=o;var A=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],C=1===S?this.posY+this.margin[0]:this.margin[0],_=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],E=1===S?0:_+(S-2)*T;if(0!==this.ctx.clip_path.length){var L=this.path;l=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(l,this.posX+this.margin[3],-E+C+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=L}if(c=JSON.parse(JSON.stringify(d)),this.path=b(c,this.posX+this.margin[3],-E+C+this.ctx.prevPageLastElemOffset),!1===t||0===S){var P=(S>j||S<k)&&p.call(this);P&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],A,T,null).clip().discardPath()),w.call(this,e,t),P&&this.pdf.restoreGraphicsState()}this.lineWidth=s}this.path=d}else this.lineWidth=i,w.call(this,e,t),this.lineWidth=s},w=function(e,t){if(("stroke"!==e||t||!m.call(this))&&("stroke"===e||t||!f.call(this))){for(var r,n,a=[],s=this.path,i=0;i<s.length;i++){var o=s[i];switch(o.type){case"begin":a.push({begin:!0});break;case"close":a.push({close:!0});break;case"mt":a.push({start:o,deltas:[],abs:[]});break;case"lt":var l=a.length;if(s[i-1]&&!isNaN(s[i-1].x)&&(r=[o.x-s[i-1].x,o.y-s[i-1].y],l>0))for(;l>=0;l--)if(!0!==a[l-1].close&&!0!==a[l-1].begin){a[l-1].deltas.push(r),a[l-1].abs.push(o);break}break;case"bct":r=[o.x1-s[i-1].x,o.y1-s[i-1].y,o.x2-s[i-1].x,o.y2-s[i-1].y,o.x-s[i-1].x,o.y-s[i-1].y],a[a.length-1].deltas.push(r);break;case"qct":var c=s[i-1].x+2/3*(o.x1-s[i-1].x),d=s[i-1].y+2/3*(o.y1-s[i-1].y),u=o.x+2/3*(o.x1-o.x),h=o.y+2/3*(o.y1-o.y),p=o.x,g=o.y;r=[c-s[i-1].x,d-s[i-1].y,u-s[i-1].x,h-s[i-1].y,p-s[i-1].x,g-s[i-1].y],a[a.length-1].deltas.push(r);break;case"arc":a.push({deltas:[],abs:[],arc:!0}),Array.isArray(a[a.length-1].abs)&&a[a.length-1].abs.push(o)}}n=t?null:"stroke"===e?"stroke":"fill";for(var x=!1,b=0;b<a.length;b++)if(a[b].arc)for(var v=a[b].abs,y=0;y<v.length;y++){var w=v[y];"arc"===w.type?k.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,t,!x):T.call(this,w.x,w.y),x=!0}else if(!0===a[b].close)this.pdf.internal.out("h"),x=!1;else if(!0!==a[b].begin){var N=a[b].start.x,j=a[b].start.y;E.call(this,a[b].deltas,N,j),x=!0}n&&S.call(this,n),t&&A.call(this)}},N=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-r;case"top":return e+t-r;case"hanging":return e+t-2*r;case"middle":return e+t/2-r;default:return e}},j=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(e,t,r,n,a,s,i,o,l){for(var c=P.call(this,r,n,a,s),d=0;d<c.length;d++){var u=c[d];0===d&&(l?C.call(this,u.x1+e,u.y1+t):T.call(this,u.x1+e,u.y1+t)),L.call(this,e,t,u.x2,u.y2,u.x3,u.y3,u.x4,u.y4)}o?A.call(this):S.call(this,i)},S=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},A=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(e,t){this.pdf.internal.out(r(e)+" "+n(t)+" m")},_=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var r,n,a,s=this.pdf.getTextDimensions(e.text),c=N.call(this,e.y),d=j.call(this,c)-s.h,u=this.ctx.transform.applyToPoint(new i(e.x,c));if(this.autoPaging){var h=this.ctx.transform.decompose(),f=new l;f=(f=(f=f.multiply(h.translate)).multiply(h.skew)).multiply(h.scale);for(var m=this.ctx.transform.applyToRectangle(new o(e.x,c,s.w,s.h)),x=f.applyToRectangle(new o(e.x,d,s.w,s.h)),y=g.call(this,x),k=[],S=0;S<y.length;S+=1)-1===k.indexOf(y[S])&&k.push(y[S]);v(k);for(var A=k[0],C=k[k.length-1],_=A;_<C+1;_++){this.pdf.setPage(_);var T=1===_?this.posY+this.margin[0]:this.margin[0],E=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[2],P=L-this.margin[0],O=this.pdf.internal.pageSize.width-this.margin[1],F=O-this.margin[3],I=1===_?0:E+(_-2)*P;if(0!==this.ctx.clip_path.length){var R=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(r,this.posX+this.margin[3],-1*I+T),w.call(this,"fill",!0),this.path=R}var D=b([JSON.parse(JSON.stringify(x))],this.posX+this.margin[3],-I+T+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(n=this.pdf.internal.getFontSize(),this.pdf.setFontSize(n*e.scale),a=this.lineWidth,this.lineWidth=a*e.scale);var M="text"!==this.autoPaging;if(M||D.y+D.h<=L){if(M||D.y>=T&&D.x<=O){var B=M?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||O-D.x)[0],U=b([JSON.parse(JSON.stringify(m))],this.posX+this.margin[3],-I+T+this.ctx.prevPageLastElemOffset)[0],z=M&&(_>A||_<C)&&p.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],F,P,null).clip().discardPath()),this.pdf.text(B,U.x,U.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),z&&this.pdf.restoreGraphicsState()}}else D.y<L&&(this.ctx.prevPageLastElemOffset+=L-D.y);e.scale>=.01&&(this.pdf.setFontSize(n),this.lineWidth=a)}}else e.scale>=.01&&(n=this.pdf.internal.getFontSize(),this.pdf.setFontSize(n*e.scale),a=this.lineWidth,this.lineWidth=a*e.scale),this.pdf.text(e.text,u.x+this.posX,u.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(n),this.lineWidth=a)},T=function(e,t,a,s){a=a||0,s=s||0,this.pdf.internal.out(r(e+a)+" "+n(t+s)+" l")},E=function(e,t,r){return this.pdf.lines(e,t,r,null,null)},L=function(e,r,n,i,o,l,c,d){this.pdf.internal.out([t(a(n+e)),t(s(i+r)),t(a(o+e)),t(s(l+r)),t(a(c+e)),t(s(d+r)),"c"].join(" "))},P=function(e,t,r,n){for(var a=2*Math.PI,s=Math.PI/2;t>r;)t-=a;var i=Math.abs(r-t);i<a&&n&&(i=a-i);for(var o=[],l=n?-1:1,c=t;i>1e-5;){var d=c+l*Math.min(i,s);o.push(O.call(this,e,c,d)),i-=Math.abs(d-c),c=d}return o},O=function(e,t,r){var n=(r-t)/2,a=e*Math.cos(n),s=e*Math.sin(n),i=a,o=-s,l=i*i+o*o,c=l+i*a+o*s,d=4/3*(Math.sqrt(2*l*c)-c)/(i*s-o*a),u=i-d*o,h=o+d*i,f=u,m=-h,p=n+t,g=Math.cos(p),x=Math.sin(p);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:u*g-h*x,y2:u*x+h*g,x3:f*g-m*x,y3:f*x+m*g,x4:e*Math.cos(r),y4:e*Math.sin(r)}},F=function(e){return 180*e/Math.PI},I=function(e,t,r,n,a,s){var i=e+.5*(r-e),l=t+.5*(n-t),c=a+.5*(r-a),d=s+.5*(n-s),u=Math.min(e,a,i,c),h=Math.max(e,a,i,c),f=Math.min(t,s,l,d),m=Math.max(t,s,l,d);return new o(u,f,h-u,m-f)},R=function(e,t,r,n,a,s,i,l){var c,d,u,h,f,m,p,g,x,b,v,y,w,N,j=r-e,k=n-t,S=a-r,A=s-n,C=i-a,_=l-s;for(d=0;d<41;d++)x=(p=(u=e+(c=d/40)*j)+c*((f=r+c*S)-u))+c*(f+c*(a+c*C-f)-p),b=(g=(h=t+c*k)+c*((m=n+c*A)-h))+c*(m+c*(s+c*_-m)-g),0==d?(v=x,y=b,w=x,N=b):(v=Math.min(v,x),y=Math.min(y,b),w=Math.max(w,x),N=Math.max(N,b));return new o(Math.round(v),Math.round(y),Math.round(w-v),Math.round(N-y))},D=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,r=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==r&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=r)}}}(DS.API),function(e){var t=function(e){var t,r,n,a,s,i,o,l,c,d;for(/[^\x00-\xFF]/.test(e),r=[],n=0,a=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;a>n;n+=4)0!==(s=(e.charCodeAt(n)<<24)+(e.charCodeAt(n+1)<<16)+(e.charCodeAt(n+2)<<8)+e.charCodeAt(n+3))?(i=(s=((s=((s=((s=(s-(d=s%85))/85)-(c=s%85))/85)-(l=s%85))/85)-(o=s%85))/85)%85,r.push(i+33,o+33,l+33,c+33,d+33)):r.push(122);return function(e,t){for(var r=t;r>0;r--)e.pop()}(r,t.length),String.fromCharCode.apply(String,r)+"~>"},r=function(e){var t,r,n,a,s,i=String,o="length",l=255,c="charCodeAt",d="slice",u="replace";for(e[d](-2),e=e[d](0,-2)[u](/\s/g,"")[u]("z","!!!!!"),n=[],a=0,s=(e+=t="uuuuu"[d](e[o]%5||5))[o];s>a;a+=5)r=52200625*(e[c](a)-33)+614125*(e[c](a+1)-33)+7225*(e[c](a+2)-33)+85*(e[c](a+3)-33)+(e[c](a+4)-33),n.push(l&r>>24,l&r>>16,l&r>>8,l&r);return function(e,t){for(var r=t;r>0;r--)e.pop()}(n,t[o]),i.fromCharCode.apply(i,n)},n=function(e){return e.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var r="",n=0;n<e.length;n+=2)r+=String.fromCharCode("0x"+(e[n]+e[n+1]));return r},s=function(e){for(var t=new Uint8Array(e.length),r=e.length;r--;)t[r]=e.charCodeAt(r);return(t=Ly(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,i){var o=0,l=e||"",c=[];for("string"==typeof(i=i||[])&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=a(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=n(l),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=s(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(DS.API),(GA=DS.API).loadFile=function(e,t,r){return function(e,t,r){t=!1!==t,r="function"==typeof r?r:function(){};var n=void 0;try{n=function(e,t,r){var n=new XMLHttpRequest,a=0,s=function(e){var t=e.length,r=[],n=String.fromCharCode;for(a=0;a<t;a+=1)r.push(n(255&e.charCodeAt(a)));return r.join("")};if(n.open("GET",e,!t),n.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(n.onload=function(){200===n.status?r(s(this.responseText)):r(void 0)}),n.send(null),t&&200===n.status)return s(n.responseText)}(e,t,r)}catch(oy){}return n}(e,t,r)},GA.loadImageFile=GA.loadFile,function(e){function t(){return(aS.html2canvas?Promise.resolve(aS.html2canvas):r.e(239).then(r.t.bind(r,5239,23))).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function n(){return(aS.DOMPurify?Promise.resolve(aS.DOMPurify):r.e(977).then(r.bind(r,7977))).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var a=function(e){var t=(0,Kv.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},s=function(e,t){var r=document.createElement(e);for(var n in t.className&&(r.className=t.className),t.innerHTML&&t.dompurify&&(r.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)r.style[n]=t.style[n];return r},i=function e(t,r){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),a=t.firstChild;a;a=a.nextSibling)!0!==r&&1===a.nodeType&&"SCRIPT"===a.nodeName||n.appendChild(e(a,r));return 1===t.nodeType&&("CANVAS"===t.nodeName?(n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value),n.addEventListener("load",function(){n.scrollTop=t.scrollTop,n.scrollLeft=t.scrollLeft},!0)),n},o=function e(t){var r=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),n=e.convert(Promise.resolve(),r);return(n=n.setProgress(1,e,1,[e])).set(t)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(e,t){return e.__proto__=t||o.prototype,e},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(a(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e),t){case"string":return this.then(n).then(function(t){return this.set({src:s("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},o.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,r=this.opt.fontFaces,n="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,a=Object.assign({async:!0,allowTaint:!0,scale:n,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete a.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=r,r)for(var s=0;s<r.length;++s){var i=r[s],o=i.src.find(function(e){return"truetype"===e.format});o&&t.addFont(o.url,i.ref.name,i.ref.style)}return a.windowHeight=a.windowHeight||0,a.windowHeight=0==a.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):a.windowHeight,t.context2d.save(!0),e(this.prop.container,a)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(e,t,r){return"img"===(r=r||"pdf").toLowerCase()||"image"===r.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},o.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},o.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},o.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(e){if("object"!==a(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in o.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},o.prototype.get=function(e,t){return this.then(function(){var r=e in o.template.prop?this.prop[e]:this.opt[e];return t?t(r):r})},o.prototype.setMargin=function(e){return this.then(function(){switch(a(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},o.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||DS.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},o.prototype.setProgress=function(e,t,r,n){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=r&&(this.progress.n=r),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(e,t,r,n){return this.setProgress(e?this.progress.val+e:null,t||null,r?this.progress.n+r:null,n?this.progress.stack.concat(n):null)},o.prototype.then=function(e,t){var r=this;return this.thenCore(e,t,function(e,t){return r.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return r.updateProgress(null,e),t}).then(e,t).then(function(e){return r.updateProgress(1),e})})},o.prototype.thenCore=function(e,t,r){r=r||Promise.prototype.then;var n=this;e&&(e=e.bind(n)),t&&(t=t.bind(n));var a=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?n:o.convert(Object.assign({},n),Promise.prototype),s=r.call(a,e,t);return o.convert(s,n.__proto__)},o.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},o.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},o.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return o.convert(t,this)},o.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},o.prototype.error=function(e){return this.then(function(){throw new Error(e)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,DS.getPageSize=function(e,t,r){if("object"===(0,Kv.A)(e)){var n=e;e=n.orientation,t=n.unit||t,r=n.format||r}t=t||"mm",r=r||"a4",e=(""+(e||"P")).toLowerCase();var a,s=(""+r).toLowerCase(),i={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":a=1;break;case"mm":a=72/25.4;break;case"cm":a=72/2.54;break;case"in":a=72;break;case"px":a=.75;break;case"pc":case"em":a=12;break;case"ex":a=6;break;default:throw"Invalid unit: "+t}var o,l=0,c=0;if(i.hasOwnProperty(s))l=i[s][1]/a,c=i[s][0]/a;else try{l=r[1],c=r[0]}catch(uS){throw new Error("Invalid format: "+r)}if("p"===e||"portrait"===e)e="p",c>l&&(o=c,c=l,l=o);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",l>c&&(o=c,c=l,l=o)}return{width:c,height:l,unit:t,k:a,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(EA):null;var r=new o(t);return t.worker?r:r.from(e).doCallback()}}(DS.API),DS.API.addJS=function(e){return UA=e,this.internal.events.subscribe("postPutResources",function(){MA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(MA+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),BA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+UA+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==MA&&void 0!==BA&&this.internal.out("/Names <</JavaScript "+MA+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=e.outline.render().split(/\r\n/),a=0;a<n.length;a++){var s=n[a],i=r.exec(s);if(null!=i){var o=i[1];e.internal.newObjectDeferredBegin(o,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(a=0;a<l;a++){var d=e.internal.newObject();c.push(d);var u=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var h=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<c.length;a++)e.internal.write("(page_"+(a+1)+")"+c[a]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+h+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,r){var n={title:t,options:r,children:[]};return null==e&&(e=this.root),e.children.push(n),n},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var r=0;r<t.children.length;r++)this.genIds_r(t.children[r])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,n=0;n<t.children.length;n++){var a=t.children[n];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(t)),n>0&&this.line("/Prev "+this.makeRef(t.children[n-1])),n<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[n+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var s=this.count=this.count_r({count:0},a);if(s>0&&this.line("/Count "+s),a.options&&a.options.pageNumber){var i=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+i.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var r=0;r<t.children.length;r++)e.count++,this.count_r(e,t.children[r]);return e.count}}])}(DS.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,r,n,a,s,i){var o,l=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,o=function(e){for(var r,n=256*e.charCodeAt(4)+e.charCodeAt(5),a=e.length,s={width:0,height:0,numcomponents:1},i=4;i<a;i+=2){if(i+=n,-1!==t.indexOf(e.charCodeAt(i+1))){r=256*e.charCodeAt(i+5)+e.charCodeAt(i+6),s={width:256*e.charCodeAt(i+7)+e.charCodeAt(i+8),height:r,numcomponents:e.charCodeAt(i+9)};break}n=256*e.charCodeAt(i+2)+e.charCodeAt(i+3)}return s}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),o.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}c={data:e,width:o.width,height:o.height,colorSpace:i,bitsPerComponent:8,filter:l,index:r,alias:n}}return c}}(DS.API),DS.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,s=function(e,t){return new rS(e,t).decode()}(e,{checkCrc:!0}),i=s.width,o=s.height,l=s.channels,c=s.palette,d=s.depth;a=c&&1===l?function(e){for(var t=e.width,r=e.height,n=e.data,a=e.palette,s=e.depth,i=!1,o=[],l=[],c=void 0,d=!1,u=0,h=0;h<a.length;h++){var f=Fy(a[h],4),m=f[0],p=f[1],g=f[2],x=f[3];o.push(m,p,g),null!=x&&(0===x?(u++,l.length<1&&l.push(h)):x<255&&(d=!0))}if(d||u>1){i=!0,l=void 0;var b=t*r;c=new Uint8Array(b);for(var v=new DataView(n.buffer),y=0;y<b;y++){var w=Fy(a[rC(v,y,s)],4)[3];c[y]=w}}else 0===u&&(l=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:i?8:void 0,colorBytes:n,alphaBytes:c,needSMask:i,palette:o,mask:l}}(s):2===l||4===l?function(e){for(var t=e.data,r=e.width,n=e.height,a=e.channels,s=e.depth,i=2===a?"DeviceGray":"DeviceRGB",o=a-1,l=r*n,c=o,d=l*c,u=1*l,h=Math.ceil(d*s/8),f=Math.ceil(u*s/8),m=new Uint8Array(h),p=new Uint8Array(f),g=new DataView(t.buffer),x=new DataView(m.buffer),b=new DataView(p.buffer),v=!1,y=0;y<l;y++){for(var w=y*a,N=0;N<c;N++)nC(x,rC(g,w+N,s),y*c+N,s);var j=rC(g,w+c,s);j<(1<<s)-1&&(v=!0),nC(b,j,1*y,s)}return{colorSpace:i,colorsPerPixel:o,sMaskBitsPerComponent:v?s:void 0,colorBytes:m,alphaBytes:p,needSMask:v}}(s):function(e){var t=e.data,r=1===e.channels?"DeviceGray":"DeviceRGB";return{colorSpace:r,colorsPerPixel:"DeviceGray"===r?1:3,colorBytes:t instanceof Uint16Array?function(e){for(var t=e.length,r=new Uint8Array(2*t),n=new DataView(r.buffer,r.byteOffset,r.byteLength),a=0;a<t;a++)n.setUint16(2*a,e[a],!1);return r}(t):t,needSMask:!1}}(s);var u,h,f,m=a,p=m.colorSpace,g=m.colorsPerPixel,x=m.sMaskBitsPerComponent,b=m.colorBytes,v=m.alphaBytes,y=m.needSMask,w=m.palette,N=m.mask,j=null;return n!==DS.API.image_compression.NONE?(j=function(e){var t;switch(e){case DS.API.image_compression.FAST:t=11;break;case DS.API.image_compression.MEDIUM:t=13;break;case DS.API.image_compression.SLOW:t=14;break;default:t=12}return t}(n),u=this.decode.FLATE_DECODE,h="/Predictor ".concat(j," /Colors ").concat(g," /BitsPerComponent ").concat(d," /Columns ").concat(i),e=YA(b,Math.ceil(i*g*d/8),g,d,n),y&&(f=YA(v,Math.ceil(i*x/8),1,x,n))):(u=void 0,h=void 0,e=b,y&&(f=v)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:r,data:e,index:t,filter:u,decodeParameters:h,transparency:N,palette:w,sMask:f,predictor:j,width:i,height:o,bitsPerComponent:d,sMaskBitsPerComponent:x,colorSpace:p}}},function(e){e.processGIF89A=function(t,r,n,a){var s=new sC(t),i=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:i,height:o},d=new oC(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)},e.processGIF87A=e.processGIF89A}(DS.API),lC.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},lC.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){iS.log("bit decode error:"+r)}},lC.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}0!==r&&(this.pos+=4-r)}},lC.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*a*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}0!==t&&(this.pos+=4-t)}},lC.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var i=this.palette[a];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==e&&(this.pos+=4-e)}},lC.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,c=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=l,this.data[d+1]=o,this.data[d+2]=i,this.data[d+3]=c}this.pos+=e}},lC.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&r)/r*255|0,c=(i>>11)/t*255|0,d=a*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},lC.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=s,this.data[i+1]=a,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},lC.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=i}},lC.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var s=new lC(t,!1),i=s.width,o=s.height,l={data:s.getData(),width:i,height:o},c=new oC(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(DS.API),cC.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var s=new cC(t),i=s.width,o=s.height,l={data:s.getData(),width:i,height:o},c=new oC(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(DS.API),DS.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,s=new Uint8Array(a/4*3),i=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var d=n[c],u=n[c+1],h=n[c+2],f=n[c+3];s[o++]=d,s[o++]=u,s[o++]=h,i[l++]=f}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},DS.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},zA=DS.API,qA=zA.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,d=c.fof?c.fof:1,u=!1!==t.doKerning,h=0,f=e.length,m=0,p=o[0]||l,g=[];for(r=0;r<f;r++)n=e.charCodeAt(r),"function"==typeof a.metadata.widthOfString?g.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+i*(1e3/s)||0)/1e3):(h=u&&"object"===(0,Kv.A)(c[n])&&!isNaN(parseInt(c[n][m],10))?c[n][m]/d:0,g.push((o[n]||p)/l+h)),m=n;return g},HA=zA.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return zA.processArabic&&(e=zA.processArabic(e)),"function"==typeof n.metadata.widthOfString?n.metadata.widthOfString(e,r,a)/r:qA.apply(this,arguments).reduce(function(e,t){return e+t},0)},WA=function(e,t,r,n){for(var a=[],s=0,i=e.length,o=0;s!==i&&o+t[s]<r;)o+=t[s],s++;a.push(e.slice(0,s));var l=s;for(o=0;s!==i;)o+t[s]>n&&(a.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&a.push(e.slice(l,s)),a},VA=function(e,t,r){r||(r={});var n,a,s,i,o,l,c,d=[],u=[d],h=r.textIndent||0,f=0,m=0,p=e.split(" "),g=qA.apply(this,[" ",r])[0];if(l=-1===r.lineIndent?p[0].length+2:r.lineIndent||0){var x=Array(l).join(" "),b=[];p.map(function(e){(e=e.split(/\s*\n/)).length>1?b=b.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):b.push(e[0])}),p=b,l=HA.apply(this,[x,r])}for(s=0,i=p.length;s<i;s++){var v=0;if(n=p[s],l&&"\n"==n[0]&&(n=n.substr(1),v=1),h+f+(m=(a=qA.apply(this,[n,r])).reduce(function(e,t){return e+t},0))>t||v){if(m>t){for(o=WA.apply(this,[n,a,t-(h+f),t]),d.push(o.shift()),d=[o.pop()];o.length;)u.push([o.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(e,t){return e+t},0)}else d=[n];u.push(d),h=m+l,f=g}else d.push(n),h+=f+m,f=g}return c=l?function(e,t){return(t?x:"")+e.join(" ")}:function(e){return e.join(" ")},u.map(c)},zA.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle),r="Unicode";return t.metadata[r]?{widths:t.metadata[r].widths||{0:1},kerning:t.metadata[r].kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(VA.apply(this,[n[o],i,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=t[s],a[t[s]]=r[s];var i=function(e){return"0x"+parseInt(e,10).toString(16)},o=e.__fontmetrics__.compress=function(e){var t,r,n,s,l=["{"];for(var c in e){if(t=e[c],isNaN(parseInt(c,10))?r="'"+c+"'":(c=parseInt(c,10),r=(r=i(c).slice(2)).slice(0,-1)+a[r.slice(-1)]),"number"==typeof t)t<0?(n=i(t).slice(3),s="-"):(n=i(t).slice(2),s=""),n=s+n.slice(0,-1)+a[n.slice(-1)];else{if("object"!==(0,Kv.A)(t))throw new Error("Don't know what to do with value type "+(0,Kv.A)(t)+".");n=o(t)}l.push(r+n)}return l.push("}"),l.join("")},l=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,r,a,s,i={},o=1,l=i,c=[],d="",u="",h=e.length-1,f=1;f<h;f+=1)"'"==(s=e[f])?t?(a=t.join(""),t=void 0):t=[]:t?t.push(s):"{"==s?(c.push([l,a]),l={},a=void 0):"}"==s?((r=c.pop())[0][r[1]]=l,a=void 0,l=r[0]):"-"==s?o=-1:void 0===a?n.hasOwnProperty(s)?(d+=n[s],a=parseInt(d,16)*o,o=1,d=""):d+=s:n.hasOwnProperty(s)?(u+=n[s],l[a]=parseInt(u,16)*o,o=1,a=void 0,u=""):u+=s;return i},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,r=u.Unicode[t.postScriptName];r&&(t.metadata.Unicode={},t.metadata.Unicode.widths=r.widths,t.metadata.Unicode.kerning=r.kerning);var n=d.Unicode[t.postScriptName];n&&(t.metadata.Unicode.encoding=n,t.encoding=n.codePages[0])}])}(DS.API),function(e){var t=function(e){for(var t=e.length,r=new Uint8Array(t),n=0;n<t;n++)r[n]=e.charCodeAt(n);return r};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if("string"!=typeof(n=!1===s.existsFileInVFS(a.postScriptName)?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");!function(r,n){n=/^\x00\x01\x00\x00/.test(n)?t(n):t(hS(n)),r.metadata=e.API.TTFFont.open(n),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0]}(a,n)}}])}(DS),DS.API.addSvgAsImage=function(e,t,n,a,s,i,o,l){if(isNaN(t)||isNaN(n))throw iS.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw iS.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=a,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(aS.canvg?Promise.resolve(aS.canvg):r.e(455).then(r.bind(r,8455))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,n,a,s,o,l)})},DS.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},DS.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],c=0,d=0,u=0;function h(e,t){var r,n=!1;for(r=0;r<e.length;r+=1)e[r]===t&&(n=!0);return n}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var f=o.length;for(u=0;u<f;u+=1)r[o[u]].value=r[o[u]].defaultValue,r[o[u]].explicitSet=!1}if("object"===(0,Kv.A)(e))for(a in e)if(s=e[a],h(o,a)&&void 0!==s){if("boolean"===r[a].type&&"boolean"==typeof s)r[a].value=s;else if("name"===r[a].type&&h(r[a].valueSet,s))r[a].value=s;else if("integer"===r[a].type&&Number.isInteger(s))r[a].value=s;else if("array"===r[a].type){for(c=0;c<s.length;c+=1)if(n=!0,1===s[c].length&&"number"==typeof s[c][0])l.push(String(s[c]-1));else if(s[c].length>1){for(d=0;d<s[c].length;d+=1)"number"!=typeof s[c][d]&&(n=!1);!0===n&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in r)!0===r[e].explicitSet&&("name"===r[e].type?t.push("/"+e+" /"+r[e].value):t.push("/"+e+" "+r[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(e)),n=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),i=r.length+n.length+a.length+t.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(t+r+n+a+s),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,n){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(DS.API),function(e){var t=e.API,r=t.pdfEscape16=function(e,t){for(var r,n=t.metadata.Unicode.widths,a=["","0","00","000","0000"],s=[""],i=0,o=e.length;i<o;++i){if(r=t.metadata.characterToGlyph(e.charCodeAt(i)),t.metadata.glyIdsUsed.push(r),t.metadata.toUnicode[r]=e.charCodeAt(i),-1==n.indexOf(r)&&(n.push(r),n.push([parseInt(t.metadata.widthOfGlyph(r),10)])),"0"==r)return s.join("");r=r.toString(16),s.push(a[4-r.length],r)}return s.join("")},n=function(e){var t,r,n,a,s,i,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",n=[],i=0,o=(r=Object.keys(e).sort(function(e,t){return e-t})).length;i<o;i++)t=r[i],n.length>=100&&(s+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar",n=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(a=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),n.push("<"+t+"><"+a+">"));return n.length&&(s+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar\n"),s+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var r=t.font,a=t.out,s=t.newObject,i=t.putStream;if(r.metadata instanceof e.API.TTFFont&&"Identity-H"===r.encoding){for(var o=r.metadata.Unicode.widths,l=r.metadata.subset.encode(r.metadata.glyIdsUsed,1),c="",d=0;d<l.length;d++)c+=String.fromCharCode(l[d]);var u=s();i({data:c,addLength1:!0,objectId:u}),a("endobj");var h=s();i({data:n(r.metadata.toUnicode),addLength1:!0,objectId:h}),a("endobj");var f=s();a("<<"),a("/Type /FontDescriptor"),a("/FontName /"+LS(r.fontName)),a("/FontFile2 "+u+" 0 R"),a("/FontBBox "+e.API.PDFObject.convert(r.metadata.bbox)),a("/Flags "+r.metadata.flags),a("/StemV "+r.metadata.stemV),a("/ItalicAngle "+r.metadata.italicAngle),a("/Ascent "+r.metadata.ascender),a("/Descent "+r.metadata.decender),a("/CapHeight "+r.metadata.capHeight),a(">>"),a("endobj");var m=s();a("<<"),a("/Type /Font"),a("/BaseFont /"+LS(r.fontName)),a("/FontDescriptor "+f+" 0 R"),a("/W "+e.API.PDFObject.convert(o)),a("/CIDToGIDMap /Identity"),a("/DW 1000"),a("/Subtype /CIDFontType2"),a("/CIDSystemInfo"),a("<<"),a("/Supplement 0"),a("/Registry (Adobe)"),a("/Ordering ("+r.encoding+")"),a(">>"),a(">>"),a("endobj"),r.objectNumber=s(),a("<<"),a("/Type /Font"),a("/Subtype /Type0"),a("/ToUnicode "+h+" 0 R"),a("/BaseFont /"+LS(r.fontName)),a("/Encoding /"+r.encoding),a("/DescendantFonts ["+m+" 0 R]"),a(">>"),a("endobj"),r.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var r=t.font,a=t.out,s=t.newObject,i=t.putStream;if(r.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===r.encoding){for(var o=r.metadata.rawData,l="",c=0;c<o.length;c++)l+=String.fromCharCode(o[c]);var d=s();i({data:l,addLength1:!0,objectId:d}),a("endobj");var u=s();i({data:n(r.metadata.toUnicode),addLength1:!0,objectId:u}),a("endobj");var h=s();a("<<"),a("/Descent "+r.metadata.decender),a("/CapHeight "+r.metadata.capHeight),a("/StemV "+r.metadata.stemV),a("/Type /FontDescriptor"),a("/FontFile2 "+d+" 0 R"),a("/Flags 96"),a("/FontBBox "+e.API.PDFObject.convert(r.metadata.bbox)),a("/FontName /"+LS(r.fontName)),a("/ItalicAngle "+r.metadata.italicAngle),a("/Ascent "+r.metadata.ascender),a(">>"),a("endobj"),r.objectNumber=s();for(var f=0;f<r.metadata.hmtx.widths.length;f++)r.metadata.hmtx.widths[f]=parseInt(r.metadata.hmtx.widths[f]*(1e3/r.metadata.head.unitsPerEm));a("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+LS(r.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+r.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(r.metadata.hmtx.widths)+">>"),a("endobj"),r.isAlreadyPutted=!0}}(t)}]);var a=function(e){var t,n=e.text||"",a=e.x,s=e.y,i=e.options||{},o=e.mutex||{},l=o.pdfEscape,c=o.activeFontKey,d=o.fonts,u=c,h="",f=0,m="",p=d[u].encoding;if("Identity-H"!==d[u].encoding)return{text:n,x:a,y:s,options:i,mutex:o};for(m=n,u=c,Array.isArray(n)&&(m=n[0]),f=0;f<m.length;f+=1)d[u].metadata.hasOwnProperty("cmap")&&(t=d[u].metadata.cmap.unicode.codeMap[m[f].charCodeAt(0)]),t||m[f].charCodeAt(0)<256&&d[u].metadata.hasOwnProperty("Unicode")?h+=m[f]:h+="";var g="";return parseInt(u.slice(1))<14||"WinAnsiEncoding"===p?g=l(h,u).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===p&&(g=r(h,d[u])),o.isHex=!0,{text:g,x:a,y:s,options:i,mutex:o}};t.events.push(["postProcessText",function(e){var t=e.text||"",r=[],n={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var s=0;for(s=0;s<t.length;s+=1)Array.isArray(t[s])&&3===t[s].length?r.push([a(Object.assign({},n,{text:t[s][0]})).text,t[s][1],t[s][2]]):r.push(a(Object.assign({},n,{text:t[s]})).text);e.text=r}else e.text=a(Object.assign({},n,{text:t})).text}])}(DS),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,r){return t.call(this),this.internal.vFS[e]=r,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(DS.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var r,n,a,s,i,o,l,c=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},m=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,x=0;this.__bidiEngine__={};var b=function(e){var t=e.charCodeAt(),r=t>>8,n=f[r];return void 0!==n?c[256*n+(255&t)]:252===r||253===r?"AL":p.test(r)?"L":8===r?"R":"N"},v=function(e){for(var t,r=0;r<e.length;r++){if("L"===(t=b(e.charAt(r))))return!1;if("R"===t)return!0}return!1},y=function(e,t,i,o){var l,c,d,u,h=t[o];switch(h){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(h="AN");break;case"AL":g=!0,h="R";break;case"WS":case"BN":h="N";break;case"CS":o<1||o+1>=t.length||"EN"!==(l=i[o-1])&&"AN"!==l||"EN"!==(c=t[o+1])&&"AN"!==c?h="N":g&&(c="AN"),h=c===l?c:"N";break;case"ES":h="EN"===(l=o>0?i[o-1]:"B")&&o+1<t.length&&"EN"===t[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===i[o-1]){h="EN";break}if(g){h="N";break}for(d=o+1,u=t.length;d<u&&"ET"===t[d];)d++;h=d<u&&"EN"===t[d]?"EN":"N";break;case"NSM":if(a&&!s){for(u=t.length,d=o+1;d<u&&"NSM"===t[d];)d++;if(d<u){var f=e[o],m=f>=1425&&f<=2303||64286===f;if(l=t[d],m&&("R"===l||"AL"===l)){h="R";break}}}h=o<1||"B"===(l=t[o-1])?"N":i[o-1];break;case"B":g=!1,r=!0,h=x;break;case"S":n=!0,h="N"}return h},w=function(e,t,r){var n=e.split("");return r&&N(n,r,{hiLevel:x}),n.reverse(),t&&t.reverse(),n.join("")},N=function(e,t,a){var s,i,o,l,c,f=-1,m=e.length,p=0,v=[],w=x?u:d,N=[];for(g=!1,r=!1,n=!1,i=0;i<m;i++)N[i]=b(e[i]);for(o=0;o<m;o++){if(c=p,v[o]=y(e,N,v,o),s=240&(p=w[c][h[v[o]]]),p&=15,t[o]=l=w[p][5],s>0)if(16===s){for(i=f;i<o;i++)t[i]=1;f=-1}else f=-1;if(w[p][6])-1===f&&(f=o);else if(f>-1){for(i=f;i<o;i++)t[i]=l;f=-1}"B"===N[o]&&(t[o]=0),a.hiLevel|=l}n&&function(e,t,r){for(var n=0;n<r;n++)if("S"===e[n]){t[n]=x;for(var a=n-1;a>=0&&"WS"===e[a];a--)t[a]=x}}(N,t,m)},j=function(e,t,n,a,s){if(!(s.hiLevel<e)){if(1===e&&1===x&&!r)return t.reverse(),void(n&&n.reverse());for(var i,o,l,c,d=t.length,u=0;u<d;){if(a[u]>=e){for(l=u+1;l<d&&a[l]>=e;)l++;for(c=u,o=l-1;c<o;c++,o--)i=t[c],t[c]=t[o],t[o]=i,n&&(i=n[c],n[c]=n[o],n[o]=i);u=l}u++}}},k=function(e,t,r){var n=e.split(""),a={hiLevel:x};return r||(r=[]),N(n,r,a),function(e,t,r){if(0!==r.hiLevel&&l)for(var n,a=0;a<e.length;a++)1===t[a]&&(n=m.indexOf(e[a]))>=0&&(e[a]=m[n+1])}(n,r,a),j(2,n,t,r,a),j(1,n,t,r,a),n.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,r){if(function(e,t){if(t)for(var r=0;r<e.length;r++)t[r]=r;void 0===s&&(s=v(e)),void 0===o&&(o=v(e))}(e,t),a||!i||o)if(a&&i&&s^o)x=s?1:0,e=w(e,t,r);else if(!a&&i&&o)x=s?1:0,e=k(e,t,r),e=w(e,t);else if(!a||s||i||o){if(a&&!i&&s^o)e=w(e,t),s?(x=0,e=k(e,t,r)):(x=1,e=k(e,t,r),e=w(e,t));else if(a&&s&&!i&&o)x=1,e=k(e,t,r),e=w(e,t);else if(!a&&!i&&s^o){var n=l;s?(x=1,e=k(e,t,r),x=0,l=!1,e=k(e,t,r),l=n):(x=0,e=k(e,t,r),e=w(e,t),x=1,l=!1,e=k(e,t,r),l=n,e=w(e,t))}}else x=0,e=k(e,t,r);else x=s?1:0,e=k(e,t,r);return e},this.__bidiEngine__.setOptions=function(e){e&&(a=e.isInputVisual,i=e.isOutputVisual,s=e.isInputRtl,o=e.isOutputRtl,l=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var n=e.options||{};e.mutex,n.lang;var a=[];if(n.isInputVisual="boolean"!=typeof n.isInputVisual||n.isInputVisual,r.setOptions(n),"[object Array]"===Object.prototype.toString.call(t)){var s=0;for(a=[],s=0;s<t.length;s+=1)"[object Array]"===Object.prototype.toString.call(t[s])?a.push([r.doBidiReorder(t[s][0]),t[s][1],t[s][2]]):a.push([r.doBidiReorder(t[s])]);e.text=a}else e.text=r.doBidiReorder(t);r.setOptions({isInputVisual:!0})}])}(DS),DS.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new uC(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new EC(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new hC(this.contents),this.head=new pC(this),this.name=new NC(this),this.cmap=new xC(this),this.toUnicode={},this.hhea=new bC(this),this.maxp=new jC(this),this.hmtx=new kC(this),this.post=new yC(this),this.os2=new vC(this),this.loca=new TC(this),this.glyf=new AC(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,r,n,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,r,n,a;for(a=[],t=0,r=(n=this.bbox).length;t<r;t++)e=n[t],a.push(Math.round(e*this.scaleFactor));return a}.call(this),this.stemV=0,this.post.exists?(r=255&(n=this.post.italic_angle),32768&(t=n>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,r){var n,a,s,i;for(s=0,a=0,i=(e=""+e).length;0<=i?a<i:a>i;a=0<=i?++a:--a)n=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/t)||0;return s*(t/1e3)},e.prototype.lineHeight=function(e,t){var r;return null==t&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},e}();var dC,uC=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(e){var t,r,n;for(n=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)n.push(this.writeByte(e.charCodeAt(t)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,r,n,a,s,i,o;return e=this.readByte(),t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^a)+65536*(255^s)+256*(255^i)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*n+16777216*a+65536*s+256*i+o},e.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(e){var t,r,n,a;for(a=[],r=0,n=e.length;r<n;r++)t=e[r],a.push(this.writeByte(t));return a},e}(),hC=function(){var e;function t(e){var t,r,n;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,n=this.tableCount;0<=n?r<n:r>n;r=0<=n?++r:--r)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var r,n,a,s,i,o,l,c,d,u,h,f,m;for(m in h=Object.keys(t).length,o=Math.log(2),d=16*Math.floor(Math.log(h)/o),s=Math.floor(d/o),c=16*h-d,(n=new uC).writeInt(this.scalarType),n.writeShort(h),n.writeShort(d),n.writeShort(s),n.writeShort(c),a=16*h,l=n.pos+a,i=null,f=[],t)for(u=t[m],n.writeString(m),n.writeInt(e(u)),n.writeInt(l),n.writeInt(u.length),f=f.concat(u),"head"===m&&(i=l),l+=u.length;l%4;)f.push(0),l++;return n.write(f),r=2981146554-e(n.data),n.pos=i+8,n.writeUInt32(r),n.data},e=function(e){var t,r,n,a;for(e=SC.call(e);e.length%4;)e.push(0);for(n=new uC(e),r=0,t=0,a=e.length;t<a;t=t+=4)r+=n.readUInt32();return 4294967295&r},t}(),fC={}.hasOwnProperty,mC=function(e,t){for(var r in t)fC.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};dC=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var pC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new uC).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),gC=function(){function e(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=e.readByte();break;case 4:for(h=e.readUInt16(),u=h/2,e.pos+=6,a=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),e.pos+=2,m=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),l=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),c=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),n=(this.length-e.pos+this.offset)/2,i=function(){var t,r;for(r=[],o=t=0;0<=n?t<n:t>n;o=0<=n?++t:--t)r.push(e.readUInt16());return r}(),o=g=0,b=a.length;g<b;o=++g)for(p=a[o],r=x=f=m[o];f<=p?x<=p:x>=p;r=f<=p?++x:--x)0===c[o]?s=r+l[o]:0!==(s=i[c[o]/2+(r-f)-(u-o)]||0)&&(s+=l[o]),this.codeMap[r]=65535&s}e.pos=d}return e.encode=function(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,b,v,y,w,N,j,k,S,A,C,_,T,E,L,P,O,F,I,R,D,M,B,U,z,q,H,W,V,G,K;switch(T=new uC,s=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(m=0,p=function(){var e=[];for(f=0;f<256;++f)e.push(0);return e}(),x={0:0},a={},E=0,F=s.length;E<F;E++)null==x[W=e[n=s[E]]]&&(x[W]=++m),a[n]={old:e[n],new:x[e[n]]},p[n]=x[e[n]];return T.writeUInt16(1),T.writeUInt16(0),T.writeUInt32(12),T.writeUInt16(0),T.writeUInt16(262),T.writeUInt16(0),T.write(p),{charMap:a,subtable:T.data,maxGlyphID:m+1};case"unicode":for(C=[],d=[],b=0,x={},r={},g=l=null,L=0,I=s.length;L<I;L++)null==x[y=e[n=s[L]]]&&(x[y]=++b),r[n]={old:y,new:x[y]},i=x[y]-n,null!=g&&i===l||(g&&d.push(g),C.push(n),l=i),g=n;for(g&&d.push(g),d.push(65535),C.push(65535),S=2*(k=C.length),j=2*Math.pow(Math.log(k)/Math.LN2,2),u=Math.log(j/2)/Math.LN2,N=2*k-j,o=[],w=[],h=[],f=P=0,R=C.length;P<R;f=++P){if(A=C[f],c=d[f],65535===A){o.push(0),w.push(0);break}if(A-(_=r[A].new)>=32768)for(o.push(0),w.push(2*(h.length+k-f)),n=O=A;A<=c?O<=c:O>=c;n=A<=c?++O:--O)h.push(r[n].new);else o.push(_-A),w.push(0)}for(T.writeUInt16(3),T.writeUInt16(1),T.writeUInt32(12),T.writeUInt16(4),T.writeUInt16(16+8*k+2*h.length),T.writeUInt16(0),T.writeUInt16(S),T.writeUInt16(j),T.writeUInt16(u),T.writeUInt16(N),q=0,D=d.length;q<D;q++)n=d[q],T.writeUInt16(n);for(T.writeUInt16(0),H=0,M=C.length;H<M;H++)n=C[H],T.writeUInt16(n);for(V=0,B=o.length;V<B;V++)i=o[V],T.writeUInt16(i);for(G=0,U=w.length;G<U;G++)v=w[G],T.writeUInt16(v);for(K=0,z=h.length;K<z;K++)m=h[K],T.writeUInt16(m);return{charMap:r,subtable:T.data,maxGlyphID:b+1}}},e}(),xC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,r,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=n?r<n:r>n;r=0<=n?++r:--r)t=new gC(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var r,n;return null==t&&(t="macroman"),r=gC.encode(e,t),(n=new uC).writeUInt16(0),n.writeUInt16(1),r.table=n.data.concat(r.subtable),r},e}(),bC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),vC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r}(),this.charRange=function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),yC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="post",e.prototype.parse=function(e){var t,r,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(r=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)t=e.readByte(),n.push(this.names.push(e.readString(t)));return n;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=function(){var t,r,n;for(n=[],a=t=0,r=this.file.maxp.numGlyphs;0<=r?t<r:t>r;a=0<=r?++t:--t)n.push(e.readUInt32());return n}.call(this)}},e}(),wC=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},NC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="name",e.prototype.parse=function(e){var t,r,n,a,s,i,o,l,c,d,u;for(e.pos=this.offset,e.readShort(),t=e.readShort(),i=e.readShort(),r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+i+e.readShort()});for(o={},a=c=0,d=r.length;c<d;a=++c)n=r[a],e.pos=n.offset,l=e.readString(n.length),s=new wC(l,n),null==o[u=n.nameID]&&(o[u]=[]),o[n.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(hS){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},e}(),jC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),kC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,r,n,a,s,i,o;for(e.pos=this.offset,this.metrics=[],t=0,i=this.file.hhea.numberOfMetrics;0<=i?t<i:t>i;t=0<=i?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var r,a;for(a=[],t=r=0;0<=n?r<n:r>n;t=0<=n?++r:--r)a.push(e.readInt16());return a}(),this.widths=function(){var e,t,r,n;for(n=[],e=0,t=(r=this.metrics).length;e<t;e++)a=r[e],n.push(a.advance);return n}.call(this),r=this.widths[this.widths.length-1],o=[],t=s=0;0<=n?s<n:s>n;t=0<=n?++s:--s)o.push(this.widths.push(r));return o},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),SC=[].slice,AC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,r,n,a,s,i,o,l,c,d;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,r=a.indexOf(e),0===(n=a.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+r,s=(i=new uC(t.read(n))).readShort(),l=i.readShort(),d=i.readShort(),o=i.readShort(),c=i.readShort(),this.cache[e]=-1===s?new _C(i,l,d,o,c):new CC(i,s,l,d,o,c),this.cache[e]))},e.prototype.encode=function(e,t,r){var n,a,s,i,o;for(s=[],a=[],i=0,o=t.length;i<o;i++)n=e[t[i]],a.push(s.length),n&&(s=s.concat(n.encode(r)));return a.push(s.length),{table:s,offsets:a}},e}(),CC=function(){function e(e,t,r,n,a,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),_C=function(){function e(e,t,r,n,a){var s,i;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=n,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;i=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&i;)s.pos+=1&i?4:2,128&i?s.pos+=8:64&i?s.pos+=4:8&i&&(s.pos+=2)}return e.prototype.encode=function(){var e,t,r;for(t=new uC(SC.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),TC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mC(e,dC),e.prototype.tag="loca",e.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,n;for(n=[],r=0,t=this.length;r<t;r+=2)n.push(2*e.readUInt16());return n}.call(this):function(){var t,n;for(n=[],r=0,t=this.length;r<t;r+=4)n.push(e.readUInt32());return n}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),n=0,a=0,s=0;s<r.length;++s)if(r[s]=n,a<t.length&&t[a]==s){++a,r[s]=n;var i=this.offsets[s],o=this.offsets[s+1]-i;o>0&&(n+=o)}for(var l=new Array(4*r.length),c=0;c<r.length;++c)l[4*c+3]=255&r[c],l[4*c+2]=(65280&r[c])>>8,l[4*c+1]=(16711680&r[c])>>16,l[4*c]=(4278190080&r[c])>>24;return l},e}(),EC=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,r,n,a;for(t in n=this.font.cmap.tables[0].codeMap,e={},a=this.subset)r=a[t],e[t]=n[r];return e},e.prototype.glyphsFor=function(e){var t,r,n,a,s,i,o;for(n={},s=0,i=e.length;s<i;s++)n[a=e[s]]=this.font.glyf.glyphFor(a);for(a in t=[],n)(null!=(r=n[a])?r.compound:void 0)&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(a in o=this.glyphsFor(t))r=o[a],n[a]=r;return n},e.prototype.encode=function(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g;for(n in r=xC.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),h={0:0},g=r.charMap)h[(o=g[n]).old]=o.new;for(f in u=r.maxGlyphID,s)f in h||(h[f]=u++);return c=function(e){var t,r;for(t in r={},e)r[e[t]]=t;return r}(h),d=Object.keys(c).sort(function(e,t){return e-t}),m=function(){var e,t,r;for(r=[],e=0,t=d.length;e<t;e++)i=d[e],r.push(c[i]);return r}(),a=this.font.glyf.encode(s,m,h),l=this.font.loca.encode(a.offsets,m),p={cmap:this.font.cmap.raw(),glyf:a.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(p["OS/2"]=this.font.os2.raw()),this.font.directory.encode(p)},e}();function LC(e,t,r,n,a){n=n||{};var s=a.internal.scaleFactor,i=a.internal.getFontSize()/s,o=i*(a.getLineHeightFactor?a.getLineHeightFactor():1.15),l="",c=1;if("middle"!==n.valign&&"bottom"!==n.valign&&"center"!==n.halign&&"right"!==n.halign||(c=(l="string"===typeof e?e.split(/\r\n|\r|\n/g):e).length||1),r+=i*(2-1.15),"middle"===n.valign?r-=c/2*o:"bottom"===n.valign&&(r-=c*o),"center"===n.halign||"right"===n.halign){var d=i;if("center"===n.halign&&(d*=.5),l&&c>=1){for(var u=0;u<l.length;u++)a.text(l[u],t-a.getStringUnitWidth(l[u])*d,r),r+=o;return a}t-=a.getStringUnitWidth(e)*d}return"justify"===n.halign?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}DS.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(r){var n,a,s,i;if(Array.isArray(r))return"["+function(){var e,a,s;for(s=[],e=0,a=r.length;e<a;e++)n=r[e],s.push(t.convert(n));return s}().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(r)){for(a in s=["<<"],r)i=r[a],s.push("/"+a+" "+t.convert(i));return s.push(">>"),s.join("\n")}return""+r},t}();var PC={},OC=function(){function e(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(e,t){void 0===t&&(t=null),t?t.__autoTableDocumentDefaults=e:PC=e},e.unifyColor=function(e){return Array.isArray(e)?e:"number"===typeof e?[e,e,e]:"string"===typeof e?[e]:null},e.prototype.applyStyles=function(t,r){var n,a,s;void 0===r&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,l=i.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[l];c&&-1===c.indexOf(o)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var d=e.unifyColor(t.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),(d=e.unifyColor(t.textColor))&&(a=this.jsPDFDocument).setTextColor.apply(a,d),(d=e.unifyColor(t.lineColor))&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),"number"===typeof t.lineWidth&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(e,t,r){return this.jsPDFDocument.splitTextToSize(e,t,r)},e.prototype.rect=function(e,t,r,n,a){return this.jsPDFDocument.rect(e,t,r,n,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return PC||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return null==e.width&&(e={width:e.getWidth(),height:e.getHeight()}),e},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),FC=function(e,t){return FC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},FC(e,t)};function IC(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}FC(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}"function"===typeof SuppressedError&&SuppressedError;var RC=function(e){function t(t){var r=e.call(this)||this;return r._element=t,r}return IC(t,e),t}(Array);function DC(e,t,r){r.applyStyles(t,!0);var n=(Array.isArray(e)?e:[e]).map(function(e){return r.getTextWidth(e)}).reduce(function(e,t){return Math.max(e,t)},0);return n}function MC(e,t,r,n){var a=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:s});var i=BC(a,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function BC(e,t){var r=e>0,n=t||0===t;return r&&n?"DF":r?"S":n?"F":null}function UC(e,t){var r,n,a,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:t}return"object"===typeof e?("number"===typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"===typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(r=e.left)&&void 0!==r?r:t,top:null!==(n=e.top)&&void 0!==n?n:t,right:null!==(a=e.right)&&void 0!==a?a:t,bottom:null!==(s=e.bottom)&&void 0!==s?s:t}):("number"!==typeof e&&(e=t),{top:e,right:e,bottom:e,left:e})}function zC(e,t){var r=UC(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function qC(e,t,r,n,a){var s={},i=96/72,o=HC(t,function(e){return a.getComputedStyle(e).backgroundColor});null!=o&&(s.fillColor=o);var l=HC(t,function(e){return a.getComputedStyle(e).color});null!=l&&(s.textColor=l);var c=function(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=r.map(function(e){return parseInt(e||"0")/n}),i=UC(s,0);a>i.top&&(i.top=a);a>i.bottom&&(i.bottom=a);return i}(n,r);c&&(s.cellPadding=c);var d="borderTopColor",u=i*r,h=n.borderTopWidth;if(n.borderBottomWidth===h&&n.borderRightWidth===h&&n.borderLeftWidth===h){var f=(parseFloat(h)||0)/u;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/u,right:(parseFloat(n.borderRightWidth)||0)/u,bottom:(parseFloat(n.borderBottomWidth)||0)/u,left:(parseFloat(n.borderLeftWidth)||0)/u},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=HC(t,function(e){return a.getComputedStyle(e)[d]});null!=m&&(s.lineColor=m);var p=["left","right","center","justify"];-1!==p.indexOf(n.textAlign)&&(s.halign=n.textAlign),-1!==(p=["middle","bottom","top"]).indexOf(n.verticalAlign)&&(s.valign=n.verticalAlign);var g=parseInt(n.fontSize||"");isNaN(g)||(s.fontSize=g/i);var x=function(e){var t="";("bold"===e.fontWeight||"bolder"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(t="bold");"italic"!==e.fontStyle&&"oblique"!==e.fontStyle||(t+="italic");return t}(n);x&&(s.fontStyle=x);var b=(n.fontFamily||"").toLowerCase();return-1!==e.indexOf(b)&&(s.font=b),s}function HC(e,t){var r=WC(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];return 0===parseInt(n[4])||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function WC(e,t){var r=t(e);return"rgba(0, 0, 0, 0)"===r||"transparent"===r||"initial"===r||"inherit"===r?null==e.parentElement?null:WC(e.parentElement,t):r}function VC(e,t,r,n,a){var s,i,o;void 0===n&&(n=!1),void 0===a&&(a=!1),o="string"===typeof t?r.document.querySelector(t):t;var l=Object.keys(e.getFontList()),c=e.scaleFactor(),d=[],u=[],h=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:d,body:u,foot:h};for(var f=0;f<o.rows.length;f++){var m=o.rows[f],p=null===(i=null===(s=null===m||void 0===m?void 0:m.parentElement)||void 0===s?void 0:s.tagName)||void 0===i?void 0:i.toLowerCase(),g=GC(l,c,r,m,n,a);g&&("thead"===p?d.push(g):"tfoot"===p?h.push(g):u.push(g))}return{head:d,body:u,foot:h}}function GC(e,t,r,n,a,s){for(var i=new RC(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=r.getComputedStyle(l);if(a||"none"!==c.display){var d=void 0;s&&(d=qC(e,l,t,c,r)),i.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:d,_element:l,content:KC(l)})}}var u=r.getComputedStyle(n);if(i.length>0&&(a||"none"!==u.display))return i}function KC(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join("\n"),t.innerText||t.textContent||""}function YC(e,t,r,n,a){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(s[l]=o[l])}return s}function XC(e,t){var r=new OC(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();!function(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var s=a[n];s&&"object"!==typeof s&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&"number"!==typeof s.startY&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}(a,n,t);var s,i=YC({},a,n,t);"undefined"!==typeof window&&(s=window);var o=function(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(a){if("columnStyles"===a){var s=e[a],i=t[a],o=r[a];n.columnStyles=YC({},s,i,o)}else{var l=[e,t,r].map(function(e){return e[a]||{}});n[a]=YC({},l[0],l[1],l[2])}},s=0,i=Object.keys(n);s<i.length;s++){a(i[s])}return n}(a,n,t),l=function(e,t,r){for(var n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,s=[e,t,r];a<s.length;a++){var i=s[a];i.didParseCell&&n.didParseCell.push(i.didParseCell),i.willDrawCell&&n.willDrawCell.push(i.willDrawCell),i.didDrawCell&&n.didDrawCell.push(i.didDrawCell),i.willDrawPage&&n.willDrawPage.push(i.willDrawPage),i.didDrawPage&&n.didDrawPage.push(i.didDrawPage)}return n}(a,n,t),c=function(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g=UC(t.margin,40/e.scaleFactor()),x=null!==(r=function(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),s=!1;if(r&&r.startPageNumber){s=r.startPageNumber+r.pageNumber-1===a}if("number"===typeof t)return t;if((null==t||!1===t)&&s&&null!=(null===r||void 0===r?void 0:r.finalY))return r.finalY+20/n;return null}(e,t.startY))&&void 0!==r?r:g.top;m=!0===t.showFoot?"everyPage":!1===t.showFoot?"never":null!==(n=t.showFoot)&&void 0!==n?n:"everyPage";p=!0===t.showHead?"everyPage":!1===t.showHead?"never":null!==(a=t.showHead)&&void 0!==a?a:"everyPage";var b=null!==(s=t.useCss)&&void 0!==s&&s,v=t.theme||(b?"plain":"striped"),y=!!t.horizontalPageBreak,w=null!==(i=t.horizontalPageBreakRepeat)&&void 0!==i?i:null;return{includeHiddenHtml:null!==(o=t.includeHiddenHtml)&&void 0!==o&&o,useCss:b,theme:v,startY:x,margin:g,pageBreak:null!==(l=t.pageBreak)&&void 0!==l?l:"auto",rowPageBreak:null!==(c=t.rowPageBreak)&&void 0!==c?c:"auto",tableWidth:null!==(d=t.tableWidth)&&void 0!==d?d:"auto",showHead:p,showFoot:m,tableLineWidth:null!==(u=t.tableLineWidth)&&void 0!==u?u:0,tableLineColor:null!==(h=t.tableLineColor)&&void 0!==h?h:200,horizontalPageBreak:y,horizontalPageBreakRepeat:w,horizontalPageBreakBehaviour:null!==(f=t.horizontalPageBreakBehaviour)&&void 0!==f?f:"afterAllRows"}}(r,i),d=function(e,t,r){var n=t.head||[],a=t.body||[],s=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var o=VC(e,t.html,r,i,t.useCss)||{};n=o.head||n,a=o.body||n,s=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||function(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(e){return"_element"!==e}).forEach(function(e){var t,r=1;"object"!==typeof(t=Array.isArray(n)?n[parseInt(e)]:n[e])||Array.isArray(t)||(r=(null===t||void 0===t?void 0:t.colSpan)||1);for(var s=0;s<r;s++){var i={dataKey:Array.isArray(n)?a.length:e+(s>0?"_".concat(s):"")};a.push(i)}}),a}(n,a,s);return{columns:l,head:n,body:a,foot:s}}(r,i,s);return{id:t.tableId,content:d,hooks:l,styles:o,settings:c}}var $C,JC=function(e,t,r){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=r,this.doc=e.getDocument()},QC=function(e){function t(t,r,n,a,s,i){var o=e.call(this,t,r,i)||this;return o.cell=n,o.row=a,o.column=s,o.section=a.section,o}return IC(t,e),t}(JC),ZC=function(){function e(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},e.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(e,t,r,n,a,s){for(var i=0,o=t;i<o.length;i++){var l=!1===(0,o[i])(new QC(e,this,r,n,a,s));if(r.text=Array.isArray(r.text)?r.text:[r.text],l)return!1}return!0},e.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var r=0,n=this.hooks.didDrawPage;r<n.length;r++){(0,n[r])(new JC(e,this,t))}},e.prototype.callWillDrawPageHooks=function(e,t){for(var r=0,n=this.hooks.willDrawPage;r<n.length;r++){(0,n[r])(new JC(e,this,t))}},e.prototype.getWidth=function(e){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(e,t){return e+t.wrappedWidth},0);var t=this.settings.margin;return e-t.left-t.right},e}(),e_=function(){function e(e,t,r,n,a){void 0===a&&(a=!1),this.height=0,this.raw=e,e instanceof RC&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=r,this.cells=n,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(e,r){var n;return Math.max(e,(null===(n=t.cells[r.index])||void 0===n?void 0:n.height)||0)},0)},e.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(e){var r=t.cells[e.index];return!!r&&r.rowSpan>1}).length>0},e.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},e.prototype.getMinimumRowHeight=function(e,t){var r=this;return e.reduce(function(e,n){var a=r.cells[n.index];if(!a)return 0;var s=t.getLineHeight(a.styles.fontSize),i=a.padding("vertical")+s;return i>e?i:e},0)},e}(),t_=function(){function e(e,t,r){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=r,this.raw=e;var a=e;null==e||"object"!==typeof e||Array.isArray(e)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=null!==(n=e.content)&&void 0!==n?n:e,e._element&&(this.raw=e._element));var s=null!=a?""+a:"";this.text=s.split(/\r\n|\r|\n/g)}return e.prototype.getTextPos=function(){var e,t;if("top"===this.styles.valign)e=this.y+this.padding("top");else if("bottom"===this.styles.valign)e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}if("right"===this.styles.halign)t=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var n=this.width-this.padding("horizontal");t=this.x+n/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},e.prototype.getContentHeight=function(e,t){void 0===t&&(t=1.15);var r=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/e*t)+this.padding("vertical");return Math.max(r,this.styles.minCellHeight)},e.prototype.padding=function(e){var t=UC(this.styles.cellPadding,0);return"vertical"===e?t.top+t.bottom:"horizontal"===e?t.left+t.right:t[e]},e}(),r_=function(){function e(e,t,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=r}return e.prototype.getMaxCustomCellWidth=function(e){for(var t=0,r=0,n=e.allRows();r<n.length;r++){var a=n[r].cells[this.index];a&&"number"===typeof a.styles.cellWidth&&(t=Math.max(t,a.styles.cellWidth))}return t},e}();function n_(e,t){!function(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=zC(e,t);t.allRows().forEach(function(s){for(var i=0,o=t.columns;i<o.length;i++){var l=o[i],c=s.cells[l.index];if(c){var d=t.hooks.didParseCell;t.callCellHooks(e,d,c,s,l,null);var u=c.padding("horizontal");c.contentWidth=DC(c.text,c.styles,e)+u;var h=DC(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,e);if(c.minReadableWidth=h+c.padding("horizontal"),"number"===typeof c.styles.cellWidth)c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if("wrap"===c.styles.cellWidth||!0===n)c.contentWidth>a?(c.minWidth=a,c.wrappedWidth=a):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var f=10/r;c.minWidth=c.styles.minCellWidth||f,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(e){for(var r=0,n=t.columns;r<n.length;r++){var a=n[r],s=e.cells[a.index];if(s&&1===s.colSpan)a.wrappedWidth=Math.max(a.wrappedWidth,s.wrappedWidth),a.minWidth=Math.max(a.minWidth,s.minWidth),a.minReadableWidth=Math.max(a.minReadableWidth,s.minReadableWidth);else{var i=t.styles.columnStyles[a.dataKey]||t.styles.columnStyles[a.index]||{},o=i.cellWidth||i.minCellWidth;o&&"number"===typeof o&&(a.minWidth=o,a.wrappedWidth=o)}s&&(s.colSpan>1&&!a.minWidth&&(a.minWidth=s.minWidth),s.colSpan>1&&!a.wrappedWidth&&(a.wrappedWidth=s.minWidth))}})}(e,t);var r=[],n=0;t.columns.forEach(function(e){var a=e.getMaxCustomCellWidth(t);a?e.width=a:(e.width=e.wrappedWidth,r.push(e)),n+=e.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=a_(r,a,function(e){return Math.max(e.minReadableWidth,e.minWidth)})),a&&(a=a_(r,a,function(e){return e.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),function(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,s=0,i=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if((i-=1)>1&&e.columns[o+1])s+=l.width,delete n.cells[l.index];else if(a){var c=a;delete n.cells[l.index],a=null,c.width=l.width+s}else{if(!(c=n.cells[l.index]))continue;if(i=c.colSpan,s=0,c.colSpan>1){a=c,s+=l.width;continue}c.width=l.width+s}}}(t),function(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var s=a[n],i=0,o=e.columns;i<o.length;i++){var l=o[i],c=s.cells[l.index];if(c){t.applyStyles(c.styles,!0);var d=c.width-c.padding("horizontal");if("linebreak"===c.styles.overflow)c.text=t.splitTextToSize(c.text,d+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if("ellipsize"===c.styles.overflow)c.text=s_(c.text,d,c.styles,t,"...");else if("hidden"===c.styles.overflow)c.text=s_(c.text,d,c.styles,t,"");else if("function"===typeof c.styles.overflow){var u=c.styles.overflow(c.text,d);c.text="string"===typeof u?[u]:u}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=c.contentHeight/c.rowSpan;c.rowSpan>1&&r.count*r.height<h*c.rowSpan?r={height:h,count:c.rowSpan}:r&&r.count>0&&r.height>h&&(h=r.height),h>s.height&&(s.height=h)}}r.count--}}(t,e),function(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var s=n[a],i=0,o=e.columns;i<o.length;i++){var l=o[i],c=t[l.index];if(r>1)r--,delete s.cells[l.index];else if(c)c.cell.height+=s.height,r=c.cell.colSpan,delete s.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var d=s.cells[l.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var u=n.length-a,h=d.rowSpan>u?u:d.rowSpan;t[l.index]={cell:d,left:h,row:s}}}}}(t)}function a_(e,t,r){for(var n=t,a=e.reduce(function(e,t){return e+t.wrappedWidth},0),s=0;s<e.length;s++){var i=e[s],o=n*(i.wrappedWidth/a),l=i.width+o,c=r(i),d=l<c?c:l;t-=d-i.width,i.width=d}if(t=Math.round(1e10*t)/1e10){var u=e.filter(function(e){return!(t<0)||e.width>r(e)});u.length&&(t=a_(u,t,r))}return t}function s_(e,t,r,n,a){return e.map(function(e){return function(e,t,r,n,a){var s=1e4*n.scaleFactor();if(t=Math.ceil(t*s)/s,t>=DC(e,r,n))return e;for(;t<DC(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}(e,t,r,n,a)})}function i_(e,t){var r=new OC(e),n=function(e,t){var r=e.content,n=function(e){return e.map(function(e,t){var r,n;return n="object"===typeof e&&null!==(r=e.dataKey)&&void 0!==r?r:t,new r_(n,e,t)})}(r.columns);if(0===r.head.length){(a=l_(n,"head"))&&r.head.push(a)}if(0===r.foot.length){var a;(a=l_(n,"foot"))&&r.foot.push(a)}var s=e.settings.theme,i=e.styles;return{columns:n,head:o_("head",r.head,n,i,s,t),body:o_("body",r.body,n,i,s,t),foot:o_("foot",r.foot,n,i,s,t)}}(t,r.scaleFactor()),a=new ZC(t,n);return n_(r,a),r.applyStyles(r.userStyles),a}function o_(e,t,r,n,a,s){var i={};return t.map(function(t,o){for(var l=0,c={},d=0,u=0,h=0,f=r;h<f.length;h++){var m=f[h];if(null==i[m.index]||0===i[m.index].left)if(0===u){var p=void 0,g={};"object"!==typeof(p=Array.isArray(t)?t[m.index-d-l]:t[m.dataKey])||Array.isArray(p)||(g=(null===p||void 0===p?void 0:p.styles)||{});var x=c_(e,m,o,a,n,s,g),b=new t_(p,x,e);c[m.dataKey]=b,c[m.index]=b,u=b.colSpan-1,i[m.index]={left:b.rowSpan-1,times:u}}else u--,d++;else i[m.index].left--,u=i[m.index].times,l++}return new e_(t,o,e,c)})}function l_(e,t){var r={};return e.forEach(function(e){if(null!=e.raw){var n=function(e,t){if("head"===e){if("object"===typeof t)return t.header||null;if("string"===typeof t||"number"===typeof t)return t}else if("foot"===e&&"object"===typeof t)return t.footer;return null}(t,e.raw);null!=n&&(r[e.dataKey]=n)}}),Object.keys(r).length>0?r:null}function c_(e,t,r,n,a,s,i){var o,l={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[n];"head"===e?o=a.headStyles:"body"===e?o=a.bodyStyles:"foot"===e&&(o=a.footStyles);var c=YC({},l.table,l[e],a.styles,o),d=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},u="body"===e?d:{},h="body"===e&&r%2===0?YC({},l.alternateRow,a.alternateRowStyles):{},f=function(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(s),m=YC({},f,c,h,u);return YC(m,i)}function d_(e,t,r){var n;void 0===r&&(r={});var a=zC(e,t),s=new Map,i=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:"string"!==typeof t.settings.horizontalPageBreakRepeat&&"number"!==typeof t.settings.horizontalPageBreakRepeat||(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(e){var r=t.columns.find(function(t){return t.dataKey===e||t.index===e});r&&!s.has(r.index)&&(s.set(r.index,!0),i.push(r.index),o.push(t.columns[r.index]),a-=r.wrappedWidth)});for(var c=!0,d=null!==(n=null===r||void 0===r?void 0:r.start)&&void 0!==n?n:0;d<t.columns.length;)if(s.has(d))d++;else{var u=t.columns[d].wrappedWidth;if(!(c||a>=u))break;c=!1,i.push(d),o.push(t.columns[d]),a-=u,d++}return{colIndexes:i,columns:o,lastIndex:d-1}}function u_(e,t){var r=t.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+a.bottom+i;"avoid"===r.pageBreak&&(o+=t.body.reduce(function(e,t){return e+t.height},0));var l=new OC(e);("always"===r.pageBreak||null!=r.startY&&o>l.pageSize().height)&&(w_(l),s.y=a.top),t.callWillDrawPageHooks(l,s);var c=YC({},s);t.startPageNumber=l.pageNumber(),r.horizontalPageBreak?function(e,t,r,n){var a=function(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=d_(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}(e,t),s=t.settings;if("afterAllRows"===s.horizontalPageBreakBehaviour)a.forEach(function(a,s){e.applyStyles(e.userStyles),s>0?y_(e,t,r,n,a.columns,!0):h_(e,t,n,a.columns),function(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(s,i){var o=i===t.body.length-1;g_(e,t,s,o,r,n,a)})}(e,t,r,n,a.columns),m_(e,t,n,a.columns)});else for(var i=-1,o=a[0],l=function(){var s=i;if(o){e.applyStyles(e.userStyles);var l=o.columns;i>=0?y_(e,t,r,n,l,!0):h_(e,t,n,l),s=f_(e,t,i+1,n,l),m_(e,t,n,l)}var c=s-i;a.slice(1).forEach(function(a){e.applyStyles(e.userStyles),y_(e,t,r,n,a.columns,!0),f_(e,t,i+1,n,a.columns,c),m_(e,t,n,a.columns)}),i=s};i<t.body.length-1;)l()}(l,t,c,s):(l.applyStyles(l.userStyles),"firstPage"!==r.showHead&&"everyPage"!==r.showHead||t.head.forEach(function(e){return x_(l,t,e,s,t.columns)}),l.applyStyles(l.userStyles),t.body.forEach(function(e,r){var n=r===t.body.length-1;g_(l,t,e,n,c,s,t.columns)}),l.applyStyles(l.userStyles),"lastPage"!==r.showFoot&&"everyPage"!==r.showFoot||t.foot.forEach(function(e){return x_(l,t,e,s,t.columns)})),MC(l,t,c,s),t.callEndPageHooks(l,s),t.finalY=s.y,e.lastAutoTable=t,l.applyStyles(l.userStyles)}function h_(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),"firstPage"!==a.showHead&&"everyPage"!==a.showHead||t.head.forEach(function(a){return x_(e,t,a,r,n)})}function f_(e,t,r,n,a,s){e.applyStyles(e.userStyles),s=null!==s&&void 0!==s?s:t.body.length;var i=Math.min(r+s,t.body.length),o=-1;return t.body.slice(r,i).forEach(function(s,i){var l=r+i===t.body.length-1,c=v_(e,t,l,n);s.canEntireRowFit(c,a)&&(x_(e,t,s,n,a),o=r+i)}),o}function m_(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),"lastPage"!==a.showFoot&&"everyPage"!==a.showFoot||t.foot.forEach(function(a){return x_(e,t,a,r,n)})}function p_(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),s=Math.floor((t-a)/n);return Math.max(0,s)}function g_(e,t,r,n,a,s,i){var o=v_(e,t,n,s);if(r.canEntireRowFit(o,i))x_(e,t,r,s,i);else if(function(e,t,r,n){var a=e.pageSize().height,s=n.settings.margin,i=a-(s.top+s.bottom);"body"===t.section&&(i-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var o=t.getMinimumRowHeight(n.columns,e),l=o<r;if(o>i)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!l)return!1;var c=t.hasRowSpan(n.columns);return t.getMaxCellHeight(n.columns)>i?(c&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!c&&"avoid"!==n.settings.rowPageBreak}(e,r,o,t)){var l=function(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var s=0,i=0,o=r.columns;i<o.length;i++){var l=o[i];if(g=e.cells[l.index]){Array.isArray(g.text)||(g.text=[g.text]),(p=YC(p=new t_(g.raw,g.styles,g.section),g)).text=[];var c=p_(g,t,n);g.text.length>c&&(p.text=g.text.splice(c,g.text.length));var d=n.scaleFactor(),u=n.getLineHeightFactor();g.contentHeight=g.getContentHeight(d,u),g.contentHeight>=t&&(g.contentHeight=t,p.styles.minCellHeight-=t),g.contentHeight>e.height&&(e.height=g.contentHeight),p.contentHeight=p.getContentHeight(d,u),p.contentHeight>s&&(s=p.contentHeight),a[l.index]=p}}var h=new e_(e.raw,-1,e.section,a,!0);h.height=s;for(var f=0,m=r.columns;f<m.length;f++){var p,g;l=m[f],(p=h.cells[l.index])&&(p.height=h.height),(g=e.cells[l.index])&&(g.height=e.height)}return h}(r,o,t,e);x_(e,t,r,s,i),y_(e,t,a,s,i),g_(e,t,l,n,a,s,i)}else y_(e,t,a,s,i),g_(e,t,r,n,a,s,i)}function x_(e,t,r,n,a){n.x=t.settings.margin.left;for(var s=0,i=a;s<i.length;s++){var o=i[s],l=r.cells[o.index];if(l)if(e.applyStyles(l.styles),l.x=n.x,l.y=n.y,!1!==t.callCellHooks(e,t.hooks.willDrawCell,l,r,o,n)){b_(e,l,n);var c=l.getTextPos();LC(l.text,c.x,c.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,r,o,n),n.x+=o.width}else n.x+=o.width;else n.x+=o.width}n.y+=r.height}function b_(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),"number"===typeof n.lineWidth){var a=BC(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else"object"===typeof n.lineWidth&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),function(e,t,r,n){var a,s,i,o;n.top&&(a=r.x,s=r.y,i=r.x+t.width,o=r.y,n.right&&(i+=.5*n.right),n.left&&(a-=.5*n.left),l(n.top,a,s,i,o));n.bottom&&(a=r.x,s=r.y+t.height,i=r.x+t.width,o=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(a-=.5*n.left),l(n.bottom,a,s,i,o));n.left&&(a=r.x,s=r.y,i=r.x,o=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,a,s,i,o));n.right&&(a=r.x+t.width,s=r.y,i=r.x+t.width,o=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,a,s,i,o));function l(t,r,n,a,s){e.getDocument().setLineWidth(t),e.getDocument().line(r,n,a,s,"S")}}(e,t,r,n.lineWidth))}function v_(e,t,r,n){var a=t.settings.margin.bottom,s=t.settings.showFoot;return("everyPage"===s||"lastPage"===s&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function y_(e,t,r,n,a,s){void 0===a&&(a=[]),void 0===s&&(s=!1),e.applyStyles(e.userStyles),"everyPage"!==t.settings.showFoot||s||t.foot.forEach(function(r){return x_(e,t,r,n,a)}),t.callEndPageHooks(e,n);var i=t.settings.margin;MC(e,t,r,n),w_(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),"everyPage"===t.settings.showHead&&(t.head.forEach(function(r){return x_(e,t,r,n,a)}),e.applyStyles(e.userStyles))}function w_(e){var t=e.pageNumber();return e.setPage(t+1),e.pageNumber()===t&&(e.addPage(),!0)}function N_(e,t){u_(e,i_(e,XC(e,t)))}try{if("undefined"!==typeof window&&window){var j_=window,k_=j_.jsPDF||(null===($C=j_.jspdf)||void 0===$C?void 0:$C.jsPDF);k_&&function(e){e.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u_(this,i_(this,XC(this,e[0]))),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(e,t,r,n){LC(e,t,r,n,this)},e.API.autoTableSetDefaults=function(e){return OC.setDefaults(e,this),this},e.autoTableSetDefaults=function(e,t){OC.setDefaults(e,t)},e.API.autoTableHtmlToJson=function(e,t){var r;if(void 0===t&&(t=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=VC(new OC(this),e,window,t,!1),a=n.head,s=n.body,i=(null===(r=a[0])||void 0===r?void 0:r.map(function(e){return e.content}))||[];return{columns:i,rows:s,data:s}}}(k_)}}catch(X_){console.error("Could not apply autoTable plugin",X_)}function S_(e,t,r,n,a){const s=t.filter(e=>e.chargeableWeight||e.weightBreaker||e.charge);if(0===s.length)return r;r>230&&(e.addPage(),r=20),e.setFont("helvetica","bold"),e.setFontSize(9),e.text("Freight Charges (Segment ".concat(a,")"),15,r);return N_(e,{startY:r+=3,head:[["Chargeable Weight","Weight Breaker","Pricing Unit","Charge","Currency","Total"]],body:s.map(e=>{const t=(parseFloat(e.chargeableWeight)||0)*(parseFloat(e.charge)||0);return[e.chargeableWeight||"",e.weightBreaker||"",e.pricingUnit||"",e.charge||"",e.currency||"USD",t.toFixed(2)]}),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:8,fontStyle:"bold"},bodyStyles:{fontSize:8},columnStyles:{0:{cellWidth:30},1:{cellWidth:30},2:{cellWidth:30},3:{cellWidth:25},4:{cellWidth:20},5:{cellWidth:25}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}function A_(e){let t=0;return e.forEach(e=>{(e.freightChargesTables||e.freightCharges||[]).forEach(e=>{const r=parseFloat(e.chargeableWeight)||0,n=parseFloat(e.charge)||0;t+=r*n}),e.originHandling&&e.originHandling.forEach(e=>{t+=C_(e)}),e.destinationHandling&&e.destinationHandling.forEach(e=>{t+=C_(e)})}),t}const C_=e=>{if(e.total&&parseFloat(e.total)>0)return parseFloat(e.total);return(parseFloat(e.numberOfUnits)||1)*(parseFloat(e.amount)||0)},__=(e,t)=>{let r=15;return e.addImage(wn,"PNG",15,r,35,14),e.setFontSize(11),e.setFont("helvetica","bold"),e.text("Scanwell Logistics Colombo (Pvt) Ltd.",195,r+2,{align:"right"}),e.setFontSize(9),e.setFont("helvetica","normal"),e.text("67/1 Hudson Road Colombo 3 Sri Lanka.",195,r+7,{align:"right"}),e.text("Office #+94 11 2426600/4766400",195,r+12,{align:"right"}),r+=25,e.setFontSize(16),e.setFont("helvetica","bold"),e.text("QUOTATION",105,r,{align:"center"}),r+12},T_=(e,t,r)=>{var n,a,s;e.setFontSize(11),e.setFont("helvetica","bold"),e.text(t.quoteNumber||"N/A",15,r);const i="air"===t.freightCategory?"Air":"Sea",o=(null===(n=t.freightMode)||void 0===n?void 0:n.charAt(0).toUpperCase())+(null===(a=t.freightMode)||void 0===a?void 0:a.slice(1)),l=null===(s=t.freightType)||void 0===s?void 0:s.toUpperCase(),c="".concat(i," ").concat(o," ").concat(l);if(e.text(c,195,r,{align:"right"}),r+=5,e.setFontSize(9),e.setFont("helvetica","normal"),e.text("Credit Terms",195,r,{align:"right"}),t.rateValidity){r+=4;const n=new Date(t.rateValidity).toLocaleDateString("en-GB");e.text("Rate Validity: ".concat(n,", 05:30"),195,r,{align:"right"})}r+=10,e.setFontSize(9),e.setFont("helvetica","bold"),e.text("Customer",15,r),t.customerAddress&&""!==t.customerAddress.trim()&&e.text("Customer Address",130,r),e.setFont("helvetica","normal");const d=r+=4;e.text(t.customer||"N/A",15,r);let u=0;if(t.customerAddress&&""!==t.customerAddress.trim()){e.setFont("helvetica","normal");const r=e.splitTextToSize(t.customerAddress,70);r.forEach((t,r)=>{e.text(t,130,d+4*r)}),u=r.length}return r+=4*Math.max(1,u)+4,e.setFont("helvetica","bold"),e.text("Pickup Address",15,r),e.text("Delivery Address",130,r),e.setFont("helvetica","normal"),r+=4,e.text(t.pickupLocation||"N/A",15,r),e.text(t.deliveryLocation||"N/A",130,r),r+=8},E_=e=>{const t=new DS;let r=__(t);r=T_(t,e,r);const n=e.equipment?JSON.parse(e.equipment):{},a=e.termsConditions?JSON.parse(e.termsConditions):[],s="air"===e.freightCategory;let i=[];if(e.carrierOptions)i=JSON.parse(e.carrierOptions);else{const t=e.carriers?JSON.parse(e.carriers):[],r=e.freightCharges?JSON.parse(e.freightCharges):[],n=e.destinationCharges?JSON.parse(e.destinationCharges):[],a=e.originHandling?JSON.parse(e.originHandling):[],s=e.destinationHandling?JSON.parse(e.destinationHandling):[];var o,l,c,d;if(t.length>0||r.length>0)i=[{carrier:(null===(o=t[0])||void 0===o?void 0:o.carrier)||"",incoterm:(null===(l=t[0])||void 0===l?void 0:l.incoterm)||"",currency:(null===(c=t[0])||void 0===c?void 0:c.currency)||"",cargoType:(null===(d=t[0])||void 0===d?void 0:d.cargoType)||"",freightCharges:r,destinationCharges:n,originHandling:a,destinationHandling:s}]}t.line(15,r,195,r),r+=5,t.setFont("helvetica","bold"),t.text("Port of Loading",15,r),t.text("Port of Discharge",130,r),t.setFont("helvetica","normal"),r+=4,t.text(e.portOfLoading||"N/A",15,r),t.text(e.portOfDischarge||"N/A",130,r),r+=8,t.setFont("helvetica","bold"),t.text("Equipment",15,r),t.text("Units",70,r),t.text("Gross Weight",95,r),t.text("Volume (m\xb3)",135,r),t.text("Chargeable Weight",165,r),r+=4,t.setFont("helvetica","normal"),t.text(n.equipment||"N/A",15,r),t.text(n.units||"0",70,r),t.text(n.grossWeight||"0",95,r),t.text(n.volume||"0",135,r),t.text(n.chargeableWeight||"0",165,r),r+=10,i.length>0&&i.forEach((e,n)=>{if(r>240&&(t.addPage(),r=20),i.length>1&&(t.setFillColor(230,230,230),t.rect(15,r-3,180,7,"F"),t.setFont("helvetica","bold"),t.setFontSize(10),t.text("".concat(s?"Airline":"Carrier"," Option [").concat(n+1,"]"),18,r+2),r+=10),e.carrier||e.incoterm||e.currency||e.cargoType){t.setFontSize(9),t.setFont("helvetica","bold"),r+=2,t.setFont("helvetica","normal");let n=[];e.carrier&&n.push("".concat(s?"Airline":"Carrier",": ").concat(e.carrier)),e.incoterm&&n.push("Incoterm: ".concat(e.incoterm)),e.currency&&n.push("Currency: ".concat(e.currency)),e.cargoType&&n.push("Cargo Type: ".concat(e.cargoType)),n.length>0&&(t.text(n.join("  |  "),15,r),r+=8)}r=function(e,t,r,n){const a=t.filter(e=>e.carrier||e.unitType||e.amount);if(0===a.length)return r;r>230&&(e.addPage(),r=20);e.setFont("helvetica","bold"),e.setFontSize(9),e.text("Freight Charges",15,r),r+=3;const s=a.map(e=>{const t=e.numberOfUnits||"",r=C_(e),a=[e.carrier||"",e.unitType||"",t,e.amount||"",e.currency||"",e.transitTime||"",e.numberOfRouting||""];return n&&(a.push(e.surcharge||""),a.push(e.frequency||"")),a.push(r.toFixed(2)),a}),i=["Carrier","Unit Type","Units","Amount","Currency","Transit","Routing"];n&&i.push("Surcharge","Frequency");return i.push("Total"),N_(e,{startY:r,head:[i],body:s,theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:8,fontStyle:"bold"},bodyStyles:{fontSize:8},columnStyles:{0:{cellWidth:n?18:22},1:{cellWidth:18},2:{cellWidth:12},3:{cellWidth:15},4:{cellWidth:18},5:{cellWidth:15},6:{cellWidth:n?18:22}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}(t,e.freightCharges||[],r,s),r=L_(t,e.destinationCharges||[],"Destination Charges (POD)",r),r=L_(t,e.originHandling||[],"Origin Handling Charges",r),r=L_(t,e.destinationHandling||[],"Destination Handling Charges",r);const a=function(e){let t=0;e.freightCharges&&e.freightCharges.forEach(e=>{t+=C_(e)});e.destinationCharges&&e.destinationCharges.forEach(e=>{t+=C_(e)});e.originHandling&&e.originHandling.forEach(e=>{t+=C_(e)});e.destinationHandling&&e.destinationHandling.forEach(e=>{t+=C_(e)});return t}(e);a>0&&(t.setFont("helvetica","bold"),t.text("Total Amount: USD ".concat(a.toFixed(2)),15,r),r+=10)}),a.length>0&&(r>240&&(t.addPage(),r=20),t.setFontSize(9),t.setFont("helvetica","bold"),t.text("Terms & Conditions:",15,r),r+=5,t.setFont("helvetica","normal"),t.setFontSize(8),a.forEach(e=>{t.splitTextToSize("- ".concat(e),170).forEach(e=>{r>280&&(t.addPage(),r=20),t.text(e,15,r),r+=4})})),r=280,t.setFontSize(8),t.setFont("helvetica","italic"),t.text("Quotation generated by - System",15,r),t.text("This is a Computer generated Document and no Signature required.",15,r+4),t.save("".concat(e.quoteNumber||"Quote",".pdf"))};function L_(e,t,r,n){const a=t.filter(e=>e.chargeName||e.amount);if(0===a.length)return n;n>230&&(e.addPage(),n=20),e.setFont("helvetica","bold"),e.setFontSize(9),e.text(r,15,n);return N_(e,{startY:n+=3,head:[["Charge Name","Unit Type","Units","Amount","Currency","Total"]],body:a.map(e=>{const t=e.numberOfUnits||("SHIPMENT"===e.unitType?"1":""),r=C_(e);return[e.chargeName||"",e.unitType||"",t,e.amount||"",e.currency||"",r.toFixed(2)]}),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:0,fontSize:8,fontStyle:"bold"},bodyStyles:{fontSize:8},columnStyles:{0:{cellWidth:50},1:{cellWidth:30},2:{cellWidth:20},3:{cellWidth:25},4:{cellWidth:20},5:{cellWidth:25}},margin:{left:15,right:15}}),e.lastAutoTable.finalY+8}const P_=["quoteId"];function O_(e){let{category:t,mode:r}=e;const n=ae(),[a]=ze(),i=a.get("id"),o="true"===a.get("edit"),l=i&&!o,[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)({quoteNumber:"",createdDate:(new Date).toISOString().split("T")[0],rateValidity:"",customer:"",pickupLocation:"",deliveryLocation:"",portOfLoading:"",portOfDischarge:"",equipment:{equipment:"",units:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},carrierOptions:[{carrier:"",incoterm:"",currency:"",cargoType:"",freightCharges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}],termsConditions:[]});(0,s.useEffect)(()=>{i?m():h(e=>We(We({},e),{},{quoteNumber:Gv()}))},[i]);const f=e=>e?e.split("T")[0]:"",m=async()=>{try{d(!0);const e=await Fa(i);console.log("=== LOAD QUOTE DATA DEBUG ==="),console.log("Raw data from API:",e[0]);let t=[{carrier:"",incoterm:"",currency:"",cargoType:"",freightCharges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}];const r=e[0].carrierOptions||e[0].CarrierOptions;if(r){console.log("carrierOptions exists, raw value:",r);try{const e=JSON.parse(r);console.log("Parsed carrierOptions:",e),Array.isArray(e)&&e.length>0?(console.log("Using new array format"),t=e):e&&"object"===typeof e&&!Array.isArray(e)&&(console.log("Converting from old object format"),t=Object.keys(e).map(t=>{const r=e[t];return{carrier:t,incoterm:r.incoterm||"",currency:r.currency||"",cargoType:r.cargoType||"",freightCharges:r.freightCharges||[{carrier:t,unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:r.destinationCharges||[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:r.originHandling||[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:r.destinationHandling||[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}}),console.log("Converted to array:",t))}catch(K_){console.error("Error parsing carrierOptions:",K_)}}else if(e[0].carriers||e[0].Carriers){console.log("Using very old format with separate fields");try{const r=e[0].carriers||e[0].Carriers,n=e[0].freightCharges||e[0].FreightCharges,a=e[0].destinationCharges||e[0].DestinationCharges,s=e[0].originHandling||e[0].OriginHandling,i=e[0].destinationHandling||e[0].DestinationHandling,o=r?JSON.parse(r):[],l=n?JSON.parse(n):[],c=a?JSON.parse(a):[],d=s?JSON.parse(s):[],u=i?JSON.parse(i):[];console.log("Old format carriers:",o),o.length>0&&(t=o.map((e,t)=>({carrier:e.carrier||"",incoterm:e.incoterm||"",currency:e.currency||"",cargoType:e.cargoType||"",freightCharges:l.length>0?l:[{carrier:e.carrier||"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:c.length>0?c:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:d.length>0?d:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:u.length>0?u:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]})),console.log("Converted old format to:",t))}catch(K_){console.error("Error converting old format:",K_)}}const n={quoteId:e[0].quoteId||e[0].QuoteId||"",quoteNumber:e[0].quoteNumber||e[0].QuoteNumber||"",createdDate:f(e[0].createdDate||e[0].CreatedDate),rateValidity:f(e[0].rateValidity||e[0].RateValidity),customer:e[0].customer||e[0].Customer||"",pickupLocation:e[0].pickupLocation||e[0].PickupLocation||"",deliveryLocation:e[0].deliveryLocation||e[0].DeliveryLocation||"",portOfLoading:e[0].portOfLoading||e[0].PortOfLoading||"",portOfDischarge:e[0].portOfDischarge||e[0].PortOfDischarge||"",equipment:e[0].equipment||e[0].Equipment?JSON.parse(e[0].equipment||e[0].Equipment):{equipment:"",units:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},carrierOptions:t,termsConditions:e[0].termsConditions||e[0].TermsConditions?JSON.parse(e[0].termsConditions||e[0].TermsConditions):[],createdAt:e[0].createdAt||e[0].CreatedAt||""};console.log("Final form data to set:",n),h(n)}catch(X_){console.error("Error loading quote:",X_),alert("Failed to load quote data")}finally{d(!1)}},p=l;return c?(0,xn.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,xn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):(0,xn.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),!u.customer||""===u.customer.trim())return void alert("Customer is required. Please enter a customer name.");const a={quoteId:u.quoteId,quoteNumber:u.quoteNumber,freightCategory:t,freightMode:r,freightType:"direct",createdDate:u.createdDate,rateValidity:u.rateValidity,customer:u.customer,pickupLocation:u.pickupLocation,deliveryLocation:u.deliveryLocation,portOfLoading:u.portOfLoading,portOfDischarge:u.portOfDischarge,equipment:JSON.stringify(u.equipment),carrierOptions:JSON.stringify(u.carrierOptions),termsConditions:JSON.stringify(u.termsConditions),status:"draft",createdBy:11,createdAt:i&&u.createdAt||(new Date).toISOString()};try{if(i)console.log("Update payload:",a),await Ra(a),alert("Quote updated successfully!");else{const{quoteId:e}=a,t=jn(a,P_);await Ia(t),alert("Quote created successfully!")}n(-1)}catch(X_){console.error("Error saving quote:",X_),alert("Failed to save quote")}},className:"space-y-6",children:(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[null===t||void 0===t?void 0:t.toUpperCase()," - ",null===r||void 0===r?void 0:r.toUpperCase()," (Direct)"]}),l&&(0,xn.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"View Mode"}),o&&(0,xn.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Edit Mode"})]}),(0,xn.jsxs)("div",{className:"flex gap-2",children:[i&&(0,xn.jsxs)("button",{type:"button",onClick:async()=>{let e="";if(u.customer)try{e=await ub(u.customer),console.log("Customer Address:",e)}catch(X_){console.error("Error fetching customer address:",X_)}const n={quoteNumber:u.quoteNumber,freightCategory:t,freightMode:r,freightType:"direct",createdDate:u.createdDate,rateValidity:u.rateValidity,customer:u.customer,customerAddress:e,pickupLocation:u.pickupLocation,deliveryLocation:u.deliveryLocation,portOfLoading:u.portOfLoading,portOfDischarge:u.portOfDischarge,equipment:JSON.stringify(u.equipment),carrierOptions:JSON.stringify(u.carrierOptions),termsConditions:JSON.stringify(u.termsConditions)};E_(n)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,xn.jsx)(xv,{size:18}),"Download PDF"]}),(0,xn.jsxs)("button",{type:"button",onClick:()=>n(-1),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[(0,xn.jsx)(bv,{size:18}),"Back"]})]})]}),(0,xn.jsx)(Mv,{formData:u,setFormData:h,disabled:p}),(0,xn.jsx)(Bv,{formData:u,setFormData:h,disabled:p}),(0,xn.jsx)(Uv,{formData:u,setFormData:h,category:t,disabled:p}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"air"===t?"Airline Options":"Sea Options"}),!p&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{p||h(e=>We(We({},e),{},{carrierOptions:[...e.carrierOptions,{carrier:"",incoterm:"",currency:"",cargoType:"",freightCharges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}],destinationCharges:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}]}))},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md transition-all hover:shadow-lg",children:[(0,xn.jsx)(da,{size:18}),"Add Option"]})]}),u.carrierOptions.map((e,r)=>(0,xn.jsx)(Wv,{option:e,index:r,category:t,formData:u,setFormData:h,onRemove:()=>(e=>{p||u.carrierOptions.length<=1||h(t=>We(We({},t),{},{carrierOptions:t.carrierOptions.filter((t,r)=>r!==e)}))})(r),disabled:p,totalOptions:u.carrierOptions.length},r))]}),(0,xn.jsx)(Vv,{formData:u,setFormData:h,disabled:p}),!p&&(0,xn.jsx)("div",{className:"flex justify-end mt-6",children:(0,xn.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,xn.jsx)(qa,{size:18}),i?"Update Quote":"Save Quote"]})})]})})}function F_(e){let{routeOption:t,routeIdx:r,formData:n,setFormData:a,category:s,disabled:i=!1}=e;const o=(e=>"air"===e?wv:"sea"===e?Nv:[...wv,...Nv])(s),l=Iv(s),c=(e,t)=>{if(i)return;const s=[...n.routeOptions];s[r][e]=t,a(e=>We(We({},e),{},{routeOptions:s}))},d=(e,t,s)=>{if(i)return;const o=[...n.routeOptions];o[r].carriers[e][t]=s,a(e=>We(We({},e),{},{routeOptions:o}))};return(0,xn.jsxs)("div",{className:"space-y-6 mb-6",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Route Configuration"}),(0,xn.jsx)("div",{className:"bg-white rounded-lg p-4 border-2 border-blue-200 mb-4",children:(0,xn.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,xn.jsxs)("div",{className:"flex flex-col items-center",children:[(0,xn.jsx)("span",{className:"text-xs text-gray-500 mb-1",children:"Origin"}),(0,xn.jsx)("div",{className:"px-4 py-2 bg-green-100 border-2 border-green-500 rounded-lg font-medium text-sm min-w-[120px] text-center",children:t.origin||"Not set"})]}),(0,xn.jsx)(Ca,{className:"text-blue-500",size:20}),t.transits.map((e,t)=>(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsxs)("div",{className:"flex flex-col items-center",children:[(0,xn.jsxs)("span",{className:"text-xs text-gray-500 mb-1",children:["Transit ",t+1]}),(0,xn.jsx)("div",{className:"px-4 py-2 bg-yellow-100 border-2 border-yellow-500 rounded-lg font-medium text-sm min-w-[120px] text-center",children:e||"Not set"})]}),(0,xn.jsx)(Ca,{className:"text-blue-500",size:20})]},t)),(0,xn.jsxs)("div",{className:"flex flex-col items-center",children:[(0,xn.jsx)("span",{className:"text-xs text-gray-500 mb-1",children:"Destination"}),(0,xn.jsx)("div",{className:"px-4 py-2 bg-red-100 border-2 border-red-500 rounded-lg font-medium text-sm min-w-[120px] text-center",children:t.destination||"Not set"})]})]})}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,xn.jsx)(vv,{label:"Origin",value:t.origin,onChange:e=>c("origin",e),suggestions:o,disabled:i}),(0,xn.jsx)("div",{className:"flex items-end",children:!i&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{if(i)return;const e=[...n.routeOptions];e[r].transits.push(""),a(t=>We(We({},t),{},{routeOptions:e}))},className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700",children:[(0,xn.jsx)(da,{size:18}),"Add Transit"]})}),(0,xn.jsx)(vv,{label:"Destination",value:t.destination,onChange:e=>c("destination",e),suggestions:o,disabled:i})]}),t.transits.length>0&&(0,xn.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,xn.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Transit Stops"}),t.transits.map((e,t)=>(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[(0,xn.jsxs)("span",{className:"text-sm text-gray-600 min-w-[80px]",children:["Transit ",t+1,":"]}),(0,xn.jsx)("div",{className:"flex-1",children:(0,xn.jsx)(vv,{value:e,onChange:e=>((e,t)=>{if(i)return;const s=[...n.routeOptions];s[r].transits[e]=t,a(e=>We(We({},e),{},{routeOptions:s}))})(t,e),suggestions:o,showLabel:!1,disabled:i})}),!i&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{if(i)return;const t=[...n.routeOptions];t[r].transits=t[r].transits.filter((t,r)=>r!==e),a(e=>We(We({},e),{},{routeOptions:t}))})(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,xn.jsx)(Pa,{size:18})})]},t))]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h4",{className:"text-md font-medium text-gray-700",children:"air"==s?"AirLine Options":"Carrier Options"}),!i&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{if(i)return;const e=[...n.routeOptions];e[r].carriers.push({carrier:"",incoterm:"",currency:"",cargoType:""}),a(t=>We(We({},t),{},{routeOptions:e}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"air"==s?"Add AirLine":"Add Carrier"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-50",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"air"==s?"AirLine":"Carrier"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Incoterm"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Cargo Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:t.carriers.map((e,s)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.carrier,onChange:e=>d(s,"carrier",e),suggestions:l,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.incoterm,onChange:e=>d(s,"incoterm",e),suggestions:kv,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>d(s,"currency",e),suggestions:Sv,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.cargoType,onChange:e=>d(s,"cargoType",e),suggestions:Av,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.carriers.length>1&&!i&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{if(i)return;const t=[...n.routeOptions];t[r].carriers=t[r].carriers.filter((t,r)=>r!==e),a(e=>We(We({},e),{},{routeOptions:t}))})(s),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},s))})]})})]})]})}function I_(e){let{title:t,chargeData:r,routeOption:n,routeIdx:a,tableIdx:s,formData:i,setFormData:o,chargeType:l,showCarrier:c=!1,disabled:d=!1,category:u,onRemove:h=null}=e;const f=Iv(u),m="air"===u,p=e=>{if("origin"===e)return"Origin";if("destination"===e)return"Destination";if(e.startsWith("transit")){const t=e.replace("transit","");return"Transit ".concat(t)}return e},g=(e,t,r)=>{if(d)return;const n=[...i.routeOptions];n[a][l][s][e]||(n[a][l][s][e]={}),n[a][l][s][e][t]=r,o(e=>We(We({},e),{},{routeOptions:n}))},x=e=>{var t;return parseFloat((null===(t=r.amountPerLocation)||void 0===t?void 0:t[e])||0)},b=(()=>{const e=["origin"];return n.transits.forEach((t,r)=>{e.push("transit".concat(r+1))}),e.push("destination"),e})();return(0,xn.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:t}),h&&!d&&(0,xn.jsxs)("button",{type:"button",onClick:h,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,xn.jsx)(Pa,{size:16}),"Remove"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-50",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left w-48"}),b.map(e=>(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center font-semibold min-w-[150px]",children:p(e)},e))]})}),(0,xn.jsxs)("tbody",{children:[(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:c?"Carrier":"Charge Name"}),b.map(e=>{var t,n;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:c?(null===(t=r.carrierPerLocation)||void 0===t?void 0:t[e])||"":(null===(n=r.chargeNamePerLocation)||void 0===n?void 0:n[e])||"",onChange:t=>g(c?"carrierPerLocation":"chargeNamePerLocation",e,t),suggestions:c?f:Pv[l.replace("Tables","")]||Pv.handling,showLabel:!1,disabled:d})},e)})]}),(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Unit Type"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:(null===(t=r.unitTypePerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("unitTypePerLocation",e,t),suggestions:_v,showLabel:!1,disabled:d})},e)})]}),(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Number of Units"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:(null===(t=r.unitsPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("unitsPerLocation",e,t.target.value),disabled:d,placeholder:"0",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Amount"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:(null===(t=r.amountPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("amountPerLocation",e,t.target.value),disabled:d,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Currency"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:(null===(t=r.currencyPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("currencyPerLocation",e,t),suggestions:Sv,showLabel:!1,disabled:d})},e)})]}),c&&(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Transit Time"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:(null===(t=r.transitTimePerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("transitTimePerLocation",e,t.target.value),disabled:d,placeholder:"e.g., 7-10 days",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),c&&(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Number of Routing"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:(null===(t=r.numberOfRoutingPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("numberOfRoutingPerLocation",e,t.target.value),disabled:d,placeholder:"e.g., Direct",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),c&&m&&(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Surcharge"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:(null===(t=r.surchargePerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("surchargePerLocation",e,t.target.value),disabled:d,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),c&&m&&(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-50 font-medium",children:"Frequency"}),b.map(e=>{var t;return(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:(null===(t=r.frequencyPerLocation)||void 0===t?void 0:t[e])||"",onChange:t=>g("frequencyPerLocation",e,t.target.value),disabled:d,placeholder:"e.g., Daily",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})},e)})]}),(0,xn.jsxs)("tr",{className:"bg-blue-50",children:[(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2 bg-gray-100 font-bold",children:"Total"}),b.map(e=>(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:(x(e)||0).toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-blue-100 font-semibold text-center"})},e))]})]})]})}),(0,xn.jsx)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-3",children:(0,xn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,xn.jsxs)("span",{className:"font-semibold text-gray-700",children:["Total for ",t,":"]}),(0,xn.jsx)("span",{className:"text-2xl font-bold text-blue-900",children:(()=>{const e=r.amountPerLocation||{};return Object.values(e).reduce((e,t)=>e+(parseFloat(t)||0),0)})().toFixed(2)})]})})]})}function R_(e){let{formData:t,setFormData:r,routeIdx:n,tableIdx:a,chargeData:s,tableName:i,category:o,disabled:l=!1,onRemove:c=null}=e;const d=(e,s,i)=>{if(l)return;const o=[...t.routeOptions];if(o[n].freightChargesTables[a].charges[e][s]=i,"numberOfUnits"===s||"amount"===s){const t=o[n].freightChargesTables[a].charges[e],r=parseFloat(t.numberOfUnits)||0,s=parseFloat(t.amount)||0;t.total=r*s}r(e=>We(We({},e),{},{routeOptions:o}))},u=Iv(o),h=Dv(o),f="air"===o,m=s.charges||[];return(0,xn.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,xn.jsxs)("h3",{className:"text-lg font-medium text-gray-700",children:["Freight Charges (",i,")"]}),(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{if(l)return;const e={carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",total:0};"air"===o&&(e.surcharge="",e.frequency="");const s=[...t.routeOptions];s[n].freightChargesTables[a].charges.push(e),r(e=>We(We({},e),{},{routeOptions:s}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Charge"]}),c&&!l&&(0,xn.jsxs)("button",{type:"button",onClick:c,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,xn.jsx)(Pa,{size:16}),"Remove Table"]})]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-50",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"air"==o?"AirLine":"Carrier"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Transit Time"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Routing"}),f&&(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Surcharge"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Frequency"})]}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:m.map((e,s)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.carrier,onChange:e=>d(s,"carrier",e),suggestions:u,showLabel:!1,disabled:l})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.unitType,onChange:e=>d(s,"unitType",e),suggestions:h,showLabel:!1,disabled:l})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>d(s,"numberOfUnits",e.target.value),disabled:l,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>d(s,"amount",e.target.value),disabled:l,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>d(s,"currency",e),suggestions:Sv,showLabel:!1,disabled:l})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.transitTime||"",onChange:e=>d(s,"transitTime",e.target.value),disabled:l,placeholder:"e.g., 7-10 days",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.numberOfRouting||"",onChange:e=>d(s,"numberOfRouting",e.target.value),disabled:l,placeholder:"e.g., Direct",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),f&&(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.surcharge||"",onChange:e=>d(s,"surcharge",e.target.value),disabled:l,placeholder:"0.00",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.frequency||"",onChange:e=>d(s,"frequency",e.target.value),disabled:l,placeholder:"e.g., Daily",className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})})]}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:m.length>1&&!l&&(0,xn.jsx)("button",{type:"button",onClick:()=>(e=>{if(l)return;const s=[...t.routeOptions];s[n].freightChargesTables[a].charges=s[n].freightChargesTables[a].charges.filter((t,r)=>r!==e),r(e=>We(We({},e),{},{routeOptions:s}))})(s),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},s))}),(0,xn.jsx)("tfoot",{className:"bg-gray-50 font-semibold",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{colSpan:f?"9":"7",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:(s.charges&&Array.isArray(s.charges)?s.charges.reduce((e,t)=>e+(parseFloat(t.total)||0),0):0).toFixed(2)}),(0,xn.jsx)("td",{className:"border border-gray-300"})]})})]})})]})}function D_(e){let{category:t,mode:r}=e;const n=ae(),[a]=ze(),i=a.get("id"),o="true"===a.get("edit"),l=i&&!o,[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)({quoteNumber:"",createdDate:(new Date).toISOString().split("T")[0],rateValidity:"",customer:"",pickupLocation:"",deliveryLocation:"",portOfLoading:"",portOfDischarge:"",routeOptions:[{routeName:"Option 1",origin:"",destination:"",transits:[],carriers:[{carrier:"",incoterm:"",currency:"",cargoType:""}],freightChargesTables:[{tableName:"Default",charges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}]}],destinationChargesTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],originHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],destinationHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}]}],equipment:{equipment:"",units:"",grossWeight:"",volume:"",chargeableWeight:""},termsConditions:[]});(0,s.useEffect)(()=>{i?m():h(e=>We(We({},e),{},{quoteNumber:Gv()}))},[i]);const f=e=>e?e.split("T")[0]:"",m=async()=>{try{d(!0);const e=await Fa(i);h({quoteId:e[0].quoteId||"",quoteNumber:e[0].quoteNumber||"",createdDate:f(e[0].createdDate)||"",rateValidity:f(e[0].rateValidity)||"",customer:e[0].customer||"",pickupLocation:e[0].pickupLocation||"",deliveryLocation:e[0].deliveryLocation||"",portOfLoading:e[0].portOfLoading||"",portOfDischarge:e[0].portOfDischarge||"",routeOptions:e[0].transitRoutes?JSON.parse(e[0].transitRoutes):u.routeOptions,equipment:e[0].equipment?JSON.parse(e[0].equipment):u.equipment,termsConditions:e[0].termsConditions?JSON.parse(e[0].termsConditions):[]})}catch(X_){console.error("Error loading quote:",X_),alert("Failed to load quote data")}finally{d(!1)}},p=(e,t)=>{if(l)return;const r=[...u.routeOptions],n=r[e][t].length;let a;a="freightChargesTables"===t?{tableName:"Option ".concat(n),charges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}]}:{tableName:"Option ".concat(n),chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}},r[e][t].push(a),h(e=>We(We({},e),{},{routeOptions:r}))},g=(e,t,r)=>{if(l||0===r)return;const n=[...u.routeOptions];n[e][t]=n[e][t].filter((e,t)=>t!==r),h(e=>We(We({},e),{},{routeOptions:n}))};return c?(0,xn.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,xn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):(0,xn.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),!u.customer||""===u.customer.trim())return void alert("Customer is required. Please enter a customer name.");const a={quoteNumber:u.quoteNumber,freightCategory:t,freightMode:r,freightType:"transit",createdDate:u.createdDate,rateValidity:u.rateValidity,customer:u.customer,pickupLocation:u.pickupLocation,deliveryLocation:u.deliveryLocation,portOfLoading:u.portOfLoading,portOfDischarge:u.portOfDischarge,transitRoutes:JSON.stringify(u.routeOptions),equipment:JSON.stringify(u.equipment),termsConditions:JSON.stringify(u.termsConditions),status:"draft",createdBy:11,createdAt:(new Date).toISOString()};i&&(a.quoteId=i);try{i?(await Ra(a),alert("Quote updated successfully!")):(await Ia(a),alert("Quote created successfully!")),n(-1)}catch(X_){console.error("Error saving quote:",X_),alert("Failed to save quote")}},className:"space-y-6",children:(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[null===t||void 0===t?void 0:t.toUpperCase()," - ",null===r||void 0===r?void 0:r.toUpperCase()," (Transit)"]}),l&&(0,xn.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"View Mode"}),o&&(0,xn.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Edit Mode"})]}),(0,xn.jsxs)("div",{className:"flex gap-2",children:[i&&(0,xn.jsxs)("button",{type:"button",onClick:async()=>{let e="";if(u.customer)try{e=await ub(u.customer),console.log("Customer Address:",e)}catch(X_){console.error("Error fetching customer address:",X_)}(e=>{var t;const r=new DS;let n=__(r);n=T_(r,e,n);const a=e.equipment?JSON.parse(e.equipment):{},s=e.termsConditions?JSON.parse(e.termsConditions):[];let i=[],o=[];if(e.routes){const t=JSON.parse(e.routes);Array.isArray(t)&&t.length>0&&t[0].routes&&(i=t[0].routes,o=t[0].routes)}if(r.line(15,n,195,n),n+=5,r.setFont("helvetica","bold"),r.setFontSize(9),r.text("Route Segments",15,n),n+=5,r.setFont("helvetica","normal"),i.length>0){var l;const e=i.map(e=>e.origin||"N/A").concat([(null===(l=i[i.length-1])||void 0===l?void 0:l.destination)||"N/A"]).join(" \u2192 ");r.splitTextToSize(e,170).forEach(e=>{r.text(e,15,n),n+=4})}n+=6;const c=a.equipment?a:(null===(t=o[0])||void 0===t?void 0:t.equipment)||{};r.setFont("helvetica","bold"),r.text("Equipment",15,n),r.text("Units",70,n),r.text("Gross Weight",95,n),r.text("Volume (m\xb3)",135,n),r.text("Chargeable Weight",165,n),n+=4,r.setFont("helvetica","normal"),r.text(c.equipment||a.equipment||"N/A",15,n),r.text(a.units||c.units||"0",70,n),r.text(c.grossWeight||a.grossWeight||"0",95,n),r.text(c.volume||a.volume||"0",135,n),r.text(c.chargeableWeight||a.chargeableWeight||"0",165,n),n+=10,o.forEach((e,t)=>{var a;n>240&&(r.addPage(),n=20),r.setFillColor(200,220,240),r.rect(15,n-3,180,7,"F"),r.setFont("helvetica","bold"),r.setFontSize(10);const s=(null===(a=e.mode)||void 0===a?void 0:a.toUpperCase())||"N/A",i="".concat(e.origin||"N/A"," \u2192 ").concat(e.destination||"N/A");r.text("Segment ".concat(t+1,": ").concat(s," (").concat(i,")"),18,n+2),n+=10;const o=e.equipment||{};r.setFontSize(9),r.setFont("helvetica","bold"),r.text("Equipment",15,n),r.text("Transit Time",70,n),r.text("Net Weight",105,n),r.text("Gross Weight",135,n),r.text("Chargeable",170,n),n+=4,r.setFont("helvetica","normal"),r.text(o.equipment||"N/A",15,n),r.text(o.transitTime||"N/A",70,n),r.text(o.netWeight||"0",105,n),r.text(o.grossWeight||"0",135,n),r.text(o.chargeableWeight||"0",170,n),n+=8;const l=e.freightChargesTables||e.freightCharges||[];n=S_(r,l,n,e.mode,t+1),e.originHandling&&e.originHandling.length>0&&(n=L_(r,e.originHandling,"Seg".concat(t+1,": Origin Handling"),n)),e.destinationHandling&&e.destinationHandling.length>0&&(n=L_(r,e.destinationHandling,"Seg".concat(t+1,": Destination Handling"),n)),n+=5});const d=A_(o);n>270&&(r.addPage(),n=20),r.setFont("helvetica","bold"),r.setFontSize(11),r.text("Total Amount: USD ".concat(d.toFixed(2)),15,n),s.length>0&&(n+=10,n>250&&(r.addPage(),n=20),r.setFontSize(9),r.setFont("helvetica","bold"),r.text("Terms & Conditions:",15,n),n+=5,r.setFont("helvetica","normal"),r.setFontSize(8),s.forEach(e=>{r.splitTextToSize("- ".concat(e),170).forEach(e=>{n>280&&(r.addPage(),n=20),r.text(e,15,n),n+=4})})),r.setFontSize(8),r.setFont("helvetica","italic"),r.text("Quotation generated by - System",15,280),r.text("This is a Computer generated Document and no Signature required.",15,284),r.save("".concat(e.quoteNumber||"Transit-Quote",".pdf"))})({quoteNumber:u.quoteNumber,freightCategory:t,freightMode:r,freightType:"transit",createdDate:u.createdDate,rateValidity:u.rateValidity,customer:u.customer,customerAddress:e,pickupLocation:u.pickupLocation,deliveryLocation:u.deliveryLocation,equipment:JSON.stringify(u.equipment),transitRoutes:JSON.stringify(u.routeOptions),termsConditions:JSON.stringify(u.termsConditions)})},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,xn.jsx)(xv,{size:18}),"Download PDF"]}),(0,xn.jsx)("button",{type:"button",onClick:()=>n(-1),children:"Back"})]})]}),(0,xn.jsx)(Mv,{formData:u,setFormData:h,disabled:l}),(0,xn.jsxs)("div",{className:"mt-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Route Options"}),!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{l||h(e=>We(We({},e),{},{routeOptions:[...e.routeOptions,{routeName:"Option ".concat(e.routeOptions.length+1),origin:"",destination:"",transits:[],carriers:[{carrier:"",incoterm:"",currency:"",cargoType:""}],freightChargesTables:[{tableName:"Default",charges:[{carrier:"",unitType:"",numberOfUnits:"",amount:"",currency:"",transitTime:"",numberOfRouting:"",surcharge:"",frequency:"",total:0}]}],destinationChargesTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],originHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}],destinationHandlingTables:[{tableName:"Default",chargeNamePerLocation:{},unitTypePerLocation:{},unitsPerLocation:{},amountPerLocation:{},currencyPerLocation:{}}]}]}))},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,xn.jsx)(da,{size:18}),"Add Option"]})]}),u.routeOptions.map((e,r)=>(0,xn.jsxs)("div",{className:"border-2 border-teal-200 rounded-lg p-6 mb-6 bg-gradient-to-br from-teal-50 to-blue-50",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("h4",{className:"text-lg font-semibold text-teal-900",children:e.routeName}),u.routeOptions.length>1&&!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>(e=>{l||1===u.routeOptions.length||h(t=>We(We({},t),{},{routeOptions:t.routeOptions.filter((t,r)=>r!==e)}))})(r),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,xn.jsx)(Pa,{size:16}),"Remove Option"]})]}),(0,xn.jsx)(F_,{routeOption:e,routeIdx:r,formData:u,setFormData:h,category:t,disabled:l}),(0,xn.jsx)(Uv,{formData:u,setFormData:h,category:t,disabled:l}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Freight Charges"}),!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>p(r,"freightChargesTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Table"]})]}),e.freightChargesTables.map((e,n)=>(0,xn.jsx)("div",{className:"mb-4",children:(0,xn.jsx)(R_,{formData:u,setFormData:h,routeIdx:r,tableIdx:n,chargeData:e,tableName:e.tableName,category:t,disabled:l,onRemove:n>0?()=>g(r,"freightChargesTables",n):null})},n))]}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Destination Charges (POD)"}),!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>p(r,"destinationChargesTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Table"]})]}),e.destinationChargesTables.map((n,a)=>(0,xn.jsx)("div",{className:"mb-4",children:(0,xn.jsx)(I_,{title:"Destination Charges (".concat(n.tableName,")"),chargeData:n,routeOption:e,routeIdx:r,tableIdx:a,formData:u,setFormData:h,chargeType:"destinationChargesTables",showCarrier:!1,disabled:l,category:t,onRemove:a>0?()=>g(r,"destinationChargesTables",a):null})},a))]}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Origin Handling Charges"}),!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>p(r,"originHandlingTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Table"]})]}),e.originHandlingTables.map((n,a)=>(0,xn.jsx)("div",{className:"mb-4",children:(0,xn.jsx)(I_,{title:"Origin Handling Charges (".concat(n.tableName,")"),chargeData:n,routeOption:e,routeIdx:r,tableIdx:a,formData:u,setFormData:h,chargeType:"originHandlingTables",showCarrier:!1,disabled:l,category:t,onRemove:a>0?()=>g(r,"originHandlingTables",a):null})},a))]}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Destination Handling Charges"}),!l&&(0,xn.jsxs)("button",{type:"button",onClick:()=>p(r,"destinationHandlingTables"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Table"]})]}),e.destinationHandlingTables.map((n,a)=>(0,xn.jsx)("div",{className:"mb-4",children:(0,xn.jsx)(I_,{title:"Destination Handling Charges (".concat(n.tableName,")"),chargeData:n,routeOption:e,routeIdx:r,tableIdx:a,formData:u,setFormData:h,chargeType:"destinationHandlingTables",showCarrier:!1,disabled:l,category:t,onRemove:a>0?()=>g(r,"destinationHandlingTables",a):null})},a))]})]},r))]}),(0,xn.jsx)(Vv,{formData:u,setFormData:h,disabled:l}),!l&&(0,xn.jsx)("div",{className:"flex justify-end mt-6",children:(0,xn.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,xn.jsx)(qa,{size:18}),i?"Update Quote":"Save Quote"]})})]})})}const M_=["Per Kg","Per Lb","Per Container","Per CBM","Per Shipment","Flat Rate","Per Unit","Per Pallet"];function B_(e){let{title:t,chargeData:r,routeIdx:n,routeSegmentIdx:a,tableIdx:s,formData:i,setFormData:o,disabled:l=!1,onRemove:c=null}=e;const d=(e,t)=>{if(l)return;const r=[...i.routeOptions];r[n].routes[a].freightChargesTables[s][e]=t,o(e=>We(We({},e),{},{routeOptions:r}))},u=i.routeOptions[n].routes[a].mode,h="air"===(f=u)?Lv.air:"sea"===f?Lv.sea:"trucking"===f?Lv.trucking:[...Lv.air,...Lv.sea,...Lv.trucking];var f;return(0,xn.jsxs)("div",{className:"space-y-4 mb-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:t}),c&&!l&&(0,xn.jsxs)("button",{type:"button",onClick:c,className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,xn.jsx)(Pa,{size:16}),"Remove"]})]}),(0,xn.jsxs)("div",{className:"text-xs text-gray-600 mb-2",children:["Mode: ",(0,xn.jsx)("span",{className:"font-semibold capitalize",children:u})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chargeable Weight (Kg)"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:r.chargeableWeight||"",onChange:e=>d("chargeableWeight",e.target.value),disabled:l,placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100 focus:ring-2 focus:ring-purple-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight Breaker"}),(0,xn.jsx)(vv,{value:r.weightBreaker||"",onChange:e=>d("weightBreaker",e),suggestions:h,showLabel:!1,disabled:l,placeholder:"Select ".concat(u," weight breaker")})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pricing Unit"}),(0,xn.jsx)(vv,{value:r.pricingUnit||"",onChange:e=>d("pricingUnit",e),suggestions:M_,showLabel:!1,disabled:l,placeholder:"Select pricing unit"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Charge (Price)"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:r.charge||"",onChange:e=>d("charge",e.target.value),disabled:l,placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100 focus:ring-2 focus:ring-purple-500"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,xn.jsx)(vv,{value:r.currency||"",onChange:e=>d("currency",e),suggestions:Sv,showLabel:!1,disabled:l,placeholder:"Select currency"})]})]}),(0,xn.jsxs)("div",{className:"bg-purple-50 border-2 border-purple-200 rounded-lg p-3",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,xn.jsx)("span",{className:"font-semibold text-gray-700",children:"Total Freight Charge:"}),(0,xn.jsxs)("span",{className:"text-2xl font-bold text-purple-900",children:[((parseFloat(r.chargeableWeight)||0)*(parseFloat(r.charge)||0)).toFixed(2)," ",r.currency||""]})]}),(0,xn.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["(",r.chargeableWeight||"0"," \xd7 ",r.charge||"0"," ",r.pricingUnit||"",")"]})]})]})}function U_(e){let{route:t,routeIdx:r,routeSegmentIdx:n,formData:a,setFormData:s,disabled:i=!1,mode:o}=e;const l=(e,t)=>{if(i)return;const o=[...a.routeOptions];o[r].routes[n].equipment[e]=t,s(e=>We(We({},e),{},{routeOptions:o}))},c=e=>{if(i)return;const t=[...a.routeOptions],o="origin"===e?"originHandling":"destinationHandling";t[r].routes[n][o].push({chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}),s(e=>We(We({},e),{},{routeOptions:t}))},d=(e,t)=>{if(i)return;const o=[...a.routeOptions],l="origin"===e?"originHandling":"destinationHandling";o[r].routes[n][l]=o[r].routes[n][l].filter((e,r)=>r!==t),s(e=>We(We({},e),{},{routeOptions:o}))},u=(e,t,o,l)=>{if(i)return;const c=[...a.routeOptions],d="origin"===e?"originHandling":"destinationHandling";if(c[r].routes[n][d][t][o]=l,"numberOfUnits"===o||"amount"===o){const e=c[r].routes[n][d][t],a=parseFloat(e.numberOfUnits)||0,s=parseFloat(e.amount)||0;e.total=a*s}s(e=>We(We({},e),{},{routeOptions:c}))},h=e=>t["origin"===e?"originHandling":"destinationHandling"].reduce((e,t)=>e+(parseFloat(t.total)||0),0),f=Iv(t.mode),m=Rv(t.mode);return(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,xn.jsx)("h6",{className:"text-md font-semibold text-gray-700 mb-4",children:"Equipment Details"}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,xn.jsx)(vv,{label:"air"==o?"AirLine":"Carrier",value:t.equipment.carrier,onChange:e=>l("carrier",e),suggestions:f,disabled:i}),(0,xn.jsx)(vv,{label:"Equipment",value:t.equipment.equipment,onChange:e=>l("equipment",e),suggestions:m,disabled:i}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transit Time (Days)"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.transitTime,onChange:e=>l("transitTime",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Net Weight (Kg)"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.netWeight,onChange:e=>l("netWeight",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gross Weight (Kg)"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.grossWeight,onChange:e=>l("grossWeight",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Volume (m\xb3)"}),(0,xn.jsx)("input",{type:"number",step:"0.01",value:t.equipment.volume,onChange:e=>l("volume",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chargeable Weight (Kg)"}),(0,xn.jsx)("input",{type:"number",value:t.equipment.chargeableWeight,onChange:e=>l("chargeableWeight",e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]})]})]}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h6",{className:"text-md font-semibold text-gray-700",children:"Freight Charges"}),!i&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{if(i)return;const e=[...a.routeOptions],t=e[r].routes[n].freightChargesTables.length;e[r].routes[n].freightChargesTables.push({tableName:"Option ".concat(t),chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}),s(t=>We(We({},t),{},{routeOptions:e}))},className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Table"]})]}),t.freightChargesTables.map((e,t)=>(0,xn.jsx)("div",{className:"mb-4",children:(0,xn.jsx)(B_,{title:"Freight Charges (".concat(e.tableName,")"),chargeData:e,routeIdx:r,routeSegmentIdx:n,tableIdx:t,formData:a,setFormData:s,disabled:i,onRemove:t>0?()=>(e=>{if(i||0===e)return;const t=[...a.routeOptions];t[r].routes[n].freightChargesTables=t[r].routes[n].freightChargesTables.filter((t,r)=>r!==e),s(e=>We(We({},e),{},{routeOptions:t}))})(t):null})},t))]}),(0,xn.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h6",{className:"text-md font-semibold text-gray-700",children:"Origin Handling Charges"}),!i&&(0,xn.jsxs)("button",{type:"button",onClick:()=>c("origin"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Charge"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-100",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:t.originHandling.map((e,r)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.chargeName,onChange:e=>u("origin",r,"chargeName",e),suggestions:Pv.handling,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.unitType,onChange:e=>u("origin",r,"unitType",e),suggestions:_v,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>u("origin",r,"numberOfUnits",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>u("origin",r,"amount",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>u("origin",r,"currency",e),suggestions:Sv,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.originHandling.length>1&&!i&&(0,xn.jsx)("button",{type:"button",onClick:()=>d("origin",r),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},r))}),(0,xn.jsx)("tfoot",{className:"bg-gray-100 font-semibold",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{colSpan:"5",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:h("origin").toFixed(2)}),(0,xn.jsx)("td",{className:"border border-gray-300"})]})})]})})]}),(0,xn.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h6",{className:"text-md font-semibold text-gray-700",children:"Destination Handling Charges"}),!i&&(0,xn.jsxs)("button",{type:"button",onClick:()=>c("destination"),className:"flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[(0,xn.jsx)(da,{size:16}),"Add Charge"]})]}),(0,xn.jsx)("div",{className:"overflow-x-auto",children:(0,xn.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,xn.jsx)("thead",{className:"bg-gray-100",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Charge Name"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Unit Type"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Number of Units"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Amount"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Currency"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Total"}),(0,xn.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center w-20",children:"Action"})]})}),(0,xn.jsx)("tbody",{children:t.destinationHandling.map((e,r)=>(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.chargeName,onChange:e=>u("destination",r,"chargeName",e),suggestions:Pv.handling,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.unitType,onChange:e=>u("destination",r,"unitType",e),suggestions:_v,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",value:e.numberOfUnits,onChange:e=>u("destination",r,"numberOfUnits",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"number",step:"0.01",value:e.amount,onChange:e=>u("destination",r,"amount",e.target.value),disabled:i,className:"w-full px-2 py-1 border border-gray-300 rounded disabled:bg-gray-100"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)(vv,{value:e.currency,onChange:e=>u("destination",r,"currency",e),suggestions:Sv,showLabel:!1,disabled:i})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2",children:(0,xn.jsx)("input",{type:"text",value:e.total.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded bg-gray-50"})}),(0,xn.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:t.destinationHandling.length>1&&!i&&(0,xn.jsx)("button",{type:"button",onClick:()=>d("destination",r),className:"text-red-600 hover:text-red-700",children:(0,xn.jsx)(Pa,{size:16})})})]},r))}),(0,xn.jsx)("tfoot",{className:"bg-gray-100 font-semibold",children:(0,xn.jsxs)("tr",{children:[(0,xn.jsx)("td",{colSpan:"5",className:"border border-gray-300 px-4 py-2 text-right",children:"Grand Total:"}),(0,xn.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:h("destination").toFixed(2)}),(0,xn.jsx)("td",{className:"border border-gray-300"})]})})]})})]})]})}function z_(e){let{routeOption:t,routeIdx:r,formData:n,setFormData:a,disabled:s=!1}=e;const i=(e,t,i)=>{if(s)return;const o=[...n.routeOptions];o[r].routes[e][t]=i,a(e=>We(We({},e),{},{routeOptions:o}))},o=e=>"air"===e?wv:"sea"===e?Nv:["Los Angeles, CA","New York, NY","Chicago, IL","Houston, TX","Miami, FL","Atlanta, GA","Dallas, TX"],l=e=>"air"===e?"\u2708\ufe0f":"sea"===e?"\ud83d\udea2":"trucking"===e?"\ud83d\ude9b":"\ud83d\udce6",c=e=>"air"===e?{bg:"bg-blue-100",border:"border-blue-500",text:"text-blue-900",badgeBg:"bg-blue-200"}:"sea"===e?{bg:"bg-teal-100",border:"border-teal-500",text:"text-teal-900",badgeBg:"bg-teal-200"}:"trucking"===e?{bg:"bg-orange-100",border:"border-orange-500",text:"text-orange-900",badgeBg:"bg-orange-200"}:{bg:"bg-gray-100",border:"border-gray-500",text:"text-gray-900",badgeBg:"bg-gray-200"},d=e=>{const t=l(e.mode),r="air"===e.mode?"Air":"sea"===e.mode?"Sea":"Trucking",n=e.origin||"Origin",a=e.destination||"Destination";return"".concat(t," ").concat(r,": ").concat(n," \u2192 ").concat(a)};return(0,xn.jsxs)("div",{className:"space-y-6 mb-6",children:[(0,xn.jsxs)("div",{className:"bg-white rounded-lg p-6 border-2 border-purple-300 shadow-md",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("h4",{className:"text-lg font-semibold text-purple-900",children:"Create Route Segments"}),!s&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{if(s)return;const e=[...n.routeOptions];e[r].routes.push({mode:"air",origin:"",destination:"",equipment:{carrier:"",equipment:"",transitTime:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},freightChargesTables:[{tableName:"Default",chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}),a(t=>We(We({},t),{},{routeOptions:e}))},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 shadow-lg",children:[(0,xn.jsx)(da,{size:18}),"Add Segment"]})]}),(0,xn.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Add your route segments here. Details for each segment will appear below."}),(0,xn.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border-2 border-purple-200 mb-6",children:(0,xn.jsx)("div",{className:"flex items-center gap-2 flex-wrap",children:t.routes.map((e,t)=>{const r=c(e.mode);return(0,xn.jsxs)("div",{className:"flex items-center gap-2",children:[t>0&&(0,xn.jsx)(Ca,{className:"text-purple-500",size:24}),(0,xn.jsxs)("div",{className:"flex flex-col items-center",children:[(0,xn.jsxs)("span",{className:"text-xs text-gray-500 mb-1 font-semibold",children:["Segment ",t+1]}),(0,xn.jsxs)("div",{className:"px-4 py-3 ".concat(r.bg," border-2 ").concat(r.border," rounded-lg font-semibold text-sm min-w-[140px] text-center shadow-sm"),children:[(0,xn.jsxs)("div",{className:"text-xs mb-1",children:[l(e.mode)," ","air"===e.mode?"Air":"sea"===e.mode?"Sea":"Trucking"]}),(0,xn.jsx)("div",{children:e.origin||"Origin"}),(0,xn.jsx)("div",{className:"text-xs text-gray-600",children:"\u2193"}),(0,xn.jsx)("div",{children:e.destination||"Dest"})]})]})]},t)})})}),(0,xn.jsx)("div",{className:"space-y-4",children:t.routes.map((e,l)=>{const d=c(e.mode);return(0,xn.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-300",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,xn.jsx)("h5",{className:"font-semibold text-gray-800 flex items-center gap-2",children:(0,xn.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-bold ".concat(d.badgeBg," ").concat(d.text),children:["Segment ",l+1]})}),t.routes.length>1&&!s&&(0,xn.jsxs)("button",{type:"button",onClick:()=>(e=>{if(s||1===t.routes.length)return;const i=[...n.routeOptions];i[r].routes=i[r].routes.filter((t,r)=>r!==e),a(e=>We(We({},e),{},{routeOptions:i}))})(l),className:"flex items-center gap-1 px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[(0,xn.jsx)(Pa,{size:16}),"Remove"]})]}),(0,xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode"}),(0,xn.jsxs)("select",{value:e.mode,onChange:e=>i(l,"mode",e.target.value),disabled:s,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100 focus:ring-2 focus:ring-purple-500",children:[(0,xn.jsx)("option",{value:"air",children:"\u2708\ufe0f Air"}),(0,xn.jsx)("option",{value:"sea",children:"\ud83d\udea2 Sea"}),(0,xn.jsx)("option",{value:"trucking",children:"\ud83d\ude9b Trucking"})]})]}),(0,xn.jsx)(vv,{label:"Origin",value:e.origin,onChange:e=>i(l,"origin",e),suggestions:o(e.mode),disabled:s}),(0,xn.jsx)(vv,{label:"Destination",value:e.destination,onChange:e=>i(l,"destination",e),suggestions:o(e.mode),disabled:s})]})]},l)})})]}),(0,xn.jsxs)("div",{className:"space-y-6",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,xn.jsx)("div",{className:"h-px bg-gradient-to-r from-purple-300 to-pink-300 flex-1"}),(0,xn.jsx)("h4",{className:"text-lg font-semibold text-purple-900 px-4",children:"Segment Details"}),(0,xn.jsx)("div",{className:"h-px bg-gradient-to-r from-pink-300 to-purple-300 flex-1"})]}),(0,xn.jsx)("p",{className:"text-sm text-gray-600 text-center mb-6",children:"Fill in the details for each segment below. Equipment, freight charges, and handling charges are specific to each segment."}),t.routes.map((e,t)=>{const i=c(e.mode);return(0,xn.jsxs)("div",{className:"bg-white rounded-lg p-6 border-2 border-gray-300 shadow-lg",id:"segment-detail-".concat(t),children:[(0,xn.jsx)("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-4 mb-6 border-2 border-purple-300",children:(0,xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,xn.jsxs)("div",{className:"flex items-center gap-3",children:[(0,xn.jsx)("span",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg ".concat("air"===e.mode?"bg-blue-600":"sea"===e.mode?"bg-teal-600":"bg-orange-600"),children:t+1}),(0,xn.jsxs)("div",{children:[(0,xn.jsxs)("h5",{className:"text-xl font-bold text-gray-800",children:["Segment ",t+1]}),(0,xn.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:d(e)})]})]}),(0,xn.jsxs)("div",{className:"px-4 py-2 rounded-lg font-semibold ".concat(i.badgeBg," ").concat(i.text),children:[l(e.mode)," ","air"===e.mode?"Air Freight":"sea"===e.mode?"Sea Freight":"Trucking"]})]})}),(0,xn.jsx)(U_,{route:e,routeIdx:r,routeSegmentIdx:t,formData:n,setFormData:a,disabled:s,mode:e.mode})]},t)})]})]})}function q_(){const e=ae(),[t]=ze(),r=t.get("id"),n="true"===t.get("edit"),a=r&&!n,[i,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)({quoteNumber:"",createdDate:(new Date).toISOString().split("T")[0],rateValidity:"",customer:"",pickupLocation:"",deliveryLocation:"",importExport:"import",routeOptions:[{routeName:"Option 1",routes:[{mode:"air",origin:"",destination:"",equipment:{carrier:"",equipment:"",transitTime:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},freightChargesTables:[{tableName:"Default",chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}]}],termsConditions:[]});(0,s.useEffect)(()=>{r?u():c(e=>We(We({},e),{},{quoteNumber:Gv()}))},[r]);const d=e=>e?e.split("T")[0]:"",u=async()=>{try{o(!0);const e=await Fa(r);c({quoteNumber:e[0].quoteNumber||"",createdDate:d(e[0].createdDate)||"",rateValidity:d(e[0].rateValidity)||"",customer:e[0].customer||"",pickupLocation:e[0].pickupLocation||"",deliveryLocation:e[0].deliveryLocation||"",importExport:e[0].freightMode||"import",routeOptions:e[0].routes?JSON.parse(e[0].routes):l.routeOptions,termsConditions:e[0].termsConditions?JSON.parse(e[0].termsConditions):[]})}catch(X_){console.error("Error loading quote:",X_),alert("Failed to load quote data")}finally{o(!1)}},h=()=>l.routeOptions.reduce((e,t)=>e+t.routes.reduce((e,t)=>e+(parseInt(t.equipment.transitTime)||0),0),0);return i?(0,xn.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,xn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,xn.jsx)("form",{onSubmit:async t=>{if(t.preventDefault(),!l.customer||""===l.customer.trim())return void alert("Customer is required. Please enter a customer name.");const n={quoteNumber:l.quoteNumber,freightCategory:"multimodal",freightMode:l.importExport,freightType:"multimodal",createdDate:l.createdDate,rateValidity:l.rateValidity,customer:l.customer,pickupLocation:l.pickupLocation,deliveryLocation:l.deliveryLocation,routes:JSON.stringify(l.routeOptions),totalTransitTime:h(),termsConditions:JSON.stringify(l.termsConditions),status:"draft",createdBy:11,createdAt:(new Date).toISOString()};r&&(n.quoteId=r);try{r?(await Ra(n),alert("Quote updated successfully!")):(await Ia(n),alert("Quote created successfully!")),e(-1)}catch(X_){console.error("Error saving quote:",X_),alert("Failed to save quote")}},className:"space-y-6",children:(0,xn.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsxs)("div",{children:[(0,xn.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Multi-Modal Freight Quote"}),(0,xn.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Quote Number: ",l.quoteNumber]}),a&&(0,xn.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"View Mode"}),n&&(0,xn.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Edit Mode"})]}),(0,xn.jsxs)("div",{className:"flex gap-2",children:[r&&(0,xn.jsxs)("button",{type:"button",onClick:async()=>{let e="";if(l.customer)try{e=await ub(l.customer),console.log("Customer Address:",e)}catch(X_){console.error("Error fetching customer address:",X_)}(e=>{var t;const r=new DS;let n=__(r);n=T_(r,e,n);const a=e.equipment?JSON.parse(e.equipment):{},s=e.termsConditions?JSON.parse(e.termsConditions):[];let i=[],o=[];if(e.routes){const t=JSON.parse(e.routes);Array.isArray(t)&&t.length>0&&t[0].routes&&(i=t[0].routes,o=t[0].routes)}if(r.line(15,n,195,n),n+=5,r.setFont("helvetica","bold"),r.setFontSize(9),r.text("Route Segments",15,n),n+=5,r.setFont("helvetica","normal"),i.length>0){const e=i.map((e,t)=>{var r;const n=(null===(r=e.mode)||void 0===r?void 0:r.toUpperCase())||"N/A",a="".concat(e.origin||"N/A"," \u2192 ").concat(e.destination||"N/A");return"Seg ".concat(t+1,": ").concat(n," (").concat(a,")")}).join("  |  ");r.splitTextToSize(e,170).forEach(e=>{r.text(e,15,n),n+=4})}n+=6;const l=a.equipment?a:(null===(t=o[0])||void 0===t?void 0:t.equipment)||{};r.setFont("helvetica","bold"),r.text("Equipment",15,n),r.text("Units",70,n),r.text("Gross Weight",95,n),r.text("Volume (m\xb3)",135,n),r.text("Chargeable Weight",165,n),n+=4,r.setFont("helvetica","normal"),r.text(l.equipment||a.equipment||"N/A",15,n),r.text(a.units||l.units||"0",70,n),r.text(l.grossWeight||a.grossWeight||"0",95,n),r.text(l.volume||a.volume||"0",135,n),r.text(l.chargeableWeight||a.chargeableWeight||"0",165,n),n+=10,o.forEach((e,t)=>{var a;n>240&&(r.addPage(),n=20),r.setFillColor(220,200,240),r.rect(15,n-3,180,7,"F"),r.setFont("helvetica","bold"),r.setFontSize(10);const s=(null===(a=e.mode)||void 0===a?void 0:a.toUpperCase())||"N/A",i="".concat(e.origin||"N/A"," \u2192 ").concat(e.destination||"N/A");r.text("Segment ".concat(t+1,": ").concat(s," (").concat(i,")"),18,n+2),n+=10;const o=e.equipment||{};r.setFontSize(9),r.setFont("helvetica","bold"),r.text("Equipment",15,n),r.text("Transit Time",70,n),r.text("Net Weight",105,n),r.text("Gross Weight",135,n),r.text("Chargeable",170,n),n+=4,r.setFont("helvetica","normal"),r.text(o.equipment||"N/A",15,n),r.text(o.transitTime||"N/A",70,n),r.text(o.netWeight||"0",105,n),r.text(o.grossWeight||"0",135,n),r.text(o.chargeableWeight||"0",170,n),n+=8;const l=e.freightChargesTables||e.freightCharges||[];n=S_(r,l,n,e.mode,t+1),e.originHandling&&e.originHandling.length>0&&(n=L_(r,e.originHandling,"Seg".concat(t+1,": Origin Handling"),n)),e.destinationHandling&&e.destinationHandling.length>0&&(n=L_(r,e.destinationHandling,"Seg".concat(t+1,": Destination Handling"),n)),n+=5});const c=A_(o);n>270&&(r.addPage(),n=20),r.setFont("helvetica","bold"),r.setFontSize(11),r.text("Total Amount: USD ".concat(c.toFixed(2)),15,n),s.length>0&&(n+=10,n>250&&(r.addPage(),n=20),r.setFontSize(9),r.setFont("helvetica","bold"),r.text("Terms & Conditions:",15,n),n+=5,r.setFont("helvetica","normal"),r.setFontSize(8),s.forEach(e=>{r.splitTextToSize("- ".concat(e),170).forEach(e=>{n>280&&(r.addPage(),n=20),r.text(e,15,n),n+=4})})),r.setFontSize(8),r.setFont("helvetica","italic"),r.text("Quotation generated by - System",15,280),r.text("This is a Computer generated Document and no Signature required.",15,284),r.save("".concat(e.quoteNumber||"MultiModal-Quote",".pdf"))})({quoteNumber:l.quoteNumber,freightMode:l.importExport,freightType:"multimodal",createdDate:l.createdDate,rateValidity:l.rateValidity,customer:l.customer,customerAddress:e,pickupLocation:l.pickupLocation,deliveryLocation:l.deliveryLocation,routes:JSON.stringify(l.routeOptions),termsConditions:JSON.stringify(l.termsConditions)})},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,xn.jsx)(xv,{size:18}),"Download PDF"]}),(0,xn.jsx)("button",{type:"button",onClick:()=>e(-1),children:"Back"})]})]}),(0,xn.jsxs)("div",{className:"mb-6",children:[(0,xn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Import / Export"}),(0,xn.jsxs)("select",{value:l.importExport,onChange:e=>c(t=>We(We({},t),{},{importExport:e.target.value})),disabled:a,className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100",children:[(0,xn.jsx)("option",{value:"import",children:"Import"}),(0,xn.jsx)("option",{value:"export",children:"Export"})]})]}),(0,xn.jsx)(Mv,{formData:l,setFormData:c,disabled:a}),(0,xn.jsxs)("div",{className:"mt-6",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Route Options"}),!a&&(0,xn.jsxs)("button",{type:"button",onClick:()=>{a||c(e=>We(We({},e),{},{routeOptions:[...e.routeOptions,{routeName:"Option ".concat(e.routeOptions.length+1),routes:[{mode:"air",origin:"",destination:"",equipment:{carrier:"",equipment:"",transitTime:"",netWeight:"",grossWeight:"",volume:"",chargeableWeight:""},freightChargesTables:[{tableName:"Default",chargeableWeight:"",weightBreaker:"",pricingUnit:"",charge:"",currency:""}],originHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}],destinationHandling:[{chargeName:"",unitType:"",numberOfUnits:"",amount:"",currency:"",total:0}]}]}]}))},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,xn.jsx)(da,{size:18}),"Add Option"]})]}),l.routeOptions.map((e,t)=>(0,xn.jsxs)("div",{className:"border-2 border-purple-200 rounded-lg p-6 mb-6 bg-gradient-to-br from-purple-50 to-pink-50",children:[(0,xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,xn.jsx)("h4",{className:"text-lg font-semibold text-purple-900",children:e.routeName}),l.routeOptions.length>1&&!a&&(0,xn.jsxs)("button",{type:"button",onClick:()=>(e=>{a||1===l.routeOptions.length||c(t=>We(We({},t),{},{routeOptions:t.routeOptions.filter((t,r)=>r!==e)}))})(t),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:[(0,xn.jsx)(Pa,{size:16}),"Remove Option"]})]}),(0,xn.jsx)(z_,{routeOption:e,routeIdx:t,formData:l,setFormData:c,disabled:a})]},t))]}),(0,xn.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-200 rounded-lg p-4 mb-6",children:(0,xn.jsxs)("div",{className:"text-lg font-semibold text-blue-900",children:["Total Transit Time: ",h()," Days"]})}),(0,xn.jsx)(Vv,{formData:l,setFormData:c,disabled:a}),!a&&(0,xn.jsx)("div",{className:"flex justify-end mt-6",children:(0,xn.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[(0,xn.jsx)(qa,{size:18}),r?"Update Quote":"Save Quote"]})})]})})}function H_(){const[e]=ze(),t=e.get("category"),r=e.get("type"),n=e.get("mode");return(0,xn.jsx)("div",{className:"p-6",children:(console.log("this is catagory ",t),"direct"===r?(0,xn.jsx)(O_,{category:t,mode:n}):"transit"===r?(0,xn.jsx)(D_,{category:t,mode:n}):"multimodal"===r?(0,xn.jsx)(q_,{}):(0,xn.jsx)("div",{className:"p-6",children:"Please select a freight type"}))})}function W_(){const[e,t]=(0,s.useState)(!1);return(0,xn.jsxs)("div",{className:"h-screen bg-slate-50 flex flex-col overflow-hidden",children:[(0,xn.jsx)(Mn,{onMenuToggle:()=>{t(!e)},isMobileMenuOpen:e}),(0,xn.jsxs)("div",{className:"flex flex-1 overflow-hidden pt-14",children:[(0,xn.jsx)(Jn,{isOpen:e,onClose:()=>{t(!1)}}),(0,xn.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,xn.jsx)(H_,{})})]}),(0,xn.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n      "})]})}const V_=function(){return(0,xn.jsx)(vn,{children:(0,xn.jsx)(Oe,{children:(0,xn.jsxs)(ke,{children:[(0,xn.jsx)(Ne,{path:"/login",element:(0,xn.jsx)(Ub,{})}),(0,xn.jsxs)(Ne,{element:(0,xn.jsx)(yn,{}),children:[(0,xn.jsx)(Ne,{path:"/dashboard",element:(0,xn.jsx)(aa,{})}),(0,xn.jsx)(Ne,{path:"/mail-tracking",element:(0,xn.jsx)(ga,{})}),(0,xn.jsx)(Ne,{path:"/quotes-invoices",element:(0,xn.jsx)(Ka,{})}),(0,xn.jsx)(Ne,{path:"/quotes",element:(0,xn.jsx)(W_,{})}),(0,xn.jsx)(Ne,{path:"/rates",element:(0,xn.jsx)(Cb,{})}),(0,xn.jsx)(Ne,{path:"/rfq",element:(0,xn.jsx)(Mx,{})}),(0,xn.jsx)(Ne,{path:"/leads",element:(0,xn.jsx)(sb,{})}),(0,xn.jsx)(Ne,{path:"/accounts",element:(0,xn.jsx)(jb,{})}),(0,xn.jsx)(Ne,{path:"/sales-plans",element:(0,xn.jsx)(Rb,{})}),(0,xn.jsx)(Ne,{path:"/usefull-link",element:(0,xn.jsx)(sv,{})}),(0,xn.jsx)(Ne,{path:"/hr/manage-employee",element:(0,xn.jsx)($b,{})}),(0,xn.jsx)(Ne,{path:"/hr/manage",element:(0,xn.jsx)(Zb,{})}),(0,xn.jsx)(Ne,{path:"/rolebase",element:(0,xn.jsx)(mv,{})}),(0,xn.jsx)(Ne,{path:"/profile",element:(0,xn.jsx)(gv,{})}),(0,xn.jsx)(Ne,{path:"/",element:(0,xn.jsx)(ye,{to:"/dashboard",replace:!0})})]}),(0,xn.jsx)(Ne,{path:"*",element:(0,xn.jsx)(ye,{to:"/login",replace:!0})})]})})})},G_=e=>{e&&e instanceof Function&&r.e(453).then(r.bind(r,6453)).then(t=>{let{getCLS:r,getFID:n,getFCP:a,getLCP:s,getTTFB:i}=t;r(e),n(e),a(e),s(e),i(e)})};o.createRoot(document.getElementById("root")).render((0,xn.jsx)(s.StrictMode,{children:(0,xn.jsx)(V_,{})})),G_()})();
//# sourceMappingURL=main.f2d812e2.js.map